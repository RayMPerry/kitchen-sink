From: <Saved by Blink>
Snapshot-Content-Location: http://nongnu.org/txr/txr-manpage.html#/
Subject: Manpage for TXR
Date: Mon, 19 Apr 2021 15:51:54 -0000
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--pSBQFzMwx6iqKirzHyn6nKPOp5RwEH2OySALaokay7----"


------MultipartBoundary--pSBQFzMwx6iqKirzHyn6nKPOp5RwEH2OySALaokay7----
Content-Type: text/html
Content-ID: <frame-FE2AA86AA406C98C87ABDED30672A250@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: http://nongnu.org/txr/txr-manpage.html#/

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>=
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3DUTF-8"><l=
ink rel=3D"stylesheet" type=3D"text/css" href=3D"cid:css-09d5e6d3-863d-447c=
-aeb2-db07e4366efb@mhtml.blink" /><title>Manpage for TXR </title>



</head><body>
<h2>Manpage for <a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0005261=
5">TXR </a></h2>
<h2>Apr 07, 2021</h2>
<p>
</p><form action=3D"https://www.paypal.com/cgi-bin/webscr" method=3D"post">


<input type=3D"image" src=3D"https://www.paypalobjects.com/en_US/i/btn/btn_=
donate_LG.gif" border=3D"0" name=3D"submit" alt=3D"PayPal - The safer, easi=
er way to pay online!">
<img alt=3D"" border=3D"0" src=3D"https://www.paypalobjects.com/en_US/i/scr=
/pixel.gif" width=3D"1" height=3D"1" iyg7n92l5=3D"">
</form>
<p></p>
<div class=3D"toc">
<h2>Contents</h2>

<a href=3D"http://nongnu.org/txr/txr-manpage.html#/">[expand all]</a>
<dl>
<dt><a name=3D"TOC-1" class=3D"tocanchor">1</a> <a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-00052615">NAME</a></dt>
<dt><a name=3D"TOC-2" class=3D"tocanchor">2</a> <a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-02345740">SYNOPSIS</a></dt>
<dt><a name=3D"TOC-3" class=3D"tocanchor">3</a> <a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-02D7A45F">DESCRIPTION</a></dt>
<dt><a name=3D"TOC-4" class=3D"tocanchor">4</a> <a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-02F43351">ARGUMENTS AND OPTIONS</a></dt>
<dt><a name=3D"TOC-5" class=3D"tocanchor">5</a> <a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-0014ADB0">STATUS AND ERROR REPORTING</a></dt>
<dt><a name=3D"TOC-6" class=3D"tocanchor">6</a> <a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-00C0A1F1">BASIC TXR SYNTAX</a><a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0125" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-6.1" class=3D"tocanchor">6.1</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-0243C6DA">Comments</a></dt>
<dt><a name=3D"TOC-6.2" class=3D"tocanchor">6.2</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-01ED8E44">Hash Bang Support</a><a href=3D"http=
://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></d=
t>
<dd><dl id=3D"g0126" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-6.2.1" class=3D"tocanchor">6.2.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0021E02D">Basic Hash Bang</a></dt>
<dt><a name=3D"TOC-6.2.2" class=3D"tocanchor">6.2.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03FCDE42">Argument Generation with <tt>--a=
rgs</tt> and <tt>--eargs</tt></a></dt>
<dt><a name=3D"TOC-6.2.3" class=3D"tocanchor">6.2.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01DF6FA2">Argument Generation with the Nul=
l Hack</a></dt>
<dt><a name=3D"TOC-6.2.4" class=3D"tocanchor">6.2.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-033493D0">Passing Options to <b>TXR</b> vi=
a Hash Bang Null Hack</a></dt>
<dt><a name=3D"TOC-6.2.5" class=3D"tocanchor">6.2.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0011EF66">Hash Bang and Setuid</a></dt>
</dl>
</dd><dt><a name=3D"TOC-6.3" class=3D"tocanchor">6.3</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-02C9DD57">Whitespace</a></dt>
<dt><a name=3D"TOC-6.4" class=3D"tocanchor">6.4</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-0005ACF4">Text</a></dt>
<dt><a name=3D"TOC-6.5" class=3D"tocanchor">6.5</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-022D8E2F">Special Characters in Text</a></dt>
<dt><a name=3D"TOC-6.6" class=3D"tocanchor">6.6</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-03D48970">Character Handling and International=
 Characters</a></dt>
<dt><a name=3D"TOC-6.7" class=3D"tocanchor">6.7</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-00AE32C5">Regular Expression Directives</a></d=
t>
<dt><a name=3D"TOC-6.8" class=3D"tocanchor">6.8</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-00F7A1E1">Variables</a></dt>
<dt><a name=3D"TOC-6.9" class=3D"tocanchor">6.9</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-0241B63E">Negative Match</a><a href=3D"http://=
nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0127" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-6.9.1" class=3D"tocanchor">6.9.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01FCFA9B">Variable Followed by Nothing</a>=
</dt>
<dt><a name=3D"TOC-6.9.2" class=3D"tocanchor">6.9.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03777A15">Variable Followed by Text</a></d=
t>
<dt><a name=3D"TOC-6.9.3" class=3D"tocanchor">6.9.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-014ABA83">Variable Followed by a Function =
Call or Directive</a></dt>
<dt><a name=3D"TOC-6.9.4" class=3D"tocanchor">6.9.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01AF08B6">Consecutive Variables</a></dt>
<dt><a name=3D"TOC-6.9.5" class=3D"tocanchor">6.9.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01257C83">Consecutive Variables Via Direct=
ive</a></dt>
<dt><a name=3D"TOC-6.9.6" class=3D"tocanchor">6.9.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-031A997C">Longest Match</a></dt>
</dl>
</dd><dt><a name=3D"TOC-6.10" class=3D"tocanchor">6.10</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-02EBB63E">Positive Match</a></dt>
<dt><a name=3D"TOC-6.11" class=3D"tocanchor">6.11</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-015134D8">Special Symbols <tt>nil</tt> and <=
tt>t</tt></a></dt>
<dt><a name=3D"TOC-6.12" class=3D"tocanchor">6.12</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-030AF1E0">Keyword Symbols</a></dt>
<dt><a name=3D"TOC-6.13" class=3D"tocanchor">6.13</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-00265C5B">Regular Expressions</a></dt>
<dt><a name=3D"TOC-6.14" class=3D"tocanchor">6.14</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-023BD1E6">Compound Expressions</a></dt>
<dt><a name=3D"TOC-6.15" class=3D"tocanchor">6.15</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-029EAE7C">Character Literals</a></dt>
<dt><a name=3D"TOC-6.16" class=3D"tocanchor">6.16</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-026B69E0">String Literals</a></dt>
<dt><a name=3D"TOC-6.17" class=3D"tocanchor">6.17</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03C50723">Word List Literals</a></dt>
<dt><a name=3D"TOC-6.18" class=3D"tocanchor">6.18</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-00E96BCB">String Quasiliterals</a></dt>
<dt><a name=3D"TOC-6.19" class=3D"tocanchor">6.19</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-02E9E83D">Quasiword List Literals</a></dt>
<dt><a name=3D"TOC-6.20" class=3D"tocanchor">6.20</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-01C38CA6">Numbers</a></dt>
<dt><a name=3D"TOC-6.21" class=3D"tocanchor">6.21</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03C6DC72">Comments</a></dt>
</dl>
</dd><dt><a name=3D"TOC-7" class=3D"tocanchor">7</a> <a href=3D"http://nong=
nu.org/txr/txr-manpage.html#N-018A0A19">DIRECTIVES</a><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0128" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.1" class=3D"tocanchor">7.1</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-00C9CE7C">Overview</a></dt>
<dt><a name=3D"TOC-7.2" class=3D"tocanchor">7.2</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-01149CCF">Subexpression Evaluation</a></dt>
<dt><a name=3D"TOC-7.3" class=3D"tocanchor">7.3</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-024CD657">Input Scanning and Data Manipulation=
</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> =
<tt>[+]</tt></a></dt>
<dd><dl id=3D"g0129" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.3.1" class=3D"tocanchor">7.3.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0131C606">The <tt>next</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.2" class=3D"tocanchor">7.3.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-021FCB7C">The <tt>skip</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.3" class=3D"tocanchor">7.3.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01460E2D">Reducing Backtracking with Block=
s</a></dt>
<dt><a name=3D"TOC-7.3.4" class=3D"tocanchor">7.3.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01476441">The <tt>trailer</tt> directive</=
a></dt>
<dt><a name=3D"TOC-7.3.5" class=3D"tocanchor">7.3.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00334C65">The <tt>freeform</tt> directive<=
/a></dt>
<dt><a name=3D"TOC-7.3.6" class=3D"tocanchor">7.3.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03CAE17D">The <tt>fuzz</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.7" class=3D"tocanchor">7.3.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02D5D09D">The <tt>line</tt> and <tt>chr</t=
t> directives</a></dt>
<dt><a name=3D"TOC-7.3.8" class=3D"tocanchor">7.3.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01557906">The <tt>name</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.9" class=3D"tocanchor">7.3.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03B6EA7D">The <tt>data</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.10" class=3D"tocanchor">7.3.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-039458F2">The <tt>some</tt>, <tt>all</tt=
>, <tt>none</tt>, <tt>maybe</tt>, <tt>cases</tt> and <tt>choose</tt> direct=
ives</a></dt>
<dt><a name=3D"TOC-7.3.11" class=3D"tocanchor">7.3.11</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0222EE5F">The <tt>require</tt> directive=
</a></dt>
<dt><a name=3D"TOC-7.3.12" class=3D"tocanchor">7.3.12</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03AE2765">The <tt>if</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.13" class=3D"tocanchor">7.3.13</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DC6E54">The Lisp <tt>if</tt> versus TX=
R <tt>if</tt></a></dt>
<dt><a name=3D"TOC-7.3.14" class=3D"tocanchor">7.3.14</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01410000">The <tt>gather</tt> directive<=
/a></dt>
<dt><a name=3D"TOC-7.3.15" class=3D"tocanchor">7.3.15</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01AADEFA">The <tt>until</tt> / <tt>last<=
/tt> clause in <tt>gather</tt></a></dt>
<dt><a name=3D"TOC-7.3.16" class=3D"tocanchor">7.3.16</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03CE85EA">Keyword parameters in <tt>gath=
er</tt></a></dt>
<dt><a name=3D"TOC-7.3.17" class=3D"tocanchor">7.3.17</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-016E0310">The <tt>collect</tt> directive=
</a></dt>
<dt><a name=3D"TOC-7.3.18" class=3D"tocanchor">7.3.18</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-014CE43D">The <tt>until</tt> / <tt>last<=
/tt> clause in <tt>collect</tt></a></dt>
<dt><a name=3D"TOC-7.3.19" class=3D"tocanchor">7.3.19</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037F7135">Keyword parameters in <tt>coll=
ect</tt></a></dt>
<dt><a name=3D"TOC-7.3.20" class=3D"tocanchor">7.3.20</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-020EDAFF">Specifying variables in <tt>co=
llect</tt></a></dt>
<dt><a name=3D"TOC-7.3.21" class=3D"tocanchor">7.3.21</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-025D542C">Mandatory <tt>until</tt> and <=
tt>last</tt></a></dt>
<dt><a name=3D"TOC-7.3.22" class=3D"tocanchor">7.3.22</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-031B6F7D">The <tt>coll</tt> directive</a=
></dt>
<dt><a name=3D"TOC-7.3.23" class=3D"tocanchor">7.3.23</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0357BB7E">Keyword parameters in <tt>coll=
</tt></a></dt>
<dt><a name=3D"TOC-7.3.24" class=3D"tocanchor">7.3.24</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02BF4BBC">The <tt>flatten</tt> directive=
</a></dt>
<dt><a name=3D"TOC-7.3.25" class=3D"tocanchor">7.3.25</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0252B14E">The <tt>merge</tt> directive</=
a></dt>
<dt><a name=3D"TOC-7.3.26" class=3D"tocanchor">7.3.26</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03336E1B">The <tt>cat</tt> directive</a>=
</dt>
<dt><a name=3D"TOC-7.3.27" class=3D"tocanchor">7.3.27</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02ED877D">The <tt>bind</tt> directive</a=
></dt>
<dt><a name=3D"TOC-7.3.28" class=3D"tocanchor">7.3.28</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00A298C5">Keywords in the <tt>bind</tt> =
directive</a></dt>
<dt><a name=3D"TOC-7.3.29" class=3D"tocanchor">7.3.29</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02572115">Lisp forms in the <tt>bind</tt=
> directive</a></dt>
<dt><a name=3D"TOC-7.3.30" class=3D"tocanchor">7.3.30</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-032AAE1B">The <tt>set</tt> directive</a>=
</dt>
<dt><a name=3D"TOC-7.3.31" class=3D"tocanchor">7.3.31</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019F9FB7">The <tt>rebind</tt> directive<=
/a></dt>
<dt><a name=3D"TOC-7.3.32" class=3D"tocanchor">7.3.32</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02A1EE04">The <tt>forget</tt> directive<=
/a></dt>
<dt><a name=3D"TOC-7.3.33" class=3D"tocanchor">7.3.33</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B66E65">The <tt>do</tt> directive</a><=
/dt>
<dt><a name=3D"TOC-7.3.34" class=3D"tocanchor">7.3.34</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-028DBD1B">The <tt>mdo</tt> directive</a>=
</dt>
<dt><a name=3D"TOC-7.3.35" class=3D"tocanchor">7.3.35</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01617CB2">The <tt>in-package</tt> direct=
ive</a></dt>
</dl>
</dd><dt><a name=3D"TOC-7.4" class=3D"tocanchor">7.4</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-00935A22">Blocks</a><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0130" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.4.1" class=3D"tocanchor">7.4.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01CE7F10">Overview</a></dt>
<dt><a name=3D"TOC-7.4.2" class=3D"tocanchor">7.4.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0298769A">The <tt>block</tt> directive</a>=
</dt>
<dt><a name=3D"TOC-7.4.3" class=3D"tocanchor">7.4.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0167D9C2">Block Scope</a></dt>
<dt><a name=3D"TOC-7.4.4" class=3D"tocanchor">7.4.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0295951F">Block Nesting</a></dt>
<dt><a name=3D"TOC-7.4.5" class=3D"tocanchor">7.4.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02E0775E">Block Semantics</a></dt>
<dt><a name=3D"TOC-7.4.6" class=3D"tocanchor">7.4.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01AC9294">Interaction Between the <tt>trai=
ler</tt> and <tt>accept</tt> Directives</a></dt>
<dt><a name=3D"TOC-7.4.7" class=3D"tocanchor">7.4.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01188822">Interaction Between the <tt>next=
</tt> and <tt>accept</tt> Directives</a></dt>
<dt><a name=3D"TOC-7.4.8" class=3D"tocanchor">7.4.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00B71A20">Interaction Between Functions an=
d the <tt>accept</tt> directive</a></dt>
<dt><a name=3D"TOC-7.4.9" class=3D"tocanchor">7.4.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03054775">Interaction Between <tt>finally<=
/tt> and the <tt>accept</tt> directive</a></dt>
<dt><a name=3D"TOC-7.4.10" class=3D"tocanchor">7.4.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-005E1D6C">Vertical-Horizontal Mismatch B=
etween <tt>block</tt> and <tt>accept</tt></a></dt>
<dt><a name=3D"TOC-7.4.11" class=3D"tocanchor">7.4.11</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02A72FC6">Horizontal-Horizontal Mismatch=
 between <tt>block</tt> and <tt>accept</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-7.5" class=3D"tocanchor">7.5</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-00AAF302">Functions</a><a href=3D"http://=
nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0131" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.5.1" class=3D"tocanchor">7.5.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01CE7F11">Overview</a></dt>
<dt><a name=3D"TOC-7.5.2" class=3D"tocanchor">7.5.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-027D3819">Definition Syntax</a></dt>
<dt><a name=3D"TOC-7.5.3" class=3D"tocanchor">7.5.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02917AC7">Two Forms of The Horizontal Func=
tion</a></dt>
<dt><a name=3D"TOC-7.5.4" class=3D"tocanchor">7.5.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02B006F2">Vertical-Horizontal Overloading<=
/a></dt>
<dt><a name=3D"TOC-7.5.5" class=3D"tocanchor">7.5.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01A1FB11">Call Syntax</a></dt>
<dt><a name=3D"TOC-7.5.6" class=3D"tocanchor">7.5.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-020602B8">Vertical Versus Horizontal Calls=
</a></dt>
<dt><a name=3D"TOC-7.5.7" class=3D"tocanchor">7.5.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03351C8D">Local Variables</a></dt>
<dt><a name=3D"TOC-7.5.8" class=3D"tocanchor">7.5.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-030FDF45">Nested Functions</a></dt>
<dt><a name=3D"TOC-7.5.9" class=3D"tocanchor">7.5.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0375A4EA">Indirect Calls</a></dt>
</dl>
</dd><dt><a name=3D"TOC-7.6" class=3D"tocanchor">7.6</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-0035A666">Modularization</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0132" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.6.1" class=3D"tocanchor">7.6.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01A2ECA0">The <tt>load</tt> and <tt>includ=
e</tt> directives</a></dt>
</dl>
</dd><dt><a name=3D"TOC-7.7" class=3D"tocanchor">7.7</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-016CB7C5">Output</a><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0133" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.7.1" class=3D"tocanchor">7.7.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00798E09">Introduction</a></dt>
<dt><a name=3D"TOC-7.7.2" class=3D"tocanchor">7.7.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0159EBE7">The <tt>output</tt> directive</a=
></dt>
<dt><a name=3D"TOC-7.7.3" class=3D"tocanchor">7.7.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-007B5ECB">Output Text</a></dt>
<dt><a name=3D"TOC-7.7.4" class=3D"tocanchor">7.7.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01C7272E">Output Variables</a></dt>
<dt><a name=3D"TOC-7.7.5" class=3D"tocanchor">7.7.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01F15AE8">Output Variables: Indexing</a></=
dt>
<dt><a name=3D"TOC-7.7.6" class=3D"tocanchor">7.7.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0323B78E">Output Substitutions</a></dt>
<dt><a name=3D"TOC-7.7.7" class=3D"tocanchor">7.7.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00CB3FB7">The <tt>repeat</tt> directive</a=
></dt>
<dt><a name=3D"TOC-7.7.8" class=3D"tocanchor">7.7.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-017CF83A">Nested <tt>repeat</tt> directive=
s</a></dt>
<dt><a name=3D"TOC-7.7.9" class=3D"tocanchor">7.7.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0343AA1B">The <tt>rep</tt> directive</a></=
dt>
<dt><a name=3D"TOC-7.7.10" class=3D"tocanchor">7.7.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00B81F3D"><tt>repeat</tt> and <tt>rep</t=
t> Examples</a></dt>
<dt><a name=3D"TOC-7.7.11" class=3D"tocanchor">7.7.11</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0399709A">The <tt>close</tt> directive</=
a></dt>
<dt><a name=3D"TOC-7.7.12" class=3D"tocanchor">7.7.12</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-011C2741">Output Filtering</a></dt>
<dt><a name=3D"TOC-7.7.13" class=3D"tocanchor">7.7.13</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-029EF765">Function Filters</a></dt>
<dt><a name=3D"TOC-7.7.14" class=3D"tocanchor">7.7.14</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00BDE41F">The <tt>deffilter</tt> directi=
ve</a></dt>
<dt><a name=3D"TOC-7.7.15" class=3D"tocanchor">7.7.15</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00B50006">The <tt>filter</tt> directive<=
/a></dt>
</dl>
</dd><dt><a name=3D"TOC-7.8" class=3D"tocanchor">7.8</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-007C12B4">Exceptions</a><a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0134" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-7.8.1" class=3D"tocanchor">7.8.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-018E0BFC">Introduction</a></dt>
<dt><a name=3D"TOC-7.8.2" class=3D"tocanchor">7.8.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0328371B">The <tt>try</tt> directive</a></=
dt>
<dt><a name=3D"TOC-7.8.3" class=3D"tocanchor">7.8.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0134EBD1">The <tt>finally</tt> clause</a><=
/dt>
<dt><a name=3D"TOC-7.8.4" class=3D"tocanchor">7.8.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-023ADC77"><tt>catch</tt> clauses</a></dt>
<dt><a name=3D"TOC-7.8.5" class=3D"tocanchor">7.8.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-020EA418"><tt>catch</tt> Clauses with Para=
meters</a></dt>
<dt><a name=3D"TOC-7.8.6" class=3D"tocanchor">7.8.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01634260">The <tt>throw</tt> directive</a>=
</dt>
<dt><a name=3D"TOC-7.8.7" class=3D"tocanchor">7.8.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00FFE564">The <tt>defex</tt> directive</a>=
</dt>
<dt><a name=3D"TOC-7.8.8" class=3D"tocanchor">7.8.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0294EF6B">The <tt>assert</tt> directive</a=
></dt>
</dl>
</dd></dl>
</dd><dt><a name=3D"TOC-8" class=3D"tocanchor">8</a> <a href=3D"http://nong=
nu.org/txr/txr-manpage.html#N-01450DA7">TXR LISP</a><a href=3D"http://nongn=
u.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0135" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-8.1" class=3D"tocanchor">8.1</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-01CE7F16">Overview</a></dt>
<dt><a name=3D"TOC-8.2" class=3D"tocanchor">8.2</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-03FB6EC1">Additional Syntax</a><a href=3D"http=
://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></d=
t>
<dd><dl id=3D"g0136" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-8.2.1" class=3D"tocanchor">8.2.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03F5B70D">Symbol Tokens</a></dt>
<dt><a name=3D"TOC-8.2.2" class=3D"tocanchor">8.2.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-007009FB">Package Prefixes</a></dt>
<dt><a name=3D"TOC-8.2.3" class=3D"tocanchor">8.2.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00D2D8A3">Uninterned Symbols</a></dt>
<dt><a name=3D"TOC-8.2.4" class=3D"tocanchor">8.2.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01E5CC56">Meta-Symbols, Meta-Numbers and M=
eta-Expressions</a></dt>
<dt><a name=3D"TOC-8.2.5" class=3D"tocanchor">8.2.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0057E40C">Consing Dot</a></dt>
<dt><a name=3D"TOC-8.2.6" class=3D"tocanchor">8.2.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-013775DB">Referencing Dot</a></dt>
<dt><a name=3D"TOC-8.2.7" class=3D"tocanchor">8.2.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-036AA5E6">Unbound Referencing Dot</a></dt>
<dt><a name=3D"TOC-8.2.8" class=3D"tocanchor">8.2.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01C607FD">Quote and Quasiquote</a></dt>
<dt><a name=3D"TOC-8.2.9" class=3D"tocanchor">8.2.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0364F463">Quasiquoting non-List Objects</a=
></dt>
<dt><a name=3D"TOC-8.2.10" class=3D"tocanchor">8.2.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01377D39">Quasiquoting combined with Qua=
siliterals</a></dt>
<dt><a name=3D"TOC-8.2.11" class=3D"tocanchor">8.2.11</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03501D40">Vector Literals</a></dt>
<dt><a name=3D"TOC-8.2.12" class=3D"tocanchor">8.2.12</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-029325E0">Struct Literals</a></dt>
<dt><a name=3D"TOC-8.2.13" class=3D"tocanchor">8.2.13</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-024EAF03">Hash Literals</a></dt>
<dt><a name=3D"TOC-8.2.14" class=3D"tocanchor">8.2.14</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02BDE2B7">Range Literals</a></dt>
<dt><a name=3D"TOC-8.2.15" class=3D"tocanchor">8.2.15</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01DD9A70">Buffer Literals</a></dt>
<dt><a name=3D"TOC-8.2.16" class=3D"tocanchor">8.2.16</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-002C7012">Tree Node Literals</a></dt>
<dt><a name=3D"TOC-8.2.17" class=3D"tocanchor">8.2.17</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-030F6302">Tree Literals</a></dt>
<dt><a name=3D"TOC-8.2.18" class=3D"tocanchor">8.2.18</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0217A971">The <tt>..</tt> notation</a></=
dt>
<dt><a name=3D"TOC-8.2.19" class=3D"tocanchor">8.2.19</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E5BE4A">The DWIM Brackets</a></dt>
<dt><a name=3D"TOC-8.2.20" class=3D"tocanchor">8.2.20</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DD9E88">Compound Forms</a></dt>
<dt><a name=3D"TOC-8.2.21" class=3D"tocanchor">8.2.21</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-030626A5">Dot Position in Function Calls=
</a></dt>
<dt><a name=3D"TOC-8.2.22" class=3D"tocanchor">8.2.22</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03585CFE">Improper Lists as Macro Calls<=
/a></dt>
<dt><a name=3D"TOC-8.2.23" class=3D"tocanchor">8.2.23</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-003988F9">Regular Expression Literals</a=
></dt>
<dt><a name=3D"TOC-8.2.24" class=3D"tocanchor">8.2.24</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01BB4378">Notation for Circular and Shar=
ed Structure</a></dt>
<dt><a name=3D"TOC-8.2.25" class=3D"tocanchor">8.2.25</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E46A67">Notation for Erasing Objects</=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-8.3" class=3D"tocanchor">8.3</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-025B2358">Generalization of List Accessor=
s</a></dt>
<dt><a name=3D"TOC-8.4" class=3D"tocanchor">8.4</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-0204FDAC">Generalization of Iteration</a></dt>
<dt><a name=3D"TOC-8.5" class=3D"tocanchor">8.5</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-021B2981">Callable Objects</a></dt>
<dt><a name=3D"TOC-8.6" class=3D"tocanchor">8.6</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-03B076F9">Special Variables</a></dt>
<dt><a name=3D"TOC-8.7" class=3D"tocanchor">8.7</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-015596F7">Syntactic Places and Accessors</a><a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+=
]</tt></a></dt>
<dd><dl id=3D"g0137" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-8.7.1" class=3D"tocanchor">8.7.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-024FE946">Symbolic Places</a></dt>
<dt><a name=3D"TOC-8.7.2" class=3D"tocanchor">8.7.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0278265C">Compound Places</a></dt>
<dt><a name=3D"TOC-8.7.3" class=3D"tocanchor">8.7.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02D99C45">Accessor Functions</a></dt>
<dt><a name=3D"TOC-8.7.4" class=3D"tocanchor">8.7.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02909D48">Macro Call Syntactic Places</a><=
/dt>
<dt><a name=3D"TOC-8.7.5" class=3D"tocanchor">8.7.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0062C823">User-Defined Syntactic Places an=
d Place Operators</a></dt>
<dt><a name=3D"TOC-8.7.6" class=3D"tocanchor">8.7.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-008BEEA3">Deletable Places</a></dt>
<dt><a name=3D"TOC-8.7.7" class=3D"tocanchor">8.7.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01C2A7EC">Evaluation of Places</a></dt>
<dt><a name=3D"TOC-8.7.8" class=3D"tocanchor">8.7.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02A51FFD">Nested Places</a></dt>
<dt><a name=3D"TOC-8.7.9" class=3D"tocanchor">8.7.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-031BD7AD">Built-In Syntactic Places</a></d=
t>
<dt><a name=3D"TOC-8.7.10" class=3D"tocanchor">8.7.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-014ADCC0">Built-In Place-Mutating Operat=
ors</a></dt>
</dl>
</dd><dt><a name=3D"TOC-8.8" class=3D"tocanchor">8.8</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-018617C6">Namespaces and Environments</a>=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>=
[+]</tt></a></dt>
<dd><dl id=3D"g0138" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-8.8.1" class=3D"tocanchor">8.8.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03A72D00">Global Functions and Operator Ma=
cros</a></dt>
<dt><a name=3D"TOC-8.8.2" class=3D"tocanchor">8.8.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03910FBD">Global and Dynamic Variables</a>=
</dt>
<dt><a name=3D"TOC-8.8.3" class=3D"tocanchor">8.8.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00E3CDD1">Global Symbol Macros</a></dt>
<dt><a name=3D"TOC-8.8.4" class=3D"tocanchor">8.8.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0284CA29">Lexical Environments</a></dt>
<dt><a name=3D"TOC-8.8.5" class=3D"tocanchor">8.8.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-031BE3BA">Pattern Language and Lisp Scope =
Nesting</a></dt>
</dl>
</dd></dl>
</dd><dt><a name=3D"TOC-9" class=3D"tocanchor">9</a> <a href=3D"http://nong=
nu.org/txr/txr-manpage.html#N-015965C2">LISP OPERATOR, FUNCTION AND MACRO R=
EFERENCE</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"t=
oggle"> <tt>[-]</tt></a></dt>
<dd><dl id=3D"g0139" class=3D"tocsec" style=3D"">
<dt><a name=3D"TOC-9.1" class=3D"tocanchor">9.1</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-006C6D00">Conventions</a></dt>
<dt><a name=3D"TOC-9.2" class=3D"tocanchor">9.2</a> <a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-01D3CD75">Form Evaluation</a><a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[-]</tt></a></dt>
<dd><dl id=3D"g0140" class=3D"tocsec" style=3D"">
<dt><a name=3D"TOC-9.2.1" class=3D"tocanchor">9.2.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0163F998">Operator <tt>quote</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.3" class=3D"tocanchor">9.3</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-03A7361E">Variable Binding</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[-]</tt></a=
></dt>
<dd><dl id=3D"g0141" class=3D"tocsec" style=3D"">
<dt><a name=3D"TOC-9.3.1" class=3D"tocanchor">9.3.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-039DD0E7">Operator <tt>defvar</tt> and mac=
ro <tt>defparm</tt></a></dt>
<dt><a name=3D"TOC-9.3.2" class=3D"tocanchor">9.3.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03F36A75">Macros <tt>defvarl</tt> and <tt>=
defparml</tt></a></dt>
<dt><a name=3D"TOC-9.3.3" class=3D"tocanchor">9.3.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-013AF20B">Operators <tt>let</tt> and <tt>l=
et*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.4" class=3D"tocanchor">9.4</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-02F30528">Functions</a><a href=3D"http://=
nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0142" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.4.1" class=3D"tocanchor">9.4.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00B44934">Operator <tt>defun</tt></a></dt>
<dt><a name=3D"TOC-9.4.2" class=3D"tocanchor">9.4.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00FAFD10">Operator <tt>lambda</tt></a></dt=
>
<dt><a name=3D"TOC-9.4.3" class=3D"tocanchor">9.4.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0209307D">Macros <tt>flet</tt> and <tt>lab=
els</tt></a></dt>
<dt><a name=3D"TOC-9.4.4" class=3D"tocanchor">9.4.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0386C775">Function <tt>call</tt></a></dt>
<dt><a name=3D"TOC-9.4.5" class=3D"tocanchor">9.4.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-026C3723">Functions <tt>apply</tt> and <tt=
>iapply</tt></a></dt>
<dt><a name=3D"TOC-9.4.6" class=3D"tocanchor">9.4.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-006E109C">Operator <tt>fun</tt></a></dt>
<dt><a name=3D"TOC-9.4.7" class=3D"tocanchor">9.4.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02DC9E04">Operator <tt>dwim</tt></a></dt>
<dt><a name=3D"TOC-9.4.8" class=3D"tocanchor">9.4.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00F6F5F8">Function <tt>functionp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.4.9" class=3D"tocanchor">9.4.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-003E7671">Function <tt>copy-fun</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.5" class=3D"tocanchor">9.5</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-014DC8B2">Sequencing, Selection and Itera=
tion</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggl=
e"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0143" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.5.1" class=3D"tocanchor">9.5.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03F7A8B8">Operators/functions <tt>progn</t=
t> and <tt>prog1</tt></a></dt>
<dt><a name=3D"TOC-9.5.2" class=3D"tocanchor">9.5.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03A0E48C">Macro/function <tt>prog2</tt></a=
></dt>
<dt><a name=3D"TOC-9.5.3" class=3D"tocanchor">9.5.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-016C9E24">Operator <tt>cond</tt></a></dt>
<dt><a name=3D"TOC-9.5.4" class=3D"tocanchor">9.5.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-017EB9A1">Macros <tt>caseq</tt>, <tt>caseq=
l</tt> and <tt>casequal</tt></a></dt>
<dt><a name=3D"TOC-9.5.5" class=3D"tocanchor">9.5.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02FB71A2">Macros <tt>caseq*</tt>, <tt>case=
ql*</tt> and <tt>casequal*</tt></a></dt>
<dt><a name=3D"TOC-9.5.6" class=3D"tocanchor">9.5.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03B4E3A4">Operator/function <tt>if</tt></a=
></dt>
<dt><a name=3D"TOC-9.5.7" class=3D"tocanchor">9.5.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02D7EEB3">Operator/function <tt>and</tt></=
a></dt>
<dt><a name=3D"TOC-9.5.8" class=3D"tocanchor">9.5.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02F4E3A4">Operator/function <tt>or</tt></a=
></dt>
<dt><a name=3D"TOC-9.5.9" class=3D"tocanchor">9.5.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-017EFAB6">Macros <tt>when</tt> and <tt>unl=
ess</tt></a></dt>
<dt><a name=3D"TOC-9.5.10" class=3D"tocanchor">9.5.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01026F48">Macros <tt>while</tt> and <tt>=
until</tt></a></dt>
<dt><a name=3D"TOC-9.5.11" class=3D"tocanchor">9.5.11</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01F7BF0B">Macros <tt>while*</tt> and <tt=
>until*</tt></a></dt>
<dt><a name=3D"TOC-9.5.12" class=3D"tocanchor">9.5.12</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0154DC75">Macro <tt>whilet</tt></a></dt>
<dt><a name=3D"TOC-9.5.13" class=3D"tocanchor">9.5.13</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02DA21F6">Macros <tt>iflet</tt> and <tt>=
whenlet</tt></a></dt>
<dt><a name=3D"TOC-9.5.14" class=3D"tocanchor">9.5.14</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03272DC8">Macro <tt>condlet</tt></a></dt=
>
<dt><a name=3D"TOC-9.5.15" class=3D"tocanchor">9.5.15</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018F39B0">Macro <tt>ifa</tt></a></dt>
<dt><a name=3D"TOC-9.5.16" class=3D"tocanchor">9.5.16</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-025CC33C">Macro <tt>conda</tt></a></dt>
<dt><a name=3D"TOC-9.5.17" class=3D"tocanchor">9.5.17</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-005C93DF">Macro <tt>whena</tt></a></dt>
<dt><a name=3D"TOC-9.5.18" class=3D"tocanchor">9.5.18</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D31F8C">Macro <tt>dotimes</tt></a></dt=
>
<dt><a name=3D"TOC-9.5.19" class=3D"tocanchor">9.5.19</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0105F01D">Operators <tt>each</tt>, <tt>e=
ach*</tt>, <tt>collect-each</tt>, <tt>collect-each*</tt>, <tt>append-each</=
tt> and <tt>append-each*</tt></a></dt>
<dt><a name=3D"TOC-9.5.20" class=3D"tocanchor">9.5.20</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-031372ED">Operators <tt>for</tt> and <tt=
>for*</tt></a></dt>
<dt><a name=3D"TOC-9.5.21" class=3D"tocanchor">9.5.21</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01FF4DDB">Macros <tt>doloop</tt> and <tt=
>doloop*</tt></a></dt>
<dt><a name=3D"TOC-9.5.22" class=3D"tocanchor">9.5.22</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02CA3C70">Macros <tt>each-prod</tt>, <tt=
>collect-each-prod</tt> and <tt>append-each-prod</tt></a></dt>
<dt><a name=3D"TOC-9.5.23" class=3D"tocanchor">9.5.23</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02660E4F">Macros <tt>each-prod*</tt>, <t=
t>collect-each-prod*</tt> and <tt>append-each-prod*</tt></a></dt>
<dt><a name=3D"TOC-9.5.24" class=3D"tocanchor">9.5.24</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02F60DCE">Operators <tt>block</tt> and <=
tt>block*</tt></a></dt>
<dt><a name=3D"TOC-9.5.25" class=3D"tocanchor">9.5.25</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03E500DF">Operators <tt>return</tt> and =
<tt>return-from</tt></a></dt>
<dt><a name=3D"TOC-9.5.26" class=3D"tocanchor">9.5.26</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0309887F">Function <tt>return*</tt></a><=
/dt>
<dt><a name=3D"TOC-9.5.27" class=3D"tocanchor">9.5.27</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-007E0D96">Macros <tt>tagbody</tt> and <t=
t>go</tt></a></dt>
<dt><a name=3D"TOC-9.5.28" class=3D"tocanchor">9.5.28</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018A4BA9">Macros <tt>prog</tt> and <tt>p=
rog*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.6" class=3D"tocanchor">9.6</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-03B7E13E">Evaluation</a><a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0144" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.6.1" class=3D"tocanchor">9.6.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0286C8B8">Function <tt>eval</tt></a></dt>
<dt><a name=3D"TOC-9.6.2" class=3D"tocanchor">9.6.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0172F00A">Function <tt>constantp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.6.3" class=3D"tocanchor">9.6.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01144687">Function <tt>make-env</tt></a></=
dt>
<dt><a name=3D"TOC-9.6.4" class=3D"tocanchor">9.6.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03389BE3">Functions <tt>env-vbind</tt> and=
 <tt>env-fbind</tt></a></dt>
<dt><a name=3D"TOC-9.6.5" class=3D"tocanchor">9.6.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0018DCDC">Functions <tt>env-vbindings</tt>=
, <tt>env-fbindings</tt> and <tt>env-next</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.7" class=3D"tocanchor">9.7</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-0384A294">Global Environment</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0145" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.7.1" class=3D"tocanchor">9.7.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00004DDC">Accessors <tt>symbol-function</t=
t>, <tt>symbol-macro</tt> and <tt>symbol-value</tt></a></dt>
<dt><a name=3D"TOC-9.7.2" class=3D"tocanchor">9.7.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01FBF828">Functions <tt>boundp</tt>, <tt>f=
boundp</tt> and <tt>mboundp</tt></a></dt>
<dt><a name=3D"TOC-9.7.3" class=3D"tocanchor">9.7.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01FA4070">Function <tt>makunbound</tt></a>=
</dt>
<dt><a name=3D"TOC-9.7.4" class=3D"tocanchor">9.7.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02964FC0">Functions <tt>fmakunbound</tt> a=
nd <tt>mmakunbound</tt></a></dt>
<dt><a name=3D"TOC-9.7.5" class=3D"tocanchor">9.7.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00722170">Function <tt>func-get-form</tt><=
/a></dt>
<dt><a name=3D"TOC-9.7.6" class=3D"tocanchor">9.7.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03F222DA">Function <tt>func-get-name</tt><=
/a></dt>
<dt><a name=3D"TOC-9.7.7" class=3D"tocanchor">9.7.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-009538DB">Function <tt>func-get-env</tt></=
a></dt>
<dt><a name=3D"TOC-9.7.8" class=3D"tocanchor">9.7.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-015852B6">Functions <tt>fun-fixparam-count=
</tt> and <tt>fun-optparam-count</tt></a></dt>
<dt><a name=3D"TOC-9.7.9" class=3D"tocanchor">9.7.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02AA3799">Function <tt>fun-variadic</tt></=
a></dt>
<dt><a name=3D"TOC-9.7.10" class=3D"tocanchor">9.7.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00AC0CF7">Function <tt>interp-fun-p</tt>=
</a></dt>
<dt><a name=3D"TOC-9.7.11" class=3D"tocanchor">9.7.11</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00B99FC5">Function <tt>vm-fun-p</tt></a>=
</dt>
<dt><a name=3D"TOC-9.7.12" class=3D"tocanchor">9.7.12</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00833473">Function <tt>special-var-p</tt=
></a></dt>
<dt><a name=3D"TOC-9.7.13" class=3D"tocanchor">9.7.13</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01E259AD">Function <tt>special-operator-=
p</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.8" class=3D"tocanchor">9.8</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-027AA48B">Object Type</a><a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt=
>
<dd><dl id=3D"g0146" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.8.1" class=3D"tocanchor">9.8.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01F81275">Function <tt>typeof</tt></a></dt=
>
<dt><a name=3D"TOC-9.8.2" class=3D"tocanchor">9.8.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00699D3B">Function <tt>subtypep</tt></a></=
dt>
<dt><a name=3D"TOC-9.8.3" class=3D"tocanchor">9.8.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03B8D9EE">Function <tt>typep</tt></a></dt>
<dt><a name=3D"TOC-9.8.4" class=3D"tocanchor">9.8.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0384D122">Macro <tt>typecase</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.9" class=3D"tocanchor">9.9</a> <a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-026153A8">Object Equivalence</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0147" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.9.1" class=3D"tocanchor">9.9.1</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0137D341">Functions <tt>identity</tt>, <tt=
>identity</tt> and <tt>use</tt></a></dt>
<dt><a name=3D"TOC-9.9.2" class=3D"tocanchor">9.9.2</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03C679D2">Functions <tt>null</tt>, <tt>not=
</tt> and <tt>false</tt></a></dt>
<dt><a name=3D"TOC-9.9.3" class=3D"tocanchor">9.9.3</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00373D97">Functions <tt>true</tt> and <tt>=
have</tt></a></dt>
<dt><a name=3D"TOC-9.9.4" class=3D"tocanchor">9.9.4</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02550B35">Functions <tt>eq</tt>, <tt>eql</=
tt> and <tt>equal</tt></a></dt>
<dt><a name=3D"TOC-9.9.5" class=3D"tocanchor">9.9.5</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0216A942">Functions <tt>neq</tt>, <tt>neql=
</tt> and <tt>nequal</tt></a></dt>
<dt><a name=3D"TOC-9.9.6" class=3D"tocanchor">9.9.6</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-020A0042">Functions <tt>meq</tt>, <tt>meql=
</tt> and <tt>mequal</tt></a></dt>
<dt><a name=3D"TOC-9.9.7" class=3D"tocanchor">9.9.7</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01D6CEA1">Function <tt>less</tt></a></dt>
<dt><a name=3D"TOC-9.9.8" class=3D"tocanchor">9.9.8</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02AC1F73">Function <tt>greater</tt></a></d=
t>
<dt><a name=3D"TOC-9.9.9" class=3D"tocanchor">9.9.9</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-00A3E42D">Functions <tt>lequal</tt> and <t=
t>gequal</tt></a></dt>
<dt><a name=3D"TOC-9.9.10" class=3D"tocanchor">9.9.10</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0036CED9">Function <tt>copy</tt></a></dt=
>
</dl>
</dd><dt><a name=3D"TOC-9.10" class=3D"tocanchor">9.10</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-02F3139A">List Manipulation</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0148" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.10.1" class=3D"tocanchor">9.10.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D6CEDA">Function <tt>cons</tt></a></dt=
>
<dt><a name=3D"TOC-9.10.2" class=3D"tocanchor">9.10.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0076C7BE">Function <tt>atom</tt></a></dt=
>
<dt><a name=3D"TOC-9.10.3" class=3D"tocanchor">9.10.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B94132">Function <tt>consp</tt></a></d=
t>
<dt><a name=3D"TOC-9.10.4" class=3D"tocanchor">9.10.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D60463">Accessors <tt>car</tt> and <tt=
>first</tt></a></dt>
<dt><a name=3D"TOC-9.10.5" class=3D"tocanchor">9.10.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02288559">Accessors <tt>cdr</tt> and <tt=
>rest</tt></a></dt>
<dt><a name=3D"TOC-9.10.6" class=3D"tocanchor">9.10.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0276905F">Functions <tt>rplaca</tt> and =
<tt>rplacd</tt></a></dt>
<dt><a name=3D"TOC-9.10.7" class=3D"tocanchor">9.10.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B0FA33">Accessors <tt>second</tt>, <tt=
>third</tt>, <tt>fourth</tt>, <tt>fifth</tt>, <tt>sixth</tt>, <tt>seventh</=
tt>, <tt>eighth</tt>, <tt>ninth</tt> and <tt>tenth</tt></a></dt>
<dt><a name=3D"TOC-9.10.8" class=3D"tocanchor">9.10.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0014162F">Functions <tt>append</tt> and =
<tt>nconc</tt></a></dt>
<dt><a name=3D"TOC-9.10.9" class=3D"tocanchor">9.10.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01143C2A">Function <tt>append*</tt></a><=
/dt>
<dt><a name=3D"TOC-9.10.10" class=3D"tocanchor">9.10.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012FF2DC">Functions <tt>revappend</tt>=
 and <tt>nreconc</tt></a></dt>
<dt><a name=3D"TOC-9.10.11" class=3D"tocanchor">9.10.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0206CE91">Function <tt>list</tt></a></=
dt>
<dt><a name=3D"TOC-9.10.12" class=3D"tocanchor">9.10.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03593DE9">Function <tt>list*</tt></a><=
/dt>
<dt><a name=3D"TOC-9.10.13" class=3D"tocanchor">9.10.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-038E3E1D">Accessor <tt>sub-list</tt></=
a></dt>
<dt><a name=3D"TOC-9.10.14" class=3D"tocanchor">9.10.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E43DA2">Function <tt>replace-list</t=
t></a></dt>
<dt><a name=3D"TOC-9.10.15" class=3D"tocanchor">9.10.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03F70343">Functions <tt>listp</tt> and=
 <tt>proper-list-p</tt></a></dt>
<dt><a name=3D"TOC-9.10.16" class=3D"tocanchor">9.10.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C6C858">Function <tt>endp</tt></a></=
dt>
<dt><a name=3D"TOC-9.10.17" class=3D"tocanchor">9.10.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01F8186A">Function <tt>length-list</tt=
></a></dt>
<dt><a name=3D"TOC-9.10.18" class=3D"tocanchor">9.10.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-006ED237">Function <tt>copy-list</tt><=
/a></dt>
<dt><a name=3D"TOC-9.10.19" class=3D"tocanchor">9.10.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-037EBB77">Function <tt>copy-cons</tt><=
/a></dt>
<dt><a name=3D"TOC-9.10.20" class=3D"tocanchor">9.10.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015EB85E">Function <tt>copy-tree</tt><=
/a></dt>
<dt><a name=3D"TOC-9.10.21" class=3D"tocanchor">9.10.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D8471B">Functions <tt>reverse</tt> a=
nd <tt>nreverse</tt></a></dt>
<dt><a name=3D"TOC-9.10.22" class=3D"tocanchor">9.10.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02FC66FA">Accessor <tt>nthlast</tt></a=
></dt>
<dt><a name=3D"TOC-9.10.23" class=3D"tocanchor">9.10.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E2C334">Accessor <tt>butlastn</tt></=
a></dt>
<dt><a name=3D"TOC-9.10.24" class=3D"tocanchor">9.10.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0039F3FB">Accessor <tt>nth</tt></a></d=
t>
<dt><a name=3D"TOC-9.10.25" class=3D"tocanchor">9.10.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D71D22">Accessor <tt>nthcdr</tt></a>=
</dt>
<dt><a name=3D"TOC-9.10.26" class=3D"tocanchor">9.10.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B8D7B5">Function <tt>tailp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.10.27" class=3D"tocanchor">9.10.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00209CEE">Accessors <tt>caar</tt>, <tt=
>cadr</tt>, <tt>cdar</tt>, <tt>cddr</tt>, <tt>...</tt> and <tt>cdddddr</tt>=
</a></dt>
<dt><a name=3D"TOC-9.10.28" class=3D"tocanchor">9.10.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0226672B">Functions <tt>flatten</tt> a=
nd <tt>flatten*</tt></a></dt>
<dt><a name=3D"TOC-9.10.29" class=3D"tocanchor">9.10.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01FF2F12">Functions <tt>flatcar</tt> a=
nd <tt>flatcar*</tt></a></dt>
<dt><a name=3D"TOC-9.10.30" class=3D"tocanchor">9.10.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0149BC05">Function <tt>tree-find</tt><=
/a></dt>
<dt><a name=3D"TOC-9.10.31" class=3D"tocanchor">9.10.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0387CD82">Functions <tt>memq</tt>, <tt=
>memql</tt> and <tt>memqual</tt></a></dt>
<dt><a name=3D"TOC-9.10.32" class=3D"tocanchor">9.10.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0176FBE7">Functions <tt>member</tt> an=
d <tt>member-if</tt></a></dt>
<dt><a name=3D"TOC-9.10.33" class=3D"tocanchor">9.10.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0188A56C">Functions <tt>rmemq</tt>, <t=
t>rmemql</tt>, <tt>rmemqual</tt>, <tt>rmember</tt> and <tt>rmember-if</tt><=
/a></dt>
<dt><a name=3D"TOC-9.10.34" class=3D"tocanchor">9.10.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BBCCAA">Functions <tt>conses</tt> an=
d <tt>conses*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.11" class=3D"tocanchor">9.11</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-02BC98A1">Association Lists</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0149" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.11.1" class=3D"tocanchor">9.11.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E9306D">Function <tt>assoc</tt></a></d=
t>
<dt><a name=3D"TOC-9.11.2" class=3D"tocanchor">9.11.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00123702">Functions <tt>assq</tt> and <t=
t>assql</tt></a></dt>
<dt><a name=3D"TOC-9.11.3" class=3D"tocanchor">9.11.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B49598">Functions <tt>rassq</tt>, <tt>=
rassql</tt> and <tt>rassoc</tt></a></dt>
<dt><a name=3D"TOC-9.11.4" class=3D"tocanchor">9.11.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E9343D">Function <tt>acons</tt></a></d=
t>
<dt><a name=3D"TOC-9.11.5" class=3D"tocanchor">9.11.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0371BAFA">Function <tt>acons-new</tt></a=
></dt>
<dt><a name=3D"TOC-9.11.6" class=3D"tocanchor">9.11.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01E315BD">Function <tt>aconsql-new</tt><=
/a></dt>
<dt><a name=3D"TOC-9.11.7" class=3D"tocanchor">9.11.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-001A53C4">Function <tt>alist-remove</tt>=
</a></dt>
<dt><a name=3D"TOC-9.11.8" class=3D"tocanchor">9.11.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-000CD07F">Function <tt>alist-nremove</tt=
></a></dt>
<dt><a name=3D"TOC-9.11.9" class=3D"tocanchor">9.11.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037A7464">Function <tt>copy-alist</tt></=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.12" class=3D"tocanchor">9.12</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-019B9951">Property Lists</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a=
></dt>
<dd><dl id=3D"g0150" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.12.1" class=3D"tocanchor">9.12.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01C6D406">Function <tt>prop</tt></a></dt=
>
<dt><a name=3D"TOC-9.12.2" class=3D"tocanchor">9.12.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03C6CE65">Function <tt>memp</tt></a></dt=
>
<dt><a name=3D"TOC-9.12.3" class=3D"tocanchor">9.12.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006E31B5">Functions <tt>plist-to-alist</=
tt> and <tt>improper-plist-to-alist</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.13" class=3D"tocanchor">9.13</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0135C6D1">List Sorting</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0151" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.13.1" class=3D"tocanchor">9.13.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01093AE7">Function <tt>merge</tt></a></d=
t>
<dt><a name=3D"TOC-9.13.2" class=3D"tocanchor">9.13.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0132852F">Function <tt>multi-sort</tt></=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.14" class=3D"tocanchor">9.14</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01F26AB7">Lazy Lists and Lazy Evaluatio=
n</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle">=
 <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0152" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.14.1" class=3D"tocanchor">9.14.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-038B9EC2">Function <tt>make-lazy-cons</t=
t></a></dt>
<dt><a name=3D"TOC-9.14.2" class=3D"tocanchor">9.14.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E217A2">Function <tt>lconsp</tt></a></=
dt>
<dt><a name=3D"TOC-9.14.3" class=3D"tocanchor">9.14.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E1BA6F">Function <tt>lcons-fun</tt></a=
></dt>
<dt><a name=3D"TOC-9.14.4" class=3D"tocanchor">9.14.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03598F4D">Functions <tt>lcons-car</tt> a=
nd <tt>lcons-cdr</tt></a></dt>
<dt><a name=3D"TOC-9.14.5" class=3D"tocanchor">9.14.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-013CC637">Macro <tt>lcons</tt></a></dt>
<dt><a name=3D"TOC-9.14.6" class=3D"tocanchor">9.14.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00B65D06">Functions <tt>lazy-stream-cons=
</tt> and <tt>get-lines</tt></a></dt>
<dt><a name=3D"TOC-9.14.7" class=3D"tocanchor">9.14.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00DCE524">Macro <tt>delay</tt></a></dt>
<dt><a name=3D"TOC-9.14.8" class=3D"tocanchor">9.14.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0307223D">Accessor <tt>force</tt></a></d=
t>
<dt><a name=3D"TOC-9.14.9" class=3D"tocanchor">9.14.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00C7553F">Function <tt>promisep</tt></a>=
</dt>
<dt><a name=3D"TOC-9.14.10" class=3D"tocanchor">9.14.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-008216E0">Macro <tt>mlet</tt></a></dt>
<dt><a name=3D"TOC-9.14.11" class=3D"tocanchor">9.14.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02F671F4">Functions <tt>generate</tt>,=
 <tt>giterate</tt> and <tt>ginterate</tt></a></dt>
<dt><a name=3D"TOC-9.14.12" class=3D"tocanchor">9.14.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023B6B64">Function <tt>expand-right</t=
t></a></dt>
<dt><a name=3D"TOC-9.14.13" class=3D"tocanchor">9.14.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E168FE">Functions <tt>expand-left</t=
t> and <tt>nexpand-left</tt></a></dt>
<dt><a name=3D"TOC-9.14.14" class=3D"tocanchor">9.14.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011DC272">Function <tt>repeat</tt></a>=
</dt>
<dt><a name=3D"TOC-9.14.15" class=3D"tocanchor">9.14.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0247F5FA">Function <tt>pad</tt></a></d=
t>
<dt><a name=3D"TOC-9.14.16" class=3D"tocanchor">9.14.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0208F32F">Function <tt>weave</tt></a><=
/dt>
<dt><a name=3D"TOC-9.14.17" class=3D"tocanchor">9.14.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0323BEBD">Macros <tt>gen</tt> and <tt>=
gun</tt></a></dt>
<dt><a name=3D"TOC-9.14.18" class=3D"tocanchor">9.14.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-033BE5A1">Functions <tt>range</tt> and=
 <tt>range*</tt></a></dt>
<dt><a name=3D"TOC-9.14.19" class=3D"tocanchor">9.14.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02FD60D0">Functions <tt>rlist</tt> and=
 <tt>rlist*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.15" class=3D"tocanchor">9.15</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01884DC2">Ranges</a><a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0153" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.15.1" class=3D"tocanchor">9.15.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E9003D">Function <tt>rcons</tt></a></d=
t>
<dt><a name=3D"TOC-9.15.2" class=3D"tocanchor">9.15.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00DDB00B">Function <tt>rangep</tt></a></=
dt>
<dt><a name=3D"TOC-9.15.3" class=3D"tocanchor">9.15.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00AED1A7">Functions <tt>from</tt> and <t=
t>to</tt></a></dt>
<dt><a name=3D"TOC-9.15.4" class=3D"tocanchor">9.15.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02C56FB6">Functions <tt>in-range</tt> an=
d <tt>in-range*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.16" class=3D"tocanchor">9.16</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-031A46B6">Characters and Strings</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0154" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.16.1" class=3D"tocanchor">9.16.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033DD796">Function <tt>mkstring</tt></a>=
</dt>
<dt><a name=3D"TOC-9.16.2" class=3D"tocanchor">9.16.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FE763D">Function <tt>copy-str</tt></a>=
</dt>
<dt><a name=3D"TOC-9.16.3" class=3D"tocanchor">9.16.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-029EEA82">Function <tt>upcase-str</tt></=
a></dt>
<dt><a name=3D"TOC-9.16.4" class=3D"tocanchor">9.16.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DA541E">Function <tt>downcase-str</tt>=
</a></dt>
<dt><a name=3D"TOC-9.16.5" class=3D"tocanchor">9.16.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D5358A">Function <tt>string-extend</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.6" class=3D"tocanchor">9.16.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00BB392B">Function <tt>stringp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.16.7" class=3D"tocanchor">9.16.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03E6D841">Function <tt>length-str</tt></=
a></dt>
<dt><a name=3D"TOC-9.16.8" class=3D"tocanchor">9.16.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0167F423">Function <tt>coded-length</tt>=
</a></dt>
<dt><a name=3D"TOC-9.16.9" class=3D"tocanchor">9.16.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0257180F">Function <tt>search-str</tt></=
a></dt>
<dt><a name=3D"TOC-9.16.10" class=3D"tocanchor">9.16.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02783DAA">Function <tt>search-str-tree=
</tt></a></dt>
<dt><a name=3D"TOC-9.16.11" class=3D"tocanchor">9.16.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03FF771E">Function <tt>match-str</tt><=
/a></dt>
<dt><a name=3D"TOC-9.16.12" class=3D"tocanchor">9.16.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01859E7F">Function <tt>match-str-tree<=
/tt></a></dt>
<dt><a name=3D"TOC-9.16.13" class=3D"tocanchor">9.16.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">Accessor <tt>sub-str</tt></a=
></dt>
<dt><a name=3D"TOC-9.16.14" class=3D"tocanchor">9.16.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02059F0A">Function <tt>replace-str</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.15" class=3D"tocanchor">9.16.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">Functions <tt>cat-str</tt>, =
<tt>join-with</tt> and <tt>join</tt></a></dt>
<dt><a name=3D"TOC-9.16.16" class=3D"tocanchor">9.16.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000386B4">Function <tt>split-str</tt><=
/a></dt>
<dt><a name=3D"TOC-9.16.17" class=3D"tocanchor">9.16.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C7F5FA">Function <tt>spl</tt></a></d=
t>
<dt><a name=3D"TOC-9.16.18" class=3D"tocanchor">9.16.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0296195B">Functions <tt>split-str-set<=
/tt> and <tt>sspl</tt></a></dt>
<dt><a name=3D"TOC-9.16.19" class=3D"tocanchor">9.16.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0225F28F">Functions <tt>tok-str</tt> a=
nd <tt>tok-where</tt></a></dt>
<dt><a name=3D"TOC-9.16.20" class=3D"tocanchor">9.16.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0117F60C">Function <tt>tok</tt></a></d=
t>
<dt><a name=3D"TOC-9.16.21" class=3D"tocanchor">9.16.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0236023D">Function <tt>list-str</tt></=
a></dt>
<dt><a name=3D"TOC-9.16.22" class=3D"tocanchor">9.16.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E6E63B">Function <tt>trim-str</tt></=
a></dt>
<dt><a name=3D"TOC-9.16.23" class=3D"tocanchor">9.16.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C6CEED">Function <tt>chrp</tt></a></=
dt>
<dt><a name=3D"TOC-9.16.24" class=3D"tocanchor">9.16.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01B18DF0">Function <tt>chr-isalnum</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.25" class=3D"tocanchor">9.16.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F18E1B">Function <tt>chr-isalpha</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.26" class=3D"tocanchor">9.16.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0171941F">Function <tt>chr-isascii</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.27" class=3D"tocanchor">9.16.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02A1A5A8">Function <tt>chr-iscntrl</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.28" class=3D"tocanchor">9.16.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01ED5020">Functions <tt>chr-isdigit</t=
t> and <tt>chr-digit</tt></a></dt>
<dt><a name=3D"TOC-9.16.29" class=3D"tocanchor">9.16.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00617BD5">Function <tt>chr-isgraph</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.30" class=3D"tocanchor">9.16.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02BB58D0">Function <tt>chr-islower</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.31" class=3D"tocanchor">9.16.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-001B5076">Function <tt>chr-isprint</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.32" class=3D"tocanchor">9.16.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011B4F35">Function <tt>chr-ispunct</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.33" class=3D"tocanchor">9.16.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002B4C59">Function <tt>chr-isspace</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.34" class=3D"tocanchor">9.16.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0251A159">Function <tt>chr-isblank</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.35" class=3D"tocanchor">9.16.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00DB3D75">Function <tt>chr-isunisp</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.36" class=3D"tocanchor">9.16.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02BB451C">Function <tt>chr-isupper</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.37" class=3D"tocanchor">9.16.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-021C89F4">Functions <tt>chr-isxdigit</=
tt> and <tt>chr-xdigit</tt></a></dt>
<dt><a name=3D"TOC-9.16.38" class=3D"tocanchor">9.16.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015A451C">Function <tt>chr-toupper</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.39" class=3D"tocanchor">9.16.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015A58D0">Function <tt>chr-tolower</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.40" class=3D"tocanchor">9.16.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000AEC8B">Functions <tt>int-chr</tt> a=
nd <tt>chr-int</tt></a></dt>
<dt><a name=3D"TOC-9.16.41" class=3D"tocanchor">9.16.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0378FEF2">Accessor <tt>chr-str</tt></a=
></dt>
<dt><a name=3D"TOC-9.16.42" class=3D"tocanchor">9.16.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01743140">Function <tt>chr-str-set</tt=
></a></dt>
<dt><a name=3D"TOC-9.16.43" class=3D"tocanchor">9.16.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0394CA3A">Function <tt>span-str</tt></=
a></dt>
<dt><a name=3D"TOC-9.16.44" class=3D"tocanchor">9.16.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0171717F">Function <tt>compl-span-str<=
/tt></a></dt>
<dt><a name=3D"TOC-9.16.45" class=3D"tocanchor">9.16.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00A9DB25">Function <tt>break-str</tt><=
/a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.17" class=3D"tocanchor">9.17</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-017F3F15">Lazy Strings</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0155" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.17.1" class=3D"tocanchor">9.17.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02AFF63D">Function <tt>lazy-str</tt></a>=
</dt>
<dt><a name=3D"TOC-9.17.2" class=3D"tocanchor">9.17.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0381BB2A">Function <tt>lazy-stringp</tt>=
</a></dt>
<dt><a name=3D"TOC-9.17.3" class=3D"tocanchor">9.17.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0212FED6">Function <tt>lazy-str-force-up=
to</tt></a></dt>
<dt><a name=3D"TOC-9.17.4" class=3D"tocanchor">9.17.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03269DEF">Function <tt>lazy-str-force</t=
t></a></dt>
<dt><a name=3D"TOC-9.17.5" class=3D"tocanchor">9.17.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-012701D6">Function <tt>lazy-str-get-trai=
ling-list</tt></a></dt>
<dt><a name=3D"TOC-9.17.6" class=3D"tocanchor">9.17.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-016D8C45">Functions <tt>length-str-&gt;<=
/tt>, <tt>length-str-&gt;=3D</tt>, <tt>length-str-&lt;</tt> and <tt>length-=
str-&lt;=3D</tt></a></dt>
<dt><a name=3D"TOC-9.17.7" class=3D"tocanchor">9.17.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0143A273">Function <tt>cmp-str</tt></a><=
/dt>
<dt><a name=3D"TOC-9.17.8" class=3D"tocanchor">9.17.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01AA954A">Functions <tt>str=3D</tt>, <tt=
>str&lt;</tt>, <tt>str&gt;</tt>, <tt>str&gt;=3D</tt> and <tt>str&lt;=3D</tt=
></a></dt>
<dt><a name=3D"TOC-9.17.9" class=3D"tocanchor">9.17.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03ABBED1">Function <tt>string-lt</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.18" class=3D"tocanchor">9.18</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00BAB6A4">Vectors</a><a href=3D"http://=
nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0156" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.18.1" class=3D"tocanchor">9.18.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B6C6F1">Function <tt>vector</tt></a></=
dt>
<dt><a name=3D"TOC-9.18.2" class=3D"tocanchor">9.18.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0297F5F5">Function <tt>vec</tt></a></dt>
<dt><a name=3D"TOC-9.18.3" class=3D"tocanchor">9.18.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B9C3E5">Function <tt>vectorp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.18.4" class=3D"tocanchor">9.18.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01723847">Function <tt>vec-set-length</t=
t></a></dt>
<dt><a name=3D"TOC-9.18.5" class=3D"tocanchor">9.18.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-001963BF">Accessor <tt>vecref</tt></a></=
dt>
<dt><a name=3D"TOC-9.18.6" class=3D"tocanchor">9.18.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01693B82">Function <tt>vec-push</tt></a>=
</dt>
<dt><a name=3D"TOC-9.18.7" class=3D"tocanchor">9.18.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D6D851">Function <tt>length-vec</tt></=
a></dt>
<dt><a name=3D"TOC-9.18.8" class=3D"tocanchor">9.18.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01000634">Function <tt>size-vec</tt></a>=
</dt>
<dt><a name=3D"TOC-9.18.9" class=3D"tocanchor">9.18.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03295612">Function <tt>vec-list</tt></a>=
</dt>
<dt><a name=3D"TOC-9.18.10" class=3D"tocanchor">9.18.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00460235">Function <tt>list-vec</tt></=
a></dt>
<dt><a name=3D"TOC-9.18.11" class=3D"tocanchor">9.18.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-010E7635">Function <tt>copy-vec</tt></=
a></dt>
<dt><a name=3D"TOC-9.18.12" class=3D"tocanchor">9.18.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03BFFF0A">Accessor <tt>sub-vec</tt></a=
></dt>
<dt><a name=3D"TOC-9.18.13" class=3D"tocanchor">9.18.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01F59E62">Function <tt>replace-vec</tt=
></a></dt>
<dt><a name=3D"TOC-9.18.14" class=3D"tocanchor">9.18.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01AEB28B">Function <tt>cat-vec</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.19" class=3D"tocanchor">9.19</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01BCCCA1">Buffers</a><a href=3D"http://=
nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0157" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.19.1" class=3D"tocanchor">9.19.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-038187CC">The <tt>buf</tt> type</a></dt>
<dt><a name=3D"TOC-9.19.2" class=3D"tocanchor">9.19.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-035546D9">Conventions Used by the <tt>bu=
f-put-</tt> Functions</a></dt>
<dt><a name=3D"TOC-9.19.3" class=3D"tocanchor">9.19.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0095470A">Conventions Used by the <tt>bu=
f-get-</tt> Functions</a></dt>
<dt><a name=3D"TOC-9.19.4" class=3D"tocanchor">9.19.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-011445E1">Function <tt>make-buf</tt></a>=
</dt>
<dt><a name=3D"TOC-9.19.5" class=3D"tocanchor">9.19.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02C6CEE4">Function <tt>bufp</tt></a></dt=
>
<dt><a name=3D"TOC-9.19.6" class=3D"tocanchor">9.19.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0026D89A">Function <tt>length-buf</tt></=
a></dt>
<dt><a name=3D"TOC-9.19.7" class=3D"tocanchor">9.19.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-013A3727">Function <tt>buf-alloc-size</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.8" class=3D"tocanchor">9.19.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0057FBE2">Function <tt>buf-trim</tt></a>=
</dt>
<dt><a name=3D"TOC-9.19.9" class=3D"tocanchor">9.19.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01208847">Function <tt>buf-set-length</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.10" class=3D"tocanchor">9.19.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BE75E1">Function <tt>copy-buf</tt></=
a></dt>
<dt><a name=3D"TOC-9.19.11" class=3D"tocanchor">9.19.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000FFE37">Accessor <tt>sub-buf</tt></a=
></dt>
<dt><a name=3D"TOC-9.19.12" class=3D"tocanchor">9.19.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C59E4E">Function <tt>replace-buf</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.13" class=3D"tocanchor">9.19.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E81617">Function <tt>buf-list</tt></=
a></dt>
<dt><a name=3D"TOC-9.19.14" class=3D"tocanchor">9.19.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-009FC934">Function <tt>buf-put-buf</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.15" class=3D"tocanchor">9.19.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002F655F">Function <tt>buf-put-i8</tt>=
</a></dt>
<dt><a name=3D"TOC-9.19.16" class=3D"tocanchor">9.19.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002F6556">Function <tt>buf-put-u8</tt>=
</a></dt>
<dt><a name=3D"TOC-9.19.17" class=3D"tocanchor">9.19.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-019FC970">Function <tt>buf-put-i16</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.18" class=3D"tocanchor">9.19.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-019FC960">Function <tt>buf-put-u16</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.19" class=3D"tocanchor">9.19.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-035FC973">Function <tt>buf-put-i32</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.20" class=3D"tocanchor">9.19.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-035FC963">Function <tt>buf-put-u32</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.21" class=3D"tocanchor">9.19.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007FC973">Function <tt>buf-put-i64</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.22" class=3D"tocanchor">9.19.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007FC963">Function <tt>buf-put-u64</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.23" class=3D"tocanchor">9.19.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00690748">Function <tt>buf-put-char</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.24" class=3D"tocanchor">9.19.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03BCF627">Function <tt>buf-put-uchar</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.25" class=3D"tocanchor">9.19.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031CE904">Function <tt>buf-put-short</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.26" class=3D"tocanchor">9.19.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-035696C9">Function <tt>buf-put-ushort<=
/tt></a></dt>
<dt><a name=3D"TOC-9.19.27" class=3D"tocanchor">9.19.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007FC982">Function <tt>buf-put-int</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.28" class=3D"tocanchor">9.19.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-018913CB">Function <tt>buf-put-uint</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.29" class=3D"tocanchor">9.19.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00990DE3">Function <tt>buf-put-long</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.30" class=3D"tocanchor">9.19.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-020CF007">Function <tt>buf-put-ulong</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.31" class=3D"tocanchor">9.19.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-001D2408">Function <tt>buf-put-float</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.32" class=3D"tocanchor">9.19.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-006A81D9">Function <tt>buf-put-double<=
/tt></a></dt>
<dt><a name=3D"TOC-9.19.33" class=3D"tocanchor">9.19.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03690764">Function <tt>buf-put-cptr</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.34" class=3D"tocanchor">9.19.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0013E55F">Function <tt>buf-get-i8</tt>=
</a></dt>
<dt><a name=3D"TOC-9.19.35" class=3D"tocanchor">9.19.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0013E556">Function <tt>buf-get-u8</tt>=
</a></dt>
<dt><a name=3D"TOC-9.19.36" class=3D"tocanchor">9.19.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E7C970">Function <tt>buf-get-i16</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.37" class=3D"tocanchor">9.19.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E7C960">Function <tt>buf-get-u16</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.38" class=3D"tocanchor">9.19.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0127C970">Function <tt>buf-get-i32</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.39" class=3D"tocanchor">9.19.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0127C960">Function <tt>buf-get-u32</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.40" class=3D"tocanchor">9.19.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C7C972">Function <tt>buf-get-i64</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.41" class=3D"tocanchor">9.19.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C7C962">Function <tt>buf-get-u64</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.42" class=3D"tocanchor">9.19.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E9074A">Function <tt>buf-get-char</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.43" class=3D"tocanchor">9.19.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03BCF5D1">Function <tt>buf-get-uchar</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.44" class=3D"tocanchor">9.19.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031CE896">Function <tt>buf-get-short</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.45" class=3D"tocanchor">9.19.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-035691E9">Function <tt>buf-get-ushort<=
/tt></a></dt>
<dt><a name=3D"TOC-9.19.46" class=3D"tocanchor">9.19.46</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C7C985">Function <tt>buf-get-int</tt=
></a></dt>
<dt><a name=3D"TOC-9.19.47" class=3D"tocanchor">9.19.47</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-030913C8">Function <tt>buf-get-uint</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.48" class=3D"tocanchor">9.19.48</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02190DE0">Function <tt>buf-get-long</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.49" class=3D"tocanchor">9.19.49</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-020CEF9D">Function <tt>buf-get-ulong</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.50" class=3D"tocanchor">9.19.50</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-001D239A">Function <tt>buf-get-float</=
tt></a></dt>
<dt><a name=3D"TOC-9.19.51" class=3D"tocanchor">9.19.51</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-006C6EB9">Function <tt>buf-get-double<=
/tt></a></dt>
<dt><a name=3D"TOC-9.19.52" class=3D"tocanchor">9.19.52</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E90766">Function <tt>buf-get-cptr</t=
t></a></dt>
<dt><a name=3D"TOC-9.19.53" class=3D"tocanchor">9.19.53</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-021DB1B7">Function <tt>put-buf</tt></a=
></dt>
<dt><a name=3D"TOC-9.19.54" class=3D"tocanchor">9.19.54</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00D142E1">Functions <tt>fill-buf</tt> =
and <tt>fill-buf-adjust</tt></a></dt>
<dt><a name=3D"TOC-9.19.55" class=3D"tocanchor">9.19.55</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007FD2F9">Function <tt>get-line-as-buf=
</tt></a></dt>
<dt><a name=3D"TOC-9.19.56" class=3D"tocanchor">9.19.56</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00FA177D">Functions <tt>file-get-buf</=
tt> and <tt>command-get-buf</tt></a></dt>
<dt><a name=3D"TOC-9.19.57" class=3D"tocanchor">9.19.57</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02AE3A31">Functions <tt>file-put-buf</=
tt>, <tt>file-append-buf</tt> and <tt>command-put-buf</tt></a></dt>
<dt><a name=3D"TOC-9.19.58" class=3D"tocanchor">9.19.58</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012BF6AD">Functions <tt>buf-str</tt> a=
nd <tt>str-buf</tt></a></dt>
<dt><a name=3D"TOC-9.19.59" class=3D"tocanchor">9.19.59</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0291625A">Functions <tt>buf-int</tt> a=
nd <tt>buf-uint</tt></a></dt>
<dt><a name=3D"TOC-9.19.60" class=3D"tocanchor">9.19.60</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">Functions <tt>int-buf</tt> a=
nd <tt>uint-buf</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.20" class=3D"tocanchor">9.20</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-03ACAF25">Structures</a><a href=3D"http=
://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></d=
t>
<dd><dl id=3D"g0158" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.20.1" class=3D"tocanchor">9.20.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00BFD56E">Static Slots</a></dt>
<dt><a name=3D"TOC-9.20.2" class=3D"tocanchor">9.20.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FDE09D">Multiple Inheritance</a></dt>
<dt><a name=3D"TOC-9.20.3" class=3D"tocanchor">9.20.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00EF8767">Duplicate Supertypes</a></dt>
<dt><a name=3D"TOC-9.20.4" class=3D"tocanchor">9.20.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-035A698D">Dirty Flags</a></dt>
<dt><a name=3D"TOC-9.20.5" class=3D"tocanchor">9.20.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02CDB347">Equality Substitution</a></dt>
<dt><a name=3D"TOC-9.20.6" class=3D"tocanchor">9.20.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-021CC672">Macro <tt>defstruct</tt></a></=
dt>
<dt><a name=3D"TOC-9.20.7" class=3D"tocanchor">9.20.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0047C7E8">Macro <tt>defmeth</tt></a></dt=
>
<dt><a name=3D"TOC-9.20.8" class=3D"tocanchor">9.20.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0230059D">Macros <tt>new</tt> and <tt>ln=
ew</tt></a></dt>
<dt><a name=3D"TOC-9.20.9" class=3D"tocanchor">9.20.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-021E6FDC">Macros <tt>new*</tt> and <tt>l=
new*</tt></a></dt>
<dt><a name=3D"TOC-9.20.10" class=3D"tocanchor">9.20.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C411A2">Macro <tt>with-slots</tt></a=
></dt>
<dt><a name=3D"TOC-9.20.11" class=3D"tocanchor">9.20.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03A212AB">Macro <tt>qref</tt></a></dt>
<dt><a name=3D"TOC-9.20.12" class=3D"tocanchor">9.20.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03A211AB">Macro <tt>uref</tt></a></dt>
<dt><a name=3D"TOC-9.20.13" class=3D"tocanchor">9.20.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C216C3">Macro <tt>meth</tt></a></dt>
<dt><a name=3D"TOC-9.20.14" class=3D"tocanchor">9.20.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02ECA31C">Macro <tt>umeth</tt></a></dt=
>
<dt><a name=3D"TOC-9.20.15" class=3D"tocanchor">9.20.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BF39DD">Macro <tt>usl</tt></a></dt>
<dt><a name=3D"TOC-9.20.16" class=3D"tocanchor">9.20.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-022EEF2D">Function <tt>make-struct-typ=
e</tt></a></dt>
<dt><a name=3D"TOC-9.20.17" class=3D"tocanchor">9.20.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E5EEA7">Function <tt>find-struct-typ=
e</tt></a></dt>
<dt><a name=3D"TOC-9.20.18" class=3D"tocanchor">9.20.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00717410">Function <tt>struct-type-p</=
tt></a></dt>
<dt><a name=3D"TOC-9.20.19" class=3D"tocanchor">9.20.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00088BD7">Function <tt>struct-type-nam=
e</tt></a></dt>
<dt><a name=3D"TOC-9.20.20" class=3D"tocanchor">9.20.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D8EEEE">Function <tt>super</tt></a><=
/dt>
<dt><a name=3D"TOC-9.20.21" class=3D"tocanchor">9.20.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002B3F64">Function <tt>make-struct</tt=
></a></dt>
<dt><a name=3D"TOC-9.20.22" class=3D"tocanchor">9.20.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C734D9">Function <tt>make-lazy-struc=
t</tt></a></dt>
<dt><a name=3D"TOC-9.20.23" class=3D"tocanchor">9.20.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01515451">Functions <tt>struct-from-pl=
ist</tt> and <tt>struct-from-args</tt></a></dt>
<dt><a name=3D"TOC-9.20.24" class=3D"tocanchor">9.20.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03168BF2">Function <tt>allocate-struct=
</tt></a></dt>
<dt><a name=3D"TOC-9.20.25" class=3D"tocanchor">9.20.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-032B3FDC">Function <tt>copy-struct</tt=
></a></dt>
<dt><a name=3D"TOC-9.20.26" class=3D"tocanchor">9.20.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0326F62D">Accessor <tt>slot</tt></a></=
dt>
<dt><a name=3D"TOC-9.20.27" class=3D"tocanchor">9.20.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02657437">Function <tt>slotset</tt></a=
></dt>
<dt><a name=3D"TOC-9.20.28" class=3D"tocanchor">9.20.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03AB857D">Functions <tt>test-dirty</tt=
>, <tt>clear-dirty</tt> and <tt>test-clear-dirty</tt></a></dt>
<dt><a name=3D"TOC-9.20.29" class=3D"tocanchor">9.20.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01BB3FB3">Function <tt>structp</tt></a=
></dt>
<dt><a name=3D"TOC-9.20.30" class=3D"tocanchor">9.20.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C33D76">Function <tt>struct-type</tt=
></a></dt>
<dt><a name=3D"TOC-9.20.31" class=3D"tocanchor">9.20.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03A968CA">Function <tt>clear-struct</t=
t></a></dt>
<dt><a name=3D"TOC-9.20.32" class=3D"tocanchor">9.20.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002A609F">Function <tt>reset-struct</t=
t></a></dt>
<dt><a name=3D"TOC-9.20.33" class=3D"tocanchor">9.20.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A8343B">Function <tt>replace-struct<=
/tt></a></dt>
<dt><a name=3D"TOC-9.20.34" class=3D"tocanchor">9.20.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-022200C1">Function <tt>method</tt></a>=
</dt>
<dt><a name=3D"TOC-9.20.35" class=3D"tocanchor">9.20.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02AC8367">Function <tt>super-method</t=
t></a></dt>
<dt><a name=3D"TOC-9.20.36" class=3D"tocanchor">9.20.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000BCBC5">Function <tt>umethod</tt></a=
></dt>
<dt><a name=3D"TOC-9.20.37" class=3D"tocanchor">9.20.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01F8E0A1">Function <tt>uslot</tt></a><=
/dt>
<dt><a name=3D"TOC-9.20.38" class=3D"tocanchor">9.20.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E90177">Function <tt>slots</tt></a><=
/dt>
<dt><a name=3D"TOC-9.20.39" class=3D"tocanchor">9.20.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B90177">Function <tt>slotp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.20.40" class=3D"tocanchor">9.20.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-032FD510">Function <tt>static-slot-p</=
tt></a></dt>
<dt><a name=3D"TOC-9.20.41" class=3D"tocanchor">9.20.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C47D17">Function <tt>static-slot</tt=
></a></dt>
<dt><a name=3D"TOC-9.20.42" class=3D"tocanchor">9.20.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0017D1B5">Function <tt>static-slot-set=
</tt></a></dt>
<dt><a name=3D"TOC-9.20.43" class=3D"tocanchor">9.20.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E71F31">Function <tt>static-slot-ens=
ure</tt></a></dt>
<dt><a name=3D"TOC-9.20.44" class=3D"tocanchor">9.20.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01F88B0D">Function <tt>static-slot-hom=
e</tt></a></dt>
<dt><a name=3D"TOC-9.20.45" class=3D"tocanchor">9.20.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-016185D1">Function <tt>call-super-meth=
od</tt></a></dt>
<dt><a name=3D"TOC-9.20.46" class=3D"tocanchor">9.20.46</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0223E999">Function <tt>call-super-fun<=
/tt></a></dt>
<dt><a name=3D"TOC-9.20.47" class=3D"tocanchor">9.20.47</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03946F2A">Functions <tt>struct-get-ini=
tfun</tt> and <tt>struct-get-postinitfun</tt></a></dt>
<dt><a name=3D"TOC-9.20.48" class=3D"tocanchor">9.20.48</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00946F18">Functions <tt>struct-set-ini=
tfun</tt> and <tt>struct-set-postinitfun</tt></a></dt>
<dt><a name=3D"TOC-9.20.49" class=3D"tocanchor">9.20.49</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00AECEBA">Macro <tt>with-objects</tt><=
/a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.21" class=3D"tocanchor">9.21</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-007C2511">Special Structure Functions</=
a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <t=
t>[+]</tt></a></dt>
<dd><dl id=3D"g0159" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.21.1" class=3D"tocanchor">9.21.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00790C76">Method <tt>equal</tt></a></dt>
<dt><a name=3D"TOC-9.21.2" class=3D"tocanchor">9.21.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F8B869">Method <tt>print</tt></a></dt>
<dt><a name=3D"TOC-9.21.3" class=3D"tocanchor">9.21.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E775FE">Method <tt>lambda</tt></a></dt=
>
<dt><a name=3D"TOC-9.21.4" class=3D"tocanchor">9.21.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FEBA97">Method <tt>lambda-set</tt></a>=
</dt>
<dt><a name=3D"TOC-9.21.5" class=3D"tocanchor">9.21.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-025D84CE">Method <tt>length</tt></a></dt=
>
<dt><a name=3D"TOC-9.21.6" class=3D"tocanchor">9.21.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-035F2D99">Methods <tt>car</tt>, <tt>cdr<=
/tt> and <tt>nullify</tt></a></dt>
<dt><a name=3D"TOC-9.21.7" class=3D"tocanchor">9.21.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0002B267">Methods <tt>rplaca</tt> and <t=
t>rplacd</tt></a></dt>
<dt><a name=3D"TOC-9.21.8" class=3D"tocanchor">9.21.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01FFD230">Function <tt>from-list</tt></a=
></dt>
<dt><a name=3D"TOC-9.21.9" class=3D"tocanchor">9.21.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0151798B">Function <tt>derived</tt></a><=
/dt>
<dt><a name=3D"TOC-9.21.10" class=3D"tocanchor">9.21.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0227EA90">Methods <tt>iter-begin</tt> =
and <tt>iter-reset</tt></a></dt>
<dt><a name=3D"TOC-9.21.11" class=3D"tocanchor">9.21.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000891B1">Method <tt>iter-item</tt></a=
></dt>
<dt><a name=3D"TOC-9.21.12" class=3D"tocanchor">9.21.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00387731">Method <tt>iter-step</tt></a=
></dt>
<dt><a name=3D"TOC-9.21.13" class=3D"tocanchor">9.21.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00889268">Method <tt>iter-more</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.22" class=3D"tocanchor">9.22</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-027F768C">Sequence Manipulation</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0160" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.22.1" class=3D"tocanchor">9.22.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03C6CAE0">Function <tt>seqp</tt></a></dt=
>
<dt><a name=3D"TOC-9.22.2" class=3D"tocanchor">9.22.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01156AE3">Function <tt>iterable</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.3" class=3D"tocanchor">9.22.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01C1D23C">Function <tt>make-like</tt></a=
></dt>
<dt><a name=3D"TOC-9.22.4" class=3D"tocanchor">9.22.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02F0880D">Functions <tt>list-seq</tt>, <=
tt>vec-seq</tt> and <tt>str-seq</tt></a></dt>
<dt><a name=3D"TOC-9.22.5" class=3D"tocanchor">9.22.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03AD172A">Functions <tt>length</tt> and =
<tt>len</tt></a></dt>
<dt><a name=3D"TOC-9.22.6" class=3D"tocanchor">9.22.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-004918EB">Function <tt>empty</tt></a></d=
t>
<dt><a name=3D"TOC-9.22.7" class=3D"tocanchor">9.22.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03E5C1DE">Function <tt>nullify</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.8" class=3D"tocanchor">9.22.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D9F42F">Accessor <tt>sub</tt></a></dt>
<dt><a name=3D"TOC-9.22.9" class=3D"tocanchor">9.22.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-035991E1">Function <tt>replace</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.10" class=3D"tocanchor">9.22.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F6D433">Function <tt>take</tt></a></=
dt>
<dt><a name=3D"TOC-9.22.11" class=3D"tocanchor">9.22.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E42C4C">Functions <tt>take-while</tt=
> and <tt>take-until</tt></a></dt>
<dt><a name=3D"TOC-9.22.12" class=3D"tocanchor">9.22.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C6C906">Function <tt>drop</tt></a></=
dt>
<dt><a name=3D"TOC-9.22.13" class=3D"tocanchor">9.22.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011E5936">Functions <tt>drop-while</tt=
> and <tt>drop-until</tt></a></dt>
<dt><a name=3D"TOC-9.22.14" class=3D"tocanchor">9.22.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0326F3F2">Accessor <tt>last</tt></a></=
dt>
<dt><a name=3D"TOC-9.22.15" class=3D"tocanchor">9.22.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-026BB6FA">Accessor <tt>butlast</tt></a=
></dt>
<dt><a name=3D"TOC-9.22.16" class=3D"tocanchor">9.22.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02193773">Function <tt>ldiff</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.17" class=3D"tocanchor">9.22.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015D8676">Function <tt>search</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.18" class=3D"tocanchor">9.22.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-010AB2D7">Function <tt>contains</tt></=
a></dt>
<dt><a name=3D"TOC-9.22.19" class=3D"tocanchor">9.22.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03405F7D">Function <tt>rsearch</tt></a=
></dt>
<dt><a name=3D"TOC-9.22.20" class=3D"tocanchor">9.22.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A419FB">Functions <tt>ref</tt> and <=
tt>refset</tt></a></dt>
<dt><a name=3D"TOC-9.22.21" class=3D"tocanchor">9.22.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0327B17E">Function <tt>update</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.22" class=3D"tocanchor">9.22.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000ECD82">Functions <tt>remq</tt>, <tt=
>remql</tt> and <tt>remqual</tt></a></dt>
<dt><a name=3D"TOC-9.22.23" class=3D"tocanchor">9.22.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B85CD2">Functions <tt>remq*</tt>, <t=
t>remql*</tt> and <tt>remqual*</tt></a></dt>
<dt><a name=3D"TOC-9.22.24" class=3D"tocanchor">9.22.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00583609">Functions <tt>keepq</tt>, <t=
t>keepql</tt> and <tt>keepqual</tt></a></dt>
<dt><a name=3D"TOC-9.22.25" class=3D"tocanchor">9.22.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01413802">Functions <tt>remove-if</tt>=
, <tt>keep-if</tt>, <tt>remove-if*</tt> and <tt>keep-if*</tt></a></dt>
<dt><a name=3D"TOC-9.22.26" class=3D"tocanchor">9.22.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01DF131F">Functions <tt>countqual</tt>=
, <tt>countql</tt> and <tt>countq</tt></a></dt>
<dt><a name=3D"TOC-9.22.27" class=3D"tocanchor">9.22.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BBC726">Function <tt>count-if</tt></=
a></dt>
<dt><a name=3D"TOC-9.22.28" class=3D"tocanchor">9.22.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00A2B785">Functions <tt>posq</tt>, <tt=
>posql</tt> and <tt>posqual</tt></a></dt>
<dt><a name=3D"TOC-9.22.29" class=3D"tocanchor">9.22.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C2BBDB">Functions <tt>pos</tt> and <=
tt>pos-if</tt></a></dt>
<dt><a name=3D"TOC-9.22.30" class=3D"tocanchor">9.22.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01F68300">Functions <tt>rposq</tt>, <t=
t>rposql</tt>, <tt>rposqual</tt>, <tt>rpos</tt> and <tt>rpos-if</tt></a></d=
t>
<dt><a name=3D"TOC-9.22.31" class=3D"tocanchor">9.22.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-027D45DD">Functions <tt>pos-max</tt> a=
nd <tt>pos-min</tt></a></dt>
<dt><a name=3D"TOC-9.22.32" class=3D"tocanchor">9.22.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03164F4F">Function <tt>mismatch</tt></=
a></dt>
<dt><a name=3D"TOC-9.22.33" class=3D"tocanchor">9.22.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0208F1DE">Function <tt>where</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.34" class=3D"tocanchor">9.22.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-008F3C16">Function <tt>rmismatch</tt><=
/a></dt>
<dt><a name=3D"TOC-9.22.35" class=3D"tocanchor">9.22.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-004955D4">Functions <tt>starts-with</t=
t> and <tt>ends-with</tt></a></dt>
<dt><a name=3D"TOC-9.22.36" class=3D"tocanchor">9.22.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031D7F72">Function <tt>select</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.37" class=3D"tocanchor">9.22.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031DC0F2">Function <tt>reject</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.38" class=3D"tocanchor">9.22.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-032DBF7E">Function <tt>relate</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.39" class=3D"tocanchor">9.22.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-016BE41C">Function <tt>in</tt></a></dt=
>
<dt><a name=3D"TOC-9.22.40" class=3D"tocanchor">9.22.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0142889E">Function <tt>partition</tt><=
/a></dt>
<dt><a name=3D"TOC-9.22.41" class=3D"tocanchor">9.22.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02FD4882">Functions <tt>split</tt> and=
 <tt>split*</tt></a></dt>
<dt><a name=3D"TOC-9.22.42" class=3D"tocanchor">9.22.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03951D7A">Function <tt>partition*</tt>=
</a></dt>
<dt><a name=3D"TOC-9.22.43" class=3D"tocanchor">9.22.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-005431FF">Functions <tt>find</tt> and =
<tt>find-if</tt></a></dt>
<dt><a name=3D"TOC-9.22.44" class=3D"tocanchor">9.22.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0301CDB6">Functions <tt>rfind</tt> and=
 <tt>rfind-if</tt></a></dt>
<dt><a name=3D"TOC-9.22.45" class=3D"tocanchor">9.22.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02BB4231">Functions <tt>find-max</tt> =
and <tt>find-min</tt></a></dt>
<dt><a name=3D"TOC-9.22.46" class=3D"tocanchor">9.22.46</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0385B074">Functions <tt>uni</tt>, <tt>=
isec</tt>, <tt>diff</tt> and <tt>symdiff</tt></a></dt>
<dt><a name=3D"TOC-9.22.47" class=3D"tocanchor">9.22.47</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0202F92F">Functions <tt>mapcar</tt>, <=
tt>mappend</tt>, <tt>mapcar*</tt> and <tt>mappend*</tt></a></dt>
<dt><a name=3D"TOC-9.22.48" class=3D"tocanchor">9.22.48</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015987D7">Functions <tt>maprod</tt>, <=
tt>maprend</tt> and <tt>maprodo</tt></a></dt>
<dt><a name=3D"TOC-9.22.49" class=3D"tocanchor">9.22.49</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03A943EE">Function <tt>mapdo</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.50" class=3D"tocanchor">9.22.50</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03AA85AD">Functions <tt>transpose</tt>=
 and <tt>zip</tt></a></dt>
<dt><a name=3D"TOC-9.22.51" class=3D"tocanchor">9.22.51</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015AFD48">Functions <tt>window-map</tt=
>, <tt>window-mappend</tt> and <tt>window-mapdo</tt></a></dt>
<dt><a name=3D"TOC-9.22.52" class=3D"tocanchor">9.22.52</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0030734D">Function <tt>interpose</tt><=
/a></dt>
<dt><a name=3D"TOC-9.22.53" class=3D"tocanchor">9.22.53</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00FB426F">Functions <tt>reduce-left</t=
t> and <tt>reduce-right</tt></a></dt>
<dt><a name=3D"TOC-9.22.54" class=3D"tocanchor">9.22.54</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D4DD08">Functions <tt>some</tt>, <tt=
>all</tt> and <tt>none</tt></a></dt>
<dt><a name=3D"TOC-9.22.55" class=3D"tocanchor">9.22.55</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-034946BA">Function <tt>multi</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.56" class=3D"tocanchor">9.22.56</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01FE5176">Functions <tt>sort</tt> and =
<tt>nsort</tt></a></dt>
<dt><a name=3D"TOC-9.22.57" class=3D"tocanchor">9.22.57</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00091853">Function <tt>grade</tt></a><=
/dt>
<dt><a name=3D"TOC-9.22.58" class=3D"tocanchor">9.22.58</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01F12561">Functions <tt>shuffle</tt> a=
nd <tt>nshuffle</tt></a></dt>
<dt><a name=3D"TOC-9.22.59" class=3D"tocanchor">9.22.59</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E65DDC">Function <tt>sort-group</tt>=
</a></dt>
<dt><a name=3D"TOC-9.22.60" class=3D"tocanchor">9.22.60</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B6D456">Function <tt>uniq</tt></a></=
dt>
<dt><a name=3D"TOC-9.22.61" class=3D"tocanchor">9.22.61</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0028147F">Function <tt>unique</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.62" class=3D"tocanchor">9.22.62</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C801EF">Function <tt>tuples</tt></a>=
</dt>
<dt><a name=3D"TOC-9.22.63" class=3D"tocanchor">9.22.63</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000167DF">Function <tt>partition-by</t=
t></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.23" class=3D"tocanchor">9.23</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0372EA61">Open Sequence Traversal</a><a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+=
]</tt></a></dt>
<dd><dl id=3D"g0161" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.23.1" class=3D"tocanchor">9.23.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-024C86F4">Function <tt>iter-begin</tt></=
a></dt>
<dt><a name=3D"TOC-9.23.2" class=3D"tocanchor">9.23.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B6130D">Function <tt>iter-more</tt></a=
></dt>
<dt><a name=3D"TOC-9.23.3" class=3D"tocanchor">9.23.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0036122B">Function <tt>iter-item</tt></a=
></dt>
<dt><a name=3D"TOC-9.23.4" class=3D"tocanchor">9.23.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0205F7AB">Function <tt>iter-step</tt></a=
></dt>
<dt><a name=3D"TOC-9.23.5" class=3D"tocanchor">9.23.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03EE4725">Function <tt>iter-reset</tt></=
a></dt>
<dt><a name=3D"TOC-9.23.6" class=3D"tocanchor">9.23.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0068A845">Function <tt>seq-begin</tt></a=
></dt>
<dt><a name=3D"TOC-9.23.7" class=3D"tocanchor">9.23.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E3D643">Function <tt>seq-next</tt></a>=
</dt>
<dt><a name=3D"TOC-9.23.8" class=3D"tocanchor">9.23.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01CA6912">Function <tt>seq-reset</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.24" class=3D"tocanchor">9.24</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00F51820">Procedural List Construction<=
/a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <=
tt>[+]</tt></a></dt>
<dd><dl id=3D"g0162" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.24.1" class=3D"tocanchor">9.24.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018F6666">Structure <tt>list-builder</tt=
></a></dt>
<dt><a name=3D"TOC-9.24.2" class=3D"tocanchor">9.24.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0315C467">Function <tt>build-list</tt></=
a></dt>
<dt><a name=3D"TOC-9.24.3" class=3D"tocanchor">9.24.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03244398">Methods <tt>add</tt> and <tt>a=
dd*</tt></a></dt>
<dt><a name=3D"TOC-9.24.4" class=3D"tocanchor">9.24.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03975507">Methods <tt>pend</tt> and <tt>=
pend*</tt></a></dt>
<dt><a name=3D"TOC-9.24.5" class=3D"tocanchor">9.24.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-022F6E60">Methods <tt>ncon</tt> and <tt>=
ncon*</tt></a></dt>
<dt><a name=3D"TOC-9.24.6" class=3D"tocanchor">9.24.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D9F55D">Method <tt>get</tt></a></dt>
<dt><a name=3D"TOC-9.24.7" class=3D"tocanchor">9.24.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0166445C">Methods <tt>del</tt> and <tt>d=
el*</tt></a></dt>
<dt><a name=3D"TOC-9.24.8" class=3D"tocanchor">9.24.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01346AAA">Macros <tt>build</tt> and <tt>=
buildn</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.25" class=3D"tocanchor">9.25</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-02E80A51">Permutations and Combinations=
</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> =
<tt>[+]</tt></a></dt>
<dd><dl id=3D"g0163" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.25.1" class=3D"tocanchor">9.25.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0176D3A1">Function <tt>perm</tt></a></dt=
>
<dt><a name=3D"TOC-9.25.2" class=3D"tocanchor">9.25.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0188EBDE">Function <tt>rperm</tt></a></d=
t>
<dt><a name=3D"TOC-9.25.3" class=3D"tocanchor">9.25.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E6CEDD">Function <tt>comb</tt></a></dt=
>
<dt><a name=3D"TOC-9.25.4" class=3D"tocanchor">9.25.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D9003C">Function <tt>rcomb</tt></a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-9.26" class=3D"tocanchor">9.26</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0137A962">Macros</a><a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0164" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.26.1" class=3D"tocanchor">9.26.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0131EFEE">Macro parameter lists</a></dt>
<dt><a name=3D"TOC-9.26.2" class=3D"tocanchor">9.26.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0264A0BD">Operator <tt>macro-time</tt></=
a></dt>
<dt><a name=3D"TOC-9.26.3" class=3D"tocanchor">9.26.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02CAEF0B">Operator <tt>defmacro</tt></a>=
</dt>
<dt><a name=3D"TOC-9.26.4" class=3D"tocanchor">9.26.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00AC12C0">Operator <tt>macrolet</tt></a>=
</dt>
<dt><a name=3D"TOC-9.26.5" class=3D"tocanchor">9.26.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02AC86DE">Function <tt>macro-form-p</tt>=
</a></dt>
<dt><a name=3D"TOC-9.26.6" class=3D"tocanchor">9.26.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02ED5471">Functions <tt>macroexpand-1</t=
t> and <tt>macroexpand</tt></a></dt>
<dt><a name=3D"TOC-9.26.7" class=3D"tocanchor">9.26.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01E62179">Functions <tt>macroexpand-1-li=
sp1</tt> and <tt>macroexpand-lisp1</tt></a></dt>
<dt><a name=3D"TOC-9.26.8" class=3D"tocanchor">9.26.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E0F5F5">Functions <tt>expand</tt> and =
<tt>*expand</tt></a></dt>
<dt><a name=3D"TOC-9.26.9" class=3D"tocanchor">9.26.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0334827B">Function <tt>expand-with-free-=
refs</tt></a></dt>
<dt><a name=3D"TOC-9.26.10" class=3D"tocanchor">9.26.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007B1A53">Functions <tt>lexical-var-p<=
/tt> and <tt>lexical-fun-p</tt></a></dt>
<dt><a name=3D"TOC-9.26.11" class=3D"tocanchor">9.26.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02D124AB">Function <tt>lexical-lisp1-b=
inding</tt></a></dt>
<dt><a name=3D"TOC-9.26.12" class=3D"tocanchor">9.26.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0080256D">Operator <tt>defsymacro</tt>=
</a></dt>
<dt><a name=3D"TOC-9.26.13" class=3D"tocanchor">9.26.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00321AB1">Operator <tt>symacrolet</tt>=
</a></dt>
<dt><a name=3D"TOC-9.26.14" class=3D"tocanchor">9.26.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0393C970">Macros <tt>placelet</tt> and=
 <tt>placelet*</tt></a></dt>
<dt><a name=3D"TOC-9.26.15" class=3D"tocanchor">9.26.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02ACCDDF">Macro <tt>equot</tt></a></dt=
>
<dt><a name=3D"TOC-9.26.16" class=3D"tocanchor">9.26.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00A580D9">Operators <tt>tree-bind</tt>=
 and <tt>mac-param-bind</tt></a></dt>
<dt><a name=3D"TOC-9.26.17" class=3D"tocanchor">9.26.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D834A5">Operator <tt>tree-case</tt><=
/a></dt>
<dt><a name=3D"TOC-9.26.18" class=3D"tocanchor">9.26.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02AB6E53">Macro <tt>tb</tt></a></dt>
<dt><a name=3D"TOC-9.26.19" class=3D"tocanchor">9.26.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-029B6E53">Macro <tt>tc</tt></a></dt>
<dt><a name=3D"TOC-9.26.20" class=3D"tocanchor">9.26.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-034F045B">Macro <tt>with-gensyms</tt><=
/a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.27" class=3D"tocanchor">9.27</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00B4065C">Parameter List Macros</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0165" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.27.1" class=3D"tocanchor">9.27.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B67ED8">Special variable <tt>*param-ma=
cro*</tt></a></dt>
<dt><a name=3D"TOC-9.27.2" class=3D"tocanchor">9.27.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019F25A5">Macro <tt>define-param-expande=
r</tt></a></dt>
<dt><a name=3D"TOC-9.27.3" class=3D"tocanchor">9.27.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01697547">Parameter list macro <tt>:key<=
/tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.28" class=3D"tocanchor">9.28</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00A7F3F6">Mutation of Syntactic Places<=
/a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <=
tt>[+]</tt></a></dt>
<dd><dl id=3D"g0166" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.28.1" class=3D"tocanchor">9.28.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033F39EB">Macro <tt>set</tt></a></dt>
<dt><a name=3D"TOC-9.28.2" class=3D"tocanchor">9.28.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008211EC">Macro <tt>pset</tt></a></dt>
<dt><a name=3D"TOC-9.28.3" class=3D"tocanchor">9.28.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037F3A8C">Macro <tt>zap</tt></a></dt>
<dt><a name=3D"TOC-9.28.4" class=3D"tocanchor">9.28.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0042153F">Macro <tt>flip</tt></a></dt>
<dt><a name=3D"TOC-9.28.5" class=3D"tocanchor">9.28.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-036C7E9E">Macros <tt>test-set</tt> and <=
tt>test-clear</tt></a></dt>
<dt><a name=3D"TOC-9.28.6" class=3D"tocanchor">9.28.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02933F2A">Macro <tt>compare-swap</tt></a=
></dt>
<dt><a name=3D"TOC-9.28.7" class=3D"tocanchor">9.28.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03A0AABD">Macros <tt>inc</tt> and <tt>de=
c</tt></a></dt>
<dt><a name=3D"TOC-9.28.8" class=3D"tocanchor">9.28.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E4BC37">Macros <tt>pinc</tt> and <tt>p=
dec</tt></a></dt>
<dt><a name=3D"TOC-9.28.9" class=3D"tocanchor">9.28.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A4228F">Macros <tt>test-inc</tt> and <=
tt>test-dec</tt></a></dt>
<dt><a name=3D"TOC-9.28.10" class=3D"tocanchor">9.28.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0042131D">Macro <tt>swap</tt></a></dt>
<dt><a name=3D"TOC-9.28.11" class=3D"tocanchor">9.28.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C211C1">Macro <tt>push</tt></a></dt>
<dt><a name=3D"TOC-9.28.12" class=3D"tocanchor">9.28.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-017F39D2">Macro <tt>pop</tt></a></dt>
<dt><a name=3D"TOC-9.28.13" class=3D"tocanchor">9.28.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C37AB0">Macro <tt>pushnew</tt></a></=
dt>
<dt><a name=3D"TOC-9.28.14" class=3D"tocanchor">9.28.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01AC8471">Macro <tt>shift</tt></a></dt=
>
<dt><a name=3D"TOC-9.28.15" class=3D"tocanchor">9.28.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0166291D">Macro <tt>rotate</tt></a></d=
t>
<dt><a name=3D"TOC-9.28.16" class=3D"tocanchor">9.28.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02BF3A07">Macro <tt>del</tt></a></dt>
<dt><a name=3D"TOC-9.28.17" class=3D"tocanchor">9.28.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-008216EC">Macro <tt>lset</tt></a></dt>
<dt><a name=3D"TOC-9.28.18" class=3D"tocanchor">9.28.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-033F39DC">Macro <tt>upd</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.29" class=3D"tocanchor">9.29</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-004B0AB7">User-Defined Places and Place=
 Operators</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D=
"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0167" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.29.1" class=3D"tocanchor">9.29.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0311B2B1">Place-Expander Functions</a></=
dt>
<dt><a name=3D"TOC-9.29.2" class=3D"tocanchor">9.29.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01AF752D">The Update Expander</a></dt>
<dt><a name=3D"TOC-9.29.3" class=3D"tocanchor">9.29.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-036C9591">The Clobber Expander</a></dt>
<dt><a name=3D"TOC-9.29.4" class=3D"tocanchor">9.29.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03BF73F8">The Delete Expander</a></dt>
<dt><a name=3D"TOC-9.29.5" class=3D"tocanchor">9.29.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006EA023">Macro <tt>with-update-expander=
</tt></a></dt>
<dt><a name=3D"TOC-9.29.6" class=3D"tocanchor">9.29.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0181ED4C">Macro <tt>with-clobber-expande=
r</tt></a></dt>
<dt><a name=3D"TOC-9.29.7" class=3D"tocanchor">9.29.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02A6E020">Macro <tt>with-delete-expander=
</tt></a></dt>
<dt><a name=3D"TOC-9.29.8" class=3D"tocanchor">9.29.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B6BCE9">Function <tt>call-update-expan=
der</tt></a></dt>
<dt><a name=3D"TOC-9.29.9" class=3D"tocanchor">9.29.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0223827D">Function <tt>call-clobber-expa=
nder</tt></a></dt>
<dt><a name=3D"TOC-9.29.10" class=3D"tocanchor">9.29.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-021E7CC3">Function <tt>call-delete-exp=
ander</tt></a></dt>
<dt><a name=3D"TOC-9.29.11" class=3D"tocanchor">9.29.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-006E03C4">Macro <tt>define-modify-macr=
o</tt></a></dt>
<dt><a name=3D"TOC-9.29.12" class=3D"tocanchor">9.29.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F92066">Macro <tt>defplace</tt></a><=
/dt>
<dt><a name=3D"TOC-9.29.13" class=3D"tocanchor">9.29.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0157E559">Macro <tt>defset</tt></a></d=
t>
<dt><a name=3D"TOC-9.29.14" class=3D"tocanchor">9.29.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C3089A">Macro <tt>define-place-macro=
</tt></a></dt>
<dt><a name=3D"TOC-9.29.15" class=3D"tocanchor">9.29.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-008212A0">Macro <tt>rlet</tt></a></dt>
<dt><a name=3D"TOC-9.29.16" class=3D"tocanchor">9.29.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00821260">Macro <tt>slet</tt></a></dt>
<dt><a name=3D"TOC-9.29.17" class=3D"tocanchor">9.29.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-008215E0">Macro <tt>alet</tt></a></dt>
<dt><a name=3D"TOC-9.29.18" class=3D"tocanchor">9.29.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C5F850">Macro <tt>define-accessor</t=
t></a></dt>
<dt><a name=3D"TOC-9.29.19" class=3D"tocanchor">9.29.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A2C58A">Special variables <tt>*place=
-update-expander*</tt>, <tt>*place-clobber-expander*</tt> and <tt>*place-de=
lete-expander*</tt></a></dt>
<dt><a name=3D"TOC-9.29.20" class=3D"tocanchor">9.29.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01B680E6">Special variable <tt>*place-=
macro*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.30" class=3D"tocanchor">9.30</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-020A71DB">Structural Pattern Matching</=
a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <t=
t>[+]</tt></a></dt>
<dd><dl id=3D"g0168" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.30.1" class=3D"tocanchor">9.30.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018E0BFD">Introduction</a></dt>
<dt><a name=3D"TOC-9.30.2" class=3D"tocanchor">9.30.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03706E73">Pattern Matching Operators</a>=
</dt>
<dt><a name=3D"TOC-9.30.3" class=3D"tocanchor">9.30.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0289A0A7">Syntax and Key Concepts</a></d=
t>
<dt><a name=3D"TOC-9.30.4" class=3D"tocanchor">9.30.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0119500B">Variables in Patterns</a></dt>
<dt><a name=3D"TOC-9.30.5" class=3D"tocanchor">9.30.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02914C7A">Comparison to Macro Parameter =
Lists</a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.31" class=3D"tocanchor">9.31</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-023B33E3">Pattern Matching Notation</a>=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>=
[+]</tt></a></dt>
<dd><dl id=3D"g0169" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.31.1" class=3D"tocanchor">9.31.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0372AD4F">Atom match</a></dt>
<dt><a name=3D"TOC-9.31.2" class=3D"tocanchor">9.31.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0195411E">Variable match</a></dt>
<dt><a name=3D"TOC-9.31.3" class=3D"tocanchor">9.31.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0272CE71">List match</a></dt>
<dt><a name=3D"TOC-9.31.4" class=3D"tocanchor">9.31.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01E67541">Vector match</a></dt>
<dt><a name=3D"TOC-9.31.5" class=3D"tocanchor">9.31.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0381AB6D">Range match</a></dt>
<dt><a name=3D"TOC-9.31.6" class=3D"tocanchor">9.31.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DE4A45">Pattern operator <tt>struct</t=
t></a></dt>
<dt><a name=3D"TOC-9.31.7" class=3D"tocanchor">9.31.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-020988A5">Pattern operator <tt>hash</tt>=
</a></dt>
<dt><a name=3D"TOC-9.31.8" class=3D"tocanchor">9.31.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-028B26DD">Pattern operator <tt>as</tt></=
a></dt>
<dt><a name=3D"TOC-9.31.9" class=3D"tocanchor">9.31.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03098987">Pattern operator <tt>with</tt>=
</a></dt>
<dt><a name=3D"TOC-9.31.10" class=3D"tocanchor">9.31.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0268BD16">Pattern operator <tt>require=
</tt></a></dt>
<dt><a name=3D"TOC-9.31.11" class=3D"tocanchor">9.31.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F6E2A2">Pattern operators <tt>all</t=
t> and <tt>all*</tt></a></dt>
<dt><a name=3D"TOC-9.31.12" class=3D"tocanchor">9.31.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-033989E1">Pattern operator <tt>some</t=
t></a></dt>
<dt><a name=3D"TOC-9.31.13" class=3D"tocanchor">9.31.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C98DE1">Pattern operator <tt>coll</t=
t></a></dt>
<dt><a name=3D"TOC-9.31.14" class=3D"tocanchor">9.31.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03A12201">Pattern operators <tt>and</t=
t> and <tt>or</tt></a></dt>
<dt><a name=3D"TOC-9.31.15" class=3D"tocanchor">9.31.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-003BC1A2">Pattern operator <tt>not</tt=
></a></dt>
<dt><a name=3D"TOC-9.31.16" class=3D"tocanchor">9.31.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02A534E4">Pattern predicate operator</=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.32" class=3D"tocanchor">9.32</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-021716E7">Pattern Matching Macros</a><a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+=
]</tt></a></dt>
<dd><dl id=3D"g0170" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.32.1" class=3D"tocanchor">9.32.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00CFBF5E">Macros <tt>when-match</tt> and=
 <tt>if-match</tt></a></dt>
<dt><a name=3D"TOC-9.32.2" class=3D"tocanchor">9.32.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-012DEAC3">Macro <tt>match-case</tt></a><=
/dt>
<dt><a name=3D"TOC-9.32.3" class=3D"tocanchor">9.32.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-031E43FF">Macro <tt>lambda-match</tt></a=
></dt>
<dt><a name=3D"TOC-9.32.4" class=3D"tocanchor">9.32.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02BF0F8C">Macro <tt>defun-match</tt></a>=
</dt>
<dt><a name=3D"TOC-9.32.5" class=3D"tocanchor">9.32.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B92C0D">Parameter list macro <tt>:matc=
h</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.33" class=3D"tocanchor">9.33</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0241C2DE">Quasiquote Operator Syntax</a=
><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt=
>[+]</tt></a></dt>
<dd><dl id=3D"g0171" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.33.1" class=3D"tocanchor">9.33.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01665185">Macro <tt>qquote</tt></a></dt>
<dt><a name=3D"TOC-9.33.2" class=3D"tocanchor">9.33.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-036B313D">Operator <tt>unquote</tt></a><=
/dt>
<dt><a name=3D"TOC-9.33.3" class=3D"tocanchor">9.33.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03BC798C">Operator <tt>splice</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.34" class=3D"tocanchor">9.34</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0043732C">Math Library</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0172" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.34.1" class=3D"tocanchor">9.34.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01F56DFE">Functions <tt>+</tt> and <tt>-=
</tt></a></dt>
<dt><a name=3D"TOC-9.34.2" class=3D"tocanchor">9.34.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008424F7">Function <tt>/</tt></a></dt>
<dt><a name=3D"TOC-9.34.3" class=3D"tocanchor">9.34.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0163FFE2">Functions <tt>sum</tt> and <tt=
>prod</tt></a></dt>
<dt><a name=3D"TOC-9.34.4" class=3D"tocanchor">9.34.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-026DDCEC">Functions <tt>wrap</tt> and <t=
t>wrap*</tt></a></dt>
<dt><a name=3D"TOC-9.34.5" class=3D"tocanchor">9.34.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D44645">Functions <tt>gcd</tt> and <tt=
>lcm</tt></a></dt>
<dt><a name=3D"TOC-9.34.6" class=3D"tocanchor">9.34.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02A088B3">Function <tt>divides</tt></a><=
/dt>
<dt><a name=3D"TOC-9.34.7" class=3D"tocanchor">9.34.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0297F537">Function <tt>abs</tt></a></dt>
<dt><a name=3D"TOC-9.34.8" class=3D"tocanchor">9.34.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03AD95A2">Function <tt>signum</tt></a></=
dt>
<dt><a name=3D"TOC-9.34.9" class=3D"tocanchor">9.34.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02084F55">Functions <tt>trunc</tt>, <tt>=
floor</tt>, <tt>ceil</tt> and <tt>round</tt></a></dt>
<dt><a name=3D"TOC-9.34.10" class=3D"tocanchor">9.34.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0047F5A8">Function <tt>mod</tt></a></d=
t>
<dt><a name=3D"TOC-9.34.11" class=3D"tocanchor">9.34.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02DE978F">Functions <tt>trunc-rem</tt>=
, <tt>floor-rem</tt>, <tt>ceil-rem</tt> and <tt>round-rem</tt></a></dt>
<dt><a name=3D"TOC-9.34.12" class=3D"tocanchor">9.34.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F5D388">Functions <tt>sin</tt>, <tt>=
cos</tt>, <tt>tan</tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt=
>atan2</tt></a></dt>
<dt><a name=3D"TOC-9.34.13" class=3D"tocanchor">9.34.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01DC05E9">Functions <tt>sinh</tt>, <tt=
>cosh</tt>, <tt>tanh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt=
></a></dt>
<dt><a name=3D"TOC-9.34.14" class=3D"tocanchor">9.34.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C4F18A">Functions <tt>exp</tt>, <tt>=
log</tt>, <tt>log10</tt> and <tt>log2</tt></a></dt>
<dt><a name=3D"TOC-9.34.15" class=3D"tocanchor">9.34.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0127A60B">Functions <tt>expt</tt>, <tt=
>sqrt</tt> and <tt>isqrt</tt></a></dt>
<dt><a name=3D"TOC-9.34.16" class=3D"tocanchor">9.34.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-034A37D0">Function <tt>exptmod</tt></a=
></dt>
<dt><a name=3D"TOC-9.34.17" class=3D"tocanchor">9.34.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012730BE">Function <tt>square</tt></a>=
</dt>
<dt><a name=3D"TOC-9.34.18" class=3D"tocanchor">9.34.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03AB449B">Function <tt>cum-norm-dist</=
tt></a></dt>
<dt><a name=3D"TOC-9.34.19" class=3D"tocanchor">9.34.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0036EAFB">Function <tt>inv-cum-norm</t=
t></a></dt>
<dt><a name=3D"TOC-9.34.20" class=3D"tocanchor">9.34.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02ACFDE6">Functions <tt>n-choose-k</tt=
> and <tt>n-perm-k</tt></a></dt>
<dt><a name=3D"TOC-9.34.21" class=3D"tocanchor">9.34.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">Functions <tt>fixnump</tt>, =
<tt>bignump</tt>, <tt>integerp</tt>, <tt>floatp</tt> and <tt>numberp</tt></=
a></dt>
<dt><a name=3D"TOC-9.34.22" class=3D"tocanchor">9.34.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0197FF9D">Functions <tt>zerop</tt> and=
 <tt>nzerop</tt></a></dt>
<dt><a name=3D"TOC-9.34.23" class=3D"tocanchor">9.34.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-019BF656">Functions <tt>plusp</tt> and=
 <tt>minusp</tt></a></dt>
<dt><a name=3D"TOC-9.34.24" class=3D"tocanchor">9.34.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02140809">Functions <tt>evenp</tt> and=
 <tt>oddp</tt></a></dt>
<dt><a name=3D"TOC-9.34.25" class=3D"tocanchor">9.34.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-038E636C">Functions <tt>succ</tt>, <tt=
>ssucc</tt>, <tt>sssucc</tt>, <tt>pred</tt>, <tt>ppred</tt> and <tt>pppred<=
/tt></a></dt>
<dt><a name=3D"TOC-9.34.26" class=3D"tocanchor">9.34.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02A1116F">Functions <tt>&gt;</tt>, <tt=
>&lt;</tt>, <tt>&gt;=3D</tt>, <tt>&lt;=3D</tt> and <tt>=3D</tt></a></dt>
<dt><a name=3D"TOC-9.34.27" class=3D"tocanchor">9.34.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-003BE40C">Function <tt>/=3D</tt></a></=
dt>
<dt><a name=3D"TOC-9.34.28" class=3D"tocanchor">9.34.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023C3643">Functions <tt>max</tt> and <=
tt>min</tt></a></dt>
<dt><a name=3D"TOC-9.34.29" class=3D"tocanchor">9.34.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B940D4">Function <tt>clamp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.34.30" class=3D"tocanchor">9.34.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02400F97">Function <tt>bracket</tt></a=
></dt>
<dt><a name=3D"TOC-9.34.31" class=3D"tocanchor">9.34.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-028043AE">Functions <tt>int-str</tt>, =
<tt>flo-str</tt> and <tt>num-str</tt></a></dt>
<dt><a name=3D"TOC-9.34.32" class=3D"tocanchor">9.34.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03F852CF">Functions <tt>int-flo</tt> a=
nd <tt>flo-int</tt></a></dt>
<dt><a name=3D"TOC-9.34.33" class=3D"tocanchor">9.34.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">Functions <tt>tofloat</tt> a=
nd <tt>toint</tt></a></dt>
<dt><a name=3D"TOC-9.34.34" class=3D"tocanchor">9.34.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02A6CE24">Variables <tt>fixnum-min</tt=
> and <tt>fixnum-max</tt></a></dt>
<dt><a name=3D"TOC-9.34.35" class=3D"tocanchor">9.34.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E2D4B8">Functions <tt>tofloatz</tt> =
and <tt>tointz</tt></a></dt>
<dt><a name=3D"TOC-9.34.36" class=3D"tocanchor">9.34.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0085F231">Variables <tt>flo-min</tt>, =
<tt>flo-max</tt> and <tt>flo-epsilon</tt></a></dt>
<dt><a name=3D"TOC-9.34.37" class=3D"tocanchor">9.34.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00998CE7">Variable <tt>flo-dig</tt></a=
></dt>
<dt><a name=3D"TOC-9.34.38" class=3D"tocanchor">9.34.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A2123A">Variable <tt>flo-max-dig</tt=
></a></dt>
<dt><a name=3D"TOC-9.34.39" class=3D"tocanchor">9.34.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03F0FA9E">Variables <tt>%pi%</tt> and =
<tt>%e%</tt></a></dt>
<dt><a name=3D"TOC-9.34.40" class=3D"tocanchor">9.34.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03CC559E">Function <tt>digits</tt></a>=
</dt>
<dt><a name=3D"TOC-9.34.41" class=3D"tocanchor">9.34.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-030C5561">Function <tt>digpow</tt></a>=
</dt>
<dt><a name=3D"TOC-9.34.42" class=3D"tocanchor">9.34.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-026201AD">Functions <tt>poly</tt> and =
<tt>rpoly</tt></a></dt>
<dt><a name=3D"TOC-9.34.43" class=3D"tocanchor">9.34.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-020294AB">Function <tt>bignum-len</tt>=
</a></dt>
<dt><a name=3D"TOC-9.34.44" class=3D"tocanchor">9.34.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-013A1643">Variables <tt>flo-near</tt>,=
 <tt>flo-down</tt>, <tt>flo-up</tt> and <tt>flo-zero</tt></a></dt>
<dt><a name=3D"TOC-9.34.45" class=3D"tocanchor">9.34.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0085ACA3">Functions <tt>flo-get-round-=
mode</tt> and <tt>flo-set-round-mode</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.35" class=3D"tocanchor">9.35</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00842C88">Bit Operations</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a=
></dt>
<dd><dl id=3D"g0173" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.35.1" class=3D"tocanchor">9.35.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D5AF97">Functions <tt>logand</tt>, <tt=
>logior</tt> and <tt>logxor</tt></a></dt>
<dt><a name=3D"TOC-9.35.2" class=3D"tocanchor">9.35.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00B1548A">Function <tt>logtest</tt></a><=
/dt>
<dt><a name=3D"TOC-9.35.3" class=3D"tocanchor">9.35.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006B7321">Functions <tt>lognot</tt> and =
<tt>logtrunc</tt></a></dt>
<dt><a name=3D"TOC-9.35.4" class=3D"tocanchor">9.35.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-026F9F46">Function <tt>sign-extend</tt><=
/a></dt>
<dt><a name=3D"TOC-9.35.5" class=3D"tocanchor">9.35.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0107F533">Function <tt>ash</tt></a></dt>
<dt><a name=3D"TOC-9.35.6" class=3D"tocanchor">9.35.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0347F5A4">Function <tt>bit</tt></a></dt>
<dt><a name=3D"TOC-9.35.7" class=3D"tocanchor">9.35.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0056CEF1">Function <tt>mask</tt></a></dt=
>
<dt><a name=3D"TOC-9.35.8" class=3D"tocanchor">9.35.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0121D13B">Function <tt>bitset</tt></a></=
dt>
<dt><a name=3D"TOC-9.35.9" class=3D"tocanchor">9.35.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0338F21A">Function <tt>width</tt></a></d=
t>
<dt><a name=3D"TOC-9.35.10" class=3D"tocanchor">9.35.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00A12EC7">Function <tt>logcount</tt></=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.36" class=3D"tocanchor">9.36</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-014C0223">User-Defined Arithmetic Types=
</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> =
<tt>[+]</tt></a></dt>
<dd><dl id=3D"g0174" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.36.1" class=3D"tocanchor">9.36.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-021396F7">Method <tt>+</tt></a></dt>
<dt><a name=3D"TOC-9.36.2" class=3D"tocanchor">9.36.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B396F7">Method <tt>-</tt></a></dt>
<dt><a name=3D"TOC-9.36.3" class=3D"tocanchor">9.36.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0234C408">Method <tt>--</tt></a></dt>
<dt><a name=3D"TOC-9.36.4" class=3D"tocanchor">9.36.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02C9F5F9">Method <tt>neg</tt></a></dt>
<dt><a name=3D"TOC-9.36.5" class=3D"tocanchor">9.36.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-022396F7">Method <tt>*</tt></a></dt>
<dt><a name=3D"TOC-9.36.6" class=3D"tocanchor">9.36.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D396F7">Method <tt>/</tt></a></dt>
<dt><a name=3D"TOC-9.36.7" class=3D"tocanchor">9.36.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0054C409">Method <tt>//</tt></a></dt>
<dt><a name=3D"TOC-9.36.8" class=3D"tocanchor">9.36.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B8BAB0">Method <tt>recip</tt></a></dt>
<dt><a name=3D"TOC-9.36.9" class=3D"tocanchor">9.36.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0309F553">Method <tt>abs</tt></a></dt>
<dt><a name=3D"TOC-9.36.10" class=3D"tocanchor">9.36.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03AA56EA">Method <tt>signum</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.11" class=3D"tocanchor">9.36.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E8C8B8">Method <tt>trunc</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.12" class=3D"tocanchor">9.36.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02CD7330">Method <tt>r-trunc</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.13" class=3D"tocanchor">9.36.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E91F51">Method <tt>trunc1</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.14" class=3D"tocanchor">9.36.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00D9F564">Method <tt>mod</tt></a></dt>
<dt><a name=3D"TOC-9.36.15" class=3D"tocanchor">9.36.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02F8C918">Method <tt>r-mod</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.16" class=3D"tocanchor">9.36.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0226C8EB">Method <tt>expt</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.17" class=3D"tocanchor">9.36.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00192012">Method <tt>r-expt</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.18" class=3D"tocanchor">9.36.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03462450">Method <tt>exptmod</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.19" class=3D"tocanchor">9.36.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F8DD02">Method <tt>isqrt</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.20" class=3D"tocanchor">9.36.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0129DBF6">Method <tt>square</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.21" class=3D"tocanchor">9.36.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0136D9F9">Method <tt>&gt;</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.22" class=3D"tocanchor">9.36.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0136D95D">Method <tt>&lt;</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.23" class=3D"tocanchor">9.36.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0388136A">Method <tt>&gt;=3D</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.24" class=3D"tocanchor">9.36.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-038809AA">Method <tt>&lt;=3D</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.25" class=3D"tocanchor">9.36.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B396F7">Method <tt>=3D</tt></a></dt>
<dt><a name=3D"TOC-9.36.26" class=3D"tocanchor">9.36.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B8A374">Method <tt>zerop</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.27" class=3D"tocanchor">9.36.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B8D135">Method <tt>plusp</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.28" class=3D"tocanchor">9.36.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02DDD586">Method <tt>minusp</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.29" class=3D"tocanchor">9.36.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B90BF9">Method <tt>evenp</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.30" class=3D"tocanchor">9.36.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E6D33E">Method <tt>oddp</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.31" class=3D"tocanchor">9.36.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D908C0">Method <tt>floor</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.32" class=3D"tocanchor">9.36.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BBC669">Method <tt>r-floor</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.33" class=3D"tocanchor">9.36.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01ED20D1">Method <tt>floor1</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.34" class=3D"tocanchor">9.36.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A6CAA5">Method <tt>ceil</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.35" class=3D"tocanchor">9.36.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0399208F">Method <tt>r-ceil</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.36" class=3D"tocanchor">9.36.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C8FF28">Method <tt>ceil1</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.37" class=3D"tocanchor">9.36.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03F8B9F8">Method <tt>round</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.38" class=3D"tocanchor">9.36.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031D7670">Method <tt>r-round</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.39" class=3D"tocanchor">9.36.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03EA1351">Method <tt>round1</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.40" class=3D"tocanchor">9.36.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0239F62C">Method <tt>sin</tt></a></dt>
<dt><a name=3D"TOC-9.36.41" class=3D"tocanchor">9.36.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0209F56C">Method <tt>cos</tt></a></dt>
<dt><a name=3D"TOC-9.36.42" class=3D"tocanchor">9.36.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0239F61E">Method <tt>tan</tt></a></dt>
<dt><a name=3D"TOC-9.36.43" class=3D"tocanchor">9.36.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0186CA8D">Method <tt>asin</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.44" class=3D"tocanchor">9.36.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B6C9CC">Method <tt>acos</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.45" class=3D"tocanchor">9.36.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0186CA7F">Method <tt>atan</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.46" class=3D"tocanchor">9.36.46</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00D8FB88">Method <tt>atan2</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.47" class=3D"tocanchor">9.36.47</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03BBA063">Method <tt>r-atan2</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.48" class=3D"tocanchor">9.36.48</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0266D697">Method <tt>sinh</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.49" class=3D"tocanchor">9.36.49</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0366CA96">Method <tt>cosh</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.50" class=3D"tocanchor">9.36.50</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0266D577">Method <tt>tanh</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.51" class=3D"tocanchor">9.36.51</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0338FCA8">Method <tt>asinh</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.52" class=3D"tocanchor">9.36.52</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0239109D">Method <tt>acosh</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.53" class=3D"tocanchor">9.36.53</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0338FB88">Method <tt>atanh</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.54" class=3D"tocanchor">9.36.54</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C9F560">Method <tt>log</tt></a></dt>
<dt><a name=3D"TOC-9.36.55" class=3D"tocanchor">9.36.55</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C6CADD">Method <tt>log2</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.56" class=3D"tocanchor">9.36.56</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01B901AD">Method <tt>log10</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.57" class=3D"tocanchor">9.36.57</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0119F541">Method <tt>exp</tt></a></dt>
<dt><a name=3D"TOC-9.36.58" class=3D"tocanchor">9.36.58</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0026D70F">Method <tt>sqrt</tt></a></dt=
>
<dt><a name=3D"TOC-9.36.59" class=3D"tocanchor">9.36.59</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011D877D">Method <tt>logand</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.60" class=3D"tocanchor">9.36.60</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02BD8EDD">Method <tt>logior</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.61" class=3D"tocanchor">9.36.61</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031D8ED1">Method <tt>lognot</tt></a></=
dt>
<dt><a name=3D"TOC-9.36.62" class=3D"tocanchor">9.36.62</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00495055">Method <tt>r-lognot</tt></a>=
</dt>
<dt><a name=3D"TOC-9.36.63" class=3D"tocanchor">9.36.63</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-019541E2">Method <tt>lognot1</tt></a><=
/dt>
<dt><a name=3D"TOC-9.36.64" class=3D"tocanchor">9.36.64</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000B2006">Method <tt>logtrunc</tt></a>=
</dt>
<dt><a name=3D"TOC-9.36.65" class=3D"tocanchor">9.36.65</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02439AC4">Method <tt>r-logtrunc</tt></=
a></dt>
<dt><a name=3D"TOC-9.36.66" class=3D"tocanchor">9.36.66</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01EFD64C">Method <tt>sign-extend</tt><=
/a></dt>
<dt><a name=3D"TOC-9.36.67" class=3D"tocanchor">9.36.67</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0099F56F">Method <tt>ash</tt></a></dt>
<dt><a name=3D"TOC-9.36.68" class=3D"tocanchor">9.36.68</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D9F568">Method <tt>bit</tt></a></dt>
<dt><a name=3D"TOC-9.36.69" class=3D"tocanchor">9.36.69</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0138CDB7">Method <tt>width</tt></a></d=
t>
<dt><a name=3D"TOC-9.36.70" class=3D"tocanchor">9.36.70</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E186C6">Method <tt>logcount</tt></a>=
</dt>
<dt><a name=3D"TOC-9.36.71" class=3D"tocanchor">9.36.71</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011DFB63">Method <tt>bitset</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.37" class=3D"tocanchor">9.37</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0146B946">Exception Handling</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0175" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.37.1" class=3D"tocanchor">9.37.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0128B9FE">Catches and Handlers</a></dt>
<dt><a name=3D"TOC-9.37.2" class=3D"tocanchor">9.37.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00D2CFDD">Handlers and Sandboxing</a></d=
t>
<dt><a name=3D"TOC-9.37.3" class=3D"tocanchor">9.37.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01E13B7A">Exception Type Hierarchy</a></=
dt>
<dt><a name=3D"TOC-9.37.4" class=3D"tocanchor">9.37.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F77525">Dialect Notes</a></dt>
<dt><a name=3D"TOC-9.37.5" class=3D"tocanchor">9.37.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-015466AD">Functions <tt>throw</tt>, <tt>=
throwf</tt> and <tt>error</tt></a></dt>
<dt><a name=3D"TOC-9.37.6" class=3D"tocanchor">9.37.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0211F3D3">Macros <tt>catch</tt>, <tt>cat=
ch*</tt> and <tt>catch**</tt></a></dt>
<dt><a name=3D"TOC-9.37.7" class=3D"tocanchor">9.37.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03162B0C">Operator <tt>unwind-protect</t=
t></a></dt>
<dt><a name=3D"TOC-9.37.8" class=3D"tocanchor">9.37.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-007287AC">Macro <tt>ignerr</tt></a></dt>
<dt><a name=3D"TOC-9.37.9" class=3D"tocanchor">9.37.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02552A58">Macro <tt>ignwarn</tt></a></dt=
>
<dt><a name=3D"TOC-9.37.10" class=3D"tocanchor">9.37.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">Operator <tt>handler-bind</t=
t></a></dt>
<dt><a name=3D"TOC-9.37.11" class=3D"tocanchor">9.37.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">Macros <tt>handle</tt> and <=
tt>handle*</tt></a></dt>
<dt><a name=3D"TOC-9.37.12" class=3D"tocanchor">9.37.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012CE06E">Macro <tt>with-resources</tt=
></a></dt>
<dt><a name=3D"TOC-9.37.13" class=3D"tocanchor">9.37.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B4A4FB">Special variable <tt>*unhand=
led-hook*</tt></a></dt>
<dt><a name=3D"TOC-9.37.14" class=3D"tocanchor">9.37.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00ECE51D">Macro <tt>defex</tt></a></dt=
>
<dt><a name=3D"TOC-9.37.15" class=3D"tocanchor">9.37.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-005EB97F">Function <tt>register-except=
ion-subtypes</tt></a></dt>
<dt><a name=3D"TOC-9.37.16" class=3D"tocanchor">9.37.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E7F869">Function <tt>exception-subty=
pe-p</tt></a></dt>
<dt><a name=3D"TOC-9.37.17" class=3D"tocanchor">9.37.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03ABFA6D">Function <tt>exception-subty=
pe-map</tt></a></dt>
<dt><a name=3D"TOC-9.37.18" class=3D"tocanchor">9.37.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0233BAE3">Structures <tt>frame</tt>, <=
tt>catch-frame</tt> and <tt>handle-frame</tt></a></dt>
<dt><a name=3D"TOC-9.37.19" class=3D"tocanchor">9.37.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-010405DA">Function <tt>get-frames</tt>=
</a></dt>
<dt><a name=3D"TOC-9.37.20" class=3D"tocanchor">9.37.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B97226">Functions <tt>find-frame</tt=
> and <tt>find-frames</tt></a></dt>
<dt><a name=3D"TOC-9.37.21" class=3D"tocanchor">9.37.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0337FC1B">Function <tt>invoke-catch</t=
t></a></dt>
<dt><a name=3D"TOC-9.37.22" class=3D"tocanchor">9.37.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-005A3A6C">Macro <tt>assert</tt></a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-9.38" class=3D"tocanchor">9.38</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-03351EE7">Static Error Diagnosis</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0176" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.38.1" class=3D"tocanchor">9.38.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-000C4E3D">Error Exceptions</a></dt>
<dt><a name=3D"TOC-9.38.2" class=3D"tocanchor">9.38.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03C48985">Warning Exceptions</a></dt>
<dt><a name=3D"TOC-9.38.3" class=3D"tocanchor">9.38.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02BB661C">Deferrable Warnings</a></dt>
<dt><a name=3D"TOC-9.38.4" class=3D"tocanchor">9.38.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-032EA7D7">Functions <tt>compile-error</t=
t> and <tt>compile-warning</tt></a></dt>
<dt><a name=3D"TOC-9.38.5" class=3D"tocanchor">9.38.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0205E7AF">Function <tt>compile-defr-warn=
ing</tt></a></dt>
<dt><a name=3D"TOC-9.38.6" class=3D"tocanchor">9.38.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0077C4FE">Function <tt>purge-deferred-wa=
rning</tt></a></dt>
<dt><a name=3D"TOC-9.38.7" class=3D"tocanchor">9.38.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033CBAA9">Function <tt>register-tentativ=
e-def</tt></a></dt>
<dt><a name=3D"TOC-9.38.8" class=3D"tocanchor">9.38.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0186D1B7">Function <tt>tentative-def-exi=
sts</tt></a></dt>
<dt><a name=3D"TOC-9.38.9" class=3D"tocanchor">9.38.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-001106AB">Function <tt>defer-warning</tt=
></a></dt>
<dt><a name=3D"TOC-9.38.10" class=3D"tocanchor">9.38.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012F0BE9">Function <tt>release-deferre=
d-warnings</tt></a></dt>
<dt><a name=3D"TOC-9.38.11" class=3D"tocanchor">9.38.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0335651E">Function <tt>dump-deferred-w=
arnings</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.39" class=3D"tocanchor">9.39</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01C4E6B4">Delimited Continuations</a><a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+=
]</tt></a></dt>
<dd><dl id=3D"g0177" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.39.1" class=3D"tocanchor">9.39.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03404858">Comparison with Lexical Closur=
es</a></dt>
<dt><a name=3D"TOC-9.39.2" class=3D"tocanchor">9.39.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02608659">Differences in Compiled vs. In=
terpreted Behavior</a></dt>
<dt><a name=3D"TOC-9.39.3" class=3D"tocanchor">9.39.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02199305">Function <tt>sys:capture-cont<=
/tt></a></dt>
<dt><a name=3D"TOC-9.39.4" class=3D"tocanchor">9.39.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E20FE2">Operator <tt>sys:abscond-from<=
/tt></a></dt>
<dt><a name=3D"TOC-9.39.5" class=3D"tocanchor">9.39.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02DF20E5">Function <tt>sys:abscond*</tt>=
</a></dt>
<dt><a name=3D"TOC-9.39.6" class=3D"tocanchor">9.39.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01556613">Macros <tt>obtain</tt> and <tt=
>yield-from</tt></a></dt>
<dt><a name=3D"TOC-9.39.7" class=3D"tocanchor">9.39.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01C791D0">Macro <tt>obtain-block</tt></a=
></dt>
<dt><a name=3D"TOC-9.39.8" class=3D"tocanchor">9.39.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02AE5C1E">Macro <tt>yield</tt></a></dt>
<dt><a name=3D"TOC-9.39.9" class=3D"tocanchor">9.39.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0102F0EB">Macros <tt>obtain*</tt> and <t=
t>obtain*-block</tt></a></dt>
<dt><a name=3D"TOC-9.39.10" class=3D"tocanchor">9.39.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E7852D">Macro <tt>suspend</tt></a></=
dt>
<dt><a name=3D"TOC-9.39.11" class=3D"tocanchor">9.39.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01348099">Macros <tt>hlet</tt> and <tt=
>hlet*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.40" class=3D"tocanchor">9.40</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0272B88D">Regular Expression Library</a=
><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt=
>[+]</tt></a></dt>
<dd><dl id=3D"g0178" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.40.1" class=3D"tocanchor">9.40.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-020216B7">Regular Expressions as Functio=
ns</a></dt>
<dt><a name=3D"TOC-9.40.2" class=3D"tocanchor">9.40.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0250D465">Functions <tt>search-regex</tt=
>, <tt>range-regex</tt> and <tt>search-regst</tt></a></dt>
<dt><a name=3D"TOC-9.40.3" class=3D"tocanchor">9.40.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E3A26F">Functions <tt>match-regex</tt>=
 and <tt>match-regst</tt></a></dt>
<dt><a name=3D"TOC-9.40.4" class=3D"tocanchor">9.40.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019430C5">Functions <tt>match-regex-righ=
t</tt> and <tt>match-regst-right</tt></a></dt>
<dt><a name=3D"TOC-9.40.5" class=3D"tocanchor">9.40.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02CE60DF">Function <tt>regex-prefix-matc=
h</tt></a></dt>
<dt><a name=3D"TOC-9.40.6" class=3D"tocanchor">9.40.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03BDC5F6">Function <tt>regsub</tt></a></=
dt>
<dt><a name=3D"TOC-9.40.7" class=3D"tocanchor">9.40.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DDC533">Function <tt>regexp</tt></a></=
dt>
<dt><a name=3D"TOC-9.40.8" class=3D"tocanchor">9.40.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00CF29CC">Functions <tt>trim-left</tt> a=
nd <tt>trim-right</tt></a></dt>
<dt><a name=3D"TOC-9.40.9" class=3D"tocanchor">9.40.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0168C611">Function <tt>regex-compile</tt=
></a></dt>
<dt><a name=3D"TOC-9.40.10" class=3D"tocanchor">9.40.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0218BD2B">Function <tt>regex-source</t=
t></a></dt>
<dt><a name=3D"TOC-9.40.11" class=3D"tocanchor">9.40.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C9C361">Function <tt>regex-parse</tt=
></a></dt>
<dt><a name=3D"TOC-9.40.12" class=3D"tocanchor">9.40.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-001D3F81">Function <tt>read-until-matc=
h</tt></a></dt>
<dt><a name=3D"TOC-9.40.13" class=3D"tocanchor">9.40.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00EFD668">Functions <tt>scan-until-mat=
ch</tt> and <tt>count-until-match</tt></a></dt>
<dt><a name=3D"TOC-9.40.14" class=3D"tocanchor">9.40.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02F44ECE">Functions <tt>m^$</tt>, <tt>=
m^</tt> and <tt>m$</tt></a></dt>
<dt><a name=3D"TOC-9.40.15" class=3D"tocanchor">9.40.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">Functions <tt>r^$</tt>, <tt>=
r^</tt>, <tt>r$</tt> and <tt>rr</tt></a></dt>
<dt><a name=3D"TOC-9.40.16" class=3D"tocanchor">9.40.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0177F5FF">Function <tt>rra</tt></a></d=
t>
<dt><a name=3D"TOC-9.40.17" class=3D"tocanchor">9.40.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000B5ACD">Functions <tt>f^$</tt>, <tt>=
f^</tt> and <tt>f$</tt></a></dt>
<dt><a name=3D"TOC-9.40.18" class=3D"tocanchor">9.40.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031971BD">Functions <tt>fr^$</tt>, <tt=
>fr^</tt>, <tt>fr$</tt> and <tt>frr</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.41" class=3D"tocanchor">9.41</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01559C04">Hashing Library</a><a href=3D=
"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></=
a></dt>
<dd><dl id=3D"g0179" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.41.1" class=3D"tocanchor">9.41.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-026D4158">Functions <tt>make-hash</tt> a=
nd <tt>hash</tt></a></dt>
<dt><a name=3D"TOC-9.41.2" class=3D"tocanchor">9.41.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-017E6F4C">Functions <tt>hash-construct</=
tt>, <tt>hash-from-pairs</tt> and <tt>hash-from-alist</tt></a></dt>
<dt><a name=3D"TOC-9.41.3" class=3D"tocanchor">9.41.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02EE9235">Function <tt>hash-list</tt></a=
></dt>
<dt><a name=3D"TOC-9.41.4" class=3D"tocanchor">9.41.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02767282">Function <tt>hash-zip</tt></a>=
</dt>
<dt><a name=3D"TOC-9.41.5" class=3D"tocanchor">9.41.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02DBCCC8">Function <tt>hash-update</tt><=
/a></dt>
<dt><a name=3D"TOC-9.41.6" class=3D"tocanchor">9.41.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03EF9A2C">Function <tt>hash-update-1</tt=
></a></dt>
<dt><a name=3D"TOC-9.41.7" class=3D"tocanchor">9.41.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02F6F229">Function <tt>group-by</tt></a>=
</dt>
<dt><a name=3D"TOC-9.41.8" class=3D"tocanchor">9.41.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-001A208F">Function <tt>group-reduce</tt>=
</a></dt>
<dt><a name=3D"TOC-9.41.9" class=3D"tocanchor">9.41.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-030E3A4A">Functions <tt>make-similar-has=
h</tt> and <tt>copy-hash</tt></a></dt>
<dt><a name=3D"TOC-9.41.10" class=3D"tocanchor">9.41.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0161147E">Function <tt>inhash</tt></a>=
</dt>
<dt><a name=3D"TOC-9.41.11" class=3D"tocanchor">9.41.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0203B5FA">Accessor <tt>gethash</tt></a=
></dt>
<dt><a name=3D"TOC-9.41.12" class=3D"tocanchor">9.41.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0025A17A">Function <tt>sethash</tt></a=
></dt>
<dt><a name=3D"TOC-9.41.13" class=3D"tocanchor">9.41.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-022660B2">Function <tt>pushhash</tt></=
a></dt>
<dt><a name=3D"TOC-9.41.14" class=3D"tocanchor">9.41.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0029C57A">Function <tt>remhash</tt></a=
></dt>
<dt><a name=3D"TOC-9.41.15" class=3D"tocanchor">9.41.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00836D97">Function <tt>clearhash</tt><=
/a></dt>
<dt><a name=3D"TOC-9.41.16" class=3D"tocanchor">9.41.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00766C80">Function <tt>hash-count</tt>=
</a></dt>
<dt><a name=3D"TOC-9.41.17" class=3D"tocanchor">9.41.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-038C1CEB">Accessor <tt>hash-userdata</=
tt></a></dt>
<dt><a name=3D"TOC-9.41.18" class=3D"tocanchor">9.41.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-030B41A7">Function <tt>get-hash-userda=
ta</tt></a></dt>
<dt><a name=3D"TOC-9.41.19" class=3D"tocanchor">9.41.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-030B40A7">Function <tt>set-hash-userda=
ta</tt></a></dt>
<dt><a name=3D"TOC-9.41.20" class=3D"tocanchor">9.41.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B947EC">Function <tt>hashp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.41.21" class=3D"tocanchor">9.41.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E6917D">Function <tt>maphash</tt></a=
></dt>
<dt><a name=3D"TOC-9.41.22" class=3D"tocanchor">9.41.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02FBE776">Functions <tt>hash-revget</t=
t> and <tt>hash-keys-of</tt></a></dt>
<dt><a name=3D"TOC-9.41.23" class=3D"tocanchor">9.41.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01D4F138">Function <tt>hash-invert</tt=
></a></dt>
<dt><a name=3D"TOC-9.41.24" class=3D"tocanchor">9.41.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0000455E">Functions <tt>hash-eql</tt> =
and <tt>hash-equal</tt></a></dt>
<dt><a name=3D"TOC-9.41.25" class=3D"tocanchor">9.41.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01BD56A5">Functions <tt>hash_keys</tt>=
, <tt>hash_values</tt>, <tt>hash_pairs</tt> and <tt>hash_alist</tt></a></dt=
>
<dt><a name=3D"TOC-9.41.26" class=3D"tocanchor">9.41.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-039105E8">Operator <tt>dohash</tt></a>=
</dt>
<dt><a name=3D"TOC-9.41.27" class=3D"tocanchor">9.41.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02235BB2">Functions <tt>hash-uni</tt>,=
 <tt>hash-diff</tt>, <tt>hash-symdiff</tt> and <tt>hash-isec</tt></a></dt>
<dt><a name=3D"TOC-9.41.28" class=3D"tocanchor">9.41.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-024ACBBB">Functions <tt>hash-subset</t=
t> and <tt>hash-proper-subset</tt></a></dt>
<dt><a name=3D"TOC-9.41.29" class=3D"tocanchor">9.41.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0225209D">Functions <tt>hash-begin</tt=
>, <tt>hash-reset</tt>, <tt>hash-next</tt> and <tt>hash-peek</tt></a></dt>
<dt><a name=3D"TOC-9.41.30" class=3D"tocanchor">9.41.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-001B79C0">Macro <tt>with-hash-iter</tt=
></a></dt>
<dt><a name=3D"TOC-9.41.31" class=3D"tocanchor">9.41.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0041D85A">Special variable <tt>*hash-s=
eed*</tt></a></dt>
<dt><a name=3D"TOC-9.41.32" class=3D"tocanchor">9.41.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002CFA72">Function <tt>gen-hash-seed</=
tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.42" class=3D"tocanchor">9.42</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00E1FEB3">Search Tree Library</a><a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</t=
t></a></dt>
<dd><dl id=3D"g0180" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.42.1" class=3D"tocanchor">9.42.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0008DDFB">Function <tt>tnode</tt></a></d=
t>
<dt><a name=3D"TOC-9.42.2" class=3D"tocanchor">9.42.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00D8534F">Function <tt>tnodep</tt></a></=
dt>
<dt><a name=3D"TOC-9.42.3" class=3D"tocanchor">9.42.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-020D5C1D">Accessors <tt>key</tt>, <tt>le=
ft</tt> and <tt>right</tt></a></dt>
<dt><a name=3D"TOC-9.42.4" class=3D"tocanchor">9.42.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033F7D05">Functions <tt>set-key</tt>, <t=
t>set-left</tt> and <tt>set-right</tt></a></dt>
<dt><a name=3D"TOC-9.42.5" class=3D"tocanchor">9.42.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018A17C0">Function <tt>copy-tnode</tt></=
a></dt>
<dt><a name=3D"TOC-9.42.6" class=3D"tocanchor">9.42.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02F6D50B">Function <tt>tree</tt></a></dt=
>
<dt><a name=3D"TOC-9.42.7" class=3D"tocanchor">9.42.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B8E442">Function <tt>treep</tt></a></d=
t>
<dt><a name=3D"TOC-9.42.8" class=3D"tocanchor">9.42.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008B4AD9">Function <tt>tree-insert-node<=
/tt></a></dt>
<dt><a name=3D"TOC-9.42.9" class=3D"tocanchor">9.42.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-034ADC20">Function <tt>tree-insert-node<=
/tt></a></dt>
<dt><a name=3D"TOC-9.42.10" class=3D"tocanchor">9.42.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03FE4877">Function <tt>tree-lookup-nod=
e</tt></a></dt>
<dt><a name=3D"TOC-9.42.11" class=3D"tocanchor">9.42.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01D63E47">Function <tt>tree-lookup</tt=
></a></dt>
<dt><a name=3D"TOC-9.42.12" class=3D"tocanchor">9.42.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00772FAE">Function <tt>tree-delete-nod=
e</tt></a></dt>
<dt><a name=3D"TOC-9.42.13" class=3D"tocanchor">9.42.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-022035DF">Function <tt>tree-delete</tt=
></a></dt>
<dt><a name=3D"TOC-9.42.14" class=3D"tocanchor">9.42.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0149BF2D">Function <tt>tree-root</tt><=
/a></dt>
<dt><a name=3D"TOC-9.42.15" class=3D"tocanchor">9.42.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C88274">Function <tt>tree-clear</tt>=
</a></dt>
<dt><a name=3D"TOC-9.42.16" class=3D"tocanchor">9.42.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01EBE427">Function <tt>copy-search-tre=
e</tt></a></dt>
<dt><a name=3D"TOC-9.42.17" class=3D"tocanchor">9.42.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02887FCA">Function <tt>tree-begin</tt>=
</a></dt>
<dt><a name=3D"TOC-9.42.18" class=3D"tocanchor">9.42.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0049D1B0">Function <tt>tree-next</tt><=
/a></dt>
<dt><a name=3D"TOC-9.42.19" class=3D"tocanchor">9.42.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-025AB9C9">Special variable <tt>*tree-f=
un-whitelist*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.43" class=3D"tocanchor">9.43</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-038348D3">Partial Evaluation and Combin=
ators</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"togg=
le"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0181" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.43.1" class=3D"tocanchor">9.43.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0068EA9D">Macros <tt>op</tt> and <tt>do<=
/tt></a></dt>
<dt><a name=3D"TOC-9.43.2" class=3D"tocanchor">9.43.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-017F3A22">Macro <tt>lop</tt></a></dt>
<dt><a name=3D"TOC-9.43.3" class=3D"tocanchor">9.43.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03EF3A27">Macro <tt>ldo</tt></a></dt>
<dt><a name=3D"TOC-9.43.4" class=3D"tocanchor">9.43.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00BE749A">Macros <tt>ap</tt>, <tt>ip</tt=
>, <tt>ado</tt> and <tt>ido.</tt></a></dt>
<dt><a name=3D"TOC-9.43.5" class=3D"tocanchor">9.43.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01937C5A">Macros <tt>opip</tt> and <tt>o=
and</tt></a></dt>
<dt><a name=3D"TOC-9.43.6" class=3D"tocanchor">9.43.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033F39EF">Macro <tt>ret</tt></a></dt>
<dt><a name=3D"TOC-9.43.7" class=3D"tocanchor">9.43.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008216A8">Macro <tt>aret</tt></a></dt>
<dt><a name=3D"TOC-9.43.8" class=3D"tocanchor">9.43.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0387F549">Function <tt>dup</tt></a></dt>
<dt><a name=3D"TOC-9.43.9" class=3D"tocanchor">9.43.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D06BA4">Function <tt>flipargs</tt></a>=
</dt>
<dt><a name=3D"TOC-9.43.10" class=3D"tocanchor">9.43.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C53CF7">Functions <tt>chain</tt> and=
 <tt>chand</tt></a></dt>
<dt><a name=3D"TOC-9.43.11" class=3D"tocanchor">9.43.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0106CD7F">Function <tt>juxt</tt></a></=
dt>
<dt><a name=3D"TOC-9.43.12" class=3D"tocanchor">9.43.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">Functions <tt>andf</tt> and =
<tt>orf</tt></a></dt>
<dt><a name=3D"TOC-9.43.13" class=3D"tocanchor">9.43.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0026CE18">Function <tt>notf</tt></a></=
dt>
<dt><a name=3D"TOC-9.43.14" class=3D"tocanchor">9.43.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000E3A74">Functions <tt>iff</tt> and <=
tt>iffi</tt></a></dt>
<dt><a name=3D"TOC-9.43.15" class=3D"tocanchor">9.43.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-032070EB">Functions <tt>tf</tt> and <t=
t>nilf</tt></a></dt>
<dt><a name=3D"TOC-9.43.16" class=3D"tocanchor">9.43.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0026CB20">Function <tt>retf</tt></a></=
dt>
<dt><a name=3D"TOC-9.43.17" class=3D"tocanchor">9.43.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012A7E6A">Functions <tt>apf</tt> and <=
tt>ipf</tt></a></dt>
<dt><a name=3D"TOC-9.43.18" class=3D"tocanchor">9.43.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00192C21">Function <tt>callf</tt></a><=
/dt>
<dt><a name=3D"TOC-9.43.19" class=3D"tocanchor">9.43.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0026CEF1">Function <tt>mapf</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.44" class=3D"tocanchor">9.44</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-019F37B4">Input and Output (Streams)</a=
><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt=
>[+]</tt></a></dt>
<dd><dl id=3D"g0182" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.44.1" class=3D"tocanchor">9.44.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006566FB">Special variables <tt>*stdout*=
</tt>, <tt>*stddebug*</tt>, <tt>*stdin*</tt>, <tt>*stderr*</tt> and <tt>*st=
dnull*</tt></a></dt>
<dt><a name=3D"TOC-9.44.2" class=3D"tocanchor">9.44.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B252AA">Special variables <tt>*print-f=
lo-format*</tt> and <tt>*pprint-flo-format*</tt></a></dt>
<dt><a name=3D"TOC-9.44.3" class=3D"tocanchor">9.44.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E97D03">Special variable <tt>*print-fl=
o-precision*</tt></a></dt>
<dt><a name=3D"TOC-9.44.4" class=3D"tocanchor">9.44.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F41F6C">Special variable <tt>*print-fl=
o-digits*</tt></a></dt>
<dt><a name=3D"TOC-9.44.5" class=3D"tocanchor">9.44.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01DD07CC">Special variable <tt>*print-ba=
se*</tt></a></dt>
<dt><a name=3D"TOC-9.44.6" class=3D"tocanchor">9.44.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01FC9977">Special variable <tt>*print-ci=
rcle*</tt></a></dt>
<dt><a name=3D"TOC-9.44.7" class=3D"tocanchor">9.44.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-011ACA52">Function <tt>format</tt></a></=
dt>
<dt><a name=3D"TOC-9.44.8" class=3D"tocanchor">9.44.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0347F537">Function <tt>fmt</tt></a></dt>
<dt><a name=3D"TOC-9.44.9" class=3D"tocanchor">9.44.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FCCE0D">Functions <tt>print</tt>, <tt>=
pprint</tt>, <tt>prinl</tt>, <tt>pprinl</tt>, <tt>tostring</tt> and <tt>tos=
tringp</tt></a></dt>
<dt><a name=3D"TOC-9.44.10" class=3D"tocanchor">9.44.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0217DE45">Function <tt>tprint</tt></a>=
</dt>
<dt><a name=3D"TOC-9.44.11" class=3D"tocanchor">9.44.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0263C039">Function <tt>display-width</=
tt></a></dt>
<dt><a name=3D"TOC-9.44.12" class=3D"tocanchor">9.44.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02BB4421">Function <tt>streamp</tt></a=
></dt>
<dt><a name=3D"TOC-9.44.13" class=3D"tocanchor">9.44.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0121FDEB">Function <tt>real-time-strea=
m-p</tt></a></dt>
<dt><a name=3D"TOC-9.44.14" class=3D"tocanchor">9.44.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">Function <tt>open-file</tt><=
/a></dt>
<dt><a name=3D"TOC-9.44.15" class=3D"tocanchor">9.44.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0348F89A">Function <tt>open-tail</tt><=
/a></dt>
<dt><a name=3D"TOC-9.44.16" class=3D"tocanchor">9.44.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0221AE09">Function <tt>open-directory<=
/tt></a></dt>
<dt><a name=3D"TOC-9.44.17" class=3D"tocanchor">9.44.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F0B9B0">Function <tt>make-string-inp=
ut-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.18" class=3D"tocanchor">9.44.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-022937CD">Function <tt>make-string-byt=
e-input-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.19" class=3D"tocanchor">9.44.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01737CF9">Function <tt>make-strlist-in=
put-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.20" class=3D"tocanchor">9.44.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0144BF51">Function <tt>make-string-out=
put-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.21" class=3D"tocanchor">9.44.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-037412EE">Function <tt>get-string-from=
-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.22" class=3D"tocanchor">9.44.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00F363E0">Function <tt>make-strlist-ou=
tput-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.23" class=3D"tocanchor">9.44.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-021DF087">Function <tt>get-list-from-s=
tream</tt></a></dt>
<dt><a name=3D"TOC-9.44.24" class=3D"tocanchor">9.44.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-004ED7A0">Macro <tt>with-in-string-str=
eam</tt></a></dt>
<dt><a name=3D"TOC-9.44.25" class=3D"tocanchor">9.44.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00FD832E">Macro <tt>with-in-string-byt=
e-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.26" class=3D"tocanchor">9.44.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0001C63C">Macro <tt>with-out-string-st=
ream</tt></a></dt>
<dt><a name=3D"TOC-9.44.27" class=3D"tocanchor">9.44.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-024F86B3">Macro <tt>with-out-strlist-s=
tream</tt></a></dt>
<dt><a name=3D"TOC-9.44.28" class=3D"tocanchor">9.44.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03F54E14">Function <tt>make-byte-input=
-stream</tt></a></dt>
<dt><a name=3D"TOC-9.44.29" class=3D"tocanchor">9.44.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00596930">Function <tt>close-stream</t=
t></a></dt>
<dt><a name=3D"TOC-9.44.30" class=3D"tocanchor">9.44.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-013E33A2">Macro <tt>with-stream</tt></=
a></dt>
<dt><a name=3D"TOC-9.44.31" class=3D"tocanchor">9.44.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01060C4A">Functions <tt>get-error</tt>=
, <tt>get-error-str</tt> and <tt>clear-error</tt></a></dt>
<dt><a name=3D"TOC-9.44.32" class=3D"tocanchor">9.44.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01EF7E47">Functions <tt>get-line</tt>,=
 <tt>get-char</tt> and <tt>get-byte</tt></a></dt>
<dt><a name=3D"TOC-9.44.33" class=3D"tocanchor">9.44.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BE9AAC">Function <tt>get-string</tt>=
</a></dt>
<dt><a name=3D"TOC-9.44.34" class=3D"tocanchor">9.44.34</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0260DBDD">Functions <tt>unget-char</tt=
> and <tt>unget-byte</tt></a></dt>
<dt><a name=3D"TOC-9.44.35" class=3D"tocanchor">9.44.35</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-012163C3">Functions <tt>put-string</tt=
>, <tt>put-line</tt>, <tt>put-char</tt> and <tt>put-byte</tt></a></dt>
<dt><a name=3D"TOC-9.44.36" class=3D"tocanchor">9.44.36</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0367B282">Functions <tt>put-strings</t=
t> and <tt>put-lines</tt></a></dt>
<dt><a name=3D"TOC-9.44.37" class=3D"tocanchor">9.44.37</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03999913">Function <tt>flush-stream</t=
t></a></dt>
<dt><a name=3D"TOC-9.44.38" class=3D"tocanchor">9.44.38</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-031B5075">Function <tt>seek-stream</tt=
></a></dt>
<dt><a name=3D"TOC-9.44.39" class=3D"tocanchor">9.44.39</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-009F5B3F">Function <tt>truncate-stream=
</tt></a></dt>
<dt><a name=3D"TOC-9.44.40" class=3D"tocanchor">9.44.40</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-005268C8">Functions <tt>stream-get-pro=
p</tt> and <tt>stream-set-prop</tt></a></dt>
<dt><a name=3D"TOC-9.44.41" class=3D"tocanchor">9.44.41</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-020BF082">Functions <tt>make-catenated=
-stream</tt> and <tt>cat-streams</tt></a></dt>
<dt><a name=3D"TOC-9.44.42" class=3D"tocanchor">9.44.42</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-021EE493">Function <tt>catenated-strea=
m-p</tt></a></dt>
<dt><a name=3D"TOC-9.44.43" class=3D"tocanchor">9.44.43</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0050A46A">Function <tt>catenated-strea=
m-push</tt></a></dt>
<dt><a name=3D"TOC-9.44.44" class=3D"tocanchor">9.44.44</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-018C5606">Functions <tt>open-files</tt=
> and <tt>open-files*</tt></a></dt>
<dt><a name=3D"TOC-9.44.45" class=3D"tocanchor">9.44.45</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0255B4F1">Function <tt>abs-path-p</tt>=
</a></dt>
<dt><a name=3D"TOC-9.44.46" class=3D"tocanchor">9.44.46</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-019DEA44">Function <tt>pure-rel-path-p=
</tt></a></dt>
<dt><a name=3D"TOC-9.44.47" class=3D"tocanchor">9.44.47</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C01721">Functions <tt>dir-name</tt> =
and <tt>base-name</tt></a></dt>
<dt><a name=3D"TOC-9.44.48" class=3D"tocanchor">9.44.48</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0033B27E">Function <tt>path-cat</tt></=
a></dt>
<dt><a name=3D"TOC-9.44.49" class=3D"tocanchor">9.44.49</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03985DE5">Variable <tt>path-sep-chars<=
/tt></a></dt>
<dt><a name=3D"TOC-9.44.50" class=3D"tocanchor">9.44.50</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03FE5500">Functions <tt>read</tt> and =
<tt>iread</tt></a></dt>
<dt><a name=3D"TOC-9.44.51" class=3D"tocanchor">9.44.51</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-009C0AC4">Function <tt>record-adapter<=
/tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.45" class=3D"tocanchor">9.45</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01691F81">Stream Output Indentation</a>=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>=
[+]</tt></a></dt>
<dd><dl id=3D"g0183" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.45.1" class=3D"tocanchor">9.45.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00512FDD">Variables <tt>indent-off</tt>,=
 <tt>indent-data</tt>, <tt>indent-code</tt> and <tt>indent-foff</tt></a></d=
t>
<dt><a name=3D"TOC-9.45.2" class=3D"tocanchor">9.45.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F3170C">Functions <tt>get-indent-mode<=
/tt> and <tt>set-indent-mode</tt></a></dt>
<dt><a name=3D"TOC-9.45.3" class=3D"tocanchor">9.45.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A1F89C">Functions <tt>test-set-indent-=
mode</tt> and <tt>test-neq-set-indent-mode</tt></a></dt>
<dt><a name=3D"TOC-9.45.4" class=3D"tocanchor">9.45.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-024E9FD8">Functions <tt>get-indent</tt>,=
 <tt>set-indent</tt> and <tt>inc-indent</tt></a></dt>
<dt><a name=3D"TOC-9.45.5" class=3D"tocanchor">9.45.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A9EA49">Function <tt>width-check</tt><=
/a></dt>
<dt><a name=3D"TOC-9.45.6" class=3D"tocanchor">9.45.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B5FB1D">Function <tt>force-break</tt><=
/a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.46" class=3D"tocanchor">9.46</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00B5307D">Stream Output Limiting</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0184" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.46.1" class=3D"tocanchor">9.46.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-031FA9E5">Function <tt>set-max-length</t=
t></a></dt>
<dt><a name=3D"TOC-9.46.2" class=3D"tocanchor">9.46.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-027D3FB4">Function <tt>set-max-depth</tt=
></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.47" class=3D"tocanchor">9.47</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-018F2126">Coprocesses</a><a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></=
dt>
<dd><dl id=3D"g0185" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.47.1" class=3D"tocanchor">9.47.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B03D38">Functions <tt>open-command</tt=
> and <tt>open-process</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.48" class=3D"tocanchor">9.48</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0107F06A">I/O-Related Convenience Funct=
ions</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggl=
e"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0186" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.48.1" class=3D"tocanchor">9.48.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02238370">Functions <tt>file-get</tt>, <=
tt>file-get-string</tt> and <tt>file-get-lines</tt></a></dt>
<dt><a name=3D"TOC-9.48.2" class=3D"tocanchor">9.48.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0041C2E5">Functions <tt>file-put</tt>, <=
tt>file-put-string</tt> and <tt>file-put-lines</tt></a></dt>
<dt><a name=3D"TOC-9.48.3" class=3D"tocanchor">9.48.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-000CCA8A">Functions <tt>file-append</tt>=
, <tt>file-append-string</tt> and <tt>file-append-lines</tt></a></dt>
<dt><a name=3D"TOC-9.48.4" class=3D"tocanchor">9.48.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0062A33B">Functions <tt>command-get</tt>=
, <tt>command-get-string</tt> and <tt>command-get-lines</tt></a></dt>
<dt><a name=3D"TOC-9.48.5" class=3D"tocanchor">9.48.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-024D65F3">Functions <tt>command-put</tt>=
, <tt>command-put-string</tt> and <tt>command-put-lines</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.49" class=3D"tocanchor">9.49</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0127C724">Buffer streams</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a=
></dt>
<dd><dl id=3D"g0187" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.49.1" class=3D"tocanchor">9.49.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F5647C">Function <tt>make-buf-stream</=
tt></a></dt>
<dt><a name=3D"TOC-9.49.2" class=3D"tocanchor">9.49.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02954B48">Function <tt>get-buf-from-stre=
am</tt></a></dt>
<dt><a name=3D"TOC-9.49.3" class=3D"tocanchor">9.49.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01150550">Macros <tt>with-out-buf-stream=
</tt> and <tt>with-in-buf-stream</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.50" class=3D"tocanchor">9.50</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-03C8E357">Foreign Pointers</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0188" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.50.1" class=3D"tocanchor">9.50.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F7EE55">The <tt>cptr</tt> type</a></dt=
>
<dt><a name=3D"TOC-9.50.2" class=3D"tocanchor">9.50.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-015139D6">Function <tt>cptr-int</tt></a>=
</dt>
<dt><a name=3D"TOC-9.50.3" class=3D"tocanchor">9.50.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-013139D1">Function <tt>cptr-obj</tt></a>=
</dt>
<dt><a name=3D"TOC-9.50.4" class=3D"tocanchor">9.50.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01768FB9">Function <tt>int-cptr</tt></a>=
</dt>
<dt><a name=3D"TOC-9.50.5" class=3D"tocanchor">9.50.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037139E3">Function <tt>cptr-buf</tt></a>=
</dt>
<dt><a name=3D"TOC-9.50.6" class=3D"tocanchor">9.50.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A212ED">Function <tt>cptr-cast</tt></a=
></dt>
<dt><a name=3D"TOC-9.50.7" class=3D"tocanchor">9.50.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00913A85">Function <tt>cptr-zap</tt></a>=
</dt>
<dt><a name=3D"TOC-9.50.8" class=3D"tocanchor">9.50.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B1FBEF">Function <tt>cptr-free</tt></a=
></dt>
<dt><a name=3D"TOC-9.50.9" class=3D"tocanchor">9.50.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B9289A">Function <tt>cptrp</tt></a></d=
t>
<dt><a name=3D"TOC-9.50.10" class=3D"tocanchor">9.50.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B1F90C">Function <tt>cptr-type</tt><=
/a></dt>
<dt><a name=3D"TOC-9.50.11" class=3D"tocanchor">9.50.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00513A70">Function <tt>cptr-get</tt></=
a></dt>
<dt><a name=3D"TOC-9.50.12" class=3D"tocanchor">9.50.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00513A38">Function <tt>cptr-put</tt></=
a></dt>
<dt><a name=3D"TOC-9.50.13" class=3D"tocanchor">9.50.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01CB17AB">Variable <tt>cptr-null</tt><=
/a></dt>
<dt><a name=3D"TOC-9.50.14" class=3D"tocanchor">9.50.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-024CD90F">Function <tt>cptr-size-hint<=
/tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.51" class=3D"tocanchor">9.51</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-010D730D">User-Defined Streams</a><a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</=
tt></a></dt>
<dd><dl id=3D"g0189" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.51.1" class=3D"tocanchor">9.51.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03FB1671">Function <tt>make-struct-deleg=
ate-stream</tt></a></dt>
<dt><a name=3D"TOC-9.51.2" class=3D"tocanchor">9.51.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0376A37F">Method <tt>put-string</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.3" class=3D"tocanchor">9.51.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0146375A">Method <tt>put-char</tt></a></=
dt>
<dt><a name=3D"TOC-9.51.4" class=3D"tocanchor">9.51.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01963753">Method <tt>put-byte</tt></a></=
dt>
<dt><a name=3D"TOC-9.51.5" class=3D"tocanchor">9.51.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02963E19">Method <tt>get-line</tt></a></=
dt>
<dt><a name=3D"TOC-9.51.6" class=3D"tocanchor">9.51.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0246375D">Method <tt>get-char</tt></a></=
dt>
<dt><a name=3D"TOC-9.51.7" class=3D"tocanchor">9.51.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00963754">Method <tt>get-byte</tt></a></=
dt>
<dt><a name=3D"TOC-9.51.8" class=3D"tocanchor">9.51.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006DC39A">Method <tt>unget-char</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.9" class=3D"tocanchor">9.51.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-027DC412">Method <tt>unget-byte</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.10" class=3D"tocanchor">9.51.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02117E37">Method <tt>put-buf</tt></a><=
/dt>
<dt><a name=3D"TOC-9.51.11" class=3D"tocanchor">9.51.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-013949E0">Method <tt>fill-buf</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.12" class=3D"tocanchor">9.51.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0308FCDD">Method <tt>close</tt></a></d=
t>
<dt><a name=3D"TOC-9.51.13" class=3D"tocanchor">9.51.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02390935">Method <tt>flush</tt></a></d=
t>
<dt><a name=3D"TOC-9.51.14" class=3D"tocanchor">9.51.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0136D6A2">Method <tt>seek</tt></a></dt=
>
<dt><a name=3D"TOC-9.51.15" class=3D"tocanchor">9.51.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0032FBF3">Method <tt>truncate</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.16" class=3D"tocanchor">9.51.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00663AE2">Method <tt>get-prop</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.17" class=3D"tocanchor">9.51.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03663AE4">Method <tt>set-prop</tt></a>=
</dt>
<dt><a name=3D"TOC-9.51.18" class=3D"tocanchor">9.51.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00121ED3">Method <tt>get-error</tt></a=
></dt>
<dt><a name=3D"TOC-9.51.19" class=3D"tocanchor">9.51.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02F46C69">Method <tt>get-error-str</tt=
></a></dt>
<dt><a name=3D"TOC-9.51.20" class=3D"tocanchor">9.51.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-029208DD">Method <tt>clear-error</tt><=
/a></dt>
<dt><a name=3D"TOC-9.51.21" class=3D"tocanchor">9.51.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011D42AB">Method <tt>get-fd</tt></a></=
dt>
<dt><a name=3D"TOC-9.51.22" class=3D"tocanchor">9.51.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00FE2393">Structure <tt>stream-wrap</t=
t></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.52" class=3D"tocanchor">9.52</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-000CFF61">Symbols and Packages</a><a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</=
tt></a></dt>
<dd><dl id=3D"g0190" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.52.1" class=3D"tocanchor">9.52.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02A96E4A">Package Examples</a></dt>
<dt><a name=3D"TOC-9.52.2" class=3D"tocanchor">9.52.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0162BA5A">Packages and the Extraction La=
nguage</a></dt>
<dt><a name=3D"TOC-9.52.3" class=3D"tocanchor">9.52.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0032A071">Package Library Conventions</a=
></dt>
<dt><a name=3D"TOC-9.52.4" class=3D"tocanchor">9.52.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0383342A">Variables <tt>user-package</tt=
>, <tt>keyword-package</tt> and <tt>system-package</tt></a></dt>
<dt><a name=3D"TOC-9.52.5" class=3D"tocanchor">9.52.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-000CBBA0">Special variable <tt>*package*=
</tt></a></dt>
<dt><a name=3D"TOC-9.52.6" class=3D"tocanchor">9.52.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0084463A">Function <tt>make-sym</tt></a>=
</dt>
<dt><a name=3D"TOC-9.52.7" class=3D"tocanchor">9.52.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03AA7FBB">Function <tt>gensym</tt></a></=
dt>
<dt><a name=3D"TOC-9.52.8" class=3D"tocanchor">9.52.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0387B1B1">Special variable <tt>*gensym-c=
ounter*</tt></a></dt>
<dt><a name=3D"TOC-9.52.9" class=3D"tocanchor">9.52.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02512A9A">Function <tt>make-package</tt>=
</a></dt>
<dt><a name=3D"TOC-9.52.10" class=3D"tocanchor">9.52.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E687F3">Function <tt>delete-package<=
/tt></a></dt>
<dt><a name=3D"TOC-9.52.11" class=3D"tocanchor">9.52.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0160EA2C">Function <tt>merge-delete-pa=
ckage</tt></a></dt>
<dt><a name=3D"TOC-9.52.12" class=3D"tocanchor">9.52.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007A478F">Function <tt>packagep</tt></=
a></dt>
<dt><a name=3D"TOC-9.52.13" class=3D"tocanchor">9.52.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0250826D">Function <tt>find-package</t=
t></a></dt>
<dt><a name=3D"TOC-9.52.14" class=3D"tocanchor">9.52.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E20381">Special variable <tt>*packag=
e-alist*</tt></a></dt>
<dt><a name=3D"TOC-9.52.15" class=3D"tocanchor">9.52.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-017F684C">Function <tt>package-alist</=
tt></a></dt>
<dt><a name=3D"TOC-9.52.16" class=3D"tocanchor">9.52.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-038581D9">Function <tt>package-name</t=
t></a></dt>
<dt><a name=3D"TOC-9.52.17" class=3D"tocanchor">9.52.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03AF0206">Function <tt>package-symbols=
</tt></a></dt>
<dt><a name=3D"TOC-9.52.18" class=3D"tocanchor">9.52.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-030C06F5">Functions <tt>package-local-=
symbols</tt> and <tt>package-foreign-symbols</tt></a></dt>
<dt><a name=3D"TOC-9.52.19" class=3D"tocanchor">9.52.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-027A535C">Functions <tt>package-fallba=
ck-list</tt> and <tt>set-package-fallback-list</tt></a></dt>
<dt><a name=3D"TOC-9.52.20" class=3D"tocanchor">9.52.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02722B58">Functions <tt>intern</tt> an=
d <tt>intern-fb</tt></a></dt>
<dt><a name=3D"TOC-9.52.21" class=3D"tocanchor">9.52.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01B6BFC2">Function <tt>unintern</tt></=
a></dt>
<dt><a name=3D"TOC-9.52.22" class=3D"tocanchor">9.52.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01EA8B50">Functions <tt>find-symbol</t=
t> and <tt>find-symbol-fb</tt></a></dt>
<dt><a name=3D"TOC-9.52.23" class=3D"tocanchor">9.52.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03627360">Function <tt>rehome-sym</tt>=
</a></dt>
<dt><a name=3D"TOC-9.52.24" class=3D"tocanchor">9.52.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C0BF69">Function <tt>symbolp</tt></a=
></dt>
<dt><a name=3D"TOC-9.52.25" class=3D"tocanchor">9.52.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-035D3BBF">Function <tt>symbol-name</tt=
></a></dt>
<dt><a name=3D"TOC-9.52.26" class=3D"tocanchor">9.52.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02AB2428">Function <tt>symbol-package<=
/tt></a></dt>
<dt><a name=3D"TOC-9.52.27" class=3D"tocanchor">9.52.27</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01405F25">Function <tt>keywordp</tt></=
a></dt>
<dt><a name=3D"TOC-9.52.28" class=3D"tocanchor">9.52.28</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0222F2E3">Function <tt>bindable</tt></=
a></dt>
<dt><a name=3D"TOC-9.52.29" class=3D"tocanchor">9.52.29</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01747674">Function <tt>use-sym</tt></a=
></dt>
<dt><a name=3D"TOC-9.52.30" class=3D"tocanchor">9.52.30</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01AF42B7">Function <tt>unuse-sym</tt><=
/a></dt>
<dt><a name=3D"TOC-9.52.31" class=3D"tocanchor">9.52.31</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-024BF63F">Functions <tt>use-package</t=
t> and <tt>unuse-package</tt></a></dt>
<dt><a name=3D"TOC-9.52.32" class=3D"tocanchor">9.52.32</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-033951A2">Macro <tt>defpackage</tt></a=
></dt>
<dt><a name=3D"TOC-9.52.33" class=3D"tocanchor">9.52.33</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0179530B">Macro <tt>in-package</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.53" class=3D"tocanchor">9.53</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00776B60">Pseudo-random Numbers</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0191" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.53.1" class=3D"tocanchor">9.53.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033875AD">Special variable <tt>*random-s=
tate*</tt></a></dt>
<dt><a name=3D"TOC-9.53.2" class=3D"tocanchor">9.53.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-010348CD">Special variable <tt>*random-w=
armup*</tt></a></dt>
<dt><a name=3D"TOC-9.53.3" class=3D"tocanchor">9.53.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-032BEE6C">Function <tt>make-random-state=
</tt></a></dt>
<dt><a name=3D"TOC-9.53.4" class=3D"tocanchor">9.53.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00C9A749">Function <tt>random-state-p</t=
t></a></dt>
<dt><a name=3D"TOC-9.53.5" class=3D"tocanchor">9.53.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-005C0F98">Function <tt>random-state-get-=
vec</tt></a></dt>
<dt><a name=3D"TOC-9.53.6" class=3D"tocanchor">9.53.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03A57C86">Functions <tt>random-fixnum</t=
t>, <tt>random</tt> and <tt>rand</tt></a></dt>
<dt><a name=3D"TOC-9.53.7" class=3D"tocanchor">9.53.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01572D27">Function <tt>random-float</tt>=
</a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.54" class=3D"tocanchor">9.54</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0005B035">Time</a><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0192" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.54.1" class=3D"tocanchor">9.54.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B6DB3D">Functions <tt>time</tt>, <tt>t=
ime-usec</tt> and <tt>time-nsec</tt></a></dt>
<dt><a name=3D"TOC-9.54.2" class=3D"tocanchor">9.54.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F192AD">Functions <tt>time-string-loca=
l</tt> and <tt>time-string-utc</tt></a></dt>
<dt><a name=3D"TOC-9.54.3" class=3D"tocanchor">9.54.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00789418">Functions <tt>time-fields-loca=
l</tt> and <tt>time-fields-utc</tt></a></dt>
<dt><a name=3D"TOC-9.54.4" class=3D"tocanchor">9.54.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01F8F906">Structure <tt>time</tt></a></d=
t>
<dt><a name=3D"TOC-9.54.5" class=3D"tocanchor">9.54.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00B758FD">Functions <tt>time-struct-loca=
l</tt> and <tt>time-struct-utc</tt></a></dt>
<dt><a name=3D"TOC-9.54.6" class=3D"tocanchor">9.54.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00207C99">Functions <tt>time-parse</tt>,=
 <tt>time-parse-local</tt> and <tt>time-parse-utc</tt></a></dt>
<dt><a name=3D"TOC-9.54.7" class=3D"tocanchor">9.54.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-001284ED">Methods <tt>time-local</tt> an=
d <tt>time-utc</tt></a></dt>
<dt><a name=3D"TOC-9.54.8" class=3D"tocanchor">9.54.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-007B1819">Method <tt>time-string</tt></a=
></dt>
<dt><a name=3D"TOC-9.54.9" class=3D"tocanchor">9.54.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0012278E">Method <tt>time-parse</tt></a>=
</dt>
<dt><a name=3D"TOC-9.54.10" class=3D"tocanchor">9.54.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007C486E">Functions <tt>make-time</tt>=
 and <tt>make-time-utc</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.55" class=3D"tocanchor">9.55</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00E76208">Data Integrity</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a=
></dt>
<dd><dl id=3D"g0193" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.55.1" class=3D"tocanchor">9.55.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0119CE1D">Function <tt>crc32-stream</tt>=
</a></dt>
<dt><a name=3D"TOC-9.55.2" class=3D"tocanchor">9.55.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D92859">Function <tt>crc32</tt></a></d=
t>
<dt><a name=3D"TOC-9.55.3" class=3D"tocanchor">9.55.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006C94B6">Functions <tt>sha256-stream</t=
t> and <tt>md5-stream</tt></a></dt>
<dt><a name=3D"TOC-9.55.4" class=3D"tocanchor">9.55.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019F97A2">Functions <tt>sha256</tt> and =
<tt>md5</tt></a></dt>
<dt><a name=3D"TOC-9.55.5" class=3D"tocanchor">9.55.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03B36E53">Functions <tt>sha256-begin</tt=
>, <tt>sha256-hash</tt> and <tt>sha256-end</tt></a></dt>
<dt><a name=3D"TOC-9.55.6" class=3D"tocanchor">9.55.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-025F32FD">Functions <tt>md5-begin</tt>, =
<tt>md5-hash</tt> and <tt>md5-end</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.56" class=3D"tocanchor">9.56</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-000264BC">The Awk Utility</a><a href=3D=
"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></=
a></dt>
<dd><dl id=3D"g0194" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.56.1" class=3D"tocanchor">9.56.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-012F3A2C">Macro <tt>awk</tt></a></dt>
<dt><a name=3D"TOC-9.56.2" class=3D"tocanchor">9.56.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0003ED2C">Variables <tt>rec</tt> and <tt=
>orec</tt></a></dt>
<dt><a name=3D"TOC-9.56.3" class=3D"tocanchor">9.56.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-003BDFA9">Variable <tt>f</tt></a></dt>
<dt><a name=3D"TOC-9.56.4" class=3D"tocanchor">9.56.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0267AE6D">Variable <tt>nf</tt></a></dt>
<dt><a name=3D"TOC-9.56.5" class=3D"tocanchor">9.56.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03A7AE6D">Variable <tt>nr</tt></a></dt>
<dt><a name=3D"TOC-9.56.6" class=3D"tocanchor">9.56.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E33A82">Variable <tt>fnr</tt></a></dt>
<dt><a name=3D"TOC-9.56.7" class=3D"tocanchor">9.56.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02133AA5">Variable <tt>arg</tt></a></dt>
<dt><a name=3D"TOC-9.56.8" class=3D"tocanchor">9.56.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-039E5F67">Variable <tt>fname</tt></a></d=
t>
<dt><a name=3D"TOC-9.56.9" class=3D"tocanchor">9.56.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0397AE68">Variable <tt>rs</tt></a></dt>
<dt><a name=3D"TOC-9.56.10" class=3D"tocanchor">9.56.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02D33A4D">Variable <tt>krs</tt></a></d=
t>
<dt><a name=3D"TOC-9.56.11" class=3D"tocanchor">9.56.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B6902C">Variables <tt>fs</tt> and <t=
t>ft</tt></a></dt>
<dt><a name=3D"TOC-9.56.12" class=3D"tocanchor">9.56.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02D33A30">Variable <tt>kfs</tt></a></d=
t>
<dt><a name=3D"TOC-9.56.13" class=3D"tocanchor">9.56.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0357AE6F">Variable <tt>fw</tt></a></dt=
>
<dt><a name=3D"TOC-9.56.14" class=3D"tocanchor">9.56.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02D33AA0">Variable <tt>ofs</tt></a></d=
t>
<dt><a name=3D"TOC-9.56.15" class=3D"tocanchor">9.56.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02D33A3D">Variable <tt>ors</tt></a></d=
t>
<dt><a name=3D"TOC-9.56.16" class=3D"tocanchor">9.56.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">Function <tt>prn</tt></a></d=
t>
<dt><a name=3D"TOC-9.56.17" class=3D"tocanchor">9.56.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03820F9E">Macro <tt>next</tt></a></dt>
<dt><a name=3D"TOC-9.56.18" class=3D"tocanchor">9.56.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000CD1AE">Macro <tt>again</tt></a></dt=
>
<dt><a name=3D"TOC-9.56.19" class=3D"tocanchor">9.56.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00839D2F">Macro <tt>next-file</tt></a>=
</dt>
<dt><a name=3D"TOC-9.56.20" class=3D"tocanchor">9.56.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">Macros <tt>rng</tt>, <tt>-rn=
g</tt>, <tt>rng-</tt> <tt>-rng-</tt>, <tt>--rng</tt>, <tt>--rng-</tt>, <tt>=
rng+</tt>, <tt>-rng+</tt> and <tt>--rng+</tt></a></dt>
<dt><a name=3D"TOC-9.56.21" class=3D"tocanchor">9.56.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-006B6E54">Macro <tt>ff</tt></a></dt>
<dt><a name=3D"TOC-9.56.22" class=3D"tocanchor">9.56.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-036B6E55">Macro <tt>mf</tt></a></dt>
<dt><a name=3D"TOC-9.56.23" class=3D"tocanchor">9.56.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-018CCE37">Macro <tt>fconv</tt></a></dt=
>
<dt><a name=3D"TOC-9.56.24" class=3D"tocanchor">9.56.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B10DF9">Macros <tt>-&gt;</tt>, <tt>-=
&gt;&gt;</tt>, <tt>&lt;-</tt>, <tt>!&gt;</tt> and <tt>&lt;!</tt></a></dt>
<dt><a name=3D"TOC-9.56.25" class=3D"tocanchor">9.56.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D16283">Examples of <tt>awk</tt> Mac=
ro Usage</a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.57" class=3D"tocanchor">9.57</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01AAFC45">Environment Variables and Com=
mand Line</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"=
toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0195" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.57.1" class=3D"tocanchor">9.57.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DEE18A">Special variables <tt>*args-fu=
ll*</tt>, <tt>*args-eff*</tt> and <tt>*args*</tt></a></dt>
<dt><a name=3D"TOC-9.57.2" class=3D"tocanchor">9.57.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0267F548">Function <tt>env</tt></a></dt>
<dt><a name=3D"TOC-9.57.3" class=3D"tocanchor">9.57.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-011814B5">Function <tt>env-hash</tt></a>=
</dt>
<dt><a name=3D"TOC-9.57.4" class=3D"tocanchor">9.57.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-002E0364">Functions <tt>getenv</tt>, <tt=
>setenv</tt> and <tt>unsetenv</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.58" class=3D"tocanchor">9.58</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-02C70C38">Command Line Option Processin=
g</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle">=
 <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0196" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.58.1" class=3D"tocanchor">9.58.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02968E5D">Command Line Option Convention=
s</a></dt>
<dt><a name=3D"TOC-9.58.2" class=3D"tocanchor">9.58.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0361E497">Command Line Processing Exampl=
es</a></dt>
<dt><a name=3D"TOC-9.58.3" class=3D"tocanchor">9.58.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03FC5092">Structure <tt>opt-desc</tt></a=
></dt>
<dt><a name=3D"TOC-9.58.4" class=3D"tocanchor">9.58.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0047F5AB">Function <tt>opt</tt></a></dt>
<dt><a name=3D"TOC-9.58.5" class=3D"tocanchor">9.58.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D911E8">Structure <tt>opts</tt></a></d=
t>
<dt><a name=3D"TOC-9.58.6" class=3D"tocanchor">9.58.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A5A2FF">Function <tt>getopts</tt></a><=
/dt>
<dt><a name=3D"TOC-9.58.7" class=3D"tocanchor">9.58.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-016C6171">Function <tt>opthelp</tt></a><=
/dt>
<dt><a name=3D"TOC-9.58.8" class=3D"tocanchor">9.58.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0126C738">Macro <tt>define-option-struct=
</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.59" class=3D"tocanchor">9.59</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00136952">System Programming</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0197" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.59.1" class=3D"tocanchor">9.59.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03A7137C">Accessor <tt>errno</tt></a></d=
t>
<dt><a name=3D"TOC-9.59.2" class=3D"tocanchor">9.59.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02A1DB65">Function <tt>strerror</tt></a>=
</dt>
<dt><a name=3D"TOC-9.59.3" class=3D"tocanchor">9.59.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0006C92F">Function <tt>exit</tt></a></dt=
>
<dt><a name=3D"TOC-9.59.4" class=3D"tocanchor">9.59.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-036B1BDB">Variables <tt>e2big</tt>, <tt>=
eacces</tt>, <tt>eaddrinuse</tt>, <tt>eaddrnotavail</tt>, <tt>eafnosupport<=
/tt>, <tt>eagain</tt>, <tt>ealready</tt>, <tt>ebadf</tt>, <tt>ebadmsg</tt>,=
 <tt>ebusy</tt>, <tt>ecanceled</tt>, <tt>echild</tt>, <tt>econnaborted</tt>=
, <tt>econnrefused</tt>, <tt>econnreset</tt>, <tt>edeadlk</tt>, <tt>edestad=
drreq</tt>, <tt>edom</tt>, <tt>edquot</tt>, <tt>eexist</tt>, <tt>efault</tt=
>, <tt>efbig</tt>, <tt>ehostunreach</tt>, <tt>eidrm</tt>, <tt>eilseq</tt>, =
<tt>einprogress</tt>, <tt>eintr</tt>, <tt>einval</tt>, <tt>eio</tt>, <tt>ei=
sconn</tt>, <tt>eisdir</tt>, <tt>eloop</tt>, <tt>emfile</tt>, <tt>emlink</t=
t>, <tt>emsgsize</tt>, <tt>emultihop</tt>, <tt>enametoolong</tt>, <tt>enetd=
own</tt>, <tt>enetreset</tt>, <tt>enetunreach</tt>, <tt>enfile</tt>, <tt>en=
obufs</tt>, <tt>enodata</tt>, <tt>enodev</tt>, <tt>enoent</tt>, <tt>enoexec=
</tt>, <tt>enolck</tt>, <tt>enolink</tt>, <tt>enomem</tt>, <tt>enomsg</tt>,=
 <tt>enoprotoopt</tt>, <tt>enospc</tt>, <tt>enosr</tt>, <tt>enostr</tt>, <t=
t>enosys</tt>, <tt>enotconn</tt>, <tt>enotdir</tt>, <tt>enotempty</tt>, <tt=
>enotrecoverable</tt>, <tt>enotsock</tt>, <tt>enotsup</tt>, <tt>enotty</tt>=
, <tt>enxio</tt>, <tt>eopnotsupp</tt>, <tt>eoverflow</tt>, <tt>eownerdead</=
tt>, <tt>eperm</tt>, <tt>epipe</tt>, <tt>eproto</tt>, <tt>eprotonosupport</=
tt>, <tt>eprototype</tt>, <tt>erange</tt>, <tt>erofs</tt>, <tt>espipe</tt>,=
 <tt>esrch</tt>, <tt>estale</tt>, <tt>etime</tt>, <tt>etimedout</tt>, <tt>e=
txtbsy</tt>, <tt>ewouldblock</tt> and <tt>exdev</tt></a></dt>
<dt><a name=3D"TOC-9.59.5" class=3D"tocanchor">9.59.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02F934F6">Function <tt>abort</tt></a></d=
t>
<dt><a name=3D"TOC-9.59.6" class=3D"tocanchor">9.59.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-003EEEF5">Functions <tt>at-exit-call</tt=
> and <tt>at-exit-do-not-call</tt></a></dt>
<dt><a name=3D"TOC-9.59.7" class=3D"tocanchor">9.59.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00D79773">Function <tt>usleep</tt></a></=
dt>
<dt><a name=3D"TOC-9.59.8" class=3D"tocanchor">9.59.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00C543B8">Functions <tt>mkdir</tt> and <=
tt>ensure-dir</tt></a></dt>
<dt><a name=3D"TOC-9.59.9" class=3D"tocanchor">9.59.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D941C3">Function <tt>chdir</tt></a></d=
t>
<dt><a name=3D"TOC-9.59.10" class=3D"tocanchor">9.59.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0047F5F6">Function <tt>pwd</tt></a></d=
t>
<dt><a name=3D"TOC-9.59.11" class=3D"tocanchor">9.59.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03D90503">Function <tt>rmdir</tt></a><=
/dt>
<dt><a name=3D"TOC-9.59.12" class=3D"tocanchor">9.59.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-014AF3F7">Function <tt>remove-path</tt=
></a></dt>
<dt><a name=3D"TOC-9.59.13" class=3D"tocanchor">9.59.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-016EF40C">Function <tt>rename-path</tt=
></a></dt>
<dt><a name=3D"TOC-9.59.14" class=3D"tocanchor">9.59.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0158244A">Functions <tt>sh</tt> and <t=
t>run</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.60" class=3D"tocanchor">9.60</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0274414F">Unix Filesystem Manipulation<=
/a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <=
tt>[+]</tt></a></dt>
<dd><dl id=3D"g0198" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.60.1" class=3D"tocanchor">9.60.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0308FEDD">Structure <tt>stat</tt></a></d=
t>
<dt><a name=3D"TOC-9.60.2" class=3D"tocanchor">9.60.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-006DE1CC">Functions <tt>stat</tt>, <tt>l=
stat</tt> and <tt>fstat</tt></a></dt>
<dt><a name=3D"TOC-9.60.3" class=3D"tocanchor">9.60.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F32D57">Variables <tt>s-ifmt</tt>, <tt=
>s-iflnk</tt>, <tt>s-ifreg</tt>, <tt>s-ifblk</tt>, ... , <tt>s-ixoth</tt></=
a></dt>
<dt><a name=3D"TOC-9.60.4" class=3D"tocanchor">9.60.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0068D92E">Function <tt>umask</tt></a></d=
t>
<dt><a name=3D"TOC-9.60.5" class=3D"tocanchor">9.60.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02F0F482">Functions <tt>makedev</tt>, <t=
t>minor</tt> and <tt>major</tt></a></dt>
<dt><a name=3D"TOC-9.60.6" class=3D"tocanchor">9.60.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F941E5">Function <tt>chmod</tt></a></d=
t>
<dt><a name=3D"TOC-9.60.7" class=3D"tocanchor">9.60.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-003B491C">Functions <tt>chown</tt> and <=
tt>lchown</tt></a></dt>
<dt><a name=3D"TOC-9.60.8" class=3D"tocanchor">9.60.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E96FCF">Functions <tt>utimes</tt> and =
<tt>lutimes</tt></a></dt>
<dt><a name=3D"TOC-9.60.9" class=3D"tocanchor">9.60.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F93A39">Function <tt>mknod</tt></a></d=
t>
<dt><a name=3D"TOC-9.60.10" class=3D"tocanchor">9.60.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0091FD43">Function <tt>mkfifo</tt></a>=
</dt>
<dt><a name=3D"TOC-9.60.11" class=3D"tocanchor">9.60.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-009EF0C8">Functions <tt>symlink</tt> a=
nd <tt>link</tt></a></dt>
<dt><a name=3D"TOC-9.60.12" class=3D"tocanchor">9.60.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0338B219">Function <tt>readlink</tt></=
a></dt>
<dt><a name=3D"TOC-9.60.13" class=3D"tocanchor">9.60.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0168BEB4">Function <tt>realpath</tt></=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.61" class=3D"tocanchor">9.61</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-023BAF92">Unix Filesystem Complex Opera=
tions</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"togg=
le"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0199" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.61.1" class=3D"tocanchor">9.61.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019D6582">Functions <tt>copy-file</tt> a=
nd <tt>copy-files</tt></a></dt>
<dt><a name=3D"TOC-9.61.2" class=3D"tocanchor">9.61.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-034734A3">Function <tt>copy-path-rec</tt=
></a></dt>
<dt><a name=3D"TOC-9.61.3" class=3D"tocanchor">9.61.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03E81B3A">Function <tt>remove-path-rec</=
tt></a></dt>
<dt><a name=3D"TOC-9.61.4" class=3D"tocanchor">9.61.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D8298E">Functions <tt>chmod-rec</tt> a=
nd <tt>chown-rec</tt></a></dt>
<dt><a name=3D"TOC-9.61.5" class=3D"tocanchor">9.61.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0038DD42">Function <tt>touch</tt></a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-9.62" class=3D"tocanchor">9.62</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0266E956">Unix Filesystem Object Existe=
nce, Type and Access Tests</a><a href=3D"http://nongnu.org/txr/txr-manpage.=
html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0200" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.62.1" class=3D"tocanchor">9.62.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03C41AE2">Function <tt>path-exists-p</tt=
></a></dt>
<dt><a name=3D"TOC-9.62.2" class=3D"tocanchor">9.62.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00198FC7">Functions <tt>path-file-p</tt>=
, <tt>path-dir-p</tt>, <tt>path-symlink-p</tt>, <tt>path-blkdev-p</tt>, <tt=
>path-chrdev-p</tt>, <tt>path-sock-p</tt> and <tt>path-pipe-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.3" class=3D"tocanchor">9.62.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01EFC15D">Function <tt>path-dir-empty</t=
t></a></dt>
<dt><a name=3D"TOC-9.62.4" class=3D"tocanchor">9.62.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FBA677">Functions <tt>path-setgid-p</t=
t>, <tt>path-setuid-p</tt> and <tt>path-sticky-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.5" class=3D"tocanchor">9.62.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-020F44B5">Functions <tt>path-mine-p</tt>=
 and <tt>path-my-group-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.6" class=3D"tocanchor">9.62.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02933008">Function <tt>path-readable-to-=
me-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.7" class=3D"tocanchor">9.62.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02033190">Function <tt>path-writable-to-=
me-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.8" class=3D"tocanchor">9.62.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-028A5109">Function <tt>path-read-writabl=
e-to-me-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.9" class=3D"tocanchor">9.62.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-014A4B85">Function <tt>path-executable-t=
o-me-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.10" class=3D"tocanchor">9.62.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03B3F844">Functions <tt>path-private-t=
o-me-p</tt> and <tt>path-strictly-private-to-me-p</tt></a></dt>
<dt><a name=3D"TOC-9.62.11" class=3D"tocanchor">9.62.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0155004F">Functions <tt>path-newer</tt=
> and <tt>path-older</tt></a></dt>
<dt><a name=3D"TOC-9.62.12" class=3D"tocanchor">9.62.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0103E27B">Function <tt>path-same-objec=
t</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.63" class=3D"tocanchor">9.63</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01ED65C8">Unix Credentials</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0201" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.63.1" class=3D"tocanchor">9.63.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00125C22">Functions <tt>getuid</tt>, <tt=
>geteuid</tt>, <tt>getgid</tt> and <tt>getegid</tt></a></dt>
<dt><a name=3D"TOC-9.63.2" class=3D"tocanchor">9.63.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03897D65">Functions <tt>setuid</tt>, <tt=
>seteuid</tt>, <tt>setgid</tt> and <tt>setegid</tt></a></dt>
<dt><a name=3D"TOC-9.63.3" class=3D"tocanchor">9.63.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-030FEE9B">Function <tt>getgroups</tt></a=
></dt>
<dt><a name=3D"TOC-9.63.4" class=3D"tocanchor">9.63.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-030FEE97">Function <tt>setgroups</tt></a=
></dt>
<dt><a name=3D"TOC-9.63.5" class=3D"tocanchor">9.63.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D37234">Functions <tt>getresuid</tt> a=
nd <tt>getresgid</tt></a></dt>
<dt><a name=3D"TOC-9.63.6" class=3D"tocanchor">9.63.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-027671E8">Functions <tt>setresuid</tt> a=
nd <tt>setresgid</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.64" class=3D"tocanchor">9.64</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-031CBEFD">Unix Password Database</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0202" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.64.1" class=3D"tocanchor">9.64.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-036B0636">Structure <tt>passwd</tt></a><=
/dt>
<dt><a name=3D"TOC-9.64.2" class=3D"tocanchor">9.64.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0377C43A">Functions <tt>getpwent</tt>, <=
tt>setpwent</tt> and <tt>endpwent</tt></a></dt>
<dt><a name=3D"TOC-9.64.3" class=3D"tocanchor">9.64.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03E528C6">Function <tt>getpwuid</tt></a>=
</dt>
<dt><a name=3D"TOC-9.64.4" class=3D"tocanchor">9.64.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03552854">Function <tt>getpwnam</tt></a>=
</dt>
</dl>
</dd><dt><a name=3D"TOC-9.65" class=3D"tocanchor">9.65</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01BD99A2">Unix Group Database</a><a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</t=
t></a></dt>
<dd><dl id=3D"g0203" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.65.1" class=3D"tocanchor">9.65.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DE71BA">Structure <tt>group</tt></a></=
dt>
<dt><a name=3D"TOC-9.65.2" class=3D"tocanchor">9.65.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02CAC7FB">Functions <tt>getgrent</tt>, <=
tt>setgrent</tt> and <tt>endgrent</tt></a></dt>
<dt><a name=3D"TOC-9.65.3" class=3D"tocanchor">9.65.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03E5634E">Function <tt>getgrgid</tt></a>=
</dt>
<dt><a name=3D"TOC-9.65.4" class=3D"tocanchor">9.65.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03556394">Function <tt>getgrnam</tt></a>=
</dt>
</dl>
</dd><dt><a name=3D"TOC-9.66" class=3D"tocanchor">9.66</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-023364EA">Unix Password Hashing</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0204" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.66.1" class=3D"tocanchor">9.66.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F928CE">Function <tt>crypt</tt></a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-9.67" class=3D"tocanchor">9.67</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-010CFD89">Unix Signal Handling</a><a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</=
tt></a></dt>
<dd><dl id=3D"g0205" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.67.1" class=3D"tocanchor">9.67.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0176430F">Variables <tt>sig-hup</tt>, <t=
t>sig-int</tt>, <tt>sig-quit</tt>, <tt>sig-ill</tt>, <tt>sig-trap</tt>, <tt=
>sig-abrt</tt>, <tt>sig-bus</tt>, <tt>sig-fpe</tt>, <tt>sig-kill</tt>, <tt>=
sig-usr1</tt>, <tt>sig-segv</tt>, <tt>sig-usr2</tt>, <tt>sig-pipe</tt>, <tt=
>sig-alrm</tt>, <tt>sig-term</tt>, <tt>sig-chld</tt>, <tt>sig-cont</tt>, <t=
t>sig-stop</tt>, <tt>sig-tstp</tt>, <tt>sig-ttin</tt>, <tt>sig-ttou</tt>, <=
tt>sig-urg</tt>, <tt>sig-xcpu</tt>, <tt>sig-xfsz</tt>, <tt>sig-vtalrm</tt>,=
 <tt>sig-prof</tt>, <tt>sig-poll</tt>, <tt>sig-sys</tt>, <tt>sig-winch</tt>=
, <tt>sig-iot</tt>, <tt>sig-stkflt</tt>, <tt>sig-io</tt>, <tt>sig-lost</tt>=
 and <tt>sig-pwr</tt></a></dt>
<dt><a name=3D"TOC-9.67.2" class=3D"tocanchor">9.67.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E1B6FA">Functions <tt>set-sig-handler<=
/tt> and <tt>get-sig-handler</tt></a></dt>
<dt><a name=3D"TOC-9.67.3" class=3D"tocanchor">9.67.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0360A99A">Function <tt>sig-check</tt></a=
></dt>
<dt><a name=3D"TOC-9.67.4" class=3D"tocanchor">9.67.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0108FFCE">Function <tt>raise</tt></a></d=
t>
<dt><a name=3D"TOC-9.67.5" class=3D"tocanchor">9.67.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0386CCD5">Function <tt>kill</tt></a></dt=
>
<dt><a name=3D"TOC-9.67.6" class=3D"tocanchor">9.67.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00234BED">Function <tt>strsignal</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.68" class=3D"tocanchor">9.68</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00DF1BD2">Unix Processes</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a=
></dt>
<dd><dl id=3D"g0206" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.68.1" class=3D"tocanchor">9.68.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0365C3E1">Functions <tt>fork</tt> and <t=
t>wait</tt></a></dt>
<dt><a name=3D"TOC-9.68.2" class=3D"tocanchor">9.68.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0243C575">Functions <tt>w-ifexited</tt>,=
 <tt>w-exitstatus</tt>, <tt>w-ifsignaled</tt>, <tt>w-termsig</tt>, <tt>w-co=
redump</tt>, <tt>w-ifstopped</tt> and <tt>w-stopsig</tt></a></dt>
<dt><a name=3D"TOC-9.68.3" class=3D"tocanchor">9.68.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D6C913">Function <tt>exec</tt></a></dt=
>
<dt><a name=3D"TOC-9.68.4" class=3D"tocanchor">9.68.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03592671">Function <tt>exit*</tt></a></d=
t>
<dt><a name=3D"TOC-9.68.5" class=3D"tocanchor">9.68.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D7B5A3">Functions <tt>getpid</tt> and =
<tt>getppid</tt></a></dt>
<dt><a name=3D"TOC-9.68.6" class=3D"tocanchor">9.68.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-017C3515">Function <tt>daemon</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.69" class=3D"tocanchor">9.69</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00C41E8E">Unix File Descriptors</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0207" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.69.1" class=3D"tocanchor">9.69.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02BEAF24">Function <tt>open-fileno</tt><=
/a></dt>
<dt><a name=3D"TOC-9.69.2" class=3D"tocanchor">9.69.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008ACF75">Function <tt>fileno</tt></a></=
dt>
<dt><a name=3D"TOC-9.69.3" class=3D"tocanchor">9.69.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01F91AEF">Function <tt>dupfd</tt></a></d=
t>
<dt><a name=3D"TOC-9.69.4" class=3D"tocanchor">9.69.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F6D390">Function <tt>pipe</tt></a></dt=
>
<dt><a name=3D"TOC-9.69.5" class=3D"tocanchor">9.69.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01094176">Function <tt>close</tt></a></d=
t>
<dt><a name=3D"TOC-9.69.6" class=3D"tocanchor">9.69.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0386D39D">Function <tt>poll</tt></a></dt=
>
<dt><a name=3D"TOC-9.69.7" class=3D"tocanchor">9.69.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03709E8A">Function <tt>isatty</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.70" class=3D"tocanchor">9.70</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-012E8480">Unix File Control</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0208" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.70.1" class=3D"tocanchor">9.70.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-034BF6C9">Variables <tt>o-accmode</tt>, =
<tt>o-rdonly</tt>, <tt>o-wronly</tt>, <tt>o-rdwr</tt>, <tt>o-creat</tt>, <t=
t>o-noctty</tt>, <tt>o-trunc</tt>, <tt>o-append</tt>, <tt>o-nonblock</tt>, =
<tt>o-sync</tt>, <tt>o-async</tt>, <tt>o-directory</tt>, <tt>o-nofollow</tt=
>, <tt>o-cloexec</tt>, <tt>o-direct</tt>, <tt>o-noatime</tt> and <tt>o-path=
</tt></a></dt>
<dt><a name=3D"TOC-9.70.2" class=3D"tocanchor">9.70.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D6E4D8">Variables <tt>seek-set</tt>, <=
tt>seek-cur</tt> and <tt>seek-end</tt></a></dt>
<dt><a name=3D"TOC-9.70.3" class=3D"tocanchor">9.70.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-025E55E7">Variables <tt>f-dupfd</tt>, <t=
t>f-dupfd-cloexec</tt>, <tt>f-getfd</tt>, <tt>f-setfd</tt>, <tt>f-getfl</tt=
>, <tt>f-setfl</tt>, <tt>f-getlk</tt>, <tt>f-setlk</tt> and <tt>f-setlkw</t=
t></a></dt>
<dt><a name=3D"TOC-9.70.4" class=3D"tocanchor">9.70.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-021805C2">Variable <tt>fd-cloexec</tt></=
a></dt>
<dt><a name=3D"TOC-9.70.5" class=3D"tocanchor">9.70.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0137046C">Variables <tt>f-rdlck</tt>, <t=
t>f-wrlck</tt> and <tt>f-unlck</tt></a></dt>
<dt><a name=3D"TOC-9.70.6" class=3D"tocanchor">9.70.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-004E5B3E">Structure <tt>flock</tt></a></=
dt>
<dt><a name=3D"TOC-9.70.7" class=3D"tocanchor">9.70.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03793032">Function <tt>fcntl</tt></a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-9.71" class=3D"tocanchor">9.71</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-039EFF20">Unix Itimers</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0209" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.71.1" class=3D"tocanchor">9.71.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B7882A">Variables <tt>itimer-real</tt>=
, <tt>itimer-virtual</tt> and <tt>itimer-prof</tt></a></dt>
<dt><a name=3D"TOC-9.71.2" class=3D"tocanchor">9.71.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02DE107D">Functions <tt>getitimer</tt> a=
nd <tt>setitimer</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.72" class=3D"tocanchor">9.72</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01A58F3E">Unix Syslog</a><a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></=
dt>
<dd><dl id=3D"g0210" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.72.1" class=3D"tocanchor">9.72.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02371913">Variables <tt>log-pid</tt>, <t=
t>log-cons</tt>, <tt>log-ndelay</tt>, <tt>log-odelay</tt>, <tt>log-nowait</=
tt> and <tt>log-perror</tt></a></dt>
<dt><a name=3D"TOC-9.72.2" class=3D"tocanchor">9.72.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0116F48F">Special variables <tt>log-user=
</tt>, <tt>log-daemon</tt>, <tt>log-auth</tt> and <tt>log-authpriv</tt></a>=
</dt>
<dt><a name=3D"TOC-9.72.3" class=3D"tocanchor">9.72.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-035D75EC">Variables <tt>log-emerg</tt>, =
<tt>log-alert</tt>, <tt>log-crit</tt>, <tt>log-err</tt>, <tt>log-warning</t=
t>, <tt>log-notice</tt>, <tt>log-info</tt> and <tt>log-debug</tt></a></dt>
<dt><a name=3D"TOC-9.72.4" class=3D"tocanchor">9.72.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02841215">The <tt>*stdlog*</tt> special =
variable</a></dt>
<dt><a name=3D"TOC-9.72.5" class=3D"tocanchor">9.72.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037AA654">Function <tt>openlog</tt></a><=
/dt>
<dt><a name=3D"TOC-9.72.6" class=3D"tocanchor">9.72.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02CEE7EA">Function <tt>closelog</tt></a>=
</dt>
<dt><a name=3D"TOC-9.72.7" class=3D"tocanchor">9.72.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0085DB47">Function <tt>setlogmask</tt></=
a></dt>
<dt><a name=3D"TOC-9.72.8" class=3D"tocanchor">9.72.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02075291">Function <tt>syslog</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-9.73" class=3D"tocanchor">9.73</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-036B3694">Unix Path Globbing</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0211" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.73.1" class=3D"tocanchor">9.73.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0188409B">Variables <tt>glob-err</tt>, <=
tt>glob-mark</tt>, <tt>glob-nosort</tt>, <tt>glob-nocheck</tt>, <tt>glob-no=
escape</tt>, <tt>glob-period</tt>, <tt>glob-altdirfunc</tt>, <tt>glob-brace=
</tt>, <tt>glob-nomagic</tt>, <tt>glob-tilde</tt>, <tt>glob-tilde-check</tt=
> and <tt>glob-onlydir</tt></a></dt>
<dt><a name=3D"TOC-9.73.2" class=3D"tocanchor">9.73.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E6C7DE">Function <tt>glob</tt></a></dt=
>
<dt><a name=3D"TOC-9.73.3" class=3D"tocanchor">9.73.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0330E15A">Variables <tt>fnm-pathname</tt=
>, <tt>fnm-noescape</tt>, <tt>fnm-period</tt>, <tt>fnm-leading-dir</tt>, <t=
t>fnm-casefold</tt> and <tt>fnm-extmatch</tt></a></dt>
<dt><a name=3D"TOC-9.73.4" class=3D"tocanchor">9.73.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F8FF75">Function <tt>fnmatch</tt></a><=
/dt>
</dl>
</dd><dt><a name=3D"TOC-9.74" class=3D"tocanchor">9.74</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-011FF2B6">Unix Filesystem Traversal</a>=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>=
[+]</tt></a></dt>
<dd><dl id=3D"g0212" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.74.1" class=3D"tocanchor">9.74.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A802F2">Variables <tt>ftw-phys</tt>, <=
tt>ftw-mount</tt>, <tt>ftw-chdir</tt>, <tt>ftw-depth</tt> and <tt>ftw-actio=
nretval</tt></a></dt>
<dt><a name=3D"TOC-9.74.2" class=3D"tocanchor">9.74.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02ED8B51">Variables <tt>ftw-f</tt>, <tt>=
ftw-d</tt>, <tt>ftw-dnr</tt>, <tt>ftw-ns</tt>, <tt>ftw-sl</tt>, <tt>ftw-dp<=
/tt> and <tt>ftw-sln</tt></a></dt>
<dt><a name=3D"TOC-9.74.3" class=3D"tocanchor">9.74.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03853999">Variables <tt>ftw-continue</tt=
>, <tt>ftw-stop</tt>, <tt>ftw-skip-subtree</tt> and <tt>ftw-skip-siblings</=
tt></a></dt>
<dt><a name=3D"TOC-9.74.4" class=3D"tocanchor">9.74.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0057F54E">Function <tt>ftw</tt></a></dt>
<dt><a name=3D"TOC-9.74.5" class=3D"tocanchor">9.74.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-036FE5B4">Structure <tt>dirent</tt></a><=
/dt>
<dt><a name=3D"TOC-9.74.6" class=3D"tocanchor">9.74.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D8CAF4">Variables <tt>dt-blk</tt>, <tt=
>dt-chr</tt>, <tt>dt-dir</tt>, <tt>dt-fifo</tt>, <tt>dt-lnk</tt>, <tt>dt-re=
g</tt>, <tt>dt-sock</tt> and <tt>dt-unknown</tt></a></dt>
<dt><a name=3D"TOC-9.74.7" class=3D"tocanchor">9.74.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-024AA6F4">Function <tt>opendir</tt></a><=
/dt>
<dt><a name=3D"TOC-9.74.8" class=3D"tocanchor">9.74.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0289D074">Function <tt>readdir</tt></a><=
/dt>
<dt><a name=3D"TOC-9.74.9" class=3D"tocanchor">9.74.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01FEE88A">Function <tt>closedir</tt></a>=
</dt>
<dt><a name=3D"TOC-9.74.10" class=3D"tocanchor">9.74.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02507FF2">Function <tt>dirstat</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.75" class=3D"tocanchor">9.75</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00E95F45">Unix Sockets</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0213" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.75.1" class=3D"tocanchor">9.75.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01F91F35">Datagram Socket Streams</a></d=
t>
<dt><a name=3D"TOC-9.75.2" class=3D"tocanchor">9.75.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02C48759">Structure <tt>sockaddr</tt></a=
></dt>
<dt><a name=3D"TOC-9.75.3" class=3D"tocanchor">9.75.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01DD05D9">Structure <tt>sockaddr-in</tt>=
</a></dt>
<dt><a name=3D"TOC-9.75.4" class=3D"tocanchor">9.75.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-013DD169">Structure <tt>sockaddr-in6</tt=
></a></dt>
<dt><a name=3D"TOC-9.75.5" class=3D"tocanchor">9.75.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01DD05D2">Structure <tt>sockaddr-un</tt>=
</a></dt>
<dt><a name=3D"TOC-9.75.6" class=3D"tocanchor">9.75.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0110E961">Structure <tt>addrinfo</tt></a=
></dt>
<dt><a name=3D"TOC-9.75.7" class=3D"tocanchor">9.75.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0363FE99">Function <tt>getaddrinfo</tt><=
/a></dt>
<dt><a name=3D"TOC-9.75.8" class=3D"tocanchor">9.75.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0228EAE0">Variables <tt>af-unix</tt>, <t=
t>af-inet</tt> and <tt>af-inet6</tt></a></dt>
<dt><a name=3D"TOC-9.75.9" class=3D"tocanchor">9.75.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D17D22">Variables <tt>sock-stream</tt>=
 and <tt>sock-dgram</tt></a></dt>
<dt><a name=3D"TOC-9.75.10" class=3D"tocanchor">9.75.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-020DFFDE">Variables <tt>ai-passive</tt=
>, <tt>ai-numerichost</tt>, <tt>ai-v4mapped</tt>, <tt>ai-all</tt>, <tt>ai-a=
ddrconfig</tt> and <tt>ai-numericserv</tt></a></dt>
<dt><a name=3D"TOC-9.75.11" class=3D"tocanchor">9.75.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-026A2C3B">Variables <tt>inaddr-any</tt=
>, <tt>inaddr-loopback</tt>, <tt>in6addr-any</tt> and <tt>in6addr-loopback<=
/tt></a></dt>
<dt><a name=3D"TOC-9.75.12" class=3D"tocanchor">9.75.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-026B766B">Function <tt>open-socket</tt=
></a></dt>
<dt><a name=3D"TOC-9.75.13" class=3D"tocanchor">9.75.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A7ECBB">Function <tt>open-socket-pai=
r</tt></a></dt>
<dt><a name=3D"TOC-9.75.14" class=3D"tocanchor">9.75.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0323EB36">Functions <tt>sock-family</t=
t> and <tt>sock-type</tt></a></dt>
<dt><a name=3D"TOC-9.75.15" class=3D"tocanchor">9.75.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015ABEC7">Accessor <tt>sock-peer</tt><=
/a></dt>
<dt><a name=3D"TOC-9.75.16" class=3D"tocanchor">9.75.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01FE18ED">Function <tt>sock-set-peer</=
tt></a></dt>
<dt><a name=3D"TOC-9.75.17" class=3D"tocanchor">9.75.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E5DFD4">Function <tt>sock-connect</t=
t></a></dt>
<dt><a name=3D"TOC-9.75.18" class=3D"tocanchor">9.75.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B052CF">Function <tt>sock-bind</tt><=
/a></dt>
<dt><a name=3D"TOC-9.75.19" class=3D"tocanchor">9.75.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02F624A8">Function <tt>sock-listen</tt=
></a></dt>
<dt><a name=3D"TOC-9.75.20" class=3D"tocanchor">9.75.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">Function <tt>sock-accept</tt=
></a></dt>
<dt><a name=3D"TOC-9.75.21" class=3D"tocanchor">9.75.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-028953A4">Variables <tt>shut-rd</tt>, =
<tt>shut-wr</tt> and <tt>shut-rdwr</tt></a></dt>
<dt><a name=3D"TOC-9.75.22" class=3D"tocanchor">9.75.22</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0222BA70">Function <tt>sock-shutdown</=
tt></a></dt>
<dt><a name=3D"TOC-9.75.23" class=3D"tocanchor">9.75.23</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03DF15F2">Functions <tt>sock-recv-time=
out</tt> and <tt>sock-send-timeout</tt></a></dt>
<dt><a name=3D"TOC-9.75.24" class=3D"tocanchor">9.75.24</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01FF658D">Functions <tt>str-inaddr</tt=
> and <tt>str-in6addr</tt></a></dt>
<dt><a name=3D"TOC-9.75.25" class=3D"tocanchor">9.75.25</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00918411">Functions <tt>str-inaddr-net=
</tt> and <tt>str-in6addr-net</tt></a></dt>
<dt><a name=3D"TOC-9.75.26" class=3D"tocanchor">9.75.26</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02456270">Functions <tt>inaddr-str</tt=
> and <tt>in6addr-str</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.76" class=3D"tocanchor">9.76</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0260AE30">Unix Terminal Control</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0214" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.76.1" class=3D"tocanchor">9.76.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-039CD619">Structure <tt>termios</tt></a>=
</dt>
<dt><a name=3D"TOC-9.76.2" class=3D"tocanchor">9.76.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02391683">Variables <tt>ignbrk</tt>, <tt=
>brkint</tt>, <tt>ignpar</tt>, <tt>parmrk</tt>, <tt>inpck</tt>, <tt>istrip<=
/tt>, <tt>inlcr</tt>, <tt>igncr</tt>, <tt>icrnl</tt>, <tt>iuclc</tt>, <tt>i=
xon</tt>, <tt>ixany</tt>, <tt>ixoff</tt>, <tt>imaxbel</tt> and <tt>iutf8</t=
t></a></dt>
<dt><a name=3D"TOC-9.76.3" class=3D"tocanchor">9.76.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03BD477F">Variables <tt>opost</tt>, <tt>=
olcuc</tt>, <tt>onlcr</tt>, <tt>ocrnl</tt>, <tt>onocr</tt>, <tt>onlret</tt>=
, <tt>ofill</tt>, <tt>ofdel</tt>, <tt>vtdly</tt>, <tt>vt0</tt>, <tt>vt1</tt=
>, <tt>nldly</tt>, <tt>nl0</tt>, <tt>nl1</tt>, <tt>crdly</tt>, <tt>cr0</tt>=
, <tt>cr1</tt>, <tt>cr2</tt>, <tt>cr3</tt>, <tt>tabdly</tt>, <tt>tab0</tt>,=
 <tt>tab1</tt>, <tt>tab2</tt>, <tt>tab3</tt>, <tt>bsdly</tt>, <tt>bs0</tt>,=
 <tt>bs1</tt>, <tt>ffdly</tt>, <tt>ff0</tt> and <tt>ff1</tt></a></dt>
<dt><a name=3D"TOC-9.76.4" class=3D"tocanchor">9.76.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B1B5DF">Variables <tt>csize</tt>, <tt>=
cs5</tt>, <tt>cs6</tt>, <tt>cs7</tt>, <tt>cs8</tt>, <tt>cstopb</tt>, <tt>cr=
ead</tt>, <tt>parenb</tt>, <tt>parodd</tt>, <tt>hupcl</tt>, <tt>clocal</tt>=
, <tt>cbaud</tt>, <tt>cbaudex</tt>, <tt>cmspar</tt> and <tt>crtscts</tt></a=
></dt>
<dt><a name=3D"TOC-9.76.5" class=3D"tocanchor">9.76.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0072FF5E">Variables <tt>isig</tt>, <tt>i=
canon</tt>, <tt>echo</tt>, <tt>echoe</tt>, <tt>echok</tt>, <tt>echonl</tt>,=
 <tt>noflsh</tt>, <tt>tostop</tt>, <tt>iexten</tt>, <tt>xcase</tt>, <tt>ech=
octl</tt>, <tt>echoprt</tt>, <tt>echoke</tt>, <tt>flusho</tt>, <tt>pendin</=
tt> and <tt>extproc</tt></a></dt>
<dt><a name=3D"TOC-9.76.6" class=3D"tocanchor">9.76.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01812D70">Variables <tt>vintr</tt>, <tt>=
vquit</tt>, <tt>verase</tt>, <tt>vkill</tt>, <tt>veof</tt>, <tt>vtime</tt>,=
 <tt>vmin</tt>, <tt>vswtc</tt>, <tt>vstart</tt>, <tt>vstop</tt>, <tt>vsusp<=
/tt>, <tt>veol</tt>, <tt>vreprint</tt>, <tt>vdiscard</tt>, <tt>vwerase</tt>=
, <tt>vlnext</tt> and <tt>veol2</tt></a></dt>
<dt><a name=3D"TOC-9.76.7" class=3D"tocanchor">9.76.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02173FF9">Variables <tt>tcooff</tt>, <tt=
>tcoon</tt>, <tt>tcioff</tt> and <tt>tcion</tt></a></dt>
<dt><a name=3D"TOC-9.76.8" class=3D"tocanchor">9.76.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0279ED46">Variables <tt>tciflush</tt>, <=
tt>tcoflush</tt> and <tt>tcioflush</tt></a></dt>
<dt><a name=3D"TOC-9.76.9" class=3D"tocanchor">9.76.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02C6ECF5">Variables <tt>tcsanow</tt>, <t=
t>tcsadrain</tt> and <tt>tcsaflush</tt></a></dt>
<dt><a name=3D"TOC-9.76.10" class=3D"tocanchor">9.76.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-013D13CA">Functions <tt>tcgetattr</tt>=
 and <tt>tcsetattr</tt></a></dt>
<dt><a name=3D"TOC-9.76.11" class=3D"tocanchor">9.76.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-033C365C">Function <tt>tcsendbreak</tt=
></a></dt>
<dt><a name=3D"TOC-9.76.12" class=3D"tocanchor">9.76.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01AC4760">Function <tt>tcdrain</tt></a=
></dt>
<dt><a name=3D"TOC-9.76.13" class=3D"tocanchor">9.76.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-034C4A4D">Function <tt>tcflush</tt></a=
></dt>
<dt><a name=3D"TOC-9.76.14" class=3D"tocanchor">9.76.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03081D51">Function <tt>tcflow</tt></a>=
</dt>
<dt><a name=3D"TOC-9.76.15" class=3D"tocanchor">9.76.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02061924">Methods <tt>set-iflags</tt>,=
 <tt>set-oflags</tt>, <tt>set-cflags</tt>, <tt>set-lflags</tt>, <tt>clear-i=
flags</tt>, <tt>clear-oflags</tt>, <tt>clear-cflags</tt> and <tt>clear-lfla=
gs</tt></a></dt>
<dt><a name=3D"TOC-9.76.16" class=3D"tocanchor">9.76.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03DCB007">Methods <tt>go-raw</tt> and =
<tt>go-cbreak</tt></a></dt>
<dt><a name=3D"TOC-9.76.17" class=3D"tocanchor">9.76.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-033502F8">Methods <tt>string-encode</t=
t> and <tt>string-decode</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.77" class=3D"tocanchor">9.77</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0191BDC8">Unix System Identification</a=
><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt=
>[+]</tt></a></dt>
<dd><dl id=3D"g0215" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.77.1" class=3D"tocanchor">9.77.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-003D12F6">Structure <tt>utsname</tt></a>=
</dt>
<dt><a name=3D"TOC-9.77.2" class=3D"tocanchor">9.77.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0308D954">Function <tt>uname</tt></a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-9.78" class=3D"tocanchor">9.78</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00708D78">Web Programming Support</a><a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+=
]</tt></a></dt>
<dd><dl id=3D"g0216" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.78.1" class=3D"tocanchor">9.78.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0388DB26">Functions <tt>url-encode</tt> =
and <tt>url-decode</tt></a></dt>
<dt><a name=3D"TOC-9.78.2" class=3D"tocanchor">9.78.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01263EAE">Functions <tt>html-encode</tt>=
, <tt>html-encode*</tt> and <tt>html-decode</tt></a></dt>
<dt><a name=3D"TOC-9.78.3" class=3D"tocanchor">9.78.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B05083">Functions <tt>base64-encode</t=
t>, <tt>base64-decode</tt> and <tt>base64-decode-buf</tt></a></dt>
<dt><a name=3D"TOC-9.78.4" class=3D"tocanchor">9.78.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03BEDB34">Functions <tt>base64-stream-en=
c</tt> and <tt>base64-stream-dec</tt></a></dt>
<dt><a name=3D"TOC-9.78.5" class=3D"tocanchor">9.78.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D46C3D">Functions <tt>base64url-encode=
</tt>, <tt>base64url-decode</tt> and <tt>base64url-decode-buf</tt></a></dt>
<dt><a name=3D"TOC-9.78.6" class=3D"tocanchor">9.78.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-016A14B3">Functions <tt>base64url-stream=
-enc</tt> and <tt>base64url-stream-dec</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.79" class=3D"tocanchor">9.79</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00062533">Filter Module</a><a href=3D"h=
ttp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a>=
</dt>
<dd><dl id=3D"g0217" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.79.1" class=3D"tocanchor">9.79.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03C1B843">Function <tt>make-trie</tt></a=
></dt>
<dt><a name=3D"TOC-9.79.2" class=3D"tocanchor">9.79.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0006C677">Function <tt>trie-add</tt></a>=
</dt>
<dt><a name=3D"TOC-9.79.3" class=3D"tocanchor">9.79.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00026B83">Function <tt>trie-compress</tt=
></a></dt>
<dt><a name=3D"TOC-9.79.4" class=3D"tocanchor">9.79.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02D16290">Function <tt>trie-lookup-begin=
</tt></a></dt>
<dt><a name=3D"TOC-9.79.5" class=3D"tocanchor">9.79.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-014E6D7B">Function <tt>trie-lookup-feed-=
char</tt></a></dt>
<dt><a name=3D"TOC-9.79.6" class=3D"tocanchor">9.79.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-012A5FAD">Function <tt>tree-value-at</tt=
></a></dt>
<dt><a name=3D"TOC-9.79.7" class=3D"tocanchor">9.79.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00C9EEB0">Function <tt>filter-string-tre=
e</tt></a></dt>
<dt><a name=3D"TOC-9.79.8" class=3D"tocanchor">9.79.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03136087">Function <tt>filter-equal</tt>=
</a></dt>
<dt><a name=3D"TOC-9.79.9" class=3D"tocanchor">9.79.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E48912">Function <tt>regex-from-trie</=
tt></a></dt>
<dt><a name=3D"TOC-9.79.10" class=3D"tocanchor">9.79.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E6A902">Special variable <tt>*filter=
s*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.80" class=3D"tocanchor">9.80</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-016B867F">Access To TXR Pattern Languag=
e From Lisp</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=
=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0218" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.80.1" class=3D"tocanchor">9.80.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033F766A">Function <tt>match-fun</tt></a=
></dt>
<dt><a name=3D"TOC-9.80.2" class=3D"tocanchor">9.80.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00355D4E">Macro <tt>txr-if</tt></a></dt>
<dt><a name=3D"TOC-9.80.3" class=3D"tocanchor">9.80.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02311DCA">Macro <tt>txr-when</tt></a></d=
t>
<dt><a name=3D"TOC-9.80.4" class=3D"tocanchor">9.80.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03813122">Macro <tt>txr-case</tt></a></d=
t>
<dt><a name=3D"TOC-9.80.5" class=3D"tocanchor">9.80.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02AC7FB4">Function <tt>txr-parse</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-9.81" class=3D"tocanchor">9.81</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00D4DA37">Debugging Functions</a><a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</t=
t></a></dt>
<dd><dl id=3D"g0219" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.81.1" class=3D"tocanchor">9.81.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0370CD69">Functions <tt>source-loc</tt> =
and <tt>source-loc-str</tt></a></dt>
<dt><a name=3D"TOC-9.81.2" class=3D"tocanchor">9.81.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-024EB211">Functions <tt>rlcp</tt> and <t=
t>rlcp-tree</tt></a></dt>
<dt><a name=3D"TOC-9.81.3" class=3D"tocanchor">9.81.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-014AFEA9">Special variable <tt>*rec-sour=
ce-loc*</tt></a></dt>
<dt><a name=3D"TOC-9.81.4" class=3D"tocanchor">9.81.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00519E96">Function <tt>macro-ancestor</t=
t></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.82" class=3D"tocanchor">9.82</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01D04262">Profiling</a><a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt=
>
<dd><dl id=3D"g0220" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.82.1" class=3D"tocanchor">9.82.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-004C9B10">Operator <tt>prof</tt></a></dt=
>
<dt><a name=3D"TOC-9.82.2" class=3D"tocanchor">9.82.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018C92AB">Macro <tt>pprof</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.83" class=3D"tocanchor">9.83</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01D94F50">Garbage Collection</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0221" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.83.1" class=3D"tocanchor">9.83.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01C75157">Function <tt>sys:gc</tt></a></=
dt>
<dt><a name=3D"TOC-9.83.2" class=3D"tocanchor">9.83.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02C0C748">Function <tt>sys:gc-set-delta<=
/tt></a></dt>
<dt><a name=3D"TOC-9.83.3" class=3D"tocanchor">9.83.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01230613">Function <tt>finalize</tt></a>=
</dt>
<dt><a name=3D"TOC-9.83.4" class=3D"tocanchor">9.83.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02AF83A0">Function <tt>call-finalizers</=
tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.84" class=3D"tocanchor">9.84</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01A6690F">Modularization</a><a href=3D"=
http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a=
></dt>
<dd><dl id=3D"g0222" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.84.1" class=3D"tocanchor">9.84.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03561A65">Variable <tt>self-path</tt></a=
></dt>
<dt><a name=3D"TOC-9.84.2" class=3D"tocanchor">9.84.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008E4BC2">Variable <tt>stdlib</tt></a></=
dt>
<dt><a name=3D"TOC-9.84.3" class=3D"tocanchor">9.84.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0306CE9C">Function <tt>load</tt></a></dt=
>
<dt><a name=3D"TOC-9.84.4" class=3D"tocanchor">9.84.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D1DB58">Special variable <tt>*load-pat=
h*</tt></a></dt>
<dt><a name=3D"TOC-9.84.5" class=3D"tocanchor">9.84.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0020A085">Macro <tt>load-for</tt></a></d=
t>
<dt><a name=3D"TOC-9.84.6" class=3D"tocanchor">9.84.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-014C116E">Variable <tt>txr-exe-path</tt>=
</a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.85" class=3D"tocanchor">9.85</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-01F1599C">Function Tracing</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0223" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.85.1" class=3D"tocanchor">9.85.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0067A6AC">Special variable <tt>*trace-ou=
tput*</tt></a></dt>
<dt><a name=3D"TOC-9.85.2" class=3D"tocanchor">9.85.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02833733">Macros <tt>trace</tt> and <tt>=
untrace</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-9.86" class=3D"tocanchor">9.86</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00E098FA">Dynamic Library Access</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0224" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-9.86.1" class=3D"tocanchor">9.86.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037C4BFE">Function <tt>dlopen</tt></a></=
dt>
<dt><a name=3D"TOC-9.86.2" class=3D"tocanchor">9.86.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-033F7DE5">Function <tt>dlclose</tt></a><=
/dt>
<dt><a name=3D"TOC-9.86.3" class=3D"tocanchor">9.86.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01B1E865">Functions <tt>dlsym</tt> and <=
tt>dlvsym</tt></a></dt>
<dt><a name=3D"TOC-9.86.4" class=3D"tocanchor">9.86.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-029063A0">Functions <tt>dlsym-checked</t=
t> and <tt>dlvsym-checked</tt></a></dt>
<dt><a name=3D"TOC-9.86.5" class=3D"tocanchor">9.86.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0083A22A">Variables <tt>rtld-lazy</tt>, =
<tt>rtld-now</tt>, <tt>rtld-global</tt>, <tt>rtld-local</tt>, <tt>rtld-node=
lete</tt>, <tt>rtld-noload</tt> and <tt>rtld-deepbind</tt></a></dt>
</dl>
</dd></dl>
</dd><dt><a name=3D"TOC-10" class=3D"tocanchor">10</a> <a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#N-0275762A">FOREIGN FUNCTION INTERFACE</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0225" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.1" class=3D"tocanchor">10.1</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-02163660">Cautionary Notes</a></dt>
<dt><a name=3D"TOC-10.2" class=3D"tocanchor">10.2</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-010AF4DA">Key Concepts</a><a href=3D"http://=
nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0226" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.2.1" class=3D"tocanchor">10.2.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FC6677">The <i>put</i> operation</a></=
dt>
<dt><a name=3D"TOC-10.2.2" class=3D"tocanchor">10.2.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03DFB320">The <i>in</i> operation</a></d=
t>
<dt><a name=3D"TOC-10.2.3" class=3D"tocanchor">10.2.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-032B6677">The <i>get</i> operation</a></=
dt>
<dt><a name=3D"TOC-10.2.4" class=3D"tocanchor">10.2.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-032BF677">The <i>out</i> operation</a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-10.3" class=3D"tocanchor">10.3</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0233907C">The FFI Type System</a></dt>
<dt><a name=3D"TOC-10.4" class=3D"tocanchor">10.4</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-0324B36D">Simple FFI Types</a><a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></=
dt>
<dd><dl id=3D"g0227" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.4.1" class=3D"tocanchor">10.4.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0008D7DC">FFI types <tt>char</tt>, <tt>z=
char</tt>, <tt>uchar</tt> and <tt>bchar</tt></a></dt>
<dt><a name=3D"TOC-10.4.2" class=3D"tocanchor">10.4.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-018C7C8C">FFI types <tt>short</tt>, <tt>=
ushort</tt>, <tt>int</tt>, <tt>uint</tt>, <tt>long</tt>, <tt>and</tt> <tt>u=
long</tt></a></dt>
<dt><a name=3D"TOC-10.4.3" class=3D"tocanchor">10.4.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02299408">FFI types <tt>longlong</tt> an=
d <tt>ulonglong</tt></a></dt>
<dt><a name=3D"TOC-10.4.4" class=3D"tocanchor">10.4.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0131FBF2">FFI types <tt>int8</tt> and <t=
t>uint8</tt></a></dt>
<dt><a name=3D"TOC-10.4.5" class=3D"tocanchor">10.4.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D0AA7B">FFI types <tt>int16</tt>, <tt>=
uint16</tt>, <tt>int32</tt>, <tt>uint32</tt>, <tt>int64</tt> and <tt>uint64=
</tt></a></dt>
<dt><a name=3D"TOC-10.4.6" class=3D"tocanchor">10.4.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03237030">FFI types <tt>float</tt> and <=
tt>double</tt></a></dt>
<dt><a name=3D"TOC-10.4.7" class=3D"tocanchor">10.4.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03BDE6A5">FFI type <tt>bool</tt></a></dt=
>
<dt><a name=3D"TOC-10.4.8" class=3D"tocanchor">10.4.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00DB04DD">FFI type <tt>val</tt></a></dt>
<dt><a name=3D"TOC-10.4.9" class=3D"tocanchor">10.4.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019DE724">FFI type <tt>cptr</tt></a></dt=
>
<dt><a name=3D"TOC-10.4.10" class=3D"tocanchor">10.4.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">FFI types <tt>str</tt>, <tt>=
bstr</tt>, <tt>str-d</tt> and <tt>bstr-d</tt></a></dt>
<dt><a name=3D"TOC-10.4.11" class=3D"tocanchor">10.4.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-032DB6DC">FFI types <tt>wstr</tt> and =
<tt>wstr-d</tt></a></dt>
<dt><a name=3D"TOC-10.4.12" class=3D"tocanchor">10.4.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0384A6E7">FFI types <tt>buf</tt> and <=
tt>buf-d</tt></a></dt>
<dt><a name=3D"TOC-10.4.13" class=3D"tocanchor">10.4.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0216EF16">FFI type <tt>closure</tt></a=
></dt>
<dt><a name=3D"TOC-10.4.14" class=3D"tocanchor">10.4.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-013DE1A3">FFI type <tt>void</tt></a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-10.5" class=3D"tocanchor">10.5</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-03C7DF28">Parametrized FFI Type Operato=
rs</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"=
> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0228" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.5.1" class=3D"tocanchor">10.5.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01CDE57C">FFI type <tt>enum</tt></a></dt=
>
<dt><a name=3D"TOC-10.5.2" class=3D"tocanchor">10.5.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01096D60">FFI type <tt>enumed</tt></a></=
dt>
<dt><a name=3D"TOC-10.5.3" class=3D"tocanchor">10.5.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0005D5C1">FFI type <tt>struct</tt></a></=
dt>
<dt><a name=3D"TOC-10.5.4" class=3D"tocanchor">10.5.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01C78B86">FFI type <tt>union</tt></a></d=
t>
<dt><a name=3D"TOC-10.5.5" class=3D"tocanchor">10.5.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0117BE95">FFI type <tt>array</tt></a></d=
t>
<dt><a name=3D"TOC-10.5.6" class=3D"tocanchor">10.5.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-017039ED">FFI type <tt>zarray</tt></a></=
dt>
<dt><a name=3D"TOC-10.5.7" class=3D"tocanchor">10.5.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-027B04D0">FFI type <tt>ptr</tt></a></dt>
<dt><a name=3D"TOC-10.5.8" class=3D"tocanchor">10.5.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00A494BF">FFI type <tt>ptr-in</tt></a></=
dt>
<dt><a name=3D"TOC-10.5.9" class=3D"tocanchor">10.5.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03D4DF7E">FFI type <tt>ptr-out</tt></a><=
/dt>
<dt><a name=3D"TOC-10.5.10" class=3D"tocanchor">10.5.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01D7AC98">FFI type <tt>ptr-in-d</tt></=
a></dt>
<dt><a name=3D"TOC-10.5.11" class=3D"tocanchor">10.5.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02036BEC">FFI type <tt>ptr-out-d</tt><=
/a></dt>
<dt><a name=3D"TOC-10.5.12" class=3D"tocanchor">10.5.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02D36BEC">FFI type <tt>ptr-out-s</tt><=
/a></dt>
<dt><a name=3D"TOC-10.5.13" class=3D"tocanchor">10.5.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E6A76D">FFI type <tt>bool</tt></a></=
dt>
<dt><a name=3D"TOC-10.5.14" class=3D"tocanchor">10.5.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011F2878">FFI types <tt>ubit</tt> and =
<tt>sbit</tt></a></dt>
<dt><a name=3D"TOC-10.5.15" class=3D"tocanchor">10.5.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-015B052B">FFI type <tt>bit</tt></a></d=
t>
<dt><a name=3D"TOC-10.5.16" class=3D"tocanchor">10.5.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00A6E963">FFI types <tt>buf</tt> and <=
tt>buf-d</tt></a></dt>
<dt><a name=3D"TOC-10.5.17" class=3D"tocanchor">10.5.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0139F9ED">FFI type <tt>carray</tt></a>=
</dt>
<dt><a name=3D"TOC-10.5.18" class=3D"tocanchor">10.5.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E726E5">FFI type <tt>cptr</tt></a></=
dt>
<dt><a name=3D"TOC-10.5.19" class=3D"tocanchor">10.5.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01C7BC08">FFI type <tt>align</tt></a><=
/dt>
</dl>
</dd><dt><a name=3D"TOC-10.6" class=3D"tocanchor">10.6</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0286B807">Additional Types</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0229" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.6.1" class=3D"tocanchor">10.6.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03258244">FFI types <tt>size-t</tt>, <tt=
>ptrdiff-t</tt>, <tt>int-ptr-t</tt>, <tt>uint-ptr-t</tt>, <tt>wint-t</tt>, =
<tt>sig-atomic-t</tt>, <tt>time-t</tt> and <tt>clock-t</tt> .</a></dt>
<dt><a name=3D"TOC-10.6.2" class=3D"tocanchor">10.6.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-015DE290">FFI type <tt>qref</tt></a></dt=
>
<dt><a name=3D"TOC-10.6.3" class=3D"tocanchor">10.6.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-008CEE1E">FFI type <tt>elemtype</tt></a>=
</dt>
<dt><a name=3D"TOC-10.6.4" class=3D"tocanchor">10.6.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01D716FE">FFI types <tt>blkcnt-t</tt>, <=
tt>blksize-t</tt>, <tt>clockid-t</tt>, <tt>dev-t</tt>, <tt>fsblkcnt-t</tt>,=
 <tt>fsfilcnt-t</tt>, <tt>gid-t</tt>, <tt>id-t</tt>, <tt>ino-t</tt>, <tt>ke=
y-t</tt>, <tt>loff-t</tt>, <tt>mode-t</tt>, <tt>nlink-t</tt>, <tt>off-t</tt=
>, <tt>pid-t</tt>, <tt>ssize-t</tt> and <tt>uid-t</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-10.7" class=3D"tocanchor">10.7</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-018D3223">Endian Types</a></dt>
<dt><a name=3D"TOC-10.8" class=3D"tocanchor">10.8</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-02ECE110">Incomplete Types</a></dt>
<dt><a name=3D"TOC-10.9" class=3D"tocanchor">10.9</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-02DBE9F3">Flexible Structures</a></dt>
<dt><a name=3D"TOC-10.10" class=3D"tocanchor">10.10</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-027D075C">Bitfield Allocation Rules</a></d=
t>
<dt><a name=3D"TOC-10.11" class=3D"tocanchor">10.11</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03231BE6">FFI Call Descriptors</a></dt>
<dt><a name=3D"TOC-10.12" class=3D"tocanchor">10.12</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01D49526">Foreign Function Type API</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0230" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.12.1" class=3D"tocanchor">10.12.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02940F9A">Function <tt>ffi-type-compil=
e</tt></a></dt>
<dt><a name=3D"TOC-10.12.2" class=3D"tocanchor">10.12.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01A96E1C">Function <tt>ffi-make-call-d=
esc</tt></a></dt>
<dt><a name=3D"TOC-10.12.3" class=3D"tocanchor">10.12.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E31038">Function <tt>ffi-type-operat=
or-p</tt></a></dt>
<dt><a name=3D"TOC-10.12.4" class=3D"tocanchor">10.12.4</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01EE962E">Function <tt>ffi-type-p</tt>=
</a></dt>
<dt><a name=3D"TOC-10.12.5" class=3D"tocanchor">10.12.5</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0095DF58">Function <tt>ffi-make-closur=
e</tt></a></dt>
<dt><a name=3D"TOC-10.12.6" class=3D"tocanchor">10.12.6</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023DCFF9">Function <tt>ffi-call</tt></=
a></dt>
<dt><a name=3D"TOC-10.12.7" class=3D"tocanchor">10.12.7</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0094D6D7">Function <tt>ffi-typedef</tt=
></a></dt>
<dt><a name=3D"TOC-10.12.8" class=3D"tocanchor">10.12.8</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00CDBB53">Function <tt>ffi-size</tt></=
a></dt>
<dt><a name=3D"TOC-10.12.9" class=3D"tocanchor">10.12.9</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00061B61">Function <tt>ffi-alignof</tt=
></a></dt>
<dt><a name=3D"TOC-10.12.10" class=3D"tocanchor">10.12.10</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-0318DA0C">Function <tt>ffi-offsetof<=
/tt></a></dt>
<dt><a name=3D"TOC-10.12.11" class=3D"tocanchor">10.12.11</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-03DC1AED">Function <tt>ffi-arraysize=
</tt></a></dt>
<dt><a name=3D"TOC-10.12.12" class=3D"tocanchor">10.12.12</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-00DF8E15">Function <tt>ffi-elemsize<=
/tt></a></dt>
<dt><a name=3D"TOC-10.12.13" class=3D"tocanchor">10.12.13</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-02DF8E12">Function <tt>ffi-elemtype<=
/tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-10.13" class=3D"tocanchor">10.13</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-03311048">Foreign Function Macro Lang=
uage</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggl=
e"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0231" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.13.1" class=3D"tocanchor">10.13.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023E0D2C">Macro <tt>with-dyn-lib</tt><=
/a></dt>
<dt><a name=3D"TOC-10.13.2" class=3D"tocanchor">10.13.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00DCE51D">Macro <tt>deffi</tt></a></dt=
>
<dt><a name=3D"TOC-10.13.3" class=3D"tocanchor">10.13.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00C54FC8">Macros <tt>deffi-cb</tt> and=
 <tt>deffi-cb-unsafe</tt></a></dt>
<dt><a name=3D"TOC-10.13.4" class=3D"tocanchor">10.13.4</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C237C9">Macro <tt>deffi-var</tt></a>=
</dt>
<dt><a name=3D"TOC-10.13.5" class=3D"tocanchor">10.13.5</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02B237BB">Macro <tt>deffi-sym</tt></a>=
</dt>
<dt><a name=3D"TOC-10.13.6" class=3D"tocanchor">10.13.6</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01BE95E8">Macro <tt>typedef</tt></a></=
dt>
<dt><a name=3D"TOC-10.13.7" class=3D"tocanchor">10.13.7</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0235DCAE">Macro <tt>sizeof</tt></a></d=
t>
<dt><a name=3D"TOC-10.13.8" class=3D"tocanchor">10.13.8</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-000F730E">Macro <tt>alignof</tt></a></=
dt>
<dt><a name=3D"TOC-10.13.9" class=3D"tocanchor">10.13.9</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-013D0A5C">Macro <tt>offsetof</tt></a><=
/dt>
<dt><a name=3D"TOC-10.13.10" class=3D"tocanchor">10.13.10</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-002129D6">Macro <tt>arraysize</tt></=
a></dt>
<dt><a name=3D"TOC-10.13.11" class=3D"tocanchor">10.13.11</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-01D55CC4">Macro <tt>elemsize</tt></a=
></dt>
<dt><a name=3D"TOC-10.13.12" class=3D"tocanchor">10.13.12</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-03D55EC5">Macro <tt>elemtype</tt></a=
></dt>
<dt><a name=3D"TOC-10.13.13" class=3D"tocanchor">10.13.13</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-020F3A1C">Macro <tt>ffi</tt></a></dt=
>
</dl>
</dd><dt><a name=3D"TOC-10.14" class=3D"tocanchor">10.14</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-00AE2961">Zero-filled Object Support<=
/a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <=
tt>[+]</tt></a></dt>
<dd><dl id=3D"g0232" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.14.1" class=3D"tocanchor">10.14.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03855D2D">Function <tt>make-zstruct</t=
t></a></dt>
<dt><a name=3D"TOC-10.14.2" class=3D"tocanchor">10.14.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00B1FC38">Macro <tt>znew</tt></a></dt>
<dt><a name=3D"TOC-10.14.3" class=3D"tocanchor">10.14.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-016D3BB5">Function <tt>zero-fill</tt><=
/a></dt>
</dl>
</dd><dt><a name=3D"TOC-10.15" class=3D"tocanchor">10.15</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-0362C74D">Foreign Unions</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0233" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.15.1" class=3D"tocanchor">10.15.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-010A23C0">Function <tt>make-union</tt>=
</a></dt>
<dt><a name=3D"TOC-10.15.2" class=3D"tocanchor">10.15.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-008912E4">Function <tt>union-members</=
tt></a></dt>
<dt><a name=3D"TOC-10.15.3" class=3D"tocanchor">10.15.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02FA4F0C">Function <tt>union-get</tt><=
/a></dt>
<dt><a name=3D"TOC-10.15.4" class=3D"tocanchor">10.15.4</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02FA4EBC">Function <tt>union-put</tt><=
/a></dt>
<dt><a name=3D"TOC-10.15.5" class=3D"tocanchor">10.15.5</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02258991">Functions <tt>union-in</tt> =
and <tt>union-out</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-10.16" class=3D"tocanchor">10.16</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-030C8E8A">FFI-type-driven I/O Functio=
ns</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"=
> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0234" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.16.1" class=3D"tocanchor">10.16.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-025DB229">Function <tt>put-obj</tt></a=
></dt>
<dt><a name=3D"TOC-10.16.2" class=3D"tocanchor">10.16.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0315B229">Function <tt>get-obj</tt></a=
></dt>
<dt><a name=3D"TOC-10.16.3" class=3D"tocanchor">10.16.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0039A1D1">Function <tt>fill-obj</tt></=
a></dt>
</dl>
</dd><dt><a name=3D"TOC-10.17" class=3D"tocanchor">10.17</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-037C2C57">Buffer Functions</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0235" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.17.1" class=3D"tocanchor">10.17.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0000F6A9">Functions <tt>ffi-put</tt> a=
nd <tt>ffi-put-into</tt></a></dt>
<dt><a name=3D"TOC-10.17.2" class=3D"tocanchor">10.17.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02330623">Function <tt>ffi-out</tt></a=
></dt>
<dt><a name=3D"TOC-10.17.3" class=3D"tocanchor">10.17.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-037AAB17">Function <tt>ffi-in</tt></a>=
</dt>
<dt><a name=3D"TOC-10.17.4" class=3D"tocanchor">10.17.4</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023305C7">Function <tt>ffi-get</tt></a=
></dt>
</dl>
</dd><dt><a name=3D"TOC-10.18" class=3D"tocanchor">10.18</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-0228461D">Foreign Arrays</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0236" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-10.18.1" class=3D"tocanchor">10.18.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00E825E0">Functions <tt>carray-vec</tt=
> and <tt>carray-list</tt></a></dt>
<dt><a name=3D"TOC-10.18.2" class=3D"tocanchor">10.18.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-027E7FFC">Function <tt>carrayp</tt></a=
></dt>
<dt><a name=3D"TOC-10.18.3" class=3D"tocanchor">10.18.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00DD8DF1">Function <tt>carray-blank</t=
t></a></dt>
<dt><a name=3D"TOC-10.18.4" class=3D"tocanchor">10.18.4</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-00D75AD6">Function <tt>carray-buf</tt>=
</a></dt>
<dt><a name=3D"TOC-10.18.5" class=3D"tocanchor">10.18.5</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02F23E0F">Function <tt>carray-buf-sync=
</tt></a></dt>
<dt><a name=3D"TOC-10.18.6" class=3D"tocanchor">10.18.6</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0022F54E">Function <tt>buf-carray</tt>=
</a></dt>
<dt><a name=3D"TOC-10.18.7" class=3D"tocanchor">10.18.7</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E001C5">Function <tt>carray-cptr</tt=
></a></dt>
<dt><a name=3D"TOC-10.18.8" class=3D"tocanchor">10.18.8</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03FF97BD">Function <tt>length-carray</=
tt></a></dt>
<dt><a name=3D"TOC-10.18.9" class=3D"tocanchor">10.18.9</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-006593D0">Function <tt>copy-carray</tt=
></a></dt>
<dt><a name=3D"TOC-10.18.10" class=3D"tocanchor">10.18.10</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-00705BC4">Function <tt>carray-set-le=
ngth</tt></a></dt>
<dt><a name=3D"TOC-10.18.11" class=3D"tocanchor">10.18.11</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-001F5BCA">Accessor <tt>carray-ref</t=
t></a></dt>
<dt><a name=3D"TOC-10.18.12" class=3D"tocanchor">10.18.12</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-000127F9">Function <tt>carray-refset=
</tt></a></dt>
<dt><a name=3D"TOC-10.18.13" class=3D"tocanchor">10.18.13</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-00058922">Functions <tt>carray-dup</=
tt> and <tt>carray-own</tt></a></dt>
<dt><a name=3D"TOC-10.18.14" class=3D"tocanchor">10.18.14</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-0010030E">Function <tt>carray-free</=
tt></a></dt>
<dt><a name=3D"TOC-10.18.15" class=3D"tocanchor">10.18.15</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-030FEDE6">Function <tt>carray-type</=
tt></a></dt>
<dt><a name=3D"TOC-10.18.16" class=3D"tocanchor">10.18.16</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-03EB1E3D">Functions <tt>vec-carray</=
tt> and <tt>list-carray</tt></a></dt>
<dt><a name=3D"TOC-10.18.17" class=3D"tocanchor">10.18.17</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-028920F5">Functions <tt>carray-get</=
tt> and <tt>carray-getz</tt></a></dt>
<dt><a name=3D"TOC-10.18.18" class=3D"tocanchor">10.18.18</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-02890B44">Functions <tt>carray-put</=
tt> and <tt>carray-putz</tt></a></dt>
<dt><a name=3D"TOC-10.18.19" class=3D"tocanchor">10.18.19</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-03DF5BC5">Accessor <tt>carray-sub</t=
t></a></dt>
<dt><a name=3D"TOC-10.18.20" class=3D"tocanchor">10.18.20</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-01AAF602">Function <tt>carray-replac=
e</tt></a></dt>
<dt><a name=3D"TOC-10.18.21" class=3D"tocanchor">10.18.21</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-0057639E">Function <tt>carray-pun</t=
t></a></dt>
<dt><a name=3D"TOC-10.18.22" class=3D"tocanchor">10.18.22</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-02403ED4">Functions <tt>carray-uint<=
/tt> and <tt>carray-int</tt></a></dt>
<dt><a name=3D"TOC-10.18.23" class=3D"tocanchor">10.18.23</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-00797A01">Functions <tt>uint-carray<=
/tt> and <tt>int-carray</tt></a></dt>
<dt><a name=3D"TOC-10.18.24" class=3D"tocanchor">10.18.24</a> <a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#N-00737951">Functions <tt>fill-carray<=
/tt> and <tt>put-carray</tt></a></dt>
</dl>
</dd></dl>
</dd><dt><a name=3D"TOC-11" class=3D"tocanchor">11</a> <a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#N-0195CD45">LISP COMPILATION</a><a href=3D"ht=
tp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a><=
/dt>
<dd><dl id=3D"g0237" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-11.1" class=3D"tocanchor">11.1</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-01CE7F17">Overview</a></dt>
<dt><a name=3D"TOC-11.2" class=3D"tocanchor">11.2</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-0314D5DA">Top-Level Forms</a></dt>
<dt><a name=3D"TOC-11.3" class=3D"tocanchor">11.3</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-01D9D5AE">File Compilation Model</a></dt>
<dt><a name=3D"TOC-11.4" class=3D"tocanchor">11.4</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-027938EC">Treatment of Literals</a></dt>
<dt><a name=3D"TOC-11.5" class=3D"tocanchor">11.5</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-030700A6">Treatment of The Hash Bang Line</a=
></dt>
<dt><a name=3D"TOC-11.6" class=3D"tocanchor">11.6</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03FBFCAE">Compiled File Compatibility</a></d=
t>
<dt><a name=3D"TOC-11.7" class=3D"tocanchor">11.7</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-0190C819">Semantic Differences between Compi=
lation and Interpretation</a><a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0238" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-11.7.1" class=3D"tocanchor">11.7.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-019FEC08">Differences due to <tt>load-ti=
me</tt></a></dt>
<dt><a name=3D"TOC-11.7.2" class=3D"tocanchor">11.7.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02793C6C">Treatment of literals</a></dt>
<dt><a name=3D"TOC-11.7.3" class=3D"tocanchor">11.7.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01368FC6">Treatment of unbound variables=
</a></dt>
<dt><a name=3D"TOC-11.7.4" class=3D"tocanchor">11.7.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-003616B1">Unbound symbols in <tt>dwim</t=
t></a></dt>
<dt><a name=3D"TOC-11.7.5" class=3D"tocanchor">11.7.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-027616B2">Bound symbols in <tt>dwim</tt>=
</a></dt>
<dt><a name=3D"TOC-11.7.6" class=3D"tocanchor">11.7.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03C89989">File-wide insertion of gensyms=
</a></dt>
<dt><a name=3D"TOC-11.7.7" class=3D"tocanchor">11.7.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E6B6D3">Delimited Continuations</a></d=
t>
</dl>
</dd><dt><a name=3D"TOC-11.8" class=3D"tocanchor">11.8</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-00C757AB">Compilation Library</a><a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</t=
t></a></dt>
<dd><dl id=3D"g0239" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-11.8.1" class=3D"tocanchor">11.8.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00DE8B13">Function <tt>compile-toplevel<=
/tt></a></dt>
<dt><a name=3D"TOC-11.8.2" class=3D"tocanchor">11.8.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-009542C1">Function <tt>compile</tt></a><=
/dt>
<dt><a name=3D"TOC-11.8.3" class=3D"tocanchor">11.8.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0211BE68">Functions <tt>compile-file</tt=
> and <tt>compile-update-file</tt></a></dt>
<dt><a name=3D"TOC-11.8.4" class=3D"tocanchor">11.8.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F68BBC">Special Variable <tt>*opt-leve=
l*</tt></a></dt>
<dt><a name=3D"TOC-11.8.5" class=3D"tocanchor">11.8.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-013AAB51">Macro <tt>with-compilation-uni=
t</tt></a></dt>
<dt><a name=3D"TOC-11.8.6" class=3D"tocanchor">11.8.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-030BF4F5">Operators <tt>compile-only</tt=
> and <tt>eval-only</tt></a></dt>
<dt><a name=3D"TOC-11.8.7" class=3D"tocanchor">11.8.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03A3999F">Macro <tt>load-time</tt></a></=
dt>
<dt><a name=3D"TOC-11.8.8" class=3D"tocanchor">11.8.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0289A0F1">Function <tt>disassemble</tt><=
/a></dt>
<dt><a name=3D"TOC-11.8.9" class=3D"tocanchor">11.8.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02FE7607">Function <tt>dump-compiled-obj=
ects</tt></a></dt>
</dl>
</dd></dl>
</dd><dt><a name=3D"TOC-12" class=3D"tocanchor">12</a> <a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#N-025AAA27">INTERACTIVE LISTENER</a><a href=
=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt=
></a></dt>
<dd><dl id=3D"g0240" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-12.1" class=3D"tocanchor">12.1</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-01CE7F14">Overview</a></dt>
<dt><a name=3D"TOC-12.2" class=3D"tocanchor">12.2</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-02C3773D">Basic Operation</a></dt>
<dt><a name=3D"TOC-12.3" class=3D"tocanchor">12.3</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-0276C551">Limitations</a></dt>
<dt><a name=3D"TOC-12.4" class=3D"tocanchor">12.4</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03ABCB3A">Ways to Quit</a></dt>
<dt><a name=3D"TOC-12.5" class=3D"tocanchor">12.5</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-004659B6">Interrupting Evaluation</a></dt>
<dt><a name=3D"TOC-12.6" class=3D"tocanchor">12.6</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-025B7305">Listener Variables</a><a href=3D"h=
ttp://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a>=
</dt>
<dd><dl id=3D"g0241" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-12.6.1" class=3D"tocanchor">12.6.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03F9BE17">Variables <tt>*0</tt>, <tt>*1<=
/tt>, <tt>*2</tt>, <tt>...</tt>, <tt>*99</tt></a></dt>
<dt><a name=3D"TOC-12.6.2" class=3D"tocanchor">12.6.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02B67C9B">Symbol Macros <tt>*-1</tt>, <t=
t>*-2</tt>, <tt>...</tt>, <tt>*-20</tt></a></dt>
<dt><a name=3D"TOC-12.6.3" class=3D"tocanchor">12.6.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-02E7AE5A">Variable <tt>*n</tt></a></dt>
<dt><a name=3D"TOC-12.6.4" class=3D"tocanchor">12.6.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0367AE5A">Variable <tt>*v</tt></a></dt>
<dt><a name=3D"TOC-12.6.5" class=3D"tocanchor">12.6.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03A7AE5A">Variable <tt>*r</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-12.7" class=3D"tocanchor">12.7</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-0012B6FD">Exceptions</a></dt>
<dt><a name=3D"TOC-12.8" class=3D"tocanchor">12.8</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03B0B055">Editing</a><a href=3D"http://nongn=
u.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0242" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-12.8.1" class=3D"tocanchor">12.8.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00155DB7">Move Left and Right</a></dt>
<dt><a name=3D"TOC-12.8.2" class=3D"tocanchor">12.8.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0134A700">Jump to Beginning and End of L=
ine</a></dt>
<dt><a name=3D"TOC-12.8.3" class=3D"tocanchor">12.8.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0108023E">Jump to Matching Parenthesis</=
a></dt>
<dt><a name=3D"TOC-12.8.4" class=3D"tocanchor">12.8.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01A79FD2">Character Swap</a></dt>
<dt><a name=3D"TOC-12.8.5" class=3D"tocanchor">12.8.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0209E06D">Delete Character Left</a></dt>
<dt><a name=3D"TOC-12.8.6" class=3D"tocanchor">12.8.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00AFC48C">Delete Character Right</a></dt=
>
<dt><a name=3D"TOC-12.8.7" class=3D"tocanchor">12.8.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-038DCC2F">Delete Word Left</a></dt>
<dt><a name=3D"TOC-12.8.8" class=3D"tocanchor">12.8.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0282D0CB">Delete to Beginning of Line</a=
></dt>
<dt><a name=3D"TOC-12.8.9" class=3D"tocanchor">12.8.9</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0144183A">Delete to End of Line</a></dt>
<dt><a name=3D"TOC-12.8.10" class=3D"tocanchor">12.8.10</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03580D9E">Verbatim Character Insert</a=
></dt>
<dt><a name=3D"TOC-12.8.11" class=3D"tocanchor">12.8.11</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0180B94A">Verbatim Insert Mode</a></dt=
>
<dt><a name=3D"TOC-12.8.12" class=3D"tocanchor">12.8.12</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0323EE8E">Delete Current Line</a></dt>
<dt><a name=3D"TOC-12.8.13" class=3D"tocanchor">12.8.13</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-017651D8">History Recall</a></dt>
<dt><a name=3D"TOC-12.8.14" class=3D"tocanchor">12.8.14</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01863EEC">History Search</a></dt>
<dt><a name=3D"TOC-12.8.15" class=3D"tocanchor">12.8.15</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02204D0C">Submit and Stay in History</=
a></dt>
<dt><a name=3D"TOC-12.8.16" class=3D"tocanchor">12.8.16</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023F7AE6">Insert Previous Word</a></dt=
>
<dt><a name=3D"TOC-12.8.17" class=3D"tocanchor">12.8.17</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023EEEBF">Insert Previous Atom</a></dt=
>
<dt><a name=3D"TOC-12.8.18" class=3D"tocanchor">12.8.18</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-023F0BA7">Insert Previous Line</a></dt=
>
<dt><a name=3D"TOC-12.8.19" class=3D"tocanchor">12.8.19</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03A78033">Symbolic Completion</a></dt>
<dt><a name=3D"TOC-12.8.20" class=3D"tocanchor">12.8.20</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01FD5995">Edit with External Editor</a=
></dt>
<dt><a name=3D"TOC-12.8.21" class=3D"tocanchor">12.8.21</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-029FCC15">Undo Editing</a></dt>
</dl>
</dd><dt><a name=3D"TOC-12.9" class=3D"tocanchor">12.9</a> <a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-02B77626">Visual Selection Mode</a><a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]<=
/tt></a></dt>
<dd><dl id=3D"g0243" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-12.9.1" class=3D"tocanchor">12.9.1</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E677F3">Making a Selection</a></dt>
<dt><a name=3D"TOC-12.9.2" class=3D"tocanchor">12.9.2</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00E05BF0">Selection Endpoint Toggle</a><=
/dt>
<dt><a name=3D"TOC-12.9.3" class=3D"tocanchor">12.9.3</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-03FBE514">Visual Copy</a></dt>
<dt><a name=3D"TOC-12.9.4" class=3D"tocanchor">12.9.4</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-037FBEEE">Visual Cut</a></dt>
<dt><a name=3D"TOC-12.9.5" class=3D"tocanchor">12.9.5</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-0270B8E7">Clipboard Paste</a></dt>
<dt><a name=3D"TOC-12.9.6" class=3D"tocanchor">12.9.6</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-028048CE">Clipboard Swap Paste</a></dt>
<dt><a name=3D"TOC-12.9.7" class=3D"tocanchor">12.9.7</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-00F08526">Visual Replace</a></dt>
<dt><a name=3D"TOC-12.9.8" class=3D"tocanchor">12.9.8</a> <a href=3D"http:/=
/nongnu.org/txr/txr-manpage.html#N-01780CEC">Delete in Selection Mode</a></=
dt>
</dl>
</dd><dt><a name=3D"TOC-12.10" class=3D"tocanchor">12.10</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-00E041A0">Multi-Line Mode</a></dt>
<dt><a name=3D"TOC-12.11" class=3D"tocanchor">12.11</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0077CFA3">Reading Forms Directly from the =
Terminal</a></dt>
<dt><a name=3D"TOC-12.12" class=3D"tocanchor">12.12</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-013F32E9">Clear Screen and Refresh</a></dt=
>
<dt><a name=3D"TOC-12.13" class=3D"tocanchor">12.13</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02C789B1">Suspend to Background</a></dt>
<dt><a name=3D"TOC-12.14" class=3D"tocanchor">12.14</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0182AD71">Editing Help</a></dt>
<dt><a name=3D"TOC-12.15" class=3D"tocanchor">12.15</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02CF4979">Print the Prompt</a></dt>
<dt><a name=3D"TOC-12.16" class=3D"tocanchor">12.16</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-0005EA45">Plain Mode</a></dt>
<dt><a name=3D"TOC-12.17" class=3D"tocanchor">12.17</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03C0E452">Interactive Profile File</a></dt=
>
<dt><a name=3D"TOC-12.18" class=3D"tocanchor">12.18</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-01E869EB">History Persistence</a></dt>
<dt><a name=3D"TOC-12.19" class=3D"tocanchor">12.19</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-004A414D">Parenthesis Matching</a></dt>
<dt><a name=3D"TOC-12.20" class=3D"tocanchor">12.20</a> <a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-02B1BA73">Listener Configuration Variables=
</a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> =
<tt>[+]</tt></a></dt>
<dd><dl id=3D"g0244" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-12.20.1" class=3D"tocanchor">12.20.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-007B676F">Special variable <tt>*listen=
er-hist-len*</tt></a></dt>
<dt><a name=3D"TOC-12.20.2" class=3D"tocanchor">12.20.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02C5CACF">Special variable <tt>*listen=
er-multi-line-p*</tt></a></dt>
<dt><a name=3D"TOC-12.20.3" class=3D"tocanchor">12.20.3</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-02E4924F">Special variable <tt>*listen=
er-sel-inclusive-p*</tt></a></dt>
<dt><a name=3D"TOC-12.20.4" class=3D"tocanchor">12.20.4</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-01E7ACFE">Special variable <tt>*listen=
er-pprint-p*</tt></a></dt>
<dt><a name=3D"TOC-12.20.5" class=3D"tocanchor">12.20.5</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-002B819C">Special variable <tt>*listen=
er-greedy-eval-p*</tt></a></dt>
<dt><a name=3D"TOC-12.20.6" class=3D"tocanchor">12.20.6</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0003D10B">Special variable <tt>*doc-ur=
l*</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-12.21" class=3D"tocanchor">12.21</a> <a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-02247FD0">Listener-Related Functions<=
/a><a href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <=
tt>[+]</tt></a></dt>
<dd><dl id=3D"g0245" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-12.21.1" class=3D"tocanchor">12.21.1</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-0097F54C">Function <tt>doc</tt></a></d=
t>
<dt><a name=3D"TOC-12.21.2" class=3D"tocanchor">12.21.2</a> <a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03C6D422">Function <tt>quip</tt></a></=
dt>
</dl>
</dd></dl>
</dd><dt><a name=3D"TOC-13" class=3D"tocanchor">13</a> <a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#N-01B21F66">SETUID/SETGID OPERATION</a></dt>
<dt><a name=3D"TOC-14" class=3D"tocanchor">14</a> <a href=3D"http://nongnu.=
org/txr/txr-manpage.html#N-037ACEFC">STAND-ALONE APPLICATION SUPPORT</a><a =
href=3D"http://nongnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]=
</tt></a></dt>
<dd><dl id=3D"g0246" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-14.1" class=3D"tocanchor">14.1</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-0389D15E">The Internal Argument String</a></=
dt>
<dt><a name=3D"TOC-14.2" class=3D"tocanchor">14.2</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-00891FF9">Deployment Directory Structure</a>=
</dt>
<dt><a name=3D"TOC-14.3" class=3D"tocanchor">14.3</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-02850687">Function <tt>save-exe</tt></a></dt=
>
</dl>
</dd><dt><a name=3D"TOC-15" class=3D"tocanchor">15</a> <a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#N-0179BAC0">DEBUGGER</a></dt>
<dt><a name=3D"TOC-16" class=3D"tocanchor">16</a> <a href=3D"http://nongnu.=
org/txr/txr-manpage.html#N-037D9E3E">COMPATIBILITY</a><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0247" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-16.1" class=3D"tocanchor">16.1</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-01CE7F15">Overview</a></dt>
<dt><a name=3D"TOC-16.2" class=3D"tocanchor">16.2</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-036F1A29">The <tt>-C</tt> compatibility opti=
on</a></dt>
<dt><a name=3D"TOC-16.3" class=3D"tocanchor">16.3</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03F5D03D">Environment variable <tt>TXR_COMPA=
T</tt></a></dt>
<dt><a name=3D"TOC-16.4" class=3D"tocanchor">16.4</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-0194D768">Compatibility Version Values</a></=
dt>
<dt><a name=3D"TOC-16.5" class=3D"tocanchor">16.5</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-032F57D4">Variables <tt>txr-version</tt> and=
 <tt>lib-version</tt></a></dt>
</dl>
</dd><dt><a name=3D"TOC-17" class=3D"tocanchor">17</a> <a href=3D"http://no=
ngnu.org/txr/txr-manpage.html#N-014A29D1">APPENDIX</a><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#/" class=3D"toggle"> <tt>[+]</tt></a></dt>
<dd><dl id=3D"g0248" class=3D"tocsec" style=3D"display: none">
<dt><a name=3D"TOC-17.1" class=3D"tocanchor">17.1</a> <a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-03D86EEC">A. NOTES ON EXOTIC REGULAR EXPRESS=
IONS</a></dt>
</dl>
</dd></dl>
<hr>
</div>

<a name=3D"N-00052615">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-1">1</a> NAME</h2=
>




<p>


<b>TXR</b> - Programming Language (Version 256)
</p><p>
<a name=3D"N-02345740">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-2">2</a> SYNO=
PSIS</h2>




<p>


<tt>




txr [ </tt><tt><i>options</i></tt><tt> ] [ </tt><tt><i>script-file</i></tt>=
<tt> [ </tt><tt><i>data-files</i></tt><tt> ... ]]=20

</tt>

</p><p>
<a name=3D"N-02D7A45F">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-3">3</a> DESC=
RIPTION</h2>




<p>


<b>TXR</b> is a general-purpose, multi-paradigm programming language.
It comprises two languages integrated into a single tool: a text
scanning and extraction language referred to as the <b>TXR</b> Pattern Lang=
uage
(sometimes just "TXR"), and a general-purpose dialect of Lisp called <b>TXR=
 Lisp</b>.
</p><p>
<b>TXR</b> can be used for everything from "one liner" data transformation =
tasks at
the command line, to data scanning and extracting scripts, to full
application development in a wide-range of areas.
</p><p>
A script written in the <b>TXR</b> Pattern Language, also referred to in th=
is
document as a
<i>query</i>,

specifies a pattern which matches one or more sources of inputs, such
as text files. Patterns can consist of large chunks of multi-line free-form
text, which is matched literally against material in the input sources. Fre=
e
variables occurring in the pattern (denoted by the
<tt>@</tt>
symbol) are bound to the pieces of text occurring in the
corresponding positions.  Patterns can be arbitrarily complex,
and can be broken down into named pattern functions, which may be mutually
recursive.
</p><p>
In addition to embedded variables which implicitly match text, the
<b>TXR</b> pattern language supports a number of directives, for matching t=
ext using
regular expressions, for continuing a match in another file, for searching
through a file for the place where an entire sub-query matches, for collect=
ing
lists, and for combining sub-queries using logical conjunction, disjunction=
 and
negation, and numerous others.
</p><p>
Patterns can contain actions which transform data and generate output.
These actions can be embedded anywhere within the pattern matching logic.
A common structure for small <b>TXR</b> scripts is to perform a complete ma=
tching
session in the at the top of the script, and then deal with processing
and reporting at the bottom.
</p><p>
The <b>TXR Lisp</b> language can be used from within <b>TXR</b> scripts as =
an
embedded language, or completely stand-alone.  It supports functional,
imperative and object-oriented programming, and provides numerous data type=
s
such as symbols, strings, vectors, hash tables with weak reference support,
lazy lists, and arbitrary-precision ("bignum") integers.  It has expressive
foreign function interface (FFI) for calling into libraries and other softw=
are
components that support C-language-style calls. </p><p>
<b>TXR Lisp</b> source files as well as individual functions can be optiona=
lly compiled
for execution on a virtual machine that is built into <b>TXR</b>.  Compiled=
 files
execute and load faster, and resist reverse-engineering.  Stand-alone
application delivery is possible.
</p><p>
<b>TXR</b> is free software offered under the two-clause BSD license which
places almost no restrictions on redistribution, and allows every conceivab=
le
use, of the whole software or any constituent part, royalty-free, free of
charge, and free of any restrictions.
</p><p>
<a name=3D"N-02F43351">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-4">4</a> ARGU=
MENTS AND OPTIONS</h2>




<p>


</p><p>
If <b>TXR</b> is given no arguments, it will enter into an interactive
mode. See the INTERACTIVE LISTENER section for a
description of this mode.  When <b>TXR</b> enters interactive mode this
way, it prints a one-line banner is printed announcing the program
name and version, and one line of help text instructing the user
how to exit.
</p><p>
Options which don't take an argument may be combined together.
The
<tt>-v</tt>
and
<tt>-q</tt>
options are mutually exclusive. Of these two, the one which
occurs in the rightmost position in the argument list dominates.
The
<tt>-c</tt>
and
<tt>-f</tt>
options are also mutually exclusive; if both are specified,
it is a fatal error.
</p><p>



</p><dl class=3D"items">
<dt><tt>-D<tt><i>var=3Dvalue</i></tt><tt> </tt></tt></dt><dd>



Bind the variable
<tt><i>var</i></tt>
to the value
<tt><i>value</i></tt>
prior to processing the query. The name is in scope over the entire
query, so that all occurrence of the variable are substituted and
match the equivalent text.  If the value contains commas, these
are interpreted as separators, which give rise to a list value.
For instance
<tt>-Da,b,c</tt>
creates a list of the strings
<tt>"a"</tt>,
<tt>"b"</tt>

and
<tt>"c"</tt>.
(See Collect Directive bellow). List variables provide a multiple
match. That is to say, if a list variable occurs in a query, a successful
match occurs if any of its values matches the text. If more than one
value matches the text, the first one is taken.
<p>



</p></dd><dt><tt>-D<tt><i>var</i></tt><tt> </tt></tt></dt><dd>



Binds the variable
<tt><i>var</i></tt>
to an empty string value prior to processing the query.
<p>
</p></dd><dt><tt>-q</tt></dt><dd>

Quiet operation during matching. Certain error messages are not reported on=
 the
standard error device (but the if the situations occur, they still fail the
query). This option does not suppress error generation during the parsing
of the query, only during its execution.
<p>
</p></dd><dt><tt>-i</tt></dt><dd>

If this option is present, then <b>TXR</b> will enter into an interactive
interpretation mode after processing all options, and the input query
if one is present. See the INTERACTIVE LISTENER section for a
description of this mode.
<p>
</p></dd><dt><tt>-d</tt></dt><dd>

</dd><dt><tt>--debugger</tt></dt><dd>

Invoke the interactive <b>TXR</b> debugger. See the DEBUGGER section.
Implies
<tt>--backtrace</tt>.
<p>
</p></dd><dt><tt>--backtrace</tt></dt><dd>

Turns on the establishment of backtrace frames for function calls so that a
backtrace can be produced when an unhandled exception occurs, and in other
situations. Backtraces are helpful in identifying the causes of errors, but
require extra stack space and slow down execution.
<p>
</p></dd><dt><tt>-n</tt></dt><dd>

</dd><dt><tt>--noninteractive</tt></dt><dd>

This option affects behavior related to <b>TXR</b>'s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream.  It also has a another, unrelated effect, on the
behavior of the interactive listener; see below.
<p>
Normally, if this stream is connected to a terminal device, it is
automatically marked as having the real-time property when <b>TXR</b> start=
s up (see
the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005268C8">stream-se=
t-prop</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0121FDEB">real-time=
-stream-p</a></tt>).
The
<tt>-n</tt>
option suppresses this behavior; the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream remains ordinary.
</p><p>
The <b>TXR</b> pattern language reads standard input via
a lazy list, created by applying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
function to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream. If that stream is marked real-time, then the lazy list which is
returned by that function has behaviors that are better suited for scanning
interactive input. A more detailed explanation is given under the descripti=
on
of this function.
</p><p>
If the
<tt>-n</tt>
option is effect and <b>TXR</b> enters into the interactive listener,
the listener operates in
<i>plain mode</i>.

The listener reads buffered lines
from the operating system without any character-based editing features
or history navigation. In plain mode, no prompts appear and no
terminal control escape sequences are generated. The only output is
the results of evaluation, related diagnostic messages, and any output
generated by the evaluated expressions themselves.
</p><p>
</p></dd><dt><tt>-v</tt></dt><dd>

Verbose operation. Detailed logging is enabled.
<p>
</p></dd><dt><tt>-b</tt></dt><dd>

This option binds a Lisp global lexical variable (as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defparml<=
/a></tt>
function) to an object described by Lisp syntax. It requires an argument
of the form
<tt><i>sym=3Dvalue</i></tt>
where
<tt>sym</tt>
must be, syntactically, a token denoting a bindable symbol, and
<tt><i>value</i></tt>
is arbitrary <b>TXR Lisp</b> syntax. The
<tt><i>sym</i></tt>
syntax is converted to the symbol it denotes, which is bound as a global
lexical variable, if it is not already a variable.
The
<tt><i>value</i></tt>
syntax is parsed to the Lisp object it denotes. This object is not subject
to evaluation; the object itself is stored into the variable binding denote=
d
by
<tt><i>sym</i></tt>.
Note that if
<tt><i>sym</i></tt>
already exists as a global variable, then it is simply overwritten. If
<tt><i>sym</i></tt>
is marked special, then it stays special.
<p>
</p></dd><dt><tt>-B</tt></dt><dd>

If the query is successful, print the variable bindings as a sequence
of assignments in shell syntax that can be
<i>eval</i>-ed

by a POSIX shell.
II the query fails, print the word "false". Evaluation of this word
by the shell has the effect of producing an unsuccessful termination
status from the shell's
<i>eval</i>

command.
<p>
</p></dd><dt><tt>-l</tt></dt><dd>

</dd><dt><tt>--lisp-bindings</tt></dt><dd>

This option implies
<tt>-B</tt>.
Print the variable bindings in Lisp syntax instead of
shell syntax.
<p>



</p></dd><dt><tt>-a <tt><i>num</i></tt><tt> </tt></tt></dt><dd>



This option implies
<tt>-B</tt>.
The decimal integer argument
<tt><i>num</i></tt>
specifies the maximum
number of array dimensions to use for list-valued variable bindings.
The default is 1. Additional dimensions are expressed using numeric suffixe=
s
in the generated variable names.
For instance, consider the three-dimensional list arising out of a triply
nested collect:
<tt>

((("a" "b") ("c" "d")) (("e" "f") ("g" "h"))).
</tt>

Suppose this is bound to a variable V.  With
<tt>-a 1</tt>,
this will be
reported as:
<p>
<tt>
</tt></p><pre><tt>  V_0_0[0]=3D"a"
  V_0_1[0]=3D"b"
  V_1_0[0]=3D"c"
  V_1_1[0]=3D"d"
  V_0_0[1]=3D"e"
  V_0_1[1]=3D"f"
  V_1_0[1]=3D"g"
  V_1_1[1]=3D"h"
</tt></pre><tt>

</tt>

<p>
With
<tt>-a 2</tt>,
it comes out as:
</p><p>
<tt>
</tt></p><pre><tt>  V_0[0][0]=3D"a"
  V_1[0][0]=3D"b"
  V_0[0][1]=3D"c"
  V_1[0][1]=3D"d"
  V_0[1][0]=3D"e"
  V_1[1][0]=3D"f"
  V_0[1][1]=3D"g"
  V_1[1][1]=3D"h"
</tt></pre><tt>

</tt>

<p>
The leftmost bracketed index is the most major index. That is to say,
the dimension order is:
<tt>NAME_m_m+1_..._n[1][2]...[m-1]</tt>.
</p><p>



</p></dd><dt><tt>-c <tt><i>query</i></tt><tt> </tt></tt></dt><dd>



Specifies the query in the form of a command line argument. If this option =
is
used, the
<tt><i>script-file</i></tt>
argument is omitted. The first non-option argument,
if there is one, now specifies the first input source rather than a query.
Unlike queries read from a file, (non-empty) queries specified as arguments
using -c do not have to properly end in a newline. Internally,
<b>TXR</b> adds the missing newline before parsing the query. Thus
<tt>-c</tt>
<tt>"@a"</tt>

is a valid query which matches a line.
<p>
Example:
</p><p>
Shell script which uses <b>TXR</b> to read two lines
<tt>"1"</tt>

and
<tt>"2"</tt>

from standard input,
binding them to variables
<tt>a</tt>
and
<tt>b</tt>.
Standard
input is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
and the data
comes from shell "here document" redirection:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;#!/bin/sh
</tt><p><tt>
<br>&nbsp;txr&nbsp;-B&nbsp;-c&nbsp;"@a
<br>&nbsp;@b"&nbsp;-&nbsp;&lt;&lt;!
<br>&nbsp;1
<br>&nbsp;2
<br>&nbsp;!
</tt>

</p><p>
</p></dd><dt>output:</dt><dd>
<tt>

&nbsp;a=3D1
<br>&nbsp;b=3D2
</tt>

</dd></dl>
<p>

</p><p>
The
<tt>@;</tt>
comment syntax can be used for better formatting:
</p><p>
<tt>
</tt></p><pre><tt>  txr -B -c "@;
  @a
  @b"
</tt></pre><tt>

</tt>

</dl>
<p>



</p></dd><dt><tt>-f <tt><i>script-file</i></tt><tt> </tt></tt></dt><dd>



Specifies the file from which the query is to be read, instead of the
<tt><i>script-file</i></tt>
argument. This is useful in
<tt>#!</tt>
("hash bang") scripts. (See Hash Bang Support below).
<p>



</p></dd><dt><tt>-e <tt><i>expression</i></tt><tt> </tt></tt></dt><dd>



Evaluates a <b>TXR Lisp</b> expression for its side effects, without printi=
ng
its value. Can be specified more than once. The
<tt><i>script-file</i></tt>
argument becomes optional if
<tt>-e</tt>
is used at least once. If the evaluation of every
<tt><i>expression</i></tt>
evaluated this way terminates normally, and there is no
<tt><i>script-file</i></tt>
argument, then <b>TXR</b> terminates with a successful status.
<p>



</p></dd><dt><tt>-p <tt><i>expression</i></tt><tt> </tt></tt></dt><dd>



Just like
<tt>-e</tt>
but prints the value of
<tt><i>expression</i></tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>
function.
<p>



</p></dd><dt><tt>-P <tt><i>expression</i></tt><tt> </tt></tt></dt><dd>



Like
<tt>-p</tt>
but prints using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>
function.
<p>



</p></dd><dt><tt>-t <tt><i>expression</i></tt><tt> </tt></tt></dt><dd>



Like
<tt>-p</tt>
but prints using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a=
></tt>
function.
<p>



</p></dd><dt><tt>-C <tt><i>number</i></tt><tt> </tt></tt></dt><dd>






</dd><dt><tt>--compat=3D<tt><i>number</i></tt><tt> </tt></tt></dt><dd>



Requests <b>TXR</b> to behave in a manner that is compatible with the speci=
fied
version of <b>TXR</b>. This makes a difference in situations when a release=
 of
<b>TXR</b> breaks backward compatibility. If some version N+1 deliberately =
introduces
a change which is backward incompatible, then
<tt>-C N</tt>
can be used to request the old behavior.
<p>
The requested value of N can be too low, in which case <b>TXR</b> will
complain and exit with an unsuccessful termination status. This indicates
that <b>TXR</b> refuses to be compatible with such an old version. Users re=
quiring
the behavior of that version will have to install an older version of <b>TX=
R</b> which
supports that behavior, or even that exact version.
</p><p>
If the option is specified more than once, the behavior is not specified.
</p><p>
Compatibility can also be requested via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F5D03D">TXR_COMPA=
T</a></tt>
environment variable instead of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
option.
</p><p>
For more information, see the COMPATIBILITY section.
</p><p>



</p></dd><dt><tt>--gc-delta=3D<tt><i>number</i></tt><tt> </tt></tt></dt><dd=
>



The
<tt><i>number</i></tt>
argument to this option must be a decimal integer. It represents
a megabyte value, the "GC delta": one megabyte is 1048576 bytes.  The "GC
delta" controls an aspect of the garbage collector behavior.
See the
<tt>gc-set-delta</tt>
function for a description.
<p>



</p></dd><dt><tt>--debug-autoload
</tt></dt><dd>



This option turns on debugging, like
<tt>--debugger</tt>
but also requests stepping into the auto-load processing of
<b>TXR Lisp</b> library code.  Normally, debugging through the evaluations
triggered by auto-loading is suppressed.
Implies
<tt>--backtrace</tt>.
<p>



</p></dd><dt><tt>--debug-expansion
</tt></dt><dd>



This option turns on debugging, like
<tt>--debugger</tt>
but also requests stepping into the parse-time macro-expansion
of <b>TXR Lisp</b> code embedded in <b>TXR</b> queries. Normally, this is s=
uppressed.
Implies
<tt>--backtrace</tt>.
<p>
</p></dd><dt><tt>--help</tt></dt><dd>

Prints usage summary on standard output, and terminates successfully.
<p>
</p></dd><dt><tt>--license</tt></dt><dd>

Prints the software license. This depends on the software being
installed such that the LICENSE file is in the data directory.
Use of <b>TXR</b> implies agreement with the liability disclaimer in the li=
cense.
<p>
</p></dd><dt><tt>--version</tt></dt><dd>

Prints program version standard output, and terminates successfully.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE=
42">--args</a></tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
option provides a way to encode multiple arguments as a single
argument, which is useful on some systems which have limitations in
their implementation of the "hash bang" mechanism. For details about
its special syntax, See Hash Bang Support below. It is also useful in
stand-alone application deployment. See the section
STAND-ALONE APPLICATION SUPPORT, in which example uses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
are shown.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE=
42">--eargs</a></tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
option (extended
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>)
is like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
but must be followed by an argument. The argument is removed from
the argument list and substituted in place of occurrences of
<tt>{}</tt>
among the arguments expanded from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
syntax.
<p>
</p></dd><dt><tt>--lisp</tt></dt><dd>

</dd><dt><tt>--compiled</tt></dt><dd>

These options influence the treatment of query files which do not have
a suffix indicating their type. The
<tt>--lisp</tt>
option causes an unsuffixed file to be treated as Lisp source;
<tt>--compiled</tt>
causes it to be treated as a compile file.
<p>
Moreover, if
<tt>--lisp</tt>
is specified, and an unsuffixed file does not exist, then <b>TXR</b>will ad=
d the
<tt>".tl"</tt>

suffix and try the file again; and
<tt>--compiled</tt>
will similarly add the
<tt>".tlo"</tt>

suffix and try opening the file again.
In the same situation, if neither
<tt>--lisp</tt>
nor
<tt>--compiled</tt>
has been specified, <b>TXR</b> will first try adding the
<tt>".txr"</tt>

suffix. If that fails,
then the
<tt>".tlo"</tt>

suffix will be tried and finally
<tt>".tl"</tt>.
Note that
<tt>--lisp</tt>
and
<tt>--compiled</tt>
influence how the argument of the
<tt>-f</tt>
option is treated, but only they precedes that option.
</p><p>
</p></dd><dt><tt>--reexec</tt></dt><dd>

On platforms which support the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6C913">exec</a><=
/tt>
family of functions, this option causes <b>TXR</b> to re-execute itself.
The re-executed image receives the remaining arguments which follow
the
<tt>--reexec</tt>
argument. Note: this option is useful for supporting setuid operation in
"hash hang" scripts. On some platforms, the interpreter designated by
a "hash bang" script runs without altered privilege, even if that
interpreter is installed setuid. If the interpreter is executed directly,
then setuid applies to it, but not if it is executed via "hash bang".
If the
<tt>--reexec</tt>
option is used in the interpreter command line of such a script, the
interpreter will re-execute itself, thereby gaining the setuid privilege.
The re-executed image will then obtain the script name from the arguments
which are passed to it and determine whether that script will run setuid.
See the section SETUID/SETGID OPERATION.
<p>
</p></dd><dt><tt>--gc-debug</tt></dt><dd>

This option enables a behavior which stresses the garbage collector with
frequent garbage collection requests. The purpose is to make it more likely
to reproduce certain kinds of bugs. Use of this option severely degrades
the performance of <b>TXR</b>.
<p>
</p></dd><dt><tt>--vg-debug</tt></dt><dd>

If <b>TXR</b> is enabled with Valgrind support, then this option is availab=
le.
It enables code which uses the Valgrind API to integrate with the Valgrind
debugger, for more accurate tracking of garbage collected objects. For
example, objects which have been reclaimed by the garbage collector
are marked as inaccessible, and marked as uninitialized when they are
allocated again.
<p>
</p></dd><dt><tt>--dv-regex</tt></dt><dd>

If this option is used, then regular expressions are all treated using the
derivative-based back-end.  The NFA-based regex implementation is disabled.
Normally, only regular expressions which require the intersection and
complement operators are handled using the derivative back-end.
This option makes it possible to test that back-end on test cases that it
wouldn't normally receive.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C4=
08">--</a></tt></dt><dd>

Signifies the end of the option list.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">=
-</a></tt></dt><dd>

This argument is not interpreted as an option, but treated as a filename
argument. After the first such argument, no more options are recognized. Ev=
en
if another argument looks like an option, it is treated as a name.
This special argument
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
means "read from standard input" instead of a file.
The
<tt><i>script-file</i></tt>,
or any of the data files, may be specified using this option.
If two or more files are specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>,
the behavior is system-dependent.
It may be possible to indicate EOF from the interactive terminal, and
then specify more input which is interpreted as the second file, and so for=
th.
<p>
</p></dd></dl>
<p>

After the options, the remaining arguments are files. The first file argume=
nt
specifies the script file, and is mandatory if the
<tt>-f</tt>
option has not been specified, and <b>TXR</b> isn't operating in interactiv=
e
mode or evaluating expressions from the command line via
<tt>-e</tt>
or one of the related options.  A file argument consisting of a single
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
means to read the standard input instead of opening a file.
</p><p>
Specifying standard input as a source with an explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
argument is unnecessary. If no data source arguments are present, then
<b>TXR</b> scans standard input by default. This was not true in versions o=
f <b>TXR</b>prior to 171; see the COMPATIBILITY section.
</p><p>
</p><p>

<b>TXR</b> begins by reading the script. In the case of the <b>TXR</b> patt=
ern language,
the entire query is scanned, internalized and then begins executing, if it =
is
free of syntax errors. (<b>TXR Lisp</b> is processed differently, form by f=
orm).  On the
other hand, the pattern language reads data files in a lazy manner. A file
isn't opened until the query demands material from that file, and then the
contents are read on demand, not all at once.
</p><p>
The suffix of the
<tt><i>script-file</i></tt>
is significant. If the name has no suffix, or if it has a
<tt>".txr"</tt>

suffix, then it is assumed to be in the <b>TXR</b> pattern language. If it =
has
the
<tt>".tl"</tt>

suffix, then it is assumed to be <b>TXR Lisp</b>.  The
<tt>--lisp</tt>
option changes the treatment of unsuffixed script file names, causing them
to be interpreted as <b>TXR Lisp</b>.
</p><p>
If an unsuffixed script file name is specified, and cannot be opened, then
<b>TXR</b> will add the
<tt>".txr"</tt>

suffix and try again. If that fails, it will be tried with the
<tt>".tl"</tt>

suffix, and treated as <b>TXR Lisp</b>.
If the
<tt>--lisp</tt>
option has been specified, then <b>TXR</b> tries only the
<tt>".tl"</tt>

suffix.
</p><p>
A <b>TXR Lisp</b> file is processed as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
macro: forms from the file are read and evaluated. If the forms do not term=
inate
the <b>TXR</b> process or throw an exception, and there are no syntax error=
s, then
<b>TXR</b> terminates successfully after evaluating the last form. If synta=
x errors
are encountered in a form, then <b>TXR</b> terminates unsuccessfully.
<b>TXR Lisp</b> is documented in the section TXR LISP.
</p><p>
If a query file is specified, but no file arguments,
it is up to the query to open a file, pipe or standard input via the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive
prior to attempting to make a match. If a query attempts to match text,
but has run out of files to process, the match fails.
</p><p>
<a name=3D"N-0014ADB0">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-5">5</a> STAT=
US AND ERROR REPORTING</h2>




<p>


<b>TXR</b> sends errors and verbose logs to the standard error device. The =
following
paragraphs apply when <b>TXR</b> is run without enabling verbose mode with
<tt>-v</tt>,
or the printing of variable
bindings with
<tt>-B</tt>
or
<tt>-a</tt>.
</p><p>
If the command line arguments are incorrect, <b>TXR</b> issues an error dia=
gnostic
and terminates with a failed status.
</p><p>
If the
<tt><i>script-file</i></tt>
specifies a query, and the query has a malformed syntax, <b>TXR</b> likewis=
e
issues error diagnostics and terminates with a failed status.
</p><p>
If the query fails due to a mismatch, <b>TXR</b> terminates
with a failed status. No diagnostics are issued.
</p><p>
If the query is well-formed, and matches, then <b>TXR</b> issues
no diagnostics, and terminates with a successful status.
</p><p>
In verbose mode (option
<tt>-v</tt>),
<b>TXR</b> issues diagnostics on the standard error device even in situatio=
ns which
are not erroneous.
</p><p>
In bindings-printing mode (options
<tt>-B</tt>
or
<tt>-a)</tt>,
<b>TXR</b> prints the word
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a>=
</tt>
if the query fails, and exits with a failed
termination status. If the query succeeds, the variable bindings, if any,
are output on standard output.
</p><p>
If the
<tt><i>script-file</i></tt>
is <b>TXR Lisp</b>, then it is processed form by form. Each top-level Lisp =
form
is evaluated after it is read. If any form is syntactically malformed,
<b>TXR</b> issues diagnostics and terminates unsuccessfully.  This is somew=
hat
different from how the pattern language is treated: a script in the pattern
language is parsed in its entirety before being executed.
</p><p>
<a name=3D"N-00C0A1F1">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6">6</a> BASI=
C TXR SYNTAX</h2>




<p>


<a name=3D"N-0243C6DA">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.1">6.1</a> =
Comments</h3>



<p>


A query may contain comments which are delimited by the sequence
<tt>@;</tt>
and extend to the end of the line. Whitespace can occur between the
<tt>@</tt>
and
<tt>;</tt>.
A comment which begins on a line swallows that entire line, as well as the
newline which terminates it. In essence, the entire comment line disappears=
.
If the comment follows some material in a line, then it does not consume
the newline. Thus, the following two queries are equivalent:
</p><dl class=3D"items">
<dt>1.</dt><dd>
<tt>

&nbsp;@a@; comment: match whole line against variable @a
<br>&nbsp;@;&nbsp;this&nbsp;comment&nbsp;disappears&nbsp;entirely
<br>&nbsp;@b
</tt>

<p>
</p></dd><dt>2.</dt><dd>
<tt>

&nbsp;@a
<br>&nbsp;@b
</tt>

<p>
</p></dd></dl>
<p>

</p><p>
The comment after the
<tt>@a</tt>
does not consume the newline, but the
comment which follows does. Without this intuitive behavior,
line comment would give rise to empty lines that must match empty
lines in the data, leading to spurious mismatches.
</p><p>
Instead of the
<tt>;</tt>
character, the
<tt>#</tt>
character can be used. This is an obsolescent feature.
</p><p>
<a name=3D"N-01ED8E44">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.2">6.2</a> =
Hash Bang Support</h3>



<p>


<b>TXR</b> has several features which support use of the "hash bang" conven=
tion
for creating apparently stand-alone executable programs.
</p><p>
<a name=3D"N-0021E02D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.2.1">6.2.1<=
/a> Basic Hash Bang</h4>


Special processing is applied to <b>TXR</b> query or <b>TXR Lisp</b> script=
 files that are
specified on the command line via the
<tt>-f</tt>
option or as the first non-option argument. If the first line of such
a file begins with the characters
<tt>#!</tt>,
that entire line is consumed and processed specially.
<p>
This removal
for <b>TXR</b> queries to be turned into standalone executable programs in =
the POSIX
environment using the "hash bang" mechanism.  Unlike most interpreters,
<b>TXR</b> applies special processing to the
<tt>#!</tt>
line, which is described below, in the section
<b>Argument Generation with the Null Hack</b>.

</p><p>
Shell session example: create a simple executable program called
<tt>"twoline.txr"</tt>

and
run it. This assumes <b>TXR</b> is installed in
<tt>/usr/bin</tt>.
</p><p>
<tt>
</tt></p><pre><tt>  $ cat &gt; hello.txr
  #!/usr/bin/txr
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> a "H=
ey")
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
>)
  Hello, world!
  @(end)
  $ chmod a+x hello.txr
  $ ./hello.txr
  Hello, world!
</tt></pre><tt>

</tt>

<p>
When this plain hash bang line is used, <b>TXR</b> receives the name of the=
 script
as an argument.  Therefore, it is not possible to pass additional options
to <b>TXR</b>.  For instance, if the above script is invoked like this
</p><p>
<tt>
</tt></p><pre><tt>  $ ./hello.txr -B
</tt></pre><tt>

</tt>

<p>
the -B option isn't processed by <b>TXR</b>, but treated as an additional a=
rgument,
just as if
<tt>




txr </tt><tt><i>scriptname</i></tt><tt> -B=20

</tt>

had been executed directly.
</p><p>
This behavior is useful if the script author wants not to expose the
<b>TXR</b> options to the user of the script.
</p><p>
However, the hash bang line can use the
<tt>-f</tt>
option:
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/txr -f
</tt></pre><tt>

</tt>

<p>
Now, the name of the script is passed as an argument to the
<tt>-f</tt>
option, and <b>TXR</b> will look for more options after that, so that the r=
esulting
program appears to accept <b>TXR</b> options. Now we can run
</p><p>
<tt>
</tt></p><pre><tt>  $ ./hello.txr -B
  Hello, world!
  a=3D"Hey"
</tt></pre><tt>

</tt>

<p>
The
<tt>-B</tt>
option is honored.
</p><p>

<a name=3D"N-03FCDE42">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.2.2">6.2.2<=
/a> Argument Generation with <tt>--args</tt> and <tt>--eargs</tt></h4>



On some operating systems, it is not possible to pass more than one
argument through the hash bang mechanism. That is to say, this will
not work.
<p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/txr -B -f
</tt></pre><tt>

</tt>

<p>
To support systems like this, <b>TXR</b> supports the special argument
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>,
as well as as an extended version,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>.
With
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>,
it is possible to encode multiple arguments
into one argument.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
option must be followed by a separator
character, chosen by the programmer. The characters after that are
split into multiple arguments on the separator character. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
option is then removed from the argument list and replaced with these
arguments, which are processed in its place.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/txr --args:-B:-f
</tt></pre><tt>

</tt>

<p>
The above has the same behavior as
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/txr -B -f
</tt></pre><tt>

</tt>

<p>
on a system which supports multiple arguments in hash bang.
The separator character is the colon, and so the remainder
of that argument,
<tt>-B:-f</tt>,
is split into the two arguments
<tt>-B -f</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
mechanism allows an additional flexibility. An
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
argument must be followed by one more argument.
</p><p>
After
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
performs the argument splitting in the same manner as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>,
any of the arguments which it produces which are the
two-character sequence
<tt>{}</tt>
are replaced with that following argument. Whether
or not the replacement occurs, that following argument
is then removed.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/txr --eargs:-B:{}:--foo:42
</tt></pre><tt>

</tt>

<p>
This has an effect which cannot be replicated in any known
implementation of the hash bang mechanism. Suppose
that this hash bang line is placed in a script called
<tt>script.txr</tt>.
When this script is invoked with arguments, as in:
</p><p>
<tt>
</tt></p><pre><tt>  script.txr a b c
</tt></pre><tt>

</tt>

<p>
then <b>TXR</b> is invoked similarly to:
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr --eargs:-B:{}:--foo:42 script.txr a b c
</tt></pre><tt>

</tt>

<p>
Then, when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
processing takes place, firstly the argument sequence
</p><p>
<tt>
</tt></p><pre><tt>  -B {} --foo 42
</tt></pre><tt>

</tt>

<p>
is produced by splitting into four fields using the
<tt>:</tt>
character as the separator.  Then, within these four fields, all occurrence=
s of
<tt>{}</tt>
are replaced with the following argument
<tt>script.txr</tt>,
resulting in:
</p><p>
<tt>
</tt></p><pre><tt>  -B script.txr --foo 42
</tt></pre><tt>

</tt>

<p>
Furthermore, that
<tt>script.txr</tt>
argument is removed from the remaining argument list.
</p><p>
The four arguments are then substituted in place of the original
<tt>--eargs:-B:{}:--foo:42</tt>
syntax.
</p><p>
The resulting <b>TXR</b> invocation is, therefore:
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr -B script.txr --foo 42 a b c
</tt></pre><tt>

</tt>

<p>
Thus,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
allows some arguments to be encoded into the interpreter script, such that
script name is inserted anywhere among them, possibly multiple times. Argum=
ents
for the interpreter can be encoded, as well as arguments to be processed by=
 the
script.
</p><p>

<a name=3D"N-01DF6FA2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.2.3">6.2.3<=
/a> Argument Generation with the Null Hack</h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
mechanisms do not solve the following problem: the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
utility is often exploited for its
<tt>PATH</tt>
searching capability, and used to express hash bang scripts in the followin=
g
way:
<p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/env txr
</tt></pre><tt>

</tt>

<p>
Here, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
utility searches for the
<tt>txr</tt>
program in the directories indicated by the
<tt>PATH</tt>
variable, which liberates the script from having encode the exact location
where the program is installed.  However, if the operating system allows on=
ly
one argument in the hash bang mechanism, then no arguments can be passed
to the program.
</p><p>
To mitigate this problem,
<b>TXR</b>supports a special feature in its hash bang support. If the hash =
bang
<tt>#!</tt>
line contains a null byte, then text after the null byte, to the end of the
line, is split into fields using the space character as a separator, and th=
ese
fields are inserted into the command line. This manipulation happens during
command line processing, prior to the execution of the file, which happens
after command-line processing. If this processing is applied to a file
that is specified using the
<tt>-f</tt>
option, then the arguments which arise from the special processing
are inserted after that option and its argument.  If this processing is
applied to the file which is the first non-option argument, then the
options are inserted before that argument. However, care is taken not
to process that argument a second time.
In either situation, processing of the command line options continues, and =
the
arguments which are processed next are the ones which were just inserted.  =
This
is true even if the options had been inserted as a result of processing the
first non-option argument, which would ordinarily signal the termination of
option processing.
</p><p>
In the following examples, it is assumed that the script is
named, and invoked, as
<tt>/home/jenny/foo.txr</tt>,
and is given arguments
<tt>--bar abc</tt>,
and that
<tt>txr</tt>
resolves to
<tt>/usr/bin/txr</tt>.
The
<tt>&lt;NUL&gt;</tt>
code indicates a literal ASCII NUL character, or zero bytes.
</p><p>
Basic example:
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/env txr&lt;NUL&gt;-a 3
</tt></pre><tt>

</tt>

<p>
Here,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
searches for
<tt>txr</tt>,
finding it in
<tt>/usr/bin</tt>.
Thus, including the executable name, <b>TXR</b> receives this full argument=
 list:
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr /home/jenny/foo.txr --bar abc
</tt></pre><tt>

</tt>

<p>
The first non-option argument is the name of the script. <b>TXR</b> opens
the script, and notices that it begins with a hash bang line.
It consumes the hash bang line and finds the null byte inside it,
retrieving the character string after it, which is
<tt>"-a 3"</tt>.
This is split into the two arguments
<tt>-a</tt>
and
<tt>3</tt>,
which are then inserted into the command line ahead of the
the script name. The effective command line then becomes:
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr -a 3 /home/jenny/foo.txr --bar abc
</tt></pre><tt>

</tt>

<p>
Command line option processing continues, beginning with the
<tt>-a</tt>
option. After the option is processed,
<tt>/home/jenny/foo.txr</tt>
is encountered again. This time it is not opened a second time;
it signals the end of option processing, exactly as it would immediately
do if it hadn't triggered the insertion of any arguments.
</p><p>
Advanced example: use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
to invoke
<tt>txr</tt>
passing options to interpreter and to the script:
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/env txr&lt;NUL&gt;--eargs:-C:175:{}:--debug
</tt></pre><tt>

</tt>

<p>
This example shows how
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
can be used in conjunction with the null hack. When
<tt>txr</tt>
begins executing, it receives the arguments
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr /home/jenny/foo.txr
</tt></pre><tt>

</tt>

<p>
The script file is opened, and the arguments delimited by the
null character in the hash bang line are inserted, resulting
in the effective command line:
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr --eargs:-C:175:{}:--debug /home/jenny/foo.=
txr
</tt></pre><tt>

</tt>

<p>
Next,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
is processed in the ordinary way, transforming the command line
into:
</p><p>
<tt>
</tt></p><pre><tt>  /usr/bin/txr -C 175 /home/jenny/foo.txr --debug
</tt></pre><tt>

</tt>

<p>
The name of the script file is encountered, and signals the end
of option processing. Thus
<tt>txr</tt>
receives the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
option, instructing it to emulate some behaviors from version 175,
and the
<tt>/home/jenny/foo.txr</tt>
script receives
<tt>--debug</tt>
as
<b>its</b>

argument: it executes with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
list containing one element, the character string
<tt>"--debug"</tt>.
</p><p>
The hash bang null hack feature was introduced in <b>TXR</b> 177.
Previous versions ignore the hash bang line, performing no special
processing. Where a risk exists that programs which depend on the
feature might be executed by an older version of <b>TXR</b>, care must
be taken to detect and handle that situation, either by means of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032F57D4">txr-versi=
on</a></tt>
variable, or else by some logic which infers that the processing of the has=
h
bang line hadn't been performed.
</p><p>

<a name=3D"N-033493D0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.2.4">6.2.4<=
/a> Passing Options to <b>TXR</b> via Hash Bang Null Hack</h4>



<p>
It is possible to use the Hash Bang Null Hack, such that the resulting
executable program recognizes <b>TXR</b> options. This is made possible by
a special behavior in the processing of the
<tt>-f</tt>
option.
</p><p>
For instance, suppose that the effect of the following familiar hash bang l=
ine
is required:
</p><p>
<tt>
</tt></p><pre><tt>  #!/path/to/txr -f
</tt></pre><tt>

</tt>

<p>
However, suppose there is also a requirement to use the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
utility to find <b>TXR</b>. Furthermore, the operation system allows only o=
ne hash
bang argument.  Using the Null Hack, this is rewritten as:
</p><p>
<tt>
</tt></p><pre><tt>  #!/usr/bin/env txr&lt;NUL&gt;-f
</tt></pre><tt>

</tt>

<p>
then if the script is invoked with arguments
<tt>-a b c</tt>,
the command line will ultimately be transformed into:
</p><p>
<tt>
</tt></p><pre><tt>  /path/to/txr -f /path/to/scriptfile -i a b c
</tt></pre><tt>

</tt>

<p>
which allows <b>TXR</b> to process the
<tt>-i</tt>
option, leaving
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>
as arguments for the script.
</p><p>
However, note that there is a subtle issue with the
<tt>-f</tt>
option that has been inserted via the Null Hack: namely, this
insertion happens after
<b>TXR</b> has opened the script file and read the hash bang line from it.
This means that when the inserted
<tt>-f</tt>
option is being processed, the script file is already open.
A special behavior occurs. The
<tt>-f</tt>
option processing notices that the argument to
<tt>-f</tt>
is identical to the path name of name of the script file that <b>TXR</b> ha=
s
already opened for processing. The
<tt>-f</tt>
option and its argument are then skipped.
</p><p>
<a name=3D"N-0011EF66">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.2.5">6.2.5<=
/a> Hash Bang and Setuid</h4>


<b>TXR</b> supports setuid hash bang scripting, even on platforms that do n=
ot
support setuid and setgid attributes on hash bang scripts. On such
platforms, <b>TXR</b> has to be installed setuid/setgid. See the section
SETUID/SETGID OPERATION. On some platforms, it may also be necessary to
to use the
<tt>--reexec</tt>
option.
<p>
<a name=3D"N-02C9DD57">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.3">6.3</a> =
Whitespace</h3>



<p>


Outside of directives, whitespace is significant in <b>TXR</b> queries, and=
 represents
a pattern match for whitespace in the input.  An extent of text consisting =
of
an undivided mixture of tabs and spaces is a whitespace token.  </p><p>
Whitespace tokens match a precisely identical piece of whitespace in the in=
put,
with one exception: a whitespace token consisting of precisely one space ha=
s a
special meaning. It is equivalent to the regular expression
<tt>@/[ ]+/</tt>:
match an extent of one or more spaces (but not tabs!). Multiple consecutive
spaces do not have this meaning.
</p><p>
Thus, the query line
<tt>"a b"</tt>

(one space between
<tt>a</tt>
and
<tt>b</tt>)
matches
<tt>"a b"</tt>

with any number of spaces between the two letters.
</p><p>
For matching a single space, the syntax
<tt>@\ </tt>
can be used (backslash-escaped space).
</p><p>
It is more often necessary to match multiple spaces than to exactly
match one space, so this rule simplifies many queries and adds inconvenienc=
e
to only few.
</p><p>
In output clauses, string and character literals and quasiliterals, a space
token denotes a space.
</p><p>
<a name=3D"N-0005ACF4">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.4">6.4</a> =
Text</h3>



<p>


Query material which is not escaped by the special character
<tt>@</tt>
is literal text, which matches input character for character. Text which oc=
curs at
the beginning of a line matches the beginning of a line.  Text which starts=
 in
the middle of a line, other than following a variable, must match exactly a=
t
the current position, where the previous match left off. Moreover, if the t=
ext
is the last element in the line, its match is anchored to the end of the li=
ne.
</p><p>
An empty query line matches an empty line in the input. Note that an
empty input stream does not contain any lines, and therefore is not matched
by an empty line. An empty line in the input is represented by a newline
character which is either the first character of the file, or follows
a previous newline-terminated line.  </p><p>
Input streams which end without terminating their last line with a newline =
are
tolerated, and are treated as if they had the terminator.
</p><p>
Text which follows a variable has special semantics, described in the
section Variables below.
</p><p>
A query may not leave a line of input partially matched. If any portion of =
a
line of input is matched, it must be entirely matched, otherwise a matching
failure results. However, a query may leave unmatched lines. Matching only
four lines of a ten line file is not a matching failure. The
<tt>eof</tt>
directive can be used to explicitly match the end of a file.
</p><p>
In the following example, the query matches the text, even though
the text has an extra line.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;Four score and seven
<br>&nbsp;years&nbsp;ago&nbsp;our
</tt>

<p>
</p></dd><dt>data:</dt><dd>
<tt>

&nbsp;Four score and seven
<br>&nbsp;years&nbsp;ago&nbsp;our
<br>&nbsp;forefathers
</tt>

</dd></dl>
<p>

</p><p>
In the following example, the query
<b>fails</b>

to match the text, because the text has extra material on one
line that is not matched:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;I can carry nearly eighty gigs
<br>&nbsp;in&nbsp;my&nbsp;head
</tt>

<p>
</p></dd><dt>data:</dt><dd>
<tt>

&nbsp;I can carry nearly eighty gigs of data
<br>&nbsp;in&nbsp;my&nbsp;head
</tt>

</dd></dl>
<p>

</p><p>
Needless to say, if the text has insufficient material relative
to the query, that is a failure also.
</p><p>
To match arbitrary material from the current position to the end
of a line, the "match any sequence of characters, including empty"
regular expression
<tt>@/.*/</tt>
can be used. Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;I can carry nearly eighty gigs@/.*/
</tt>

<p>
</p></dd><dt>data:</dt><dd>
<tt>

&nbsp;I can carry nearly eighty gigs of data
</tt>

</dd></dl>
<p>

</p><p>
In this example, the query matches, since the regular expression
matches the string "of data". (See Regular Expressions section below).
</p><p>
Another way to do this is:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;I can carry nearly eighty gigs@(<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-021FCB7C">skip</a>)
</tt>

<p>
</p></dd></dl>
<a name=3D"N-022D8E2F">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.5">6.5</a> Spec=
ial Characters in Text</h3>



<p>


Control characters may be embedded directly in a query (with the exception =
of
newline characters). An alternative to embedding is to use escape syntax.
The following escapes are supported:
</p><p>



</p><dl class=3D"items">
<dt><tt>@\
 newline<tt><i></i></tt><tt> </tt></tt></dt><dd>



A backslash immediately followed by a newline introduces a physical line
break without breaking up the logical line. Material following this sequenc=
e
continues to be interpreted as a continuation of the previous line, so
that indentation can be introduced to show the continuation without appeari=
ng
in the data.



</dd><dt><tt>@\
 space<tt><i></i></tt><tt> </tt></tt></dt><dd>



A backslash followed by a space encodes a space. This is useful in line
continuations when it is necessary for some or all of the leading spaces to=
 be
preserved.  For instance the two line sequence
<p>
<tt>
</tt></p><pre><tt>  abcd@\
    @\  efg
</tt></pre><tt>

</tt>

<p>
is equivalent to the line
</p><p>
<tt>
</tt></p><pre><tt>  abcd  efg
</tt></pre><tt>

</tt>

<p>
The two spaces before the
<tt>@\</tt>
in the second line are consumed. The spaces after are preserved.
</p><p>
</p></dd><dt><tt>@\a</tt></dt><dd>

Alert character (ASCII 7, BEL).
</dd><dt><tt>@\b</tt></dt><dd>

Backspace (ASCII 8, BS).
</dd><dt><tt>@\t</tt></dt><dd>

Horizontal tab (ASCII 9, HT).
</dd><dt><tt>@\n</tt></dt><dd>

Line feed (ASCII 10, LF). Serves as abstract newline on POSIX systems.
</dd><dt><tt>@\v</tt></dt><dd>

Vertical tab (ASCII 11, VT).
</dd><dt><tt>@\f</tt></dt><dd>

Form feed (ASCII 12, FF). This character clears the screen on many
kinds of terminals, or ejects a page of text from a line printer.
</dd><dt><tt>@\r</tt></dt><dd>

Carriage return (ASCII 13, CR).
</dd><dt><tt>@\e</tt></dt><dd>

Escape (ASCII 27, ESC)



</dd><dt><tt>@\x <tt><i>hex-digits</i></tt><tt> </tt></tt></dt><dd>



A
<tt>@\x</tt>
immediately followed by a sequence of hex digits is interpreted as a hexade=
cimal
numeric character code. For instance
<tt>@\x41</tt>
is the ASCII character A.  If a semicolon character immediately follows the
hex digits, it is consumed, and characters which follow are not considered
part of the hex escape even if they are hex digits.



</dd><dt><tt>@\ <tt><i>octal-digits</i></tt><tt> </tt></tt></dt><dd>



A
<tt>@\</tt>
immediately followed by a sequence of octal digits (0 through 7) is interpr=
eted
as an octal character code. For instance
<tt>@\010</tt>
is character 8, same as
<tt>@\b</tt>.
If a semicolon character immediately follows the octal digits, it is consum=
ed,
and subsequent characters are not treated as part of the octal escape,
even if they are octal digits.
</dd></dl>
<p>

</p><p>
Note that if a newline is embedded into a query line with
<tt>@\n,</tt>
this does not split the line into two; it's embedded into the line and thus
cannot match anything. However,
<tt>@\n</tt>
may be useful in the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03336E1B">cat</a>=
)</tt>
directive and
in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>.
</p><p>
<a name=3D"N-03D48970">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.6">6.6</a> =
Character Handling and International Characters</h3>



<p>


</p><p>
<b>TXR</b> represents text internally using wide characters, which are used=
 to
represent Unicode code points. Script source code, as well as all data sour=
ces,
are assumed to be in the UTF-8 encoding.  In <b>TXR</b> and <b>TXR Lisp</b>=
 source, extended
characters can be used directly in comments, literal text, string literals,
quasiliterals and regular expressions.  Extended characters can also be
expressed indirectly using hexadecimal or octal escapes.
On some platforms, wide characters may be restricted to 16 bits, so that
<b>TXR</b> can only work with characters in the BMP (Basic Multilingual Pla=
ne)
subset of Unicode.
</p><p>
<b>TXR</b> does not use the localization features of the system library;
its handling of extended characters is not affected by environment variable=
s
like
<tt>LANG</tt>
and
<tt>L_CTYPE</tt>.
The program reads and writes only the UTF-8 encoding.
</p><p>
If
<b>TXR</b> encounters an invalid bytes in the UTF-8 input, what happens dep=
ends on
the context in which this occurs. In a query, comments are read without reg=
ard
for encoding, so invalid encoding bytes in comments are not detected. A com=
ment
is simply a sequence of bytes terminated by a newline.  In lexical elements
which represent text, such as string literals, invalid or unexpected encodi=
ng
bytes are treated as syntax errors. The scanner issues an error message,
then discards a byte and resumes scanning.  Certain sequences pass through =
the
scanner without triggering an error, namely some UTF-8 overlong sequences.
These are caught when when the lexeme is subject to UTF-8 decoding, and tre=
ated
in the same manner as other UTF-8 data, described in the following paragrap=
h.
</p><p>
Invalid bytes in data are treated as follows. When an invalid byte is
encountered in the middle of a multibyte character, or if the input
ends in the middle of a multibyte character, or if a character is extracted
which is encoded as an overlong form, the UTF-8 decoder returns to the star=
ting
byte of the ill-formed multibyte character, and extracts just that byte,
mapping it to the Unicode character range U+DC00 through U+DCFF.  The decod=
ing
resumes afresh at the following byte, expecting that byte to be the start
of a UTF-8 code.
</p><p>
Furthermore, because <b>TXR</b> internally uses a null-terminated character
representation of strings which easily interoperates with C language
interfaces, when a null character is read from a stream, <b>TXR</b> convert=
s it to
the code U+DC00. On output, this code converts back to a null byte,
as explained in the previous paragraph. By means of this representational
trick, <b>TXR</b> can handle textual data containing null bytes.
</p><p>
<a name=3D"N-00AE32C5">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.7">6.7</a> =
Regular Expression Directives</h3>



<p>


</p><p>
In place of a piece of text (see section Text above), a regular expression
directive may be used, which has the following syntax:
</p><p>
<tt>
</tt></p><pre><tt>  @/RE/
</tt></pre><tt>

</tt>

<p>
where the RE part enclosed in slashes represents regular expression
syntax (described in the section Regular Expressions below).
</p><p>
Long regular expressions can be broken into multiple lines using a
backslash-newline sequence.  Whitespace before the sequence or after the
sequence is not significant, so the following two are equivalent:
</p><p>
<tt>
</tt></p><pre><tt>  @/reg \
    ular/

  @/regular/
</tt></pre><tt>

</tt>

<p>
There may not be whitespace between the backslash and newline.
</p><p>
Whereas literal text simply represents itself, regular expression denotes a
(potentially infinite) set of texts.  The regular expression directive
matches the longest piece of text (possibly empty) which belongs to the set
denoted by the regular expression. The match is anchored to the current
position; thus if the directive is the first element of a line, the match i=
s
anchored to the start of a line. If the regular expression directive is the
last element of a line, it is anchored to the end of the line also: the reg=
ular
expression must match the text from the current position to the end of the
line.
</p><p>
Even if the regular expression matches the empty string, the match will fai=
l if
the input is empty, or has run out of data. For instance suppose the third =
line
of the query is the regular expression
<tt>@/.*/</tt>,
but the input is a file which has
only two lines. This will fail: the data has no line for the regular expres=
sion to
match. A line containing no characters is not the same thing as the absence=
 of
a line, even though both abstractions imply an absence of characters.
</p><p>
Like text which follows a variable, a regular expression directive which
follows a variable has special semantics, described in the section Variable=
s
below.
</p><p>
<a name=3D"N-00F7A1E1">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.8">6.8</a> =
Variables</h3>



<p>


</p><p>
Much of the query syntax consists of arbitrary text, which matches file dat=
a
character for character. Embedded within the query may be variables and
directives which are introduced by a
<tt>@</tt>
character.  Two consecutive
<tt>@@</tt>
characters encode a literal
<tt>@</tt>.
</p><p>
A variable matching or substitution directive is written in one of several
ways:
</p><p>
<tt>




<br>&nbsp;&nbsp;@</tt><tt><i>sident</i></tt><tt>=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt>}=20




<br>&nbsp;&nbsp;@*</tt><tt><i>sident</i></tt><tt>=20




<br>&nbsp;&nbsp;@*{</tt><tt><i>bident</i></tt><tt>}=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> /</tt><tt><i>regex</i></t=
t><tt>/}=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> (</tt><tt><i>fun</i></tt>=
<tt> [</tt><tt><i>arg</i></tt><tt> ... ])}=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> </tt><tt><i>number</i></t=
t><tt>}=20

</tt>

</p><p>
The forms with an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
indicate a long match, see Longest Match below.
The last three forms with the embedded regexp
<tt>




/</tt><tt><i>regex</i></tt><tt>/=20

</tt>

or
<tt><i>number</i></tt>
or function
have special semantics; see Positive Match below.
</p><p>
The identifier
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
cannot be used as a name; it is a reserved symbol which
denotes the value true. An attempt to use the variable
<tt>@t</tt>
will result in an exception.  The symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
can be used where a variable name is required syntactically,
but it has special semantics, described in a section below.
</p><p>
A
<tt><i>sident</i></tt>
is a "simple identifier" form which is not delimited by
braces.
</p><p>
A
<tt><i>sident</i></tt>
consists of any combination of
one or more letters, numbers, and underscores. It may not look like a numbe=
r,
so that for instance
<tt>123</tt>
is not a valid
<tt><i>sident</i></tt>,
but
<tt>12A</tt>
is valid.  Case is
sensitive, so that
<tt>FOO</tt>
is different from
<tt>foo</tt>,
which is different from
<tt>Foo</tt>.
</p><p>
The braces around an identifier can be used when material which follows wou=
ld
otherwise be interpreted as being part of the identifier. When a name is
enclosed in braces it is a
<tt><i>bident</i></tt>.
</p><p>
The following additional characters may be used as part of
<tt><i>bident</i></tt>
which are not allowed in a
<tt><i>sident</i></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  ! $ % &amp; * + - &lt; =3D &gt; ? \ ~
</tt></pre><tt>

</tt>

<p>
Moreover, most Unicode characters beyond U+007F may appear in a
<tt><i>bident</i></tt>,
with certain exceptions. A character may not be used if it is any of the
Unicode space characters, a member of the high or low surrogate region,
a member of any Unicode private use area, or is one of the two characters
U+FFFE or U+FFFF.
</p><p>
The rule still holds that a name cannot look like a number so
<tt>+123</tt>
is not a valid
<tt><i>bident</i></tt>
but these are valid:
<tt>a-&gt;b</tt>,
<tt>*xyz*</tt>,
<tt>foo-bar</tt>.
</p><p>
The syntax
<tt>@FOO_bar</tt>
introduces the name
<tt>FOO_bar</tt>,
whereas
<tt>@{FOO}_bar</tt>
means the
variable named
<tt>"FOO"</tt>

followed by the text
<tt>"_bar"</tt>.
There may be whitespace
between the
<tt>@</tt>
and the name, or opening brace. Whitespace is also allowed in the
interior of the braces. It is not significant.
</p><p>
If a variable has no prior binding, then it specifies a match. The
match is determined from some current position in the data: the
character which immediately follows all that has been matched previously.
If a variable occurs at the start of a line, it matches some text
at the start of the line. If it occurs at the end of a line, it matches
everything from the current position to the end of the line.
</p><p>
<a name=3D"N-0241B63E">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9">6.9</a> =
Negative Match</h3>



<p>


</p><p>
If a variable is one of the plain forms
</p><p>
<tt>




<br>&nbsp;&nbsp;@</tt><tt><i>sident</i></tt><tt>=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt>}=20




<br>&nbsp;&nbsp;@*</tt><tt><i>sident</i></tt><tt>=20




<br>&nbsp;&nbsp;@*{</tt><tt><i>bident</i></tt><tt>}=20

</tt>

</p><p>
then this is a "negative match".  The extent of the matched text (the text
bound to the variable) is determined by looking at what follows the variabl=
e,
and ranges from the current position to some position where the following
material finds a match. This is why this is called a "negative match": the
spanned text which ends up bound to the variable is that in which the match=
 for
the trailing material did not occur.
</p><p>
A variable may be followed by a piece of text, a regular expression directi=
ve,
a function call, a directive, another variable, or nothing (i.e.  occurs at=
 the
end of a line). These cases are described in detail below.
</p><p>
<a name=3D"N-01FCFA9B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9.1">6.9.1<=
/a> Variable Followed by Nothing</h4>


If the variable is followed by nothing, the negative match extends from the
current position in the data, to the end of the line.  Example:
<dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;a b c @FOO
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;a b c defghijk
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;FOO=3D"defghijk"
</tt>

<p>
</p></dd></dl>
<a name=3D"N-03777A15">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9.2">6.9.2</a> =
Variable Followed by Text</h4>


For the purposes of determining the negative match, text is defined as a
sequence of literal text and regular expressions, not divided by a directiv=
e.
So for instance in this example:
<p>
<tt>
</tt></p><pre><tt>  @a:@/foo/bcd e@(<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-039458F2">maybe</a>)f@(end)
</tt></pre><tt>

</tt>

<p>

</p><p>
the variable @a is considered to be followed by
<tt>":@/foo/bcd e"</tt>.
</p><p>
If a variable is followed by text, then the extent of the negative match is
determined by searching for the first occurrence of that text within the li=
ne,
starting at the current position.
</p><p>
The variable matches everything between the current position and the matchi=
ng
position (not including the matching position). Any whitespace which follow=
s
the variable (and is not enclosed inside braces that surround the variable
name) is part of the text. For example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;a b @FOO e f
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;a b c d e f
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;FOO=3D"c d"
</tt>

</dd></dl>
<p>

</p><p>
In the above example, the pattern text
<tt>"a b "</tt>

matches the
data
<tt>"a b "</tt>.
So when the
<tt>@FOO</tt>
variable is processed, the data being
matched is the remaining
<tt>"c d e f"</tt>.
The text which follows
<tt>@FOO</tt>
is
<tt>" e f"</tt>.
This is found within the data
<tt>"c d e f"</tt>

at position 3 (counting from 0).  So positions 0-2
<tt>

("c d")
</tt>

constitute the matching text which is bound to FOO.
</p><p>
<a name=3D"N-014ABA83">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9.3">6.9.3<=
/a> Variable Followed by a Function Call or Directive</h4>


<p>
If the variable is followed by a function call, or a directive, the extent =
is
determined by scanning the text for the first position where a match occurs
for the entire remainder of the line. (For a description of functions,
see Functions.)
</p><p>
For example:
</p><p>
<tt>
</tt></p><pre><tt>  @foo@(<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-0057">bind</a> a "abc")xyz
</tt></pre><tt>

</tt>

<p>
Here,
<tt>foo</tt>
will match the text from the current position to where
<tt>"xyz"</tt>

occurs, even though there is a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a>)</=
tt>
directive. Furthermore, if
more material is added after the xyz, it is part of the search.
Note the difference between the following two:
</p><p>
<tt>
</tt></p><pre><tt>  @foo@/abc/@(func)
  @foo@(func)@/abc/
</tt></pre><tt>

</tt>

<p>
In the first example, the variable foo matches the text from the current
position until the match for the regular expression abc.
<tt>@(func)</tt>
is not
considered when processing
<tt>@foo</tt>.
In the second example, the variable foo
matches the text from the current position until the position which matches
the function call, followed by a match for the regular expression.
The entire sequence
<tt>@(func)@/abc/</tt>
is considered.
</p><p>
<a name=3D"N-01AF08B6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9.4">6.9.4<=
/a> Consecutive Variables</h4>


If an unbound variable specifies a fixed-width match or a regular expressio=
n,
then the issue of consecutive variables does not arise. Such a variable
consumes text regardless of any context which follows it.
<p>
However, what if an unbound variable with no modifier is followed by anothe=
r
variable? The behavior depends on the nature of the other variable.
</p><p>
If the other variable is also unbound, and also has no modifier, this is a
semantic error which will cause the query to fail.  A diagnostic message wi=
ll
be issued, unless operating in quiet mode via
<tt>-q</tt>.
The reason is that there is no way to bind two
consecutive variables to an extent of text; this is an ambiguous situation,
since there is no matching criterion for dividing the text between two
variables.  (In theory, a repetition of the same variable, like
<tt>@FOO@FOO</tt>,
could find a solution by dividing the match extent in half, which would wor=
k
only in the case when it contains an even number of characters.  This behav=
ior
seems to have dubious value).
</p><p>
An unbound variable may be followed by one which is bound. The bound
variable is effectively replaced by the text which it denotes, and the logi=
c
proceeds accordingly.
</p><p>
It is possible for a variable to be bound to a regular expression.
If
<tt>x</tt>
is an unbound variable and
<tt>y</tt>
is bound to a regular expression
<tt>RE</tt>,
then
<tt>@x@y</tt>
means
<tt>@x@/RE/</tt>.
A variable
<tt>v</tt>
can be bound to a regular expression using, for example,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> v =
#/RE/)</tt>.
</p><p>
The
<tt>@*</tt>
syntax for longest match is available. Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@FOO:@BAR@FOO
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;xyz:defxyz
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;FOO=3Dxyz, BAR=3Ddef
</tt>

</dd></dl>
<p>

</p><p>
Here,
<tt>FOO</tt>
is matched with
<tt>"xyz"</tt>,
based on the delimiting around the
colon. The colon in the pattern then matches the colon in the data,
so that
<tt>BAR</tt>
is considered for matching against
<tt>"defxyz"</tt>.
<tt>BAR</tt>
is followed by
<tt>FOO</tt>,
which is already bound to
<tt>"xyz"</tt>.
Thus
<tt>"xyz"</tt>

is located in the
<tt>"defxyz"</tt>

data following
<tt>"def"</tt>,
and so BAR is bound to
<tt>"def"</tt>.
</p><p>
If an unbound variable is followed by a variable which is bound to a list, =
or
nested list, then each character string in the list is tried in turn to pro=
duce
a match. The first match is taken.
</p><p>
An unbound variable may be followed by another unbound variable which speci=
fies
a regular expression or function call match. This is a special case called =
a
"double variable match".  What happens is that the text is searched using t=
he
regular expression or function.  If the search fails, than neither variable=
 is
bound: it is a matching failure.  If the search succeeds, than the first
variable is bound to the text which is skipped by the search.  The second
variable is bound to the text matched by the regular expression or function=
.
Examples:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@foo@{bar /abc/}
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;xyz@#abc
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;foo=3D"xyz@#", BAR=3D"abc"
</tt>

</dd></dl>
<p>

</p><p>
<a name=3D"N-01257C83">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9.5">6.9.5<=
/a> Consecutive Variables Via Directive</h4>


Two variables can be
<i>de facto</i>

consecutive in a manner shown in the
following example:
<p>
<tt>
</tt></p><pre><tt>  @var1@(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-001B">all</a>)@var2@(end)
</tt></pre><tt>

</tt>

<p>
This is treated just like the variable followed by directive. No semantic
error is identified, even if both variables are unbound. Here,
<tt>@var2</tt>
matches everything at the current position, and so
<tt>@var1</tt>
ends up bound to the empty string.
</p><p>
Example 1:
<tt>b</tt>
matches at position 0 and
<tt>a</tt>
binds the empty string:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@a@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>=
)@b@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;abc
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a=3D""
<br>&nbsp;b=3D"abc"
</tt>

</dd></dl>
<p>

</p><p>
Example 2:
<tt>*a</tt>
specifies longest match (see Longest Match below), and so it takes
everything:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@*a@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a=
>)@b@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;abc
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a=3D"abc"
<br>&nbsp;b=3D""
</tt>

</dd></dl>
<p>

</p><p>
<a name=3D"N-031A997C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.9.6">6.9.6<=
/a> Longest Match</h4>


The closest-match behavior for the negative match can be overridden to long=
est
match behavior. A special syntax is provided for this: an asterisk between =
the
<tt>@</tt>
and the variable, e.g:
<dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;a @*{FOO}cd
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;a b cdcdcdcd
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;FOO=3D"b cdcdcd"
</tt>

</dd></dl>
<p>

</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;a @{FOO}cd
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;a b cdcdcd
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;FOO=3D"b "
<br>&nbsp;b=3D""
</tt>

</dd></dl>
<p>

</p><p>
In the former example, the match extends to the rightmost occurrence of
<tt>"cd"</tt>,
and so
<tt>FOO</tt>
receives
<tt>"b cdcdcd"</tt>.
In the latter example, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
syntax isn't used, and so a leftmost match takes place. The extent
covers only the
<tt>"b "</tt>,
stopping at the first
<tt>"cd"</tt>

occurrence.
</p><p>
<a name=3D"N-02EBB63E">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.10">6.10</a=
> Positive Match</h3>



<p>


</p><p>
There are syntactic variants of variable syntax which have an embedded expr=
ession
enclosed with the variable in braces:
</p><p>
<tt>




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> /</tt><tt><i>regex</i></t=
t><tt>/}=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> (</tt><tt><i>fun</i></tt>=
<tt> [args</tt><tt><i>...])}</i></tt><tt>=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> </tt><tt><i>number</i></t=
t><tt>}=20




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> </tt><tt><i>bident</i></t=
t><tt>}=20

</tt>

</p><p>
These specify a variable binding that is driven by a positive match derived
from a regular expression, function or character count, rather than from
trailing material (which is regarded as a "negative" match, since the
variable is bound to material which is
<b>skipped</b>

in order to match the trailing material). In the
<tt>




/</tt><tt><i>regex</i></tt><tt>/=20

</tt>

form, the match
extends over all characters from the current position which match
the regular expression
<tt><i>regex</i></tt>.
(see Regular Expressions section below).
In the
<tt>




(</tt><tt><i>fun</i></tt><tt> [</tt><tt><i>args</i></tt><tt> ...])=20

</tt>

form, the match extends over characters which
are matched by the call to the function, if the call
succeeds. Thus
<tt>@{x (y z w)}</tt>
is just like
<tt>@(y z w)</tt>,
except that the region of
text skipped over by
<tt>@(y z w)</tt>
is also bound to the variable
<tt>x</tt>.
See Functions below.
</p><p>
In the
<tt><i>number</i></tt>
form, the match processes a field of text which
consists of the specified number of characters, which must be non-negative
number.  If the data line doesn't have that many characters starting at the
current position, the match fails. A match for zero characters produces an
empty string.  The text which is actually bound to the variable
is all text within the specified field, but excluding leading and
trailing whitespace. If the field contains only spaces, then an empty
string is extracted.
</p><p>
This syntax is processed without consideration of what other
syntax follows.  A positive match may be directly followed by an unbound
variable.
</p><p>
The
<tt>




<br>&nbsp;&nbsp;@{</tt><tt><i>bident</i></tt><tt> </tt><tt><i>bident</i></t=
t><tt>}=20

</tt>

syntax allows the
<tt><i>number</i></tt>
or
<tt><i>regex</i></tt>
modifier to come from a variable. The variable must be bound and contain
a non-negative integer or regular expression.
For example,
<tt>@{x y}</tt>
behaves like
<tt>@{x 3}</tt>
if
<tt>y</tt>
is bound to the integer 3. It is an error if
<tt>y</tt>
is unbound.
</p><p>

<a name=3D"N-015134D8">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.11">6.11</a=
> Special Symbols <tt>nil</tt> and <tt>t</tt></h3>



<p>



</p><p>
Just like in the Common Lisp language, the names
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
are special.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
symbol stands for the empty
list object, an object which marks the end of a list, and Boolean false. It=
 is
synonymous with the syntax
<tt>()</tt>
which may be used interchangeably with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in most constructs.
</p><p>
In <b>TXR Lisp</b>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
cannot be used as variables. When evaluated, they evaluate to themselves.
</p><p>
In the <b>TXR</b> pattern language,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
can be used in the variable binding syntax, but does not create a binding;
it has a special meaning.  It allows the variable matching syntax to be use=
d to
skip material, in ways similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
directive.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
symbol is also used as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
name, both in the <b>TXR</b> pattern language and in <b>TXR Lisp</b>.
A block named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is considered to be anonymous.
</p><p>
<a name=3D"N-030AF1E0">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.12">6.12</a=
> Keyword Symbols</h3>



<p>


</p><p>
Names whose names begin with the
<tt>:</tt>
character are keyword symbols.  These also
may not be used as variables either and stand for themselves. Keywords are
useful for labeling information and situations.
</p><p>
<a name=3D"N-00265C5B">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.13">6.13</a=
> Regular Expressions</h3>



<p>


Regular expressions are a language for specifying sets of character strings=
.
Through the use of pattern matching elements, regular expression is
able to denote an infinite set of texts.
<b>TXR</b> contains an original implementation of regular expressions, whic=
h
supports the following syntax:
</p><dl class=3D"items">
<dt><tt>.</tt></dt><dd>

The period is a "wildcard" that matches any character.
</dd><dt><tt>[]</tt></dt><dd>

Character class: matches a single character, from the set specified by
special syntax written between the square brackets.
This supports basic regexp character class syntax. POSIX
notation like
<tt>[:digit:]</tt>
is not supported.
The regex tokens
<tt>\s</tt>,
<tt>\d</tt>
and
<tt>\w</tt>
are permitted in character classes, but not their complementing counterpart=
s.
These tokens simply contribute their characters to the class.
The class
<tt>[a-zA-Z]</tt>
means match an uppercase
or lowercase letter; the class
<tt>[0-9a-f]</tt>
means match a digit or
a lowercase letter; the class
<tt>[^0-9]</tt>
means match a non-digit, and so forth.
There are no locale-specific behaviors in <b>TXR</b> regular expressions;
<tt>[A-Z]</tt>
denotes an ASCII/Unicode range of characters.
The class
<tt>[\d.]</tt>
means match a digit or the period character.
A
<tt>]</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
can be used within a character class, but must be escaped
with a backslash. A
<tt>^</tt>
in the first position denotes a complemented
class, unless it is escaped by backslash. In any other position, it denotes
itself.  Two backslashes code for one backslash. So for instance
<tt>[\[\-]</tt>
means match a
<tt>[</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
character,
<tt>[^^]</tt>
means match any character other
than
<tt>^</tt>,
and
<tt>[\^\\]</tt>
means match either a
<tt>^</tt>
or a backslash. Regex operators
such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
and
<tt>&amp;</tt>
appearing in a character class represent ordinary
characters. The characters
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>,
<tt>]</tt>
and
<tt>^</tt>
occurring outside of a character class
are ordinary. Unescaped
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
characters can appear within a character class. The
empty character class
<tt>[]</tt>
matches no character at all, and its complement
<tt>[^]</tt>
matches any character, and is treated as a synonym for the <tt>.</tt>
(period) wildcard operator.

</dd><dt><tt>\s</tt>, <tt>\w</tt> and <tt>\d</tt> </dt><dd>

These regex tokens each match a single character. The
<tt>\s</tt>
regex token matches a wide variety of ASCII whitespace characters
and Unicode spaces. The
<tt>\w</tt>
token matches alphabetic word characters; it
is equivalent to the character class
<tt>[A-Za-z_]</tt>.
The
<tt>\d</tt>
token matches a digit, and is equivalent to
<tt>[0-9]</tt>.

</dd><dt><tt>\S</tt>, <tt>\W</tt> and <tt>\D</tt> </dt><dd>

These regex tokens are the complemented counterparts of
<tt>\s</tt>,
<tt>\w</tt>
and
<tt>\d</tt>.
The
<tt>\S</tt>
token matches all those characters which
<tt>\s</tt>
does not match,
<tt>\W</tt>
matches all characters that
<tt>\w</tt>
does not match and
<tt>\D</tt>
matches nondigits.
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">=
empty</a></tt></dt><dd>

An empty expression is a regular expression. It represents the set of strin=
gs
consisting of the empty string; i.e. it matches just the empty string. The
empty regex can appear alone as a full regular expression (for instance the
<b>TXR</b> syntax
<tt>@//</tt>
with nothing between the slashes)
and can also be passed as a subexpression to operators, though this
may require the use of parentheses to make the empty regex explicit.  For
example, the expression
<tt>a|</tt>
means: match either
<tt>a</tt>,
or nothing.  The forms
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
and
<tt>(*)</tt>
are syntax errors; though not useful, the correct way to match the
empty expression zero or more times is the syntax
<tt>()*</tt>.
</dd><dt><tt>nomatch</tt></dt><dd>

The nomatch regular expression represents the
empty set: it matches no strings at all, not even the empty string.
There is no dedicated syntax to directly express nomatch in the regex langu=
age.
However, the empty character class
<tt>[]</tt>
is equivalent to nomatch, and may be
considered to be a notation for it. Other representations of nomatch are
possible: for instance, the regex
<tt>~.*</tt>
which is the complement of the regex that
denotes the set of all possible strings, and thus denotes the empty set. A
nomatch has uses; for instance, it can be used to temporarily "comment out"
regular expressions. The regex
<tt>([]abc|xyz)</tt>
is equivalent to
<tt>(xyz)</tt>,
since the
<tt>[]abc</tt>
branch cannot match anything. Using
<tt>[]</tt>
to "block" a subexpression allows
you to leave it in place, then enable it later by removing the "block".
</dd><dt><tt>(R)</tt></dt><dd>

If
<tt>R</tt>
is a regular expression, then so is
<tt>(R).</tt>
The contents of parentheses denote one regular expression unit, so that for
instance in
<tt>(RE)*</tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
operator applies to the entire parenthesized group.
The syntax
<tt>()</tt>
is valid and equivalent to the empty regular expression.
</dd><dt><tt>R?</tt></dt><dd>

Optionally match the preceding regular expression
<tt>R</tt>.
</dd><dt><tt>R*</tt></dt><dd>

Match the expression
<tt>R</tt>
zero or more times. This
operator is sometimes called the "Kleene star", or "Kleene closure".
The Kleene closure favors the longest match. Roughly speaking, if there are=
 two
or more ways in which
<tt>R1*R2</tt>
can match, than that match occurs in which
<tt>R1*</tt>
matches the longest possible text.
</dd><dt><tt>R+</tt></dt><dd>

Match the preceding expression
<tt>R</tt>
one or more times.  Like
<tt>R*</tt>,
this favors the longest possible match:
<tt>R+</tt>
is equivalent to
<tt>RR*</tt>.
</dd><dt><tt>R1%R2</tt></dt><dd>

Match
<tt>R1</tt>
zero or more times, then match
<tt>R2</tt>.
If this match can occur in
more than one way, then it occurs such that
<tt>R1</tt>
is matched the fewest
number of times, which is opposite from the behavior of
<tt>R1*R2</tt>.
Repetitions of
<tt>R1</tt>
terminate at the earliest
point in the text where a non-empty match for
<tt>R2</tt>
occurs. Because
it favors shorter matches,
<tt>%</tt>
is termed a non-greedy operator.  If
<tt>R2</tt>
is the empty expression, or equivalent to it, then
<tt>R1%R2</tt>
reduces to
<tt>R1*</tt>.
So for
instance
<tt>(R%)</tt>
is equivalent to
<tt>(R*)</tt>,
since the missing right operand is
interpreted as the empty regex. Note that whereas the expression
<tt>(R1*R2)</tt>
is equivalent to
<tt>(R1*)R2</tt>,
the expression
<tt>(R1%R2)</tt>
is
<b>not</b>

equivalent to
<tt>(R1%)R2</tt>.
Also note that
<tt>A(XY%Z)B</tt>
is equivalent to
<tt>AX(Y%Z)B</tt>.
This is because the precedence of
<tt>%</tt>
is higher than that of catenation on its left side; this rule prevents the =
given
syntax from expressing the
<tt>XY</tt>
catenation. The expression may be understood as:
<tt>A(X(Y%Z))B</tt>
where the inner parentheses clarify how the syntax surrounding the
<tt>%</tt>
operator is being parsed, and the outer parentheses are superfluous.
The correct way to assert catenation of
<tt>XY</tt>
as the left operand of
<tt>%</tt>
is
<tt>A(XY)%ZB</tt>.
To specify
<tt>XY</tt>
as the left operand, and limit the right operand to just
<tt>Z</tt>,
the correct syntax is
<tt>A((XY)%Z)B</tt>.
By contrast, the expression
<tt>A(X%YZ)B</tt>
is not equivalent to
<tt>A(X%Y)ZB</tt>
because the precedence of
<tt>%</tt>
is lower than that of catenation on its right side. The operator is
effectively "bi-precedential".
</dd><dt><tt>~R</tt></dt><dd>

Match the opposite of the following expression
<tt>R</tt>;
that is, match exactly
those texts that
<tt>R</tt>
does not match. This operator is called complement,
or logical not.
</dd><dt><tt>R1R2</tt></dt><dd>

Two consecutive regular expressions denote catenation:
the left expression must match, and then the right.
</dd><dt><tt>R1|R2</tt></dt><dd>

match either the expression
<tt>R1</tt>
or
<tt>R2</tt>.
This operator is known by
a number of names: union, logical or, disjunction, branch, or alternative.
</dd><dt><tt>R1&amp;R2</tt></dt><dd>

Match both the expression
<tt>R1</tt>
and
<tt>R2</tt>
simultaneously; i.e. the
matching text must be one of the texts which are in the intersection of the=
 set
of texts matched by
<tt>R1</tt>
and the set matched by
<tt>R2</tt>.
This operator is called intersection, logical and, or conjunction.
<p>
</p></dd></dl>
<p>

Any character which is not a regular expression operator, a backslash escap=
e,
or the slash delimiter, denotes one-position match of that character itself=
.
</p><p>
Any of the special characters, including the delimiting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>,
and the backslash, can be escaped with a backslash to suppress its
meaning and denote the character itself.
</p><p>
Furthermore, all of the same escapes as are described in the section Specia=
l
Characters in Text above are supported - the difference is that in regular
expressions, the
<tt>@</tt>
character is not required, so for example a tab is coded as
<tt>\t</tt>
rather than
<tt>@\t</tt>.
Octal and hex character escapes can be optionally
terminated by a semicolon, which is useful if the following characters are
octal or hex digits not intended to be part of the escape.
</p><p>
Only the above escapes are supported. Unlike in some other regular expressi=
on
implementations, if a backlash appears before a character which isn't a reg=
ex
special character or one of the supported escape sequences, it is an error.
This wasn't true of historic versions of <b>TXR</b>. See the COMPATIBILITY =
section.
</p><p>
</p><dl class=3D"items">
<dt>Precedence table, highest to lowest:</dt><dd>
<table>
<tbody><tr valign=3D"top"><td>Operators</td><td>Class</td><td>Associativity=
<br></td></tr>
<tr valign=3D"top"><td><tt>(R) []</tt></td><td>primary</td><td><br></td></t=
r>
<tr valign=3D"top"><td><tt>R? R+ R* R%...</tt></td><td>postfix</td><td>left=
-to-right<br></td></tr>
<tr valign=3D"top"><td><tt>R1R2</tt></td><td>catenation</td><td>left-to-rig=
ht<br></td></tr>
<tr valign=3D"top"><td><tt>~R ...%R</tt></td><td>unary</td><td>right-to-lef=
t<br></td></tr>
<tr valign=3D"top"><td><tt>R1&amp;R2</tt></td><td>intersection</td><td>left=
-to-right<br></td></tr>
<tr valign=3D"top"><td><tt>R1|R2</tt></td><td>union</td><td>left-to-right<b=
r></td></tr>
</tbody></table>
</dd></dl>
<p>

</p><p>
The
<tt>%</tt>
operator is like a postfix operator with respect to its left
operand, but like a unary operator with respect to its right operand.
Thus
<tt>a~b%c~d</tt>
is
<tt>

a(~(b%(c(~d))))
</tt>

, demonstrating right-to-left associativity,
where all of
<tt>b%</tt>
may be regarded as a unary operator being applied to
<tt>c~d</tt>.
Similarly,
<tt>a?*+%b</tt>
means
<tt>(((a?)*)+)%b</tt>,
where the trailing
<tt>%b</tt>
behaves like a postfix operator.
</p><p>
In
<b>TXR</b>, regular expression matches do not span multiple lines. The rege=
x
language has no feature for multi-line matching. However, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freefor=
m</a>)</tt>
directive
allows the remaining portion of the input to be treated as one string
in which line terminators appear as explicit characters. Regular expression=
s
may freely match through this sequence.
</p><p>
It's possible for a regular expression to match an empty string.
For instance, if the next input character is
<tt>z</tt>,
facing a
the regular expression
<tt>/a?/</tt>,
there is a zero-character match:
the regular expression's state machine can reach an acceptance
state without consuming any characters. Examples:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@A@/a?/@/.*/
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;zzzzz
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;A=3D""
</tt>

</dd></dl>
<p>

</p><p>
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@{A /a?/}@B
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;zzzzz
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;A=3D"", B=3D"zzzz"
</tt>

</dd></dl>
<p>

</p><p>
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@*A@/a?/
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;zzzzz
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;A=3D"zzzzz"
</tt>

</dd></dl>
<p>

</p><p>
In the first example, variable
<tt>@A</tt>
is followed by a regular expression
which can match an empty string. The expression faces the letter
<tt>z</tt>
at position 0 in the data line. A zero-character match occurs there,
therefore the variable
<tt>A</tt>
takes on the empty string. The
<tt>@/.*/</tt>
regular expression then consumes the line.
</p><p>
Similarly, in the second example, the
<tt>/a?/</tt>
regular expression faces a
<tt>z</tt>,
and thus yields an empty string which is bound to
<tt>A</tt>.
Variable
<tt>@B</tt>
consumes the entire line.
</p><p>
The third example requests the longest match for the variable binding.
Thus, a search takes place for the rightmost position where the
regular expression matches. The regular expression matches anywhere,
including the empty string after the last character, which is
the rightmost place. Thus variable
<tt>A</tt>
fetches the entire line.
</p><p>
For additional information about the advanced regular expression
operators, NOTES ON EXOTIC REGULAR EXPRESSIONS below.
</p><p>
<a name=3D"N-023BD1E6">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.14">6.14</a=
> Compound Expressions</h3>



<p>


If the
<tt>@</tt>
escape character is followed by an open parenthesis or square bracket,
this is taken to be the start of a <b>TXR Lisp</b> compound expression.
</p><p>
The <b>TXR</b> language has the unusual property that its syntactic element=
s,
so-called
<i>directives</i>,

are Lisp compound expressions. These expressions not only enclose syntax, b=
ut
expressions which begin with certain symbols
<i>de facto</i>

behave as tokens in a phrase structure grammar. For instance, the expressio=
n
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
begins a block which must be terminated by the expression
<tt>@(end)</tt>,
otherwise there is a syntax error. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
expression can contain arguments which modify the behavior of the construct=
,
for instance
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
 :gap 0 :vars (a b))</tt>.
In some ways, this situation might be compared to the HTML language, in whi=
ch
an element such as
<tt>&lt;a&gt;</tt>
must be terminated by
<tt>&lt;/a&gt;</tt>
and can have attributes such as
<tt>&lt;a href=3D"..."&gt;</tt>.
</p><p>
Compound contain subexpressions: other compound expressions, or literal obj=
ects
of various kinds. Among these are: symbols, numbers, string literals, chara=
cter
literals, quasiliterals and regular expressions. These are described in the
following sections. Additional kinds of literal objects exist, which are
discussed in the TXR LISP section of the manual.
</p><p>
Some examples of compound expressions are:
</p><p>
<tt>
</tt></p><pre><tt>  (banana)

  (a b c (d e f))

  (  a (b (c d) (e  ) ))

  ("apple" #\b #\space 3)

  (a #/[a-z]*/ b)

  (_ `@file.txt`)
</tt></pre><tt>

</tt>

<p>
Symbols occurring in a compound expression follow a slight more permissive
lexical syntax than the
<tt><i>bident</i></tt>
in the syntax
<tt>




@{</tt><tt><i>bident</i></tt><tt>}=20

</tt>

introduced earlier. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(slash) character may be part of an identifier, or even
constitute an entire identifier. In fact a symbol inside a
directive is a
<tt><i>lident</i></tt>.
This is described in the Symbol Tokens section under TXR LISP.
A symbol must not be a number; tokens that look like numbers are treated as
numbers and not symbols.
</p><p>
<a name=3D"N-029EAE7C">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.15">6.15</a=
> Character Literals</h3>



<p>


</p><p>
Character literals are introduced by the
<tt>#\</tt>
syntax, which is either
followed by a character name, the letter
<tt>x</tt>
followed by hex digits,
the letter
<tt>o</tt>
followed by octal digits, or a single character. Valid character
names are:
</p><p>
<tt>
</tt></p><pre><tt>  nul                 linefeed            return
  alarm               newline             esc
  backspace           vtab                space
  tab                 page                pnul
</tt></pre><tt>

</tt>

<p>
For instance
<tt>#\esc</tt>
denotes the escape character.
</p><p>
This convention for character literals is similar to that
of the Scheme language.  Note that
<tt>#\linefeed</tt>
and
<tt>#\newline</tt>
are the same
character. The
<tt>#\pnul</tt>
character is specific to <b>TXR</b> and denotes the
<tt>U+DC00</tt>
code in Unicode; the name stands for "pseudo-null", which is related to
its special function. For more information about this, see the section
"Character Handling and International Characters".
</p><p>
<a name=3D"N-026B69E0">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.16">6.16</a=
> String Literals</h3>



<p>


</p><p>
String literals are delimited by double quotes.
A double quote within a string literal is encoded using
<tt>

\"
</tt>

and a backslash is encoded as
<tt>\\</tt>.
Backslash escapes like
<tt>\n</tt>
and
<tt>\t</tt>
are recognized, as are hexadecimal escapes like
<tt>\xFF</tt>
or
<tt>\xxabc</tt>
and octal
escapes like
<tt>\123</tt>.
Ambiguity between an escape and subsequent
text can be resolved by using trailing semicolon delimiter:
<tt>"\xabc;d"</tt>

is a string consisting of the character
<tt>U+0ABC</tt>
followed by
<tt>"d"</tt>.
The semicolon
delimiter disappears. To write a literal semicolon immediately after a hex
or octal escape, write two semicolons, the first of which will be interpret=
ed
as a delimiter. Thus,
<tt>"\x21;;"</tt>

represents
<tt>"!;"</tt>.
</p><p>
If the line ends in the middle of a literal, it is an error, unless the
last character is a backslash. This backslash is a special escape which doe=
s
not denote a character; rather, it indicates that the string literal contin=
ues
on the next line.  The backslash is deleted, along with whitespace which
immediately precedes it, as well as leading whitespace in the following lin=
e.
The escape sequence
<tt>"\ "</tt>

(backslash space) can be used to encode a significant space.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  "foo   \
   bar"

  "foo   \
  \ bar"

  "foo\  \
   bar"
</tt></pre><tt>

</tt>

<p>
The first string literal is the string
<tt>"foobar"</tt>.
The second two are
<tt>"foo bar"</tt>.
</p><p>
<a name=3D"N-03C50723">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.17">6.17</a=
> Word List Literals</h3>



<p>


</p><p>
A word list literal (WLL) provides a convenient way to write a list of stri=
ngs
when such a list can be given as whitespace-delimited words.
</p><p>
There are two flavors of the WLL: the regular WLL which begins with
<tt>

#"
</tt>

(hash, double-quote) and the splicing list literal which begins with
<tt>

#*"
</tt>

(hash, star, double-quote).
</p><p>
Both types are terminated by a double quote, which may be escaped
as
<tt>

\"
</tt>

in order to include it as a character. All the escaping conventions
used in string literals can be used in word literals.
</p><p>
Unlike in string literals, whitespace (tabs and spaces) is not
significant in word literals: it separates words.  Whitespace may be
escaped with a backslash in order to include it as a literal character.
</p><p>
Just like in string literals, an unescaped newline character is not allowed=
.
A newline preceded by a backslash is permitted. Such an escaped backslash,
together with any leading and trailing unescaped whitespace, is removed
and replaced with a single space.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  #"abc def ghi"   --&gt; notates ("abc" "def" "ghi")

  #"abc   def \
      ghi"         --&gt; notates ("abc" "def" "ghi")

  #"abc\ def ghi" --&gt; notates ("abc def" "ghi")

  #"abc\ def\ \
   \ ghi"         --&gt; notates ("abc def " " ghi")
</tt></pre><tt>

</tt>

<p>
A splicing word literal differs from a word literal in that it does not
produce a list of string literals, but rather it produces a sequence of str=
ing
literals that is merged into the surrounding syntax.  Thus, the following t=
wo
notations are equivalent:
</p><p>
<tt>
</tt></p><pre><tt>  (1 2 3 #*"abc def" 4 5 #"abc def")

  (1 2 3 "abc" "def" 4 5 ("abc" "def"))
</tt></pre><tt>

</tt>

<p>
The regular WLL produced a single list object, but the splicing
WLL expanded into multiple string literal objects.
</p><p>
<a name=3D"N-00E96BCB">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.18">6.18</a=
> String Quasiliterals</h3>



<p>


</p><p>
Quasiliterals are similar to string literals, except that they may
contain variable references denoted by the usual
<tt>@</tt>
syntax. The quasiliteral
represents a string formed by substituting the values of those variables
into the literal template. If
<tt>a</tt>
is bound to
<tt>"apple"</tt>

and
<tt>b</tt>
to
<tt>"banana"</tt>,
the quasiliteral
<tt>`one @a and two @{b}s`</tt>
represents the string
<tt>"one apple and two bananas"</tt>.
A backquote escaped by a backslash represents
itself. Unlike in directive syntax, two consecutive
<tt>@</tt>
characters do not code for a literal
<tt>@</tt>,
but cause a syntax error. The reason for this is that compounding of the
<tt>@</tt>
syntax is meaningful.
Instead, there is a
<tt>\@</tt>
escape for encoding a literal
<tt>@</tt>
character.  Quasiliterals support the full output variable
syntax. Expressions within variable substitutions follow the evaluation rul=
es
of <b>TXR Lisp</b>.  This hasn't always been the case: see the COMPATIBILIT=
Y section.
</p><p>
Quasiliterals can be split into multiple lines in the same way as ordinary
string literals.
</p><p>
<a name=3D"N-02E9E83D">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.19">6.19</a=
> Quasiword List Literals</h3>



<p>


</p><p>
The quasiword list literals (QLL-s) are to quasiliterals what WLL-s are to
ordinary literals. (See the above section Word List Literals.)
</p><p>
A QLL combines the convenience of the WLL
with the power of quasistrings.
</p><p>
Just as in the case of WLL-s, there are two flavors of the
QLL: the regular QLL which begins with
<tt>#`</tt>
&nbsp;(hash, backquote) and the splicing QLL which begins with
<tt>#*`</tt>
&nbsp;(hash, star, backquote).
</p><p>
Both types are terminated by a backquote, which may be escaped
as
<tt>\`</tt>
&nbsp;in order to include it as a character. All the escaping conventions
used in quasiliterals can be used in QLL.
</p><p>
Unlike in quasiliterals, whitespace (tabs and spaces) is not
significant in QLL: it separates words.  Whitespace may be
escaped with a backslash in order to include it as a literal character.
</p><p>
A newline is not permitted unless escaped. An escaped newline works exactly=
 the
same way as it does in word list literals (WLL-s).
</p><p>
Note that the delimiting into words is done before the variable
substitution. If the variable a contains spaces, then
<tt>#`@a`</tt>
nevertheless
expands into a list of one item: the string derived from
<tt>a</tt>.
</p><p>
Examples:
</p><p>
<tt>
</tt></p><pre><tt>  #`abc @a ghi`  --&gt; notates (`abc` `@a` `ghi`)

  #`abc   @d@e@f \
  ghi`            --&gt; notates (`abc` `@d@e@f` `ghi`)

  #`@a\ @b @c` --&gt; notates (`@a @b` `@c`)
</tt></pre><tt>

</tt>

<p>
A splicing QLL differs from an ordinary QLL in that it does not produce a l=
ist
of quasiliterals, but rather it produces a sequence of quasiliterals that i=
s
merged into the surrounding syntax.
</p><p>
<a name=3D"N-01C38CA6">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.20">6.20</a=
> Numbers</h3>



<p>


</p><p>
<b>TXR</b> supports integers and floating-point numbers. </p><p>
An integer constant is made up of digits
<tt>0</tt>
through
<tt>9</tt>,
optionally preceded by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
sign.
</p><p>
Examples:
</p><p>
<tt>
</tt></p><pre><tt>  123
  -34
  +0
  -0
  +234483527304983792384729384723234
</tt></pre><tt>

</tt>

<p>
An integer constant can also be specified in hexadecimal using the prefix
<tt>#x</tt>
followed by an optional sign, followed by hexadecimal digits:
<tt>0</tt>
through
<tt>9</tt>
and the upper or lower case letters
<tt>A</tt>
through
<tt>F</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  #xFF    ;; 255
  #x-ABC  ;; -2748
</tt></pre><tt>

</tt>

<p>
Similarly, octal numbers are supported with the prefix
<tt>#o</tt>
followed by octal digits:
</p><p>
<tt>
</tt></p><pre><tt>  #o777   ;; 511
</tt></pre><tt>

</tt>

<p>
and binary numbers can be written with a
<tt>#b</tt>
prefix:
</p><p>
<tt>
</tt></p><pre><tt>  #b1110  ;; 14
</tt></pre><tt>

</tt>

<p>
Note that the
<tt>#b</tt>
prefix is also used for buffer literals.
</p><p>
A floating-point constant is marked by the inclusion of a decimal point, th=
e
exponential "e notation", or both. It is an optional sign, followed
by a mantissa consisting of digits, a decimal point, more digits, and then =
an
optional exponential notation consisting of the letter
<tt>e</tt>
or
<tt>E</tt>,
an optional
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
sign, and then digits indicating the exponent value.
In the mantissa, the digits are not optional. At least one digit must eithe=
r
precede the decimal point or follow. That is to say, a decimal point by its=
elf
is not a floating-point constant.
</p><p>
Examples:
</p><p>
<tt>
</tt></p><pre><tt>  .123
  123.
  1E-3
  20E40
  .9E1
  9.E19
  -.5
  +3E+3
  1.E5
</tt></pre><tt>

</tt>

<p>
Examples which are not floating-point constant tokens:
</p><p>
<tt>
</tt></p><pre><tt>  .      ;; dot token, not a number
  123E   ;; the symbol 123E
  1.0E-  ;; syntax error: invalid floating point constant
  1.0E   ;; syntax error: invalid floating point constant
  1.E    ;; syntax error: invalid floating point literal
  .e     ;; syntax error: dot token followed by symbol
</tt></pre><tt>

</tt>

<p>
In <b>TXR</b> there is a special "dotdot" token consisting of two consecuti=
ve periods.
An integer constant followed immediately by dotdot is recognized as such; i=
t is
not treated as a floating constant followed by a dot. That is to say,
<tt>123..</tt>
does not mean
<tt>123. .</tt>
(floating point
<tt>123.0</tt>
value followed by dot token).  It means
<tt>123 ..</tt>
(integer
<tt>123</tt>
followed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217A971">..</a></t=
t>
token).
</p><p>
Dialect Note: unlike in Common Lisp,
<tt>123.</tt>
is not an integer, but the floating-point number
<tt>123.0</tt>.
</p><p>
<a name=3D"N-03C6DC72">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-6.21">6.21</a=
> Comments</h3>



<p>


</p><p>
Comments of the form
<tt>@;</tt>
were introduced earlier. Inside compound expressions, another convention fo=
r
comments exists: Lisp comments, which are introduced by the
<tt>;</tt>
(semicolon) character and span to the end of the line.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(foo  ; this is a comment
    bar  ; this is another comment
    )
</tt></pre><tt>

</tt>

<p>
This is equivalent to
<tt>@(foo bar)</tt>.
</p><p>
<a name=3D"N-018A0A19">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7">7</a> DIRE=
CTIVES</h2>




<p>


</p><p>
<a name=3D"N-00C9CE7C">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.1">7.1</a> =
Overview</h3>



<p>


</p><p>
When a <b>TXR Lisp</b> compound expressions occurs in <b>TXR</b> preceded b=
y a
<tt>@</tt>,
it is a
<i>directive</i>.

</p><p>
Directives which are based on certain symbols are, additionally,
involved in a phrase-structure syntax which uses Lisp expressions
as if they were tokens.
</p><p>
For instance, the directive
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
</tt></pre><tt>

</tt>

<p>
not only denotes a compound expression with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
symbol in its head position, but it also introduces a syntactic phrase whic=
h
requires a matching
<tt>@(end)</tt>
directive. In other words,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
is not only
an expression, but serves as a kind of token in a higher level phrase struc=
ture
grammar.
</p><p>
Effectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
is a reserved symbol in the <b>TXR</b> language. A <b>TXR</b> program canno=
t use
this symbol as the name of a pattern function, due to its role in the synta=
x.
The symbol has no reserved role in <b>TXR Lisp</b>.
</p><p>
Usually if this type of directive occurs alone in a line, not
preceded or followed by other material, it is involved in a "vertical" (or =
line
oriented) syntax.
</p><p>
If such a directive is embedded in a line (has preceding or trailing materi=
al)
then it is in a horizontal syntactic and semantic context (character-orient=
ed).
</p><p>
There is an exception: the definition of a horizontal function looks like t=
his:
</p><p>
<tt>
</tt></p><pre><tt>  @(define name (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02133AA5">arg</a>))body material@(end)
</tt></pre><tt>

</tt>

<p>
Yet, this is considered one vertical item, which means that it does not mat=
ch
a line of data. (This is necessary because all horizontal syntax matches
something within a line of data, which is undesirable for definitions.)
</p><p>
Many directives exhibit both horizontal and vertical syntax, with different=
 but
closely related semantics. A few are vertical only, and some are
horizontal only.
</p><p>
A summary of the available directives follows:
</p><p>
</p><dl class=3D"items">
<dt><tt>@(eof)</tt></dt><dd>

Explicitly match the end of file. Fails if unmatched data remains in
the input stream.
<p>
</p></dd><dt><tt>@(eol)</tt></dt><dd>

Explicitly match the end of line. Fails if the current position is not the
end of a line. Also fails if no data remains (there is no current line).
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056=
">next</a>)</tt></dt><dd>

Continue matching in another file or other data source.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A=
">block</a>)</tt></dt><dd>

Groups together a sequence of directives into a logical name block,
which can be explicitly terminated from within using
the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
and
<tt>@(fail)</tt>
directives.
Blocks are described in the section Blocks below.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021F=
CB7C">skip</a>)</tt></dt><dd>

Treat the remaining query as a subquery unit, and search the lines (or
characters) of the input file until that subquery matches somewhere.  A ski=
p is
also an anonymous block.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020=
">trailer</a>)</tt></dt><dd>

Treat the remaining query or subquery as a match for a trailing context. Th=
at
is to say, if the remainder matches, the data position is not advanced.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033=
4C65">freeform</a>)</tt></dt><dd>

Treat the remainder of the input as one big string, and apply the following
query line to that string. The newline characters (or custom separators) ap=
pear
explicitly in that string.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CA=
E17D">fuzz</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CAE17D">fuzz</a><=
/tt>
directive, inspired by the patch utility, specifies a partial
match for some lines.
<p>

</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5=
D09D">line</a>)</tt> and <tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-02D5D09D">chr</a>)</tt> </dt><dd>

These directives match a variable or expression against the current line
number or character position.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0155=
7906">name</a>)</tt></dt><dd>

Match a variable against the name of the current data source.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6=
EA7D">data</a>)</tt></dt><dd>

Match a variable against the remaining data (lazy list of strings).
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077=
">some</a>)</tt></dt><dd>

Multiple clauses are each applied to the same input. Succeeds if at least o=
ne
of the clauses matches the input. The bindings established by earlier
successful clauses are visible to the later clauses.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B=
">all</a>)</tt></dt><dd>

Multiple clauses are applied to the same input. Succeeds if and only if eac=
h
one of the clauses matches. The clauses are applied in sequence, and evalua=
tion
stops on the first failure. The bindings established by earlier successful
clauses are visible to the later clauses.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054=
">none</a>)</tt></dt><dd>

Multiple clauses are applied to the same input. Succeeds if and only if non=
e of
them match. The clauses are applied in sequence, and evaluation stops on th=
e
first success. No bindings are ever produced by this construct.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394=
58F2">maybe</a>)</tt></dt><dd>

Multiple clauses are applied to the same input. No failure occurs if none o=
f
them match.  The bindings established by earlier successful clauses are vis=
ible
to the later clauses.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394=
58F2">cases</a>)</tt></dt><dd>

Multiple clauses are applied to the same input. Evaluation stops on the
first successful clause.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075=
">require</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a></=
tt>
directive is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
directive in that it evaluates one or more
<b>TXR Lisp</b> expressions.  If the result of the rightmost expression is =
nil,
then require triggers a match failure.  See the TXR LISP section far below.
<p>

</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039=
">if</a>)</tt>, <tt>@(elif)</tt>, and <tt>@(else)</tt> </dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive with optional
<tt>elif</tt>
and
<tt>else</tt>
clauses allows one of multiple bodies of pattern matching directives to be
conditionally selected by testing the values of Lisp expressions. It is
also available inside
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
for conditionally selecting output clauses.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394=
58F2">choose</a>)</tt></dt><dd>

Multiple clauses are applied to the same input. The one whose effect persis=
ts
is the one which maximizes or minimizes the length of a particular variable=
.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0049=
18EB">empty</a>)</tt></dt><dd>

The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</=
a>)</tt>
directive matches the empty string. It is useful in certain
situations, such as expressing an empty match in a directive that doesn't
accept an empty clause. The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</=
a>)</tt>
syntax has another meaning in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
clauses, in conjunction with
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>.
<p>



</p></dd><dt><tt>@(define <tt><i>name</i></tt><tt> (</tt><tt><i>args</i></t=
t><tt> ...)) </tt></tt></dt><dd>



Introduces a function. Functions are described in the Functions section bel=
ow.
<p>



</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386=
C775">call</a> <tt><i>expr</i></tt><tt> </tt><tt><i>args</i></tt><tt>*) </t=
t></tt></dt><dd>



Performs function indirection.  Evaluates
<tt><i>expr</i></tt>,
which must produce a symbol that names a pattern function. Then that
pattern function is invoked.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D=
">gather</a>)</tt></dt><dd>

Searches text for matches for multiple clauses which may occur in arbitrary
order. For convenience, lines of the first clause are treated as separate
clauses.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055=
">collect</a>)</tt></dt><dd>

Search the data for multiple matches of a clause. Collect the
bindings in the clause into lists, which are output as array variables.
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
directive is line oriented. It works with a multi-line
pattern and scans line by line. A similar directive called
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)</=
tt>
works within one line.
<p>
A collect is an anonymous block.
</p><p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049=
">and</a>)</tt></dt><dd>

Separator of clauses for
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)</tt>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</=
a>)</tt>.
Equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)</tt=
>.
The choice is stylistic.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034=
">or</a>)</tt></dt><dd>

Separator of clauses for
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)</tt>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</=
a>)</tt>.
Equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)</t=
t>.
The choice is stylistic.
<p>
</p></dd><dt><tt>@(end)</tt></dt><dd>

Required terminator for
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</=
a>)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a>)</tt=
>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a>=
)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>)<=
/tt>
and
<tt>@(define)</tt>.
<p>
</p></dd><dt><tt>@(fail)</tt></dt><dd>

Terminate the processing of a block, as if it were a failed match.
Blocks are described in the section Blocks below.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B=
">accept</a>)</tt></dt><dd>

Terminate the processing of a block, as if it were a successful match.
What bindings emerge may depend on the kind of block: collect
has special semantics.  Blocks are described in the section Blocks below.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328=
371B">try</a>)</tt></dt><dd>

Indicates the start of a try block, which is related to exception
handling, described in the Exceptions section below.
<p>

</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023=
">catch</a>)</tt> and <tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-006C">finally</a>)</tt> </dt><dd>

Special clauses within
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a>=
)</tt>.
See Exceptions below.
<p>

</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B=
">defex</a>)</tt> and <tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-0016">throw</a>)</tt> </dt><dd>

Define custom exception types; throw an exception.  See Exceptions below.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E=
">assert</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive requires the following material to match, otherwise
it throws an exception. It is useful for catching mistakes or omissions
in parts of a query that are sure-fire matches.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019=
">flatten</a>)</tt></dt><dd>

Normalizes a set of specified variables to one-dimensional lists. Those
variables which have scalar value are reduced to lists of that value.
Those which are lists of lists (to an arbitrary level of nesting) are conve=
rted
to flat lists of their leaf values.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028=
">merge</a>)</tt></dt><dd>

Binds a new variable which is the result of merging two or more
other variables. Merging has somewhat complicated semantics.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0333=
6E1B">cat</a>)</tt></dt><dd>

Decimates a list (any number of dimensions) to a string, by catenating its
constituent strings, with an optional separator string between all of the
values.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057=
">bind</a>)</tt></dt><dd>

Binds one or more variables against a value using a structural
pattern match. A limited form of unification takes place which can cause a
match to fail.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F=
">set</a>)</tt></dt><dd>

Destructively assigns one or more existing variables using a structural
pattern, using syntax similar to bind. Assignment to unbound
variables triggers an error.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F=
9FB7">rebind</a>)</tt></dt><dd>

Evaluates an expression in the current binding environment, and
then creates new bindings for the variables in the structural pattern.
Useful for temporarily overriding variable values in a scope.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1=
EE04">forget</a>)</tt></dt><dd>

Removes variable bindings.
<p>
</p></dd><dt><tt>@(local)</tt></dt><dd>

Synonym of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1EE04">forget<=
/a>)</tt>.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159=
EBE7">output</a>)</tt></dt><dd>

A directive which encloses an output clause in the query. An output section
does not match text, but produces text. The directives above are not
understood in an output clause.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052=
">repeat</a>)</tt></dt><dd>

A directive understood within an
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
section, for repeating multi-line
text, with successive substitutions pulled from lists. The directive
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
produces iteration over lists horizontally within one line. These directive=
s
have a different meaning in matching clauses, providing a shorthand
notation for
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
 :vars nil)</tt>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a> :v=
ars nil)</tt>,
respectively.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BD=
E41F">deffilter</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter=
</a></tt>
directive is used for defining named filters, which are useful
for filtering variable substitutions in output blocks. Filters are useful
when data must be translated between different representations that
have different special characters or other syntax, requiring escaping
or similar treatment. Note that it is also possible to use a function
as a filter. See Function Filters below.
<p>
Named filters are stored in the hash table held in the Lisp special variabl=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6A902">*filters*=
</a></tt>.
</p><p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B5=
0006">filter</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B50006">filter</a=
></tt>
directive passes one or more variables through a given
filter or chain or filters, updating them with the filtered values.
<p>

</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080=
">load</a>)</tt> and <tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-01A2ECA0">include</a>)</tt> </dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directives allow <b>TXR</b> programs to be modularized. They bring in
code from a file, in two different ways.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061=
">do</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
directive is used to evaluate <b>TXR Lisp</b> expressions, discarding their
result values. See the TXR LISP section far below.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028D=
BD1B">mdo</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a></=
tt>
(macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>)
directive evaluates <b>TXR Lisp</b> expressions immediately, during the par=
sing
of the <b>TXR</b> syntax in which it occurs.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062=
">in-package</a>)</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
directive is used to switch to a different symbol package.
It mirrors the <b>TXR Lisp</b> macro of the same name.
<p>
</p></dd></dl>
<p>

</p><p>
<a name=3D"N-01149CCF">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.2">7.2</a> =
Subexpression Evaluation</h3>



<p>


</p><p>
Some directives contain subexpressions which are evaluated. Two distinct
styles of evaluations occur in <b>TXR</b>: bind expressions and Lisp expres=
sions.
Which semantics applies to an expression depends on the syntactic
context in which it occurs: which position in which directive.
</p><p>
The evaluation of <b>TXR Lisp</b> expressions is described in the TXR LISP =
section of the manual.
</p><p>
Bind expressions are so named because they occur in the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a>)</=
tt>
directive. <b>TXR</b> pattern function invocations also treat argument expr=
essions
as bind expressions.
</p><p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind<=
/a>)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a>)</t=
t>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a>)<=
/tt>,
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilt=
er</a>)</tt>
directives also use bind expression evaluation. Bind expression evaluation
also occurs in the argument position of the
<tt>:tlist</tt>
keyword in the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive.
</p><p>
Unlike Lisp expressions, bind expressions do not support operators.  If a b=
ind
expression is a nested list structure, it is a template denoting that
structure.  Any symbol in any position of that structure is interpreted as =
a
variable. When the bind expression is evaluated, those corresponding positi=
ons
in the template are replaced by the values of the variables.
</p><p>
Anywhere where a variable can appear in a bind expression's nested list
structure, a Lisp expression can appear preceded by the
<tt>@</tt>
character. That Lisp expression is evaluated and its value is substituted
into the bind expression's template.
</p><p>
Moreover, a Lisp expression preceded by
<tt>@</tt>
can be used as an entire bind expression. The value of that Lisp
expression is then taken as the bind expression value.
</p><p>
Any object in a bind expression which is not a nested list structure contai=
ning
Lisp expressions or variables denotes itself literally.
</p><p>
</p><dl>
<dt>Examples:</dt><dd>
<p>


</p><p>
In the following examples, the variables
<tt>a</tt>
and
<tt>b</tt>
are assumed to have the string values
<tt>"foo"</tt>

and
<tt>"bar"</tt>,
respectively.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">-&gt;</a>=
</tt>
notation indicates the value of each expression.
</p><p>
<tt>
</tt></p><pre><tt>  a              -&gt;  "foo"
  (a b)          -&gt;  ("foo" "bar")
  ((a) ((b) b))  -&gt;  (("foo") (("bar") "bar"))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> a=
 b)     -&gt;  error: unbound variable list
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> =
a b)    -&gt;  ("foo" "bar") ;; Lisp expression
  (a @[b 1..:])  -&gt;  ("foo" "ar")  ;; Lisp eval of [b 1..:]
  (a @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2)=
)   -&gt;  ("foo" 4)     ;; Lisp eval of (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-007C">+</a> 2 2)
  #(a b)         -&gt;  (a b)         ;; Vector literal, not list.
  [a b]          -&gt;  error: unbound variable dwim
</tt></pre><tt>

</tt>

<p>
The last example above
<tt>[a b]</tt>
is a notation equivalent to
<tt>(dwim a b)</tt>
and so follows similarly to the example involving
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-024CD657">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3">7.3</a> Inpu=
t Scanning and Data Manipulation</h3>



<p>


</p><p>
<a name=3D"N-0131C606">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.1">7.3.1<=
/a> The <tt>next</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
directive indicates that the remaining directives in the current block
are to be applied against a new input source.
</p><p>
It can only occur by itself as the only element in a query line,
and takes various arguments, according to these possibilities:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> </tt><tt><i>source</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> </tt><tt><i>source</i></tt><tt> :nothrow)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> :args)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> :env)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> :list </tt><tt><i>lisp-expr</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> :tlist </tt><tt><i>bind-expr</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> :string </tt><tt><i>lisp-expr</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> :var </tt><tt><i>var</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056"=
>next</a> nil)=20

</tt>

</p><p>
The lone
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
without arguments specifies that subsequent directives
will match inside the next file in the argument list which was passed
to <b>TXR</b> on the command line.
</p><p>
If
<tt><i>source</i></tt>
is given, it must be a <b>TXR Lisp</b> expression which denotes an
input source. Its value may be a string or an input stream.
For instance, if variable
<tt>A</tt>
contains the text
<tt>"data"</tt>,
then
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> A)=
</tt>
means switch to the file called
<tt>"data"</tt>,
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> `@=
A.txt`)</tt>
means to switch to the file
<tt>"data.txt"</tt>.
The directive
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> (o=
pen-command `git log`))</tt>
switches to the input stream connected to the output of the
<tt>git log</tt>
command.
</p><p>
If the input source cannot be opened for whatever reason,
<b>TXR</b> throws an exception (see Exceptions below). An unhandled excepti=
on will
terminate the program.  Often, such a drastic measure is inconvenient;
if
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
is invoked with the
<tt>:nothrow</tt>
keyword, then if the input
source cannot be opened, the situation is treated as a simple
match failure.
</p><p>
The variant
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :a=
rgs)</tt>
means that the remaining command line arguments are to
be treated as a data source. For this purpose, each argument is considered =
to
be a line of text. The argument list does include that argument which speci=
fies
the file that is currently being processed or was most recently processed.
As the arguments are matched, they are consumed. This means that if a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive without
arguments is executed in the scope of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :a=
rgs)</tt>,
it opens the file named
by the first unconsumed argument.
</p><p>
To process arguments, and then continue with the original file and argument
list, wrap the argument processing in a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>)<=
/tt>.
When the block terminates, the input source and argument list are restored
to what they were before the block.
</p><p>
The variant
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :e=
nv)</tt>
means that the list of process environment variables
is treated as a source of data. It looks like a text file stream
consisting of lines of the form
<tt>"name=3Dvalue"</tt>.
If this feature is not available
on a given platform, an exception is thrown.
</p><p>
The syntax
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :list =
</tt><tt><i>lisp-expr</i></tt><tt>)=20

</tt>

treats <b>TXR Lisp</b> expression
<tt><i>lisp-expr</i></tt>
as a source of
text. The value of
<tt><i>lisp-expr</i></tt>
is flattened to a simple list in a way similar to the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a>=
)</tt>
directive.  The resulting list is treated as if it were the
lines of a text file: each element of the list must be a string,
which represents a line.  If the strings happen contain embedded newline
characters, they are a visible constituent of the line, and do not act as l=
ine
separators.
</p><p>
The syntax
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :tlist=
 </tt><tt><i>bind-expr</i></tt><tt>)=20

</tt>

is similar to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :l=
ist ...)</tt>
except that
<tt><i>bind-expr</i></tt>
is not a <b>TXR Lisp</b> expression, but a <b>TXR</b> bind expression.
</p><p>
The syntax
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :var <=
/tt><tt><i>var</i></tt><tt>)=20

</tt>

requires
<tt><i>var</i></tt>
to be a previously bound variable. The value of the
variable is retrieved and treated like a list, in the
same manner as under
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :l=
ist ...)</tt>.
Note that
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :v=
ar x)</tt>
is not always the same as
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :t=
list x)</tt>,
because
<tt>:var x</tt>
strictly requires
<tt>x</tt>
to be a <b>TXR</b> variable, whereas the
<tt>x</tt>
in
<tt>:tlist x</tt>
is an expression which can potentially refer to Lisp variable.
</p><p>
The syntax
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :strin=
g </tt><tt><i>lisp-expr</i></tt><tt>)=20

</tt>

treats expression
<tt><i>lisp-expr</i></tt>
as a source of text. The value of the expression must be a string. Newlines=
 in
the string are interpreted as line terminators.
</p><p>
A string which is not terminated by a newline is tolerated, so that:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
056">next</a> :string "abc")
  @a
</tt></pre><tt>

</tt>

<p>
binds
<tt>a</tt>
to
<tt>"abc"</tt>.
Likewise, this is also the case with input files and other
streams whose last line is not terminated by a newline.
</p><p>
However, watch out for empty strings, which are analogous to a correctly fo=
rmed
empty file which contains no lines:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
056">next</a> :string "")
  @a
</tt></pre><tt>

</tt>

<p>
This will not bind
<tt>a</tt>
to
<tt>""</tt>;
it is a matching failure.  The behavior of
<tt>:list</tt>
is
different. The query
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
056">next</a> :list "")
  @a
</tt></pre><tt>

</tt>

<p>
binds
<tt>a</tt>
to
<tt>""</tt>.
The reason is that under
<tt>:list</tt>
the string
<tt>""</tt>

is flattened to
the list
<tt>

("")
</tt>

which is not an empty input stream, but a stream consisting of
one empty line.
</p><p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> ni=
l)</tt>
variant indicates that the following subquery is applied to empty data,
and the list of data sources from the command line is considered empty.
This directive is useful in front of <b>TXR</b> code which doesn't process =
data
sources from the command line, but takes command line arguments.
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> ni=
l)</tt>
incantation absolutely prevents <b>TXR</b> from trying to open the
first command line argument as a data source.
</p><p>
Note that the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive only redirects the source of input over the scope of subquery in =
which
the that directive appears.  For
example, the following query looks for the line starting with
<tt>"xyz"</tt>

at the top of the file
<tt>"foo.txt"</tt>,
within a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a></tt>
directive.  After the
<tt>@(end)</tt>
which terminates the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>,
the
<tt>"abc"</tt>

is matched in the previous input stream which was in effect before
the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
077">some</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> "foo=
.txt")
  xyz@suffix
  @(end)
  abc
</tt></pre><tt>

</tt>

<p>
However, if the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
subquery successfully matched
<tt>"xyz@suffix"</tt>

within the
file
<tt>foo.text</tt>,
there is now a binding for the
<tt>suffix</tt>
variable, which
is visible to the remainder of the entire query. The variable bindings
survive beyond the clause, but the data stream does not.
</p><p>
<a name=3D"N-021FCB7C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.2">7.3.2<=
/a> The <tt>skip</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
directive considers the remainder of the query as a search
pattern. The remainder is no longer required to strictly match at the
current line in the current input stream. Rather, the current stream is sea=
rched,
starting with the current line, for the first line where the entire remaind=
er
of the query will successfully match. If no such line is found, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
directive fails. If a matching position is found, the remainder of
the query is processed from that point.
</p><p>
The remainder of the query can itself contain
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
directives.
Each such directive performs a recursive subsearch.
</p><p>
Skip comes in vertical and horizontal flavors. For instance, skip and match=
 the
last line:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a>)
  @last
  @(eof)
</tt></pre><tt>

</tt>

<p>
Skip and match the last character of the line:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a>)@{last 1}@(eol)
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
directive has two optional arguments, which are evaluated as <b>TXR Lisp</b=
>expressions. If the first argument evaluates to an integer,
its value limits the range of lines scanned for a match. Judicious use
of this feature can improve the performance of queries.
</p><p>
Example: scan until
<tt>"size: @SIZE"</tt>

matches, which must happen within
the next 15 lines:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a> 15)
  size: @SIZE
</tt></pre><tt>

</tt>

<p>
Without the range limitation skip will keep searching until it consumes
the entire input source.  In a horizontal
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>,
the range-limiting numeric argument is expressed in characters, so that
</p><p>
<tt>
</tt></p><pre><tt>  abc@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-021FCB7C">skip</a> 5)def
</tt></pre><tt>

</tt>

<p>
means: there must be a match for
<tt>"abc"</tt>

at the start of the line, and then within the next five characters,
there must be a match for
<tt>"def"</tt>.
</p><p>
Sometimes a skip is nested within a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>,
or
following another skip. For instance, consider:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  begin @BEG_SYMBOL
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  end @BEG_SYMBOL
  @(end)
</tt></pre><tt>

</tt>

<p>
The above
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
iterates over the entire input. But, potentially, so does
the embedded
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>.
Suppose that
<tt>"begin x"</tt>

is matched, but the data has no
matching
<tt>"end x"</tt>.
The skip will search in vain all the way to the end of the
data, and then the collect will try another iteration back at the
beginning, just one line down from the original starting point.  If it is a
reasonable expectation that an
<tt>end x</tt>
occurs 15 lines of a
<tt>"begin x"</tt>,
this can be specified instead:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  begin @BEG_SYMBOL
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a> =
15)
  end @BEG_SYMBOL
  @(end)
</tt></pre><tt>

</tt>

<p>
If the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is used in place of a number, it means to scan
an unlimited range of lines; thus,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
> nil)</tt>
is equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>.
</p><p>
If the symbol
<tt>:greedy</tt>
is used, it changes the semantics of the skip
to longest match semantics.  For instance, match the last three space-separ=
ated
tokens of the line:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a> :greedy) @a @b @c
</tt></pre><tt>

</tt>

<p>
Without
<tt>:greedy</tt>,
the variable
<tt>@c</tt>
will can match multiple tokens,
and end up with spaces in it, because nothing follows
<tt>@c</tt>
and so it matches from any position which follows a space to the
end of the line.  Also note the space in front of
<tt>@a</tt>.
Without this
space,
<tt>@a</tt>
will get an empty string.
</p><p>
A line oriented example of greedy skip: match the last line without
using
<tt>@eof</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a> :greedy)
  @last_line
</tt></pre><tt>

</tt>

<p>
There may be a second numeric argument. This specifies a minimum
number of lines to skip before looking for a match. For instance,
skip 15 lines and then search indefinitely for
<tt>begin ...</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a> nil 15)
  begin @BEG_SYMBOL
</tt></pre><tt>

</tt>

<p>
The two arguments may be used together. For instance, the following
matches if, and only if, the 15th line of input starts with
<tt>begin </tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a> 1 15)
  begin @BEG_SYMBOL
</tt></pre><tt>

</tt>

<p>
Essentially,
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a> 1 =
</tt><tt><i>n</i></tt><tt>)=20

</tt>

means "hard skip by
<tt><i>n</i></tt>
lines".
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
> 1 0)</tt>
is the same as
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
> 1)</tt>,
which is a noop, because it means: "the remainder of the query must match
starting on the next line", or, more briefly, "skip exactly zero lines",
which is the behavior if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
directive is omitted altogether.
</p><p>
Here is one trick for grabbing the fourth line from the bottom of the input=
:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a>)
  @fourth_from_bottom
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a> =
1 3)
  @(eof)
</tt></pre><tt>

</tt>

<p>
Or using greedy skip:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a> :greedy)
  @fourth_from_bottom
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a> =
1 3)
</tt></pre><tt>

</tt>

<p>
Nongreedy skip with the
<tt>@(eof)</tt>
has a slight advantage because the greedy skip
will keep scanning even though it has found the correct match, then backtra=
ck
to the last good match once it runs out of data. The regular skip with expl=
icit
<tt>@(eof)</tt>
will stop when the
<tt>@(eof)</tt>
matches.
</p><p>
<a name=3D"N-01460E2D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.3">7.3.3<=
/a> Reducing Backtracking with Blocks</h4>


<p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
can consume considerable CPU time when multiple skips are nested.  Consider=
:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
21FCB7C">skip</a>)
  A
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  B
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  C
</tt></pre><tt>

</tt>

<p>
This is actually nesting: the second a third skips occur within the body of=
 the
first one, and thus this creates nested iteration. <b>TXR</b> is searching =
for the
combination of skips which find match the pattern of lines
<tt>A</tt>,
<tt>B</tt>
and
<tt>C</tt>,
with
backtracking behavior. The outermost skip marches through the data until it
finds
<tt>A</tt>,
followed by a pattern match for the second skip. The second skip
iterates within to find
<tt>B</tt>,
followed by the third skip, and the third skip
iterates to find
<tt>C</tt>.
If there is only one line
<tt>A</tt>,
and one
<tt>B</tt>,
then this is reasonably fast. But suppose there are many lines matching
<tt>A</tt>
and
<tt>B</tt>,
giving rise to a large number combinations of skips which match
<tt>A</tt>
and
<tt>B</tt>,
and yet do not find a match for
<tt>C</tt>,
triggering backtracking. The nested stepping which tries
the combinations of
<tt>A</tt>
and
<tt>B</tt>
can give rise to a considerable running time.
</p><p>
One way to deal with the problem is to unravel the nesting with the help of
blocks. For example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
05A">block</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)
  A
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)
  B
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  C
</tt></pre><tt>

</tt>

<p>
Now the scope of each skip is just the remainder of the block in which it
occurs. The first skip finds
<tt>A</tt>,
and then the block ends. Control passes to the
next block, and backtracking will not take place to a block which completed
(unless all these blocks are enclosed in some larger construct which
backtracks, causing the blocks to be re-executed.
</p><p>
This rewrite is not equivalent, and cannot be used for instance
in backreferencing situations such as:
</p><p>
<tt>
</tt></p><pre><tt>  @;
  @; Find three lines anywhere in the input which are identical.
  @;
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  @line
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  @line
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  @line
</tt></pre><tt>

</tt>

<p>
This example depends on the nested search-within-search semantics.
</p><p>
<a name=3D"N-01476441">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.4">7.3.4<=
/a> The <tt>trailer</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a></=
tt>
directive introduces a trailing portion of a query or subquery
which matches input material normally, but in the event of a successful mat=
ch,
does not advance the current position. This can be used, for instance, to
cause
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
to match partially overlapping regions.
</p><p>
Trailer can be used in vertical context:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020"=
>trailer</a>)=20




<br>&nbsp;&nbsp;</tt><tt><i>directives</i></tt><tt>=20




<br>&nbsp;&nbsp;...=20

</tt>

</p><p>
or horizontal:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020"=
>trailer</a>) </tt><tt><i>directives</i></tt><tt> ...=20

</tt>

</p><p>
A vertical
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a></=
tt>
prevents the vertical input position from
advancing as it is matched by
<tt><i>directives</i></tt>,
whereas a horizontal
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a></=
tt>
prevents the horizontal position from advancing. In other words,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a></=
tt>
performs matching without consuming the input, providing a
look-ahead mechanism.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  @line
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a>)
  @line
  @(end)
</tt></pre><tt>

</tt>

<p>
This script collects each line which has a duplicate somewhere later
in the input. Without the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>
directive, this does not work properly
for inputs like:
</p><p>
<tt>
</tt></p><pre><tt>  111
  222
  111
  222
</tt></pre><tt>

</tt>

<p>
Without
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>,
the first duplicate pair constitutes a match which
spans over the
<tt>222</tt>.
After that pair is found, the matching continues
after the second
<tt>111</tt>.
</p><p>
With the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>
directive in place, the collect body, on each
iteration, only consumes the lines matched prior to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>.
</p><p>
<a name=3D"N-00334C65">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.5">7.3.5<=
/a> The <tt>freeform</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a></tt>
directive provides a useful alternative to
<b>TXR</b>'s line-oriented matching discipline. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a></tt>
directive treats all
remaining input from the current input source as one big line. The query li=
ne
which immediately follows freeform is applied to that line.
</p><p>
The syntax variations are:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
0334C65">freeform</a>)
  ... query line ..

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a> </tt><tt><i>number</i></tt><tt>)=20
  ... query line ..

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a> </tt><tt><i>string</i></tt><tt>)=20
  ... query line ..

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a> </tt><tt><i>number</i></tt><tt> </tt><tt><i>string</i></tt><tt>)=20
  ... query line ..
</tt></pre><tt>

</tt>

<p>
where
<tt><i>number</i></tt>
and
<tt><i>string</i></tt>
denote <b>TXR Lisp</b> expressions which evaluate to an integer or string
value, respectively.
</p><p>
If
<tt><i>number</i></tt>
and
<tt><i>string</i></tt>
are both present, they may be given in either order.
</p><p>
If the
<tt><i>number</i></tt>
argument is given, its value limits the range of lines which are combined
together. For instance
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freefor=
m</a> 5)</tt>
means to only consider the next five lines
to to be one big line. Without this argument, freeform is "bottomless". It
can match the entire file, which creates the risk of allocating a large amo=
unt
of memory.
</p><p>
If the
<tt><i>string</i></tt>
argument is given, it specifies a custom line terminator. The
default terminator is
<tt>"\n"</tt>.
The terminator does not have to be one character long.
</p><p>
Freeform does not convert the entire remainder of the input into one big li=
ne
all at once, but does so in a dynamic, lazy fashion, which takes place as t=
he
data is accessed. So at any time, only some prefix of the data exists as a =
flat
line in which newlines are replaced by the terminator string, and the remai=
nder
of the data still remains as a list of lines.
</p><p>
After the subquery is applied to the virtual line, the unmatched remainder
of that line is broken up into multiple lines again, by looking for and
removing all occurrences of the terminator string within the flattened port=
ion.
</p><p>
Care must be taken if the terminator is other than the default
<tt>"\n"</tt>.
All occurrences of the terminator string are treated as line terminators in
the flattened portion of the data, so extra line breaks may be introduced.
Likewise, in the yet unflattened portion, no breaking takes place, even if
the text contains occurrences of the terminator string. The extent of data =
which
is flattened, and the amount of it which remains, depends entirely on the
query line underneath
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a>=
)</tt>.
</p><p>
In the following example, lines of data are flattened using $ as the line
terminator.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freef=
orm</a> "$")
<br>&nbsp;@a$@b:
<br>&nbsp;@c
<br>&nbsp;@d
</tt>

<p>
</p></dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2:3
<br>&nbsp;4
</tt>

<p>
</p></dd><dt>output (<tt>-B</tt>):</dt><dd>
<tt>

&nbsp;a=3D"1"
<br>&nbsp;b=3D"2"
<br>&nbsp;c=3D"3"
<br>&nbsp;d=3D"4"
</tt>

</dd></dl>
<p>

</p><p>
The data is turned into the virtual line
<tt>1$2:3$4$</tt>.
The
<tt>@a$@b:</tt>
subquery matches
the
<tt>1$2:</tt>
portion, binding
<tt>a</tt>
to
<tt>"1"</tt>,
and
<tt>b</tt>
to
<tt>"2"</tt>.
The remaining portion
<tt>3$4$</tt>
is then split into separate lines again according to the line terminator
<tt>$i</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  3
  4
</tt></pre><tt>

</tt>

<p>
Thus the remainder of the query
</p><p>
<tt>
</tt></p><pre><tt>  @c
  @d
</tt></pre><tt>

</tt>

<p>
faces these lines, binding
<tt>c</tt>
to
<tt>3</tt>
and
<tt>d</tt>
to
<tt>4</tt>.
Note that since the data
does not contain dollar signs, there is no ambiguity; the meaning may be
understood in terms of the entire data being flattened and split again.
</p><p>
In the following example,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a></tt>
is used to solve a tokenizing problem.  The
Unix password file has fields separated by colons. Some fields may be empty=
.
Using freeform, we can join the password file using
<tt>":"</tt>

as a terminator.
By restricting freeform to one line, we can obtain each line of the passwor=
d
file with a terminating
<tt>":"</tt>,
allowing for a simple tokenization, because
now the fields are colon-terminated rather than colon-separated.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
056">next</a> "/etc/passwd")
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00334C65">freeform<=
/a> 1 ":")
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)@{to=
ken /[^:]*/}:@(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-03CAE17D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.6">7.3.6<=
/a> The <tt>fuzz</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CAE17D">fuzz</a><=
/tt>
directive allows for an imperfect match spanning a set number of
lines. It takes two arguments, both of which are <b>TXR Lisp</b> expression=
s that should
evaluate to integers:
</p><p>
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CAE17D">fuzz</a> m =
n)=20

<br>&nbsp;&nbsp;...
</tt>

</p><p>
This expresses that over the next
<tt><i>n</i></tt>
query lines, the matching strictness
is relaxed a little bit. Only m out of those n lines have to match.
Afterward, the rest of the query follows normal, strict processing.
</p><p>
In the degenerate situation that there are fewer than n query lines followi=
ng
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CAE17D">fuzz</a><=
/tt>
directive, then m of them must succeed nevertheless. (If there
are fewer than m, then this is impossible.)
</p><p>
<a name=3D"N-02D5D09D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.7">7.3.7<=
/a> The <tt>line</tt> and <tt>chr</tt> directives</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr</a></=
tt>
directives perform binding between the current input line number or charact=
er
position within a line, against an expression or variable:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2D5D09D">line</a> 42)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a> =
x)
  abc@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr</a=
> 3)def@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr<=
/a> y)
</tt></pre><tt>

</tt>

<p>
The directive
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a=
> 42)</tt>
means "match the current input line number against the integer 42". If
the current line is 42, then the directive matches, otherwise it fails.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
is a vertical directive which doesn't consume a line of input. Thus,
the following matches at the beginning of an input stream, and
<tt>x</tt>
ends up bound to the first line of input:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2D5D09D">line</a> 1)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a> =
1)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a> =
1)
  @x
</tt></pre><tt>

</tt>

<p>
The directive
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a=
> x)</tt>
binds variable
<tt>x</tt>
to the current input line number, if
<tt>x</tt>
is an unbound variable. If
<tt>x</tt>
is already bound, then the value of
<tt>x</tt>
must match the current line number, otherwise the directive fails.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr</a></=
tt>
directive is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
except that it's a horizontal directive, and matches the character position
rather than the line position. Character positions are measured from zero,
rather than one.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr</a></=
tt>
does not consume a character. Hence the two occurrences of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr</a></=
tt>
in the following example both match, and
<tt>x</tt>
takes the entire line of input:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2D5D09D">chr</a> 0)@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
D5D09D">chr</a> 0)@x
</tt></pre><tt>

</tt>

<p>
The argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">chr</a></=
tt>
may be an
<tt>@</tt>-delimited
Lisp expression. This is useful for matching computed lines or
character positions:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2D5D09D">line</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007=
C">+</a> a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*=
</a> b c)))
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-01557906">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.8">7.3.8<=
/a> The <tt>name</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
directive performs a binding between the name of the current
data source and a variable or bind expression:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
1557906">name</a> na)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a> =
"data.txt")
</tt></pre><tt>

</tt>

<p>
If
<tt>na</tt>
is an unbound variable, it is bound and takes on the name
of the data source, such as a file name. If
<tt>na</tt>
is bound, then it has to match the name of the data source,
otherwise the directive fails.
</p><p>
The directive
<tt>

@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a> "d=
ata.txt")
</tt>

fails unless the current data source has that name.
</p><p>
<a name=3D"N-03B6EA7D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.9">7.3.9<=
/a> The <tt>data</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6EA7D">data</a><=
/tt>
directive performs a binding between the unmatched data
at the current position, and and a variable or bind expression.
The unmatched data takes the form of a list of strings:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
3B6EA7D">data</a> d)
</tt></pre><tt>

</tt>

<p>
The binding is performed on object equality. If
<tt>d</tt>
is already bound, a matching failure occurs unless
<tt>d</tt>
contains the current unmatched data.
</p><p>
Matching the current data has various uses.
</p><p>
For instance, two branches of pattern matching can, at some point, bind the
current data into different variables. When those paths join, the variables=
 can
be bound together to create the assertion that the current data had been th=
e
same at those points:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
01B">all</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)
  foo
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)
  bar
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6EA7D">data</a=
> x)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)
  xyzzy
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)
  bar
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6EA7D">data</a=
> y)
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a> x y))
</tt></pre><tt>

</tt>

<p>
Here, two branches of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>
match some material which ends in the line
<tt>bar</tt>.
However, it is possible that this is a different line. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6EA7D">data</a><=
/tt>
directives are used to create an assertion that the data regions matched
by the two branches are identical. That is to say, the unmatched data
<tt>x</tt>
captured after the first
<tt>bar</tt>
and the unmatched data
<tt>y</tt>
captured after the second
<tt>bar</tt>
must be the same object in order for
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a>=
 (eq x y))</tt>
to succeed, which implies that the same
<tt>bar</tt>
was matched in both branches of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>.
</p><p>
Another use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6EA7D">data</a><=
/tt>
is simply to gain access to the trailing remainder of the unmatched
input in order to print it, or do some special processing on it.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a=
></tt>
Lisp function is useful for printing the unmatched data as newline-terminat=
ed
lines:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
3B6EA7D">data</a> remainder)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a> remaind=
er))
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-039458F2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.10">7.3.1=
0</a> The <tt>some</tt>, <tt>all</tt>, <tt>none</tt>, <tt>maybe</tt>, <tt>c=
ases</tt> and <tt>choose</tt> directives</h4>



<p>
These directives, called the parallel directives, combine multiple subqueri=
es,
which are applied at the same input position, rather than to consecutive in=
put.
</p><p>
They come in vertical (line mode) and horizontal (character mode) flavors.
</p><p>
In horizontal mode, the current position is understood to be a character
position in the line being processed. The clauses advance this character
position by moving it to the right.  In vertical mode, the current position=
 is
understood to be a line of text within the stream. A clause advances the
position by some whole number of lines.
</p><p>
The syntax of these parallel directives follows this example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
077">some</a>)
  subquery1
  .
  .
  .
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)
  subquery2
  .
  .
  .
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)
  subquery3
  .
  .
  .
  @(end)
</tt></pre><tt>

</tt>

<p>
And in horizontal mode:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
077">some</a>)subquery1...@(<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-0049">and</a>)subquery2...@(<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#D-0049">and</a>)subquery3...@(end)
</tt></pre><tt>

</tt>

<p>
Long horizontal lines can be broken up with line continuations, allowing th=
e
above example to be written like this, which is considered a single logical
line:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
077">some</a>)@\
     subquery1...@\
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)@\
     subquery2...@\
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)@\
     subquery3...@\
  @(end)
</tt></pre><tt>

</tt>

<p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</=
a>)</tt>
or
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">choose<=
/a>)</tt>
must be followed
by at least one subquery clause, and be terminated by
<tt>@(end)</tt>.
If there are two
or more subqueries, these additional clauses are indicated by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)</t=
t>
or
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)</tt=
>,
which are interchangeable.  The separator and terminator directives also mu=
st
appear as the only element in a query line.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">choose</a=
></tt>
directive requires keyword arguments. See below.
</p><p>
The syntax supports arbitrary nesting. For example:
</p><p>
<tt>
</tt></p><pre><tt>  QUERY:            SYNTAX TREE:

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)     =
       all -+
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)              +- skip -+
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)  =
            |        +- some -+
  it                     |        |        +- TEXT
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)   =
            |        |        +- and
  @    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)=
            |        |        +- none -+
  was                    |        |        |        +- TEXT
  @    (end)             |        |        |        +- end
  @  (end)               |        |        +- end
  a dark                 |        +- TEXT
  @(end)                 *- end
</tt></pre><tt>

</tt>

<p>
nesting can be indicated using whitespace between
<tt>@</tt>
and the
directive expression. Thus, the above is an
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>
query containing a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>
clause which applies to a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
that is followed by the text line
<tt>"a dark"</tt>.
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
clause combines the text line
<tt>"it"</tt>,
and a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>
clause which contains just one clause consisting of the line
<tt>"was"</tt>.
</p><p>
The semantics of the parallel directives is:
</p><p>
</p><dl class=3D"items">
<dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>=
)</tt></dt><dd>

Each of the clauses is matched at the current position. If any of the
clauses fails to match, the directive fails (and thus does not produce
any variable bindings). Clauses following the failed directive are not
evaluated. Bindings extracted by a successful clause are visible to the cla=
uses
which follow, and if the directive succeeds, all of the combined bindings
emerge.
<p>



</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077=
">some</a> [ :resolve (<tt><i>var</i></tt><tt> ...) ]) </tt></tt></dt><dd>



Each of the clauses is matched at the current position. If any of the claus=
es
succeed, the directive succeeds, retaining the bindings accumulated by the
successfully matching clauses.  Evaluation does not stop on the first succe=
ssful
clause. Bindings extracted by a successful clause are visible to the clause=
s
which follow.
<p>
The
<tt>:resolve</tt>
parameter is for situations when the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
directive has
multiple clauses that need to bind some common variables to different
values: for instance, output parameters in functions. Resolve takes
a list of variable name symbols as an argument.  This is called the
resolve set. If the clauses of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
bind variables in the resolve
set, those bindings are not visible to later clauses.  However, those
bindings do emerge out of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
directive as a whole.
This creates a conflict: what if two or more clauses introduce
different bindings for a variable in the resolve set?
This is why it is called the resolve set: conflicts for variables in the
resolve set are automatically resolved in favor of later directives.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
077">some</a> :resolve (x))
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> a =
"a")
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> x =
"x1")
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> b =
"b")
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> x =
"x2")
  @(end)
</tt></pre><tt>

</tt>

<p>
Here, the two clauses both introduce a binding for
<tt>x</tt>.
Without the
<tt>:resolve</tt>
parameter, this would mean that the second clause fails, because
<tt>x</tt>
comes in
with the value
<tt>"x1"</tt>,
which does not bind with
<tt>"x2"</tt>.
But because
<tt>x</tt>
is placed
into the resolve set, the second clause does not see the=20
<tt>"x1"</tt>

binding. Both
clauses establish their bindings independently creating a conflict over
<tt>x</tt>.
The conflict is resolved in favor of the second clause, and so the bindings
which emerge from the directive are:
</p><p>
<tt>
</tt></p><pre><tt>  a=3D"a"
  b=3D"b"
  x=3D"x2"
</tt></pre><tt>

</tt>

<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054=
">none</a>)</tt></dt><dd>

Each of the clauses is matched at the current position. The
directive succeeds only if all of the clauses fail. If
any clause succeeds, the directive fails, and subsequent clauses are not
evaluated. Thus, this directive never produces variable bindings, only matc=
hing
success or failure.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394=
58F2">maybe</a>)</tt></dt><dd>

Each of the clauses is matched at the current position.  The directive alwa=
ys
succeeds, even if all of the clauses fail.  Whatever bindings are found in =
any
of the clauses are retained. Bindings extracted by any successful clause ar=
e
visible to the clauses which follow.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394=
58F2">cases</a>)</tt></dt><dd>

Each of the clauses is matched at the current position.
The clauses are matched, in order, at the current position.
If any clause matches, the matching stops and the bindings
collected from that clause are retained. Any remaining clauses
after that one are not processed. If no clause matches, the
directive fails, and produces no bindings.
<p>



</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394=
58F2">choose</a> [ :longest <tt><i>var</i></tt><tt> | :shortest </tt><tt><i=
>var</i></tt><tt> ]) </tt></tt></dt><dd>



Each of the clauses is matched at the current position in order. In this
construct, bindings established by an earlier clause are not visible to lat=
er
clauses.  Although any or all of the clauses can potentially match, the cla=
use
which succeeds is the one which maximizes or minimizes the length of the
text bound to the specified variable. The other clauses have no effect.
<p>
For all of the parallel directives other than
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">choose<=
/a>)</tt>,
the query
advances the input position by the greatest number of lines that match in a=
ny
of the successfully matching subclauses that are evaluated.  The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a>)</=
tt>
directive does not advance the input position.
</p><p>
For instance if there are two subclauses, and one of them matches three lin=
es,
but the other one matches five lines, then the overall clause is considered=
 to
have made a five line match at its position. If more directives follow, the=
y
begin matching five lines down from that position.
</p><p>
</p></dd></dl>
<a name=3D"N-0222EE5F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.11">7.3.11</a=
> The <tt>require</tt> directive</h4>



<p>
The syntax of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a>=
)</tt>
is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075"=
>require</a> </tt><tt><i>lisp-expression</i></tt><tt>)=20

</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a></=
tt>
directive evaluates a <b>TXR Lisp</b> expression. (See TXR LISP far
below.) If the expression yields a true value, then it succeeds, and matchi=
ng
continues with the directives which follow. Otherwise the directive fails.
</p><p>
In the context of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a></=
tt>
directive, the expression should not be introduced by the
<tt>@</tt>
symbol; it is expected to be a Lisp expression.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @; require that 4 is greater than 3
  @; This succeeds; therefore, @a is processed
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a> (=
&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2) =
3))
  @a
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-03AE2765">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.12">7.3.1=
2</a> The <tt>if</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive allows for conditional selection of pattern matching clauses,
based on the Boolean results of Lisp expressions.
</p><p>
A variant of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive is also available for use inside an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
clauses, where it similarly allows for the conditional selection of output
clauses.
</p><p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive can be exemplified as follows:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039"=
>if</a> </tt><tt><i>lisp-expr</i></tt><tt>)=20

<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.



<br>&nbsp;&nbsp;@(elif </tt><tt><i>lisp-expr</i></tt><tt>)=20

<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.



<br>&nbsp;&nbsp;@(elif </tt><tt><i>lisp-expr</i></tt><tt>)=20

<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;@(else)
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;@(end)
</tt>

</p><p>
The
<tt>@(elif)</tt>
and
<tt>@(else)</tt>
clauses are all optional. If
<tt>@(else)</tt>
is present, it must be
last, before
<tt>@(end)</tt>,
after any
<tt>@(elif)</tt>
clauses. Any of the clauses may be empty.
</p><p>
</p><dl>
<dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
039">if</a> (&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006=
">length</a> str) 42))
  foo: @a @b
  @(else)
  {@c}
  @(end)
</tt></pre><tt>

</tt>

<p>
In this example, if the length of the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
is greater than
<tt>42</tt>,
then matching continues with
<tt>"foo: @a b"</tt>,
otherwise it proceeds with
<tt>{@c}</tt>.
</p></dd></dl>
<p>

More precisely, how the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive works is as follows. The Lisp expressions are evaluated in order,
starting with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
expression, then the
<tt>elif</tt>
expressions if any are present. If any Lisp expression yields a true result
(any value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>)
then evaluation of Lisp expressions stops. The corresponding clause of that
Lisp expression is selected and pattern matching continues
with that clauses. The result of that clause (its success or failure,
and any newly bound variables) is then taken as the result of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive. If none of the Lisp expressions yield true, and an
<tt>else</tt>
clause is present, then that clause is processed and its result determines
the result of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive. If none of the Lisp expressions
yield true, and there is no
<tt>else</tt>
clause, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive is deemed to have trivially succeeded, allowing matching to conti=
nue
with whatever directive follows it.
</p><p>

<a name=3D"N-03DC6E54">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.13">7.3.1=
3</a> The Lisp <tt>if</tt> versus TXR <tt>if</tt></h4>



<p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
directive supports the embedding of Lisp expressions, whose values are
interpolated into the output. In particular, Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
expressions are useful. For instance
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> expr=
 "A" "B")</tt>
reproduces
<tt>A</tt>
if
<tt>expr</tt>
yields a true value, otherwise
<tt>B</tt>.
Yet the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a>)</tt=
>
directive is also supported in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>.
How the apparent conflict between the two is resolved is that the two take
different numbers of arguments. An
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a>)</tt=
>
which has no arguments at all is a syntax error. One that has one argument
is the head of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive syntax which must be terminated by
<tt>@(end)</tt>
and which takes the optional
<tt>@(elif)</tt>
and
<tt>@(else)</tt>
clauses. An
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a>)</tt=
>
which has two or more arguments is parsed as a self-contained Lisp expressi=
on.
</p><p>
<a name=3D"N-01410000">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.14">7.3.1=
4</a> The <tt>gather</tt> directive</h4>



<p>
Sometimes text is structured as items that can appear in an arbitrary order=
.
When multiple matches need to be extracted, there is a combinatorial explos=
ion
of possible orders, making it impractical to write pattern matches for all
the possible orders.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
directive is for these situations. It specifies multiple clauses
which all have to match somewhere in the data, but in any order.
</p><p>
For further convenience, the lines of the first clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
directive
are implicitly treated as separate clauses.
</p><p>
The syntax follows this pattern
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
04D">gather</a>)
  one-line-query1
  one-line-query2
  .
  .
  .
  one-line-queryN
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)
  multi
  line
  query1
  .
  .
  .
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)
  multi
  line
  query2
  .
  .
  .
  @(end)
</tt></pre><tt>

</tt>

<p>
The multi-line clauses are optional.   The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
directive takes
keyword parameters, see below.
</p><p>

<a name=3D"N-01AADEFA">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.15">7.3.1=
5</a> The <tt>until</tt> / <tt>last</tt> clause in <tt>gather</tt></h4>



<p>
Similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
has an optional
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
04D">gather</a>)
  ...
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)
  ...
  @(end)
</tt></pre><tt>

</tt>

<p>
How gather works is that the text is searched for matches for the single li=
ne
and multi-line queries. The clauses are applied in the order in which they =
appear.
Whenever one of the clauses matches, any bindings it produces are retained =
and
it is removed from further consideration. Multiple clauses can match at the
same text position.  The position advances by the longest match from among =
the
clauses which matched.  If no clauses match, the position advances by one l=
ine.
The search stops when all clauses are eliminated, and then the cumulative
bindings are produced.  If the data runs out, but unmatched clauses remain,=
 the
directive fails.
</p><p>
Example: extract several environment variables, which do not appear in a pa=
rticular
order:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
056">next</a> :env)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a>)
  USER=3D@USER
  HOME=3D@HOME
  SHELL=3D@SHELL
  @(end)
</tt></pre><tt>

</tt>

<p>
If the until or last clause is present and a match occurs, then the matches
from the other clauses are discarded and the gather terminates. The differe=
nce
between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
is that any bindings bindings established in last are
retained, and the input position is advanced past the matched material.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause has visibility to bindings established in the
previous clauses in that same iteration, even though those bindings
end up thrown away.
</p><p>
For consistency, the
<tt>:mandatory</tt>
keyword is supported in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>.
The semantics of using
<tt>:mandatory</tt>
in this situation is tricky. In particular, if it is in effect, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
terminates successfully by collecting all required matches, it will
trigger a failure. On the other hand, if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></tt>
clause activates before all required matches are gathered, a failure
also occurs, whether or not the clause is
<tt>:mandatory</tt>.
</p><p>
Meaningful use of
<tt>:mandatory</tt>
requires that the gather be open-ended; it must allow some (or all) variabl=
es
not to be required. The presence of the option means that for the gather
to succeed, all required variables must be gathered first, but then termina=
tion
must be achieved via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause before all gather clauses are satisfied.
</p><p>

<a name=3D"N-03CE85EA">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.16">7.3.1=
6</a> Keyword parameters in <tt>gather</tt></h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
directive accepts the keyword parameter
<tt>:vars</tt>.
The argument to
<tt>:vars</tt>
is a list of required and optional variables. A required variable is specif=
ied
as a symbol. An optional variable is specified as a two element list which
pairs a symbol with a Lisp expression. That Lisp expression is evaluated
and specifies the default value for the variable.
<p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
04D">gather</a> :vars (a b c (d "foo")))
  ...
  @(end)
</tt></pre><tt>

</tt>

<p>
Here,
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>
are required variables, and
<tt>d</tt>
is optional, with the default value given by the Lisp expression
<tt>"foo"</tt>.
</p><p>
The presence of
<tt>:vars</tt>
changes the behavior in three ways.
</p><p>
Firstly, even if all the clauses in the gather match successfully and are
eliminated, the directive will fail if the required variables do not have
bindings. It doesn't matter whether the bindings are existing, or whether t=
hey
are established by the gather.
</p><p>
Secondly, if some of the clauses of the gather did not match, but all
of the required variables have bindings, then the directive succeeds.
Without the presence of
<tt>:vars</tt>,
it would fail in this situation.
</p><p>
Thirdly, if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
succeeds (all required variables have bindings),
then all of the optional variables which do not have bindings are given
bindings to their default values.
</p><p>
The expressions which give the default values are evaluated whenever
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004D">gather</a></t=
t>
directive is evaluated, whether or not their values are used.
</p><p>
<a name=3D"N-016E0310">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.17">7.3.1=
7</a> The <tt>collect</tt> directive</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
directive is:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  ... lines of subquery
  @(end)
</tt></pre><tt>

</tt>

<p>
or with an until or last clause:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  ... lines of subquery: main clause
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)
  ... lines of subquery: until clause
  @(end)

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>)
  ... lines of subquery: main clause
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)
  ... lines of subquery: last clause
  @(end)
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
symbol may be specified instead of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>,
which changes the meaning, see below:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
052">repeat</a>)
  ... lines of subquery
  @(end)
</tt></pre><tt>

</tt>

<p>
The subquery is matched repeatedly, starting at the current line.
If it fails to match, it is tried starting at the subsequent line.
If it matches successfully, it is tried at the line following the
entire extent of matched data, if there is one. Thus, the collected regions=
 do
not overlap. (Overlapping behavior can be obtained: see the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>
directive).
</p><p>
Unless certain keywords are specified, or unless the collection is explicit=
ly
failed with
<tt>@(fail)</tt>,
it always succeeds, even if it collects nothing,
and even if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause never finds a match.
</p><p>
If no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
last clause is specified, and the collect is not limited
using parameters, the collection is unbounded: it consumes the entire data
file.
</p><p>

<a name=3D"N-014CE43D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.18">7.3.1=
8</a> The <tt>until</tt> / <tt>last</tt> clause in <tt>collect</tt></h4>



<p>
If an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
last clause is specified, the collection stops when that clause
matches at the current position.
</p><p>
If an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>
clause terminates collect, no bindings are collected at that
position, even if the main clause matches at that position also. Moreover, =
the
position is not advanced.  The remainder of the query begins matching at th=
at
position.
</p><p>
If a last clause terminates collect, the behavior is different. Any binding=
s
captured by the main clause are thrown away, just like with the until claus=
e.
However, the bindings in the last clause itself survive, and the position i=
s
advanced to skip over that material.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</=
a>)
<br>&nbsp;@a
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until=
</a>)
<br>&nbsp;42
<br>&nbsp;@b
<br>&nbsp;@(end)
<br>&nbsp;@c
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
<br>&nbsp;42
<br>&nbsp;5
<br>&nbsp;6
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;c=3D"42"
</tt>

</dd></dl>
<p>

</p><p>
The line
<tt>42</tt>
is not collected, even though it matches
<tt>@a</tt>.
Furthermore,
the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)<=
/tt>
does not advance the position, so variable
<tt>c</tt>
takes
<tt>42</tt>.
</p><p>
If the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)<=
/tt>
is changed to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)</=
tt>
the output will be different:
</p><dl class=3D"items">
<dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;b=3D"5"
<br>&nbsp;c=3D"6"
</tt>

</dd></dl>
<p>

</p><p>
The
<tt>42</tt>
is not collected into the a list, just like before. But now
the binding captured by
<tt>@b</tt>
emerges. Furthermore, the position advances
so variable now takes
<tt>6</tt>.
</p><p>
The binding variables within the clause of a collect are treated specially.
The multiple matches for each variable are collected into lists,
which then appear as array variables in the final output.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</=
a>)
<br>&nbsp;@a:@b:@c
<br>&nbsp;@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;John:Doe:101
<br>&nbsp;Mary:Jane:202
<br>&nbsp;Bob:Coder:313
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"John"
<br>&nbsp;a[1]=3D"Mary"
<br>&nbsp;a[2]=3D"Bob"
<br>&nbsp;b[0]=3D"Doe"
<br>&nbsp;b[1]=3D"Jane"
<br>&nbsp;b[2]=3D"Coder"
<br>&nbsp;c[0]=3D"101"
<br>&nbsp;c[1]=3D"202"
<br>&nbsp;c[2]=3D"313"
</tt>

</dd></dl>
<p>

</p><p>
The query matches the data in three places, so each variable becomes
a list of three elements, reported as an array.
</p><p>
Variables with list bindings may be referenced in a query. They denote a
multiple match. The
<tt>-D</tt>
command line option can establish a one-dimensional
list binding.
</p><p>
The clauses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
may be nested.   Variable matches collated into lists in an
inner collect, are again collated into nested lists in the outer collect.
Thus an unbound variable wrapped in N nestings of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
will
be an N-dimensional list. A one dimensional list is a list of strings;
a two dimensional list is a list of lists of strings, etc.
</p><p>
It is important to note that the variables which are bound within the main
clause of a collect. That is, the variables which are subject to
collection appear, within the collect, as normal one-value bindings. The
collation into lists happens outside of the collect. So for instance in the
query:
</p><p>
<tt>

<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@x=3D@x
<br>&nbsp;@(end)
</tt>

</p><p>
The left
<tt>@x</tt>
establishes a binding for some material preceding an equal sign.
The right
<tt>@x</tt>
refers to that binding. The value of
<tt>@x</tt>
is different in each
iteration, and these values are collected. What finally comes out of the
collect clause is a single variable called
<tt>x</tt>
which holds a list containing each value that
was ever instantiated under that name within the collect clause.
</p><p>
Also note that the until clause has visibility over the bindings
established in the main clause. This is true even in the terminating
case when the until clause matches, and the bindings of the main clause
are discarded.
</p><p>

<a name=3D"N-037F7135">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.19">7.3.1=
9</a> Keyword parameters in <tt>collect</tt></h4>



By default,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
searches the rest of the input indefinitely,
or until the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause matches. It skips arbitrary amounts of
nonmatching material before the first match, and between matches.
<p>
Within the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
syntax, it is possible to specify keyword
parameters for additional control of the behavior. A keyword parameter
consist of a keyword symbol followed by an argument, enclosed within
the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
syntax. The following are the supported keywords.
</p><p>



</p><dl class=3D"items">
<dt><tt>:maxgap <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



The
<tt>:maxgap</tt>
keyword takes a numeric argument
<tt><i>n</i></tt>,
which is a Lisp expression.
It causes the collect to terminate
if it fails to find a match after skipping
<tt><i>n</i></tt>
lines from the starting position,
or more than
<tt><i>n</i></tt>
lines since any successful match. For example,
<p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :maxgap 5)
</tt></pre><tt>

</tt>

<p>
specifies that the gap between the current position and the first
match for the body of the collect, or between consecutive matches
can be no longer than five lines. A
<tt>:maxgap</tt>
value of
<tt>0</tt>
means that the collected regions must be
adjacent and must match right from the starting position. For instance:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :maxgap 0)
  M @a
  @(end)
</tt></pre><tt>

</tt>

<p>
means: from here, collect consecutive lines of the form
<tt>"M ..."</tt>.
This will not
search for the first such line, nor will it skip lines which do not match t=
his
form.
</p><p>



</p></dd><dt><tt>:mingap <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



The
<tt>:mingap</tt>
keyword complements
<tt>:maxgap</tt>,
though not exactly. Its argument
<tt><i>n</i></tt>,
a Lisp expression, specifies a minimum number
of lines which must separate consecutive matches. However, it has no effect=
 on
the distance from the starting position to the first match.
<p>



</p></dd><dt><tt>:gap <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



The
<tt>:gap</tt>
keyword effectively specifies
<tt>:mingap</tt>
and
<tt>:maxgap</tt>
at the same time, and can only be
used if these other two are not used. Thus:
<p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :gap 1)
  @a
  @(end)
</tt></pre><tt>

</tt>

<p>
means: collect every other line starting with the current line.
</p><p>



</p></dd><dt><tt>:times <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



This shorthand means the same thing as if



</dd><dt><tt>:mintimes <tt><i>n</i></tt><tt> :maxtimes </tt><tt><i>n</i></t=
t><tt> </tt></tt></dt><dd>



were specified.  This means that exactly
<tt><i>n</i></tt>
matches must occur. If fewer occur, then the collect fails.
Collect stops once it achieves
<tt>n</tt>
matches.
<p>



</p></dd><dt><tt>:mintimes <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



The argument
<tt><i>n</i></tt>
of the
<tt>:mintimes</tt>
keyword is a Lisp expression which specifies that at least
<tt><i>n</i></tt>
matches must occur, or else the collect fails.
<p>



</p></dd><dt><tt>:mintimes <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



The Lisp argument expression
<tt><i>n</i></tt>
of the
<tt>:mintimes</tt>
keyword specifies that at most
<tt><i>n</i></tt>
matches are collected.
<p>



</p></dd><dt><tt>:lines <tt><i>n</i></tt><tt> </tt></tt></dt><dd>



The argument
<tt><i>n</i></tt>
of the
<tt>:lines</tt>
keyword parameter
is a Lisp expression which specifies the upper bound on how many lines
should be scanned by collect, measuring from the starting position.
The extent of the collect body is not counted. Example:
<p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :lines 2)
  foo: @a
  bar: @b
  baz: @c
  @(end)
</tt></pre><tt>

</tt>

<p>
The above
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
will look for a match only twice: at the current position,
and one line down.
</p><p>



</p></dd><dt><tt>:vars ({<tt><i>variable</i></tt><tt> | (</tt><tt><i>variab=
le</i></tt><tt> </tt><tt><i>default-value)}*)</i></tt><tt> </tt></tt></dt><=
dd>



The
<tt>:vars</tt>
keyword specifies a restriction on what variables will emanate
from the collect. Its argument is a list of variable
names. An empty list may be specified using empty parentheses
or, equivalently, the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt><i>default-value</i></tt>
element of the syntax is a Lisp expression.
The behavior of the
<tt>:vars</tt>
keyword is specified in the following section, "Specifying variables in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>".
<p>



</p></dd><dt><tt>:lists (<tt><i>variable</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:lists</tt>
keyword indicates a list of variables. After the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
terminates, each
<tt><i>variable</i></tt>
in the list which does not have a binding is bound to the empty
list symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Unlike
<tt>:vars</tt>
the
<tt>:lists</tt>
mechanism doesn't assert that only the listed variables may emanate
from the collect. It also doesn't assert that each iteration of the
collect must bind each of those variables.
<p>



</p></dd><dt><tt>:counter {<tt><i>variable</i></tt><tt> | (</tt><tt><i>vari=
able</i></tt><tt> </tt><tt><i>starting-value</i></tt><tt>)} </tt></tt></dt>=
<dd>



The
<tt>:counter</tt>
keyword's argument is a variable name symbol,
or a compound expression consisting of a variable name symbol
and the <b>TXR Lisp</b> expression
<tt><i>starting-value</i></tt>.
If this keyword argument is specified, then a binding for
<tt><i>variable</i></tt>
is established prior to each repetition of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
body, to an integer value representing the repetition count.
By default, repetition counts begin at zero.
If
<tt><i>starting-value</i></tt>
is specified, it must evaluate to a number. This number is
then added to each repetition count, and
<tt><i>variable</i></tt>
takes on the resulting displaced value.
<p>
If there is an existing binding for
<tt><i>variable</i></tt>
prior to the processing of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>,
then the variable is shadowed.
</p><p>
The binding is collected in the same way as other bindings
that are established in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
body.
</p><p>
The repetition count only increments after a successful match.
</p><p>
The
<tt>variable</tt>
is visible to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>'s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause. If that clause is being processed after a successful match
of the body, then
<tt><i>variable</i></tt>
holds an integer value. If the body fails to match, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause sees a binding for
<tt>variable</tt>
with a value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p></dd></dl>
<p>

</p><p>

<a name=3D"N-020EDAFF">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.20">7.3.2=
0</a> Specifying variables in <tt>collect</tt></h4>



Normally, any variable for which a new binding occurs in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
block is collected. A collect clause may be "sloppy": it can neglect to col=
lect
some variables on some iterations, or bind some variables which are intende=
d to
behave like local temporaries, but end up collated into lists. Another issu=
e is
that the collect clause might not match anything at all, and then none of t=
he
variables are bound.
<p>
The
<tt>:vars</tt>
keyword allows the query writer to add discipline the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
body.
</p><p>
The argument to
<tt>:vars</tt>
is a list of variable specs. A variable spec is either a
symbol, denoting a required variable, or a
<tt>




(</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>default-value</i></tt><tt>)=20

</tt>

pair, where
<tt><i>default-value</i></tt>
is a Lisp expression whose value specifies a default value
for the variable, which is optional.
</p><p>
When a
<tt>:vars</tt>
list is specified, it means that only the given variables can
emerge from the successful collect. Any newly introduced bindings for other
variables do not propagate. More precisely,  whenever the collect body matc=
hes
successfully, the following three rules apply:
</p><dl class=3D"items">
<dt>1.</dt><dd>
If
<tt>:vars</tt>
specifies required variables, the collect body must bind all of them,
or else must not bind any variable at all, whether listed in
<tt>:vars</tt>
or not, otherwise an exception of type
<tt>query-error</tt>
is thrown.
</dd><dt>2.</dt><dd>
If
<tt>:vars</tt>
specifies required variables, and also specifies default variables,
and the collect body binds no variable at all, then the default variables
are not bound to their default values.
</dd><dt>3.</dt><dd>
If
<tt>:vars</tt>
specifies optional variables, and all required variables are bound by
the collect body, then all those optional variables that are not bound
by the collect body are bound to their default values. Under this rule, if
<tt>:vars</tt>
specifies no required variables, that is deemed to be
logically equivalent to all required variables being bound.
</dd></dl>
<p>

</p><p>
In the event that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
does not match anything, the variables
specified in
<tt>:vars</tt>,
whether required or optional, are all bound to
empty lists. These bindings are established after the processing of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
last clause, if present.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :vars (a b (c "foo")))
  @a @c
  @(end)
</tt></pre><tt>

</tt>

<p>
Here, if the body
<tt>"@a @c"</tt>

matches, an error will be thrown because one of the
mandatory variables is
<tt>b</tt>,
and the body neglects to produce a binding for
<tt>b</tt>.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :vars (a (c "foo")))
  @a @b
  @(end)
</tt></pre><tt>

</tt>

<p>
Here, if
<tt>"@a @b"</tt>

matches, only
<tt>a</tt>
will be collected, but not
<tt>b</tt>,
because
<tt>b</tt>
is not
in the variable list. Furthermore, because there is no binding for
<tt>c</tt>
in the
body, a binding is created with the value
<tt>"foo"</tt>,
exactly as if
<tt>c</tt>
matched
such a piece of text.
</p><p>
In the following example, the assumption is that
<tt>THIS NEVER MATCHES</tt>
is not found anywhere in the input but the line
<tt>THIS DOES MATCH</tt>
is found and has a successor which is bound to
<tt>a</tt>.
Because the body did not
match, the
<tt>:vars</tt>
<tt>a</tt>
and
<tt>b</tt>
should be bound to empty lists. But
<tt>a</tt>
is bound by the last clause to some text, so this takes precedence. Only
<tt>b</tt>
is bound to an empty list.
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :vars (a b))
  THIS NEVER MATCHES
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)
  THIS DOES MATCH
  @a
  @(end)
</tt></pre><tt>

</tt>

<p>
The following means: do not allow any variables to propagate out of any
iteration of the collect and therefore collect nothing:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a> :vars nil)
  ...
  @(end)
</tt></pre><tt>

</tt>

<p>
Instead of writing
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
 :vars nil)</tt>,
it is possible to write
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>.
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>
takes all collect keywords, except for
<tt>:vars</tt>.
There is a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>
directive used in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
clauses; that is a different directive.
</p><p>

<a name=3D"N-025D542C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.21">7.3.2=
1</a> Mandatory <tt>until</tt> and <tt>last</tt></h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause supports the option keyword
<tt>:mandatory</tt>,
exemplified by the following:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  ...
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a> :man=
datory)
  ...
  @(end)
</tt></pre><tt>

</tt>

<p>
This means that the collect
<b>must</b>

be terminated by a match for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause, or else by an explicit
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>.
</p><p>
Specifically, the collect cannot terminate due to simply running out of dat=
a,
or exceeding a limit on the number of matches that may be collected. In
those situations, if an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></tt>
clause is present with
<tt>:mandatory</tt>,
the collect is deemed to have failed.
</p><p>
<a name=3D"N-031B6F7D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.22">7.3.2=
2</a> The <tt>coll</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
directive is the horizontal version of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>.
Whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
works with multi-line clauses on line-oriented
material,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
works within a single line. With
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>=
,
it is possible to
recognize repeating regularities within a line and collect lists.
</p><p>
Regular-expression based Positive Match variables work well with coll.
</p><p>
Example: collect a comma-separated list, terminated by a space.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@{A /[^, ]+/}@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">un=
til</a>) @(end)@B
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;foo,bar,xyzzy blorch
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;A[0]=3D"foo"
<br>&nbsp;A[1]=3D"bar"
<br>&nbsp;A[2]=3D"xyzzy"
<br>&nbsp;B=3Dblorch
</tt>

</dd></dl>
<p>

</p><p>
Here, the variable
<tt>A</tt>
is bound to tokens which match the regular
expression
<tt>/[^, ]+/</tt>:
non-empty sequence of characters other than commas or
spaces.
</p><p>
Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
searches for matches.  If no match
occurs at the current character position, it tries at the next character
position. Whenever a match occurs, it continues at the character position w=
hich
follows the last character of the match, if such a position exists.
</p><p>
If not bounded by an until clause, it will exhaust the entire line.  If the
until clause matches, then the collection stops at that position,
and any bindings from that iteration are discarded.
Like collect, coll also supports an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause, which propagates variable
bindings and advances the position. The
<tt>:mandatory</tt>
keyword is supported.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
clauses nest, and variables bound within a coll are available to clauses
within the rest of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
clause, including the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></t=
t>
clause, and appear as
single values. The final list aggregation is only visible after the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
clause.
</p><p>
The behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
leads to difficulties when a delimited variable are used
to match material which is delimiter separated rather than terminated.
For instance, entries in a comma-separated files usually do
not appear as
<tt>"a,b,c,"</tt>

but rather
<tt>"a,b,c"</tt>.
</p><p>
So for instance, the following result is not satisfactory:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@a @(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1 2 3 4 5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;a[3]=3D"4"
</tt>

</dd></dl>
<p>

</p><p>
The
<tt>5</tt>
is missing because it isn't followed by a space, which the text-delimited
variable match
<tt>"@a "</tt>

looks for.  After matching "4 ", coll continues to look for
matches, and doesn't find any.  It is tempting to try to fix it like this:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@a@/ ?/@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1 2 3 4 5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D""
<br>&nbsp;a[1]=3D""
<br>&nbsp;a[2]=3D""
<br>&nbsp;a[3]=3D""
<br>&nbsp;a[4]=3D""
<br>&nbsp;a[5]=3D""
<br>&nbsp;a[6]=3D""
<br>&nbsp;a[7]=3D""
<br>&nbsp;a[8]=3D""
</tt>

</dd></dl>
<p>

</p><p>
The problem now is that the regular expression
<tt>/ ?/</tt>
(match either a space or nothing), matches at any position.
So when it is used as a variable
delimiter, it matches at the current position, which binds the empty string=
 to
the variable, the extent of the match being zero. In this situation, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
directive proceeds character by character. The solution is to use
positive matching: specify the regular expression which matches the item,
rather than a trying to match whatever follows.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
directive will
recognize all items which match the regular expression:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@{a /[^ ]+/}@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1 2 3 4 5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;a[3]=3D"4"
<br>&nbsp;a[4]=3D"5"
</tt>

</dd></dl>
<p>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>
clause can specify a pattern which, when recognized, terminates
the collection. So for instance, suppose that the list of items may
or may not be terminated by a semicolon. We must exclude
the semicolon from being a valid character inside an item, and
add an until clause which recognizes a semicolon:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@{a /[^ ;]+/}@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">un=
til</a>);@(end);
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1 2 3 4 5;
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;a[3]=3D"4"
<br>&nbsp;a[4]=3D"5"
</tt>

</dd></dl>
<p>

</p><p>
Whether followed by the semicolon or not, the items are collected properly.
</p><p>
Note that the
<tt>@(end)</tt>
is followed by a semicolon. That's because
when the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)<=
/tt>
clause meets a match, the matching material
is not consumed.
</p><p>
This repetition can be avoided by using
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)</=
tt>
instead of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)<=
/tt>
since
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)</=
tt>
consumes the terminating material.
</p><p>
Instead of the above regular-expression-based approach, this extraction pro=
blem
can also be solved with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</a>=
</tt>:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</a>)@=
a @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)@a@(en=
d)@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1 2 3 4 5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;a[3]=3D"4"
<br>&nbsp;a[4]=3D"5"
</tt>

</dd></dl>
<p>

</p><p>

<a name=3D"N-0357BB7E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.23">7.3.2=
3</a> Keyword parameters in <tt>coll</tt></h4>



The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)</=
tt>
directive takes most of the same parameters as
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>.
See the section Keyword parameters in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
above.
So for instance
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a> :g=
ap 0)</tt>
means that the collects must be
consecutive, and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a> :m=
axtimes 2)</tt>
means that at most two matches
will be collected.  The
<tt>:lines</tt>
keyword does not exist, but there is
an analogous
<tt>:chars</tt>
keyword.
<p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)</=
tt>
directive takes the
<tt>:vars</tt>
keyword.
</p><p>
The shorthand
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
may be used instead of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a> :v=
ars nil)</tt>.
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
takes all keywords, except
<tt>:vars</tt>.
</p><p>
<a name=3D"N-02BF4BBC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.24">7.3.2=
4</a> The <tt>flatten</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a></=
tt>
directive can be used to convert variables to one dimensional
lists. Variables which have a scalar value are converted to lists containin=
g
that value. Variables which are multidimensional lists are flattened to
one-dimensional lists.
</p><p>
Example (without
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a>=
)</tt>)
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@b
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@a
<br>&nbsp;@(end)
<br>&nbsp;@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;0
<br>&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
<br>&nbsp;4
<br>&nbsp;5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;b=3D"0"
<br>&nbsp;a_0[0]=3D"1"
<br>&nbsp;a_1[0]=3D"2"
<br>&nbsp;a_2[0]=3D"3"
<br>&nbsp;a_3[0]=3D"4"
<br>&nbsp;a_4[0]=3D"5"
</tt>

</dd></dl>
<p>

</p><p>
Example (with
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a>=
)</tt>):
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@b
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@a
<br>&nbsp;@(end)
<br>&nbsp;@(end)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatt=
en</a>&nbsp;a&nbsp;b)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;0
<br>&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
<br>&nbsp;4
<br>&nbsp;5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;b=3D"0"
<br>&nbsp;a[0]=3D"1"
<br>&nbsp;a[1]=3D"2"
<br>&nbsp;a[2]=3D"3"
<br>&nbsp;a[3]=3D"4"
<br>&nbsp;a[4]=3D"5"
</tt>

</dd></dl>
<p>

</p><p>
</p><p>
<a name=3D"N-0252B14E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.25">7.3.2=
5</a> The <tt>merge</tt> directive</h4>



<p>
The syntax of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a></tt=
>
follows the pattern:
</p><p>
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a> </tt>=
<tt><i>destination</i></tt><tt> [</tt><tt><i>sources</i></tt><tt> ...])=20

</tt>

</p><p>
<tt><i>destination</i></tt>
is a variable, which receives a new binding.
<tt><i>sources</i></tt>
are bind expressions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a></tt=
>
directive provides a way of combining collected data from multiple
nested lists in a way which normalizes different nesting levels
among the sources.  This directive is useful for combining the results from
collects at different levels of nesting into a single nested list such that
parallel elements are at equal depth.
</p><p>
A new binding is created for the
<tt><i>destination</i></tt>
variable, which holds the result of the operation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a></tt=
>
directive performs its special function if invoked with at least three
arguments: a destination and two sources.
</p><p>
The one-argument case
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a> x=
)</tt>
binds a new variable
<tt>x</tt>
and initializes it with the empty list and is thus equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> x)=
</tt>.
Likewise, the two-argument case
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a> x=
 y)</tt>
is equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> x =
y)</tt>,
establishing a binding for
<tt>x</tt>
which is initialized with the value of
<tt>y</tt>.
</p><p>
To understand what merge does when two sources are given, as in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a> C=
 A B)</tt>,
we first have
to define a property called depth.  The depth of an atom such as a string i=
s
defined as
<tt>1</tt>.
The depth of an empty
list is
<tt>0</tt>.
The depth of a nonempty list is one plus the depth of its deepest
element. So for instance
<tt>"foo"</tt>

has depth 1,
<tt>

("foo")
</tt>

has depth 2, and
<tt>

("foo" ("bar"))
</tt>

has depth three.
</p><p>
We can now define a binary (two argument) merge(A, B) function as follows.
First, merge(A, B) normalizes the values A and B
to produce a pair of values which have equal depth, as defined above.
If either value is an atom it is first converted
to a one-element list containing that atom. After this step, both
values are lists; and the only way an argument has depth zero is if it is a=
n
empty list.  Next, if either value has a smaller depth than the
other, it is wrapped in a list as many times as needed to give it equal dep=
th.
For instance if A is
<tt>(a)</tt>
and B is
<tt>(((("b" "c") ("d" "e))))</tt>
then A is converted to
<tt>(((("a"))))</tt>.
Finally, the list values are appended together to produce the merged result=
.
In the case of the preceding two example values, the result is:
<tt>(((("a"))) ((("b" "c") ("d" "e))))</tt>.
The result is stored into a the newly bound destination variable
<tt>C</tt>.
</p><p>
If more than two source arguments are given, these are merged by a left-ass=
ociative
reduction, which is to say that a three argument
<tt>merge(X, Y, Z)</tt>
is defined as
<tt>merge(merge(X, Y), Z)</tt>.
The leftmost two values are merged, and then this result is merged with the=
 third
value, and so on.
</p><p>
<a name=3D"N-03336E1B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.26">7.3.2=
6</a> The <tt>cat</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03336E1B">cat</a></=
tt>
directive converts a list variable into a single
piece of text. The syntax is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03336=
E1B">cat</a> </tt><tt><i>var</i></tt><tt> [</tt><tt><i>sep</i></tt><tt>])=
=20

</tt>

</p><p>
The
<tt><i>sep</i></tt>
argument is a Lisp expression whose value specifies a separating piece of t=
ext.
If it is omitted, then a single space is used as the separator.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)=
@{a /[^ ]+/}@(end)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03336E1B">c=
at</a>&nbsp;a&nbsp;":")
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1 2 3 4 5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a=3D"1:2:3:4:5"
</tt>

</dd></dl>
<p>

</p><p>
<a name=3D"N-02ED877D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.27">7.3.2=
7</a> The <tt>bind</tt> directive</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
directive is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057"=
>bind</a> </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>bind-expression</i><=
/tt><tt> {</tt><tt><i>keyword</i></tt><tt> </tt><tt><i>value</i></tt><tt>}*=
)=20

</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
directive is a kind of pattern match, which matches one or more
variables given in
<tt><i>pattern</i></tt>
against a value produced by the
<tt><i>bind-expression</i></tt>
on the right.
</p><p>
Variables names occurring in the
<tt><i>pattern</i></tt>
expression may refer to bound variables, or may be unbound.
</p><p>
All variables references occurring in
<tt><i>bind-expression</i></tt>
must have value.
</p><p>
Binding occurs as follows. The tree structure of
<tt><i>pattern</i></tt>
and the value of
<tt><i>bind-expression</i></tt>
are considered to be parallel structures.
</p><p>
Any variables in
<tt><i>pattern</i></tt>
which are unbound receive a new binding, which is initialized with
the structurally corresponding piece of the object produced by
<tt><i>bind-expression</i></tt>.
</p><p>
Any variables in
<tt><i>pattern</i></tt>
which are already bound must match the corresponding part of the
value of
<tt><i>bind-expression</i></tt>,
or else
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
directive fails. Variables which are already bound are not altered,
retaining their current values, even if the matching is inexact.
</p><p>
The simplest bind is of one variable against itself, for instance bind
<tt>A</tt>
against
<tt>A</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> A A)
</tt></pre><tt>

</tt>

<p>
This will throw an exception if
<tt>A</tt>
is not bound. If
<tt>A</tt>
is bound, it
succeeds, since
<tt>A</tt>
matches itself.
</p><p>
The next simplest bind binds one variable to another:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> A B)
</tt></pre><tt>

</tt>

<p>
Here, if
<tt>A</tt>
is unbound, it takes on the same value as
<tt>B</tt>.
If
<tt>A</tt>
is bound, it has
to match
<tt>B</tt>,
or the bind fails. Matching means that either
</p><dl class=3D"items">
<dt>-</dt><dd>
<tt>A</tt>
and
<tt>B</tt>
are the same text
</dd><dt>-</dt><dd>
<tt>A</tt>
is text,
<tt>B</tt>
is a list, and
<tt>A</tt>
occurs within
<tt>B</tt>.
</dd><dt>-</dt><dd>
<i>vice versa</i>:

<tt>B</tt>
is text,
<tt>A</tt>
is a list, and
<tt>B</tt>
occurs within
<tt>A</tt>.
</dd><dt>-</dt><dd>
<tt>A</tt>
and
<tt>B</tt>
are lists and are either identical, or one is
found as substructure within the other.
</dd></dl>
<p>

The right hand side does not have to be a variable. It may be some other
object, like a string, quasiliteral, regexp, or list of strings,
<i>et cetera</i>.

For instance
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> A "ab\tc")
</tt></pre><tt>

</tt>

<p>
will bind the string
<tt>"ab\tc"</tt>

to the variable
<tt>A</tt>
if
<tt>A</tt>
is unbound. If
<tt>A</tt>
is bound, this will fail unless
<tt>A</tt>
already contains an identical string. However, the right hand side of a bin=
d
cannot be an unbound variable, nor a complex expression that contains unbou=
nd
variables.
</p><p>
The left hand side of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
can be a nested list pattern containing variables.
The last item of a list at any nesting level can be preceded by a
<tt>.</tt>
(dot), which means that the variable matches the rest of the list from that
position.
</p><p>
</p><dl>
<dt>Example 1:</dt><dd>
<p>


</p><p>
Suppose that the list A contains
<tt>

("now" "now" "brown" "cow").
</tt>

Then the
directive
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> (H=
 N . C) A)</tt>,
assuming that
<tt>H</tt>,
<tt>N</tt>
and
<tt>C</tt>
are unbound variables,
will bind
<tt>H</tt>
to
<tt>"how"</tt>,
code N
to
<tt>"now"</tt>,
and
<tt>C</tt>
to the remainder of the list
<tt>

("brown" "cow").
</tt>

</p><p>
Example: suppose that the list
<tt>A</tt>
is nested to two dimensions and  contains
<tt>

(("how" "now") ("brown" "cow")).
</tt>

Then
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> ((=
H N) (B C)) A)</tt>
binds
<tt>H</tt>
to
<tt>"how"</tt>,
<tt>N</tt>
to
<tt>"now"</tt>,
<tt>B</tt>
to
<tt>"brown"</tt>

and
<tt>C</tt>
to
<tt>"cow"</tt>.
</p><p>
The dot notation may be used at any nesting level. it must be followed
by an item.  The forms
<tt>(.)</tt>
and
<tt>(X .)</tt>
are invalid, but
<tt>(. X)</tt>
is valid and equivalent to
<tt>X</tt>.
</p><p>
The number of items in a left pattern match must match the number of items =
in
the corresponding right side object. So the pattern
<tt>()</tt>
only matches
an empty list. The notations
<tt>()</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
mean exactly the same thing.
</p><p>
The symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and keyword symbols may be used on either side.
They represent themselves.  For example
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> :f=
oo :bar)</tt>
fails,
but
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> :f=
oo :foo)</tt>
succeeds since the two sides denote the same
keyword symbol object.
</p><p>
</p></dd><dt>Example 2:</dt><dd>
<p>


In this example, suppose
<tt>A</tt>
contains
<tt>"foo"</tt>

and
<tt>B</tt>
contains
bar. Then
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> (X=
 (Y Z)) (A (B "hey")))</tt>
binds
<tt>X</tt>
to
<tt>"foo"</tt>,
<tt>Y</tt>
to
<tt>"bar"</tt>

and
<tt>Z</tt>
to
<tt>"hey"</tt>.
This is because the
<tt><i>bind-expression</i></tt>
produces the object
<tt>

("foo" ("bar" "hey"))
</tt>

which is then structurally matched against the pattern
<tt>(X (Y Z))</tt>,
and the variables receive the corresponding pieces.
</p><p>

</p></dd></dl>
<a name=3D"N-00A298C5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.28">7.3.28</a=
> Keywords in the <tt>bind</tt> directive</h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
directive accepts these keywords:
<p>
</p><dl class=3D"items">
<dt><tt>:lfilt</tt></dt><dd>

The argument to
<tt>:lfilt</tt>
is a filter specification. When the left side pattern
contains a binding which is therefore matched against its counterpart from =
the
right side expression, the left side is filtered through the filter specifi=
ed
by
<tt>:lfilt</tt>
for the purposes of the comparison. For example:
<p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> "a" "A" :lfilt :upcase)
</tt></pre><tt>

</tt>

<p>
produces a match, since the left side is the same as the right after
filtering through the :upcase filter.
</p><p>
</p></dd><dt><tt>:rfilt</tt></dt><dd>

The argument to
<tt>:rfilt</tt>
is a filter specification. The specified filter is
applied to the right hand side material prior to matching it against
the left side. The filter is not applied if the left side is a variable
with no binding. It is only applied to determine a match. Binding takes
place the unmodified right hand side object.
<p>
For example, the following produces a match:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> "A" "a" :rfilt :upcase)
</tt></pre><tt>

</tt>

<p>
</p></dd><dt><tt>:filter</tt></dt><dd>

This keyword is a shorthand to specify both filters to the same value.
For instance
<tt>:filter :upcase</tt>
is equivalent to
<tt>:lfilt :upcase :rfilt :upcase</tt>.
<p>
For a description of filters, see Output Filtering below.
</p><p>
Compound filters like
<tt>(:fromhtml :upcase)</tt>
are supported with all these keywords. The filters apply across arbitrary
patterns and nested data.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> (a b c) ("A" "B" "C"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> (a b=
 c) (("z" "a") "b" "c") :rfilt :upcase)
</tt></pre><tt>

</tt>

<p>
Here, the first bind establishes the values for
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>,
and the second bind
succeeds, because the value of a matches the second element of the list
<tt>

("z" "a")
</tt>

if it is upcased, and likewise
<tt>b</tt>
matches
<tt>"b"</tt>

and
<tt>c</tt>
matches
<tt>"c"</tt>

if these are upcased.
</p><p>

</p></dd></dl>
<a name=3D"N-02572115">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.29">7.3.29</a=
> Lisp forms in the <tt>bind</tt> directive</h4>



<p>
<b>TXR Lisp</b> forms, introduced by
<tt>@</tt>
may be used in the
<tt><i>bind-expression</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>=
,
or as the entire form. This is consistent with the rules for bind expressio=
ns.
</p><p>
<b>TXR Lisp</b> forms can be used in the
<tt><i>pattern</i></tt>
expression also.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> a @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C"=
>+</a> 2 2))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> @(<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2) @(<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> 2 2))
</tt></pre><tt>

</tt>

<p>
Here,
<tt>a</tt>
is bound to the integer
<tt>4</tt>.
The second
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
then succeeds because the forms
<tt>(+ 2 2)</tt>
and
<tt>(* 2 2)</tt>
produce equal values.
</p><p>
<a name=3D"N-032AAE1B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.30">7.3.3=
0</a> The <tt>set</tt> directive</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
directive is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F"=
>set</a> </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>bind-expression</i></=
tt><tt>)=20

</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
directive syntactically resembles
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>=
,
but is not a pattern match. It overwrites
the previous values of variables with new values from the right hand side.
Each variable that is assigned must have an existing binding:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
will not induce binding.
</p><p>
Examples follow.
</p><p>
Store the value of
<tt>A</tt>
back into
<tt>A</tt>,
an operation with no effect:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02F">set</a> A A)
</tt></pre><tt>

</tt>

<p>
Exchange the values of
<tt>A</tt>
and
<tt>B</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02F">set</a> (A B) (B A))
</tt></pre><tt>

</tt>

<p>
Store a string into
<tt>A</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02F">set</a> A "text")
</tt></pre><tt>

</tt>

<p>
Store a list into
<tt>A</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02F">set</a> A ("line1" "line2"))
</tt></pre><tt>

</tt>

<p>
Destructuring assignment.
<tt>A</tt>
ends up with
<tt>"A"</tt>,
<tt>B</tt>
ends up with
<tt>

("B1" "B2")
</tt>

and
<tt>C</tt>
binds to
<tt>

("C1" "C2").
</tt>

</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> D ("A" ("B1" "B2") "C1" "C2"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> (A B=
 C) (() () ()))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> (A B =
. C) D)
</tt></pre><tt>

</tt>

<p>
Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
does not support a <b>TXR Lisp</b> expression on the left side, so the foll=
owing
are invalid syntax:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02F">set</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+<=
/a> 1 1) @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*<=
/a> 2 2))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> @b @(=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> "a")=
)
</tt></pre><tt>

</tt>

<p>
The second one is erroneous even though there is a variable on the left.
Because it is preceded by the
<tt>@</tt>
escape, it is a Lisp variable, and not a pattern variable.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
directive also doesn't support Lisp expressions in the
<tt><i>pattern</i></tt>,
which must consist only of variables.
</p><p>
<a name=3D"N-019F9FB7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.31">7.3.3=
1</a> The <tt>rebind</tt> directive</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
></tt>
directive is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9=
FB7">rebind</a> </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>bind-expressio=
n</i></tt><tt>)=20

</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
></tt>
directive resembles
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>=
.
It combines the semantics of
<tt>local</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
into a single directive.
The
<tt><i>bind-expression</i></tt>
is evaluated in the current
environment, and its value remembered. Then a new
environment is produced in which all the variables specified in
<tt><i>pattern</i></tt>
are absent. Then, the pattern is newly bound in
that environment against the previously produced value, as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>=
.
</p><p>
The old environment with the previous variables is not modified;
it continues to exist. This is in contrast with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
directive, which mutates existing bindings.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
></tt>
makes it easy to create temporary bindings based on existing bindings.
</p><p>
<tt>
</tt></p><pre><tt>  @(define pattern-function (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#N-02133AA5">arg</a>))
  @;; inside a pattern function:
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
> recursion-level @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007=
C">+</a> recursion-level 1))
  @;; ...
  @(end)
</tt></pre><tt>

</tt>

<p>
When the function terminates, the previous value of recursion-level
is restored. The effect is less verbose and more efficient than
the following equivalent
</p><p>
<tt>
</tt></p><pre><tt>  @(define pattern-function (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#N-02133AA5">arg</a>))
  @;; inside a pattern function:
  @(local temp)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> temp =
recursion-level)
  @(local recursion-level)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> recur=
sion-level @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> temp 1))
  @;; ...
  @(end)
</tt></pre><tt>

</tt>

<p>
Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
></tt>
supports nested patterns, such as
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
19F9FB7">rebind</a> (a (b c)) (1 (2 3))
</tt></pre><tt>

</tt>

<p>
but it does not support any keyword arguments. The filtering
features of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
do not make sense in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
></tt>
because the variables are always re-introduced into an environment
in which they don't exist, whereas filtering applies in
situations when bound variables are matched against values.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F9FB7">rebind</a=
></tt>
directive also doesn't support Lisp expressions in the
<tt><i>pattern</i></tt>,
which must consist only of variables.
</p><p>
<a name=3D"N-02A1EE04">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.32">7.3.3=
2</a> The <tt>forget</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1EE04">forget</a=
></tt>
has two spellings:
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1EE04">forget<=
/a>)</tt>
and
<tt>@(local)</tt>.
</p><p>
The arguments are one or more symbols, for example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2A1EE04">forget</a> a)
  @(local a b c)
</tt></pre><tt>

</tt>

<p>
this can be written
</p><p>
<tt>
</tt></p><pre><tt>  @(local a)
  @(local a b c)
</tt></pre><tt>

</tt>

<p>
Directives which follow the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1EE04">forget</a=
></tt>
or
<tt>local</tt>
directive no longer see
any bindings for the symbols mentioned in that directive, and
can establish new bindings.
</p><p>
It is not an error if the bindings do not exist.
</p><p>
It is strongly recommended to use the
<tt>@(local)</tt>
spelling in functions,
because the forgetting action simulates local variables:
for the given symbols, the machine forgets any earlier variables
from outside of the function, and consequently, any new bindings
for those variables belong to the function. (Furthermore,
functions suppress the propagation of variables that are not
in their parameter list, so these locals will be automatically
forgotten when the function terminates.)
</p><p>
<a name=3D"N-03B66E65">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.33">7.3.3=
3</a> The <tt>do</tt> directive</h4>



<p>
The syntax of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a>)</tt=
>
is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061"=
>do</a> </tt><tt><i>lisp-expression</i></tt><tt>*)=20

</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
directive evaluates zero or more <b>TXR Lisp</b> expressions. (See TXR LISP=
 far
below.) The value of the expression is ignored, and matching
continues with the directives which follow the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
directive, if any.
</p><p>
In the context of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
directive, the expression should not be introduced by the
<tt>@</tt>
symbol; it is expected to be a Lisp expression.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @; match text into variables a and b, then insert into =
hash table h
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> h (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a>))
  @a:@b
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> [h a] b))
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-028DBD1B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.34">7.3.3=
4</a> The <tt>mdo</tt> directive</h4>



<p>
The syntax of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a>=
)</tt>
is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DB=
D1B">mdo</a> </tt><tt><i>lisp-expression</i></tt><tt>*)=20

</tt>

</p><p>
Like the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
directive,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a></=
tt>
(macro-time
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>)
evaluates zero or more <b>TXR Lisp</b> expressions. Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a></=
tt>
performs this evaluation immediately upon being parsed.
Then it disappears from the syntax.
</p><p>
The effect of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a>=
 e0 e1 e2 ...)</tt>
is exactly like
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a> (mac=
ro-time e0 e1 e2 ...))</tt>
except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
doesn't disappear from the syntax.
</p><p>
Another difference is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
can be used as a horizontal or vertical directive, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a></=
tt>
is only vertical.
</p><p>
<a name=3D"N-01617CB2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.3.35">7.3.3=
5</a> The <tt>in-package</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
directive shares the same syntax and semantics as the <b>TXR Lisp</b> macro
of the same name:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">=
in-package</a> </tt><tt><i>name</i></tt><tt>)=20

</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
directive is evaluated immediately upon being parsed,
leaving no trace in the syntax tree of the surrounding <b>TXR</b>query.
</p><p>
It causes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
special variable to take on the package denoted by
<tt><i>name</i></tt>.
</p><p>
The directive that
<tt><i>name</i></tt>
is either a string or symbol. An error exception is thrown if
this isn't the case.  Otherwise it searches for the package.
If the package is not found, an error exception is thrown.
</p><p>
<a name=3D"N-00935A22">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4">7.4</a> =
Blocks</h3>



<p>


</p><p>
<a name=3D"N-01CE7F10">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.1">7.4.1<=
/a> Overview</h4>


Blocks are sections of a query which are either denoted by a name,
or are anonymous. They may nest: blocks can occur within blocks
and other constructs.
<p>
Blocks are useful for terminating parts of a pattern matching search
prematurely, and escaping to a higher level. This makes blocks not only
useful for simplifying the semantics of certain pattern matches,
but also an optimization tool.
</p><p>
Judicious use of blocks and escapes can reduce or eliminate the amount of
backtracking that <b>TXR</b> performs.
</p><p>
<a name=3D"N-0298769A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.2">7.4.2<=
/a> The <tt>block</tt> directive</h4>



<p>
The
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> </tt>=
<tt><i>name</i></tt><tt>)=20

</tt>

directive introduces a named block, except when
<tt><i>name</i></tt>
is the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>)<=
/tt>
directive introduces an unnamed block, equivalent
to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> n=
il)</tt>.
</p><p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
directives introduce implicit anonymous blocks,
as do function bodies.
</p><p>
Blocks must be terminated by
<tt>@(end)</tt>
and can be vertical:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A"=
>block</a> [</tt><tt><i>name</i></tt><tt>])=20

<br>&nbsp;&nbsp;...



<br>&nbsp;&nbsp;@(end)=20

</tt>

</p><p>
or horizontal:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A"=
>block</a> [</tt><tt><i>name</i></tt><tt>])...@(end)=20

</tt>

</p><p>
<a name=3D"N-0167D9C2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.3">7.4.3<=
/a> Block Scope</h4>


<p>
The names of blocks are in a distinct namespace from the variable binding
space. So
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> f=
oo)</tt>
is unrelated to the variable
<tt>@foo</tt>.
</p><p>
A block extends from the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> .=
..)</tt>
directive which introduces it,
until the matching
<tt>@(end)</tt>,
and may be empty.  For instance:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
077">some</a>)
  abc
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> foo=
)
  xyz
  @(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
Here, the block foo occurs in a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
clause, and so it extends to the
<tt>@(end)</tt>
which terminates the block.  After that
<tt>@(end)</tt>,
the name foo is not
associated with a block (is not "in scope"). The second
<tt>@(end)</tt>
terminates
the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
block.
</p><p>
The implicit anonymous block introduced by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>
has the same scope
as the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>:
it extends over all of the material which follows the skip,
to the end of the containing subquery.
</p><p>
<a name=3D"N-0295951F">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.4">7.4.4<=
/a> Block Nesting</h4>


<p>
Blocks may nest, and nested blocks may have the same names as blocks in
which they are nested. For instance:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
05A">block</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>)
  ...
  @(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
is a nesting of two anonymous blocks, and
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
05A">block</a> foo)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> foo=
)
  @(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
is a nesting of two named blocks which happen to have the same name.
When a nested block has the same name as an outer block, it creates
a block scope in which the outer block is "shadowed"; that is to say,
directives which refer to that block name within the nested block refer to =
the
inner block, and not to the outer one.
</p><p>
<a name=3D"N-02E0775E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.5">7.4.5<=
/a> Block Semantics</h4>


<p>
A block normally does nothing. The query material in the block is evaluated
normally. However, a block serves as a termination point for
<tt>@(fail)</tt>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
directives which are in scope of that block and refer to it.
</p><p>
The precise meaning of these directives is:
</p><p>



</p><dl class=3D"items">
<dt><tt>@(fail <tt><i>name</i></tt><tt>) </tt></tt></dt><dd>



Immediately terminate the enclosing query block called
<tt><i>name</i></tt>,
as if that block
failed to match anything. If more than one block by that name encloses
the directive, the innermost block is terminated. No bindings emerge from
a failed block.
<p>
</p></dd><dt><tt>@(fail)</tt></dt><dd>

Immediately terminate the innermost enclosing anonymous block, as if
that block failed to match.
<p>
The
<tt>@(fail)</tt>
directive has a vertical and horizontal form.
</p><p>
If the implicit block introduced by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>
is terminated in this manner,
this has the effect of causing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
itself to fail. I.e. the behavior
is as if skip search did not find a match for the trailing material,
except that it takes place prematurely (before the end of the available
data source is reached).
</p><p>
If the implicit block associated with a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
is terminated this way,
then the entire
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
fails. This is a special behavior, because a
collect normally does not fail, even if it matches nothing and collects not=
hing!
</p><p>
To prematurely terminate a collect by means of its anonymous block, without
failing it, use
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>.
</p><p>



</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B=
">accept</a> <tt><i>name</i></tt><tt>) </tt></tt></dt><dd>



Immediately terminate the enclosing query block called
<tt><i>name</i></tt>,
as if that block
successfully matched. If more than one block by that name encloses the
directive, the innermost block is terminated.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B=
">accept</a>)</tt></dt><dd>

Immediately terminate the innermost enclosing anonymous block, as if
that block successfully matched.
<p>
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
communicates the current bindings and input position to the terminated
block. These bindings and current position may be altered by special
interactions between certain directives and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>,
described in the following section. Communicating the current bindings
and input position means that the block which is terminated by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
exhibits the bindings which were collected just prior to the execution
of that
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
and the input position which was in effect at that time.
</p><p>
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
has a vertical and horizontal form. In the horizontal form,
it communicates a horizontal input position. A horizontal input
position thus communicated will only take effect if the block being
terminated had been suspended on the same line of input.
</p><p>
If the implicit block introduced by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a=
>)</tt>
is terminated by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>,
this has the effect of causing the skip itself to succeed, as if
all of the trailing material had successfully matched.
</p><p>
If the implicit block associated with a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
is terminated by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>,
then the collection stops. All bindings collected in the current iteration =
of
the collect are discarded. Bindings collected in previous iterations are
retained, and collated into lists in accordance with the semantics of colle=
ct.
</p><p>
Example: alternative way to achieve
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)<=
/tt>
termination:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)
  ---
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)
  @  (end)
  @LINE
  @(end)
</tt></pre><tt>

</tt>

<p>
This query will collect entire lines into a list called
<tt>LINE</tt>.
However,
if the line
<tt>---</tt>
is matched (by the embedded
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)</tt>),
the collection
is terminated. Only the lines up to, and not including the
<tt>---</tt>
line, are collected. The effect is identical to:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  @LINE
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a>)
  ---
  @(end)
</tt></pre><tt>

</tt>

<p>
The difference (not relevant in these examples) is that the until clause ha=
s
visibility into the bindings set up by the main clause.
</p><p>
However, the following example has a different meaning:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  @LINE
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</=
a>)
  ---
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)
  @  (end)
  @(end)
</tt></pre><tt>

</tt>

<p>
Now, lines are collected until the end of the data source, or until a line =
is
found which is followed by a
<tt>---</tt>
line. If such a line is found,
the collection stops, and that line is not included in the collection!
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
terminates the process of the collect body, and so the
action of collecting the last
<tt>@LINE</tt>
binding into the list is not performed.
</p></dd></dl>
<p>

</p><p>
Example: communication of bindings and input position:
</p><p>
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block=
</a>&nbsp;foo)
<br>&nbsp;@first
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accep=
t</a>&nbsp;foo)
<br>&nbsp;@ignored
<br>&nbsp;@(end)
<br>&nbsp;@second
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;first=3D"1"
<br>&nbsp;second=3D"2"
</tt>

</dd></dl>
<p>

</p><p>
At the point where the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
occurs, the foo block has matched the first line,
bound the text
<tt>"1"</tt>

to the variable
<tt>@first</tt>.
The block is then terminated.
Not only does the
<tt>@first</tt>
binding emerge from this terminated block, but
what also emerges is that the block advanced the data past the first line t=
o
the second line. Next, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
directive ends, and propagates the
bindings and position. Thus the
<tt>@second</tt>
which follows then matches the second
line and takes the text
<tt>"2"</tt>.
</p><p>
Example: abandonment of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
clause by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>:
</p><p>
In the following query, the foo block occurs inside a maybe clause.
Inside the foo block there is a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
clause. Its first subclause
matches variable
<tt>@first</tt>
and then terminates block foo. Since block foo is
outside of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
directive, this has the effect of terminating the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
clause:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe=
</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block=
</a>&nbsp;foo)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0077">some</a>)
<br>&nbsp;@first
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-007B">accept</a>&nbsp;foo)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0034">or</a>)
<br>&nbsp;@one
<br>&nbsp;@two
<br>&nbsp;@three
<br>&nbsp;@four
<br>&nbsp;@&nbsp;&nbsp;(end)
<br>&nbsp;@(end)
<br>&nbsp;@second
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
<br>&nbsp;4
<br>&nbsp;5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;first=3D"1"
<br>&nbsp;second=3D"2"
</tt>

</dd></dl>
<p>

</p><p>
The second clause of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
directive, namely:
</p><p>
<tt>
</tt></p><pre><tt>  @one
  @two
  @three
  @four
</tt></pre><tt>

</tt>

<p>
is never processed. The reason is that subclauses are processed in top
to bottom order, but the processing was aborted within the
first clause the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a> =
foo)</tt>.
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
construct never gets the
opportunity to match four lines.
</p><p>
If the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a> =
foo)</tt>
line is removed from the above query, the output
is different:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe=
</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block=
</a>&nbsp;foo)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0077">some</a>)
<br>&nbsp;@first
<br>&nbsp;@#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt=
;--&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">=
accept</a>&nbsp;foo)&nbsp;removed&nbsp;from&nbsp;here!!!
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0034">or</a>)
<br>&nbsp;@one
<br>&nbsp;@two
<br>&nbsp;@three
<br>&nbsp;@four
<br>&nbsp;@&nbsp;&nbsp;(end)
<br>&nbsp;@(end)
<br>&nbsp;@second
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
<br>&nbsp;4
<br>&nbsp;5
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;first=3D"1"
<br>&nbsp;one=3D"1"
<br>&nbsp;two=3D"2"
<br>&nbsp;three=3D"3"
<br>&nbsp;four=3D"4"
<br>&nbsp;second=3D"5"
</tt>

</dd></dl>
<p>

</p><p>
Now, all clauses of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a>)</=
tt>
directive have the opportunity to match.
The second clause grabs four lines, which is the longest match.
And so, the next line of input available for matching is
<tt>5</tt>,
which goes
to the
<tt>@second</tt>
variable.
</p><p>

<a name=3D"N-01AC9294">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.6">7.4.6<=
/a> Interaction Between the <tt>trailer</tt> and <tt>accept</tt> Directives=
</h4>



<p>
If one of the clauses which follow a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>
requests a successful
termination to an outer block via
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>,
then
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>
intercepts the escape and adjusts the data extent to the position
that it was given.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>=
)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trail=
er</a>)
<br>&nbsp;@line1
<br>&nbsp;@line2
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accep=
t</a>)
<br>&nbsp;@(end)
<br>&nbsp;@line3
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;line1=3D"1"
<br>&nbsp;line2=3D"2"
<br>&nbsp;line3=3D"1"
</tt>

</dd></dl>
<p>

</p><p>
The variable
<tt>line3</tt>
is bound to
<tt>"1"</tt>

because although
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
yields a data
position which has advanced to the third line, this is intercepted by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a>=
)</tt>
and adjusted back to the first line. Neglecting to do this adjustment
would violate the semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0020">trailer</a></=
tt>.
</p><p>

<a name=3D"N-01188822">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.7">7.4.7<=
/a> Interaction Between the <tt>next</tt> and <tt>accept</tt> Directives</h=
4>



<p>
When the clauses under a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
directive are terminated by an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>,
such that control passes to a block which surrounds that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>=
,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
is intercepted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>=
.
</p><p>
The input position being communicated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
is replaced with the original input position in the original
stream which is in effect prior to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
directive. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer is then resumed.
</p><p>
In other words,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
cannot be used to "leak" the new stream out of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
scope.
</p><p>
However,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
has no effect on the bindings being communicated.
</p><p>
Example:
</p><p>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> =
"file-x")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block=
</a>&nbsp;b)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next<=
/a>&nbsp;"file-y")
<br>&nbsp;@line
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accep=
t</a>&nbsp;b)
<br>&nbsp;@(end)
</tt>

</p><p>
Here, the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
matches the first line of the file
<tt>"file-y"</tt>,
after which an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer is initiated, targeting block
<tt>b</tt>.
This transfer communicates the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
binding, as well as the position within
<tt>file-y</tt>,
pointing at the second line.
However, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
traverses the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
directive, causing it to be abandoned. The special unwinding
action within that directive detects this transfer and rewrites
the input position to be the original one within the stream
associated with
<tt>"file-x"</tt>.
Note that this special handling exists in order for the behavior to be
consistent with what would happen if the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a> =
b)</tt>
were removed, and the block
<tt>b</tt>
terminated normally: because the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
is nested within that block, <b>TXR</b> would backtrack to the
previous input position within
<tt>"file-x"</tt>.
</p><p>

<a name=3D"N-00B71A20">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.8">7.4.8<=
/a> Interaction Between Functions and the <tt>accept</tt> directive</h4>



If a pattern function is terminated due to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>,
the function return mechanism intercepts the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>.
The bindings being communicated by that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
are then subject to the special resolution with respect to the
function parameters, exactly as if the bindings were being
returned normally out of the function. The resolved bindings
then replace those being communicated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer is resumed.
<p>
Example:
</p><p>
<tt>

&nbsp;@(define fun (a))
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0057">bind</a>&nbsp;a&nbsp;"a")
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0057">bind</a>&nbsp;b&nbsp;"b")
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-007B">accept</a>&nbsp;blk)
<br>&nbsp;@(end)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block=
</a>&nbsp;blk)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">f=
un</a>&nbsp;x)
<br>&nbsp;this&nbsp;line&nbsp;is&nbsp;skipped&nbsp;by&nbsp;accept
<br>&nbsp;@(end)
</tt>

</p><p>
Here, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
initiates a control transfer which communicates the
<tt>a</tt>
and
<tt>b</tt>
variable bindings which are visible in that scope. This transfer is
intercepted by the function, and the treatment of the bindings follows
to the same rules as a normal return (which, in the given function, would
readily take place if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
directive were removed). The
<tt>b</tt>
variable is suppressed, because
<tt>b</tt>
isn't a parameter of the function. Because
<tt>a</tt>
<b>is</b>

a parameter, and the argument to that parameter is the unbound
variable
<tt>x</tt>,
the effect is that
<tt>x</tt>
is bound to the value of
<tt>a</tt>.
When the accept transfer reaches block
<tt>blk</tt>
and terminates it, all that emerges is the
<tt>x</tt>
binding carrying
<tt>"a"</tt>.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
invocation is removed from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>,
then the function returns normally, producing the
<tt>x</tt>
binding. In that case, the line
<tt>this line is skipped by accept</tt>
isn't skipped since the block isn't being terminated; that
line must match something.
</p><p>

<a name=3D"N-03054775">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.9">7.4.9<=
/a> Interaction Between <tt>finally</tt> and the <tt>accept</tt> directive<=
/h4>



If the exception handling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
directive protected body is terminated by an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer, and if that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block, then there is a special interaction between the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer.
<p>
The processing of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block detects that it has been triggered by an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer. Consequently, it retrieves the current input position
and bindings from that transfer, and uses that position and those
bindings for the processing of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clauses.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clauses succeed, then the new input position and new bindings
are installed into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
control transfer and that transfer resumes.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clauses fail, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
transfer is converted to a
<tt>fail</tt>,
with exactly the same block as its destination.
</p><p>

<a name=3D"N-005E1D6C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.10">7.4.1=
0</a> Vertical-Horizontal Mismatch Between <tt>block</tt> and <tt>accept</t=
t></h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
and
<tt>fail</tt>
directives comes in horizontal and vertical forms.
<p>
This creates the possibility than an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
in horizontal context targets a vertical
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
or
<i>vice versa</i>,

raising the question of how the input position
is treated.  The semantics of this is defined.
</p><p>
If a horizontal-context
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
targets a vertical block, the current position at the target block will be =
the
following line. That is to say, when the horizontal
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
occurs, there is a current input line which may have unconsumed
material past the current position. If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
communicates its input position to a vertical context, that unconsumed
material is skipped, as if it had been matched and the vertical position
is advanced to the next line.
</p><p>
If a horizontal block catches a vertical accept, it rejects that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>'s
position and stays at the current backtracking position for that block.
Only the bindings from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
are retained.
</p><p>

<a name=3D"N-02A72FC6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.4.11">7.4.1=
1</a> Horizontal-Horizontal Mismatch between <tt>block</tt> and <tt>accept<=
/tt></h4>



It is possible for a horizontal
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
to terminate in a horizontal block which is processing
a different line of input (or even a different input stream).
This situation is treated the same way as vertical accept terminating
in a horizontal block: the position communicated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
is ignored, and only the bindings are taken.
<p>
<a name=3D"N-00AAF302">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5">7.5</a> =
Functions</h3>



<p>


</p><p>
<a name=3D"N-01CE7F11">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.1">7.5.1<=
/a> Overview</h4>


<b>TXR</b> functions allow a query to be structured to avoid repetition.
On a theoretical note, because
<b>TXR</b> functions support recursion, functions enable <b>TXR</b> to matc=
h some
kinds of patterns which exhibit self-embedding, or nesting,
and thus cannot be matched by a regular language.
<p>
Functions in <b>TXR</b> are not exactly like functions in mathematics or fu=
nctional
languages, and are not like procedures in imperative programming languages.
They are not exactly like macros either. What it means for a
<b>TXR</b> function to take arguments and produce a result is different fro=
m
the conventional notion of a function.
</p><p>
A <b>TXR</b> function may have one or more parameters. When such a function=
 is
invoked, an argument must be specified for each parameter.  However, a spec=
ial
behavior is at play here. Namely, some or all of the argument expressions m=
ay
be unbound variables.  In that case, the corresponding parameters behave li=
ke
unbound variables also.  Thus <b>TXR</b> function calls can transmit the "u=
nbound"
state from argument to parameter.
</p><p>
It should be mentioned that functions have access to all bindings that are
visible in the caller; functions may refer to variables which are not
mentioned in their parameter list.
</p><p>
With regard to returning, <b>TXR</b> functions are also unconventional. If =
the
function fails, then the function call is considered to have failed. The
function call behaves like a kind of match; if the function fails, then the
call is like a failed match.
</p><p>
When a function call succeeds, then the bindings emanating from that functi=
on
are processed specially. Firstly, any bindings for variables which do not
correspond to one of the function's parameters are thrown away. Functions m=
ay
internally bind arbitrary variables in order to get their job done, but onl=
y
those variables which are named in the function argument list may propagate=
 out
of the function call.  Thus, a function with no arguments can only indicate
matching success or failure, but not produce any bindings. Secondly,
variables do not propagate out of the function directly, but undergo
a renaming. For each parameter which went into the function as an unbound
variable (because its corresponding argument was an unbound variable),
if that parameter now has a value, that value is bound onto the correspondi=
ng
argument.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(define collect-words (<a href=3D"http://nongnu.org/tx=
r/txr-manpage.html#N-0206CE91">list</a>))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)@{li=
st /[^ \t]+/}@(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
The above function
<tt>collect-words</tt>
contains a query which collects words from a
line (sequences of characters other than space or tab), into the list varia=
ble
called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>.
This variable is named in the parameter list of the function,
therefore, its value, if it has one, is permitted to escape from the functi=
on
call.
</p><p>
Suppose the input data is:
</p><p>
<tt>
</tt></p><pre><tt>  Fine summer day
</tt></pre><tt>

</tt>

<p>
and the function is called like this:
</p><p>
<tt>
</tt></p><pre><tt>  @(collect-words wordlist)
</tt></pre><tt>

</tt>

<p>
The result (with
<tt>txr -B</tt>)
is:
</p><p>
<tt>
</tt></p><pre><tt>  wordlist[0]=3DFine
  wordlist[1]=3Dsummer
  wordlist[1]=3Dday
</tt></pre><tt>

</tt>

<p>
How it works is that in the function call
<tt>@(collect-words wordlist)</tt>,
<tt>wordlist</tt>
is an unbound variable. The parameter corresponding to that
unbound variable is the parameter
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>.
Therefore, that parameter
is unbound over the body of the function.  The function body collects the
words of
<tt>"Fine summer day"</tt>

into the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>,
and then
yields the that binding.   Then the function call completes by
noticing that the function parameter
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
now has a binding, and
that the corresponding argument
<tt>wordlist</tt>
has no binding. The binding
is thus transferred to the
<tt>wordlist</tt>
variable.  After that, the
bindings produced by the function are thrown away. The only enduring
effects are:
</p><dl class=3D"items">
<dt>-</dt><dd>
the function matched and consumed some input; and
</dd><dt>-</dt><dd>
the function succeeded; and
</dd><dt>-</dt><dd>
the
<tt>wordlist</tt>
variable now has a binding.
</dd></dl>
<p>

Another way to understand the parameter behavior is that function
parameters behave like proxies which represent their arguments.  If an argu=
ment
is an established value, such as a character string or bound variable, the
parameter is a proxy for that value and behaves just like that value. If an
argument is an unbound variable, the function parameter acts as a proxy
representing that unbound variable. The effect of binding the proxy is
that the variable becomes bound, an effect which is settled when the
function goes out of scope.
</p><p>
Within the function, both the original variable and the proxy are
visible simultaneously, and are independent.  What if a function binds both=
 of
them? Suppose a function has a parameter called
<tt>P</tt>,
which is called with an argument
<tt>A</tt>,
which is an unbound variable, and then, in the function, both
<tt>A</tt>
and
<tt>P</tt>
bound.  This is
permitted, and they can even be bound to different values.  However, when t=
he
function terminates, the local binding of A simply disappears (because
the symbol
<tt>A</tt>
is not among the parameters of the function).
Only the value bound to
<tt>P</tt>
emerges, and is bound to
<tt>A</tt>,
which still appears unbound at that point. The
<tt>P</tt>
binding disappears also, and the net effect is that
<tt>A</tt>
is now bound. The "proxy" binding of
<tt>A</tt>
through the parameter
<tt>P</tt>
"wins" the conflict with the direct binding.
</p><p>
<a name=3D"N-027D3819">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.2">7.5.2<=
/a> Definition Syntax</h4>


<p>
Function definition syntax comes in two flavors: vertical and horizontal.
Horizontal definitions actually come in two forms, the distinction
between which is hardly noticeable, and the need for which is
made clear below.
</p><p>
A function definition begins with a
<tt>@(define ...)</tt>
directive. For vertical
functions, this is the only element in a line.
</p><p>
The
<tt>define</tt>
symbol must be followed by a symbol, which is the name of the
function being defined. After the symbol, there is a parenthesized optional
argument list. If there is no such list, or if the list is specified as
<tt>()</tt>
or
the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then the function has no parameters. Examples of valid
<tt>define</tt>
syntax are:
</p><p>
<tt>
</tt></p><pre><tt>  @(define foo)
  @(define bar ())
  @(define match (a b c))
</tt></pre><tt>

</tt>

<p>
If the
<tt>define</tt>
directive is followed by more material on the same line, then
it defines a horizontal function:
</p><p>
<tt>
</tt></p><pre><tt>  @(define match-x)x@(end)
</tt></pre><tt>

</tt>

<p>
If the define is the sole element in a line, then it
is a vertical function, and the function definition continues below:
</p><p>
<tt>
</tt></p><pre><tt>  @(define match-x)
  x
  @(end)
</tt></pre><tt>

</tt>

<p>
The difference between the two is that a horizontal function matches
characters within a line, whereas a vertical function matches lines
within a stream. The former
<tt>match-x</tt>
matches the character
<tt>x</tt>,
advancing
to the next character position.  The latter
<tt>match-x</tt>
matches a line consisting
of the character
<tt>x</tt>,
advancing to the next line.
</p><p>
Material between
<tt>@(define)</tt>
and
<tt>@(end)</tt>
is the function body.  The define
directive may be followed directly by the
<tt>@(end)</tt>
directive, in which case the
function has an empty body.
</p><p>
Functions may be nested within function bodies. Such local functions have
dynamic scope. They are visible in the function body in which they are defi=
ned,
and in any functions invoked from that body.
</p><p>
The body of a function is an anonymous block. (See Blocks above).
</p><p>
<a name=3D"N-02917AC7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.3">7.5.3<=
/a> Two Forms of The Horizontal Function</h4>


<p>
If a horizontal function is defined as the only element of a line,
it may not be followed by additional material. The following
construct is erroneous:
</p><p>
<tt>
</tt></p><pre><tt>  @(define horiz (x))@foo:@bar@(end)lalala
</tt></pre><tt>

</tt>

<p>
This kind of definition is actually considered to be in the vertical contex=
t,
and like other directives that have special effects and that do not match
anything, it does not consume a line of input. If the above syntax were
allowed, it would mean that the line would not only define a function but a=
lso
match
<tt>lalala</tt>.
This would, in turn, would mean that the
<tt>@(define)...@(end)</tt>
is
actually in horizontal mode, and so it matches a span of zero characters wi=
thin
a line (which means that is would require a line of input to match: a
surprising behavior for a non-matching directive!)
</p><p>
A horizontal function can be defined in an actual horizontal context. This
occurs if its is in a line where it is preceded by other material.
For instance:
</p><p>
<tt>
</tt></p><pre><tt>  X@(define fun)...@(end)Y
</tt></pre><tt>

</tt>

<p>
This is a query line which must match the text
<tt>XY</tt>.
It also defines the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>.
The main use of this form is for nested horizontal functions:
</p><p>
<tt>
</tt></p><pre><tt>  @(define fun)@(define local_fun)...@(end)@(end)
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-02B006F2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.4">7.5.4<=
/a> Vertical-Horizontal Overloading</h4>


<p>
A function of the same name may be defined as both vertical and horizontal.
Both functions are available at the same time. Which one is used by
a call is resolved by context. See the section Vertical Versus Horizontal C=
alls
below.
</p><p>
<a name=3D"N-01A1FB11">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.5">7.5.5<=
/a> Call Syntax</h4>


<p>
A function is invoked by compound directive whose first symbol is the name =
of
that function. Additional elements in the directive are the arguments.
Arguments may be symbols, or other objects like string and character
literals, quasiliterals ore regular expressions.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define pair (a b))
<br>&nbsp;@a&nbsp;@b
<br>&nbsp;@(end)
<br>&nbsp;@(pair&nbsp;first&nbsp;second)
<br>&nbsp;@(pair&nbsp;"ice"&nbsp;cream)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;one two
<br>&nbsp;ice&nbsp;milk
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;first=3D"one"
<br>&nbsp;second=3D"two"
<br>&nbsp;cream=3D"milk"
</tt>

</dd></dl>
<p>

</p><p>
The first call to the function takes the line
<tt>"one two"</tt>.
The parameter
<tt>a</tt>
takes
<tt>"one"</tt>

and parameter
<tt>b</tt>
takes
<tt>"two"</tt>.
These are rebound to the arguments
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">second</a=
></tt>.
The second call to the function binds the a parameter to the word
<tt>"ice"</tt>,
and the
<tt>b</tt>
is unbound, because the
corresponding argument
<tt>cream</tt>
is unbound. Thus inside the function,
<tt>a</tt>
is forced to match
<tt>ice</tt>.
Then a space is matched and
<tt>b</tt>
collects the text
<tt>"milk"</tt>.
When the function returns, the unbound
<tt>"cream"</tt>

variable gets this value.
</p><p>
If a symbol occurs multiple times in the argument list, it constrains
both parameters to bind to the same value. That is to say, all parameters
which, in the body of the function, bind a value, and which are all derived
from the same argument symbol must bind to the same value. This is settled =
when
the function terminates, not while it is matching. Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define pair (a b))
<br>&nbsp;@a&nbsp;@b
<br>&nbsp;@(end)
<br>&nbsp;@(pair&nbsp;same&nbsp;same)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;one two
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;[query fails]
</tt>

</dd></dl>
<p>

</p><p>
Here the query fails because
<tt>a</tt>
and
<tt>b</tt>
are effectively proxies for the same unbound variable
<tt>same</tt>
and are bound to different values, creating a conflict which
constitutes a match failure.
</p><p>
<a name=3D"N-020602B8">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.6">7.5.6<=
/a> Vertical Versus Horizontal Calls</h4>


<p>
A function call which is the only element of the query line in
which it occurs is ambiguous. It can go either to a vertical
function or to the horizontal one. If both are defined, then
it goes to the vertical one.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define which (x))@(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0057">bind</a> x "horizontal")@(end)
<br>&nbsp;@(define&nbsp;which&nbsp;(x))
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind<=
/a>&nbsp;x&nbsp;"vertical")
<br>&nbsp;@(end)
<br>&nbsp;@(which&nbsp;fun)
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;fun=3D"vertical"
</tt>

</dd></dl>
<p>

</p><p>
Not only does this call go to the vertical function, but
it is in a vertical context.
</p><p>
If only a horizontal function is defined, then that is the one which is cal=
led,
even if the call is the only element in the line. This takes place in a
horizontal character-matching context, which requires a line of input which=
 can
be traversed:
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define which (x))@(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0057">bind</a> x "horizontal")@(end)
<br>&nbsp;@(which&nbsp;fun)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;ABC
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;[query fails]
</tt>

</dd></dl>
<p>

</p><p>
The query fails because since
<tt>@(which fun)</tt>
is in horizontal mode,
it matches characters in a line. Since the function body consists
only of
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> ..=
.)</tt>
which doesn't match any characters, the function
call requires an empty line to match. The line
<tt>ABC</tt>
is not empty,
and so there is a matching failure. The following
example corrects this:
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define which (x))@(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0057">bind</a> x "horizontal")@(end)
<br>&nbsp;@(which&nbsp;fun)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty<=
/a> line]
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;fun=3D"horizontal"
</tt>

</dd></dl>
<p>

</p><p>
A call made in a clearly horizontal context will prefer the
horizontal function, and only fall back on the vertical one
if the horizontal one doesn't exist. (In this fall-back case,
the vertical function is called with empty data; it is useful
for calling vertical functions which process arguments and
produce values.)
</p><p>
In the next example, the call is followed by trailing material,
placing it in a horizontal context. Leading material will
do the same thing:
</p><p>
Example:</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define which (x))@(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0057">bind</a> x "horizontal")@(end)
<br>&nbsp;@(define&nbsp;which&nbsp;(x))
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind<=
/a>&nbsp;x&nbsp;"vertical")
<br>&nbsp;@(end)
<br>&nbsp;@(which&nbsp;fun)B
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;B
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;fun=3D"horizontal"
</tt>

</dd></dl>
<p>

</p><p>
<a name=3D"N-03351C8D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.7">7.5.7<=
/a> Local Variables</h4>


<p>
As described earlier, variables bound in a function body which are not
parameters of the function are discarded when the function returns. However=
,
that, by itself, doesn't make these variables local, because pattern functi=
ons
have visibility to all variables in their calling environment. If a variabl=
e
<tt>x</tt>
exists already when a function is called, then an attempt to bind it inside=
 a
function may result in a failure.  The
<tt>local</tt>
directive must be used in a
pattern function to list which variables are local. </p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(define path (path))@\
    @(local x y)@\
    @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</=
a>)@\
      (@(path x))@(path y)@(<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-0057">bind</a> path `(@x)@y`)@\
    @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)@\
      @{x /[.,;'!?][^ \t\f\v]/}@(path y)@(<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-0057">bind</a> path `@x@y`)@\
    @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)@\
      @{x /[^ .,;'!?()\t\f\v]/}@(path y)@(<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-0057">bind</a> path `@x@y`)@\
    @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)@\
      @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> =
path "")@\
    @(end)@\
  @(end)
</tt></pre><tt>

</tt>

<p>
This is a horizontal function which matches a path, which lands into four
recursive cases. A path can be parenthesized path followed by a path; it ca=
n be
a certain character followed by a path, or it can be empty
</p><p>
This function ensures that the variables it uses internally,
<tt>x</tt>
and
<tt>y</tt>,
do not have anything to do with any inherited bindings for
<tt>x</tt>
and
<tt>y</tt>.
</p><p>
Note that the function is recursive, which cannot work without
<tt>x</tt>
and
<tt>y</tt>
being local, even if no such bindings exist prior to the top-level invocati=
on of the
function. The invocation
<tt>@(path x)</tt>
causes
<tt>x</tt>
to be bound, which is
visible inside the invocation
<tt>@(path y)</tt>,
but that invocation needs to have its own binding of
<tt>x</tt>
for local use.
</p><p>
<a name=3D"N-030FDF45">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.8">7.5.8<=
/a> Nested Functions</h4>


<p>
Function definitions may appear in a function. Such definitions
are visible in all functions which are invoked from the body
(and not necessarily enclosed in the body). In other words, the
scope is dynamic, not lexical.  Inner definitions shadow outer
definitions. This means that a caller can redirect the function
calls that take place in a callee, by defining local functions
which capture the references.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(define which)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-006E109C">fun</a>)
<br>&nbsp;@(end)
<br>&nbsp;@(define&nbsp;fun)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0159EBE7">output</a>)
<br>&nbsp;top-level&nbsp;fun!
<br>&nbsp;@&nbsp;&nbsp;(end)
<br>&nbsp;@(end)
<br>&nbsp;@(define&nbsp;callee)
<br>&nbsp;@&nbsp;&nbsp;(define&nbsp;fun)
<br>&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-0159EBE7">output</a>)
<br>&nbsp;local&nbsp;fun!
<br>&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;(end)
<br>&nbsp;@&nbsp;&nbsp;(end)
<br>&nbsp;@&nbsp;&nbsp;(which)
<br>&nbsp;@(end)
<br>&nbsp;@(callee)
<br>&nbsp;@(which)
</tt>

</dd><dt>output:</dt><dd>
<tt>

&nbsp;local fun!
<br>&nbsp;top-level&nbsp;fun!
</tt>

</dd></dl>
<p>

</p><p>
Here, the function
<tt>which</tt>
is defined which calls
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>.
A top-level definition of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
is introduced which
outputs
<tt>"top-level fun!"</tt>.
The function
<tt>callee</tt>
provides its own local
definition of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
which outputs
<tt>"local fun!"</tt>

before calling
<tt>which</tt>.
When
<tt>callee</tt>
is invoked, it calls
<tt>which</tt>,
whose
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a>=
)</tt>
call is routed to callee's
local definition.  When
<tt>which</tt>
is called directly from the top level, its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
call goes to the top-level definition.
</p><p>
<a name=3D"N-0375A4EA">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.5.9">7.5.9<=
/a> Indirect Calls</h4>


<p>
Function indirection may be performed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
directive. If
<tt><i>fun-expr</i></tt>
is an Lisp expression which evaluates to a symbol, and
that symbol names a function which takes no arguments, then
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
386C775">call</a> fun-expr)
</tt></pre><tt>

</tt>

may be used to invoke the function. Additional
expressions may be supplied which specify arguments.
<p>
Example 1:
</p><p>
<tt>

&nbsp;@(define foo (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021=
33AA5">arg</a>))
<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057"=
>bind</a>&nbsp;arg&nbsp;"abc")
<br>&nbsp;&nbsp;@(end)
<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C=
775">call</a>&nbsp;'foo&nbsp;b)
</tt>

</p><p>
In this example, the effect is that
<tt>foo</tt>
is invoked, and
<tt>b</tt>
ends up bound to
<tt>"abc"</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
directive here uses the
<tt>'foo</tt>
expression to calculate the name of the function to be invoked.
(See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>
operator).
</p><p>
This particular
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
expression can just be replaced by the direct invocation
syntax
<tt>@(foo b)</tt>.
</p><p>
The power of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
lies in being able to specify the function as a value which
comes from elsewhere in the program, as in the following example.
</p><p>
<tt>

&nbsp;@(define foo (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021=
33AA5">arg</a>))
<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057"=
>bind</a>&nbsp;arg&nbsp;"abc")
<br>&nbsp;&nbsp;@(end)
<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057"=
>bind</a>&nbsp;f&nbsp;@'foo)
<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C=
775">call</a>&nbsp;f&nbsp;b)
</tt>

</p><p>
Here the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
directive obtains the name of the function from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
variable.
</p><p>
Note that function names are resolved to functions in the environment
that is apparent at the point in execution where the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
takes place. The directive
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a=
> f args ...)</tt>
is precisely equivalent to
<tt>@(s args ...)</tt>
if, at the point of the call,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
is a variable which holds the symbol
<tt>s</tt>
and symbol
<tt>s</tt>
is defined as a function. Otherwise it is erroneous.
</p><p>
<a name=3D"N-0035A666">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.6">7.6</a> =
Modularization</h3>



<p>


</p><p>
<a name=3D"N-01A2ECA0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.6.1">7.6.1<=
/a> The <tt>load</tt> and <tt>include</tt> directives</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directives is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080"=
>load</a> </tt><tt><i>expr</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2E=
CA0">include</a> </tt><tt><i>expr</i></tt><tt>)=20

</tt>

</p><p>
Where
<tt><i>expr</i></tt>
is a Lisp expression that
evaluates to a string giving the path of the file to load.
</p><p>
Firstly, the path given by
<tt><i>expr</i></tt>
is converted to an effective path, as follows.
</p><p>
If the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
variable has a current value which is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and the path given in
<tt><i>expr</i></tt>
is pure relative according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019DEA44">pure-rel-=
path-p</a></tt>
function, then the effective path is interpreted taken relative
to the directory portion of the path which is stored in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
is nil, or the load path is not pure relative, then the
path is taken as-is as the effective path.
</p><p>
Next, an attempt is made to open the file for processing, in
almost exactly the same manner as by the <b>TXR Lisp</b> function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
.
The difference is that if the effective path is unsuffixed,
then the
<tt>.txr</tt>
suffix is added to it, and that resulting path is tried first,
and if it succeeds, then the file is treated as <b>TXR</b> Pattern
Language syntax.
If that fails, then the suffix
<tt>.tlo</tt>
is tried, and so forth, as described for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function.
</p><p>
Both the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directives bind the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
variable to the path of the loaded file just before parsing syntax from it,
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable is also given a new dynamic binding, whose value is the
same as the existing binding. These bindings are removed when the
load operation completes, restoring the prior values of these
variables.
</p><p>
If the file opened for processing is <b>TXR Lisp</b> source, or
a compiled <b>TXR Lisp</b> file, then it is processed in the manner
described for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function.
</p><p>
Different requirements apply to the processing of the file under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directives.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directive performs the processing of the file at parse time. If the
file being processed is <b>TXR</b> Pattern Language, then it is parsed,
and then its syntax replaces the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directive, as if it had originally appeared in its place.
If a <b>TXR Lisp</b> source or a compiled <b>TXR Lisp</b> file is processed=
 by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directive is removed from the syntax.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
directive performs the processing of the file at evaluation time.
Evaluation time
occurs after a <b>TXR</b> program is read from beginning to end and parsed.
That is to say, when a <b>TXR</b> query is parsed, any embedded
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a> ..=
.)</tt>
forms in it are parsed and constitute part of its syntax tree.
They are executed when that query is executed, whenever its execution
reaches those
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
directives. When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
directive processes <b>TXR</b> Pattern Language syntax, it parses
the file in its entirety and then executes that file's directives
against the current input position. Repeated executions of the
same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
directive result in repeated processing of the file.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include</=
a></tt>
directive is useful for loading <b>TXR</b> files which contain Lisp macros
which are needed by the parent program. The parent program cannot use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
to bring in macros because macros are required during expansion, which
takes place prior to evaluation time, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
doesn't execute until evaluation time.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03561A65">self-path=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008E4BC2">stdlib</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
variables in <b>TXR Lisp</b>.
</p><p>
<a name=3D"N-016CB7C5">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7">7.7</a> =
Output</h3>



<p>


</p><p>
<a name=3D"N-00798E09">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.1">7.7.1<=
/a> Introduction</h4>


<p>
A <b>TXR</b> query may perform custom output. Output is performed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
clauses,
which may be embedded anywhere in the query, or placed at the end.  Output
occurs as a side effect of producing a part of a query which contains an
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
directive, and is executed even if that part of the query ultimately
fails to find a match. Thus output can be useful for debugging.
An
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
clause specifies that its output goes to a file, pipe, or (by
default) standard output. If any output clause is executed whose destinatio=
n is
standard output, <b>TXR</b> makes a note of this, and later, just prior to
termination, suppresses the usual printing of the variable bindings or the =
word
false.
</p><p>
<a name=3D"N-0159EBE7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.2">7.7.2<=
/a> The <tt>output</tt> directive</h4>



<p>
The syntax of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
directive is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159E=
BE7">output</a> [ </tt><tt><i>destination</i></tt><tt> ] { </tt><tt><i>bool=
-keyword</i></tt><tt> | </tt><tt><i>keyword</i></tt><tt> </tt><tt><i>value<=
/i></tt><tt> }* )=20

<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;.&nbsp;one&nbsp;or&nbsp;more&nbsp;output&nbsp;directives&nb=
sp;or&nbsp;lines
<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;@(end)
</tt>

</p><p>
If the directive has arguments, then the first one is evaluated.
If it is an object other than a keyword symbol, then it specifies
the optional
<tt><i>destination</i></tt>.
Any remaining arguments after the optional destination are
the keyword list. If the destination is missing, then the
entire argument list is a keyword list.
</p><p>
The
<tt><i>destination</i></tt>
argument,
if present,
is treated as a <b>TXR Lisp</b> expression and evaluated.
The resulting value is taken as the output destination. The value may be a
string which gives the path name of a file to open for output. Otherwise,
the destination must be a stream object.
</p><p>
The keyword list consists of a mixture of Boolean keywords which
do not have an argument, or keywords with arguments.
</p><p>
The following Boolean keywords are supported:
</p><p>
</p><dl class=3D"items">
<dt><tt>:nothrow</tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
directive throws an exception if the output destination
cannot be opened, unless the
<tt>:nothrow</tt>
keyword is present, in which
case the situation is treated as a match failure.
<p>
Note that since command pipes are processes that report errors
asynchronously, a failing command will not throw an immediate exception tha=
t
can be suppressed with
<tt>:nothrow</tt>.
This is for synchronous errors, like
trying to open a destination file, but not having permissions, etc.
</p><p>
</p></dd><dt><tt>:append</tt></dt><dd>

This keyword is meaningful for files, specifying append mode: the output is=
 to
be added to the end of the file rather than overwriting the file.
<p>
The following value keywords are supported:
</p><p>
</p></dd><dt><tt>:filter</tt></dt><dd>

The argument can be a symbol, which specifies a filter to be applied to
the variable substitutions occurring within the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
clause.
The argument can also be a list of filter symbols, which specifies
that multiple filters are to be applied, in left to right order.
<p>
See the later sections Output Filtering below, and The Deffilter Directive.
</p><p>
</p></dd><dt><tt>:into</tt></dt><dd>

The argument of
<tt>:into</tt>
is a symbol which denotes a variable.
The output will go into that variable.  If the variable is unbound,
it will be created. Otherwise, its contents are overwritten
unless the
<tt>:append</tt>
keyword is used. If
<tt>:append</tt>
is used, then
the new content will be appended to the previous content of
the variable, after flattening the content to a list,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a></=
tt>
directive.
<p>
</p></dd><dt><tt>:named</tt></dt><dd>

The argument of
<tt>:named</tt>
is a symbol which denotes a variable.
The file or pipe stream which is opened for the output is
stored in this variable, and is not closed at the end of the
output block. This allows a subsequent output block to continue
output on the same stream, which is possible using the
next two keywords,
<tt>:continue</tt>
or
<tt>:finish</tt>.
A new binding is established for the variable, even if it
already has an existing binding.
<p>
</p></dd><dt><tt>:continue</tt></dt><dd>

A destination should not be specified if
<tt>:continue</tt>
is used.  The argument of
<tt>:continue</tt>
is an expression, such as a variable name, that evaluates to a
stream object. That stream object is used for the output block.
At the end of the output block, the stream is flushed, but not
closed.  A usage example is given in the documentation for the Close Direct=
ive
below.
<p>
</p></dd><dt><tt>:finish</tt></dt><dd>

A destination should not be specified if
<tt>:finish</tt>
is used.  The argument of
<tt>:finish</tt>
is an expression, such as a variable name, that evaluates to a
stream object. That stream object is used for the output block.
At the end of the output block, the stream is closed.
An example is given in the documentation for the Close Directive
below.
<p>
</p></dd></dl>
<a name=3D"N-007B5ECB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.3">7.7.3</a> =
Output Text</h4>


<p>
Text in an output clause is not matched against anything, but is output
verbatim to the destination file, device or command pipe.
</p><p>
<a name=3D"N-01C7272E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.4">7.7.4<=
/a> Output Variables</h4>


<p>
Variables occurring in an output clause do not match anything; instead
their contents are output.
</p><p>
A variable being output can be any object. If it is of a type other
than a list or string, it will be converted to a string as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostring<=
/a></tt>
function in <b>TXR Lisp</b>.
</p><p>
A list is converted to a string in a special way: the elements are
individually converted to a string and then they are catenated together.
The default separator string is a single space: an alternate separation
can be specified as an argument in the brace substitution syntax.
Empty lists turn into an empty string.
</p><p>
Lists may be output within
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>
or
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
clauses. Each nesting of
these constructs removes one level of nesting from the list variables
that it contains.
</p><p>
In an output clause, the
<tt>




@{</tt><tt><i>name</i></tt><tt> </tt><tt><i>number</i></tt><tt>}=20

</tt>

variable syntax generates fixed-width
field, which contains the variable's text.  The absolute value of the
number specifies the field width. For instance
<tt>-20</tt>
and
<tt>20</tt>
both specify a field
width of twenty.  If the text is longer than the field, then it overflows t=
he
field. If the text is shorter than the field, then it is left-adjusted with=
in
that field, if the width is specified as a positive number, and right-adjus=
ted
if the width is specified as negative.
</p><p>
An output variable may specify a filter which overrides any filter establis=
hed
for the output clause. The syntax for this is
<tt>




@{NAME :filter </tt><tt><i>filterspec</i></tt><tt>}.=20

</tt>

The filter specification syntax is the same as in the output clause.
See Output Filtering below.
</p><p>
<a name=3D"N-01F15AE8">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.5">7.7.5<=
/a> Output Variables: Indexing</h4>


<p>
Additional syntax is supported in output variables that does not appear
in pattern matching variables.
</p><p>
A square bracket index notation may be used to extract elements or
ranges from a variable, which works with strings, vectors and lists.  Eleme=
nts
are indexed from zero. This notation is only available in brace-enclosed
syntax, and looks like this:
</p><p>



</p><dl class=3D"items">
<dt><tt>@{name[<tt><i>expr</i></tt><tt>]} </tt></tt></dt><dd>



Extract the element at the position given by
<tt><i>expr</i></tt>.
<p>



</p></dd><dt><tt>@{name[<tt><i>expr1..expr2</i></tt><tt>]} </tt></tt></dt><=
dd>



Extract a range of elements from the position given by
<tt><i>expr1</i></tt>,
up to
one position less than the position given by
<tt><i>expr2</i></tt>.
<p>
If the variable is a list, it is treated as a list substitution,
exactly as if it were the value of an unsubscripted list variable.
The elements of the list are converted to strings and catenated
together wit ha separator string between them, the default one being
a single space.
</p><p>
An alternate character may be given as a string argument in the brace
notation.
</p></dd></dl>
<p>

</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> a ("a" "b" "c" "d"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
>)
  @{a[1..3] "," 10}
  @(end)
</tt></pre><tt>

</tt>

<p>
The above produces the text
<tt>"b,c"</tt>

in a field
<tt>10</tt>
spaces wide. The
<tt>[1..3]</tt>
argument extracts a range of
<tt>a</tt>;
the
<tt>","</tt>

argument specifies an alternate
separator string, and
<tt>10</tt>
specifies the field width.
</p><p>
<a name=3D"N-0323B78E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.6">7.7.6<=
/a> Output Substitutions</h4>


<p>
The brace syntax has another syntactic and semantic extension in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
clauses. In place
of the symbol, an expression may appear. The value of that expression
is substituted.
</p><p>
Example:
</p><p>
<tt>

<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind<=
/a>&nbsp;a&nbsp;"foo")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">o=
utput</a>)
<br>&nbsp;@{`@a:`&nbsp;-10}
</tt>

</p><p>
Here, the quasiliteral expression
<tt>`@a:`</tt>
is evaluated, producing the string
<tt>"foo:"</tt>.
This string is printed right-adjusted in a
<tt>10</tt>
character field.
</p><p>
<a name=3D"N-00CB3FB7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.7">7.7.7<=
/a> The <tt>repeat</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
directive generates repeated text from a "boilerplate",
by taking successive elements from lists. The syntax of repeat is
like this:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
052">repeat</a>)
  .
  .
  main clause material, required
  .
  .
  special clauses, optional
  .
  .
  @(end)
</tt></pre><tt>

</tt>

<p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
has four types of special clauses, any of which may be
specified with empty contents, or omitted entirely. They are described
below.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
takes arguments, also described below.
</p><p>
All of the material in the main clause and optional clauses
is examined for the presence of variables.  If none of the variables
hold lists which contain at least one item, then no output is performed,
(unless the repeat specifies an
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</=
a>)</tt>
clause, see below).
Otherwise, among those variables which contain non-empty lists, repeat find=
s
the length of the longest list. This length of this list determines the num=
ber
of repetitions, R.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
contains only a main clause, then the lines of this clause is
output R times. Over the first repetition, all of the variables which, outs=
ide
of the repeat, contain lists are locally rebound to just their first item. =
Over
the second repetition, all of the list variables are bound to their second
item, and so forth. Any variables which hold shorter lists than the longest
list eventually end up with empty values over some repetitions.
</p><p>
Example: if the list
<tt>A</tt>
holds
<tt>"1"</tt>,
<tt>"2"</tt>

and
<tt>"3"</tt>;
the list
<tt>B</tt>
holds
<tt>"A"</tt>,
<tt>"B"</tt>;
and the variable
<tt>C</tt>
holds
<tt>"X"</tt>,
then
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
052">repeat</a>)
  &gt;&gt; @C
  &gt;&gt; @A @B
  @(end)
</tt></pre><tt>

</tt>

<p>
will produce three repetitions (since there are two lists, the longest
of which has three items). The output is:
</p><p>
<tt>
</tt></p><pre><tt>  &gt;&gt; X
  &gt;&gt; 1 A
  &gt;&gt; X
  &gt;&gt; 2 B
  &gt;&gt; X
  &gt;&gt; 3
</tt></pre><tt>

</tt>

<p>
The last line has a trailing space, since it is produced by
<tt>"@A @B"</tt>,
where
<tt>B</tt>
has an empty value. Since
<tt>C</tt>
is not a list variable, it
produces the same value in each repetition.
</p><p>
The special clauses are:
</p><p>
</p><dl class=3D"items">
<dt><tt>@(single)</tt></dt><dd>

If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
produces exactly one repetition, then the contents of this clause
are processed for that one and only repetition, instead of the main clause
or any other clause which would otherwise be processed.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6=
0463">first</a>)</tt></dt><dd>

The body of this clause specifies an alternative body to be used for the fi=
rst
repetition, instead of the material from the main clause.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A=
">last</a>)</tt></dt><dd>

The body of this clause is used instead of the main clause for the last
repetition.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0049=
18EB">empty</a>)</tt></dt><dd>

If the repeat produces no repetitions, then the body of this clause is outp=
ut.
If this clause is absent or empty, the repeat produces no output.
<p>
</p></dd><dt><tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076=
">mod</a> n m)</tt></dt><dd>

The forms
<tt>n</tt>
and
<tt>m</tt>
are Lisp expressions that evaluate to integers. The value of
<tt>m</tt>
should be nonzero. The clause denoted this way is active if the repetition
modulo
<tt>m</tt>
is equal to
<tt>n</tt>.
The first repetition is numbered zero.
For instance the clause headed by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a> 0 2=
)</tt>
will be used on repetitions 0, 2, 4, 6, ...  and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a> 1 2=
)</tt>
will be used on repetitions 1, 3, 5, 7, ...
<p>
</p></dd><dt><tt>@(modlast n m)</tt></dt><dd>

The meaning of
<tt>n</tt>
and
<tt>m</tt>
is the same as in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a> n m=
)</tt>,
but one more condition
is imposed. This clause is used if the repetition modulo
<tt>m</tt>
is equal to
<tt>n</tt>,
and if it is the last repetition.
</dd></dl>
<p>

</p><p>
The precedence among the clauses which take an iteration is:
<tt>single &gt; first &gt; mod &gt; modlast &gt; last &gt; main</tt>.
That is if two or more of these
clauses can apply to a repetition, then the leftmost one in this precedence
list applies. For instance, if there is just a single repetition, then any =
of
these special clause types can apply to that repetition, since it is the on=
ly
repetition, as well as the first and last one. In this situation, if there =
is a
<tt>@(single)</tt>
clause present, then the repetition is processed using that clause.
Otherwise, if there is a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</=
a>)</tt>
clause present, that clause is used. Failing
that,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a>)</t=
t>
is used if there is such a clause and its numeric conditions
are satisfied. If there isn't, then
<tt>@(modlast)</tt>
clauses are considered, and if there
are none, or none of them activate, then
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)</=
tt>
is considered. Finally if none
of all these clauses are present or apply, then the repetition is processed
using the main clause.
</p><p>
Repeat supports arguments.
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052"=
>repeat</a>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [:counter {</tt><tt><i>symbol</i></tt><t=
t> | (</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>expr</i></tt><tt>)}]=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [:vars ({</tt><tt><i>symbol</i></tt><tt>=
 | (</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>expr</i></tt><tt>)}*)])=20

</tt>

</p><p>
The
<tt>:counter</tt>
argument designates a symbol which will behave as an integer
variable over the scope of the clauses inside the repeat. The variable prov=
ides
access to the repetition count, starting at zero, incrementing with each
repetition. If the the argument is given as
<tt>




(</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>expr</i></tt><tt>)=20

</tt>

then
<tt><i>expr</i></tt>
is a Lisp expression whose value is taken as a displacement value which
is added to each iteration of the counter. For instance
<tt>:counter (c 1)</tt>
specifies a counter
<tt>c</tt>
which counts from 1.
</p><p>
The
<tt>:vars</tt>
argument specifies a list of variable name symbols
<tt><i>symbol</i></tt>
or else pairs of the form
<tt>




(</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

consisting of a variable name and Lisp expression. Historically, the former
syntax informed
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
about references to variables contained in Lisp code. This usage is no
longer necessary as of <b>TXR</b> 243, since the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
construct walks Lisp code, identifying all free variables.
The latter syntax introduces a new pattern variable binding for
<tt><i>symbol</i></tt>
over the scope of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
construct. The
<tt><i>init-form</i></tt>
specifies a Lisp expression which is evaluated to produce the
binding's value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
directive then processes the list of variables, selecting from it
those which have a binding, either a previously existing binding or the
one just introduced. For each selected variable, repeat
will assume that the variable occurs in the repeat block and contains
a list to be iterated.
</p><p>
The variable binding syntax supported by
<tt>:vars</tt>
of the form
<tt>




(</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

provides a solution for situations when it is necessary to iterate
over some list, but that list is the result of an expression, and not store=
d in
any variable. A repeat block iterates only over lists emanating from variab=
les;
it does not iterate over lists pulled from arbitrary expressions.
</p><p>
Example: output all file names matching the
<tt>*.txr</tt>
pattern in the current directory:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a> :v=
ars ((name (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">g=
lob</a> "*.txr"))))
  @name
  @(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
Prior to <b>TXR</b> 243, the simple variable binding syntax supported by
<tt>:vars</tt>
of the form
<tt><i>symbol</i></tt>
binding was needed for situations in which <b>TXR Lisp</b> expressions whic=
h
reference variables were embedded in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>
blocks.  Variables references embedded in Lisp code were not identified
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>.
For instance, the following produced no output, because no variables
were found in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
body:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> trigraph ("abc" "def" "ghi"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">reverse</=
a> trigraph)
  @(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
There is a reference to
<tt><i>list</i></tt>
but it's inside a Lisp
<tt>(reverse lisp)</tt>
expression that was not processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>.
The solution was to mention
<tt><i>list</i></tt>
via the
<tt>:vars</tt>
construct:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> trigraph ("abc" "def" "ghi"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a> :v=
ars (trigraph))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">reverse</=
a> trigraph)
  @(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
Then the repeat block would iterates over list, producing the output:
</p><p>
<tt>
</tt></p><pre><tt>  cba
  fed
  igh
</tt></pre><tt>

</tt>

<p>
This workaround is no longer required as of <b>TXR</b> 243; the output
is produced by the first example, without
<tt>:vars</tt>.
</p><p>

<a name=3D"N-017CF83A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.8">7.7.8<=
/a> Nested <tt>repeat</tt> directives</h4>



<p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
clause encloses variables which hold multidimensional lists,
those lists require additional nesting levels of repeat (or rep).
It is an error to attempt to output a list variable which has not been
decimated into primary elements via a repeat construct.
</p><p>
Suppose that a variable
<tt>X</tt>
is two-dimensional (contains a list of lists).
<tt>X</tt>
must be twice nested in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>.
The outer repeat will traverse the lists
contained in
<tt>X</tt>.
The inner repeat will traverse the elements of each of these
lists.
</p><p>
A nested repeat may be embedded in any of the clauses of a repeat,
not only the main clause.
</p><p>
<a name=3D"N-0343AA1B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.9">7.7.9<=
/a> The <tt>rep</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a></tt>
directive is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>.
Whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
is line oriented,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a></tt>
generates material within a line. It has all the same clauses,
but everything is specified within one line:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
00E">rep</a>)... main material ... .... special clauses ...@(end)
</tt></pre><tt>

</tt>

<p>
More than one
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
can occur within a line, mixed with other material.
A
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
can be nested within a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a>)=
</tt>
or within another
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>.
</p><p>
Also,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
accepts the same
<tt>:counter</tt>
and
<tt>:vars</tt>
arguments.
</p><p>

<a name=3D"N-00B81F3D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.10">7.7.1=
0</a> <tt>repeat</tt> and <tt>rep</tt> Examples</h4>



<p>
Example 1: show the list
<tt>L</tt>
in parentheses, with spaces between
the elements, or the word
<tt>EMPTY</tt>
if the list is empty:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)@L @(=
single)(@L)@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">=
first</a>)(@L @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">l=
ast</a>)@L)@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">=
empty</a>)EMPTY@(end)
  @(end)
</tt></pre><tt>

</tt>

<p>
Here, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</=
a>)</tt>
clause specifies
<tt>EMPTY</tt>.
So if there are no repetitions,
the text
<tt>EMPTY</tt>
is produced. If there is a single item in the list
<tt>L</tt>,
then
<tt>@(single)(@L)</tt>
produces that item between parentheses.  Otherwise
if there are two or more items, the first item is produced with
a leading parenthesis followed by a space by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</=
a>)(@L</tt>
and the last item is produced with a closing parenthesis:
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)@L=
)</tt>.
All items in between are emitted with a trailing space by
the main clause:
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)@L<=
/tt>.
</p><p>
Example 2: show the list L like Example 1 above, but the empty list is
<tt>()</tt>.
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a>)
  (@(rep)@L @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">las=
t</a>)@L@(end))
  @(end)
</tt></pre><tt>

</tt>

<p>
This is simpler. The parentheses are part of the text which
surrounds the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
construct, produced unconditionally.
If the list
<tt>L</tt>
is empty, then
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)</t=
t>
produces no output, resulting in
<tt>()</tt>.
If the list
<tt>L</tt>
has one or more items, then they are produced with
spaces each one, except the last which has no space.
If the list has exactly one item, then the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)</=
tt>
applies to it
instead of the main clause: it is produced with no trailing space.
</p><p>
<a name=3D"N-0399709A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.11">7.7.1=
1</a> The <tt>close</tt> directive</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>
directive is:
</p><p>
<tt>




<br>&nbsp;&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030"=
>close</a> </tt><tt><i>expr</i></tt><tt>)=20

</tt>

</p><p>
Where
<tt><i>expr</i></tt>
evaluates to a stream. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>
directive can be
used to explicitly close streams created using
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a> =
... :named </tt><tt><i>var</i></tt><tt>)=20

</tt>

syntax, as an alternative to
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a> =
:finish </tt><tt><i>expr</i></tt><tt>).=20

</tt>

</p><p>
Examples:
</p><p>
Write two lines to
<tt>"foo.txt"</tt>

over two output blocks using
a single stream:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a> "foo.txt" :named foo)
  Hello,
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
> :continue foo)
  world!
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a> foo=
)
</tt></pre><tt>

</tt>

<p>
The same as above, using
<tt>:finish</tt>
rather than
<tt>:continue</tt>
so that the stream is closed at the end of the second block:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a> "foo.txt" :named foo)
  Hello,
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
> :finish foo)
  world!
  @(end)
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-011C2741">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.12">7.7.1=
2</a> Output Filtering</h4>


<p>
Often it is necessary to transform the output to preserve its meaning
under the convention of a given data format. For instance, if a piece of
text contains the characters
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>=
,
then if that text is being
substituted into HTML, these should be replaced by
<tt>&amp;lt;</tt>
and
<tt>&amp;gt;</tt>.
This is what filtering is for.  Filtering is applied to the contents of out=
put
variables, not to any template text.
<b>TXR</b> implements named filters.  Built-in filters are named by keyword=
s, given
below. User-defined filters are possible, however.  See notes on the deffil=
ter
directive below.
</p><p>
Instead of a filter name, the syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> </tt=
><tt><i>name</i></tt><tt>)=20

</tt>

can be used. This
denotes that the function called
<tt><i>name</i></tt>
is to be used as a filter.
This is described in the next section Function Filters below.
</p><p>
Built-in filters named by keywords:
</p><p>
</p><dl class=3D"items">
<dt><tt>:tohtml</tt></dt><dd>

Filter text to HTML, representing special characters using HTML
ampersand sequences. For instance
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
is replaced by
<tt>&amp;gt;</tt>.
<p>
</p></dd><dt><tt>:tohtml*</tt></dt><dd>

Filter text to HTML, representing special characters using HTML
ampersand sequences. Unlike
<tt>:tohtml</tt>,
this filter doesn't treat the single and double quote characters.
It is not suitable for preparing HTML fragments which end up
inserted into HTML tag attributes.
<p>
</p></dd><dt><tt>:fromhtml</tt></dt><dd>

Filter text with HTML codes into text in which the codes are replaced by th=
e
corresponding characters. For instance
<tt>&amp;gt;</tt>
is replaced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>=
.
<p>
</p></dd><dt><tt>:upcase</tt></dt><dd>

Convert the 26 lower case letters of the English alphabet to upper case.
<p>
</p></dd><dt><tt>:downcase</tt></dt><dd>

Convert the 26 upper case letters of the English alphabet to lower case.
<p>
</p></dd><dt><tt>:frompercent</tt></dt><dd>

Decode percent-encoded text. Character triplets consisting
of the
<tt>%</tt>
character followed by a pair of hexadecimal digits (case insensitive)
are are converted to bytes having the value represented by the hexadecimal
digits (most significant nybble first). Sequences of one or more such bytes=
 are
treated as UTF-8 data  and decoded to characters.
<p>
</p></dd><dt><tt>:topercent</tt></dt><dd>

Convert to percent encoding according to RFC 3986. The text is first conver=
ted
to UTF-8 bytes. The bytes are then converted back to text as follows.
Bytes in the range 0 to 32, and 127 to 255 (note: including the ASCII DEL),=
 bytes whose values correspond to ASCII characters which are listed by RFC =
3986 as being in the "reserved set", and the byte value corresponding to th=
e
ASCII
<tt>%</tt>
character are encoded as a three-character sequence consisting
of the
<tt>%</tt>
character followed by two hexadecimal digits derived from the
byte value (most significant nybble first, upper case). All other bytes
are converted directly to characters of the same value without any such
encoding.
<p>
</p></dd><dt><tt>:fromurl</tt></dt><dd>

Decode from URL encoding, which is like percent encoding, except that
if the unencoded
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
character occurs, it is decoded to a space character. The
<tt>%20</tt>
sequence still decodes to space, and
<tt>%2B</tt>
to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
character.
<p>
</p></dd><dt><tt>:tourl</tt></dt><dd>

Encode to URL encoding, which is like percent encoding except that
a space maps to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
rather than
<tt>%20</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
character, being in the
reserved set, encodes to
<tt>%2B</tt>.
<p>
</p></dd><dt><tt>:frombase64</tt></dt><dd>

Decode from the Base 64 encoding described in RFC 4648, section 5.
<p>
</p></dd><dt><tt>:tobase64</tt></dt><dd>

Encode to the Base 64 encoding described in RFC 4648, section 5.
<p>
</p></dd><dt><tt>:frombase64url</tt></dt><dd>

Decode from the Base64 encoding described in RFC 4648, section 6.
This uses the URL and filename safe alphabet, in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
(plus) and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(slash) characters used in regular Base 64 are respectively replaced with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
(minus) and
<tt>_</tt>
(underscore).
<p>
</p></dd><dt><tt>:tobase64url</tt></dt><dd>

Encode to the Base 64 encoding described in RFC 4648, section 6.  See
<tt>:frombase64url</tt>
above.
<p>
</p></dd><dt><tt>:tonumber</tt></dt><dd>

Converts strings to numbers. Strings that contain a period,
<tt>e</tt>
or
<tt>E</tt>
are converted to floating point as if by the Lisp function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">flo-str</=
a></tt>.
Otherwise they are converted to integer as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>
with a radix of 10.
Non-numeric junk results in the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
</p></dd><dt><tt>:toint</tt></dt><dd>

Converts strings to integers as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>
with a radix of 10.
Non-numeric junk results in the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
</p></dd><dt><tt>:tofloat</tt></dt><dd>

Converts strings to floating-point values as if using the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">flo-str</=
a></tt>.
Non-numeric junk results in the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
</p></dd><dt><tt>:hextoint</tt></dt><dd>

Converts strings to integers as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>
with a radix of 16.
Non-numeric junk results in the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
</p></dd></dl>
<p>

</p><p>
Examples:
</p><p>
To escape HTML characters in all variable substitutions occurring in an
output clause, specify
<tt>:filter :tohtml</tt>
in the directive:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a> :filter :tohtml)
  ...
  @(end)
</tt></pre><tt>

</tt>

<p>
To filter an individual variable, add the syntax to the variable spec:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a>)
  @{x :filter :tohtml}
  @(end)
</tt></pre><tt>

</tt>

<p>
Multiple filters can be applied at the same time. For instance:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a>)
  @{x :filter (:upcase :tohtml)}
  @(end)
</tt></pre><tt>

</tt>

<p>
This will fold the contents of
<tt>x</tt>
to upper case, and then encode any special
characters into HTML. Beware of combinations that do not make sense.
For instance, suppose the original text is HTML, containing codes
like
<tt>&amp;quot;</tt>.
The compound filter
<tt>(:upcase :fromhtml)</tt>
will not work
because
<tt>&amp;quot;</tt>
will turn to
<tt>&amp;QUOT;</tt>
which no longer be recognized by the
<tt>:fromhtml</tt>
filter, since the entity names in HTML codes
are case-sensitive.
</p><p>
Capture some numeric variables and convert to numbers:
</p><p>
<tt>
</tt></p><pre><tt>  @date @time @temperature @pressure
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B50006">filter</a=
> :tofloat temperature pressure)
  @;; temperature and pressure can now be used in calculations
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-029EF765">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.13">7.7.1=
3</a> Function Filters</h4>


<p>
A function can be used as a filter. For this to be possible, the function m=
ust
conform to certain rules:
</p><dl class=3D"items">
<dt>1.</dt><dd>
The function must take two special arguments, which may be followed
by additional arguments.
</dd><dt>2.</dt><dd>
When the function is called, the first argument will be bound to a string,
and the second argument will be unbound. The function must produce a value =
by binding it to the second argument. If the filter is to be used
as the final filter in a chain, it must produce a string.
</dd></dl>
<p>

</p><p>
For instance, the following is a valid filter function:
</p><p>
<tt>
</tt></p><pre><tt>  @(define foo_to_bar (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-016BE41C">in</a> out))
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :s=
tring in)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</=
a>)
  foo
  @    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> =
out "bar")
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)
  @    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> =
out in)
  @  (end)
  @(end)
</tt></pre><tt>

</tt>

<p>
This function binds the
<tt>out</tt>
parameter to
<tt>"bar"</tt>

if the in parameter
is
<tt>"foo"</tt>,
otherwise it binds the
<tt>out</tt>
parameter to a copy of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016BE41C">in</a></t=
t>
parameter.
This is a simple filter.
</p><p>
To use the filter, use the syntax
<tt>(:fun foo_to_bar)</tt>
in place of a filter name.
For instance in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
directive:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> "foo" "bar" :lfilt (:fun foo_to_bar))
</tt></pre><tt>

</tt>

<p>
The above should succeed since the left side is filtered from
<tt>"foo"</tt>

to
<tt>"bar"</tt>,
so that there is a match.
</p><p>
Function filters can be used in a chain:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
159EBE7">output</a> :filter (:downcase (:fun foo_to_bar) :upcase))
  ...
  @(end)
</tt></pre><tt>

</tt>

<p>
Here is a split function which takes an extra argument
which specifies the separator:
</p><p>
<tt>
</tt></p><pre><tt>  @(define split (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-016BE41C">in</a> out sep))
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> :l=
ist in)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a>)@(=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">maybe</a>)@to=
ken@sep@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)@=
token@(end)@(end)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> ou=
t token)
  @(end)
</tt></pre><tt>

</tt>

<p>
Furthermore, note that it produces a list rather than a string.
This function separates the argument in into tokens according to the
separator text carried in the variable
<tt>sep</tt>.
</p><p>
Here is another function,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join</a><=
/tt>,
which catenates a list:
</p><p>
<tt>
</tt></p><pre><tt>  @(define join (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-016BE41C">in</a> out sep))
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a> :into out)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000E">rep</a>)@in=
@sep@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)@i=
n@(end)
  @  (end)
  @(end)
</tt></pre><tt>

</tt>

<p>
Now here is these two being used in a chain:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> text "how,are,you")
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
> :filter (:fun split ",") (:fun join "-"))
  @text
  @(end)
</tt></pre><tt>

</tt>

<p>
Output:
</p><p>
<tt>
</tt></p><pre><tt>  how-are-you
</tt></pre><tt>

</tt>

<p>
When the filter invokes a function, it generates the first two arguments
internally to pass in the input value and capture the output. The remaining
arguments from the
<tt>(:fun ...)</tt>
construct are also passed to the function.
Thus the string objects
<tt>","</tt>

and
<tt>"-"</tt>

are passed as the
<tt>sep</tt>
argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join</a><=
/tt>.
</p><p>
Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
puts out a list, which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join</a><=
/tt>
accepts. So the overall filter
chain operates on a string: a string goes into split, and a string comes ou=
t of
join.
</p><p>
<a name=3D"N-00BDE41F">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.14">7.7.1=
4</a> The <tt>deffilter</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter=
</a></tt>
directive allows a query to define a custom filter, which
can then be used in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
clauses to transform substituted data.
</p><p>
The syntax of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter=
</a></tt>
is illustrated in this example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffi=
lter</a> rot13
<br>&nbsp;&nbsp;&nbsp;&nbsp;("a"&nbsp;"n")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("b"&nbsp;"o")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("c"&nbsp;"p")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("d"&nbsp;"q")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("e"&nbsp;"r")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("f"&nbsp;"s")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("g"&nbsp;"t")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("h"&nbsp;"u")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("i"&nbsp;"v")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("j"&nbsp;"w")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("k"&nbsp;"x")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("l"&nbsp;"y")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("m"&nbsp;"z")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("n"&nbsp;"a")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("o"&nbsp;"b")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("p"&nbsp;"c")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("q"&nbsp;"d")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("r"&nbsp;"e")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("s"&nbsp;"f")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("t"&nbsp;"g")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("u"&nbsp;"h")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("v"&nbsp;"i")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("w"&nbsp;"j")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("x"&nbsp;"k")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("y"&nbsp;"l")
<br>&nbsp;&nbsp;&nbsp;&nbsp;("z"&nbsp;"m"))
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@line
<br>&nbsp;@(end)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">o=
utput</a>&nbsp;:filter&nbsp;rot13)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repea=
t</a>)
<br>&nbsp;@line
<br>&nbsp;@(end)
<br>&nbsp;@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;hey there!
</tt>

</dd><dt>output:</dt><dd>
<tt>

&nbsp;url gurer!
</tt>

</dd></dl>
<p>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter=
</a></tt>
symbol must be followed by the name of the filter to be defined,
followed by bind expressions which evaluate to lists of strings. Each list =
must
be at least two elements long and specifies one or more texts which are map=
ped
to a replacement text. For instance, the following specifies a telephone ke=
ypad
mapping from upper case letters to digits.
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
0BDE41F">deffilter</a> alpha_to_phone ("E" "0")
                             ("J" "N" "Q" "1")
                             ("R" "W" "X" "2")
                             ("D" "S" "Y" "3")
                             ("F" "T" "4")
                             ("A" "M" "5")
                             ("C" "I" "V" "6")
                             ("B" "K" "U" "7")
                             ("L" "O" "P" "8")
                             ("G" "H" "Z" "9"))

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter=
</a> foo (`@a` `@b`) ("c" `-&gt;@d`))

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> x ("=
from" "to"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> y ("=
---" "+++"))
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter=
</a> sub x y)
</tt></pre><tt>

</tt>

<p>
The last deffilter has the same effect as the
<tt>

@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BDE41F">deffilter</=
a> sub ("from" "to") ("---" "+++"))
</tt>

directive.
</p><p>
Filtering works using a longest match algorithm. The input is scanned from =
left
to right, and the longest piece of text is identified at every character
position which matches a string on the left hand side, and that text is
replaced with its associated replacement text. The scanning then continues
at the first character after the matched text.
</p><p>
If none of the strings matches at a given character position, then that
character is passed through the filter untranslated, and the scan continues=
 at
the next character in the input.
</p><p>
Filtering is not in-place but rather instantiates a new text, and so
replacement text is not re-scanned for more replacements.
</p><p>
If a filter definition accidentally contains two or more repetitions of the
same left hand string with different right hand translations, the later one=
s
take precedence. No warning is issued.
</p><p>
</p><p>
<a name=3D"N-00B50006">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.7.15">7.7.1=
5</a> The <tt>filter</tt> directive</h4>



<p>
The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B50006">filter</a=
></tt>
directive is:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
0B50006">filter</a> FILTER { VAR }+ )
</tt></pre><tt>

</tt>

<p>
A filter is specified, followed by one or more variables whose values
are filtered and stored back into each variable.
</p><p>
Example: convert
<tt>a</tt>,
<tt>b</tt>,
and
<tt>c</tt>
to upper case and HTML encode:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
0B50006">filter</a> (:upcase :tohtml) a b c)
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-007C12B4">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8">7.8</a> =
Exceptions</h3>



<p>


</p><p>
<a name=3D"N-018E0BFC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.1">7.8.1<=
/a> Introduction</h4>


<p>
The exceptions mechanism in <b>TXR</b> is another
disciplined form of non-local transfer, in addition to the blocks
mechanism (see Blocks above).  Like blocks, exceptions provide a construct
which serves as the target for a dynamic exit.  Both blocks and exceptions
can be used to bail out of deep nesting when some condition occurs.
However, exceptions provide more complexity. Exceptions are useful for
error handling, and <b>TXR</b> in fact maps certain error situations to exc=
eption
control transfers. However, exceptions are not inherently an error-handling
mechanism; they are a structured dynamic control transfer mechanism, one
of whose applications is error handling.
</p><p>
An exception control transfer (simply called an exception) is always identi=
fied
by a symbol, which is its type. Types are organized in a subtype-supertype
hierarchy.  For instance, the
<tt>file-error</tt>
exception type is a subtype of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
type. This means that a file error is a kind of error. An exception
handling block which catches exceptions of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
will catch exceptions of
type
<tt>file-error</tt>,
but a block which catches
<tt>file-error</tt>
will not catch all
exceptions of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>.
A
<tt>query-error</tt>
is a kind of error, but not a kind of
<tt>file-error</tt>.
The symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is the supertype of every type: every exception type
is considered to be a kind of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
(Mnemonic:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
stands for type, as in any type).
</p><p>
Exceptions are handled using
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a>)<=
/tt>
clauses within a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a>=
)</tt>
directive.
</p><p>
In addition to being useful for exception handling, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a>=
)</tt>
directive
also provides unwind protection by means of a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a>=
)</tt>
clause,
which specifies query material to be executed unconditionally when
the try clause terminates, no matter how it terminates.
</p><p>
<a name=3D"N-0328371B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.2">7.8.2<=
/a> The <tt>try</tt> directive</h4>



<p>
The general syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
directive is
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
328371B">try</a>)
  ... main clause, required ...
  ... optional catch clauses ...
  ... optional finally clause
  @(end)
</tt></pre><tt>

</tt>

<p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause looks like:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
023">catch</a> TYPE [ PARAMETERS ])
  .
  .
  .
</tt></pre><tt>

</tt>

<p>
and also this simple form:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
023">catch</a>)
  .
  .
  .
</tt></pre><tt>

</tt>

<p>
which catches all exceptions, and is equivalent
to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a> t=
)</tt>.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause looks like:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
06C">finally</a>)
  ...
  .
  .
</tt></pre><tt>

</tt>

<p>
The main clause may not be empty, but the catch and finally may be.
</p><p>
A try clause is surrounded by an implicit anonymous block (see Blocks secti=
on
above). So for instance, the following is a no-op (an operation with no eff=
ect,
other than successful execution):
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
328371B">try</a>)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)
  @(end)
</tt></pre><tt>

</tt>

<p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a>)=
</tt>
causes a successful termination of the implicit anonymous block.
Execution resumes with query lines or directives which follow, if any.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
clauses and blocks interact. For instance, an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
from within
a try clause invokes a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>=
 foo)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0328371B">try</a>)
<br>&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-007B">accept</a>&nbsp;foo)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-006C">finally</a>)
<br>&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-0159EBE7">output</a>)
<br>&nbsp;bye!
<br>&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(end)
<br>&nbsp;@&nbsp;&nbsp;(end)
</tt>

</dd><dt>output:</dt><dd>
<tt>

&nbsp;bye!
</tt>

</dd></dl>
<p>

</p><p>
How this works: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block's main clause is
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a> =
foo)</tt>.
This causes
the enclosing block named
<tt>foo</tt>
to terminate, as a successful match.
Since the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
is nested within this block, it too must terminate
in order for the block to terminate. But the try has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause,
which executes unconditionally, no matter how the try block
terminates. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause performs some output, which is seen.
</p><p>
Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
interacts with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
in subtle ways not revealed in this example; they are documented in
the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
directive documentation.
</p><p>

<a name=3D"N-0134EBD1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.3">7.8.3<=
/a> The <tt>finally</tt> clause</h4>



<p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
directive can terminate in one of three ways. The main clause
may match successfully, and possibly yield some new variable bindings.
The main clause may fail to match. Or the main clause may be terminated
by a non-local control transfer, like an exception being thrown or a block
return (like the block foo example in the previous section).
</p><p>
No matter how the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
clause terminates, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause is processed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause is itself a query which binds variables, which leads to
questions: what happens to such variables? What if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block fails
as a query? As well as: what if a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause itself initiates a
control transfer?  Answers follow.
</p><p>
Firstly, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause will contribute variable bindings only if the main
clause terminates normally (either as a successful or failed match).
If the main clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block successfully matches, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block continues
matching at the next position in the data, and contributes bindings.
If the main clause fails, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block tries to match at the same position where the main clause failed.
</p><p>
The overall
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
directive succeeds as a match if either the main clause
or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause succeed. If both fail, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
directive is a failed match.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</=
a>)
<br>&nbsp;@a
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">final=
ly</a>)
<br>&nbsp;@b
<br>&nbsp;@(end)
<br>&nbsp;@c
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a=3D"1"
<br>&nbsp;b=3D"2"
<br>&nbsp;c=3D"3"
</tt>

</dd></dl>
<p>

</p><p>
In this example, the main clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
captures line
<tt>"1"</tt>

of the data as
variable
<tt>a</tt>,
then the finally clause captures
<tt>"2"</tt>

as
<tt>b</tt>,
and then the query continues with the
<tt>@c</tt>
line after try block, so that
<tt>c</tt>
captures
<tt>"3"</tt>.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</=
a>)
<br>&nbsp;hello&nbsp;@a
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">final=
ly</a>)
<br>&nbsp;@b
<br>&nbsp;@(end)
<br>&nbsp;@c
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;b=3D"1"
<br>&nbsp;c=3D"2"
</tt>

</dd></dl>
<p>

</p><p>
In this example, the main clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
fails to match, because
the input is not prefixed with
<tt>"hello "</tt>.
However, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause
matches, binding
<tt>b</tt>
to
<tt>"1"</tt>.
This means that the try block is a successful
match, and so processing continues with
<tt>@c</tt>
which captures
<tt>"2"</tt>.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clauses are processed during a non-local return,
they have no externally visible effect if they do not bind variables.
However, their execution makes itself known if they perform side effects,
such as output.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause guards only the main clause and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clauses. It does not
guard itself.   Once the finally clause is executing, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block is no
longer guarded.  This means if a nonlocal transfer, such as a block accept
or exception, is initiated within the finally clause, it will not re-execut=
e
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause is simply abandoned.
</p><p>
The disestablishment of blocks and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
clauses is properly interleaved
with the execution of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clauses. This means that all surrounding
exit points are visible in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause, even if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause
is being invoked as part of a transfer to a distant exit point.
The finally clause can make a control transfer to an exit point which
is more near than the original one, thereby "hijacking" the control
transfer. Also, the anonymous block established by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
directive
is visible in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause.
</p><p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
328371B">try</a>)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a>=
)
  @    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> =
"nonexistent-file")
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a>=
)
  @    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a=
>)
  @  (end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a> fil=
e-error)
  @  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)
  file error caught
  @  (end)
  @(end)
</tt></pre><tt>

</tt>

<p>
In this example, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive throws an exception of type
<tt>file-error</tt>,
because the given file does not exist. The exit point for this exception is=
 the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a> f=
ile-error)</tt>
clause in the outermost
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block. The inner block is
not eligible because it contains no catch clauses at all. However, the inne=
r
try block has a finally clause, and so during the processing of this
exception which is headed for
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a> f=
ile-error)</tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause performs an anonymous
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>.
The exit point for that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
is the anonymous block
surrounding the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>.
So the original
transfer to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause is thereby abandoned. The inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
terminates
successfully due to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>,
and since it constitutes the main clause of the outer try,
that also terminates successfully. The
<tt>"file error caught"</tt>

message is never printed.
</p><p>
<a name=3D"N-023ADC77">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.4">7.8.4<=
/a> <tt>catch</tt> clauses</h4>



<p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clauses establish their associated
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
blocks as potential exit points for
exception-induced control transfers (called "throws").
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause specifies an optional list of symbols which represent
the exception types which it catches. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause will catch
exceptions which are a subtype of any one of those exception types.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block has more than one
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause which can match a given
exception, the first one will be invoked.
</p><p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
is invoked, it is understood that the main clause did
not terminate normally, and so the main clause could not have produced any
bindings.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clauses are processed prior to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause itself throws an exception, that exception cannot
be caught by that same clause or its siblings in the same try block.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clauses of that block are no longer visible at that point.
Nevertheless, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clauses are still protected by the finally block.
If a catch clause throws, or otherwise terminates, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block is still processed.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
block throws an exception, then it is simply aborted;
the remaining directives in that block are not processed.
</p><p>
So the success or failure of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block depends on the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause, if there is one. If either of them succeed, then the try
block is considered a successful match.
</p><p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</=
a>)
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0056">next</a>&nbsp;"nonexistent-file")
<br>&nbsp;@&nbsp;&nbsp;x
<br>&nbsp;@&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0023">catch</a>&nbsp;file-error)
<br>&nbsp;@a
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">final=
ly</a>)
<br>&nbsp;@b
<br>&nbsp;@(end)
<br>&nbsp;@c
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;1
<br>&nbsp;2
<br>&nbsp;3
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;a=3D"1"
<br>&nbsp;b=3D"2"
<br>&nbsp;c=3D"3"
</tt>

</dd></dl>
<p>

</p><p>
Here, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block's main clause is terminated abruptly by a
<tt>file-error</tt>
exception from the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive.   This is handled by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause, which binds variable
<tt>a</tt>
to the input line
<tt>"1"</tt>.
Then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006C">finally</a></=
tt>
clause executes, binding
<tt>b</tt>
to
<tt>"2"</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
block then terminates successfully, and so
<tt>@c</tt>
takes
<tt>"3"</tt>.
</p><p>

<a name=3D"N-020EA418">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.5">7.8.5<=
/a> <tt>catch</tt> Clauses with Parameters</h4>



<p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause may have parameters following the type name, like this:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
023">catch</a> pair (a b))
</tt></pre><tt>

</tt>

<p>
To write a catch-all with parameters, explicitly write the
master supertype t:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
023">catch</a> t (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133=
AA5">arg</a> ...))
</tt></pre><tt>

</tt>

<p>
Parameters are useful in conjunction with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>.
The built-in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
exceptions carry one argument, which is a string containing
the error message. Using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>,
arbitrary parameters can be passed
from the throw site to the catch site.
</p><p>
<a name=3D"N-01634260">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.6">7.8.6<=
/a> The <tt>throw</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
directive generates an exception. A type must be specified,
followed by optional arguments, which are bind expressions. For example,
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
016">throw</a> pair "a" `@file.txt`)
</tt></pre><tt>

</tt>

<p>
throws an exception of type
<tt>pair</tt>,
with two arguments, being
<tt>"a"</tt>

and the expansion of the quasiliteral
<tt>`@file.txt`</tt>.
</p><p>
The selection of the target
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
is performed purely using the type
name; the parameters are not involved in the selection.
</p><p>
Binding takes place between the arguments given in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
and the target
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>.
</p><p>
If any
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
parameter, for which a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
argument is given, is a bound
variable, it has to be identical to the argument, otherwise the catch fails=
.
(Control still passes to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>,
but the catch is a failed match).
</p><p>
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> =
a "apple")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">t=
ry</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw=
</a>&nbsp;e&nbsp;"banana")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch=
</a>&nbsp;e&nbsp;(a))
<br>&nbsp;@(end)
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;[query fails]
</tt>

</dd></dl>
<p>

</p><p>
If any argument is an unbound variable, the corresponding parameter
in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
is left alone: if it is an unbound variable, it remains
unbound, and if it is bound, it stays as is.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</=
a>)
<br>&nbsp;@(trow&nbsp;e&nbsp;"honda"&nbsp;unbound)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch=
</a>&nbsp;e&nbsp;(car1&nbsp;car2))
<br>&nbsp;@car1&nbsp;@car2
<br>&nbsp;@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;honda toyota
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;car1=3D"honda"
<br>&nbsp;car2=3D"toyota"
</tt>

</dd></dl>
<p>

</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
has fewer parameters than there are throw arguments,
the excess arguments are ignored:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</=
a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw=
</a>&nbsp;e&nbsp;"banana"&nbsp;"apple"&nbsp;"pear")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch=
</a>&nbsp;e&nbsp;(fruit))
<br>&nbsp;@(end)
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;fruit=3D"banana"
</tt>

</dd></dl>
<p>

</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
has more parameters than there are throw arguments, the excess
parameters are left alone. They may be bound or unbound variables.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</=
a>)
<br>&nbsp;@(trow&nbsp;e&nbsp;"honda")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch=
</a>&nbsp;e&nbsp;(car1&nbsp;car2))
<br>&nbsp;@car1&nbsp;@car2
<br>&nbsp;@(end)
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;honda toyota
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;car1=3D"honda"
<br>&nbsp;car2=3D"toyota"
</tt>

</dd></dl>
<p>

</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
argument passing a value to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
parameter which is unbound causes
that parameter to be bound to that value.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
arguments are evaluated in the context of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>,
and the bindings
which are available there. Consideration of what parameters are bound
is done in the context of the catch.
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> =
c "c")
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">t=
ry</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1EE04">f=
orget</a>&nbsp;c)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind<=
/a>&nbsp;(a&nbsp;c)&nbsp;("a"&nbsp;"lc"))
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw=
</a>&nbsp;e&nbsp;a&nbsp;c)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch=
</a>&nbsp;e&nbsp;(b&nbsp;a))
<br>&nbsp;@(end)
</tt>

</dd><dt>result:</dt><dd>
<tt>

&nbsp;c=3D"c"
<br>&nbsp;b=3D"a"
<br>&nbsp;a=3D"lc"
</tt>

</dd></dl>
<p>

</p><p>
In the above example,
<tt>c</tt>
has a top-level binding to the string
<tt>"c"</tt>,
but then becomes unbound
via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1EE04">forget</a=
></tt>
within the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
construct, and rebound to the value
<tt>"lc"</tt>.
Since the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
construct is terminated by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>,
these modifications of the
binding environment are discarded. Hence, at the end of the query, variable
<tt>c</tt>
ends up bound to the original value
<tt>"c"</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
still takes place
within the scope of the bindings set up by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
clause, so the values of
<tt>a</tt>
and
<tt>c</tt>
that are thrown are
<tt>"a"</tt>

and
<tt>"lc"</tt>.
However, at the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
site, variable
<tt>a</tt>
does not have a binding.  At that point, the binding to
<tt>"a"</tt>

established in
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">try</a></=
tt>
has disappeared already. Being unbound, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
parameter
<tt>a</tt>
can take
whatever value the corresponding throw argument provides, so it ends up wit=
h
<tt>"lc"</tt>.
</p><p>
There is a horizontal form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>.
For instance:
</p><p>
<tt>
</tt></p><pre><tt>  abc@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-0016">throw</a> e 1)
</tt></pre><tt>

</tt>

<p>
throws exception
<tt>e</tt>
if
<tt>abc</tt>
matches.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
is used to generate an exception derived from type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
and that exception is not handled, <b>TXR</b> will issue diagnostics on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream and terminate. If an exception derived from
<tt>warning</tt>
is not handled, <b>TXR</b> will generate diagnostics on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream, after which control returns to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
directive, and proceeds with the next directive.
If an exception not derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
is thrown, control returns to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
directive and proceeds with the next directive.
</p><p>
<a name=3D"N-00FFE564">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.7">7.8.7<=
/a> The <tt>defex</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
directive allows the query writer to invent custom exception types,
which are arranged in a type hierarchy (meaning that some exception types a=
re
considered subtypes of other types).
</p><p>
Subtyping means that if an exception type
<tt>B</tt>
is a subtype of
<tt>A</tt>,
then every
exception of type
<tt>B</tt>
is also considered to be of type
<tt>A</tt>.
So a catch for type
<tt>A</tt>
will also catch exceptions of type
<tt>B</tt>.
Every type is a supertype of itself: an
<tt>A</tt>
is a kind of
<tt>A</tt>.
This implies that every type is a subtype of itself
also.  Furthermore, every type is a subtype of the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
which has no
supertype other than itself. Type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is is a subtype of every type, including
itself.  The subtyping relationship is transitive also. If
<tt>A</tt>
is a subtype
of
<tt>B</tt>,
and
<tt>B</tt>
is a subtype of
<tt>C</tt>,
then
<tt>A</tt>
is a subtype of
<tt>C</tt>.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
may be invoked with no arguments, in which case it does nothing:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02B">defex</a>)
</tt></pre><tt>

</tt>

<p>
It may be invoked with one argument, which must be a symbol. This introduce=
s a
new exception type. Strictly speaking, such an introduction is not necessar=
y;
any symbol may be used as an exception type without being introduced by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a>)<=
/tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02B">defex</a> a)
</tt></pre><tt>

</tt>

<p>
Therefore, this also does nothing, other than document the intent to use
a as an exception.
</p><p>
If two or more argument symbols are given, the symbols are all introduced a=
s
types, engaged in a subtype-supertype relationship from left to right.
That is to say, the first (leftmost) symbol is a subtype of the next one,
which is a subtype of the next one and so on. The last symbol, if it
had not been already defined as a subtype of some type, becomes a
direct subtype of the master supertype
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02B">defex</a> d e)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> a b=
 c d)
</tt></pre><tt>

</tt>

<p>
The first directive defines
<tt>d</tt>
as a subtype of
<tt>e</tt>,
and
<tt>e</tt>
as a subtype of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
The second defines
<tt>a</tt>
as a subtype of
<tt>b</tt>,
<tt>b</tt>
as a subtype of
<tt>c</tt>,
and
<tt>c</tt>
as a subtype of
<tt>d</tt>,
which is already defined as a subtype of
<tt>e</tt>.
Thus
<tt>a</tt>
is now a subtype of
<tt>e</tt>.
The the above can be condensed to:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02B">defex</a> a b c d e)
</tt></pre><tt>

</tt>

<p>
Example:
</p><dl class=3D"items">
<dt>code:</dt><dd>
<tt>

&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a>=
 gorilla ape primate)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex=
</a>&nbsp;monkey&nbsp;primate)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex=
</a>&nbsp;human&nbsp;primate)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">colle=
ct</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0328371B">t=
ry</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">s=
kip</a>)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">c=
ases</a>)
<br>&nbsp;gorilla&nbsp;@name
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw=
</a>&nbsp;gorilla&nbsp;name)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a=
>)
<br>&nbsp;monkey&nbsp;@name
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw=
</a>&nbsp;monkey&nbsp;name)
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a=
>)
<br>&nbsp;human&nbsp;@name
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw=
</a>&nbsp;human&nbsp;name)
<br>&nbsp;@(end)@#cases
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch=
</a>&nbsp;primate&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-01557906">name</a>))
<br>&nbsp;@kind&nbsp;@name
<br>&nbsp;@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">o=
utput</a>)
<br>&nbsp;we&nbsp;have&nbsp;a&nbsp;primate&nbsp;@name&nbsp;of&nbsp;kind&nbs=
p;@kind
<br>&nbsp;@(end)@#output
<br>&nbsp;@(end)@#try
<br>&nbsp;@(end)@#collect
</tt>

</dd><dt>data:</dt><dd>
<tt>

&nbsp;gorilla joe
<br>&nbsp;human&nbsp;bob
<br>&nbsp;monkey&nbsp;alice
</tt>

</dd><dt>output:</dt><dd>
<tt>

&nbsp;we have a primate joe of kind gorilla
<br>&nbsp;we&nbsp;have&nbsp;a&nbsp;primate&nbsp;bob&nbsp;of&nbsp;kind&nbsp;=
human
<br>&nbsp;we&nbsp;have&nbsp;a&nbsp;primate&nbsp;alice&nbsp;of&nbsp;kind&nbs=
p;monkey
</tt>

</dd></dl>
<p>

</p><p>
Exception types have a pervasive scope. Once a type relationship is introdu=
ced,
it is visible everywhere. Moreover, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
directive is destructive,
meaning that the supertype of a type can be redefined. This is necessary so
that something like the following works right:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02B">defex</a> gorilla ape)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> ape=
 primate)
</tt></pre><tt>

</tt>

<p>
These directives are evaluated in sequence. So after the first one, the
<tt>ape</tt>
type has the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
as its immediate supertype.  But in the second directive,
<tt>ape</tt>
appears again, and is assigned the
<tt>primate</tt>
supertype, while retaining
<tt>gorilla</tt>
as a subtype.  This situation could be diagnosed as an
error, forcing the programmer to reorder the statements, but instead
<b>TXR</b> obliges. However, there are limitations.  It is an error to defi=
ne a
subtype-supertype relationship between two types if they are already connec=
ted
by such a relationship, directly or transitively. So the following
definitions are in error:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02B">defex</a> a b)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> b c=
)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> a c=
)@# error: a is already a subtype of c, through b

  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> x y=
)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> y x=
)@# error: circularity; y is already a supertype of x.
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-0294EF6B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-7.8.8">7.8.8<=
/a> The <tt>assert</tt> directive</h4>



<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive requires the remaining query or sub-query which follows it
to match. If the remainder fails to match, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive throws an exception. If the directive is simply
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02E">assert</a>)
</tt></pre><tt>

</tt>

<p>
Then it throws an assertion of type assert, which is a subtype of error.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive also takes arguments similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
directive: an exception symbol and additional arguments which are bind
expressions, and may be unbound variables. The following assert directive, =
if
it triggers, will throw an exception of type
<tt>foo</tt>,
with arguments
<tt>1</tt>
and
<tt>"2"</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
02E">assert</a> foo 1 "2")
</tt></pre><tt>

</tt>

<p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
055">collect</a>)
  Important Header
  ----------------
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a>)
  Foo: @a, @b
  @(end)
</tt></pre><tt>

</tt>

<p>
Without the assertion in places, if the
<tt>Foo: @a, @b</tt>
part does not
match, then the entire interior of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
clause fails,
and the collect continues searching for another match.
</p><p>
With the assertion in place, if the text
<tt>"Important Header"</tt>

and its
underline match, then the remainder of the collect body must
match, otherwise an exception is thrown. Now the program will not
silently skip over any Important Header sections due to a problem
in its matching logic. This is particularly useful when the matching is var=
ied
with numerous cases, and they must all be handled.
</p><p>
There is a horizontal
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive also. For instance:
</p><p>
<tt>
</tt></p><pre><tt>  abc@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-002E">assert</a>)d@x
</tt></pre><tt>

</tt>

<p>
asserts that if the prefix
<tt>"abc"</tt>

is matched, then it must be
followed by a successful match for
<tt>"d@x"</tt>,
or else an exception is thrown.
</p><p>
If the exception is not handled, and is derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
then <b>TXR</b> issues diagnostics on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream and terminates. If the exception is derived from
<tt>warning</tt>
and not handled, <b>TXR</b> issues a diagnostic on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
after which control returns to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive. Control silently returns to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
directive if an exception of any other kind is not handled.
</p><p>
When control returns to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
due to an unhandled exception, it behaves like a failed match,
similarly to the require directive.
</p><p>
<a name=3D"N-01450DA7">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8">8</a> TXR =
LISP</h2>




<p>


The <b>TXR</b> language contains an embedded Lisp dialect called <b>TXR Lis=
p</b>.
</p><p>
This language is exposed in <b>TXR</b> in a number of ways.
</p><p>
In any situation that calls for an expression, a Lisp
expression can be used, if it is preceded by the
<tt>@</tt>
character. The Lisp expression
is evaluated and its value  becomes the value of that expression.
Thus, <b>TXR</b> directives are embedded in literal text using
<tt>@</tt>,
and Lisp expressions
are embedded in directives using
<tt>@</tt>
also.
</p><p>
Furthermore, certain directives evaluate Lisp expressions without
requiring
<tt>@</tt>.
These are
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a>)</tt=
>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a>=
)</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a>)=
</tt>,
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a>)</tt=
>
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>.
</p><p>
<b>TXR Lisp</b> code can be placed into files. On the command
line, <b>TXR</b> treats files with a
<tt>".tl"</tt>

suffix as <b>TXR Lisp</b> code, and the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a>)</=
tt>
directive does also.
</p><p>
<b>TXR</b> also provides an interactive listener for Lisp evaluation.
</p><p>
Lastly, <b>TXR Lisp</b> expressions can be evaluated via the
command line, using the
<tt>-e</tt>
and
<tt>-p</tt>
options.
</p><p>
<b>Examples:</b>

</p><p>
Bind variable
<tt>a</tt>
to the integer 4:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> a @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C"=
>+</a> 2 2))
</tt></pre><tt>

</tt>

<p>
Bind variable
<tt>b</tt>
to the standard input stream. Note that
<tt>@</tt>
is not required on a Lisp variable:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
057">bind</a> a *stdin*)
</tt></pre><tt>

</tt>

<p>
Define several Lisp functions inside
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a>)</tt=
>:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
061">do</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a=
> add (x y) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> x y))

    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a=
> occurs (item list)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</=
a> ((null list) nil)
            ((atom list) (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-02550B35">eql</a> item list))
            (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a> (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</a> list) item=
)
                   (occurs item (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-02288559">rest</a> list)))))))
</tt></pre><tt>

</tt>

<p>
Trigger a failure unless previously bound variable
<tt>answer</tt>
is greater than 42:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
075">require</a> (&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-028043AE">int-str</a> answer) 42)
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-01CE7F16">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.1">8.1</a> =
Overview</h3>



<p>


</p><p>
<b>TXR Lisp</b> is a small and simple dialect, like Scheme, but much more s=
imilar to
Common Lisp than Scheme. It has separate value and function binding namespa=
ces,
like Common Lisp (and thus is a Lisp-2 type dialect), and represents Boolea=
n
<b>true</b>

and
<b>false</b>

with the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
(note the case sensitivity of
identifiers denoting symbols!) Furthermore, the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is also the empty list, which terminates nonempty lists.
</p><p>
<b>TXR Lisp</b> has lexically scoped local variables and dynamic global var=
iables,
similarly to Common Lisp, including the convention that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
marks symbols for dynamic binding in local scopes. Lexical closures
are supported. <b>TXR Lisp</b> also supports global lexical variables via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</=
a></tt>.
</p><p>
Functions are lexically scoped in <b>TXR Lisp</b>; they can be
defined in pervasive global environment using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
or in local scopes using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>.
</p><p>
<a name=3D"N-03FB6EC1">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2">8.2</a> =
Additional Syntax</h3>



<p>


</p><p>
Much of the <b>TXR Lisp</b> syntax has been introduced in the previous sect=
ions of the
manual, since directive forms are based on it. There is some additional syn=
tax
that is useful in <b>TXR Lisp</b> programming.
</p><p>
<a name=3D"N-03F5B70D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.1">8.2.1<=
/a> Symbol Tokens</h4>


<p>
The symbol tokens in <b>TXR Lisp</b>,
called a
<tt><i>lident</i></tt>
(Lisp identifier) has a similar syntax to the
<tt><i>bident</i></tt>
(braced identifier) in the <b>TXR</b> pattern language. It may consist of
all the same characters, as well as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(slash) character which may not be used in a
<tt><i>bident</i></tt>.
Thus a
<tt><i>lident</i></tt>
may consist of these characters, in addition to letters, numbers and
underscores:
</p><p>
<tt>

<br>&nbsp;!&nbsp;$&nbsp;%&nbsp;&amp;&nbsp;*&nbsp;+&nbsp;-&nbsp;&lt;&nbsp;=
=3D&nbsp;&gt;&nbsp;?&nbsp;\&nbsp;~&nbsp;/
</tt>

</p><p>
and may not look like a number.
</p><p>
A
<tt><i>lident</i></tt>
may also include all of the Unicode characters which are permitted in a
<tt><i>bident</i></tt>.
</p><p>
The one character which is allowed in a
<tt><i>lident</i></tt>
but not in a
<tt><i>bident</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(forward slash).
</p><p>
A lone
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
is a valid
<tt><i>lident</i></tt>
and consequently a symbol token in <b>TXR Lisp</b>. The token
<tt>/abc/</tt>
is also a symbol, and, unlike in a braced expression, is not a regular
expression. In <b>TXR Lisp</b> expressions, regular expressions are written=
 with
a leading
<tt>#</tt>.
</p><p>
<a name=3D"N-007009FB">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.2">8.2.2<=
/a> Package Prefixes</h4>


<p>
If a symbol name contains a colon, the
<i>lident</i>

characters, if any, before that colon constitute the package prefix.
</p><p>
For example, the syntax
<tt>foo:bar</tt>
denotes
<tt>bar</tt>
symbol in the
<tt>foo</tt>
package.
</p><p>
It is a syntax error to read a symbol whose package doesn't exist.
</p><p>
If the package exists, but the symbol name doesn't exist in that package,
then the symbol is interned in that package.
</p><p>
If the package name is an empty string (the colon is preceded by nothing), =
the
package is understood to be the
<tt>keyword</tt>
package. The symbol is interned in that package.
</p><p>
The syntax
<tt>:test</tt>
denotes the symbol
<tt>test</tt>
in the
<tt>keyword</tt>
package, the same as
<tt>keyword:test</tt>.
</p><p>
Symbols in the keyword package are self-evaluating. This means that
when a keyword symbol is evaluated as a form, the value of that form
is the keyword symbol itself. Exactly two non-keyword symbols also
have this special self-evaluating behavior:
the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in the user package, whose fully qualified names are
<tt>usr:t</tt>
and
<tt>usr:nil</tt>.
</p><p>
The syntax
<tt>@foo:bar</tt>
denotes the meta prefix
<tt>@</tt>
being applied to the
<tt>foo:bar</tt>
symbol, not to a symbol in the
<tt>@foo</tt>
package.
</p><p>
The syntax
<tt>#:bar</tt>
denotes an uninterned symbol named
<tt>bar</tt>,
described in the next section.
</p><p>
</p><dl>
<dt>Dialect Note:</dt><dd>
<p>


In ANSI Common Lisp, the
<tt>foo:bar</tt>
syntax does not intern the symbol
<tt>bar</tt>
in the
<tt>foo</tt>
package; the symbol must exist and be an exported symbol, or else the synta=
x is
erroneous. In ANSI Common Lisp, the syntax
<tt>foo::bar</tt>
does intern
<tt>foo</tt>
in the
<tt>bar</tt>
package. <b>TXR</b>'s package system has no double-colon syntax, and lacks =
the concept of exported symbols.
</p><p>
</p></dd></dl>
<a name=3D"N-00D2D8A3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.3">8.2.3</a> =
Uninterned Symbols</h4>


<p>
Uninterned symbols are written with the
<tt>#:</tt>
prefix, followed by zero or more
<i>lident</i>

characters.
When an uninterned symbol is read, a new, unique symbol is constructed,
with the specified name. Even if two uninterned symbols have the same name,
they are different objects. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0084463A">make-sym<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
functions produce uninterned symbols.
</p><p>
"Uninterned" means "not entered into a package". Interning refers to a
process which combines package lookup with symbol creation, which ensures
that multiple occurrences of a symbol name in written syntax are all conver=
ted
to the same object: the first occurrence creates the symbol and associates =
it
with its name in a package. Subsequent occurrences do not create a new symb=
ol,
but retrieve the existing one.
</p><p>
<a name=3D"N-01E5CC56">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.4">8.2.4<=
/a> Meta-Symbols, Meta-Numbers and Meta-Expressions</h4>


<p>
The syntax of a symbol, integer or compound expression may be preceded by t=
he
character
<tt>@</tt>.
</p><p>
This is "meta syntax", whose meaning is unassigned as far as <b>TXR Lisp</b=
>evaluation is concerned. It plays a syntactic role in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
operator, and in structural pattern matching. It also appears
in the quasiliteral notation.  In other situations, application code may as=
sign
meaning to meta syntax as the programmer sees fit.
</p><p>
Meta syntax is defined as a shorthand notation, as follows:
</p><p>
If
<tt>X</tt>
is a symbol or integer, the syntax
<tt>@X</tt>
is a shorthand for the compound expression
<tt>(sys:var X)</tt>.
This is referred to as a
<i>meta-symbol</i>

if
<tt>X</tt>
is a symbol, or a
<i>meta-number</i>

if
<tt>X</tt>
is an integer.
</p><p>
If
<tt>X</tt>
is a compound expression,  either
<tt>(...)</tt>
or
<tt>[...]</tt>,
then
<tt>@X</tt>
is a shorthand for
<tt>(sys:expr X)</tt>.
This is called a
<i>meta-expression</i>.

</p><p>
The behavior of
<tt>@</tt>
followed by the syntax of a floating-point constant introduced by a leading
decimal point, not preceded by digits, is unspecified. Examples of this
are
<tt>@.123</tt>
and
<tt>@.123E+5</tt>.
</p><p>
The behavior of
<tt>@</tt>
followed by the syntax of a floating-point expression in exponential notati=
on,
which lacks a decimal point, is also unspecified. An example of this is
<tt>@12E5</tt>.
</p><p>
It is a syntax error for
<tt>@</tt>
to be followed by what appears to be a floating-point constant consisting
of a decimal point flanked by digits on both sides. For instance
<tt>@1.2</tt>
is rejected.
</p><p>
A meta-expression followed by a period, and the syntax of another object is
otherwise interpreted as a referencing dot expression. For instance
<tt>@1.E3</tt>
denotes
<tt>(qref @1 E3)</tt>
which, in turn, denotes
<tt>(qref (sys:var 1) E3)</tt>,
even though the unprefixed character sequence
<tt>1.E3</tt>
is otherwise a floating-point constant.
</p><p>
<a name=3D"N-0057E40C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.5">8.2.5<=
/a> Consing Dot</h4>


<p>
Unlike other major Lisp dialects, <b>TXR Lisp</b> allows a consing dot with=
 no forms
preceding it. This construct simply denotes the form which follows the dot.
That is to say, the parser implements the following transformation:
</p><p>
<tt>
</tt></p><pre><tt>  (. expr) -&gt; expr
</tt></pre><tt>

</tt>

<p>
This is convenient in writing function argument lists that only take
variable arguments. Instead of the syntax:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> fun args ...)
</tt></pre><tt>

</tt>

<p>
the following syntax can be used:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> fun (. args) ...)
</tt></pre><tt>

</tt>

<p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
form is printed, it is printed in the following style.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
4F">lambda</a> nil ...) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-004F">lambda</a> () ...)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> sym=
 ...) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lamb=
da</a> (. sym) ...)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (sy=
m) ...) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">la=
mbda</a> (sym) ...)
</tt></pre><tt>

</tt>

<p>
In no other circumstances is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
printed as
<tt>()</tt>,
or an atom
<tt>sym</tt>
as
<tt>(. sym)</tt>.
</p><p>
<a name=3D"N-013775DB">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.6">8.2.6<=
/a> Referencing Dot</h4>


<p>
A dot token which is flanked by expressions on both sides, without any
intervening whitespace, is the referencing dot, and not the consing dot.
The referencing dot is a syntactic sugar which translated to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
syntax ("quoted ref"). When evaluated as a form, this syntax denotes struct=
ure
access; see Structures. However, it is possible to put this syntax to use f=
or
other purposes, in other contexts.
</p><p>
<tt>
</tt></p><pre><tt>  ;; a.b may be almost any expressions
  a.b           &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-0058">qref</a> a b)
  a.b.c         &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-0058">qref</a> a b c)
  a.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> b c=
)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">q=
ref</a> a b c)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> a b).=
c  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">q=
ref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a>=
 a b) c)
</tt></pre><tt>

</tt>

<p>
That is to say, this dot operator constructs a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
expression out of its left and right arguments. If the right argument
of the dot is already a qref expression (whether produced by another instan=
ce
of the dot operator, or expressed directly) it is merged. This requires
the qref dot operator to be right-to-left associative, so that
<tt>a.b.c</tt>
works by first translating
<tt>b.c</tt>
to
<tt>(qref b c)</tt>,
and then adjoining
<tt>a</tt>
to produce
<tt>(qref a b c)</tt>.
</p><p>
If the referencing dot is immediately followed by a question mark, it forms
a single token, which produces the following syntactic variation,
in which the following item is annotated as a list headed by
the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>:
</p><p>
<tt>
</tt></p><pre><tt>  a.?b     &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-015134D8">t</a> a).b         &lt;--&gt; (<a href=3D"http=
://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> (<a href=3D"http://nong=
nu.org/txr/txr-manpage.html#N-015134D8">t</a> a) b)
  a.?b.?c  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-015134D8">t</a> a).(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
5134D8">t</a> b).c   &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#D-0058">qref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-015134D8">t</a> a) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
015134D8">t</a> b) c)
  a.?(b)   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-015134D8">t</a> a).(b)       &lt;--&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-0058">qref</a> (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-015134D8">t</a> a) (b))
  (a).?b   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-015134D8">t</a> (a)).b       &lt;--&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-0058">qref</a> (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-015134D8">t</a> (a)) b)
</tt></pre><tt>

</tt>

<p>
This syntax denotes
<i>null-safe</i>

access to structure slots and methods.
<tt>a.?b</tt>
means that
<tt>a</tt>
may evaluate to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
in which case the expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>;
otherwise,
<tt>a</tt>
must evaluate to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
which has a slot
<tt>b</tt>,
and the expression denotes access to that slot.
Similarly,
<tt>a.?(b 1)</tt>
means that if
<tt>a</tt>
evaluates to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>;
otherwise,
<tt>a</tt>
is treated as a struct object whose method
<tt>b</tt>
is invoked with argument
<tt>1</tt>,
and the value returned by that method becomes the value of
the expression.
</p><p>
Integer tokens cannot be involved in this syntax, because they
form floating-point constants when juxtaposed with a dot.
Such ambiguous uses of floating-point tokens are diagnosed as syntax errors=
:
</p><p>
<tt>
</tt></p><pre><tt>  (a.4)   ;; error: cramped floating-point literal
  (a .4)  ;; good: a followed by 0.4
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-036AA5E6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.7">8.2.7<=
/a> Unbound Referencing Dot</h4>


<p>
Closely related to the referencing dot syntax is the unbound
referencing dot. This is a dot which is flanked by an expression on the rig=
ht,
without any intervening whitespace, but is not preceded by an expression
Rather, it is preceded by whitespace,
or some punctuation such as
<tt>[</tt>,
<tt>(</tt>
or
<tt>'</tt>.
This is a syntactic sugar which translates to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
syntax:
</p><p>
<tt>
</tt></p><pre><tt>  .a       &lt;--&gt; (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-03A211AB">uref</a> a)
  .a.b     &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
03A211AB">uref</a> a b)
  .a.?b    &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
03A211AB">uref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015=
134D8">t</a> a) b)
</tt></pre><tt>

</tt>

<p>
If the unbound referencing dot is itself combined with a question
mark to form the
<tt>.?</tt>
token, then the translation to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
is as follows:
</p><p>
<tt>
</tt></p><pre><tt>  .?a      &lt;--&gt; (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-03A211AB">uref</a> t a)
  .?a.b    &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
03A211AB">uref</a> t a b)
  .?a.?b   &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
03A211AB">uref</a> t a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-015134D8">t</a> b))
</tt></pre><tt>

</tt>

<p>
When the unbound referencing dot is applied to a dotted expression,
this can be understood as a conversion of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>.
</p><p>
Indeed, this is exactly what happens if the unbound dot is applied to an
explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
expression:
</p><p>
<tt>
</tt></p><pre><tt>  .(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
058">qref</a> a b)   &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-03A211AB">uref</a> a b)
</tt></pre><tt>

</tt>

<p>
The unbound referencing dot takes its name from the semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
macro, which produces a function that implements late binding of an
object to a method slot. Whereas the expression
<tt>obj.a.b</tt>
denotes accessing object
<tt>obj</tt>
to retrieve slot
<tt>a</tt>
and then accessing slot
<tt>b</tt>
of the object from that slot, the expression
<tt>.a.b.</tt>
represents a "disembodied" reference: it produces a function which takes an
object as an argument and then performs the implied slot referencing on tha=
t
argument. When the function is called, it is said to bind the referencing t=
o
the object. Hence that referencing is "unbound".
</p><p>
Whereas the expression
<tt>.a</tt>
produces a function whose argument must be an object,
<tt>.?a</tt>
produces a function whose argument may be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The function detects this case and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<a name=3D"N-01C607FD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.8">8.2.8<=
/a> Quote and Quasiquote</h4>


<p>
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>'<tt><i>expr</i></tt><tt> </tt></tt></dt><dd>



The quote character in front of an expression is used for suppressing evalu=
ation,
which is useful for forms that evaluate to something other than themselves.
For instance if
<tt>'(+ 2 2)</tt>
is evaluated, the value is the three-element list
<tt>(+ 2 2)</tt>,
whereas if
<tt>(+ 2 2)</tt>
is evaluated, the value is
<tt>4</tt>.
Similarly, the value of
<tt>'a</tt>
is the symbol
<tt>a</tt>
itself, whereas the value of
<tt>a</tt>
is the contents of the variable
<tt>a</tt>.
<p>



</p></dd><dt><tt>^<tt><i>qq-template</i></tt><tt> </tt></tt></dt><dd>



The caret in front of an expression is a quasiquote. A quasiquote is like
a quote, but with the possibility of substitution of material.
<p>
Under a quasiquote, form is considered to be a quasiquote template. The tem=
plate
is considered to be a literal structure, except that it may contain
the notations
<tt>




,</tt><tt><i>expr</i></tt><tt>=20

</tt>

and
<tt>




,*</tt><tt><i>expr</i></tt><tt>=20

</tt>

which denote non-constant parts.
</p><p>
A quasiquote gets translated into code which, when evaluated, constructs
the structure implied by
<tt><i>qq-template</i></tt>,
taking into account the unquotes and splices.
</p><p>
A quasiquote also processes nested quasiquotes specially.
</p><p>
If
<tt><i>qq-template</i></tt>
does not contain any unquotes or splices (which match its
level of nesting), or is simply an atom, then
<tt>




^</tt><tt><i>qq-template</i></tt><tt>=20

</tt>

is equivalent to
<tt>




'</tt><tt><i>qq-template</i></tt><tt> .=20

</tt>

in other words, it is like an ordinary quote.  For instance
<tt>^(a b ^(c ,d))</tt>
is equivalent to
<tt>'(a b ^(c ,d))</tt>.
Although there is an unquote ,d it
belongs to the inner quasiquote
<tt>^(c ,d)</tt>,
and the outer quasiquote does not have
any unquotes of its own, making it equivalent to a quote.
</p><p>
Dialect Note: in Common Lisp and Scheme,
<tt>^form</tt>
is written
<tt>`form</tt>,
and
quasiquotes are also informally known as backquotes.  In <b>TXR</b>, the ba=
ckquote
character
<tt>`</tt>
used for quasi string literals.
</p><p>



</p></dd><dt><tt>,<tt><i>expr</i></tt><tt> </tt></tt></dt><dd>



The comma character is used within a
<tt><i>qq-template</i></tt>
to denote an unquote.  Whereas the quasiquote suppresses evaluation,
similarly to the quote, the comma introduces an exception: an element
of a form which is evaluated. For example, list
<tt>^(a b c ,(+ 2 2) (+ 2 2))</tt>
is the list
<tt>(a b c 4 (+ 2 2))</tt>.
Everything
in the quasiquote stands for itself, except for the
<tt>,(+ 2 2)</tt>
which is evaluated.
<p>
Note: if a variable is called
<tt>*x*</tt>,
then the syntax
<tt>,*x*</tt>
means
<tt>,* x*</tt>:
splice
the value of
<tt>x*</tt>.
In this situation, whitespace between the comma and the
variable name must be used:
<tt>, *x*</tt>.
</p><p>



</p></dd><dt><tt>,*<tt><i>expr</i></tt><tt> </tt></tt></dt><dd>



The comma-star operator is used within quasiquote list to denote a splicing
unquote.  The form which follows
<tt>,*</tt>
must evaluate to a list. That list is spliced into
the structure which the quasiquote denotes. For example:
<tt>'(a b c ,*(list (+ 3 3) (+ 4 4) d))</tt>
evaluates to
<tt>(a b c 6 8 d)</tt>.
The expression
<tt>(list (+ 3 3) (+ 4 4))</tt>
is evaluated to produce the list
<tt>(6 8)</tt>,
and this list is spliced into the quoted template.
</dd></dl>
</dl>
<p>
</p><dl>
<dt>Dialect Notes:</dt><dd>
<p>


</p><p>
In other Lisp dialects, like Scheme and ANSI Common Lisp, the equivalent sy=
ntax
is usually
<tt>,@</tt>
(comma at). The
<tt>@</tt>
character already has an assigned meaning in <b>TXR</b>, so
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
is used.
</p><p>
However,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
is also a character that may appear in a symbol name, which creates
a potential for ambiguity. The syntax
<tt>,*abc</tt>
denotes the application of the
<tt>,*</tt>
splicing operator to the symbolic expression
<tt>abc</tt>;
to apply the ordinary non-splicing unquote to the symbol
<tt>*abc</tt>,
whitespace must be used:
<tt>, *abc</tt>.
</p><p>
In <b>TXR</b>, the unquoting and splicing forms may freely appear outside o=
f
a quasiquote template. If they are evaluated as forms, however, they
throw an exception:
</p><p>
<tt>
</tt></p><pre><tt>   ,(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
007C">+</a> 2 2) ;; error!

   ',(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2) =
--&gt; ,(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 =
2)
</tt></pre><tt>

</tt>

<p>
In other Lisp dialects, a comma not enclosed by backquote syntax is
treated as a syntax error by the reader.
</p><p>
</p></dd></dl>
<a name=3D"N-0364F463">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.9">8.2.9</a> =
Quasiquoting non-List Objects</h4>


Quasiquoting is supported over hash table and vector literals (see Vectors
and Hashes below).  A hash table or vector literal can be quoted, like any
object, for instance:
<p>
<tt>
</tt></p><pre><tt>  '#(1 2 3)
</tt></pre><tt>

</tt>

<p>
The
<tt>#(1 2 3)</tt>
literal is turned into a vector atom right in the <b>TXR</b> parser,
and this atom is being quoted: this is
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> </=
tt><tt><i>atom</i></tt><tt>)=20

</tt>

syntactically, which evaluates to
<tt><i>atom</i></tt>.
</p><p>
When a vector is quasi-quoted, this is a case of
<tt>




^</tt><tt><i>atom</i></tt><tt>=20

</tt>

which evaluates to
<tt><i>atom</i></tt>.
</p><p>
A vector can be quasiquoted, for example:
</p><p>
<tt>
</tt></p><pre><tt>  ^#(1 2 3)
</tt></pre><tt>

</tt>

<p>
Unquotes can occur within a quasiquoted vector:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((a 42))
    ^#(1 ,a 3)) ; value is #(1 42 3)
</tt></pre><tt>

</tt>

<p>
In this situation, the
<tt>^#(...)</tt>
notation produces code which constructs a vector.
</p><p>
The vector in the following example is also a quasivector. It contains
unquotes, and though the quasiquote is not directly applied to it,
it is embedded in a quasiquote:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((a 42))
    ^(a b c #(d ,a))) ; value is (a b c #(d 42))
</tt></pre><tt>

</tt>

<p>
Hash table literals have two parts: the list of hash construction
arguments and the key-value pairs. For instance:
</p><p>
<tt>
</tt></p><pre><tt>   #H((:eql-based) (a 1) (b 2))
</tt></pre><tt>

</tt>

<p>
where
<tt>(:eql-based)</tt>
indicates that this hash table's keys are treated using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
equality, and
<tt>(a 1)</tt>
and
<tt>(b 2)</tt>
are the key/value entries. Hash literals may be quasiquoted.  In
quasiquoting, the arguments and pairs are treated as separate syntax; it is=
 not
one big list.  So the following is not a possible way to express the above
hash:
</p><p>
<tt>
</tt></p><pre><tt>  ;; not supported: splicing across the entire syntax
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
hash-syntax '((:eql-based) (a 1) (b 2))))
    ^#H(,*hash-syntax))
</tt></pre><tt>

</tt>

<p>
This is correct:
</p><p>
<tt>
</tt></p><pre><tt>  ;; fine: splicing hash arguments and contents separatel=
y
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
hash-args '(:eql-based))
        (hash-contents '((a 1) (b 2))))
    ^#H(,hash-args ,*hash-contents))
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-01377D39">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.10">8.2.1=
0</a> Quasiquoting combined with Quasiliterals</h4>


When a quasiliteral is embedded in a quasiquote, it is possible to use
splicing to insert material into the quasiliteral.
<p>
Example:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
86C8B8">eval</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF=
20B">let</a> ((a 3)) ^`abc @,a @{,a} @{(<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#N-0206CE91">list</a> 1 2 ,a)}`))

  -&gt; "abc 3 3 1 2 3"
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-03501D40">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.11">8.2.1=
1</a> Vector Literals</h4>


<p>
</p><dl class=3D"items">
<dt><tt>#(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a>=
)</tt></dt><dd>

A hash token followed by a list denotes a vector. For example
<tt>#(1 2 a)</tt>
is a three-element vector containing the numbers
<tt>1</tt>
and
<tt>2</tt>,
and the symbol
<tt>a</tt>.
<p>
</p></dd></dl>
<a name=3D"N-029325E0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.12">8.2.12</a=
> Struct Literals</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#S(<tt><i>name</i></tt><tt> {</tt><tt><i>slot</i></tt><tt> </tt><tt=
><i>value</i></tt><tt>}*) </tt></tt></dt><dd>



The notation
<tt>#S</tt>
followed by a nested list syntax denotes a struct literal.
The first item in the syntax is a symbol denoting the struct type
name. This must be the name of a struct type, otherwise the
literal is erroneous.  Followed by the struct type are slot names
interleaved with their values. The values are literal expressions,
not subject to evaluation.
Each slot name which is present in the
literal must name a slot in the struct type, though not
all slots in the struct type must be present in the literal.
<p>
When a struct literal is read, the denoted struct type is
constructed as if by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
with an empty
<tt><i>plist</i></tt>
argument, followed by a sequence of assignments which store into each
<tt><i>slot</i></tt>
the corresponding
<tt><i>value</i></tt>
expression.
</p><p>
</p></dd></dl>
<a name=3D"N-024EAF03">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.13">8.2.13</a=
> Hash Literals</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#H((<tt><i>hash-argument</i></tt><tt>*) (</tt><tt><i>key</i></tt><t=
t> </tt><tt><i>value</i></tt><tt>)*) </tt></tt></dt><dd>



The notation
<tt>#H</tt>
followed by list syntax denotes a hash table literal.
The first item in the syntax is a list of keywords. These are the same
keywords as are used when calling the function hash to construct
a hash table. Allowed keywords are:
<tt>:equal-based</tt>,
<tt>:eql-based</tt>,
<tt>:eq-based</tt>,
<tt>:weak-keys</tt>,
<tt>:weak-values</tt>,
and
<tt>:userdata</tt>.
If the
<tt>:userdata</tt>
keyword is present,
it must be followed by an object; that object
specifies the hash table's user data, which
can be retrieved using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>
function.
The
<tt>:equal-based</tt>,
<tt>:eql-based</tt>
and
<tt>:eq-based</tt>
keywords are mutually exclusive.
<p>
An empty list can be specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or
<tt>()</tt>,
which defaults to a
hash table based on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
function, with no weak semantics or user data.
</p><p>
The entire syntax following
<tt>#H</tt>
may be an empty list; however, that empty list may not
be specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>;
the empty parentheses notation is required.
</p><p>
The hash table key-value contents are specified as zero or more
two-element lists, whose first element specifies the
<tt><i>key</i></tt>
and whose second specifies the
<tt><i>value</i></tt>.
Both expressions are literal objects, not subject to evaluation.
</p><p>
</p></dd></dl>
<a name=3D"N-02BDE2B7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.14">8.2.14</a=
> Range Literals</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#R(<tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) </tt></tt>=
</dt><dd>



The notation
<tt>#R</tt>
followed by a two-element list syntax denotes a range literal.
It combines
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
expressions, themselves literals not subject to
evaluation, producing the range object whose corresponding
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
fields are the objects denoted by these expressions.
<p>
</p></dd></dl>
<a name=3D"N-01DD9A70">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.15">8.2.15</a=
> Buffer Literals</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#b'<tt><i>hex-data</i></tt><tt>' </tt></tt></dt><dd>



The notation
<tt>#b'</tt>
introduces a buffer object: a data representation for a
block of bytes. This
<tt>#b'</tt>
prefix must be followed
by a data section and a closing quote.
The data section consists of hexadecimal digits, among which
may be interspersed whitespace: tabs, spaces and newlines.
There must be an even number of digits, or else the
notation is ill-formed. The whitespace is ignored, and
pairs of successive hex digits specify bytes.
If there are no hex digits, then a zero length buffer
is specified.
<p>
Buffers may be constructed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011445E1">make-buf<=
/a></tt>
function, and other means such as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023305C7">ffi-get</=
a></tt>
function.
</p><p>
Note that the
<tt>#b</tt>
prefix is also used for binary numbers. In that syntax, it
is followed by an optional sign, and then a mixture of one
or more of the digits
<tt>0</tt>
or
<tt>1</tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-002C7012">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.16">8.2.16</a=
> Tree Node Literals</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#N([<tt><i>key</i></tt><tt> [</tt><tt><i>left</i></tt><tt> [</tt><t=
t><i>right</i></tt><tt>]]]) </tt></tt></dt><dd>



The notation
<tt>#N</tt>
followed by list syntax denotes a tree node literal. The list syntax must b=
e a
proper list that has up to three elements. If the list is empty, it may not
be written as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
A tree node is an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>.
Every
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
has three elements: a
<tt><i>key</i></tt>,
a
<tt><i>left</i></tt>
link and a
<tt><i>right</i></tt>
link.  They may be objects of any type.
If the tree node literal syntax omits any of these, they default to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-030F6302">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.17">8.2.17</a=
> Tree Literals</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#T([([<tt><i>keyfun</i></tt><tt> [</tt><tt><i>lessfun</i></tt><tt> =
[</tt><tt><i>equalfun</i></tt><tt>]]]) </tt><tt><i>item</i></tt><tt>*]) </t=
t></tt></dt><dd>



The notation
<tt>#T</tt>
followed by list syntax denotes a tree literal, which specifies an
object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
Objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>
are search trees.
<p>
The list syntax which follows
<tt>#T</tt>
may be empty. If so, it cannot be written as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The first element of the
<tt>#T</tt>
syntax, if present, must be a list of zero to three elements.
These elements are symbols giving the names of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>
object's
<i>key abstraction functions</i>.

<tt><i>keyfun</i></tt>
specifies the key function which is applied to each element to
retrieve its key. If it is omitted, the object shall use the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function as its key.
The
<tt><i>lessfun</i></tt>
specifies the name of the comparison function by which keys are compared
for inequality. It defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>.
The
<tt><i>equalfun</i></tt>
specifies the function by which keys are compared for equality. It
defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
A symbol which is specified as the name of any of these three special
functions must be an element of the list stored in the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025AB9C9">*tree-fun=
-whitelist*</a></tt>,
otherwise the string literal is diagnosed as erroneous.
Note: this is due to security considerations, since these three
functions are executed during the processing of tree syntax.
</p><p>
A tree object is constructed from a tree literal by first creating an empty
tree endowed with the three key abstraction functions that are indicated in=
 the
syntax, either explicitly or as defaults. Then, every
<tt><i>element</i></tt>
object is constructed from its respective literal syntax and inserted into
the tree.
</p><p>

</p></dd></dl>
<a name=3D"N-0217A971">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.18">8.2.18</a=
> The <tt>..</tt> notation</h4>



In <b>TXR Lisp</b>, there is a special "dotdot" notation consisting of a pa=
ir of dots.
This can be written between successive atoms or compound expressions, and i=
s a
shorthand for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>.
<p>
That is to say,
<tt>A .. B</tt>
translates to
<tt>(rcons A B)</tt>,
and so for instance
<tt>(a b .. (c d) e .. f . g)</tt>
means
<tt>(a (rcons b (c d)) (rcons e f) . g)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>
function constructs a range object, which denotes a pair of values.
Range objects are most commonly used for referencing subranges of
sequences.
</p><p>
For instance, if
<tt>L</tt>
is a list, then
<tt>[L 1 .. 3]</tt>
computes a sublist of
<tt>L</tt>
consisting of
elements 1 through 2 (counting from zero).
</p><p>
Note that if this notation is used in the dot position of an improper
list, the transformation still applies. That is, the syntax
<tt>(a . b .. c)</tt>
is valid and produces the object
<tt>(a . (rcons b c))</tt>
which is another way of writing
<tt>(a rcons b c)</tt>,
which is quite probably nonsense.
</p><p>
The notation's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217A971">..</a></t=
t>
operator associates right to left, so that
<tt>a..b..c</tt>
denotes
<tt>(rcons a (rcons b c))</tt>.
</p><p>
Note that range objects are not printed using the dotdot notation.
A range literal has the syntax of a two-element list, prefixed by
<tt>#R</tt>.
(See Range Literals above).
</p><p>
In any context where the dotdot notation may be used, and where
it is evaluated to its value, a range literal may also be specified.
If an evaluated dotdot notation specifies two constant expressions, then
an equivalent range literal can replace it. For instance the
form
<tt>[L 1 .. 3]</tt>
can also be written
<tt>[L #R(1 3)]</tt>.
The two are syntactically different, and so if these expressions are being
considered for their syntax rather than value, they are not the same.
</p><p>
<a name=3D"N-02E5BE4A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.19">8.2.1=
9</a> The DWIM Brackets</h4>


<b>TXR Lisp</b> has a square bracket notation. The syntax
<tt>[...]</tt>
is a shorthand
way of writing
<tt>(dwim ...)</tt>.
The
<tt>[]</tt>
syntax is useful for situations
where the expressive style of a Lisp-1 dialect is useful.
<p>
For instance if
<tt>foo</tt>
is a variable which holds a function object, then
<tt>[foo 3]</tt>
can be used to call it, instead of
<tt>(call foo 3)</tt>.
If foo is a vector, then
<tt>[foo 3]</tt>
retrieves the fourth element, like
<tt>(vecref foo 3)</tt>.
Indexing over lists,
strings and hash tables is possible, and the notation is assignable.
</p><p>
Furthermore, any arguments enclosed in
<tt>[]</tt>
which are symbols are treated
according to a modified namespace lookup rule.
</p><p>
More details are given in the documentation for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
<a name=3D"N-03DD9E88">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.20">8.2.2=
0</a> Compound Forms</h4>


In <b>TXR Lisp</b>, there are two types of compound forms: the Lisp-2 style
compound forms, denoted by ordinary lists that are expressed with parenthes=
es.
There are Lisp-1 style compound forms denoted by the DWIM Brackets, describ=
ed
in the previous section.
<p>
The first position of an ordinary Lisp-2 style compound form, is expected t=
o
have a function or operator name.  Then arguments follow. There may
also be an expression in the dotted position, if the form is a function cal=
l.
</p><p>
If the form is a function call then the arguments are evaluated. If any of =
the
arguments are symbols, they are treated according to Lisp-2 namespacing rul=
es.
</p><p>
A function name may be a symbol, or else any of the syntactic forms given i=
n the
description of the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F222DA">func-get-=
name</a></tt>.
</p><p>
<a name=3D"N-030626A5">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.21">8.2.2=
1</a> Dot Position in Function Calls</h4>


<p>
If there is an expression in the dotted position of a function call
expression, it is also evaluated, and the resulting value is involved in th=
e
function call in a special way.
</p><p>
Firstly, note that a compound form cannot be used in the dot position,
for obvious reasons, namely that
<tt>(a b c . (foo z))</tt>
does not mean that there is
a compound form in the dot position, but denotes an alternate spelling for
<tt>(a b c foo z)</tt>,
where foo behaves as a variable.
</p><p>
If the dot position of a compound form is an atom, then the behavior
may be understood according to the following transformations:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
3BDFA9">f</a> a b c ... . x)  --&gt;  (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#N-026C3723">apply</a> (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-006E109C">fun</a> f) a b c ... x)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> a b =
c ... . x]  --&gt;  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
6C3723">apply</a> f a b c ... x]
</tt></pre><tt>

</tt>

<p>
In addition to atoms, meta-expressions and meta-symbols can appear in the d=
ot
position, even though their underlying syntax is comprised of a compound
expression. This appears to work according to a transformation pattern
which superficially appears to be the same as that for atoms:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
3BDFA9">f</a> a b c ... . @x)  --&gt;  (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#N-026C3723">apply</a> (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-006E109C">fun</a> f) a b c ... @x)
</tt></pre><tt>

</tt>

<p>
However, in this situation, the
<tt>@x</tt>
is actually the form
<tt>(sys:var x)</tt>
and the dotted form is actually a proper list. The transformation is
in fact taking place over a proper list, like this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
3BDFA9">f</a> a b c ... sys:var x)  --&gt;  (<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-026C3723">apply</a> (<a href=3D"http://nongnu.org/txr=
/txr-manpage.html#N-006E109C">fun</a> f) a b c ... (sys:var @x))
</tt></pre><tt>

</tt>

<p>
That is to say, the <b>TXR Lisp</b> form expander reacts to the presence of=
 a
<tt>sys:var</tt>
or
<tt>sys:expr</tt>
atom in embedded in the form. That symbol and the items which follow it
are wrapped in an additional level of nesting, converted into a single
compound form element.
</p><p>
Effectively, in all these cases, the dot notation constitutes a shorthand f=
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>.
</p><p>
Examples:
</p><p>
<tt>
</tt></p><pre><tt>  ;; a contains 3
  ;; b contains 4
  ;; c contains #(5 6 7)
  ;; s contains "xyz"

  (foo a b . c)  ;; calls (foo 3 4 5 6 7)
  (foo a)        ;; calls (foo 3)
  (foo . s)      ;; calls (foo #\x #\y #\z)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> .=
 a)     ;; yields 3
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> a=
 . b)   ;; yields (3 . 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> a=
 . c)   ;; yields (3 5 6 7)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a> =
a c)    ;; yields (3 . #(5 6 7))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a> a=
 . b)   ;; error: cons isn't variadic.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a> a=
 b . c) ;; error: cons requires exactly two arguments.

  [foo a b . c]  ;; calls (foo 3 4 5 6 7)

  [c 1]          ;; indexes into vector #(5 6 7) to yield 6

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> list 1=
 . @1) 2) ;; yields (1 . 2)
</tt></pre><tt>

</tt>

<p>
Note that the atom in the dot position of a function call may
be a symbol macro. Since the semantics works as if by
transformation to an apply form in which the original dot
position atom is an ordinary argument, the symbol macro
may produce a compound form.
</p><p>
Thus:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
321AB1">symacrolet</a> ((x 2))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 1 . x))  ;; yields (1 . 2)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrolet=
</a> ((x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">lis=
t</a> 1 2)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 1 . x))  ;; yields (1 1 2)
</tt></pre><tt>

</tt>

<p>
That is to say, the expansion of
<tt>x</tt>
is not substituted into the form
<tt>(list 1 . x)</tt>
but rather the transformation to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>
syntax takes place first, and
so the substitution of
<tt>x</tt>
takes place in a form resembling
<tt>(apply (fun list) 1 x)</tt>.
</p><p>
Dialect Note:
</p><p>
In some other Lisp dialects like ANSI Common Lisp, the improper list syntax=
 may
not be used as a function call; a function called apply (or similar) must b=
e
used for application even if the expression which gives the trailing argume=
nts
is a symbol. Moreover, applying sequences other than lists is not supported=
.
</p><p>
<a name=3D"N-03585CFE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.22">8.2.2=
2</a> Improper Lists as Macro Calls</h4>


<p>
<b>TXR Lisp</b> allows macros to be called using forms which are improper l=
ists.
These forms are simply destructured by the usual macro parameter list
destructuring. To be callable this way, the macro must have an argument
list which specifies a parameter match in the dot position. This dot positi=
on
must either match the terminating atom of the improper list form,
or else match the trailing portion of the improper list form.
</p><p>
For instance if a macro mac is defined as
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> mac (a b . c) ...)
</tt></pre><tt>

</tt>

<p>
then it may not be invoked as
<tt>(mac 1 . 2)</tt>
because the required argument
<tt>b</tt>
is not satisfied, and so the
<tt>2</tt>
argument cannot match the dot position
<tt>c</tt>
as required. The macro may be called as
<tt>(mac 1 2 . 3)</tt>
in which case
<tt>c</tt>
receives the form
<tt>3</tt>.
If it is called as
<tt>(mac 1 2 3 . 4)</tt>
then
<tt>c</tt>
receives the improper list form
<tt>3 . 4</tt>.
</p><p>
<a name=3D"N-003988F9">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.23">8.2.2=
3</a> Regular Expression Literals</h4>


In <b>TXR Lisp</b>, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
character can occur in symbol names, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
token
is a symbol. Therefore the
<tt>/regex/</tt>
syntax is not used for denoting regular expressions; rather, the
<tt>#/regex/</tt>
syntax is used.
<p>
<a name=3D"N-01BB4378">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.24">8.2.2=
4</a> Notation for Circular and Shared Structure</h4>


<p>
<b>TXR Lisp</b> supports a printed notation called
<i>circle notation</i>

which accurately articulates
the representation of objects which contain shared substructures as well
as circular references. The notation is supported as a means of
input, and is also optionally produced as output, controlled by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FC9977">*print-ci=
rcle*</a></tt>
variable.
</p><p>
Ordinarily, shared substructure in printed objects is not
evident, except in the case of multiple occurrences of interned symbols,
in whose semantics it is implicit that they refer to the same object.
Other shared structure is printed as separate copies which look like
distinct objects. For instance, the object produced by
<tt>(let ((shared '(1 2))) (list shared shared))</tt>
is printed as
<tt>((1 2) (1 2))</tt>,
where it is not clear that the two occurrences of
<tt>(1 2)</tt>
are actually the same object. Under the circle notation, this object
can be represented as
<tt>(#5=3D(1 2) #5#)</tt>.
The
<tt>#5=3D</tt>
part introduces a reference label, associating the arbitrarily
chosen non-negative integer 5 with the object which follows.
The subsequent notation
<tt>#5#</tt>
simply refers to the object labeled by 5, reproducing that object
by reference. The result is a two-element list which has the same
<tt>(1 2)</tt>
in two places.
</p><p>
Circular structure presents a greater challenge to printing: namely, if it =
is
printed by a naive recursive descent, it results in infinite output, and
possibly stack exhaustion due to recursion. The circle notation detects
and handles circular references. For instance, the object produced by
<tt>(let ((c (list 1))) (rplacd c c))</tt>
produces a circular list which looks like an infinite list of 1's:
<tt>(1 1 1 1 ...)</tt>.
This cannot be printed. However, under the circle notation, it can
be represented as
<tt>#1=3D(1 . #1#)</tt>.
The entire object itself is labeled by the integer 1. Then, enclosed
within the syntax of that labeled object itself, a reference occurs
to the label. This circular label reference represents the corresponding
circular reference in the object.
</p><p>
A detailed description of the notational elements follows:
</p><p>



</p><dl class=3D"items">
<dt><tt>#<tt><i>digits</i></tt><tt>=3D </tt><tt><i>object</i></tt><tt> </tt=
></tt></dt><dd>



The
<tt>#=3D</tt>
syntax introduces an object label which denotes the
object whose printed representation follows. The label is identified by
the integer value arising from digits
<tt><i>digits</i></tt>
which are one or more decimal digits. Note: the value zero is permitted;
even though when the notation is produced by the <b>TXR Lisp</b> printer, l=
abeling
begins at 1. Negative values are not possible because a leading sign
is not part of the syntax.
<p>
There may be no more than one definition for a given label within the synta=
ctic
scope being parsed, otherwise a syntax error occurs.
In <b>TXR</b> pattern language code,
an entire source file is parsed as one unit, and so scope for the circular
notation's references is the entire source file. Files processed by
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2ECA0">include=
</a>)</tt>
have their own scope. The scope for labels in <b>TXR Lisp</b> source code i=
s the
top-level expression in which they appear.  Consequently, references
in one <b>TXR Lisp</b> top-level expression cannot reach definitions in ano=
ther.
</p><p>



</p></dd><dt><tt>#<tt><i>digits</i></tt><tt># </tt></tt></dt><dd>



The
<tt>##</tt>
syntax denotes a label reference: the repetition of an object that was
previously labeled by the integer given by
<tt><i>digits</i></tt>.
If no such label had been introduced in the syntactic scope,
a syntax error occurs.
An object was previously labeled by
<tt><i>digits</i></tt>
if a
<tt>#=3D</tt>
definition occurs in the same syntactic scope as the reference,
and is applied to an object which either encloses the reference,
or lexically precedes the reference.  Forward references such as
<tt>(#1# #1=3D(1 2))</tt>
are not supported.
</dd></dl>
<p>

</p><p>
Note:
</p><p>
Circular notation can span hash table literals. The syntax
<tt>#1=3D#H((:eql-based) (#1# #1#))</tt>
denotes an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>-based
hash table which contains one entry, in which that
same table itself is both the key and value. This kind of
circularity is not supported for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
hash tables. The analogous syntax
<tt>#1=3D#H(() (#1# #1#))</tt>
produces a hash table in an inconsistent state.
</p><p>
Dialect Note:
</p><p>
Circle notation is taken from Common Lisp, intended to be unsurprising to u=
sers familiar with that
language.
The implementation is based on descriptions in the ANSI Common Lisp
document, judiciously taking into account the content of the X3J13 Cleanup
Issues named PRINT-CIRCLE-STRUCTURE:USER-FUNCTIONS-WORK and
PRINT-CIRCLE-SHARED:RESPECT-PRINT-CIRCLE.
</p><p>
<a name=3D"N-02E46A67">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.2.25">8.2.2=
5</a> Notation for Erasing Objects</h4>


<p>



</p><dl class=3D"items">
<dt><tt>#; <tt><i>expr</i></tt><tt> </tt></tt></dt><dd>



The <b>TXR Lisp</b> notation
<tt>#;</tt>
in TXR Lisp indicates that the expression
<tt><i>expr</i></tt>
is to be read and then discarded, as if it were replaced by whitespace.
<p>
This is useful for temporarily "commenting out" an expression.
</p></dd></dl>
<p>

Notes:
</p><p>
Whereas it is valid for a <b>TXR Lisp</b> source file to be empty, it is
a syntax error if a <b>TXR Lisp</b> source file contains nothing but one or=
 more
objects which are each suppressed by a preceding
<tt>#;</tt>.
In the interactive listener, an input line consisting of nothing but
commented-out objects is similarly a syntax error.
</p><p>
The notation does not cascade; consecutive occurrences of
<tt>#;</tt>
trigger a syntax error.
</p><p>
The notation interacts with the circle notation. Firstly, if an object
which is erased by
<tt>#;</tt>
contains circular-referencing instances of the label notation,
those instances refer to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Secondly, commented-out objects may introduce labels
which are subsequently referenced in
<tt><i>expr</i></tt>.
An example of the first situation occurs in:
</p><p>
<tt>
</tt></p><pre><tt>  #;(#1=3D(#1#))
</tt></pre><tt>

</tt>

<p>
Here the
<tt>#1#</tt>
label is a circular reference because it refers to an object which
is a parent of the object which contains that reference. Such a reference
is only satisfied by a "backpatching" process once the entire surrounding s=
yntax
is processed to the top level. The erasure perpetrated by
<tt>#;</tt>
causes the
<tt>#1#</tt>
label reference to be replaced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and therefore the labeled object is the object
<tt>(nil)</tt>.
</p><p>
An example of the second situation is
</p><p>
<tt>
</tt></p><pre><tt>  #;(#2=3D(a b c)) #2#
</tt></pre><tt>

</tt>

<p>
Here, even though the expression
<tt>(#2=3D(a b c))</tt>
is suppressed, the label definition which it has introduced persists into t=
he
following object, where the label reference
<tt>#2#</tt>
resolves to
<tt>(a b c)</tt>.
</p><p>
A combination of the two situations occurs in
</p><p>
<tt>
</tt></p><pre><tt>  #;(#1=3D(#1#)) #1#
</tt></pre><tt>

</tt>

<p>
which yields
<tt>(nil)</tt>.
This is because the
<tt>#1=3D</tt>
label is available; but the earlier
<tt>#1#</tt>
reference, being a circular reference inside an erased object, had lapsed t=
o
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<a name=3D"N-025B2358">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.3">8.3</a> =
Generalization of List Accessors</h3>



<p>


In ancient Lisp in the 1960's, it was not possible to apply the operations
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
symbol (empty list), because it is not a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell. In
the InterLisp dialect, this restriction was lifted: these operations were
extended to accept
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
(and return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>).
The convention was adopted in
other Lisp dialects such as MacLisp and eventually in Common Lisp. Thus the=
re
exists an object which is not a cons, yet which takes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
</p><p>
In <b>TXR Lisp</b>, this relaxation is extended further. For the sake of co=
nvenience,
the operations
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
are made to work with strings and vectors:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
69">cdr</a> "") -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> "") -&=
gt; nil

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> "abc")=
 -&gt; #\a
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> "abc")=
 -&gt; "bc"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> #(1 2 =
3)) -&gt; #(2 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> #(1 2 =
3)) -&gt; 1
</tt></pre><tt>

</tt>

<p>
Moreover, structure types which define the methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
can also be treated in the same way.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
function is also extended in a special way. When the right parameter
a non-list sequence, then it uses the equal equality test rather than eq fo=
r
detecting the tail of the list.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
193773">ldiff</a> "abcd" "cd") -&gt; (#\a #\b)
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
operation starts with
<tt>"abcd"</tt>

and repeatedly applies
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
to produce
<tt>"bcd"</tt>

and
<tt>"cd"</tt>,
until the suffix is equal to the second argument:
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a> "cd" "=
cd")
</tt>

yields true.
</p><p>
Operations based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>,
such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remq</a><=
/tt>
extend to
strings and vectors.
</p><p>
Most derived list processing operations such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remq</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
obey the following
rule: the returned object follows the type of the leftmost input list objec=
t.
For instance, if one or more sequences are processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>,
and the
leftmost one is a character string, the function is expected to return
characters, which are converted to a character string. However, in the
event that the objects produced cannot be assembled into that type of
sequence, a list is returned instead.
</p><p>
For example
<tt>

[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a> l=
ist "ab" "12"]
</tt>

returns
<tt>((#\a #\b) (#\1 #\2))</tt>,
because a string cannot hold lists of characters. However
<tt>

[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</a> =
list "ab" "12"]
</tt>

returns
<tt>"a1b2"</tt>.
</p><p>
The lazy versions of these functions such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar*</=
a></tt>
do not have this behavior;
they produce lazy lists.
</p><p>
<a name=3D"N-0204FDAC">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.4">8.4</a> =
Generalization of Iteration</h3>



<p>


</p><p>
<b>TXR Lisp</b> implements a unified paradigm for iterating over sequence-l=
ike
container structures and abstract spaces such as bounded and unbounded rang=
es
of integers. This concept is based around an iterator abstraction which is
directly compatible with Lisp cons cell traversal in the sense that when
iteration takes place over lists, the iterator instance is nothing but a co=
ns
cell.
</p><p>
An iterator is created using the constructor function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
which takes a single argument. The argument denotes a space to be traversed=
;
the iterator provides the means for that traversal.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
function is applied to a list (a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
object), the return value is that object itself. The remaining functions
in the iterator API then behave like aliases for list processing functions.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
</p><p>
For example, the following loops not only produce identical behavior,
but the
<tt>iter</tt>
variable steps through the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells in the same manner in both:
</p><p>
<tt>
</tt></p><pre><tt>  ;; print all symbols in the list (a b c d):

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
iter '(a b c d)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a=
> iter
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> iter=
))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> it=
er (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> iter)=
)))

  ;; likewise:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
iter (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin<=
/a> '(a b c d))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a> =
iter)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a=
> iter))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> it=
er (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
 iter))))
</tt></pre><tt>

</tt>

<p>
There are three important differences.
</p><p>
Firstly, both examples will still work
if the list
<tt>(a b c d)</tt>
is replaced by a different kind of sequence, such as the string
<tt>"abcd"</tt>

or the vector
<tt>#(a b c d)</tt>.
However, the former example will not execute efficiently on these objects.
The reason is that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
function will construct successive suffixes of the string and list object.
That requires not only the allocation of memory, but changes the running ti=
me
complexity of the loop from linear to quadratic.
</p><p>
Secondly, the former example with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>/=
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
will not work correctly if the sequence is an empty non-list sequence, like
the null string or empty vector. Rectifying this problem requires the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
function to be used:
</p><p>
<tt>
</tt></p><pre><tt>  ;; print all symbols in the list (a b c d):

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
iter (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a>=
 "abcd")))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a=
> iter
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> iter=
))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> it=
er (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> iter)=
)))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
function converts empty sequences of all kinds into the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Thirdly, the second
example will work even if the input list is replaced with certain objects
which are not sequences at all:
</p><p>
<tt>
</tt></p><pre><tt>  ;; Print the integers from 0 to 3

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
iter (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin<=
/a> 0..4)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a> =
iter)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a=
> iter))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> it=
er (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
 iter))))

  ;; Print incrementing integers starting at 1,
  ;; breaking out of the loop after 100.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
iter (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin<=
/a> 1)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a> =
iter)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a> 100 (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a> iter)))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">retu=
rn</a>))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> it=
er (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
 iter))))
</tt></pre><tt>

</tt>

<p>
In <b>TXR Lisp</b>, numerous functions that appear as list processing funct=
ions in other
contemporary Lisp dialects, and historically, are actually sequence process=
ing
functions based on the above iterator paradigm.
</p><p>
<a name=3D"N-021B2981">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.5">8.5</a> =
Callable Objects</h3>



<p>


</p><p>
In <b>TXR Lisp</b>, sequences (strings, vectors and lists) as well as hashe=
s and
regular expressions can be used as functions everywhere, not just with the =
DWIM
brackets.
</p><p>
Sequences work as one or two-argument functions. With a single argument, an
element is selected by position and returned. With two arguments, a range i=
s
extracted and returned.
</p><p>
Moreover, when a sequence is used as a function of one argument, and the
argument is a range object rather than an integer, then the call is equival=
ent
to the two-argument form.  This is the basis for array slice syntax like
<tt>

["abc" 0..1] .
</tt>

</p><p>
Hashes also work as one or two argument functions, corresponding to the
arguments of the gethash function.
</p><p>
A regular expression behaves as a one, two, or three argument function, whi=
ch
operates on a string argument.
It returns the leftmost matching substring, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<b>Example 1:</b>

</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> "abc" '(2 0 1)) -&gt; (#\c #\a #\b)
</tt></pre><tt>

</tt>

<p>
Here,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
treats the string
<tt>"abc"</tt>

as a function of one argument (since there
is one list argument). This function maps the indices
<tt>0</tt>,
<tt>1</tt>
and
<tt>2</tt>
to the
corresponding characters of string
<tt>"abc"</tt>.
Through this function, the list of integer indices
<tt>(2 0 1)</tt>
is taken to the list of characters
<tt>(#\c #\a #\b)</tt>.
</p><p>
<b>Example 2:</b>

</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> '(1 2 3 4) 1..3) -&gt; (2 3)
</tt></pre><tt>

</tt>

<p>
Here, the shorthand
<tt>1 .. 3</tt>
denotes
<tt>(rcons 1 3)</tt>.
A range used as an argument
to a sequence performs range extraction: taking a slice starting at
index 1, up to and not including index 3, as if by the call
<tt>(sub '(1 2 3 4) 1 3)</tt>.
</p><p>
<b>Example 3:</b>

</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> '(1 2 3 4) '(0 2)) -&gt; (1 2)
</tt></pre><tt>

</tt>

<p>
A list of indices applied to a sequence is equivalent to using the
select function, as if
<tt>(select '(1 2 3 4) '(0 2))</tt>
were called.
</p><p>
<b>Example 4:</b>

</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> #/b./ "abcd") -&gt; "bc"
</tt></pre><tt>

</tt>

<p>
Here, the regular expression, called as a function, finds the matching
substring
<tt>"bc"</tt>

within the argument
<tt>"abcd"</tt>.
</p><p>
<a name=3D"N-03B076F9">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.6">8.6</a> =
Special Variables</h3>



<p>


Similarly to Common Lisp, <b>TXR Lisp</b> is lexically scoped by default, b=
ut
also has dynamically scoped (a.k.a "special") variables.
</p><p>
When a variable is defined with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>,
a binding for the symbol is
introduced in the global name space, regardless of in what scope the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
form occurs.
</p><p>
Furthermore, at the time the defvar form is evaluated, the symbol which
names the variable is tagged as special.
</p><p>
When a symbol is tagged as special, it behaves differently when it is used
in a lexical binding construct like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
and all other such constructs
such as function parameter lists. Such a binding is not the usual lexical
binding, but a "rebinding" of the global variable. Over the dynamic scope
of the form, the global variable takes on the value given to it by the
rebinding. When the form terminates, the prior value of the variable
is restored. (This is true no matter how the form terminates; even if by
an exception.)
</p><p>
Because of this "pervasive special" behavior of a symbol that has been
used as the name of a global variable, a good practice is to make global
variables have visually distinct names via the "earmuffs" convention:
beginning and ending the name with an asterisk.
</p><p>
</p><dl>
<dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
9DD0E7">defvar</a> *x* 42)     ;; *x* has a value of 42

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
print-x ()
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "~a\n" *x*))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
*x* "abc"))  ;; this overrides *x*
    (print-x))        ;; *x* is now "abc" and so that is printed

  (print-x)           ;; *x* is 42 again and so "42" is printed
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Dialect Note 1:</dt><dd>
<p>


</p><p>
The terms
<i>bind</i>

and
<i>binding</i>

are used differently in <b>TXR Lisp</b> compared to ANSI Common Lisp.
In <b>TXR Lisp</b> binding is an association between a symbol and an abstra=
ct storage
location. The association is registered in some namespace, such as the glob=
al
namespace or a lexical scope.  That storage location, in turn, contains a
value. In ANSI Lisp, a binding of a dynamic variable is the association bet=
ween
the symbol and a value.  It is possible for a dynamic variable to exist, an=
d
not have a value.  A value can be assigned, which creates a binding.
In <b>TXR Lisp</b>, an assignment is an operation which transfers a value i=
nto
a binding, not one which creates a binding.
</p><p>
In ANSI Lisp, a dynamic variable can exist which has no value. Accessing
the value signals a condition, but storing a value is permitted; doing so
creates a binding. By contrast, in <b>TXR Lisp</b> a global variable cannot=
 exist without
a value. If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
form doesn't specify a value, and the variable doesn't exist, it is
created with a value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Dialect Note 2:</dt><dd>
<p>


</p><p>
Unlike ANSI Common Lisp, <b>TXR Lisp</b> has global lexical variables in ad=
dition to
special variables. These are defined using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defparml<=
/a></tt>.
The only difference is that when variables are introduced by these macros,
the symbols are not marked special, so their binding in lexical scopes
is not altered to dynamic binding.
</p><p>
Many variables in <b>TXR Lisp</b>'s standard library are global lexicals.
Those which are special variables obey the "earmuffs" convention
in their naming. For instance
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifmt</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D75EC">log-emerg=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-hup</=
a></tt>
are global lexicals, because they provide constant values
for which overriding doesn't make sense. On the other hand the standard
output stream variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
is special. Overriding it over a dynamic scope is useful, as a means of
redirecting the output of functions which write to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
stream.
</p><p>
</p></dd><dt>Dialect Note 3:</dt><dd>
<p>


</p><p>
In Common Lisp,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>
is known as
<tt>defparameter</tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-015596F7">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7">8.7</a> Synt=
actic Places and Accessors</h3>



<p>


</p><p>
The <b>TXR Lisp</b> feature known as
<i>syntactic places</i>

allows programs to use
the syntax of a form which is used to
<i>access</i>

a value from an environment or
object, as an expression which denotes a
<i>place</i>

where a value may be
<i>stored.</i>

</p><p>
They are almost exactly the
same concept as "generalized references" in Common Lisp, and are related to
"lvalues" in languages in the C family, or "designators" in Pascal.
</p><p>
<a name=3D"N-024FE946">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.1">8.7.1<=
/a> Symbolic Places</h4>


<p>
A symbol is a is a syntactic place if it names a variable. If
<tt>a</tt>
is a variable, then it may be assigned using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
operator: the form
<tt>(set a 42)</tt>
causes
<tt>a</tt>
to have the integer value 42.
</p><p>
<a name=3D"N-0278265C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.2">8.7.2<=
/a> Compound Places</h4>


<p>
A compound expression can be a syntactic place, if its leftmost constituent=
 is
as symbol which is specially registered, and if the form has the correct sy=
ntax
for that kind of place, and suitable semantics. Such an expression is a com=
pound
place.
</p><p>
An example of a compound place is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
form. If
<tt>c</tt>
is an expression denoting a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell, then
<tt>(car c)</tt>
is not only an expression which retrieves the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of the cell. It is also a syntactic place which denotes that field as
a storage location. Consequently, the expression
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> c) "abc")
</tt>

stores the character string
<tt>"abc"</tt>

in that location.  Although the same effect can be obtained with
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a> c "ab=
c")
</tt>

the syntactic place frees the programmer from having to remember
different update functions for different kinds of places.
There are
various other advantages. <b>TXR Lisp</b> provides a plethora of operators
for modifying a place in addition to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>.
Subject to certain usage restrictions, these operators work uniformly on al=
l
places. For instance, the expression
<tt>(rotate (car x) [str 3] y)</tt>
causes three different kinds of places to exchange contents,
while the three expressions denoting those places
are evaluated only once. New kinds of place update macros like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166291D">rotate</a=
></tt>
are quite easily defined, as are new kinds of compound places.
</p><p>
<a name=3D"N-02D99C45">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.3">8.7.3<=
/a> Accessor Functions</h4>


<p>
When a function call form such as the above
<tt>(car x)</tt>
is a syntactic place, then the function is called an
<i>accessor</i>.

This term is used throughout this document to denote functions
which have associated syntactic places.
</p><p>
<a name=3D"N-02909D48">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.4">8.7.4<=
/a> Macro Call Syntactic Places</h4>


<p>
Syntactic places can be macros (global and lexical), including symbol macro=
s.
So for instance in
<tt>(set x 42)</tt>
the
<tt>x</tt>
place can actually be a symbolic macro which expands to, say,
<tt>(cdr y)</tt>.
This means that the assignment is effectively
<tt>(set (cdr y) 42)</tt>.
</p><p>
<a name=3D"N-0062C823">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.5">8.7.5<=
/a> User-Defined Syntactic Places and Place Operators</h4>


<p>
Syntactic places, as well as operators upon syntactic places,
are both open-ended. Code can be written quite easily in <b>TXR Lisp</b> to=
 introduce
new kinds of places, as well as new place-mutating operators.
New places can be introduced with the help of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
macros, or possibly the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C3089A">define-pl=
ace-macro</a></tt>
macro in simple cases when a new syntactic place can be expressed as a
transformation to the syntax of an existing place.
Three ways exist for developing new place update macros (place operators).
They can be written using the ordinary macro definer
ordinary macro definer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>,
with the help of special utility macros called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clob=
ber-expander</a></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6E020">with-dele=
te-expander</a></tt>.
They can also be written using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
in conjunction with the operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet*=
</a></tt>.
Simple update macros similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C211C1">push</a><=
/tt>
can be written compactly using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E03C4">define-mo=
dify-macro</a></tt>.
</p><p>
<a name=3D"N-008BEEA3">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.6">8.7.6<=
/a> Deletable Places</h4>


<p>
Unlike generalized references in Common Lisp, <b>TXR Lisp</b> syntactic
places support the concept of deletion. Some kinds of places
can be deleted, which is an action distinct from (but does not preclude) be=
ing
overwritten with a value. What exactly it means for a place to be deleted,
or whether that is even permitted, depends on the kind of place.
For instance a place which denotes a lexical variable may not be deleted,
whereas a global variable may be.
A place which denotes a hash table entry may be deleted, and results in the
entry being removed from the hash table. Deleting a place in a list
causes the trailing items, if any, or else the terminating atom, to
move in to close the gap. Users may define new kinds of places
which support deletion semantics.
</p><p>
<a name=3D"N-01C2A7EC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.7">8.7.7<=
/a> Evaluation of Places</h4>


<p>
To bring about their effect, place operators must evaluate one or
more places. Moreover, some of them evaluate additional forms which are not
places. Which arguments of a place operator form are places and which are
ordinary forms depends on its specific syntax. For all the built-in place
operators, the position of an argument in the syntax determines whether it =
is
treated as (and consequently required to be) a syntactic place, or whether =
it is
an ordinary form.
</p><p>
All built-in place operators perform the evaluation of place and non-place
argument forms in strict left to right order.
</p><p>
Place forms are evaluated not in order to compute a value, but in order to
determine the storage location.  In addition to determining a storage locat=
ion,
the evaluation of a place form may possibly give rise to side effects.
Once a place is fully evaluated, the storage location can then be accessed.
Access to the storage location is not considered part of the evaluation of =
a
place.  To determine a storage location means to compute some hidden refere=
ntial
object which provides subsequent access to that location without the need f=
or a
re-evaluation of the original place form.  (The subsequent access to the
place through this referential object may still require a multi-step traver=
sal
of a data structure; minimizing such steps is a matter of optimization.)
</p><p>
Place forms may themselves be compounds, which contain subexpressions that =
must
be evaluated. All such evaluation for the built-in places takes place in le=
ft
to right order.
</p><p>
Certain place operators, such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AC8471">shift</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166291D">rotate</a=
></tt>,
exhibit an unspecified behavior with regard to the timing of the access
of the prior value of a place, relative to the evaluation of places
which occur later in the same place operator form. Access to the prior valu=
es
may be delayed until the entire form is evaluated, or it may be interleaved
into the evaluation of the form. For example, in the form
<tt>(shift a b c 1)</tt>,
the prior value of
<tt>a</tt>
can be accessed and saved as soon as
<tt>a</tt>
is evaluated, prior to the evaluation of
<tt>b</tt>.
Alternatively,
<tt>a</tt>
may be accessed and saved later, after the evaluation of
<tt>b</tt>
or after the evaluation of all the forms.  This issue affects the behavior =
of
place-modifying forms whose subforms contain side effects. It is recommende=
d
that such forms not be used in programs.
</p><p>
<a name=3D"N-02A51FFD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.8">8.7.8<=
/a> Nested Places</h4>


<p>
Certain place forms are required to have one or more arguments which
are themselves places. The prime example of this, and the only example from
among built-in syntactic places, are DWIM forms. A DWIM form has the syntax
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">=
dwim</a> </tt><tt><i>obj-place</i></tt><tt> </tt><tt><i>index</i></tt><tt> =
[</tt><tt><i>alt</i></tt><tt>])=20

</tt>

</p><p>
and the square-bracket-notation equivalent:
</p><p>
<tt>




<br>&nbsp;&nbsp;[</tt><tt><i>obj-place</i></tt><tt> </tt><tt><i>index</i></=
tt><tt> [</tt><tt><i>alt</i></tt><tt>]]=20

</tt>

</p><p>
Note that not only is the entire form a place, denoting some element or ele=
ment
range of
<tt><i>obj-place</i></tt>,
but there is the added constraint that
<tt><i>obj-place</i></tt>
must also itself be a syntactic place.
</p><p>
This requirement is necessary, because it supports the behavior that
when the element or element range is updated, then
<tt><i>obj-place</i></tt>
is also potentially updated.
</p><p>
After the assignment
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> [obj 0..=
3] '("forty" "two"))
</tt>

not only is the range of places denoted by
<tt>[obj 0..3]</tt>
replaced by the list of strings
<tt>

("forty" "two")
</tt>

but
<tt>obj</tt>
may also be overwritten with a new value.
</p><p>
This behavior is necessary because the DWIM brackets notation maintains
the illusion of an encapsulated array-like container over several dis-simil=
ar
types, including Lisp lists.  But Lisp lists do not behave as fully
encapsulated containers.  Some mutations on Lisp lists return new objects,
which then have to stored (or otherwise accepted) in place of the original
objects in order to maintain the array-like container illusion.
</p><p>
<a name=3D"N-031BD7AD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.9">8.7.9<=
/a> Built-In Syntactic Places</h4>


<p>
The following is a summary of the built-in place forms, in addition to symb=
olic
places denoting variables. New syntactic place forms can be
defined by <b>TXR</b> programs.
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">=
car</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D604=
63">first</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022885=
59">rest</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA=
33">second</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA=
33">third</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;...=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA=
33">tenth</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">=
last</a> </tt><tt><i>object</i></tt><tt> [</tt><tt><i>num</i></tt><tt>])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6=
FA">butlast</a> </tt><tt><i>object</i></tt><tt> [</tt><tt><i>num</i></tt><t=
t>])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">=
cdr</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209C=
EE">caar</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209C=
EE">cadr</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209C=
EE">cdar</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209C=
EE">cddr</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;...=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209C=
EE">cdddddr</a> </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D=
22">nthcdr</a> </tt><tt><i>index</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=
=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FC66=
FA">nthlast</a> </tt><tt><i>index</i></tt><tt> </tt><tt><i>obj</i></tt><tt>=
)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C3=
34">butlastn</a> </tt><tt><i>num</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=
=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">=
last</a> </tt><tt><i>num</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0039F3=
FB">nth</a> </tt><tt><i>index</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419=
FB">ref</a> </tt><tt><i>seq</i></tt><tt> </tt><tt><i>idx</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F4=
2F">sub</a> </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt=
> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001963=
BF">vecref</a> </tt><tt><i>vec</i></tt><tt> </tt><tt><i>idx</i></tt><tt>)=
=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FE=
F2">chr-str</a> </tt><tt><i>str</i></tt><tt> </tt><tt><i>idx</i></tt><tt>)=
=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5=
FA">gethash</a> </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i></tt><tt> =
[</tt><tt><i>alt</i></tt><tt>])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1C=
EB">hash-userdata</a> </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">=
dwim</a> </tt><tt><i>obj-place</i></tt><tt> </tt><tt><i>index</i></tt><tt> =
[</tt><tt><i>alt</i></tt><tt>])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E3E=
1D">sub-list</a> </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>from</i></tt><tt=
> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BFFF=
0A">sub-vec</a> </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>from</i></tt><tt>=
 [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFE=
F2">sub-str</a> </tt><tt><i>str</i></tt><tt> [</tt><tt><i>from</i></tt><tt>=
 [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;[</tt><tt><i>obj-place</i></tt><tt> </tt><tt><i>index</i></=
tt><tt> [</tt><tt><i>alt</i></tt><tt>]] ;; equivalent to dwim=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004D=
DC">symbol-value</a> </tt><tt><i>symbol-valued-form</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004D=
DC">symbol-function</a> </tt><tt><i>function-name-valued-form</i></tt><tt>)=
=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004D=
DC">symbol-macro</a> </tt><tt><i>symbol-valued-form</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E10=
9C">fun</a> </tt><tt><i>function-name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030722=
3D">force</a> </tt><tt><i>promise</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A713=
7C">errno</a>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F6=
2D">slot</a> </tt><tt><i>struct-obj</i></tt><tt> </tt><tt><i>slot-name-valu=
ed-form</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">=
qref</a> </tt><tt><i>struct-obj</i></tt><tt> </tt><tt><i>slot-name</i></tt>=
<tt>) ;; by macro-expansion to (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-0326F62D">slot</a> ...)=20




<br>&nbsp;&nbsp;</tt><tt><i>struct-obj</i></tt><tt>.</tt><tt><i>slot-name</=
i></tt><tt> ;; equivalent to qref=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABE=
C7">sock-peer</a> </tt><tt><i>socket</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF5B=
C5">carray-sub</a> </tt><tt><i>carray</i></tt><tt> [</tt><tt><i>from</i></t=
t><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000FFE=
37">sub-buf</a> </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>from</i></tt><tt>=
 [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C=
1D">left</a> </tt><tt><i>node</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C=
1D">right</a> </tt><tt><i>node</i></tt><tt>)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C=
1D">key</a> </tt><tt><i>node</i></tt><tt>)=20

</tt>

</p><p>
<a name=3D"N-014ADCC0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.7.10">8.7.1=
0</a> Built-In Place-Mutating Operators</h4>


<p>
The following is a summary of the built-in place mutating macros.
They are described in detail in their own sections.
</p><p>



</p><dl class=3D"items">
<dt><tt>(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> =
{<tt><i>place</i></tt><tt> </tt><tt><i>new-value</i></tt><tt>}*) </tt></tt>=
</dt><dd>



Assigns the values of expressions to places, performing assignments in left=
 to right order,
returning the value assigned to the rightmost place.
<p>



</p></dd><dt><tt>(pset {<tt><i>place</i></tt><tt> </tt><tt><i>new-value</i>=
</tt><tt>}*) </tt></tt></dt><dd>



Assigns the values of expressions to places, performing the determination o=
f
places and evaluation of the expressions left to right, but the assignment
in parallel. Returns the value assigned to the rightmost place.
<p>



</p></dd><dt><tt>(zap <tt><i>place</i></tt><tt> [</tt><tt><i>new-value</i><=
/tt><tt>]) </tt></tt></dt><dd>



Assigns
<tt><i>new-value</i></tt>
to place, defaulting to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and returns the prior value.
<p>



</p></dd><dt><tt>(flip <tt><i>place</i></tt><tt>) </tt></tt></dt><dd>



Logically toggles the Boolean value of
<tt><i>place</i></tt>,
and returns the new value.
<p>



</p></dd><dt><tt>(test-set <tt><i>place</i></tt><tt>) </tt></tt></dt><dd>



If
<tt><i>place</i></tt>
contains
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
stores
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
into the place and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
to indicate that the store took place.
Otherwise does nothing and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>



</p></dd><dt><tt>(test-clear <tt><i>place</i></tt><tt>) </tt></tt></dt><dd>



If
<tt><i>place</i></tt>
contains a Boolean true value, stores
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
into the place and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
to indicate that the store took place.
Otherwise does nothing and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>



</p></dd><dt><tt>(compare-swap <tt><i>place</i></tt><tt> </tt><tt><i>cmp-fu=
n</i></tt><tt> </tt><tt><i>cmp-val</i></tt><tt> </tt><tt><i>store-val</i></=
tt><tt>) </tt></tt></dt><dd>



Examines the value of
<tt><i>place</i></tt>
and compares it to
<tt><i>cmp-val</i></tt>
using the comparison function given by the function name
<tt><i>cmp-fun</i></tt>.
If the comparison is false, returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise, stores the
<tt><i>store-val</i></tt>
value into
<tt><i>place</i></tt>
and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
<p>



</p></dd><dt><tt>(inc <tt><i>place</i></tt><tt> [</tt><tt><i>delta</i></tt>=
<tt>]) </tt></tt></dt><dd>



Increments
<tt><i>place</i></tt>
by
<tt><i>delta</i></tt>,
which defaults to 1, and returns the new value.
<p>



</p></dd><dt><tt>(dec <tt><i>place</i></tt><tt> [</tt><tt><i>delta</i></tt>=
<tt>]) </tt></tt></dt><dd>



Decrements
<tt><i>place</i></tt>
by
<tt><i>delta</i></tt>,
which defaults to 1, and returns the new value.
<p>



</p></dd><dt><tt>(pinc <tt><i>place</i></tt><tt> [</tt><tt><i>delta</i></tt=
><tt>]) </tt></tt></dt><dd>



Increments
<tt><i>place</i></tt>
by
<tt><i>delta</i></tt>,
which defaults to 1, and returns the old value.
<p>



</p></dd><dt><tt>(pdec <tt><i>place</i></tt><tt> [</tt><tt><i>delta</i></tt=
><tt>]) </tt></tt></dt><dd>



Decrements
<tt><i>place</i></tt>
by
<tt><i>delta</i></tt>,
which defaults to 1, and returns the old value.
<p>



</p></dd><dt><tt>(test-inc <tt><i>place</i></tt><tt> [</tt><tt><i>delta</i>=
</tt><tt> [</tt><tt><i>from-val</i></tt><tt>]]) </tt></tt></dt><dd>



Increments
<tt><i>place</i></tt>
by
<tt><i>delta</i></tt>
and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the previous value was
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
to
<tt><i>from-val</i></tt>,
where
<tt><i>delta</i></tt>
defaults to 1
and
<tt><i>from-val</i></tt>
defaults to zero.
<p>



</p></dd><dt><tt>(test-dec <tt><i>place</i></tt><tt> [</tt><tt><i>delta</i>=
</tt><tt> [</tt><tt><i>to-val</i></tt><tt>]]) </tt></tt></dt><dd>



Decrements
<tt><i>place</i></tt>
by
<tt><i>delta</i></tt>
and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the new value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
to
<tt><i>to-val</i></tt>,
where
<tt><i>delta</i></tt>
defaults to 1
and
<tt><i>to-val</i></tt>
defaults to 0.
<p>



</p></dd><dt><tt>(swap <tt><i>left-place</i></tt><tt> </tt><tt><i>right-pla=
ce</i></tt><tt>) </tt></tt></dt><dd>



Exchanges the values of
<tt><i>left-place</i></tt>
and
<tt><i>right-place</i></tt>.
<p>



</p></dd><dt><tt>(push <tt><i>item</i></tt><tt> </tt><tt><i>place</i></tt><=
tt>) </tt></tt></dt><dd>



Adds
<tt><i>item</i></tt>
to the front of the list which is currently stored in
<tt>place</tt>,
then stores the extended list back into
<tt>place</tt>
and returns it.
<p>



</p></dd><dt><tt>(pop <tt><i>place</i></tt><tt>) </tt></tt></dt><dd>



Pop the list stored in
<tt><i>place</i></tt>
and returns the popped value.
<p>



</p></dd><dt><tt>(shift <tt><i>place</i></tt><tt>+ </tt><tt><i>shift-in-val=
ue)</i></tt><tt> </tt></tt></dt><dd>



Treats one or more places as a "multi-place shift register".
Values are shifted to the left among the places. The
rightmost place receives
<tt><i>shift-in-value</i></tt>,
and the value of the leftmost place emerges as the return value.
<p>



</p></dd><dt><tt>(rotate <tt><i>place</i></tt><tt>*) </tt></tt></dt><dd>



Treats zero or more places as a "multi-place rotate register".
The places exchange values among themselves, by a rotation
by one place to the left. The value of the leftmost place
goes to the rightmost place, and that value is returned.
<p>



</p></dd><dt><tt>(del <tt><i>place</i></tt><tt>) </tt></tt></dt><dd>



Deletes a place which supports deletion, and returns
the value which existed in that place prior to deletion.
<p>



</p></dd><dt><tt>(lset {<tt><i>place</i></tt><tt>}+ </tt><tt><i>list-expr</=
i></tt><tt>) </tt></tt></dt><dd>



Sets multiple places to values obtained from successive
elements of
<tt><i>sequence</i></tt>.
<p>



</p></dd><dt><tt>(upd <tt><i>place</i></tt><tt> </tt><tt><i>opip-arg</i></t=
t><tt>*) </tt></tt></dt><dd>



Applies an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>-style
operational pipeline to the value of
<tt><i>place</i></tt>
and stores the result back into
<tt><i>place</i></tt>.
<p>
</p></dd></dl>
<p>

</p><p>
<a name=3D"N-018617C6">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.8">8.8</a> =
Namespaces and Environments</h3>



<p>


</p><p>
<b>TXR Lisp</b> is a Lisp-2 dialect: it features separate namespaces for
functions and variables.
</p><p>
<a name=3D"N-03A72D00">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.8.1">8.8.1<=
/a> Global Functions and Operator Macros</h4>


<p>
In <b>TXR Lisp</b>, global functions and operator macros co-exist, meaning =
that the same
symbol can be defined as both a macro and a function.
</p><p>
There is a global namespace for functions,
into which functions can be introduced with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
macro.  The global function environment can be inspected and modified using=
 the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
accessor.
</p><p>
There is a global namespace for macros, into which
macros are introduced with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
macro. The global function environment can be inspected and modified using =
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-ma=
cro</a></tt>
accessor.
</p><p>
If a name
<tt>x</tt>
is defined as both a function and a macro, then an expression of the form
<tt>(x ...)</tt>
is expanded by the macro, whereas an expression of the form
<tt>[x ...]</tt>
refers to the function. Moreover, the macro can produce a call to the
function.  The expression
<tt>(fun x)</tt>
will retrieve the function object.
</p><p>
<a name=3D"N-03910FBD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.8.2">8.8.2<=
/a> Global and Dynamic Variables</h4>


<p>
There is a global namespace for variables also.
The operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>
introduce bindings into this namespace. These operators have the
side effect of marking a symbol as a special variable,
of the symbol are treated as dynamic variables, subject to
rebinding.  The global variable namespace together with the special dynamic
rebinding is called the dynamic environment.
The dynamic environment can be inspected and modified using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-va=
lue</a></tt>
accessor.
</p><p>
The operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defparml<=
/a></tt>
introduce bindings into the global namespace without marking
symbols as special variables. Such bindings are called global lexical
variables.
</p><p>
<a name=3D"N-00E3CDD1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.8.3">8.8.3<=
/a> Global Symbol Macros</h4>


<p>
Symbol macros may be defined over the global variable namespace
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>.
</p><p>
Note that whereas a symbol may simultaneously have both a function and macr=
o
binding in the global namespace, a symbol may not simultaneously have
a variable and symbol macro binding.
</p><p>
<a name=3D"N-0284CA29">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.8.4">8.8.4<=
/a> Lexical Environments</h4>


<p>
In addition to global and dynamic namespaces, <b>TXR Lisp</b> provides lexi=
cally scoped
binding for functions, variables, macros, and symbol macros.
Lexical variable binding are introduced with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
or various binding macros derived from these. Lexical functions are bound
with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>.
Lexical macros are established with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
and lexical symbol macros with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>.
</p><p>
Macros receive an environment parameter with which they may expand
forms in their correct environment, and perform some limited introspection
over that environment in order to determine the nature of bindings,
or the classification of forms in those environments. This introspection
is provided by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B1A53">lexical-v=
ar-p</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B1A53">lexical-f=
un-p</a></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D124AB">lexical-l=
isp1-binding</a></tt>.
</p><p>
Lexical operator macros and lexical functions can also co-exist in the
following way.  A lexical function shadows a global or lexical macro
completely. However, the reverse is not the case. A lexical macro shadows
only those uses of a function which look like macro calls. This is
succinctly demonstrated by the following form:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
09307D">flet</a> ((foo () 43))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet=
</a> ((foo () 44))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> f=
oo) (foo) [foo])))

  -&gt; (#&lt;interpreted fun: lambda nil&gt; 44 43)
</tt></pre><tt>

</tt>

<p>
The
<tt>(fun foo)</tt>
and
<tt>[fun]</tt>
expressions are oblivious to the macro; the macro expansion process
process the symbol
<tt>foo</tt>
in those contexts. However the form
<tt>(foo)</tt>
is subject to macro-expansion and replaced with
<tt>44</tt>.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
are reversed, the behavior is different:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
AC12C0">macrolet</a> ((foo () 44))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a>=
 ((foo () 43))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> f=
oo) (foo) [foo])))

  -&gt; (#&lt;interpreted fun: lambda nil&gt; 43 43)
</tt></pre><tt>

</tt>

<p>
All three forms refer to the function, which lexically shadows the macro.
</p><p>
<a name=3D"N-031BE3BA">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-8.8.5">8.8.5<=
/a> Pattern Language and Lisp Scope Nesting</h4>


<p>
<b>TXR Lisp</b> expressions can be embedded in the <b>TXR</b> pattern langu=
age in various
ways. Likewise, the pattern language can be invoked from <b>TXR Lisp</b>. T=
his
brings about the possibility that Lisp code attempts to access
pattern variables bound in the pattern language. The <b>TXR</b> pattern lan=
guage
can also attempt to access <b>TXR Lisp</b> variables.
</p><p>
The rules are as follows, but they have undergone historic changes.  See th=
e
COMPATIBILITY section, in particular notes under 138 and 121, and also 124.
</p><p>
A Lisp expression evaluated from the <b>TXR</b> pattern language executes
in a null lexical environment. The current set of pattern variables capture=
d
up to that point by the pattern language are installed as dynamic variables=
.
They shadow any Lisp global variables (whether those are defined
by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</=
a></tt>).
</p><p>
In the reverse direction, a variable reference from the <b>TXR</b> pattern
language searches the pattern variable space first. If a variable doesn't
exist there, then the lookup refers to the <b>TXR Lisp</b> global variable =
space.
The pattern language doesn't see Lisp lexical variables.
</p><p>
When Lisp code is evaluated from the pattern language, the pattern variable
bindings are not only installed as dynamic variables for the sake of their
visibility from Lisp, but they are also specially stored in a dynamic
environment frame.  When <b>TXR</b> pattern code is re-entered from Lisp, t=
hese
bindings are picked up from the closest such environment frame, allowing th=
e
nested invocation of pattern code to continue with the bindings captured by
outer pattern code.
</p><p>
Concisely, in any context in which a symbol has both a binding as a Lisp gl=
obal
variable as well as a pattern variable, that symbol refers to the pattern
variable. Pattern variables are propagated through Lisp evaluation into
nested invocations of the pattern language.
</p><p>
The pattern language can also reference
Lisp variables using the
<tt>@</tt>
prefix, which is a consequence of that prefix introducing an expression tha=
t is
evaluated as Lisp, the name of a variable being such an expression.
</p><p>
<a name=3D"N-015965C2">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9">9</a> LISP=
 OPERATOR, FUNCTION AND MACRO REFERENCE</h2>




<p>


</p><p>
<a name=3D"N-006C6D00">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.1">9.1</a> =
Conventions</h3>



<p>


The following sections list all of the special operators, macros
and functions in <b>TXR Lisp</b>.
</p><p>
In these sections, syntax is indicated using these conventions:
</p><p>



</p><dl class=3D"items">
<dt><tt><tt><i>word</i></tt><tt> </tt></tt></dt><dd>



A symbol in
<tt><i>fixed-width-italic</i></tt>
font
denotes some syntactic unit: it
may be a symbol or compound form. The syntactic unit is explained
in the corresponding Description section.
<p>



</p></dd><dt><tt>{syntax}* <tt><i>word</i></tt><tt>* </tt></tt></dt><dd>



This indicates a repetition of zero or more of the given
syntax enclosed in the braces or syntactic unit.
The curly braces may be omitted if the scope of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
is clear.
<p>



</p></dd><dt><tt>{syntax}+ <tt><i>word</i></tt><tt>+ </tt></tt></dt><dd>



This indicates a repetition of one or more of the given
syntax enclosed in the braces or syntactic unit.
The curly braces may be omitted if the scope of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
is clear.
<p>
</p></dd><dt><tt>{syntax | syntax | ...}</tt></dt><dd>

This indicates a choice among alternatives.
May be combined with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
repetition.
<p>



</p></dd><dt><tt>[syntax] [<tt><i>word</i></tt><tt>] </tt></tt></dt><dd>



Square brackets indicate optional syntax.
<p>
</p></dd><dt><tt>'[' ']'</tt></dt><dd>

The quoted square brackets indicate literal brackets which appear
in the syntax, which they do without quotes. For instance
<tt>'['foo [ bar ]']'</tt>
is a pattern denotes the two possible expressions
<tt>[foo]</tt>
and
<tt>[foo bar]</tt>.
<p>



</p></dd><dt><tt>syntax -&gt; <tt><i>result</i></tt><tt> </tt></tt></dt><dd=
>



The arrow notation is used in examples to indicate that the evaluation
of the given syntax produces a value, whose printed representation is
<tt><i>result</i></tt>.
<p>
</p></dd></dl>
<a name=3D"N-01D3CD75">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.2">9.2</a> Form=
 Evaluation</h3>



<p>


A compound expression with a symbol as its first element, if
intended to be evaluated, denotes either an operator invocation or a functi=
on
call. This depends on whether the symbol names an operator or a function.
</p><p>
When the form is an operator invocation, the interpretation of the meaning =
of
that form is under the complete control of that operator.
</p><p>
If the compound form is a function call, the remaining forms, if any, denot=
e
argument expressions to the function.  They are evaluated in left to right
order to produce the argument values, which are passed to the function.  An
exception is thrown if there are not enough arguments, or too many.  Progra=
ms
can define named functions with the defun operator
</p><p>
Some operators are macros. There exist predefined macros in the library, an=
d
macro operators can also be user-defined using the macro-defining operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>.
Operators that are not macros are called special operators.
</p><p>
Macro operators work as functions which are given the source code of the fo=
rm.
They analyze the form, and translate it to another form which is substitute=
d in
their place.   This happens during a code walking phase called the expansio=
n
phase, which is applied to each top-level expression prior to evaluation. A=
ll
macros occurring in a form are expanded in the expansion phase, and subsequ=
ent
evaluation takes place on a structure which is devoid of macros. All that
remains are the executable forms of special operators, function calls,
symbols denoting either variables or themselves, and atoms such as numeric
and string literals.
</p><p>
Special operators can also perform code transformations during the expansio=
n
phase, but that is not considered macroexpansion, but rather an adjustment
of the representation of the operator into an required executable form.
In effect, it is post-macro compilation phase.
</p><p>
Note that Lisp forms occurring in <b>TXR</b> pattern language are not indiv=
idual
top-level forms. Rather, the entire <b>TXR</b> query is parsed at the same =
time, and
the macros occurring in its Lisp forms are expanded at that time.
</p><p>

<a name=3D"N-0163F998">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.2.1">9.2.1<=
/a> Operator <tt>quote</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(quote </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>
operator, when evaluated, suppresses the evaluation of
<tt><i>form</i></tt>,
and instead returns
<tt><i>form</i></tt>
itself as an object. For example, if
<tt><i>form</i></tt>
is a symbol
<tt><i>sym</i></tt>,
then the value of
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> </=
tt><tt><i>sym</i></tt><tt>)=20

</tt>

is
<tt><i>sym</i></tt>
itself. Without
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>,
<tt><i>sym</i></tt>
would evaluate to the value held by the variable which is named
<tt><i>sym</i></tt>,
or else throw an error if there is no such variable.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>
operator never raises an error, if it is given exactly one argument,
as required.
</p><p>
The notation
<tt>




'</tt><tt><i>obj</i></tt><tt>=20

</tt>

is translated to the object
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> </=
tt><tt><i>obj</i></tt><tt>)=20

</tt>

providing a shorthand for quoting.  Likewise, when an object of the form
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> </=
tt><tt><i>obj</i></tt><tt>)=20

</tt>

is printed, it appears as
<tt>'obj</tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; yields symbol a itself, not value of variable a
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> =
a) -&gt; a

  ;; yields three-element list (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#D-007C">+</a> 2 2), not 4.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2)) -&gt=
; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-03A7361E">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.3">9.3</a> Vari=
able Binding</h3>



<p>


</p><p>
Variables are associations between symbols and storage locations
which hold values. These associations are called
<i>bindings</i>.

</p><p>
Bindings are held in a context called an
<i>environment</i>.

</p><p>
<i>Lexical</i>

environments hold local variables, and nest according to the syntactic
structure of the program. Lexical bindings are always introduced by a
some form known as a
<i>binding construct</i>,

and the corresponding environment is instantiated during the evaluation
of that construct. There also exist bindings outside of any binding
construct, in the so-called
<i>global environment .</i>

Bindings in the global environment can be temporarily shadowed by
lexically-established binding in the
<i>dynamic environment .</i>

See the Special Variables section above.
</p><p>
Certain special symbols cannot be used as variable names, namely the
symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and all of the keyword symbols (symbols in the keyword package), which are
denoted by a leading colon. When any of these symbols is evaluated as
a form, the resulting value is that symbol itself. It is said that these
special symbols are self-evaluating or self-quoting, similarly to all
other atom objects such as numbers or strings.
</p><p>
When a form consisting of a symbol, other than the above special symbols, i=
s
evaluated, it is treated as a variable, and yields the value of
the variable's storage location. If the variable doesn't exist,
an exception is thrown.
</p><p>
Note: symbol forms may also denote invocations of symbol macros. (See the
operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>).
All macros, including symbol macros, which occur inside
a form are fully expanded prior to the evaluation of a form, therefore
evaluation does not consider the possibility of a symbol being
a symbol macro.
</p><p>

<a name=3D"N-039DD0E7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.3.1">9.3.1<=
/a> Operator <tt>defvar</tt> and macro <tt>defparm</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defvar </tt><tt><i>sym</i></tt><tt> [</tt><tt><i>value</i>=
</tt><tt>])=20




<br>&nbsp;&nbsp;(defparm </tt><tt><i>sym</i></tt><tt> </tt><tt><i>value</i>=
</tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
operator binds a name in the variable namespace of the global environment.
Binding a name means creating a binding: recording, in some namespace of so=
me
environment, an association between a name and some named entity. In the
case of a variable binding, that entity is a storage location for a value.
The value of a variable is that which has most recently been written into t=
he
storage location, and is also said to be a value of the binding, or stored
in the binding.
</p><p>
If the variable named
<tt><i>sym</i></tt>
already exists in the global environment, the
form has no effect; the
<tt><i>value</i></tt>
form is not evaluated, and the value of the
variable is unchanged.
</p><p>
If the variable does not exist, then a new binding is introduced, with a va=
lue
given by evaluating the
<tt><i>value</i></tt>
form. If the form is absent, the variable is initialized
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>value</i></tt>
form is evaluated in the environment
in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
form occurs, not necessarily in the global environment.
</p><p>
The symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
may not be used as variables, and neither
can be keyword symbols: symbols denoted by a leading colon.
</p><p>
In addition to creating a binding, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
operator also marks
<tt><i>sym</i></tt>
as the name of a special variable. This changes what it means to bind
that symbol in a lexical binding construct such as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
operator, or a function parameter list. See the section "Special Variables"=
 far
above.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>
macro behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
when a variable named
<tt><i>sym</i></tt>
doesn't already exist.
</p><p>
If
<tt><i>sym</i></tt>
already denotes a variable binding in the global namespace,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>
evaluates the
<tt><i>value</i></tt>
form and assigns the resulting value to the variable.
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
9DD0E7">defparm</a> x y)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#N-03F7A8B8">prog1</a> (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-039DD0E7">defvar</a> x) (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#D-002F">set</a> x y))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>
forms return
<tt><i>sym</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03F36A75">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.3.2">9.3.2</a> =
Macros <tt>defvarl</tt> and <tt>defparml</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defvarl </tt><tt><i>sym</i></tt><tt> [</tt><tt><i>value</i=
></tt><tt>])=20




<br>&nbsp;&nbsp;(defparml </tt><tt><i>sym</i></tt><tt> </tt><tt><i>value</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defparml<=
/a></tt>
macros behave, respectively, almost exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>.
</p><p>
The difference is that these operators do not mark
<tt><i>sym</i></tt>
as special.
</p><p>
If a global variable
<tt><i>sym</i></tt>
does not previously exist, then after the evaluation of
either of these forms
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a> <=
/tt><tt><i>sym</i></tt><tt>)=20

</tt>

is true, but
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00833473">special-var-=
p</a> </tt><tt><i>sym</i></tt><tt>)=20

</tt>

isn't.
</p><p>
If
<tt><i>sym</i></tt>
had been already introduced as a special variable, it stays that way
after the evaluation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defparml<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-013AF20B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.3.3">9.3.3</a> =
Operators <tt>let</tt> and <tt>let*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(let ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i><=
/tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></=
tt><tt>*)=20




<br>&nbsp;&nbsp;(let* ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i>=
</tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i><=
/tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
operators introduce a new scope with variables and
evaluate forms in that scope. The operator symbol, either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
is followed by a list which can contain any mixture of
<tt><i>sym</i></tt>
or
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

pairs.
Each
<tt><i>sym</i></tt>
must be a symbol, and specifies the name of variable to be instantiated and
initialized.
</p><p>
The
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

variant specifies that the new variable
<tt><i>sym</i></tt>
receives an initial value from the
evaluation of
<tt><i>init-form</i></tt>.
The plain
<tt><i>sym</i></tt>
variant specifies a variable which is initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt><i>init-form</i></tt>-s
are evaluated in order, by both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
</p><p>
The symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
may not be used as variables, and neither
can be keyword symbols: symbols denoted by a leading colon.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
is that in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
later
<tt>init-form</tt>-s
are in scope of the variables established by earlier variables in the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
construct. In plain
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
the
<tt><i>init-form</i></tt>-s
are evaluated in a scope which does not include any of the variables.
</p><p>
When the variables are established, the
<tt><i>body-form</i></tt>-s
are evaluated in order. The value of the last
<tt><i>body-form</i></tt>
becomes the return value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>.
If there are no
<tt><i>body-form</i></tt>-s,
then the return value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is produced.
</p><p>
The list of variables may be empty.
</p><p>
The list of variables may contain duplicate
<tt><i>sym</i></tt>-s
if the operator is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
In that situation, a given
<tt><i>init-form</i></tt>
has in scope the rightmost duplicate of any given
<tt><i>sym</i></tt>
that has been previously established.
The
<tt><i>body-form</i></tt>-s
have in scope the rightmost duplicate of any
<tt><i>sym</i></tt>
in the construct.
Therefore, the following form calculates the value 3:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let*</a> ((a 1)
         (a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">=
succ</a> a))
         (a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">=
succ</a> a)))
    a)
</tt></pre><tt>

</tt>

<p>
Each duplicate is a separately instantiated binding, and may be independent=
ly
captured by a lexical closure placed in a subsequent
<tt>init-form</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let*</a> ((a 0)
         (f1 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lam=
bda</a> () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">i=
nc</a> a)))
         (a 0)
         (f2 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lam=
bda</a> () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">i=
nc</a> a))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 [f1] [f1] [f1] [f2] [f2] [f2]))

  --&gt; (1 2 3 1 2 3)
</tt></pre><tt>

</tt>

<p>
The preceding example shows that there are two mutable variables named
<tt>a</tt>
in independent scopes, each respectively captured by the separate closures
<tt>f1</tt>
and
<tt>f2</tt>.
Three calls to
<tt>f1</tt>
increment the first
<tt>a</tt>
while the second
<tt>a</tt>
retains its initial value.
</p><p>
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
the behavior of duplicate variables is unspecified.
</p><p>
Implementation note: the <b>TXR</b> compiler diagnoses and rejects duplicat=
e
symbols in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
whereas the interpreter ignores the situation.
</p><p>
When the names of a special variables is specified in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
remain, a new binding is created for them in the dynamic environment, rathe=
r
than the lexical environment.
In
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
later
<tt><i>init-form</i></tt>-s
are evaluated in a dynamic scope in which previous dynamic variables
are established, and later dynamic variables are not yet established.
A special variable may appear multiple times in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
just like a lexical variable. Each duplicate occurrence extends the
dynamic environment with a new dynamic binding.
All these dynamic environments are removed when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
form terminates. Dynamic environments aren't captured by lexical
closures, but are captured in delimited continuations.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((a 1) (b 2)) (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-0206CE91">list</a> a b)) -&gt; (1 2)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a> (=
(a 1) (b (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> a=
 1))) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> a b (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> a b=
))) -&gt; (1 2 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ()=
) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> (:=
a nil)) -&gt; error, :a and nil can't be used as variables
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-02F30528">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4">9.4</a> Func=
tions</h3>



<p>



<a name=3D"N-00B44934">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.1">9.4.1<=
/a> Operator <tt>defun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defun </tt><tt><i>name</i></tt><tt> (</tt><tt><i>param</i>=
</tt><tt>* [: </tt><tt><i>opt-param</i></tt><tt>*] [. </tt><tt><i>rest-para=
m</i></tt><tt>])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
operator introduces a new function in the global function namespace.
The function is similar to a lambda, and has the same parameter syntax
and semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
operator.
</p><p>
Note that the above syntax synopsis describes only the canonical
parameter syntax which remains after parameter list macros are
expanded. See the section Parameter List Macros.
</p><p>
Unlike in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
the
<tt><i>body-form</i></tt>-s
of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
are surrounded by a block.
The name of this block is the same as the name of the function, making it
possible to terminate the function and return a value using
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-from<=
/a> </tt><tt><i>name</i></tt><tt> </tt><tt><i>value</i></tt><tt>).=20

</tt>

For more information, see the definition of the block operator.
</p><p>
A function may call itself by name, allowing for recursion.
</p><p>
The special symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
may not be used as function names. Neither can keyword symbols.
</p><p>
It is possible to define methods as well as macros with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>,
as an alternative to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
forms.
</p><p>
To define a method, the syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>type</i></tt><tt> </tt><tt><i>name</i></tt><tt>)=20

</tt>

should be used as the argument to the
<tt><i>name</i></tt>
parameter. This gives rise to the syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </tt>=
<tt><i>type</i></tt><tt> </tt><tt><i>name</i></tt><tt>) </tt><tt><i>args</i=
></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

which is equivalent to the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</a> =
</tt><tt><i>type</i></tt><tt> </tt><tt><i>name</i></tt><tt> </tt><tt><i>arg=
s</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

syntax.
</p><p>
Macros can be defined using
<tt>




(macro </tt><tt><i>name</i></tt><tt>)=20

</tt>

as the
<tt><i>name</i></tt>
parameter of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>.
This way of defining a macro doesn't support destructuring;
it defines the expander as an ordinary function with an ordinary
argument list. To work, the function must accept two arguments:
the entire macro call form that is to be expanded, and the
macro environment. Thus, the macro definition syntax is
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> (m=
acro </tt><tt><i>name</i></tt><tt>) </tt><tt><i>form</i></tt><tt> </tt><tt>=
<i>env</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

which is equivalent to the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</a>=
 </tt><tt><i>name</i></tt><tt> (:form </tt><tt><i>form</i></tt><tt> :env </=
tt><tt><i>env</i></tt><tt>) </tt><tt><i>form</i></tt><tt>*)=20

</tt>

syntax.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


In ANSI Common Lisp, keywords may be used as function names.
In TXR Lisp, they may not.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


A function defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
may co-exist with a macro defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>.
This is not permitted in ANSI Common Lisp.
</p><p>

</p></dd></dl>
<a name=3D"N-00FAFD10">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.2">9.4.2</a> =
Operator <tt>lambda</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lambda (</tt><tt><i>param</i></tt><tt>* [: </tt><tt><i>opt=
-param</i></tt><tt>*] [. </tt><tt><i>rest-param</i></tt><tt>])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>)=20




<br>&nbsp;&nbsp;(lambda </tt><tt><i>rest-param</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
operator produces a value which is a function.  Like in most other
Lisps, functions are objects in <b>TXR Lisp</b>.  They can be passed to fun=
ctions as
arguments, returned from functions, aggregated into lists, stored in variab=
les,
<i>et cetera</i>.

</p><p>
Note that the above syntax synopsis describes only the canonical
parameter syntax which remains after parameter list macros are
expanded. See the section Parameter List Macros.
</p><p>
The first argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
is the list of parameters for the function.   It
may be empty, and it may also be an improper list (dot notation) where the
terminating atom is a symbol other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
It can also be a single symbol.
</p><p>
The second and subsequent arguments are the forms making up the function bo=
dy.
The body may be empty.
</p><p>
When a function is called, the parameters are instantiated as variables tha=
t
are visible to the body forms. The variables are initialized from the value=
s of
the argument expressions appearing in the function call.
</p><p>
The dotted notation can be used to write a function that accepts
a variable number of arguments. There are two ways write a function that
accepts only a variable argument list and no required arguments:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">=
lambda</a> (. </tt><tt><i>rest-param</i></tt><tt>) ...)=20




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">=
lambda</a> </tt><tt><i>rest-param</i></tt><tt> ...)=20

</tt>

</p><p>
(These notations are syntactically equivalent because the list notation
<tt>(. X)</tt>
actually denotes the object
<tt>X</tt>
which isn't wrapped in any list).
</p><p>
The keyword symbol
<tt>:</tt>
(colon) can appear in the parameter list. This is
the symbol in the keyword package whose name is the empty string.  This
symbol is treated specially: it serves as a separator between
required parameters and optional parameters.  Furthermore, the
<tt>:</tt>
symbol has a role to play in function calls: it can be specified as an argu=
ment
value to an optional parameter by which the caller indicates that the
optional argument is not being specified. It will be processed exactly
that way.
</p><p>
An optional parameter can also be written in the form
<tt>




(</tt><tt><i>name</i></tt><tt> </tt><tt><i>expr</i></tt><tt> [</tt><tt><i>s=
ym</i></tt><tt>]).=20

</tt>

In this situation, if the call does not specify a value for the parameter
(or specifies a value as the keyword
<tt>:</tt>
(colon)) then the parameter takes on the
value of the expression
<tt><i>expr</i></tt>.
This expression is only evaluated when its value is required.
</p><p>
If
<tt><i>sym</i></tt>
is specified, then
<tt><i>sym</i></tt>
will be
introduced as an additional binding with a Boolean value which indicates
whether or not the optional parameter had been specified by the caller.
</p><p>
Each
<tt>expr</tt>
that is evaluated is evaluated an environment in which
all of the previous parameters are visible, in addition to the surrounding
environment of the lambda. For instance:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((default 0))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a> : (en=
d (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a> str=
)) (counter default))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> str end counter)))
</tt></pre><tt>

</tt>

<p>
In this
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
the initializing expression for the optional parameter
end is
<tt>(length str)</tt>,
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
variable it refers to is the previous
argument. The initializer for the optional variable counter is
the expression default, and it refers to the binding established
by the surrounding let. This reference is captured as part of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>'s
lexical closure.
</p><p>
Keyword symbols, and the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
may not be used as parameter names.
The behavior is unspecified if the same symbol is specified
more than once anywhere in the parameter list, whether as a parameter name =
or as
the indicator
<tt>sym</tt>
in an optional parameter or any combination.
</p><p>
Implementation note: the <b>TXR</b> compiler diagnoses and rejects duplicat=
e
symbols in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
whereas the interpreter ignores the situation.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p></dd><dt>Counting function:</dt><dd>
This function, which takes no arguments, captures the
variable
<tt>counter</tt>.
Whenever this object is called, it increments
<tt>counter</tt>
by
<tt>1</tt>
and returns the incremented value.
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((counter 0))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (=
) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a> co=
unter)))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Function that takes two or more arguments:</dt><dd>
The third and subsequent arguments are aggregated into a list passed as the
single parameter
<tt>z</tt>:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
4F">lambda</a> (x y . z) (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0206CE91">list</a> 'my-arguments-are x y z))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Variadic function:</dt><dd>
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a=
> args (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list<=
/a> 'my-list-of-arguments args))
</pre>

</tt>

<p>
</p></dd><dt>Optional arguments:</dt><dd>
<tt>
<pre>  [(lambda (x : y) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0206CE91">list</a> x y)) 1] -&gt; (1 nil)
  [(lambda (x : y) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020=
6CE91">list</a> x y)) 1 2] -&gt; (1 2)
</pre>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0209307D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.3">9.4.3</a> =
Macros <tt>flet</tt> and <tt>labels</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flet ({(</tt><tt><i>name</i></tt><tt> </tt><tt><i>param-li=
st</i></tt><tt> </tt><tt><i>function-body-form</i></tt><tt>*)}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt></p><p><tt>



<br>&nbsp;&nbsp;(labels ({(</tt><tt><i>name</i></tt><tt> </tt><tt><i>param-=
list</i></tt><tt> </tt><tt><i>function-body-form</i></tt><tt>*)}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
macros bind local, named functions in the lexical scope.
</p><p>
Note that the above syntax synopsis describes only the canonical
parameter syntax which remains after parameter list macros are
expanded. See the section Parameter List Macros.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
is that a function defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
can see itself, and therefore recurse directly by name. Moreover, if multip=
le
functions are defined by the same labels construct, they all have each othe=
r's
names in scope of their bodies.
By contrast, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>-defined
function does not have itself in scope and cannot recurse.
Multiple functions in the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
do not have each other's names in their scopes.
</p><p>
More formally, the
<tt><i>function-body-form</i></tt>-s
and
<tt><i>param-list</i></tt>
of the functions defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
are in a scope in which all of the function
names being defined by that same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
construct are visible.
</p><p>
Under both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>,
the local functions that are defined are
lexically visible to the main
<tt><i>body-form</i></tt>-s.
</p><p>
Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
are properly scoped with regard to macros.
During macro expansion, function bindings introduced by these
macro operators shadow macros defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>.
</p><p>
Furthermore, function bindings introduced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
also shadow symbol macros defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>,
when those symbol macros occur as arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
operator.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>
macros do not establish named blocks around the body forms
of the local functions which they bind. This differs from
ANSI Common Lisp, whose local function have implicit named blocks,
allowing for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
to be used.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; Wastefully slow algorithm for determining evenness.
  ;; Note:
  ;; - mutual recursion between labels-defined functions
  ;; - inner is-even bound by labels shadows the outer
  ;;   one bound by defun so the (is-even n) call goes
  ;;   to the local function.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
is-even (n)
   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
> ((is-even (n)
              (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a> n=
) t (is-odd (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a=
> n 1))))
            (is-odd (n)
              (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a> n=
) nil (is-even (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-=
</a> n 1)))))
     (is-even n)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0386C775">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.4">9.4.4</a> =
Function <tt>call</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call </tt><tt><i>function</i></tt><tt> </tt><tt><i>argumen=
t</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
function invokes
<tt><i>function</i></tt>,
passing it the given arguments, if any.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


Apply arguments
<tt>1 2</tt>
to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
which adds them to produce
<tt>3</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F"=
>lambda</a> (a b) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C=
">+</a> a b)) 1 2)
</tt></pre><tt>

</tt>

<p>
Useless use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
on a named function; equivalent to
<tt>(list 1 2)</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E1=
09C">fun</a> list) 1 2)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-026C3723">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.5">9.4.5</a> =
Functions <tt>apply</tt> and <tt>iapply</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(apply </tt><tt><i>function</i></tt><tt> [</tt><tt><i>arg</=
i></tt><tt>* </tt><tt><i>trailing-args</i></tt><tt>])=20




<br>&nbsp;&nbsp;(iapply </tt><tt><i>function</i></tt><tt> [</tt><tt><i>arg<=
/i></tt><tt>* </tt><tt><i>trailing-args</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>
function invokes
<tt><i>function</i></tt>,
optionally passing to it an argument
list. The return value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>
call is that of
<tt><i>function</i></tt>.
</p><p>
If no arguments are present after
<tt><i>function</i></tt>,
then
<tt><i>function</i></tt>
is invoked without arguments.
</p><p>
If one argument is present after
<tt><i>function</i></tt>,
then it is interpreted as
<tt><i>trailing-args</i></tt>.
If this is a sequence (a list, vector or string),
then the elements of the sequence are passed as individual arguments to
<tt><i>function</i></tt>.
If
<tt><i>trailing-args</i></tt>
is not a sequence, then
<tt><i>function</i></tt>
is invoked
with an improper argument list, terminated by the
<tt><i>trailing-args</i></tt>
atom.
</p><p>
If two or more arguments are present after
<tt><i>function</i></tt>,
then the last of these arguments is interpreted as
<tt><i>trailing-args</i></tt>.
The previous arguments represent leading arguments which are applied to
<tt><i>function</i></tt>,
prior to the arguments taken from
<tt><i>trailing-args</i></tt>.
</p><p>
Note that if
<tt><i>trailing-args</i></tt>
value is an atom or an improper list, the function is then
invoked with an improper argument list. Only a variadic
function may be invoked with an improper argument lists.
Moreover, all of the function's required and optional
parameters must be satisfied by elements of the
improper list, such that the terminating atom either
matches the
<tt><i>rest-param</i></tt>
directly (see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
operator) or else the
<tt><i>rest-param</i></tt>
receives an improper list terminated by that atom.
To treat the terminating atom of an improper list as an
ordinary element which can satisfy a required or optional
function parameter, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>
function may be used, described next.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>
function ("improper apply") is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>,
except with regard to the treatment of
<tt><i>trailing-args</i></tt>.
Firstly, under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>,
if
<tt><i>trailing-args</i></tt>
is an atom other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
(possibly a sequence, such as a vector or string),
then it is treated as an ordinary argument:
<tt><i>function</i></tt>
is invoked with a proper argument list, whose last element is
<tt><i>trailing-args</i></tt>.
Secondly, if
<tt><i>trailing-args</i></tt>
is a list, but an improper list, then the terminating atom of
<tt><i>trailing-args</i></tt>
becomes an individual argument.
This terminating atom is not split into multiple arguments,
even if it is a sequence.
Thus, in all possible cases,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>
treats an extra
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
atom as an argument, and never calls
<tt><i>function</i></tt>
with an improper argument list.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; '(1 2 3) becomes arguments to list, thus (<a href=3D=
"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> 1 2 3).
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> list=
) '(1 2 3)) -&gt; (1 2 3)

  ;; this effectively invokes (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-0206CE91">list</a> 1 2 3 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> list=
) 1 2 '(3 4)) -&gt; (1 2 3 4)

  ;; this effectively invokes (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-0206CE91">list</a> 1 2 . 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> list=
) 1 2 3)) -&gt; (1 2 . 3)

  ;; "abc" is separated into characters
  ;; which become arguments of list
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> list=
) "abc") -&gt; (#\a #\b #\c)
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


Note that some uses of this function that are necessary in other Lisp diale=
cts
are not necessary in <b>TXR Lisp</b>. The reason is that in <b>TXR Lisp</b>=
, improper list
syntax is accepted as a compound form, and performs application:
</p><p>
<tt>
</tt></p><pre><tt>  (foo a b . x)
</tt></pre><tt>

</tt>

<p>
Here, the variables
<tt>a</tt>
and
<tt>b</tt>
supply the first two arguments for
<tt>foo</tt>.
In
the dotted position,
<tt>x</tt>
must evaluate to a list or vector. The list or
vector's elements are pulled out and treated as additional arguments for
<tt>foo</tt>.
This syntax can only be used if
<tt>x</tt>
is a symbolic form or an atom.  It
cannot be a compound form, because
<tt>(foo a b . (x))</tt>
and
<tt>(foo a b x)</tt>
are equivalent structures.
</p><p>

</p></dd></dl>
<a name=3D"N-006E109C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.6">9.4.6</a> =
Operator <tt>fun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fun </tt><tt><i>function-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
operator retrieves the function object corresponding to a named
function in the current lexical environment.
</p><p>
The
<tt><i>function-name</i></tt>
may be a symbol denoting a named function: a built in
function, or one defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>.
</p><p>
The
<tt><i>function-name</i></tt>
may also take any of the forms specified in the description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F222DA">func-get-=
name</a></tt>
function. If such a
<tt><i>function-name</i></tt>
refers to a function which exists, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
operator yields that function.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
operator does not see macro bindings via their symbolic names
with which they are defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>.
However, the name syntax
<tt>




(macro </tt><tt><i>name</i></tt><tt>)=20

</tt>

may be used to refer to macros. This syntax is documented in the
description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F222DA">func-get-=
name</a></tt>.
It is also possible to
retrieve a global macro expander using the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-ma=
cro</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02DC9E04">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.7">9.4.7</a> =
Operator <tt>dwim</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dwim </tt><tt><i>argument</i></tt><tt>*)=20




<br>&nbsp;&nbsp;'['</tt><tt><i>argument</i></tt><tt>*']'=20




<br>&nbsp;&nbsp;(set (dwim </tt><tt><i>obj-place</i></tt><tt> </tt><tt><i>i=
ndex</i></tt><tt> [</tt><tt><i>alt</i></tt><tt>]) </tt><tt><i>new-value</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(set '['</tt><tt><i>obj-place</i></tt><tt> </tt><tt><i>inde=
x</i></tt><tt> [</tt><tt><i>alt</i></tt><tt>]']' </tt><tt><i>new-value</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator's name is an acronym: DWIM may be taken to mean
"Do What I Mean", or alternatively, "Dispatch, in a Way that is
Intelligent and Meaningful".
</p><p>
The notation
<tt>[...]</tt>
is a shorthand which denotes
<tt>(dwim ...)</tt>.
</p><p>
Note that since the
<tt>[</tt>
and
<tt>]</tt>
are used in this document for indicating optional syntax,
in the above Syntax synopsis the quoted notation
<tt>'['</tt>
and
<tt>']'</tt>
denotes bracket tokens which literally appear in the syntax.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator takes a variable number of arguments, which are
treated as expressions to be individually macro-expanded
and evaluated, using the same rules.
</p><p>
This means that the first argument isn't a function name, but an ordinary
expression which can simply compute a function object (or, more generally,
a callable object).
</p><p>
Furthermore, for those arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
which are symbols (after all macro-expansion is performed), the evaluation
rules are altered. For the purposes of resolving symbols to values, the
function and variable binding namespaces are considered to be merged into a
single space, creating a situation that is similar to a Lisp-1 style
dialect.
</p><p>
This special Lisp-1 evaluation is not recursively applied.  All arguments o=
f
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
which, after macro expansion, are not symbols are evaluated using the
normal Lisp-2 evaluation rules. Thus, the DWIM operator must be used
in every expression where the Lisp-1 rules for reducing symbols to
values are desired.
</p><p>
If a symbol has bindings both in the variable and function namespace in sco=
pe,
and is referenced by a dwim argument, this constitutes a conflict which is
resolved according to two rules.  When nested scopes are concerned, then an
inner binding shadows an outer binding, regardless of their kind.  An inner
variable binding for a symbol shadows an outer or global function binding, =
and
<i>vice versa</i>.

</p><p>
If a symbol is bound to both a function and variable in the global namespac=
e,
then the variable binding is favored.
</p><p>
Macros do not participate in the special scope conflation, with one
exception. What this means is that the space of symbol macros is not folded
together with the space of operator macros. An argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
that is a symbol might be
symbol macro, variable or function, but it cannot be interpreted as the nam=
e of
a operator macro.
</p><p>
The exception is this: from the perspective of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form, function bindings can shadow symbol macros. If a
function binding is defined in an inner scope relative to a symbol macro fo=
r
the same symbol,
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</a=
></tt>,
the function hides the symbol macro. In other words, when
macro expansion processes an argument of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form, and that argument is a symbol, it is treated specially
in order to provide a consistent name lookup behavior. If the innermost
binding for that symbol is a function binding, it refers to that
function binding, even if a more outer symbol macro binding exists,
and so the symbol is not expanded using the symbol macro.
By contrast, in an ordinary form, a symbolic argument never resolves
to a function binding. The symbol refers to either a symbol macro or a
variable, whichever is nested closer.
</p><p>
If, after macro expansion, the leftmost argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
is the name of a special operator or macro, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form doesn't denote an invocation of that operator or macro.  A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form is an invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator, and the leftmost argument of that operator, if it is a symbol, is
treated as a binding to be resolved in the variable or function namespace,
like any other argument.
Thus
<tt>[if x y]</tt>
is an invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
function, not the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator.
</p><p>
How many arguments are required by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator depends on the type of
object to which the first argument expression evaluates.  The possibilities
are:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>[<tt><i>function</i></tt><tt> </tt><tt><i>argument</i></tt><tt>*] <=
/tt></tt></dt><dd>



Call the given function object with the given arguments.
<p>



</p></dd><dt><tt>[<tt><i>symbol</i></tt><tt> </tt><tt><i>argument</i></tt><=
tt>*] </tt></tt></dt><dd>



If the first expression evaluates to a symbol, that symbol
is resolved in the function namespace, and then
the resulting function, if found, is called with the
given arguments.
<p>



</p></dd><dt><tt>[<tt><i>sequence</i></tt><tt> </tt><tt><i>index</i></tt><t=
t>] </tt></tt></dt><dd>



Retrieve an element from
<tt><i>sequence</i></tt>,
at the specified
<tt><i>index</i></tt>,
which is a nonnegative integer.
<p>
This form is also a syntactic place.
If a value is stored to this place, it replaces the
element.
</p><p>
The place may also be deleted, which has the effect of removing the element
from the sequence, shifting the elements at higher indices, if any, down on=
e
element position, and shortening the sequence by one.
If the place is deleted, and if
<tt><i>sequence</i></tt>
is a list, then the
<tt><i>sequence</i></tt>
form itself must be a place.
</p><p>



</p></dd><dt><tt>[<tt><i>sequence</i></tt><tt> </tt><tt><i>from-index..to-b=
elow-index</i></tt><tt>] </tt></tt></dt><dd>



Retrieve the specified range of elements.
The range of elements is specified in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
fields of a range object. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217A971">..</a></t=
t>
(dotdot) syntactic sugar denotes it construction via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>
function.  See the section on Range Indexing below.
<p>
This form is also a syntactic place.  Storing a value in this place
has the effect of replacing the subsequence with
a new subsequence. Deleting the place has the
effect of removing the specified subsequence
from
<tt><i>sequence</i></tt>.
If
<tt><i>sequence</i></tt>
is a list, then the
<tt><i>sequence</i></tt>
form must itself be a place.
The
<tt><i>new-value</i></tt>
argument in a range assignment can be a string, vector or list,
regardless of whether the target is a string, vector or list.
If the target is a string, the replacement sequence must be
a string, or a list or vector of characters.
</p><p>



</p></dd><dt><tt>[<tt><i>sequence</i></tt><tt> </tt><tt><i>index-list</i></=
tt><tt>] </tt></tt></dt><dd>



Elements specified
by
<tt><i>index-list</i></tt>,
which may be a list or vector,
are extracted from
<tt><i>sequence</i></tt>
and returned as a sequence
of the same kind as
<tt><i>sequence</i></tt>.
<p>
This form is equivalent to
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a> <=
/tt><tt><i>sequence</i></tt><tt> </tt><tt><i>where-index</i></tt><tt>)=20

</tt>

except when the target of an assignment operation.
</p><p>
This form is a syntactic place if
<tt><i>sequence</i></tt>
is one. If a sequence is assigned to this place,
then elements of the sequence are distributed to the
specified locations.
</p><p>
The following equivalences hold between index-list-based indexing
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
functions, except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
always returns the value assigned, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
returns its first argument:
</p><p>
<tt>
</tt></p><pre><tt>  [seq idx-list] &lt;--&gt; (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#N-031D7F72">select</a> seq idx-list)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> [seq i=
dx-list] new) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-035991E1">replace</a> seq new idx-list)
</tt></pre><tt>

</tt>

<p>
Note that unlike the select function, this does not support
<tt>




[</tt><tt><i>hash</i></tt><tt> </tt><tt><i>index-list</i></tt><tt>]=20

</tt>

because since hash keys may be lists, that syntax is
indistinguishable from a simple hash lookup where
<tt><i>index-list</i></tt>
is the key.
</p><p>



</p></dd><dt><tt>[<tt><i>hash</i></tt><tt> </tt><tt><i>key</i></tt><tt> [</=
tt><tt><i>alt</i></tt><tt>]] </tt></tt></dt><dd>



Retrieve a value from the hash table corresponding to
<tt><i>key</i></tt>,
or else return
<tt><i>alt</i></tt>
if there is no such entry. The expression
<tt><i>alt</i></tt>
is always evaluated, whether or not its value is used.
<p>



</p></dd><dt><tt>[<tt><i>regex</i></tt><tt> [</tt><tt><i>start</i></tt><tt>=
 [</tt><tt><i>from-end</i></tt><tt>]] </tt><tt><i>string</i></tt><tt> ] </t=
t></tt></dt><dd>



Determine whether regular expression
<tt><i>regex</i></tt>
matches
<tt><i>string</i></tt>,
and in that case return the
(possibly empty) leftmost matching substring.
Otherwise, return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
If
<tt><i>start</i></tt>
is specified, it gives the starting position where
the search begins, and if
<tt><i>from-end</i></tt>
is given, and has a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it specifies a search from right to left. These optional
arguments have the same conventions and semantics as
their equivalents in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gst</a></tt>
function.
</p><p>
Note that
<tt><i>string</i></tt>
is always required, and is always the rightmost argument.
</p><p>



</p></dd><dt><tt>[<tt><i>struct</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*]=
 </tt></tt></dt><dd>



The structure instance
<tt><i>struct</i></tt>
is inquired whether it supports a method named by the symbol
<tt><i>lambda</i></tt>.
If so, that method is invoked on the object. The method
receives
<tt><i>struct</i></tt>
followed by the value of every
<tt><i>arg</i></tt>.
If this form is used as a place, then the object must
support a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method.



</dd><dt><tt>[<tt><i>carray</i></tt><tt> </tt><tt><i>index</i></tt><tt>] </=
tt></tt></dt><dd>






</dd><dt><tt>[<tt><i>carray</i></tt><tt> </tt><tt><i>from-index..to-below-i=
ndex</i></tt><tt>] </tt></tt></dt><dd>



Element and range indexing is possible on object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
which manipulate arrays in a foreign ("C language") representation,
and are closely associated with the Foreign Function Interface (FFI).
Just like in the case of sequences, the semantics of referencing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
objects with the bracket notation is based on the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>.
These, in turn, rely on the specialized functions.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001F5BCA">carray-re=
f</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000127F9">carray-re=
fset</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF5BC5">carray-su=
b</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AAF602">carray-re=
place</a></tt>.



</dd><dt><tt>[<tt><i>buf</i></tt><tt> </tt><tt><i>index</i></tt><tt>] </tt>=
</tt></dt><dd>



Indexing is supported for objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>.
This provides a way to access and store the individual bytes
of a buffer.
</dd></dl>
</dl>
</dd></dl>
<p>

</p><p>
</p><dl>
<dt>Range Indexing:</dt><dd>
<p>


Vector and list range indexing is based from zero, meaning
that the first element is numbered zero, the second one
and so on.
zero. Negative values are allowed; the value
<tt>-1</tt>
refers to the last element of the vector or
list, and
<tt>-2</tt>
to the second last and so forth. Thus the range
<tt>1 .. -2</tt>
means
"everything except for the first element and the last two".
</p><p>
The symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
represents the position one past the end of the vector, string or
list, so
<tt>0 .. t</tt>
denotes the entire list or vector, and the range
<tt>t .. t</tt>
represents the empty range just beyond the last element.
It is possible to assign to
<tt>t .. t</tt>.
For instance:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
9DD0E7">defvar</a> list '(1 2 3))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> [<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> t .. t] '=
(4)) ;; list is now (1 2 3 4)
</tt></pre><tt>

</tt>

<p>
The value zero has a "floating" behavior when used as the end of a range.
If the start of the range is a negative value, and the end of the
range is zero, the zero is interpreted as being the position past the
end of the sequence, rather than the first element. For instance the range
<tt>-1..0</tt>
means the same thing as
<tt>-1..t</tt>.
Zero at the start of a range
always means the first element, so that
<tt>0..-1</tt>
refers to all the elements except for the last one.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


The dwim operator allows for a Lisp-1 flavor of programming in <b>TXR Lisp<=
/b>,
which is principally a Lisp-2 dialect.
</p><p>
A Lisp-1 dialect is one in which an expression like
<tt>(a b)</tt>
treats both a and b
as expressions subject to the same evaluation rules=E2=80=94at least, when
<tt>a</tt>
isn't an operator or an operator macro. This means that the symbols
<tt>a</tt>
and
<tt>b</tt>
are resolved to values in the same namespace. The form denotes a function c=
all
if the value of variable
<tt>a</tt>
is a function object.  Thus in a Lisp-1, named functions do not exist as
such: they are just variable bindings.  In a Lisp-1, the form
<tt>(car 1)</tt>
means that there
is a variable called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
which holds a function, which is retrieved from that
variable and the argument
<tt>1</tt>
is applied to it. In the expression
<tt>(car car)</tt>,
both occurrences of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
refer to the variable, and so this form applies the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function to itself. It is almost certainly meaningless.
In a Lisp-2
<tt>(car 1)</tt>
means that there is a function called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
in the function namespace. In the expression
<tt>(car car)</tt>
the two occurrences refer to different bindings:
one is a function and the other a variable.
Thus there can exist a variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
which holds a cons cell object, rather than the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function, and the form makes sense.
</p><p>
The Lisp-1 approach is useful for functional programming, because it elimin=
ates
cluttering occurrences of the call and fun operators.  For instance:
</p><p>
<tt>
</tt></p><pre><tt>  ;; regular notation

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> f=
oo (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> s=
econd) '((1 a) (2 b)))

  ;; [] notation

  [foo second '((1 a) (2 b))]
</tt></pre><tt>

</tt>

<p>
Lisp-1 dialects can also provide useful extensions by giving a meaning
to objects other than functions in the first position of a form,
and the
<tt>dwim/[...]</tt>
syntax does exactly this.
</p><p>
<b>TXR Lisp</b> is a Lisp-2 because Lisp-2 also has advantages. Lisp-2 prog=
rams
which use macros naturally achieve hygiene because lexical variables do
not interfere with the function namespace. If a Lisp-2 program has
a local variable called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>,
this does not interfere with the hidden use of the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
in a macro expansion in the same block of code. Lisp-1 dialects have to
provide hygienic macro systems to attack this problem. Furthermore, even wh=
en
not using macros, Lisp-1 programmers have to avoid using the names of funct=
ions
as lexical variable names, if the enclosing code might use them.
</p><p>
The two namespaces of a Lisp-2 also naturally accommodate symbol macros and
operator macros.  Whereas functions and variables can be represented in a
single namespace readily, because functions are data objects, this is not s=
o
with symbol macros and operator macros, the latter of which are distinguish=
ed
syntactically by their position in a form. In a Lisp-1 dialect, given
<tt>(foo bar)</tt>,
either of the two symbols could be a symbol macro, but only
<tt>foo</tt>
can possibly be an operator macro. Yet, having only a single namespace, a
Lisp-1 doesn't permit
<tt>(foo foo)</tt>,
where
<tt>foo</tt>
is simultaneously a symbol macro and an operator macro, though the situatio=
n is
unambiguous by syntax even in Lisp-1.  In other words, Lisp-1 dialects do n=
ot
entirely remove the special syntactic recognition given to the leftmost
position of a compound form, yet at the same time they prohibit
the user from taking full advantage of it by providing only one namespace.
</p><p>
<b>TXR Lisp</b> provides
the "best of both worlds": the DWIM brackets notation provides a model of
Lisp-1 computation that is purer than Lisp-1 dialects (since the leftmost
argument is not given any special syntactic treatment at all)
while the Lisp-2 foundation provides a traditional Lisp environment with it=
s
"natural hygiene".
</p><p>

</p></dd></dl>
<a name=3D"N-00F6F5F8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.8">9.4.8</a> =
Function <tt>functionp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(functionp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6F5F8">functionp=
</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a function, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-003E7671">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.4.9">9.4.9</a> =
Function <tt>copy-fun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-fun </tt><tt><i>function</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003E7671">copy-fun<=
/a></tt>
function produces and returns a duplicate of
<tt><i>function</i></tt>,
which must be a function.
</p><p>
A duplicate of a function is a distinct function object not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
to the original function, yet which accepts the same arguments
and behaves exactly the same way as the original.
</p><p>
If a function contains no captured environment, then a copy made of that
function by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003E7671">copy-fun<=
/a></tt>
is indistinguishable from the original function in every regard,
except for being a distinct object that compares unequal to the original
under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
function.
</p><p>
If a function contains a captured environment, then a copy of that function
made by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003E7671">copy-fun<=
/a></tt>
has its own copy of that environment. If the copied function changes the
values of captured lexical variables, the original function is not affected=
 by
these changes and
<i>vice versa</i>.

</p><p>
The entire lexical environment is copied; the copy and original function do=
 not
share any portion of the environment at any level of nesting.
</p><p>
</p></dd></dl>
<a name=3D"N-014DC8B2">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5">9.5</a> Sequ=
encing, Selection and Iteration</h3>



<p>



<a name=3D"N-03F7A8B8">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.1">9.5.1<=
/a> Operators/functions <tt>progn</tt> and <tt>prog1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(progn </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(prog1 </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
operator evaluates each
<tt><i>form</i></tt>
in in left-to-right order, and returns the value
of the last form. The value of the form
<tt>(progn)</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">prog1</a>=
</tt>
operator evaluates each
<tt><i>form</i></tt>
in left-to-right order, and returns the value
of the first form. The value of the form
<tt>(prog1)</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Various other operators such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
also arrange for the evaluation
of a body of forms, the value of the last of which is returned.
These operators are said to feature an implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>.
</p><p>
These special operators are also functions. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
function accepts zero or more arguments. It returns its last argument, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if called with no arguments. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">prog1</a>=
</tt>
function likewise accepts zero or more arguments. It returns its first argu=
ment, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if called with no arguments.
</p><p>
</p></dd><dt>Dialect Notes:</dt><dd>
<p>


In ANSI Common Lisp,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">prog1</a>=
</tt>
requires at least one argument. Neither
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A4BA9">prog</a><=
/tt>
nor
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">prog1</a>=
</tt>
exist as functions.
</p><p>

</p></dd></dl>
<a name=3D"N-03A0E48C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.2">9.5.2</a> =
Macro/function <tt>prog2</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(prog2 </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0E48C">prog2</a>=
</tt>
evaluates each
<tt><i>form</i></tt>
in left-to-right order. The value is that of the second form, if present,
otherwise it is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The form
<tt>(prog2 1 2 3)</tt>
yields
<tt>2</tt>.
The value of
<tt>(prog2 1 2)</tt>
is also
<tt>2</tt>;
<tt>(prog2 1)</tt>
and
<tt>(prog2)</tt>
yield
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0E48C">prog2</a>=
</tt>
symbol also has a function binding. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0E48C">prog2</a>=
</tt>
function accepts any number of arguments. If invoked with at least two argu=
ments,
it returns the second one. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Dialect Notes:</dt><dd>
<p>


In ANSI Common Lisp,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0E48C">prog2</a>=
</tt>
requires at least two arguments.
It does not exist as a function.
</p><p>

</p></dd></dl>
<a name=3D"N-016C9E24">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.3">9.5.3</a> =
Operator <tt>cond</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cond {(</tt><tt><i>test</i></tt><tt> </tt><tt><i>form</i><=
/tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</a><=
/tt>
operator provides a multi-branching conditional evaluation of
forms. Enclosed in the cond form are groups of forms expressed as lists.
Each group must be a list of at least one form.
</p><p>
The forms are processed from left to right as follows: the first form,
<tt><i>test</i></tt>,
in each group is evaluated. If it evaluates true, then the remaining
forms in that group, if any, are also evaluated. Processing then terminates=
 and
the result of the last form in the group is taken as the result of cond.
If
<tt><i>test</i></tt>
is the only form in the group, then result of
<tt><i>test</i></tt>
is taken
as the result of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</a><=
/tt>.
</p><p>
If the first form of a group yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then processing continues with the
next group, if any. If all form groups yield
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the cond form yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This holds in the case that the syntax is empty:
<tt>(cond)</tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-017EB9A1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.4">9.5.4</a> =
Macros <tt>caseq</tt>, <tt>caseql</tt> and <tt>casequal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(caseq </tt><tt><i>test-form</i></tt><tt> </tt><tt><i>norma=
l-clause</i></tt><tt>* [</tt><tt><i>else-clause</i></tt><tt>])=20




<br>&nbsp;&nbsp;(caseql </tt><tt><i>test-form</i></tt><tt> </tt><tt><i>norm=
al-clause</i></tt><tt>* [</tt><tt><i>else-clause</i></tt><tt>])=20




<br>&nbsp;&nbsp;(casequal </tt><tt><i>test-form</i></tt><tt> </tt><tt><i>no=
rmal-clause</i></tt><tt>* [</tt><tt><i>else-clause</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These three macros arrange for the evaluation of
<tt><i>test-form</i></tt>,
whose value is then compared against the key or keys in each
<tt><i>normal-clause</i></tt>
in turn.
When the value matches a key, then the remaining forms of
<tt><i>normal-clause</i></tt>
are evaluated, and the value of the last form is returned; subsequent
clauses are not evaluated. When the value doesn't match any of the keys
of a
<tt><i>normal-clause</i></tt>
then the next
<tt><i>normal-clause</i></tt>
is tested.
If all these clauses are exhausted, and there is no
<tt><i>else-clause</i></tt>,
then the value nil is returned. Otherwise, the forms in the
<tt><i>else-clause</i></tt>
are evaluated, and the value of the last one is returned.
If there are no forms, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The syntax of a
<tt><i>normal-clause</i></tt>
takes on these two forms:
</p><p>
<tt>




<br>&nbsp;&nbsp;(</tt><tt><i>key</i></tt><tt> </tt><tt><i>form</i></tt><tt>=
*)=20

</tt>

</p><p>
where
<tt><i>key</i></tt>
may be an atom which denotes a single key, or else a list
of keys.  There is a restriction that the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
may not be used
as
<tt><i>key</i></tt>.
The form
<tt>(t)</tt>
may be used as a key to match that symbol.
</p><p>
The syntax of an
<tt><i>else-clause</i></tt>
is:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134=
D8">t</a> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

</p><p>
which resembles a form that is often used as the final clause
in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</a><=
/tt>
syntax.
</p><p>
The three forms of the case construct differ from what type of
test they apply between the value of
<tt><i>test-form</i></tt>
and the keys.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseq</a>=
</tt>
macro generates code which uses the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
function's
equality. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseql</a=
></tt>
macro uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">casequal<=
/a></tt>
uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
</p></dd><dt>Example</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((command-symbol (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-017EB9A1">casequal</a> command-string
                          (("q" "quit") 'quit)
                          (("a" "add") 'add)
                          (("d" "del" "delete") 'delete)
                          (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-015134D8">t</a> 'unknown))))
    ...)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02FB71A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.5">9.5.5</a> =
Macros <tt>caseq*</tt>, <tt>caseql*</tt> and <tt>casequal*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(caseq* </tt><tt><i>test-form</i></tt><tt> </tt><tt><i>norm=
al-clause</i></tt><tt>* [</tt><tt><i>else-clause</i></tt><tt>])=20




<br>&nbsp;&nbsp;(caseql* </tt><tt><i>test-form</i></tt><tt> </tt><tt><i>nor=
mal-clause</i></tt><tt>* [</tt><tt><i>else-clause</i></tt><tt>])=20




<br>&nbsp;&nbsp;(casequal* </tt><tt><i>test-form</i></tt><tt> </tt><tt><i>n=
ormal-clause</i></tt><tt>* [</tt><tt><i>else-clause</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseq*</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseql*</=
a></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">casequal*=
</a></tt>
macros are similar to the macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseq</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseql</a=
></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">casequal<=
/a></tt>,
differing from them in only the following regard. The
<tt><i>normal-clause</i></tt>,
of these macros has the form
<tt>




(</tt><tt><i>evaluated-key</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

where
<tt>evaluated-key</tt>
is either an atom, which is evaluated to produce a key, or else
else a compound form, whose elements are evaluated as forms, producing
multiple keys.  This evaluation takes place at macro-expansion time,
in the global environment.
</p><p>
The
<tt><i>else-clause</i></tt>
works the same way under these macros as under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseq</a>=
</tt>
<i>et al</i>.

</p><p>
Note that although in a
<tt><i>normal-clause</i></tt>,
<tt><i>evaluated-key</i></tt>
must not be the atom
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
there is no restriction against it being
an atom which evaluates to
<tt>t.</tt>
In this situation, the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
has no special meaning.
</p><p>
The
<tt><i>evaluated-key</i></tt>
expressions are evaluated in the order in which they appear in
the construct, at the time the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseq*</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseql*</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">casequal*=
</a></tt>
macro is expanded.
</p><p>
Note: these macros allow the use of variables and global symbol
macros as case keys.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F36A75">defvarl</a> red 0)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> green 1)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> blue 2)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
color blue))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseql*<=
/a> color
      (red "hot")
      ((green blue) "cool")))
  --&gt; "cool"
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03B4E3A4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.6">9.5.6</a> =
Operator/function <tt>if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(if </tt><tt><i>cond</i></tt><tt> </tt><tt><i>t-form</i></t=
t><tt> [</tt><tt><i>e-form</i></tt><tt>])=20




<br>&nbsp;&nbsp;'['if </tt><tt><i>cond</i></tt><tt> </tt><tt><i>then</i></t=
t><tt> [</tt><tt><i>else</i></tt><tt>]']'=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



There exist both an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator and an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
function. A list form with the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
in the fist position is interpreted as an invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator.
The function can be accessed using the DWIM bracket notation and in other
ways.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator provides a simple two-way-selective evaluation control.
The
<tt><i>cond</i></tt>
form is evaluated. If it yields true then
<tt><i>t-form</i></tt>
is evaluated, and that form's return value becomes the return value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>.
If
<tt><i>cond</i></tt>
yields false, then
<tt><i>e-form</i></tt>
is evaluated and its return value is taken to be that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>.
If
<tt><i>e-form</i></tt>
is omitted, then the behavior is as if
<tt><i>e-form</i></tt>
were specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
function provides no evaluation control. All of arguments
are evaluated from left to right. If the
<tt><i>cond</i></tt>
argument is true, then it
returns the
<tt><i>then</i></tt>
argument, otherwise it returns the value of the
<tt><i>else</i></tt>
argument if present, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02D7EEB3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.7">9.5.7</a> =
Operator/function <tt>and</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(and </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;'['and </tt><tt><i>arg</i></tt><tt>*']'=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



There exist both an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
operator and an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
function. A list form with the
symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
in the fist position is interpreted as an invocation of the
operator.  The function can be accessed using the DWIM bracket notation and=
 in
other ways.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
operator provides three functionalities in one.  It computes the
logical "and" function over several forms.  It controls evaluation (a.k.a.
"short-circuiting").  It also provides an idiom for the convenient substitu=
tion
of a value in place of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
when some other values are all true.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
operator evaluates as follows. First, a return value is
established and initialized to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
The
<tt><i>form</i></tt>-s,
if any, are
evaluated from left to right.  The return value is overwritten with
the result of each form. Evaluation stops when all forms are exhausted,
or when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is stored in the return value.
When evaluation stops, the operator yields the return value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
function provides no evaluation control; it receives all of its
arguments fully evaluated. If it is given no arguments, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
If it is given one or more arguments, and any of them are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise it returns the value of the last argument.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
49">and</a>) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a> (&gt; =
10 5) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BB392B">string=
p</a> "foo")) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a> 1 2 3)=
 -&gt; 3  ;; shorthand for (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-0039">if</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049=
">and</a> 1 2) 3).
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02F4E3A4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.8">9.5.8</a> =
Operator/function <tt>or</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(or </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;'['or </tt><tt><i>arg</i></tt><tt>*']'=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



There exist both an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operator and an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
function. A list form with the
symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
in the fist position is interpreted as an invocation of the
operator.  The function can be accessed using the DWIM bracket notation and=
 in
other ways.
</p><p>
The or operator provides three functionalities in one.  It computes the
logical "or" function over several forms.  It controls evaluation (a.k.a.
"short-circuiting").  The behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
also provides an idiom for the selection of the first non-nil value from a
sequence of forms.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operator evaluates as follows.  First, a return value is
established and initialized to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt><i>form</i></tt>-s,
if any,
are evaluated from left to right. The return value is overwritten
with the result of each
<tt><i>form</i></tt>.
Evaluation stops when all forms are
exhausted, or when a true value is stored into the return value.
When evaluation stops, the operator yields the return value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
function provides no evaluation control; it receives all of its
arguments fully evaluated. If it is given no arguments, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If all of its arguments are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it also returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise, it
returns the value of the first argument which isn't
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
34">or</a>) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> 1 2) -&=
gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> nil 2) =
-&gt; 2
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> (&gt; 1=
0 20) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BB392B">string=
p</a> "foo")) -&gt; t
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-017EFAB6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.9">9.5.9</a> =
Macros <tt>when</tt> and <tt>unless</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(when </tt><tt><i>expression</i></tt><tt> </tt><tt><i>form<=
/i></tt><tt>*)=20




<br>&nbsp;&nbsp;(unless </tt><tt><i>expression</i></tt><tt> </tt><tt><i>for=
m</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The when macro operator evaluates
<tt><i>expression</i></tt>.
If
<tt><i>expression</i></tt>
yields
true, and there are additional forms, then each
<tt><i>form</i></tt>
is evaluated.
The value of the last form is becomes the result value of the when form.
If there are no forms, then the result is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">unless</a=
></tt>
operator is similar to when, except that it reverses the
logic of the test. The forms, if any, are evaluated if, and only if
<tt><i>expression</i></tt>
is false.
</p><p>

</p></dd></dl>
<a name=3D"N-01026F48">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.10">9.5.10</a=
> Macros <tt>while</tt> and <tt>until</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(while </tt><tt><i>expression</i></tt><tt> </tt><tt><i>form=
</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(until </tt><tt><i>expression</i></tt><tt> </tt><tt><i>form=
</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a>=
</tt>
macro operator provides a looping construct.  It evaluates
<tt><i>expression</i></tt>.
If
<tt><i>expression</i></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the evaluation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a>=
</tt>
form
terminates, producing the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise, if there are additional forms,
then each
<tt><i>form</i></tt>
is evaluated.  Next, evaluation returns to
<tt><i>expression</i></tt>,
repeating all of the previous steps.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>
macro operator is similar to while, except that the until form
terminates when
<tt><i>expression</i></tt>
evaluates true, rather than false.
</p><p>
These operators arrange for the evaluation of all their enclosed forms
in an anonymous block. Any of the
<tt><i>form</i></tt>-s,
or
<tt><i>expression</i></tt>,
may use
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator to terminate the loop, and optionally to specify
a result value for the form.
</p><p>
The only way these forms can yield a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator is used to terminate the implicit anonymous block,
and is given an argument, which becomes the result value.
</p><p>

</p></dd></dl>
<a name=3D"N-01F7BF0B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.11">9.5.11</a=
> Macros <tt>while*</tt> and <tt>until*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(while* </tt><tt><i>expression</i></tt><tt> </tt><tt><i>for=
m</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(until* </tt><tt><i>expression</i></tt><tt> </tt><tt><i>for=
m</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F7BF0B">while*</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F7BF0B">until*</a=
></tt>
macros are similar, respectively, to the macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>.
</p><p>
They differ in one respect: they begin by evaluating the
<tt><i>form</i></tt>-s
one time unconditionally, without first evaluating
<tt><i>expression</i></tt>.
After this evaluation, the subsequent behavior is
like that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a>=
</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0046">until</a></tt=
>.
</p><p>
Another way to regard the behavior is that that these forms execute
one iteration unconditionally, without evaluating the termination test prio=
r to
the first iteration. Yet another view is that these constructs relocate the
test from the "top of the loop" to the "bottom of the loop".
</p><p>

</p></dd></dl>
<a name=3D"N-0154DC75">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.12">9.5.12</a=
> Macro <tt>whilet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(whilet ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</=
i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)}+)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</a=
></tt>
macro provides a construct which combines iteration with variable
binding.
</p><p>
The evaluation of the form takes place as follows. First, fresh bindings ar=
e
established for
<tt><i>sym</i></tt>-s
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
operator.
It is an error for the list of variable bindings to be empty.
</p><p>
After the establishment of the bindings, the the value of the
<tt><i>sym</i></tt>
is tested. If the value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</a=
></tt>
terminates. Otherwise,
<tt><i>body-form</i></tt>-s
are evaluated in the scope of the variable bindings, and then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</a=
></tt>
iterates from the beginning, again establishing fresh bindings for the
<tt><i>sym</i></tt>-s,
and testing the value of the last
<tt><i>sym</i></tt>.
</p><p>
All evaluation takes place in an anonymous block, which can be
terminated with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator. Doing so terminates the loop.
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</a=
></tt>
loop is thus terminated by an explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>,
a return value can be specified. Under normal termination, the return value=
 is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
In the syntax, a small convenience is permitted. Instead of the last
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

it is permissible for the syntax
<tt>




(</tt><tt><i>init-form</i></tt><tt>)=20

</tt>

to appear, the
<tt><i>sym</i></tt>
being omitted. A machine-generated variable is substituted
in place of the missing
<tt><i>sym</i></tt>
and that variable is then initialized from
<tt><i>init-form</i></tt>
and used as the basis of the test.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; read lines of text from *stdin* and print them,
  ;; until the end-of-stream condition:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</a>=
 ((line (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line=
</a>)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line=
</a> line))

  ;; read lines of text from *stdin* and print them,
  ;; until the end-of-stream condition occurs or
  ;; a line is identical to the character string "end".

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</a>=
 ((line (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line=
</a>))
           (more (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049"=
>and</a> line (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942=
">nequal</a> line "end"))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line=
</a> line))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02DA21F6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.13">9.5.13</a=
> Macros <tt>iflet</tt> and <tt>whenlet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iflet {({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</=
i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)}+) | </tt><tt><i>atom-form<=
/i></tt><tt>}=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>then-form</i></tt><tt> [</tt><tt><=
i>else-form</i></tt><tt>])=20




<br>&nbsp;&nbsp;(whenlet {({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym=
</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)}+) | </tt><tt><i>atom-for=
m</i></tt><tt>}=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">whenlet</=
a></tt>
macros combine the variable binding of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
with conditional evaluation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</a><=
/tt>,
respectively.
</p><p>
In either construct's syntax, a non-compound form
<tt><i>atom-form</i></tt>
may appear in place of the variable binding list. In this case,
<tt><i>atom-form</i></tt>
is evaluated as a form, and the construct is equivalent to
its respective ordinary
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</a><=
/tt>
counterpart.
</p><p>
If the list of variable bindings is empty, it is interpreted as the atom
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and treated as an
<tt>atom-form</tt>.
</p><p>
If one or more bindings are specified rather than
<tt><i>atom-form</i></tt>,
then the evaluation of these forms takes
place as follows. First, fresh bindings are established for
<tt><i>sym</i></tt>-s
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
operator.
</p><p>
Then, the last variable's value is tested. If it is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then the test is true, otherwise false.
</p><p>
In the syntax, a small convenience is permitted. Instead of the last
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

it is permissible for the syntax
<tt>




(</tt><tt><i>init-form</i></tt><tt>)=20

</tt>

to appear, the
<tt><i>sym</i></tt>
being omitted. A machine-generated variable is substituted
in place of the missing
<tt><i>sym</i></tt>
and that variable is then initialized from
<tt><i>init-form</i></tt>
and used as the basis of the test. This is intended to be useful
in situations in which
<tt><i>then-form</i></tt>
or
<tt><i>else-form</i></tt>
do not require access to the tested value.
</p><p>
In the case of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a>=
</tt>
operator, if the test is true, the operator evaluates
<tt><i>then-form</i></tt>
and yields its value. Otherwise the test is false, and if the
optional
<tt><i>else-form</i></tt>
is present, that is evaluated instead and its value is returned.
If this form is missing, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
In the case of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">whenlet</=
a></tt>
operator, if the test is true, then the
<tt><i>body-form</i></tt>-s,
if any, are evaluated. The value of the last one is
returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the forms are missing.
If the test is false, then evaluation of
<tt><i>body-form</i></tt>-s
is skipped, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; dispose of foo-resource if present
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">whenlet</a=
> ((foo-res (get-foo-resource obj)))
    (foo-shutdown foo-res)
    (set-foo-resource obj nil))

  ;; Contrast with: above, using when and let
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
foo-res (get-foo-resource obj)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</a>=
 foo-res
      (foo-shutdown foo-res)
      (set-foo-resource obj nil)))

  ;; print frobosity value if it exceeds 150
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">whenlet</a=
> ((fv (get-frobosity-value))
            (exceeds-p (&gt; fv 150)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "frobosity value ~a exceeds 150\n" fv))

  ;; same as above, taking advantage of the
  ;; last variable being optional:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">whenlet</a=
> ((fv (get-frobosity-value))
            ((&gt; fv 150)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "frobosity value ~a exceeds 150\n" fv))

  ;; yield 4: 3 interpreted as atom-form
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">whenlet</a=
> 3 4)

  ;; yield 4: nil interpreted as atom-form
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a> =
() 3 4)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03272DC8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.14">9.5.14</a=
> Macro <tt>condlet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(condlet=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; ([({ sym | (</tt><tt><i>sym</i></tt><tt> </tt>=
<tt><i>init-form</i></tt><tt>)}+) | </tt><tt><i>atom-form</i></tt><tt>]=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)*)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet</=
a></tt>
macro generalizes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a>=
</tt>.
</p><p>
Each argument is a compound consisting of at least one item: a list of
bindings or
<tt><i>atom-form</i></tt>.
This item is followed by zero or more
<tt><i>body-form</i></tt>-s.
</p><p>
If the are are no
<tt><i>body-form</i></tt>-s
then the situation is treated as if there were a single
<tt><i>body-form</i></tt>
specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet</=
a></tt>
are considered in sequence, starting with the
leftmost.
</p><p>
If the argument's left item is an
<tt><i>atom-form</i></tt>
then the form is evaluated. If it yields true, then the
<tt><i>body-form</i></tt>-s
next to it are evaluated in order, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet</=
a></tt>
form terminates, yielding the value obtained from the last
<tt><i>body-form</i></tt>.
If
<tt><i>atom-form</i></tt>
yields false, then the next argument is considered, if there is one.
</p><p>
If the argument's left item is a list of bindings, then it is processed
with exactly the same logic as under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a>=
</tt>
macro. If the last binding contains a true value, then the
adjoining
<tt><i>body-form</i></tt>-s
are evaluated in a scope in which all of the bindings are visible, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet</=
a></tt>
terminates, yielding the value of the last
<tt><i>body-form</i></tt>.
Otherwise, the next argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet</=
a></tt>
is considered (processed in a scope in which the bindings produced
by the current item are no longer visible).
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet</=
a></tt>
runs out of arguments, it terminates and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((l '(1 2 3)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03272DC8">condlet<=
/a>
       ;; first arg
       (((a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">=
first</a> l)   ;; a binding gets 1
         (b (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">=
second</a> l)) ;; b binding gets 2
         (g (&gt; a b))))  ;; last variable g is nil
        'foo)           ;; not evaluated
       ;; second arg
       (((b (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">=
second</a> l)  ;; b gets 2
         (c (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">=
third</a> l))  ;; c gets 3
         (g (&gt; b c))))  ;; last variable g is true
        'bar)))         ;; condlet terminates
   --&gt; bar              ;; result is bar
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-018F39B0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.15">9.5.15</a=
> Macro <tt>ifa</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ifa </tt><tt><i>cond</i></tt><tt> </tt><tt><i>then</i></tt=
><tt> [</tt><tt><i>else</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
macro provides a anaphoric conditional operator resembling the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator. Around the evaluation of the
<tt><i>then</i></tt>
and
<tt><i>else</i></tt>
forms, the symbol
<tt>it</tt>
is implicitly bound to a subexpression of
<tt><i>cond</i></tt>,
a subexpression which is thereby identified as the
<i>it-form</i>.

This
<tt>it</tt>
alias provides a convenient reference to that place or value, similar to th=
e
word "it" in the English language, and similar anaphoric pronouns in other
languages.
</p><p>
If
<tt>it</tt>
is bound to a place form, the binding is established
as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
operator: the form is evaluated only once, even if the
<tt>it</tt>
alias is used multiple times in the
<tt><i>then</i></tt>
or
<tt><i>else</i></tt>
expressions.  Otherwise, if the form is not a syntactic place
<tt>it</tt>
is bound as an ordinary lexical variable to
the form's value.
</p><p>
An
<i>it-candidate</i>

is an an expression viable for having its value or storage location
bound to the
<tt>it</tt>
symbol. An it-candidate is any expression which is not a constant expressio=
n
according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A">constantp=
</a></tt>
function, and not a symbol.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
macro imposes applies several rules to the
<tt><i>cond</i></tt>
expression:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
The
<tt><i>cond</i></tt>
expression must be either an atom, a function call form,
or a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form.  Otherwise the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
expression is ill-formed, and throws an exception at
macro-expansion time. For the purposes of these rules,
a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form is considered as a function call expression, whose first
argument is the second element of the form. That is to say,
<tt>[f x]</tt>
which is equivalent to
<tt>(dwim f x)</tt>
is treated similarly to
<tt>(f x)</tt>
as a one-argument call.
<p>
</p></dd><dt>2.</dt><dd>
If the
<tt><i>cond</i></tt>
expression is a function call with two or more arguments,
at most one of them may be an it-candidate.
If two or more arguments are it-candidates, the situation
is ambiguous. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
expression is ill-formed and throws an exception at macro-expansion
time.
</dd><dt>3.</dt><dd>
If
<tt><i>cond</i></tt>
is an atom, or a function call expression with no arguments,
then the
<tt>it</tt>
symbol is not bound. Effectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
macro behaves like the ordinary
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator.
</dd><dt>4.</dt><dd>
If
<tt><i>cond</i></tt>
is a function call or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
expression with exactly one argument, then the
<tt>it</tt>
variable is bound to the argument expression, except when
the function being called is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>,
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a>=
</tt>.
This binding occurs regardless of whether the expression is
an it-candidate.
</dd><dt>5.</dt><dd>
If
<tt><i>cond</i></tt>
is a function call with exactly one argument to the Boolean negation
function which goes by one of the three names
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>,
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a>=
</tt>,
then that situation is handled by a rewrite according to the following patt=
ern:
<p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39=
B0">ifa</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not<=
/a> </tt><tt><i>expr</i></tt><tt>) </tt><tt><i>then</i></tt><tt> </tt><tt><=
i>else</i></tt><tt>) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-018F39B0">ifa</a> </tt><tt><i>expr</i></tt><tt> </tt><tt><i>else</i></=
tt><tt> </tt><tt><i>then</i></tt><tt>)=20

</tt>

</p><p>
which applies likewise for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a>=
</tt>
substituted for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>.
The Boolean inverse function is removed, and the <tt><i>then</i></tt>
and
<tt><i>else</i></tt>
expressions are exchanged.
</p></dd><dt>6.</dt><dd>
If
<tt><i>cond</i></tt>
is a function call with two or more arguments, then it is only
well-formed if at most one of those arguments is an it-candidate.
If there is one such argument, then the
<tt>it</tt>
variable is bound to it.
</dd><dt>7.</dt><dd>
Otherwise the variable is bound
to the leftmost argument expression, regardless of whether that
argument expression is an it-candidate.
</dd></dl>
</dl>
<p>

In all other regards, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
macro behaves similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>.
</p><p>
The
<tt><i>cond</i></tt>
expression is evaluated, and, if applicable,
the value of, or storage location denoted by the appropriate argument is
captured and bound to the variable
<tt>it</tt>
whose scope extends over the
<tt><i>then</i></tt>
form, as well as over
<tt><i>else</i></tt>,
if present.
</p><p>
If
<tt><i>cond</i></tt>
yields a true value, then
<tt><i>then</i></tt>
is evaluated and the resulting value is returned, otherwise
<tt><i>else</i></tt>
is evaluated if present and its value is returned.
A missing
<tt><i>else</i></tt>
is treated as if it were the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
form.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
8F39B0">ifa</a> t 1 0)  -&gt;  1

  ;; Rule 6: it binds to (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-022396F7">*</a> x x), which is
  ;; the only it-candidate.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
x 6) (y 49))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> =
(&gt; y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a=
> x x)) ;; it binds to (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-022396F7">*</a> x x)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> it)))
  -&gt; (36)

  ;; Rule 4: it binds to argument of evenp,
  ;; even though 4 isn't an it-candidate.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a> 4)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 it))
  -&gt; (4)

  ;; Rule 5:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a> (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a> 4))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 it))
  -&gt; (4)

  ;; Rule 7: no candidates: choose leftmost
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
x 6) (y 49))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> =
(&lt; 1 x y)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> it)))
  -&gt; (1)

  -&gt; (4)
  ;; Violation of Rule 1:
  ;; while is not a function
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a> t (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a> 42))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 it))
  --&gt; exception!

  ;; Violation of Rule 2:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
x 6) (y 49))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> =
(&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> =
y y y) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a>=
 x x)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> it))
  --&gt; exception!
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-025CC33C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.16">9.5.16</a=
> Macro <tt>conda</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(conda {(</tt><tt><i>test</i></tt><tt> </tt><tt><i>form</i>=
</tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025CC33C">conda</a>=
</tt>
operator provides a multi-branching conditional evaluation of
forms, similarly to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</a><=
/tt>
operator. Enclosed in the cond form are groups of forms expressed as lists.
Each group must be a list of at least one form.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025CC33C">conda</a>=
</tt>
operator is anaphoric: it expands into a nested structure of zero or more
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
invocations, according to these patterns:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
5CC33C">conda</a>) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025CC33C">conda</a> =
(x y ...) ...) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
18F39B0">ifa</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F=
7A8B8">progn</a> y ...) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-025CC33C">conda</a> ...))
</tt></pre><tt>

</tt>

<p>
Thus,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025CC33C">conda</a>=
</tt>
inherits all the restrictions on the
<tt><i>test</i></tt>
expressions from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>,
as well as the anaphoric
<tt>it</tt>
variable feature.
</p><p>

</p></dd></dl>
<a name=3D"N-005C93DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.17">9.5.17</a=
> Macro <tt>whena</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(whena </tt><tt><i>test</i></tt><tt> </tt><tt><i>form</i></=
tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005C93DF">whena</a>=
</tt>
macro is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</a><=
/tt>
macro, except that it is anaphoric in exactly the same manner as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
macro. It may be understood as conforming to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
5C93DF">whena</a> x f0 f2 ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#D-0039">if</a> x (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-03F7A8B8">progn</a> f0 f2 ...))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02D31F8C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.18">9.5.18</a=
> Macro <tt>dotimes</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dotimes (</tt><tt><i>var</i></tt><tt> </tt><tt><i>count-fo=
rm</i></tt><tt> [</tt><tt><i>result-form</i></tt><tt>])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D31F8C">dotimes</=
a></tt>
macro implements a simple counting loop.
<tt><i>var</i></tt>
is established as a variable, and initialized to zero.
<tt><i>count-form</i></tt>
is evaluated one time to produce a limiting value, which should be a number=
.
Then, if the value of
<tt><i>var</i></tt>
is less than the limiting value, the
<tt><i>body-form</i></tt>-s
are evaluated,
<tt><i>var</i></tt>
is incremented by one, and the process repeats with a new comparison
of
<tt><i>var</i></tt>
against the limiting value possibly leading to another evaluation of
the forms.
</p><p>
If
<tt><i>var</i></tt>
is found to equal or exceed the limiting value, then the loop terminates.
</p><p>
When the loop terminates, its return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
unless a
<tt><i>result-form</i></tt>
is present, in which case the value of that form specifies the return value=
.
</p><p>
<tt><i>body-form</i></tt>-s
as well as
<tt><i>result-form</i></tt>
are evaluated in the scope in which the binding of
<tt><i>var</i></tt>
is visible.
</p><p>

</p></dd></dl>
<a name=3D"N-0105F01D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.19">9.5.19</a=
> Operators <tt>each</tt>, <tt>each*</tt>, <tt>collect-each</tt>, <tt>colle=
ct-each*</tt>, <tt>append-each</tt> and <tt>append-each*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(each ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form=
</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(each* ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-for=
m</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(collect-each ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>i=
nit-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(collect-each* ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>=
init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(append-each ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>in=
it-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(append-each* ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>i=
nit-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These operators establish a loop for iterating over the elements of one or =
more
sequences. Each
<tt><i>init-form</i></tt>
must evaluate to an iterable object that is suitable as an argument for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
function.
The sequences are then iterated in
parallel over repeated evaluations of the
<tt><i>body-form</i></tt>-s,
with each
<tt><i>sym</i></tt>
variable being assigned to successive elements of its sequence. The shortes=
t
list determines the number of iterations, so if any of the
<tt><i>init-form</i></tt>-s
evaluate to
an empty sequence, the body is not executed.
</p><p>
If the list of
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

pairs itself is empty, then an infinite loop is specified.
</p><p>
The body forms are enclosed in an anonymous block, allowing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator to terminate the loop prematurely and optionally specify
the return value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach*</a></tt>
variants are like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each*</a>=
</tt>,
except that for each iteration, the resulting value of the body is collecte=
d
into a list. When the iteration terminates, the return value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach*</a></tt>
operator is this collection.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch*</a></tt>
variants are like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each*</a>=
</tt>,
except that for each iteration other than the last, the resulting value of =
the
body must be a list. The last iteration may produce either an atom or a lis=
t.
The objects produced by the iterations are combined together as if they
were arguments to the append function, and the resulting value is the
value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch*</a></tt>
operator.
</p><p>
The alternate forms denoted by the adorned symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each*</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch*</a></tt>,
differ from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch</a></tt>
in the following way. The plain forms evaluate the
<tt><i>init-form</i></tt>-s
in an environment in which none of the
<tt>sym</tt>
variables are yet visible. By contrast, the alternate
forms evaluate each
<tt><i>init-form</i></tt>
in an environment in which bindings for the
previous
<tt><i>sym</i></tt>
variables are visible.  In this phase of evaluation,
<tt><i>sym</i></tt>
variables are list-valued: one by one they are each bound to the list objec=
t
emanating from their corresponding
<tt><i>init-form</i></tt>.
Just before the first loop
iteration, however, the
<tt><i>sym</i></tt>
variables are assigned the first item from each
of their lists.
</p><p>
</p></dd><dt>Note:</dt><dd>
<p>


The semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach</a></tt>
may be understood in terms of an equivalence to a code pattern involving
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>:
</p><p>
<tt>

<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F0=
1D">collect-each</a>&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F=
">mapcar</a>&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F=
">lambda</a>&nbsp;(x&nbsp;y)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&lt;--&gt;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;xinit&nbsp;yinit)
</tt>

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach*</a></tt>
variant may be understood in terms of the following equivalence involving
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
for sequential binding and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>:
</p><p>
<tt>

<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F0=
1D">collect-each*</a>&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20=
B">let*</a>&nbsp;((x&nbsp;xinit)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&lt;--&gt;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>&nbsp;(<a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#D-004F">lambda</a>&nbsp;(x&nbsp;y)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;y))
</tt>

</p><p>
However, note that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
as well as each invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
binds fresh instances of the variables, whereas these operators are permitt=
ed
to bind a single instance of the variables, which are first initialized wit=
h
the initializing expressions, and then re-used as iteration variables which=
 are
stepped by assignment.
</p><p>
The other operators may be understood likewise, with the substitution
of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>
function in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each*</a>=
</tt>
and of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>
function in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-ea=
ch*</a></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>

<br>&nbsp;;;&nbsp;print&nbsp;numbers&nbsp;from&nbsp;1&nbsp;to&nbsp;10&nbsp;=
and&nbsp;whether&nbsp;they&nbsp;are&nbsp;even&nbsp;or&nbsp;odd
<br>&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">ea=
ch*</a>&nbsp;((n&nbsp;1..11)&nbsp;;;&nbsp;n&nbsp;is&nbsp;just&nbsp;a&nbsp;r=
ange&nbsp;object&nbsp;in&nbsp;this&nbsp;scope
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(even&nbsp;(<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-each</a>&n=
bsp;((m&nbsp;n))&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0036">evenp</a>&nbsp;m))))
<br>&nbsp;&nbsp;&nbsp;;;&nbsp;n&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;t=
his&nbsp;scope
<br>&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
011ACA52">format</a>&nbsp;t&nbsp;"~s&nbsp;is&nbsp;~s\n"&nbsp;n&nbsp;(<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a>&nbsp;even&nbsp;"=
even"&nbsp;"odd")))
</tt>

</p></dd><dt>Output:</dt><dd>
<p>


<tt>

<br>&nbsp;1&nbsp;is&nbsp;"odd"
<br>&nbsp;2&nbsp;is&nbsp;"even"
<br>&nbsp;3&nbsp;is&nbsp;"odd"
<br>&nbsp;4&nbsp;is&nbsp;"even"
<br>&nbsp;5&nbsp;is&nbsp;"odd"
<br>&nbsp;6&nbsp;is&nbsp;"even"
<br>&nbsp;7&nbsp;is&nbsp;"odd"
<br>&nbsp;8&nbsp;is&nbsp;"even"
<br>&nbsp;9&nbsp;is&nbsp;"odd"
<br>&nbsp;10&nbsp;is&nbsp;"even"
</tt>

</p><p>

</p></dd></dl>
<a name=3D"N-031372ED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.20">9.5.20</a=
> Operators <tt>for</tt> and <tt>for*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;({for | for*} ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i=
>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp; ([</tt><tt><i>test-form</i></tt><tt> </tt><tt><i>result=
-form</i></tt><tt>*])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp; (</tt><tt><i>inc-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for*</a><=
/tt>
operators combine variable binding with loop iteration.
The first argument is a list of variables with optional initializers,
exactly the same as in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
operators. Furthermore, the
difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for*</a><=
/tt>
is like that between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
with regard to this list of variables.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for*</a><=
/tt>
operators execute these steps:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
Establish an anonymous block over the entire form, allowing
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator to be used to terminate the loop.
</dd><dt>2.</dt><dd>
Establish bindings for the specified variables similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
The variable bindings are visible over the
<tt><i>test-form</i></tt>,
each
<tt><i>result-form</i></tt>,
each
<tt><i>inc-form</i></tt>
and each
<tt><i>body-form</i></tt>.
</dd><dt>3.</dt><dd>
Evaluate
<tt><i>test-form</i></tt>.
If
<tt><i>test-form</i></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the loop terminates.  Each
<tt><i>result-form</i></tt>
is evaluated, and the value of the last of these
forms is is the result value of the loop.
If there are no
<tt><i>result-form</i></tt>-s
then the result value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If the
<tt><i>test-form</i></tt>
is omitted, then the test
is taken to be true, and the loop does not terminate.
</dd><dt>4.</dt><dd>
Otherwise, if
<tt><i>test-form</i></tt>
yields true, then each
<tt><i>body-form</i></tt>
is evaluated in turn. Then, each
<tt>inc-form</tt>
is evaluated in turn and processing resumes at step 2.
</dd></dl>
</dl>
<p>

Furthermore, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for*</a><=
/tt>
operators establish an anonymous block,
allowing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator to be used to terminate at any point.
</p><p>

</p></dd></dl>
<a name=3D"N-01FF4DDB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.21">9.5.21</a=
> Macros <tt>doloop</tt> and <tt>doloop*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;({doloop | doloop*}=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; ({ sym | (</tt><tt><i>sym</i></tt><tt> [</tt><=
tt><i>init-form</i></tt><tt> [</tt><tt><i>step-form</i></tt><tt>])}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; ([</tt><tt><i>test-form</i></tt><tt> </tt><tt>=
<i>result-form</i></tt><tt>*])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>tagbody-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop*</=
a></tt>
macros provide an iteration construct inspired by the ANSI Common Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
and
<tt>do*</tt>
macros.
</p><p>
Each
<tt><i>sym</i></tt>
element in the form must be a symbol suitable for use as a variable name.
</p><p>
The
<tt><i>tagbody-form</i></tt>-s
are placed into an implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>,
meaning that a
<tt><i>tagbody-form</i></tt>
which is an integer, character or symbol is interpreted
as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
label which may be the target of a control transfer via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
macro.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop</a=
></tt>
macro binds each
<tt><i>sym</i></tt>
to the value produced by evaluating the adjacent
<tt><i>init-form</i></tt>.
Then, in the environment in which these variables now exist,
<tt><i>test-form</i></tt>
is evaluated. If that form yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the loop terminates. The
<tt><i>result-form</i></tt>-s
are evaluated, and the value of the last one is returned.
</p><p>
If
<tt><i>result-form</i></tt>-s
are absent, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If
<tt><i>test-form</i></tt>
is also absent, then the loop terminates and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>test-form</i></tt>
produces a true value, then
<tt><i>result-form</i></tt>-s
are not evaluated. Instead, the implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
comprised of the
<tt><i>tagbody-form</i></tt>-s
is evaluated.
If that evaluation terminates normally, the loop variables are
then updated by assigning to each
<tt><i>sym</i></tt>
the value of
<tt><i>step-form</i></tt>.
</p><p>
The following defaulting behaviors apply in regard to the variable
syntax. For each
<tt><i>sym</i></tt>
which has an associated
<tt><i>init-form</i></tt>
but no
<tt><i>step-form</i></tt>,
the
<tt><i>init-form</i></tt>
is duplicated and taken as the
<tt><i>step-form</i></tt>.
Thus a variable specification like
<tt>(x y)</tt>
is equivalent to
<tt>(x y y)</tt>.
If both forms are omitted, then the
<tt><i>init-form</i></tt>
is taken to be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and the
<tt><i>step-form</i></tt>
is taken to be
<tt><i>sym</i></tt>.
This means that the variable form
<tt>(x)</tt>
is equivalent to
<tt>(x nil x)</tt>
which has the effect that
<tt>x</tt>
retains its current value when the next loop iteration begins.
Lastly, the
<tt><i>sym</i></tt>
variant is equivalent to
<tt>




(</tt><tt><i>sym</i></tt><tt>)=20

</tt>

so that
<tt>x</tt>
is also equivalent to
<tt>(x nil x)</tt>.
</p><p>
The differences between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop*</=
a></tt>
are:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop</a=
></tt>
binds the variables in parallel, similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop*</=
a></tt>
binds sequentially, like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>;
moreover,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop</a=
></tt>
performs the
<tt><i>step-form</i></tt>
assignments in parallel as if using a single
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a> </t=
t><tt><i>sym0</i></tt><tt> </tt><tt><i>step-form-0</i></tt><tt> </tt><tt><i=
>sym1</i></tt><tt> </tt><tt><i>step-form-1</i></tt><tt> ...)=20

</tt>

form, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop*</=
a></tt>
performs the assignment sequentially as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a><=
/tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF4DDB">doloop*</=
a></tt>
macros establish an anonymous
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>,
allowing early return from the loop, with a value, via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


These macros are substantially different from the ANSI Common Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
and
<tt>do*</tt>
macros. Firstly, the termination logic is inverted; effectively they
implement "while" loops, whereas their ANSI CL counterparts implement
"until" loops. Secondly, in the ANSI CL macros, the defaulting of
the missing
<tt><i>step-form</i></tt>
is different. Variables with no
<tt><i>step-form</i></tt>
are not updated. In particular, this means that the form
<tt>(x y)</tt>
is not equivalent to
<tt>(x y y)</tt>;
the ANSI CL macros do not feature the automatic replication of
<tt><i>init-form</i></tt>
into the
<tt><i>step-form</i></tt>
position.
</p><p>

</p></dd></dl>
<a name=3D"N-02CA3C70">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.22">9.5.22</a=
> Macros <tt>each-prod</tt>, <tt>collect-each-prod</tt> and <tt>append-each=
-prod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(each-prod ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init=
-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(collect-each-prod ({(</tt><tt><i>sym</i></tt><tt> </tt><tt=
><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(append-each-prod ({(</tt><tt><i>sym</i></tt><tt> </tt><tt>=
<i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C70">each-prod=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C70">collect-e=
ach-prod</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C70">append-ea=
ch-prod</a></tt>
have a similar syntax to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C70">collect-e=
ach-prod</a></tt>.
However, instead of iterating over sequences in parallel, they iterate over
the Cartesian product of the elements from the sequences.
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-e=
ach</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C70">collect-e=
ach-prod</a></tt>
is analogous to that between the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a=
></tt>.
</p><p>
These macros can be understood as providing syntactic sugar according to th=
e
pattern established by the following equivalences:
</p><p>
<tt>

<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C=
70">each-prod</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-03A943EE">mapdo</a>&nbsp;(<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-004F">lambda</a>&nbsp;(x&nbsp;y)
<br>&nbsp;&nbsp;&nbsp;&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&lt;--&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x=
init
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yinit)
</tt></p><p><tt>
<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C=
70">collect-each-prod</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a>&nbsp;(<a =
href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>&nbsp;(x&n=
bsp;y)
<br>&nbsp;&nbsp;&nbsp;&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&lt;--&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;xinit
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yinit)
</tt></p><p><tt>
<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C=
70">append-each-prod</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprend</a>&nbs=
p;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>&nbs=
p;(x&nbsp;y)
<br>&nbsp;&nbsp;&nbsp;&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&lt;--&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;xinit
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yinit)
</tt>

</p><p>
However, note that each invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
binds fresh instances of the variables, whereas these operators are
permitted to bind a single instance of the variables, which are then steppe=
d by
assignment.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>

<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA3C=
70">collect-each-prod</a>&nbsp;((a&nbsp;'(a&nbsp;b&nbsp;c))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(n&nbsp;#(1&nb=
sp;2)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-02D6CEDA">cons</a>&nbsp;a&nbsp;n))
</tt></p><p><tt>
<br>&nbsp;--&gt;&nbsp;((a&nbsp;.&nbsp;1)&nbsp;(a&nbsp;.&nbsp;2)&nbsp;(b&nbs=
p;.&nbsp;1)&nbsp;(b&nbsp;.&nbsp;2)&nbsp;(c&nbsp;.&nbsp;1)&nbsp;(c&nbsp;.&nb=
sp;2))
</tt>

</p><p>

</p></dd></dl>
<a name=3D"N-02660E4F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.23">9.5.23</a=
> Macros <tt>each-prod*</tt>, <tt>collect-each-prod*</tt> and <tt>append-ea=
ch-prod*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(each-prod* ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>ini=
t-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(collect-each-prod* ({(</tt><tt><i>sym</i></tt><tt> </tt><t=
t><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(append-each-prod* ({(</tt><tt><i>sym</i></tt><tt> </tt><tt=
><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E4F">each-prod=
*</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E4F">collect-e=
ach-prod*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E4F">append-ea=
ch-prod*</a></tt>
are variants of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E4F">each-prod=
*</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E4F">collect-e=
ach-prod*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E4F">append-ea=
ch-prod*</a></tt>
with sequential binding.
</p><p>
These macros can be understood as providing syntactic sugar according to th=
e
pattern established by the following equivalences:
</p><p>
<tt>

<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E=
4F">each-prod*</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-013AF20B">let*</a>&nbsp;((x&nbsp;xinit)
<br>&nbsp;&nbsp;&nbsp;&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;(y&nbsp;yinit))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&lt;--&gt;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-03A943EE">mapdo</a>&nbsp;(<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#D-004F">lambda</a>&nbsp;(x&nbsp;y)&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;y)
</tt></p><p><tt>
<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E=
4F">collect-each-prod*</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"h=
ttp://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a>&nbsp;((x&nbsp;xi=
nit)
<br>&nbsp;&nbsp;&nbsp;&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;(y&nbsp;yinit))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&lt;--&gt;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-015987D7">maprod</a>&nbsp;(<a href=3D"http://nongnu.o=
rg/txr/txr-manpage.html#D-004F">lambda</a>&nbsp;(x&nbsp;y)&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;y)
</tt></p><p><tt>
<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E=
4F">append-each-prod*</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a>&nbsp;((x&nb=
sp;xinit)
<br>&nbsp;&nbsp;&nbsp;&nbsp;((x&nbsp;xinit)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;(y&nbsp;yinit))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y&nbsp;yinit))&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&lt;--&gt;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-015987D7">maprend</a>&nbsp;(<a href=3D"http://nongnu.=
org/txr/txr-manpage.html#D-004F">lambda</a>&nbsp;(x&nbsp;y)&nbsp;body)
<br>&nbsp;&nbsp;&nbsp;&nbsp;body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;y)
</tt>

</p><p>
However, note that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
as well as each invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
binds fresh instances of the variables, whereas these operators are permitt=
ed
to bind a single instance of the variables, which are first initialized wit=
h
the initializing expressions, and then re-used as iteration variables which=
 are
stepped by assignment.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>

<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02660E=
4F">collect-each-prod*</a>&nbsp;((a&nbsp;"abc")
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b&nbsp;=
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-029EEA82">upcase-str</=
a>&nbsp;a)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;`@a@b`)
</tt></p><p><tt>
<br>&nbsp;&nbsp;--&gt;&nbsp;("aA"&nbsp;"aB"&nbsp;"aC"&nbsp;"bA"&nbsp;"bB"&n=
bsp;"bC"&nbsp;"cA"&nbsp;"cB"&nbsp;"cC")
</tt>

</p><p>

</p></dd></dl>
<a name=3D"N-02F60DCE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.24">9.5.24</a=
> Operators <tt>block</tt> and <tt>block*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(block </tt><tt><i>name</i></tt><tt> </tt><tt><i>body-form<=
/i></tt><tt>*)=20




<br>&nbsp;&nbsp;(block* </tt><tt><i>name-form</i></tt><tt> </tt><tt><i>body=
-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
operator introduces a named block around the execution of
some forms. The
<tt><i>name</i></tt>
argument may be any object, though block names are usually symbols.
Two block
<tt><i>name</i></tt>
objects are considered to be the same name according to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
equality.
Since a block name is not
a variable binding, keyword symbols are permitted, and so are the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
A block named by the symbol nil is slightly special: it is
understood to be an anonymous block.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F60DCE">block*</a=
></tt>
operator differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
in that it evaluates
<tt><i>name-form</i></tt>,
which is expected to produce a symbol. The resulting symbol
is used for the name of the block.
</p><p>
A named or anonymous block establishes an exit point for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator, respectively. These operators can be invoked within a block
to cause its immediate termination with a specified return value.
</p><p>
A block also establishes a prompt for a
<i>delimited continuation</i>.

Anywhere in a block, a continuation can be captured using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
function. Delimited continuations are described in the section
Delimited Continuations. A delimited continuation allows an apparently
abandoned block to be restarted at the capture point, with the
entire call chain and dynamic environment between the prompt and the captur=
e
point intact.
</p><p>
Blocks in <b>TXR Lisp</b> have dynamic scope. This means that the following
situation is allowed:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> func () (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-03E500DF">return-from</a> foo 42))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> foo =
(func))
</tt></pre><tt>

</tt>

<p>
The function can return from the
<tt>foo</tt>
block even though the
<tt>foo</tt>
block
does not lexically surround
<tt>foo</tt>.
</p><p>
It is because blocks are dynamic that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F60DCE">block*</a=
></tt>
variant exists; for lexically scoped blocks, it would make little
sense to have support a dynamically computed name.
</p><p>
Thus blocks in <b>TXR Lisp</b> provide dynamic non-local returns, as well
as returns out of lexical nesting.
</p><p>
It is permitted for blocks to be aggressively
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>-converted
by compilation.  This means that a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
form which meets certain criteria is converted to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
form which surrounds the
<tt><i>body-form</i></tt>-s
and thus no longer establishes an exit point.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
form will be spared from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>-conversion
by the compiler if it meets the following rules.
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
Any
<tt><i>body-form</i></tt>
references the block's
<tt><i>name</i></tt>
in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E20FE2">sys:absco=
nd-from</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
expression.
</dd><dt>2.</dt><dd>
The form contains at least one direct call to a function
not in the standard <b>TXR Lisp</b> library.
</dd><dt>3.</dt><dd>
The form contains at least one direct call to the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DF20E5">sys:absco=
nd*</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F766A">match-fun=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>.
</dd><dt>4.</dt><dd>
The form references any of the functions in rules 2 and 3
as a function binding via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator (or the DWIM brackets notation) or via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
operator.
</dd><dt>5.</dt><dd>
The form is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F60DCE">block*</a=
></tt>
form; these are spared from the optimization.
</dd></dl>
</dl>

Removal of blocks under the above rules means that some use of blocks which
works in interpreted code will not work in compiled programs. Programs whic=
h
adhere to the rules are not affected by such a difference.
<p>
Additionally, the compiler may
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>-convert
blocks in contravention of the above rules, but only if doing so makes no
difference to visible program behavior.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> helper ()
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-f=
rom</a> top 42))

  ;; defun implicitly defines a block named top
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
top ()
    (helper) ;; function returns 42
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a=
> 'notreached)) ;; never printed

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
top2 ()
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((h (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> =
helper)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> =
top (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 h))   ;; may progn-convert
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> =
top (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 'helper)) ;; may progn-convert
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> =
top (helper)))) ;; not removed
</tt></pre><tt>

</tt>

In the above examples, the block containing
<tt>(call h)</tt>
may be converted to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
because it doesn't express a
<b>direct</b>

call to the
<tt>helper</tt>
function. The block which calls
<tt>helper</tt>
using
<tt>(call 'helper)</tt>
is also not considered to be making a direct call.
<p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


In Common Lisp, blocks are lexical. A separate mechanism consisting of
catch and throw operators performs non-local transfer based on symbols.
The <b>TXR Lisp</b> example:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> func () (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-03E500DF">return-from</a> foo 42))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> foo =
(func))
</tt></pre><tt>

</tt>

<p>
is not allowed in Common Lisp, but can be transliterated to:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> func () (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0016">throw</a> 'foo 42))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a> 'foo=
 (func))
</tt></pre><tt>

</tt>

<p>
Note that foo is quoted in CL. This underscores the dynamic nature of
the construct.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
itself is a function and not an operator. Also note that the CL
example, in turn, is even more closely transcribed back into
<b>TXR Lisp</b> simply by replacing its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F60DCE">block*</a=
></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> func () (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-0309887F">return*</a> 'foo 42))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F60DCE">block*</a>=
 'foo (func))
</tt></pre><tt>

</tt>

<p>
Common Lisp blocks also do not support delimited continuations.
</p><p>

</p></dd></dl>
<a name=3D"N-03E500DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.25">9.5.25</a=
> Operators <tt>return</tt> and <tt>return-from</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(return [</tt><tt><i>value</i></tt><tt>])=20




<br>&nbsp;&nbsp;(return-from </tt><tt><i>name</i></tt><tt> [</tt><tt><i>val=
ue</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
operator must be dynamically enclosed within an anonymous
block (a block named by the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>).
It immediately terminates the
evaluation of the innermost anonymous block which encloses it, causing
it to return the specified value. If the value is omitted, the anonymous
block returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
operator must be dynamically enclosed within a named block
whose name matches the
<tt><i>name</i></tt>
argument. It immediately terminates the
evaluation of the innermost such block, causing it to return the specified
value. If the value is omitted, that block returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
005A">block</a> foo
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a=
> ((a "abc\n")
            (b "def\n"))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">ppri=
nt</a> a *stdout*)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">retu=
rn-from</a> foo 42)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">ppri=
nt</a> b *stdout*)))
</tt></pre><tt>

</tt>

<p>
Here, the output produced is
<tt>"abc"</tt>.
The value of
<tt>b</tt>
is not printed
because.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
terminates block
<tt>foo</tt>,
and so the second pprint form is not evaluated.
</p><p>

</p></dd></dl>
<a name=3D"N-0309887F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.26">9.5.26</a=
> Function <tt>return*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(return* </tt><tt><i>name</i></tt><tt> [</tt><tt><i>value</=
i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>
function is similar to the the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
operator, except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
is an ordinary function parameter, and so when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>
is used, an argument expression must be specified which evaluates
to a symbol. Thus
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>
allows the target block of a return to be dynamically computed.
</p><p>
The following equivalence holds between the operator and function:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
E500DF">return-from</a> a b)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr=
/txr-manpage.html#N-0309887F">return*</a> 'a b)
</tt></pre><tt>

</tt>

<p>
Expressions used as
<tt><i>name</i></tt>
arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>
which do not simply quote a symbol have no equivalent in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007E0D96">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.27">9.5.27</a=
> Macros <tt>tagbody</tt> and <tt>go</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tagbody {</tt><tt><i>form</i></tt><tt> | </tt><tt><i>label=
</i></tt><tt>}*)=20




<br>&nbsp;&nbsp;(go </tt><tt><i>label</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
macro provides a form of the "go to" control construct. The arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
form are a mixture of zero or more forms and
<i>go labels</i>.

The latter consist of those arguments which are symbols, integers or
characters.  Labels are not considered by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
to be forms, and are not subject to macro expansion or evaluation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
macro is available inside
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>.
It is erroneous for a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
form to occur outside of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>.
This situation is diagnosed by global macro called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>,
which unconditionally throws an error.
</p><p>
In the absence of invocations of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
or other control transfers, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
macro evaluates each
<tt><i>form</i></tt>
in left to right order. The go labels are ignored.
After the last
<tt><i>form</i></tt>
is evaluated, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
form terminates, and yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Any
<tt><i>form</i></tt>
itself, or else any of its sub-forms, may be the form
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a> </tt>=
<tt><i>label</i></tt><tt>)=20

</tt>

where
<tt><i>label</i></tt>
matches one of the go labels of a surrounding
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>.
When this
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
form is evaluated, then the evaluation of
<tt><i>form</i></tt>
is immediately abandoned, and control transfers to the specified
label. The forms are then evaluated in left-to-right order starting
with the form immediately after that label. If the label is not
followed by any forms, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
terminates. If
<tt><i>label</i></tt>
doesn't match to any label in any surrounding
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
form is erroneous.
</p><p>
The abandonment of a
<tt><i>form</i></tt>
by invocation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
is a dynamic transfer. All necessary unwinding inside
<tt><i>form</i></tt>
takes place.
</p><p>
The go labels are lexically scoped, but dynamically bound. Their scope
being lexical means that the labels are not visible to forms which are not
enclosed within the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>,
even if their evaluation is invoked from that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>.
The dynamic binding means that the labels of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
form are established when it begins evaluating, and removed when
that form terminates. Once a label is removed, it is not available
to be the target of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
control transfer, even if that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
form has the label in its lexical scope. Such an attempted transfer
is erroneous.
</p><p>
It is permitted for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
forms to nest arbitrarily. The labels of an inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
are not visible to an outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>.
However, the reverse is true: a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>
form in an inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
may branch to a label in an outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>,
in which case the entire inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
terminates.
</p><p>
In cases where the same objects are used as labels
by an inner and outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>,
the inner labels shadow the outer labels.
</p><p>
There is no restriction on what kinds of symbols may be labels.
Symbols in the
<tt>keyword</tt>
package as well as the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
are valid
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
labels.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
ANSI Common Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
supports only symbols and integers as labels (which are called "go tags");
characters are not supported.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; print the numbers 1 to 10
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
i 0))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody<=
/a>
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a>=
 skip) ;; forward goto skips 0
     again
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> i)
     skip
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</=
a> (&lt;=3D (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">=
inc</a> i) 10)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</=
a> again))))

  ;; Example of erroneous usage: by the time func is invoked
  ;; by (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> func) the tagbody has already terminated. The
  ;; lambda body can still "see" the label, but it doesn't
  ;; have a binding.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> (f=
unc)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody<=
/a>
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> fu=
nc (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> ()=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a> labe=
l)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a>=
 out)
     label
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> 'never-reached)
      out)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 func))

  ;; Example of unwinding when the unwind-protect
  ;; form is abandoned by (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-007E0D96">go</a> out). Output is:
  ;;   reached
  ;;   cleanup
  ;;   out
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</a=
>
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-=
protect</a>
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn=
</a>
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pri=
nl</a> 'reached)
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go<=
/a> out)
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pri=
nl</a> 'notreached))
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl=
</a> 'cleanup))
   out
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</=
a> 'out))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-018A4BA9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.5.28">9.5.28</a=
> Macros <tt>prog</tt> and <tt>prog*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(prog ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i>=
</tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {</tt><tt><i>body-form</i></tt><tt> | </tt><tt=
><i>label</i></tt><tt>}*)=20




<br>&nbsp;&nbsp;(prog* ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i=
></tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {</tt><tt><i>body-form</i></tt><tt> | </tt><tt=
><i>label</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A4BA9">prog</a><=
/tt>
and
<tt>progn*</tt>
macros combine the features of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
respectively,
anonymous block and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A4BA9">prog</a><=
/tt>
macro treats the
<tt><i>sym</i></tt>
and
<tt>init-form</tt>
expressions similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
establishing variable bindings in parallel.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A4BA9">prog*</a>=
</tt>
macro treats these expressions in a similar way to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
</p><p>
The forms enclosed are treated like the argument forms of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">tagbody</=
a></tt>
macro: labels are permitted, along with use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007E0D96">go</a></t=
t>.
</p><p>
Finally, an anonymous block is established around all of the enclosed
forms (both the
<tt><i>init-form</i></tt>-s
and
<tt><i>body-forms</i></tt>-s)
allowing the use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
to terminate evaluation with a value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A4BA9">prog</a><=
/tt>
macro may be understood according to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
18A4BA9">prog</a> vars forms ...)  &lt;--&gt;  (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#D-005A">block</a> nil
                                  (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-013AF20B">let</a> vars
                                    (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-007E0D96">tagbody</a> forms ...)))
</tt></pre><tt>

</tt>

<p>
Likewise, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A4BA9">prog*</a>=
</tt>
macro follows an analogous equivalence, with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
replaced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-03B7E13E">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.6">9.6</a> Eval=
uation</h3>



<p>


</p><p>

<a name=3D"N-0286C8B8">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.6.1">9.6.1<=
/a> Function <tt>eval</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(eval </tt><tt><i>form</i></tt><tt> [</tt><tt><i>env</i></t=
t><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
function treats the
<tt><i>form</i></tt>
object as a Lisp expression, which is expanded and
evaluated. The side effects implied by the form are performed, and the valu=
e
which it produces is returned. The optional
<tt><i>env</i></tt>
object specifies an environment for
resolving the function and variable references encountered in the expressio=
n.
If this argument is omitted
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then evaluation takes place in the global environment.
</p><p>
The
<tt><i>form</i></tt>
is not expanded all at once. Rather, it is treated by the following algorit=
hm:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
First, if
<tt><i>form</i></tt>
is a macro, it is macro-expanded as if by an application of the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>.
</dd><dt>2.</dt><dd>
If the resulting expanded form is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>,
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
form, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
iterates over that form's argument expressions, passing each expression to =
a
recursive call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
using the same
<tt><i>env</i></tt>.
</dd><dt>3.</dt><dd>
Otherwise, if the expanded form isn't one of the above three kinds of
expressions, it is subject to a full expansion and evaluation.
</dd></dl>
</dl>

This algorithm allows a sequence of top-level forms to be combined into a
single top-level form, even when the expansion of forms occurring later in =
the
sequence depends on the evaluation effects of forms earlier in the sequence=
.
<p>
For instance, a form like
<tt>(progn (defmacro foo ()) (foo))</tt>
may be processed with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>,
because the above algorithm ensures that the
<tt>(defmacro foo ())</tt>
expression is fully evaluated first, thereby providing the
macro definition required by
<tt>(foo)</tt>.
</p><p>
This expansion and evaluation order is important because the semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
forms the reference model for how the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function processes top-level forms.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01144687">make-env<=
/a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0172F00A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.6.2">9.6.2</a> =
Function <tt>constantp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(constantp </tt><tt><i>form</i></tt><tt> [</tt><tt><i>env</=
i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A">constantp=
</a></tt>
function determines whether
<tt><i>form</i></tt>
is a constant form, with respect to environment
<tt><i>env</i></tt>.
</p><p>
If
<tt><i>env</i></tt>
is absent, the global environment is used.
The
<tt><i>env</i></tt>
argument is used for macro-expanding
<tt><i>form</i></tt>.
</p><p>
Currently,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A">constantp=
</a></tt>
returns true for any form which, after macro-expansion, is any of
the following: a compound form with the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>
in its first position; a non-symbolic atom; or one of the symbols
which evaluate to themselves and cannot be bound as variables.
These symbols are the keyword symbols, and the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
In the future,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A">constantp=
</a></tt>
will be able to recognize more constant forms, such as calls to certain
functions whose arguments are constant forms.
</p><p>

</p></dd></dl>
<a name=3D"N-01144687">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.6.3">9.6.3</a> =
Function <tt>make-env</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-env [</tt><tt><i>var-bindings</i></tt><tt> [</tt><tt>=
<i>fun-bindings</i></tt><tt> [</tt><tt><i>next-env</i></tt><tt>]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01144687">make-env<=
/a></tt>
function creates an environment object suitable as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
parameter.
</p><p>
The
<tt><i>var-bindings</i></tt>
and
<tt><i>fun-bindings</i></tt>
parameters, if specified,
should be association lists, mapping symbols to objects.  The objects in
<tt><i>fun-bindings</i></tt>
should be functions, or objects callable as functions.
</p><p>
The
<tt><i>next-env</i></tt>
argument, if specified, should be an environment.
</p><p>
Note: bindings can also be added to an environment using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03389BE3">env-vbind=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03389BE3">env-fbind=
</a></tt>
functions.
</p><p>

</p></dd></dl>
<a name=3D"N-03389BE3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.6.4">9.6.4</a> =
Functions <tt>env-vbind</tt> and <tt>env-fbind</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(env-vbind </tt><tt><i>env</i></tt><tt> </tt><tt><i>symbol<=
/i></tt><tt> </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(env-fbind </tt><tt><i>env</i></tt><tt> </tt><tt><i>symbol<=
/i></tt><tt> </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions bind a symbol to a value in either the function or variable
space of environment
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>.
</p><p>
Values established in the function space should be functions or objects tha=
t
can be used as functions such as lists, strings, arrays or hashes.
</p><p>
If
<tt><i>symbol</i></tt>
already exists in the environment, in the given space, then its
value is updated with
<tt>value</tt>.
</p><p>
If
<tt><i>env</i></tt>
is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the binding takes place in the global environment.
</p><p>

</p></dd></dl>
<a name=3D"N-0018DCDC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.6.5">9.6.5</a> =
Functions <tt>env-vbindings</tt>, <tt>env-fbindings</tt> and <tt>env-next</=
tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(env-vbindings </tt><tt><i>env</i></tt><tt>)=20




<br>&nbsp;&nbsp;(env-fbindings </tt><tt><i>env</i></tt><tt>)=20




<br>&nbsp;&nbsp;(env-next </tt><tt><i>env</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These function retrieve the components of
<tt><i>env</i></tt>,
which must be an environment. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0018DCDC">env-vbind=
ings</a></tt>
function retrieves the the association list representing variable
bindings. Similarly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0018DCDC">env-fbind=
ings</a></tt>
retrieves the association list of function bindings.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0018DCDC">env-next<=
/a></tt>
function retrieves the next environment, if
<tt><i>env</i></tt>
has one, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt>e</tt>
is an environment constructed by the expression
<tt>(make-env v f n)</tt>,
then
<tt>(env-vbindings e)</tt>
retrieves
<tt>v</tt>,
<tt>(env-fbindings e)</tt>
retrieves
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
and
<tt>(env-next e)</tt>
returns
<tt>n</tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-0384A294">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7">9.7</a> Glob=
al Environment</h3>



<p>



<a name=3D"N-00004DDC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.1">9.7.1<=
/a> Accessors <tt>symbol-function</tt>, <tt>symbol-macro</tt> and <tt>symbo=
l-value</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(symbol-function {</tt><tt><i>symbol</i></tt><tt> | </tt><t=
t><i>method-name</i></tt><tt> | </tt><tt><i>lambda-expr</i></tt><tt>})=20




<br>&nbsp;&nbsp;(symbol-macro </tt><tt><i>symbol</i></tt><tt>)=20




<br>&nbsp;&nbsp;(symbol-value </tt><tt><i>symbol</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (symbol-function {</tt><tt><i>symbol</i></tt><tt> | </=
tt><tt><i>method-name</i></tt><tt>}) </tt><tt><i>new-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (symbol-macro </tt><tt><i>symbol</i></tt><tt>) </tt><t=
t><i>new-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (symbol-value </tt><tt><i>symbol</i></tt><tt>) </tt><t=
t><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If given a
<tt><i>symbol</i></tt>
argument, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
function retrieves the value of the global function binding of the
given
<tt><i>symbol</i></tt>
if it has one: that is, the function object bound to the
<tt><i>symbol</i></tt>.
If
<tt><i>symbol</i></tt>
has no global function binding, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
function supports method names of the form
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>struct</i></tt><tt> </tt><tt><i>slot</i></tt><tt>)=20

</tt>

where
<tt><i>struct</i></tt>
names a struct type, and
<tt><i>slot</i></tt>
is either a static slot or one of the keyword symbols
<tt>:init</tt>
or
<tt>:postinit</tt>
which refer to special functions associated with a structure type.
Names in this format are returned by the
<tt><i>func-get-name</i></tt>
function.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
function also supports names of the form
<tt>




(macro </tt><tt><i>name</i></tt><tt>)=20

</tt>

which denote macros. Thus,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
provides unified access to functions, methods and macros.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
expression is passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>,
then the expression is macro-expanded and if that is successful, the functi=
on
implied by that expression is returned.
It is unspecified whether this function is interpreted or compiled.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-ma=
cro</a></tt>
function retrieves the value of the global macro binding of
<tt><i>symbol</i></tt>
if it has one.
</p><p>
Note: the name of this function has nothing to do with symbol macros;
it is named for consistency with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-va=
lue</a></tt>,
referring to the "macro-expander binding of the symbol cell".
</p><p>
The value of a macro binding is a function object.
Intrinsic macros are C functions in the <b>TXR</b> kernel, which receive
the entire macro call form and macro environment, performing their
own destructuring. Currently, macros written in <b>TXR Lisp</b> are represe=
nted
as curried C functions which carry the following list object in their
environment cell:
</p><p>
<tt>




<br>&nbsp;&nbsp;(#&lt;environment object&gt; </tt><tt><i>macro-parameter-li=
st</i></tt><tt> </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>

</p><p>
Local macros created by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
have
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in place of the environment object.
</p><p>
This representation is likely to change or expand to include other
forms in future <b>TXR</b> versions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-va=
lue</a></tt>
function retrieves the value stored in the dynamic binding of
<tt><i>symbol</i></tt>
that is apparent in the current context. If the variable has no dynamic
binding, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-va=
lue</a></tt>
retrieves its value in the global environment.
If
<tt><i>symbol</i></tt>
has no variable binding, but is defined as a global symbol macro,
then the value of that symbol macro binding is retrieved.
The value of a symbol macro binding is simply the replacement form.
</p><p>
Rather than throwing an exception, each of these functions returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the argument symbol doesn't have the binding in the respective
namespace or namespaces which that function searches.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-ma=
cro</a></tt>,
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-va=
lue</a></tt>
form denotes a place, if
<tt><i>symbol</i></tt>
has a binding of the respective kind.  This place may be assigned to or
deleted. Assignment to the place causes the denoted binding to have a new
value. Deleting a place with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
macro removes the binding,
and returns the previous contents of that binding. A binding
denoted by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
form is removed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">fmakunbou=
nd</a></tt>,
one denoted by by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-ma=
cro</a></tt>
is removed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">mmakunbou=
nd</a></tt>
and a binding denoted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-va=
lue</a></tt>
is removed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>.
</p><p>
Deleting a method via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
is not possible; an attempt to do so has no effect.
</p><p>
Storing a value, using any one of these three accessors, to a nonexistent
variable, function or macro binding, is not erroneous. It has has the effec=
t of
creating that binding.
</p><p>
Using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
accessor to assign to a lambda expression is erroneous.
</p><p>
Deleting a binding, using any of these three accessors, when the binding do=
es not
exist, also isn't erroneous. There is no effect and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
operator yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
as the prior value, consistent with the behavior when accessors are used to
retrieve a nonexistent value.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
In ANSI Common Lisp, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
function retrieves a function, macro or special operator binding
of a symbol.
These are all in one space and may not co-exist. In <b>TXR Lisp</b>, it
retrieves a symbol's function binding only. Common Lisp has an accessor
named
<tt>macro-function</tt>
similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-ma=
cro</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01FBF828">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.2">9.7.2</a> =
Functions <tt>boundp</tt>, <tt>fboundp</tt> and <tt>mboundp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(boundp </tt><tt><i>symbol</i></tt><tt>)=20




<br>&nbsp;&nbsp;(fboundp {</tt><tt><i>symbol</i></tt><tt> | </tt><tt><i>met=
hod-name</i></tt><tt> | </tt><tt><i>lambda-expr</i></tt><tt>})=20




<br>&nbsp;&nbsp;(mboundp </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the
<tt><i>symbol</i></tt>
is bound as a variable or symbol macro in the global
environment, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">fboundp</=
a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the
<tt><i>symbol</i></tt>
has a function binding in the global
environment, the method specified by
<tt><i>method-name</i></tt>
exists, or a lambda expression argument is given.
Otherwise it returns nil
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">mboundp</=
a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the symbol has an operator macro binding in the global environment,
otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Dialect Notes:</dt><dd>
<p>


</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>
function in ANSI Common Lisp doesn't report that
global symbol macros have a binding. They are not considered
bindings. In <b>TXR Lisp</b>, they are considered bindings.
</p><p>
The ANSI Common Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">fboundp</=
a></tt>
yields true if its argument has a function, macro or operator
binding. The behavior of the Common Lisp expression
<tt>(fboundp x)</tt>
in Common Lisp can be obtained in <b>TXR Lisp</b> using the
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
34">or</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">f=
boundp</a> x) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828=
">mboundp</a> x) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E25=
9AD">special-operator-p</a> x))
</tt></pre><tt>

</tt>

<p>
expression.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">mboundp</=
a></tt>
function doesn't exist in ANSI Common Lisp.
</p><p>

</p></dd></dl>
<a name=3D"N-01FA4070">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.3">9.7.3</a> =
Function <tt>makunbound</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(makunbound </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
the binding of
<tt><i>symbol</i></tt>
from either the dynamic environment or the global symbol
macro environment. After the call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>,
<tt><i>symbol</i></tt>
appears to be unbound.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
call takes place in a scope in which there exists a dynamic rebinding of
<tt><i>symbol</i></tt>,
the information for restoring the previous binding is not
affected by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>.
When that scope terminates, the previous binding will be restored.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
call takes place in a scope in which the dynamic binding for
<tt>symbol</tt>
is the global binding, then the global binding is removed.
When the global binding is removed, then
if
<tt><i>symbol</i></tt>
was previously marked as special (for instance
by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>)
this marking is removed.
</p><p>
Otherwise if
<tt><i>symbol</i></tt>
has a global symbol macro binding, that binding is removed.
</p><p>
If
<tt><i>symbol</i></tt>
has no apparent dynamic binding, and no global symbol macro binding,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
does nothing.
</p><p>
In all cases,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
returns
<tt><i>symbol</i></tt>.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
The behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
differs from its counterpart in ANSI Common Lisp.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
function in Common Lisp only removes a value from a dynamic variable. The
dynamic variable does not cease to exist, it only ceases to have a value
(because a binding is a value). In <b>TXR Lisp</b>, the variable ceases to =
exist. The
binding of a variable isn't its value, it is the variable itself: the
association between a name and an abstract storage location, in some
environment.  If the binding is undone, the variable disappears.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
function in Common Lisp does not remove global symbol macros,
which are not considered to be bindings in the variable namespace.
That is to say, the Common Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>
does not report true for symbol macros.
</p><p>
The Common Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
also doesn't remove the special attribute from a symbol. If a variable
is introduced with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
and then removed with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>,
the symbol continues to exhibit dynamic binding rather than lexical
in subsequent scopes. In <b>TXR Lisp</b>, if a global binding is removed, s=
o
is the special attribute.
</p><p>

</p></dd></dl>
<a name=3D"N-02964FC0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.4">9.7.4</a> =
Functions <tt>fmakunbound</tt> and <tt>mmakunbound</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fmakunbound </tt><tt><i>symbol</i></tt><tt>)=20




<br>&nbsp;&nbsp;(mmakunbound </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">fmakunbou=
nd</a></tt>
removes any binding for
<tt><i>symbol</i></tt>
from the function namespace of the global environment. If
<tt><i>symbol</i></tt>
has no such binding, it does nothing.
In either case, it returns
<tt><i>symbol</i></tt>.
</p><p>
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">mmakunbou=
nd</a></tt>
removes any binding for
<tt><i>symbol</i></tt>
from the operator macro namespace of the global environment.  If
<tt><i>symbol</i></tt>
has no such binding, it does nothing.
In either case, it returns
<tt><i>symbol</i></tt>.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
The behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">fmakunbou=
nd</a></tt>
differs from its counterpart in ANSI Common Lisp. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">fmakunbou=
nd</a></tt>
function in Common Lisp removes a function or macro binding, which
do not coexist.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">mmakunbou=
nd</a></tt>
function doesn't exist in Common Lisp.
</p><p>

</p></dd></dl>
<a name=3D"N-00722170">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.5">9.7.5</a> =
Function <tt>func-get-form</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(func-get-form </tt><tt><i>func</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00722170">func-get-=
form</a></tt>
function retrieves a source code form of
<tt><i>func</i></tt>,
which must be an interpreted function. The source code form has the syntax
<tt>




(</tt><tt><i>name</i></tt><tt> </tt><tt><i>arglist</i></tt><tt> </tt><tt><i=
>body-form</i></tt><tt>*) .=20

</tt>

</p><p>

</p></dd></dl>
<a name=3D"N-03F222DA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.6">9.7.6</a> =
Function <tt>func-get-name</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(func-get-name </tt><tt><i>func</i></tt><tt> [</tt><tt><i>e=
nv</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F222DA">func-get-=
name</a></tt>
tries to resolve the function object
<tt><i>func</i></tt>
to a name. If that is not possible, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The resolution is performed by an exhaustive search through
up to three spaces.
</p><p>
If an environment is specified by
<tt><i>env</i></tt>,
then this is searched first. If a binding is found in that
environment which resolves to the function, then the search
terminates and the binding's symbol is returned as the
function's name.
</p><p>
If the search through environment
<tt><i>env</i></tt>
fails, or if that argument is not specified, then the
global environment is searched for a function binding
which resolves to
<tt><i>func</i></tt>.
If such a binding is found, then the search terminates,
and the binding's symbol is returned. If two or more
symbols in the global environment resolve to the function,
it is not specified which one is returned.
</p><p>
If the global function environment search fails,
then the function is considered as a possible macro.
The global macro environment is searched for a macro
binding whose expander function is
<tt><i>func</i></tt>,
similarly to the way the function environment was
searched. If a binding is found, then the syntax
<tt>




(macro </tt><tt><i>name</i></tt><tt>)=20

</tt>

is returned, where
<tt><i>name</i></tt>
is the name of the global macro binding that was found
which resolves to
<tt><i>func</i></tt>.
If two or more global macro bindings share
<tt><i>func</i></tt>,
it is not specified which of those bindings provides
<tt><i>name</i></tt>.
</p><p>
If the global macro search fails, then
<tt><i>func</i></tt>
is considered as a possible method.
The static slot space of all struct types is searched for
a slot which contains
<tt><i>func</i></tt>.
If such a slot is found, then the method name is returned,
consisting of the syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>type</i></tt><tt> </tt><tt><i>name</i></tt><tt>)=20

</tt>

where
<tt><i>type</i></tt>
is a symbol denoting the struct type and
<tt><i>name</i></tt>
is the static slot of the struct type which holds
<tt><i>func</i></tt>.
</p><p>
A check is also performed whether
<tt><i>func</i></tt>
might be equal to one of the two special functions of
a structure type: its
<tt><i>initfun</i></tt>
or
<tt><i>postinitfun</i></tt>,
in which case it is returned as either the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>type</i></tt><tt> :init)=20

</tt>

or the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>type</i></tt><tt> :postinit)=20

</tt>

syntax.
</p><p>
If
<tt><i>func</i></tt>
is an interpreted function not found under any name,
then a lambda expression denoting that function
is returned in the syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> </tt>=
<tt><i>args</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

</p><p>
If
<tt><i>func</i></tt>
cannot be identified as a function, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-009538DB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.7">9.7.7</a> =
Function <tt>func-get-env</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(func-get-env </tt><tt><i>func</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009538DB">func-get-=
env</a></tt>
function retrieves the environment object associated with
function
<tt><i>func</i></tt>.
The environment object holds the captured bindings of a
lexical closure.
</p><p>

</p></dd></dl>
<a name=3D"N-015852B6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.8">9.7.8</a> =
Functions <tt>fun-fixparam-count</tt> and <tt>fun-optparam-count</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fun-fixparam-count </tt><tt><i>func</i></tt><tt>)=20




<br>&nbsp;&nbsp;(fun-optparam-count </tt><tt><i>func</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015852B6">fun-fixpa=
ram-count</a></tt>
reports
<tt><i>func</i></tt>'s
number of fixed parameters. The fixed parameters consist of the required
parameters and the optional parameters.  Variadic functions have a paramete=
r
which captures the remaining arguments which are in excess of the fixed
parameters. That parameter is not considered a fixed parameter and therefor=
e
doesn't contribute to this count.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015852B6">fun-optpa=
ram-count</a></tt>
reports
<tt><i>func</i></tt>'s
number of optional parameters.
</p><p>
The
<tt><i>func</i></tt>
argument must be a function.
</p><p>
Note: if a function isn't variadic (see the
<tt><i>fun-variadic</i></tt>
function) then the value reported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015852B6">fun-fixpa=
ram-count</a></tt>
represents the maximum number of arguments which can be passed to the funct=
ion.
The minimum number of required arguments can be calculated for any function=
 by
subtracting the value from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015852B6">fun-optpa=
ram-count</a></tt>
from the value from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015852B6">fun-fixpa=
ram-count</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02AA3799">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.9">9.7.9</a> =
Function <tt>fun-variadic</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fun-variadic </tt><tt><i>func</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AA3799">fun-varia=
dic</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>func</i></tt>
is a variadic function, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>func</i></tt>
argument must be a function.
</p><p>

</p></dd></dl>
<a name=3D"N-00AC0CF7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.10">9.7.10</a=
> Function <tt>interp-fun-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(interp-fun-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC0CF7">interp-fu=
n-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is an interpreted function, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00B99FC5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.11">9.7.11</a=
> Function <tt>vm-fun-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vm-fun-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B99FC5">vm-fun-p<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
a function compiled for the virtual machine: a function representation prod=
uced
by means of the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>.
If
<tt><i>obj</i></tt>
is of any other type, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00833473">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.12">9.7.12</a=
> Function <tt>special-var-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(special-var-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00833473">special-v=
ar-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a symbol marked for special variable binding, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Symbols are marked special by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01E259AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.7.13">9.7.13</a=
> Function <tt>special-operator-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(special-operator-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E259AD">special-o=
perator-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a symbol which names a special operator, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-027AA48B">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.8">9.8</a> Obje=
ct Type</h3>



<p>


</p><p>
In <b>TXR Lisp</b>, objects obey the following type hierarchy. In this type=
 hierarchy,
the internal nodes denote abstract types: no object is an instance of
an abstract type. Nodes in square brackets indicate an internal structure
in the type graph, invisible to programs, and angle
brackets indicate a plurality of types which are not listed by name:
</p><p>
<tt>
</tt></p><pre><tt>  t ----+--- [cobj types] ---+--- hash
        |                    |
        |                    +--- hash-iter
        |                    |
        |                    +--- stream
        |                    |
        |                    +--- random-state
        |                    |
        |                    +--- regex
        |                    |
        |                    +--- buf
        |                    |
        |                    +--- tree
        |                    |
        |                    +--- tree-iter
        |                    |
        |                    +--- cptr
        |                    |
        |                    +--- dir
        |                    |
        |                    +--- struct-type
        |                    |
        |                    +--- &lt;all structures&gt;
        |                    |
        |                    +--- ... others
        |
        |
        +--- sequence ---+--- string ---+--- str
        |                |              |
        |                |              +--- lstr
        |                |              |
        |                |              +--- lit
        |                |
        |                +--- list ---+--- null
        |                |            |
        |                |            +--- cons
        |                |            |
        |                |            +--- lcons
        |                |
        |                +--- vec
        |                |
        |                +--- &lt;structures with car or length methods&gt;
        |
        +--- number ---+--- float
        |              |
        |              +--- integer ---+--- fixnum
        |                              |
        |                              +--- bignum
        |
        +--- sym
        |
        +--- env
        |
        +--- range
        |
        +--- tnode
        |
        +--- pkg
        |
        +--- fun
</tt></pre><tt>

</tt>

<p>
In addition to the above hierarchy, the following relationships also exist:
</p><p>
<tt>
</tt></p><pre><tt>  t ---+--- atom --- &lt;any type other than cons&gt; ---=
 nil
       |
       +--- cons ---+--- lcons --- nil
                    |
                    +--- nil

  sym --- null

  struct ---- &lt;all structures&gt;
</tt></pre><tt>

</tt>

<p>
That is to say, the types are exhaustively partitioned into atoms and conse=
s;
an object is either a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
or else it isn't, in which case it is the abstract
type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a><=
/tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
type is odd in that it is both an abstract type,
serving as a supertype for the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>
and it is also a concrete type in that regular conses are of
this type.
</p><p>
The type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is an abstract type which is empty. That is to say, no object is of
type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This type is considered the abstract subtype of every other type,
including itself.
</p><p>
The type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is not to be confused with the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>
which is the type of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
symbol.
</p><p>
Because the type of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is also a symbol, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>
type is a subtype of
<tt>sym</tt>.
</p><p>
Lastly, the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
serves as the supertype of all structures.
</p><p>

<a name=3D"N-01F81275">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.8.1">9.8.1<=
/a> Function <tt>typeof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(typeof </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F81275">typeof</a=
></tt>
function returns a symbol representing the type of
<tt><i>value</i></tt>.
</p><p>
The core types are identified by the following symbols:
</p><p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CE=
DA">cons</a></tt></dt><dd>

Cons cell.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7=
C4">str</a></tt></dt><dd>

String.
<p>
</p></dd><dt><tt>lit</tt></dt><dd>

Literal string embedded in the <b>TXR</b> executable image.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D0=
9D">chr</a></tt></dt><dd>

Character.
<p>
</p></dd><dt><tt>fixnum</tt></dt><dd>

Fixnum integer: an integer that fits into the value word, not having to
be heap-allocated.
<p>
</p></dd><dt><tt>bignum</tt></dt><dd>

A bignum integer: arbitrary precision integer that is heap-allocated.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032370=
30">float</a></tt></dt><dd>

Floating-point number.
<p>
</p></dd><dt><tt>sym</tt></dt><dd>

Symbol.
<p>
</p></dd><dt><tt>pkg</tt></dt><dd>

Symbol package.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E10=
9C">fun</a></tt></dt><dd>

Function.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5=
F5">vec</a></tt></dt><dd>

Vector.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC6=
37">lcons</a></tt></dt><dd>

Lazy cons.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5=
A1">range</a></tt></dt><dd>

Range object.
<p>
</p></dd><dt><tt>lstr</tt></dt><dd>

Lazy string.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F5=
48">env</a></tt></dt><dd>

Function/variable binding environment.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">=
hash</a></tt></dt><dd>

Hash table.
<p>
</p></dd><dt><tt>stream</tt></dt><dd>

I/O stream of any kind.
<p>
</p></dd><dt><tt>regex</tt></dt><dd>

Regular expression object.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D=
76">struct-type</a></tt></dt><dd>

A structure type: the type of any one of the values which represents
a structure type.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DD=
FB">tnode</a></tt></dt><dd>

Binary search tree node.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D5=
0B">tree</a></tt></dt><dd>

Binary search tree.
<p>
</p></dd><dt><tt>args</tt></dt><dd>

Function argument list represented as an object.
</dd></dl>
<p>

</p><p>
There are more kinds of objects, such as user-defined structures.
</p><p>

<a name=3D"N-00699D3B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.8.2">9.8.2<=
/a> Function <tt>subtypep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(subtypep </tt><tt><i>left-type-symbol</i></tt><tt> </tt><t=
t><i>right-type-symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00699D3B">subtypep<=
/a></tt>
function tests whether
<tt><i>left-type-symbol</i></tt>
and
<tt><i>right-type-symbol</i></tt>
name a pair of types, such that the left type is a subtype of the right
type.
</p><p>
If either argument doesn't name a type, the behavior is
unspecified.
</p><p>
Each type is a subtype of itself. Most other type relationships can be infe=
rred
from the type hierarchy diagrams given in the introduction to this section.
</p><p>
In addition, there are inheritance relationships among structures. If
<tt><i>left-type-symbol</i></tt>
and
<tt><i>right-type-symbol</i></tt>
both name structure types, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00699D3B">subtypep<=
/a></tt>
yields true if the types are the same struct type, or if the right
type is a direct or indirect supertype of the left.
</p><p>
The type symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
is a supertype of all structure types.
</p><p>

</p></dd></dl>
<a name=3D"N-03B8D9EE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.8.3">9.8.3</a> =
Function <tt>typep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(typep </tt><tt><i>object</i></tt><tt> </tt><tt><i>type-sym=
bol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B8D9EE">typep</a>=
</tt>
function tests whether the type of
<tt><i>object</i></tt>
is a subtype of the type named by
<tt><i>type-symbol</i></tt>.
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
B8D9EE">typep</a> a b) --&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-00699D3B">subtypep</a> (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-01F81275">typeof</a> a) b)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0384D122">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.8.4">9.8.4</a> =
Macro <tt>typecase</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(typecase </tt><tt><i>test-form</i></tt><tt> {(</tt><tt><i>=
type-sym</i></tt><tt> </tt><tt><i>clause-form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0384D122">typecase<=
/a></tt>
macro evaluates
<tt><i>test-form</i></tt>
and then successively tests its type against each clause.
</p><p>
Each clause consists of a type symbol
<tt><i>type-sym</i></tt>
and zero or more
<tt><i>clause-form</i></tt>-s.
</p><p>
The first clause whose
<tt><i>type-sym</i></tt>
is a supertype of the type of
<tt><i>test-form</i></tt>'s
value is considered to be the matching clause.
That clause's
<tt><i>clause-form</i></tt>-s
are evaluated, and the value of the last form is returned.
</p><p>
If there is no matching clause, or there are no clauses present,
or the matching clause has no
<tt><i>clause-form</i></tt>-s,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
Note: since
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is the supertype of every type, a clause whose
<tt><i>type-sym</i></tt>
is the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
always matches.  If such a clause is placed as the last clause of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0384D122">typecase<=
/a></tt>,
it provides a fallback case, whose forms are evaluated if none of the
previous clauses match.
</p><p>
</p></dd></dl>
<a name=3D"N-026153A8">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9">9.9</a> Obje=
ct Equivalence</h3>



<p>


</p><p>

<a name=3D"N-0137D341">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.1">9.9.1<=
/a> Functions <tt>identity</tt>, <tt>identity</tt> and <tt>use</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(identity </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(identity* </tt><tt><i>value</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(use </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function returns its argument.
</p><p>
If the
<tt>identity*</tt>
function is given at least one argument, then it returns its
leftmost argument, otherwise it returns nil.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">use</a></=
tt>
function is a synonym of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function is useful as a functional argument, when a transformation
function is required, but no transformation is actually desired.
In this role, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">use</a></=
tt>
synonym leads to readable code. For instance:
<tt>
</tt></p><pre><tt>  ;; construct a function which returns its integer argum=
ent
  ;; if it is odd, otherwise it returns its successor.
  ;; "If it's odd, use it, otherwise take its successor".

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a> od=
dp use succ]

  ;; Applications of the function:

  [[iff oddp use succ] 3] -&gt; 3  ;; use applied to 3

  [[iff oddp use succ] 2] -&gt; 3  ;; succ applied to 2
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03C679D2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.2">9.9.2</a> =
Functions <tt>null</tt>, <tt>not</tt> and <tt>false</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(null </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(not </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(false </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a>=
</tt>
functions are synonyms.  They tests whether
<tt><i>value</i></tt>
is
the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
They return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if this is the case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
C679D2">null</a> '()) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a> n=
il) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a> (=
)) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a> =
t) -&gt; nil

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a> x) (<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a> t "x is =
nil!"))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
list '(b c d)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a> (<a href=3D"h=
ttp://nongnu.org/txr/txr-manpage.html#N-0387CD82">memq</a> 'a list))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format=
</a> t "list ~s does not contain the symbol a\n")))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00373D97">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.3">9.9.3</a> =
Functions <tt>true</tt> and <tt>have</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(true </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(have </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00373D97">true</a><=
/tt>
function is the complement of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">null</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C679D2">false</a>=
</tt>
functions. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00373D97">have</a><=
/tt>
function is a synonym for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00373D97">true</a><=
/tt>.
</p><p>
It return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the
<tt><i>value</i></tt>
is any object other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If
<tt><i>value</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: programs should avoid explicitly testing values with true.
For instance
<tt>(if x ...)</tt>
should be favored over
<tt>(if (true x) ...)</tt>.
However, the latter is useful with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a></=
tt>
macro because
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> (<a =
href=3D"http://nongnu.org/txr/txr-manpage.html#N-00373D97">true</a> </tt><t=
t><i>expr</i></tt><tt>) ...)=20

</tt>

binds the
<tt>it</tt>
variable to the value of
<tt><i>expr</i></tt>,
no matter what kind of form
<tt><i>expr</i></tt>
is, which is not true in the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F39B0">ifa</a> </tt=
><tt><i>expr</i></tt><tt> ...)=20

</tt>

form.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>   ;; Compute indices where the list '(1 nil 2 nil 3)
   ;; has true values:
   [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F1DE">where</a>=
 '(1 nil 2 nil 3) true] -&gt; (1 3)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02550B35">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.4">9.9.4</a> =
Functions <tt>eq</tt>, <tt>eql</tt> and <tt>equal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(eq </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-obj=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(eql </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-ob=
j</i></tt><tt>)=20




<br>&nbsp;&nbsp;(equal </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-=
obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The principal equality test functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
test whether two objects are equivalent, using different criteria. They ret=
urn
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the objects are equivalent, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
function uses the strictest equivalence test, called implementation
equality.  The eq function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if, and only if,
<tt><i>left-obj</i></tt>
and
<tt><i>right-obj</i></tt>
are actually the same object. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
test is is implemented
by comparing the raw bit pattern of the value, whether or not it is
an immediate value or a pointer to a heaped object.
Two character values are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
if they are the same character, and two fixnum integers
are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
if they have the same value.  All other object representations are actually
pointers, and are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
if, and only, if they point to the same object in memory.
So, for instance, two bignum integers might not be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
even if they have the same numeric
value, two lists might not be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
even if all their corresponding elements are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
and two strings might not be eq even if they hold identical text.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
function is slightly less strict than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>.
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
is that if
<tt><i>left-obj</i></tt>
and
<tt><i>right-obj</i></tt>
are numbers which are of the same kind and have the same numeric value,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
returns
<tt><i>t</i></tt>,
even if they are different objects.
Note that an integers and a floating-point number are not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
even if one has a value which converts to the other: thus,
<tt>(eql 0.0 0)</tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>;
a comparison expression which finds these numbers equal is
<tt>(=3D 0.0 0)</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
function also specially treats range objects. Two distinct range objects ar=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
if their corresponding
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
fields are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>.
For all other object types,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is less strict still than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>.
In general, it recurses into some kinds of aggregate objects to perform a
structural equivalence check.  For struct types, it also supports customiza=
tion
via equality substitution.  See the Equality Substitution section under
Structures.
</p><p>
Firstly, if
<tt><i>left-obj</i></tt>
and
<tt><i>right-obj</i></tt>
are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
then they are also
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
though the converse isn't necessarily the case.
</p><p>
If two objects are both cons cells, then they are equal if their
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
and their
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
If two objects are vectors, they are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
if they have the same length, and
their corresponding elements are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
If two objects are strings, they are equal if they are textually identical.
</p><p>
If two objects are functions, they are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
if they have
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
environments,
and if they have
the same code.  Two compiled functions are considered to have
the same code if and only if they are pointers to the same function.
Two interpreted functions are considered to have the same
code if their list
structure is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
Two hashes are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
if they use the same equality (both are
<tt>:equal-based</tt>,
or both are
<tt>:eql-based</tt>
or else both are
<tt>:eq-based</tt>),
if their associated user data elements are equal (see the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>),
if their sets of keys are identical, and if the data items associated with
corresponding keys from each respective hash are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
objects.
</p><p>
Two ranges are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
if their corresponding
<tt><i>to</i></tt>
and
<tt><i>from</i></tt>
fields are equal.
</p><p>
For some aggregate objects, there is no special semantics.  Two arguments
which are symbols, packages, or streams are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
if and only if they are the same object.
</p><p>
Certain object types have a custom
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0216A942">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.5">9.9.5</a> =
Functions <tt>neq</tt>, <tt>neql</tt> and <tt>nequal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(neq </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-ob=
j</i></tt><tt>)=20




<br>&nbsp;&nbsp;(neql </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-o=
bj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(nequal </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right=
-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">neq</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">neql</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">nequal</a=
></tt>
are logically negated counterparts of, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
for a given pair of arguments
<tt><i>left-obj</i></tt>
and
<tt><i>right-obj</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">neq</a></=
tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<i>Vice versa</i>,

if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">neq</a></=
tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The same relationship exits between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">neql</a><=
/tt>,
and between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">nequal</a=
></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-020A0042">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.6">9.9.6</a> =
Functions <tt>meq</tt>, <tt>meql</tt> and <tt>mequal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(meq </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-ob=
j</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(meql </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-o=
bj</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(mequal </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right=
-obj</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020A0042">meq</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020A0042">meql</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020A0042">mequal</a=
></tt>
("member equal" or "multi-equal")
provide a particular kind of a generalization of the binary
equality functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to multiple arguments.
</p><p>
The
<tt><i>left-obj</i></tt>
value is compared to each
<tt><i>right-obj</i></tt>
value using the corresponding binary equality function.
If a match occurs, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The traversal of the
<tt><i>right-obj</i></tt>
argument values proceeds from left to right, and stops
when a match is found.
</p><p>

</p></dd></dl>
<a name=3D"N-01D6CEA1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.7">9.9.7</a> =
Function <tt>less</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(less </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>right-o=
bj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(less </tt><tt><i>obj</i></tt><tt> </tt><tt><i>obj</i></tt>=
<tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function, when called with two arguments, determines whether
<tt><i>left-obj</i></tt>
compares less than
<tt><i>right-obj</i></tt>
in a generic way which handles arguments of various types.
</p><p>
The argument syntax of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is generalized. It can accept one argument, in which case it unconditionall=
y
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
regardless of that argument's value. If more than two arguments are
given, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
generalizes in a way which can be described by the following equivalence
pattern, with the understanding that each argument expression
is evaluated exactly once:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
D6CEA1">less</a> a b c) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-0049">and</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-01D6CEA1">less</a> a b) (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-01D6CEA1">less</a> b c))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a> a=
 b c d) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004=
9">and</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">l=
ess</a> a b) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1"=
>less</a> b c) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA=
1">less</a> c d))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function is used as the default for the
<tt><i>lessfun</i></tt>
argument of the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a></tt=
>,
as well as the
<tt><i>testfun</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-min</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-min<=
/a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function is capable of comparing numbers, characters, symbols, strings,
as well as lists and vectors of these. It can also compare buffers.
</p><p>
If both arguments are the same object so that
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a> </tt>=
<tt><i>left-obj</i></tt><tt> </tt><tt><i>right-obj</i></tt><tt>)=20

</tt>

holds true, then the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
regardless of the type of
<tt><i>left-obj</i></tt>,
even if the function doesn't handle comparing different instances
of that type. In other words, no object is less than itself, no matter
what it is.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function pairs with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function. If values
<tt>a</tt>
and
<tt>b</tt>
are objects which are of suitable types to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function, then exactly one of the following three expressions must be true:
<tt>(equal a b)</tt>,
<tt>(less a b)</tt>
or
<tt>(less b a)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
relation is: antisymmetric, such that if
<tt>(less a b)</tt>
is true, then
then
<tt>(less b a)</tt>
is false; irreflexive, such that
<tt>(less a a)</tt>
is false; and transitive, such that
<tt>(less a b)</tt>
and
<tt>(less b c)</tt>
imply
<tt>(less a c)</tt>.
</p><p>
The following are detailed criteria that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
applies to arguments of different types and combinations thereof.
</p><p>
If both arguments are numbers or characters, they are compared as if using =
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
function.
</p><p>
If both arguments are strings, they are compared as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03ABBED1">string-lt=
</a></tt>
function.
</p><p>
If both arguments are symbols, the following rules apply.
If the symbols have names which are different, then the result is
that of their names being compared by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03ABBED1">string-lt=
</a></tt>
function. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is passed symbols which have the same name, and neither of these
symbols has a home package, then the raw bit patterns of their
values are compared as integers: effectively, the object with the
lower machine address is considered lesser than the other.
If only one of the two same-named symbols has no home package, then if
that symbol is the left argument,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If both same-named symbols have home packages, then the result of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03ABBED1">string-lt=
</a></tt>
applied to the names of their respective packages. Thus
<tt>a:foo</tt>
is less than
<tt>z:foo</tt>.
</p><p>
If both arguments are conses, then they are compared as follows:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function is recursively applied to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields of both arguments. If it yields true, then
<tt><i>left-obj</i></tt>
is deemed to be less than
<tt><i>right-obj</i></tt>.
</dd><dt>2.</dt><dd>
Otherwise, if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields are unequal under
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</dd><dt>3.</dt><dd>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is recursively applied to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields of the arguments, and the result of that comparison is returned.
</dd></dl>
</dl>
<p>

This logic performs a lexicographic comparison on ordinary lists such
that for instance
<tt>(1 1)</tt>
is less than
<tt>(1 1 1)</tt>
but not less than
<tt>(1 0)</tt>
or
<tt>(1)</tt>.
</p><p>
Note that the empty
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
list nil compared to a cons is handled by type-based precedence, described
below.
</p><p>
Two vectors are compared by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
lexicographically, similarly
to strings. Corresponding elements, starting with element 0, of the
vectors are compared until an index position is found where corresponding
elements of the two vectors are not
<tt><i>equal</i></tt>.
If this differing position is beyond the end of one of the two vectors,
then the shorter vector is considered to be lesser. Otherwise, the result
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is the outcome of comparing those differing elements themselves
with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>.
</p><p>
Two buffers are also compared by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
lexicographically, as if they were vectors of integer byte values.
</p><p>
Two ranges are compared by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
using lexicographic logic similar to conses and vectors.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
fields of the ranges are first compared. If they are not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
equal then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is applied to those fields and the result is returned.
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
fields are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
is applied to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
fields and that result is returned.
</p><p>
If the two arguments are of the above types, but of different types from
each other, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
resolves the situation based on the following precedence: numbers and
characters are less than ranges, which are less than strings, which are les=
s
than symbols, which are less than conses, which are less than vectors,
which are less than buffers.
</p><p>
Note that since
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is a symbol, it is ranked lower than a cons. This interpretation ensures
correct behavior when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is regarded as an empty list, since the empty list is lexicographically pri=
or to
a nonempty list.
</p><p>
If either argument is a structure for which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method is defined, the method is invoked on that argument, and the
value returned is used in place of that argument for performing
the comparison.  Structures with no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method cannot participate in a comparison, resulting in an error.
See the Equality Substitution section under Structures.
</p><p>
Finally, if either of the arguments has a type other than the above
types, the situation is an error.
</p><p>

</p></dd></dl>
<a name=3D"N-02AC1F73">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.8">9.9.8</a> =
Function <tt>greater</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(greater </tt><tt><i>left-obj</i></tt><tt> </tt><tt><i>righ=
t-obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(greater </tt><tt><i>obj</i></tt><tt> </tt><tt><i>obj</i></=
tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>
function is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
with the arguments reversed. That is to say, the following
equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
AC1F73">greater</a> a &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-01D6CEA1">less</a> a) &lt;--&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</a=
> a b) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6=
CEA1">less</a> b a)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</a=
> a b c ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-01D6CEA1">less</a> ... c b a)
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>
function is used as the default for the
<tt><i>testfun</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-max</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-max<=
/a></tt>
functions.
</p><p>

</p></dd></dl>
<a name=3D"N-00A3E42D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.9">9.9.9</a> =
Functions <tt>lequal</tt> and <tt>gequal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lequal </tt><tt><i>obj</i></tt><tt> </tt><tt><i>obj</i></t=
t><tt>*)=20




<br>&nbsp;&nbsp;(gequal </tt><tt><i>obj</i></tt><tt> </tt><tt><i>obj</i></t=
t><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">lequal</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">gequal</a=
></tt>
are similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>
respectively, but differ in the following respect:
when called with two arguments which compare true under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">lequal</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">gequal</a=
></tt>
functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
When called with only one argument, both functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and both functions generalize to three or more arguments
in the same way as do
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0036CED9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.9.10">9.9.10</a=
> Function <tt>copy</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
function duplicates objects of various supported types: sequences, hashes,
structures and random states.  If
<tt><i>object</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
is equivalent to invoking a more specific copying function according to
the type of the argument, as follows:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt><tt>cons</tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006ED237">copy-list</a=
> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">=
str</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FE763D">copy-str</a>=
 </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">=
vec</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010E7635">copy-vec</a>=
 </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash=
</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">copy-hash</a=
> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt>struct type</dt><dd>
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032B3FDC">copy-struct<=
/a> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">=
fun</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003E7671">copy-fun</a>=
 </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf<=
/a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE75E1">copy-buf</a>=
 </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">=
carray</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006593D0">copy-carray<=
/a> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt>random-state</tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032BEE6C">make-random-=
state</a> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">=
tnode</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A17C0">copy-tnode</=
a> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">=
tree</a></tt></dt><dd>

<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EBE427">copy-search-=
tree</a> </tt><tt><i>object</i></tt><tt>)=20

</tt>

</dd></dl>
</dl>
<p>

For all other types of
<tt><i>object</i></tt>,
the invocation is erroneous.
</p><p>
Except in the case when
<tt><i>sequence</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
returns a value that
is distinct from (not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
to)
<tt><i>sequence</i></tt>.
This is different from
the behavior of
<tt>




[</tt><tt><i>sequence</i></tt><tt> 0..t]=20

</tt>

or
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a> </tt=
><tt><i>sequence</i></tt><tt> 0 t)=20

</tt>

which recognize
that they need not make a copy of
<tt><i>sequence</i></tt>,
and just return it.
</p><p>
Note however, that the elements of the returned sequence may be
eq to elements of the original sequence. In other words, copy is
a deeper copy than just duplicating the
<tt>sequence</tt>
value itself,
but it is not a deep copy.
</p><p>
</p></dd></dl>
<a name=3D"N-02F3139A">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10">9.10</a> Li=
st Manipulation</h3>



<p>



<a name=3D"N-02D6CEDA">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.1">9.10.=
1</a> Function <tt>cons</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cons </tt><tt><i>car-value</i></tt><tt> </tt><tt><i>cdr-va=
lue</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
function allocates, initializes and returns a single cons cell.
A cons cell has two fields called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
which are accessed by
functions of the same name, or by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02288559">rest</a><=
/tt>,
which are synonyms for these.
</p><p>
Lists are made up of conses. A (proper) list is either the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
denoting an empty list, or a cons cell which holds the first item of
the list in its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
and the list of the remaining items in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
The expression
<tt>(cons 1 nil)</tt>
allocates and returns a single cons cell which denotes the one-element
list
<tt>(1)</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
so there are no additional items.
</p><p>
A cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is an atom other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is printed with the dotted
pair notation. For example the cell produced by
<tt>(cons 1 2)</tt>
is denoted
<tt>(1 . 2)</tt>.
The notation
<tt>(1 . nil)</tt>
is perfectly valid as input, but the cell which it denotes
will print back as
<tt>(1)</tt>.
The notations are equivalent.
</p><p>
The dotted pair notation can be used regardless of what type
of object is the cons cell's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
so that for instance
<tt>(a . (b c))</tt>
denotes the cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
is the symbol a
<tt>a</tt>
and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is the list
<tt>(b c)</tt>.
This is exactly the same thing as
<tt>(a b c)</tt>.
In other words
<tt>(a b ... l m . (n o ... w . (x y z)))</tt>
is exactly the same as
<tt>(a b ... l m n o ... w x y z)</tt>.
</p><p>
Every list, and more generally cons cell tree structure, can be written
in a "fully dotted" notation, such that there are as many dots as there
are cells. For instance the cons structure of the nested list
<tt>(1 (2) (3 4 (5)))</tt>
can be made more explicit using
<tt>(1 . ((2 . nil) . ((3 . (4 . ((5 . nil) . nil))) . nil))))</tt>.
The structure contains eight conses, and so there are eight dots
in the fully dotted notation.
</p><p>
The number of conses in a linear list like
<tt>(1 2 3)</tt>
is simply the number of items, so that list in particular is
made of three conses. Additional nestings require additional conses,
so for instance
<tt>(1 2 (3))</tt>
requires four conses. A visual way to count the conses from the printed
representation is to count the atoms, then add the count of open parenthese=
s,
and finally subtract one.
</p><p>
A list terminated by an atom other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is called an improper
list, and the dot notation is extended to cover improper lists.
For instance
<tt>(1 2 . 3)</tt>
is an improper list of two elements,
terminated by
<tt>3</tt>,
and can be constructed using
<tt>(cons 1 (cons 2 3))</tt>.
The fully dotted notation for this list is
<tt>(1 . (2 . 3))</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0076C7BE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.2">9.10.2</a=
> Function <tt>atom</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(atom </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a><=
/tt>
function tests whether
<tt><i>value</i></tt>
is an atom. It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if this is the
case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise.  All values which are not cons cells are atoms.
</p><p>
<tt>(atom x)</tt>
is equivalent to
<tt>(not (consp x))</tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
76C7BE">atom</a> 3) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a> 1 2)=
) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a> "=
abc") -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a> '=
(3)) -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01B94132">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.3">9.10.3</a=
> Function <tt>consp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(consp </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B94132">consp</a>=
</tt>
function tests whether
<tt><i>value</i></tt>
is a cons.  It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if this is the
case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise.
</p><p>
<tt>(consp x)</tt>
is equivalent to
<tt>(not (atom x))</tt>.
</p><p>
Non-empty lists test positive under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B94132">consp</a>=
</tt>
because a list is represented as a reference to the first cons in a chain o=
f
one or more conses.
</p><p>
Note that a lazy cons is a cons and satisfies the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B94132">consp</a>=
</tt>
test.  See the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>
and the macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
B94132">consp</a> 3) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B94132">consp</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a> 1 2=
)) -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B94132">consp</a> =
"abc") -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B94132">consp</a> =
'(3)) -&gt; t
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02D60463">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.4">9.10.4</a=
> Accessors <tt>car</tt> and <tt>first</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(car </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(first </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (car </tt><tt><i>object</i></tt><tt>) </tt><tt><i>new-=
value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (first </tt><tt><i>object</i></tt><tt>) </tt><tt><i>ne=
w-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</a>=
</tt>
are synonyms.
</p><p>
If
<tt><i>object</i></tt>
is a cons cell, these functions retrieve the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of that cons cell.
<tt>(car (cons 1 2))</tt>
yields
<tt>1</tt>.
</p><p>
For programming convenience,
<tt><i>object</i></tt>
may be of several other kinds in addition to conses.
</p><p>
<tt>(car nil)</tt>
is allowed, and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<tt><i>object</i></tt>
may also be a vector or a string. If it is an empty vector or
string, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. Otherwise the first character of the string or
first element of the vector is returned.
</p><p>
<tt><i>object</i></tt>
may be a structure. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
operation is possible if the object has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
method. If so,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
invokes that method and returns whatever the method returns.
If the structure has no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
method, but has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function calls that method with one argument, that being
the integer zero. Whatever the method returns,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
returns. If neither method is defined, an error
exception is thrown.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
form denotes a valid place whenever
<tt><i>object</i></tt>
is a valid argument for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
function. Modifying the place denoted by the form is equivalent to invoking
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
with
<tt><i>object</i></tt>
as the left argument, and the replacement value as the right
argument. It takes place in the manner given under the description
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
function, and obeys the same restrictions.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
form supports deletion. The following equivalence
then applies:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
41">del</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car<=
/a> place)) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-017F39D2">pop</a> place)
</tt></pre><tt>

</tt>

<p>
This implies that deletion requires the argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
form to be a place, rather than the whole form itself.
In this situation, the argument place may have a value
which is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop</a></=
tt>
is defined on an empty list.
</p><p>
The abstract concept behind deleting a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
is that physically deleting this field from a cons,
thereby breaking it in half, would result in just the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
remaining. Though fragmenting a cons in this manner is impossible,
deletion simulates it by replacing the place which previously held the
cons, with that cons'
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field. This semantics happens to coincide with deleting the first element
of a list by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop</a></=
tt>
operation.
</p><p>

</p></dd></dl>
<a name=3D"N-02288559">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.5">9.10.5</a=
> Accessors <tt>cdr</tt> and <tt>rest</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cdr </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rest </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (cdr </tt><tt><i>object</i></tt><tt>) </tt><tt><i>new-=
value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (rest </tt><tt><i>object</i></tt><tt>) </tt><tt><i>new=
-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02288559">rest</a><=
/tt>
are synonyms.
</p><p>
If
<tt><i>object</i></tt>
is a cons cell, these functions retrieve the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of that cons cell.
<tt>(cdr (cons 1 2))</tt>
yields
<tt>2</tt>.
</p><p>
For programming convenience,
<tt><i>object</i></tt>
may be of several other kinds in addition to conses.
</p><p>
<tt>(cdr nil)</tt>
is allowed, and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
<tt><i>object</i></tt>
may also be a vector or a string. If it is a non-empty string or vector
containing at least two items, then the remaining part of the object is
returned, with the first element removed. For example
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> "abc")
</tt>

yields
<tt>"bc"</tt>.
If
<tt><i>object</i></tt>
is is a one-element vector or string, or an empty vector or string,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. Thus
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> "a")
</tt>

and
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> "")
</tt>

both result in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>object</i></tt>
is a structure, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
requires it to support either the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
method or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method. If both are present,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is used. When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
function uses the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
method, it invokes it with no arguments.
Whatever value the method returns becomes the
return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
invokes a structure's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method, it passes as the argument the range object
<tt>#R(1 t)</tt>.
Whatever the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method returns becomes the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
</p><p>
The invocation syntax of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02288559">rest</a><=
/tt>
form is a syntactic place.
The place is semantically correct if
<tt><i>object</i></tt>
is a valid argument for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
function. Modifying the place denoted by the form is equivalent to invoking
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
with
<tt><i>object</i></tt>
as the left argument, and the replacement value as the right
argument. It takes place in the manner given under the description
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
function, and obeys the same restrictions.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
place supports deletion, according to the following near equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
41">del</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr<=
/a> place)) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-03F7A8B8">prog1</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
069">cdr</a> place)
                                (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#D-002F">set</a> place (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-0043">car</a> place)))
</tt></pre><tt>

</tt>

<p>
The
<tt>place</tt>
expression is evaluated only once.
</p><p>
Note that this is symmetric with the delete semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
in that the cons stored in
<tt>place</tt>
goes away, as does the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field, leaving just the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
which takes the place of the original cons.
</p><p>
</p></dd><dt></dt><dd>
<p>


Example:
</p><p>
Walk every element of the list
<tt>(1 2 3)</tt>
using a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a></=
tt>
loop:
</p><p>
<tt>
</tt></p><pre><tt>    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
031372ED">for</a> ((i '(1 2 3))) (i) ((set i (<a href=3D"http://nongnu.org/=
txr/txr-manpage.html#D-0069">cdr</a> i)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> i) *stdo=
ut*)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a> =
#\newline *stdout*))
</tt></pre><tt>

</tt>

<p>
The variable
<tt>i</tt>
marches over the cons cells which make up the "backbone"
of the list. The elements are retrieved using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function.
Advancing to the next cell is achieved using
<tt>(cdr i)</tt>.
If
<tt>i</tt>
is the
last cell in a (proper) list,
<tt>(cdr i)</tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and so
<tt>i</tt>
becomes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the loop guard expression
<tt>i</tt>
fails and the loop terminates.
</p><p>

</p></dd></dl>
<a name=3D"N-0276905F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.6">9.10.6</a=
> Functions <tt>rplaca</tt> and <tt>rplacd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rplaca </tt><tt><i>object</i></tt><tt> </tt><tt><i>new-car=
-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rplacd </tt><tt><i>object</i></tt><tt> </tt><tt><i>new-cdr=
-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt>object</tt>
is a cons cell or lazy cons cell, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
functions assign new values into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields of the
<tt><i>object</i></tt>.
In addition, these functions are meaningful for other kinds of objects also=
.
</p><p>
Note that, except for the difference in return value,
<tt>(rplaca x y)</tt>
is the same as the more generic
<tt>(set (car x) y)</tt>,
and likewise
<tt>(rplacd x y)</tt>
can be written as
<tt>(set (cdr x) y)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
functions return
<tt><i>cons</i></tt>.
Note: <b>TXR</b> versions 89 and earlier, these functions returned the new =
value.
The behavior was undocumented.
</p><p>
The
<tt><i>cons</i></tt>
argument does not have to be a cons cell. Both functions support meaningful
semantics for vectors and strings.  If
<tt><i>cons</i></tt>
is a string, it must be modifiable.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
function replaces the first element of a vector or first character
of a string. The vector or string must be at least one element long.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
function replaces the suffix of a vector or string after the first element
with a new suffix. The
<tt><i>new-cdr-value</i></tt>
must be a sequence, and if the suffix of a string is being replaced,
it must be a sequence of characters. The suffix here refers to the portion =
of
the vector or string after the first element.
</p><p>
It is permissible to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
on an empty string or vector. In this case,
<tt><i>new-cdr-value</i></tt>
specifies the contents of the entire string or vector, as if the operation
were done on a non-empty vector or string, followed by the deletion of the
first element.
</p><p>
The
<tt><i>object</i></tt>
argument may be a structure. In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>,
the structure must have a defined
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
method or else, failing that, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method. The first of these methods which is available, in the given order, =
is
used to perform the operation.  Whatever the respective method returns,
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method is used, it is called with two arguments (in addition to
<tt>object</tt>):
the integer zero, and
<tt><i>new-car-value</i></tt>.
</p><p>
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>,
the structure must have a defined
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
method or else, failing that, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method. The first of these methods which is available, in the given order, =
is
used to perform the operation.  Whatever the respective method returns,
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method is used, it is called with two arguments (in addition to
<tt>object</tt>):
the range value
<tt>#R(1 t)</tt>
and
<tt><i>new-car-value</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01B0FA33">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.7">9.10.7</a=
> Accessors <tt>second</tt>, <tt>third</tt>, <tt>fourth</tt>, <tt>fifth</tt=
>, <tt>sixth</tt>, <tt>seventh</tt>, <tt>eighth</tt>, <tt>ninth</tt> and <t=
t>tenth</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(first </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(second </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(third </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(fourth </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(fifth </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(sixth </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(seventh </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(eighth </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(ninth </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(tenth </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (first </tt><tt><i>object</i></tt><tt>) </tt><tt><i>ne=
w-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (second </tt><tt><i>object</i></tt><tt>) </tt><tt><i>n=
ew-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;...=20




<br>&nbsp;&nbsp;(set (tenth </tt><tt><i>object</i></tt><tt>) </tt><tt><i>ne=
w-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Used as functions, these accessors retrieve the elements of a sequence by
position.  If the sequence is shorter than implied by the position, these
functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
When used as syntactic places, these accessors denote the storage locations
by position. The location must exist, otherwise an error exception results.
The places support deletion.
</p><p>
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
B0FA33">third</a> '(1 2)) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">second</a>=
 "ab") -&gt; #\b
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">third</a> =
'(1 2 . 3)) -&gt; **error, improper list*

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a> "=
abcd")))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B0FA33">third</a> x)=
)
    x) -&gt; "abce"
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0014162F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.8">9.10.8</a=
> Functions <tt>append</tt> and <tt>nconc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(append [</tt><tt><i>sequence</i></tt><tt>*])=20




<br>&nbsp;&nbsp;(nconc [</tt><tt><i>sequence</i></tt><tt>*])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>
function creates a new object which is a catenation of the
<tt><i>list</i></tt>
arguments. All arguments are optional;
<tt>(append)</tt>
produces the empty list, and if
a single argument is specified, that argument
is returned.
</p><p>
If two or more arguments are present, then the situation
is identified as one or more
<tt><i>sequence</i></tt>
arguments followed by
<tt><i>last-arg</i></tt>.
The
<tt><i>sequence</i></tt>
arguments must be sequences;
<tt><i>last-arg</i></tt>
may be a sequence or atom.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>
operation over three or more arguments is left-associative, such that
<tt>(append x y z)</tt>
is equivalent to both
<tt>(append (append x y) z)</tt>
and
<tt>(append x (append z y))</tt>.
</p><p>
This allows the catenation of an arbitrary number of arguments
to be understood in terms of a repeated application of the two-argument
case, whose semantics is given by these rules:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
catenates with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to produce
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> nil nil) -&gt; nil
</pre>

</tt>

</dd><dt>2.</dt><dd>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
catenates with a proper or improper list, producing that list itself:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> nil '(1 2)) -&gt; (1 2)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 nil '(1 2 . 3)) -&gt; (1 2 . 3)
</pre>

</tt>

</dd><dt>3.</dt><dd>
A proper list catenates with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
producing that list itself:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> '(1 2) nil) -&gt; (1 2)
</pre>

</tt>

</dd><dt>4.</dt><dd>
A proper list catenates with an atom,
producing an improper list terminated by that atom,
whether or not that atom is a sequence:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> '(1 2) #(3)) -&gt; (1 2 . #(3))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 2) 3) -&gt; (1 2 . 3)
</pre>

</tt>

</dd><dt>5.</dt><dd>
A non-list sequence catenates with another sequence into a sequence,
producing a sequence which contains the elements of both,
of the same kind as the left sequence. The elements must be
compatible; a string can only catenate with a sequence of characters.
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> #(1 2) #(3 4)) -&gt; #(1 2 3 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 "ab" "cd") -&gt; "abcd"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 "ab" #(#\c #\d)) -&gt; "abcd"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 "ab" #(3 4)) -&gt; ;; error
</pre>

</tt>

</dd><dt>6.</dt><dd>
A non-list sequence catenates with an atom if it is a suitable element
type for that kind of sequence. The resulting sequence is of the same
kind, and includes that atom:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> #(1 2) 3) -&gt; #(1 2 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 "ab" #) -&gt; "abc"  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0014162F">append</a> "ab" 3) -&gt; ;; error
</pre>

</tt>

</dd><dt>7.</dt><dd>
If an improper list is catenated with any object, the catenation
takes place between the terminating atom of that list and that object. This
requires the terminating atom to be a sequence.  If the catenation is possi=
ble,
then the result is a new improper list which is a copy of the original, but
with the terminating atom replaced by a catenation of that atom and the obj=
ect:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> '(1 2 . "ab") "c") -&gt; (1 2 . "abc")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 2 . "ab") '(2 3)) -&gt; ;; error
</pre>

</tt>

</dd><dt>8.</dt><dd>
A non-sequence atom doesn't catenate; the situation is erroneous:
<tt>
<pre>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">appen=
d</a> 1 2) -&gt; ;; error
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 . 2) 3) -&gt; ;; error
</pre>

</tt>

</dd></dl>
</dl>
<p>

If N arguments are specified, where N &gt; 1, then the first N-1 arguments =
must be
proper lists. Copies of these lists are catenated together. The last argume=
nt
N, shown in the above syntax as
<tt><i>last-arg</i></tt>,
may be any kind of object. It is
installed into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of the last cons cell of the resulting list.
Thus, if argument N is also a list, it is catenated onto the resulting list=
,
but without being copied. Argument N may be an atom other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>;
in that case
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>
produces an improper list.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">nconc</a>=
</tt>
function works like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>,
but may destructively manipulate any of the input objects.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; An atom is returned.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 3) -&gt; 3

  ;; A list is also just returned: no copying takes place.
  ;; The eq function can verify that the same object emerges
  ;; from append that went in.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
list '(1 2 3)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a> li=
st) list)) -&gt; t

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 2 3) '(4 5 6) 7) -&gt; '(1 2 3 4 5 6 . 7))

  ;; the (4 5 6) tail of the resulting list is the original
  ;; (4 5 6) object, shared with that list.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 2 3) '(4 5 6)) -&gt; '(1 2 3 4 5 6)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 nil) -&gt; nil

  ;; (1 2 3) is copied: it is not the last argument
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 2 3) nil) -&gt; (1 2 3)

  ;; empty lists disappear
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 nil '(1 2 3) nil '(4 5 6)) -&gt; (1 2 3 4 5 6)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 nil nil nil) -&gt; nil

  ;; atoms and improper lists other than in the last position
  ;; are erroneous
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(a . b) 3 '(1 2 3)) -&gt; **error**

  ;; sequences other than lists can be catenated.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 "abc" "def" "g" #\h) -&gt; "abcdefgh"

  ;; lists followed by non-list sequences end with non-list
  ;; sequences catenated in the terminating atom:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a>=
 '(1 2) '(3 4) "abc" "def") -&gt; (1 2 3 4 . "abcdef")
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01143C2A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.9">9.10.9</a=
> Function <tt>append*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(append* [</tt><tt><i>list</i></tt><tt>*])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01143C2A">append*</=
a></tt>
function lazily catenates lists.
</p><p>
If invoked with no arguments, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If invoked with a single argument, it returns that argument.
</p><p>
Otherwise, it returns a lazy list consisting of the elements of every
<tt><i>list</i></tt>
argument from left to right.
</p><p>
Arguments other than the last are treated as lists, and traversed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
functions to visit their elements.
</p><p>
The last argument isn't traversed: rather, that object itself becomes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of the last cons cell of the lazy list constructed from the
previous arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-012FF2DC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.10">9.10.10<=
/a> Functions <tt>revappend</tt> and <tt>nreconc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(revappend </tt><tt><i>list1</i></tt><tt> </tt><tt><i>list2=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(nreconc </tt><tt><i>list1</i></tt><tt> </tt><tt><i>list2</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012FF2DC">revappend=
</a></tt>
function returns a list consisting of
<tt>list2</tt>
appended to a reversed copy of
<tt><i>list1</i></tt>.
The returned object shares structure
with
<tt><i>list2</i></tt>,
which is unmodified.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012FF2DC">nreconc</=
a></tt>
function behaves similarly, except
that the the returned object may share
structure with not only
<tt><i>list2</i></tt>
but also
<tt><i>list1</i></tt>,
which is modified.
</p><p>

</p></dd></dl>
<a name=3D"N-0206CE91">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.11">9.10.11<=
/a> Function <tt>list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(list </tt><tt><i>value</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
function creates a new list, whose elements are the
argument values.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
06CE91">list</a>) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> 1=
) -&gt; (1)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> '=
a 'b) -&gt; (a b)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03593DE9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.12">9.10.12<=
/a> Function <tt>list*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(list* </tt><tt><i>value</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a>=
</tt>
function is a generalization of cons. If called with exactly
two arguments, it behaves exactly like cons:
<tt>(list* x y)</tt>
is identical to
<tt>(cons x y)</tt>.
If three or more arguments are specified,
the leading arguments specify additional atoms to be consed to the
front of the list. So for instance
<tt>(list* 1 2 3)</tt>
is the same as
<tt>(cons 1 (cons 2 3))</tt>
and produces the improper list
<tt>(1 2 . 3)</tt>.
Generalizing in the other direction,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a>=
</tt>
can be called with just
one argument, in which case it returns that argument, and
can also be called with no arguments in which case it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
593DE9">list*</a>) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a> =
1) -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a> =
'a 'b) -&gt; (a . b)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a> =
'a 'b 'c) -&gt; (a b . c)
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


Note that unlike in some other Lisp dialects, the effect
of
<tt>(list* 1 2 x)</tt>
can also be obtained using
<tt>(list 1 2 . x)</tt>.
However,
<tt>(list* 1 2 (func 3))</tt>
cannot be rewritten as
<tt>(list 1 2 . (func 3))</tt>
because the latter is equivalent to
<tt>(list 1 2 func 3)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-038E3E1D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.13">9.10.13<=
/a> Accessor <tt>sub-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sub-list </tt><tt><i>list</i></tt><tt> [</tt><tt><i>from</=
i></tt><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(set (sub-list </tt><tt><i>list</i></tt><tt> [</tt><tt><i>f=
rom</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]]) </tt><tt><i>new-value</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E3E1D">sub-list<=
/a></tt>
function has the same parameters and semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
function, except that it operates on its
<tt><i>list</i></tt>
argument using list operations, and assumes that
<tt><i>list</i></tt>
it is terminated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E3E1D">sub-list<=
/a></tt>
form is used as a place, then the
<tt><i>list</i></tt>
argument form must also be a place.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E3E1D">sub-list<=
/a></tt>
place denotes a subrange of
<tt><i>list</i></tt>
as if it were a storage location. The previous value of this location,
if needed, is fetched by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E3E1D">sub-list<=
/a></tt>.
Storing
<tt><i>new-value</i></tt>
to the place is performed by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E43DA2">replace-l=
ist</a></tt>.
The return value of
<tt><i>replace-list</i></tt>
is stored into
<tt><i>list</i></tt>.
In an update operation which accesses the prior value and stores a new valu=
e,
the arguments
<tt><i>list</i></tt>,
<tt><i>from</i></tt>,
<tt><i>to</i></tt>
and
<tt><i>new-value</i></tt>
are evaluated once.
</p><p>

</p></dd></dl>
<a name=3D"N-03E43DA2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.14">9.10.14<=
/a> Function <tt>replace-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(replace-list </tt><tt><i>list</i></tt><tt> </tt><tt><i>ite=
m-sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to</i><=
/tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E43DA2">replace-l=
ist</a></tt>
function is like the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function, except that it operates on its
<tt><i>list</i></tt>
argument using list operations. It assumes that
<tt><i>list</i></tt>
it is terminated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and that it is made of cells which can be mutated using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>.
</p><p>

</p></dd></dl>
<a name=3D"N-03F70343">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.15">9.10.15<=
/a> Functions <tt>listp</tt> and <tt>proper-list-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(listp </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(proper-list-p </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">listp</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">proper-li=
st-p</a></tt>
functions test, respectively, whether
<tt><i>value</i></tt>
is a list, or a proper list, and return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
accordingly.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">listp</a>=
</tt>
test is weaker, and executes without having to traverse
the object.
The value produced by the expression
<tt>(listp x)</tt>
is the same as that of
<tt>(or (null x) (consp x))</tt>,
except that
<tt>x</tt>
is evaluated only once.
The empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is a list, and a cons cell is a list.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">proper-li=
st-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
only for proper lists.  A proper list is
either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
or a cons whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is a proper list.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">proper-li=
st-p</a></tt>
traverses the
list, and its execution will not terminate if the list is circular.
</p><p>
These functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for list-like sequences that are not made of actual
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells.
</p><p>
Dialect Note: in <b>TXR</b> 137 and older,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">proper-li=
st-p</a></tt>
is called
<tt>proper-listp</tt>.
The name was changed for adherence to conventions and compatibility with ot=
her
Lisp dialects, like Common Lisp. However, the function continues to be
available under the old name. Code that must run on <b>TXR</b> 137 and olde=
r
installations should use
<tt>proper-listp</tt>,
but its use going forward is deprecated.
</p><p>

</p></dd></dl>
<a name=3D"N-00C6C858">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.16">9.10.16<=
/a> Function <tt>endp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(endp </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6C858">endp</a><=
/tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>object</i></tt>
is a cons cell, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6C858">endp</a><=
/tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6C858">endp</a><=
/tt>
function throws an exception.
</p><p>

</p></dd></dl>
<a name=3D"N-01F8186A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.17">9.10.17<=
/a> Function <tt>length-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length-list </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F8186A">length-li=
st</a></tt>
function returns the length of
<tt><i>list</i></tt>,
which may be
a proper or improper list. The length of a list is the number of conses in =
that
list.
</p><p>

</p></dd></dl>
<a name=3D"N-006ED237">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.18">9.10.18<=
/a> Function <tt>copy-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-list </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006ED237">copy-list=
</a></tt>
function which returns a list similar to
<tt><i>list</i></tt>,
but with
a newly allocated cons cell structure.
</p><p>
If
<tt><i>list</i></tt>
is an atom, it is simply returned.
</p><p>
Otherwise,
<tt><i>list</i></tt>
is a cons cell, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006ED237">copy-list=
</a></tt>
returns the same object as the expression
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> </tt><tt><i=
>list</i></tt><tt>) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
6ED237">copy-list</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0069">cdr</a> </tt><tt><i>list</i></tt><tt>))).=20

</tt>

</p><p>
Note that the object
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> </tt><tt=
><i>list</i></tt><tt>)=20

</tt>

is not deeply copied, but only
propagated by reference into the new list.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006ED237">copy-list=
</a></tt>
produces
a new list structure out of the same items that are in
<tt><i>list</i></tt>.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


Common Lisp does not allow the argument to be an atom, except
for the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-037EBB77">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.19">9.10.19<=
/a> Function <tt>copy-cons</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-cons </tt><tt><i>cons</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037EBB77">copy-cons=
</a></tt>
function creates and returns a new object that is a replica of
<tt><i>cons</i></tt>.
</p><p>
The
<tt><i>cons</i></tt>
argument must be either a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell, or else a lazy cons: an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>.
</p><p>
A new cell of the same type as
<tt><i>cons</i></tt>
is created, and all of its fields are initialized by
copying the corresponding fields from
<tt><i>cons</i></tt>.
</p><p>
If
<tt><i>cons</i></tt>
is lazy, the newly created object is in the same
state as the original. If the original has not yet been updated
and thus has an update function, the copy also has not yet been
updated and has the same update function.
</p><p>

</p></dd></dl>
<a name=3D"N-015EB85E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.20">9.10.20<=
/a> Function <tt>copy-tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-tree </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015EB85E">copy-tree=
</a></tt>
function returns a copy of
<tt><i>obj</i></tt>
which represents an arbitrary
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>-cell-based
structure.
</p><p>
The cell structure of
<tt><i>obj</i></tt>
is traversed and a similar structure is constructed, but without regard for
substructure sharing or circularity.
</p><p>
More precisely, if
<tt><i>obj</i></tt>
is an atom, then it is returned.
If it is an ordinary
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015EB85E">copy-tree=
</a></tt>
is recursively applied to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields to produce their individual replicas. A new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell is then produced from the replicated
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>.
If
<tt><i>obj</i></tt>
is a lazy
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>,
then just like in the ordinary
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
case, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields are duplicated with a recursive call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015EB85E">copy-tree=
</a></tt>.
Then, a lazy
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
is created from these replicated fields. If
<tt><i>cell</i></tt>
has an update function, then the newly created lazy
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
has the same update function; the function isn't copied.
</p><p>
Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037EBB77">copy-cons=
</a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015EB85E">copy-tree=
</a></tt>
function doesn't trigger the update of lazy conses.
The copies of lazy conses which have not been updated
are also conses which have not been updated.
</p><p>

</p></dd></dl>
<a name=3D"N-03D8471B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.21">9.10.21<=
/a> Functions <tt>reverse</tt> and <tt>nreverse</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(reverse </tt><tt><i>list</i></tt><tt>)=20




<br>&nbsp;&nbsp;(nreverse </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Description:
</p><p>
The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">reverse</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">nreverse<=
/a></tt>
produce an object which contains
the same items as proper list
<tt><i>list</i></tt>,
but in reverse order.
If
<tt><i>list</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then both functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">reverse</=
a></tt>
function is non-destructive: it creates a new list.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">nreverse<=
/a></tt>
function creates the structure of the reversed list out of the
cons cells of the input list, thereby destructively altering it (if it cont=
ains
more than one element). How
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">nreverse<=
/a></tt>
uses the material from the original list
is unspecified. It may rearrange the cons cells into a reverse order, or it=
 may
keep the structure intact, but transfer the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
values among cons cells into
reverse order.  Other approaches are possible.
</p><p>

</p></dd></dl>
<a name=3D"N-02FC66FA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.22">9.10.22<=
/a> Accessor <tt>nthlast</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(nthlast </tt><tt><i>index</i></tt><tt> </tt><tt><i>list</i=
></tt><tt>)=20




<br>&nbsp;&nbsp;(set (nthlast </tt><tt><i>index</i></tt><tt> </tt><tt><i>li=
st</i></tt><tt>) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FC66FA">nthlast</=
a></tt>
function retrieves the n-th last cons cell of a list,
indexed from one.
The
<tt><i>index</i></tt>
parameter must be a an integer. If
<tt><i>index</i></tt>
is positive and so large that it specifies a nonexistent cons beyond the
beginning of the list,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FC66FA">nthlast</=
a></tt>
returns
<tt><i>list</i></tt>.
Effectively, values of
<tt><i>index</i></tt>
larger than the length of the list are clamped to the length.
If
<tt><i>index</i></tt>
is negative, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FC66FA">nthlast</=
a></tt>
yields nil. An
<tt><i>index</i></tt>
value of zero retrieves the terminating atom of
<tt><i>list</i></tt>
or else the value
<tt><i>list</i></tt>
itself, if
<tt><i>list</i></tt>
is an atom.
</p><p>
The following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
FC66FA">nthlast</a> 1 list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#D-007A">last</a> list)
</tt></pre><tt>

</tt>

<p>
An
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FC66FA">nthlast</=
a></tt>
place designates the storage location which holds the n-th cell,
as indicated by the value of
<tt><i>index</i></tt>.
</p><p>
A negative
<tt><i>index</i></tt>
doesn't denote a place.
</p><p>
A positive
<tt><i>index</i></tt>
greater than the length of the list is treated as if it were
equal to the length of the list.
</p><p>
If
<tt><i>list</i></tt>
is itself a syntactic place, then the
<tt><i>index</i></tt>
value
<i>n</i>

is permitted for a list of length
<i>n</i>.

This index value denotes the
<tt><i>list</i></tt>
place itself.  Storing to this value overwrites
<tt><i>list</i></tt>.
If
<tt><i>list</i></tt>
isn't a syntactic place, then storing to position
<i>n</i>

isn't permitted.
</p><p>
If
<tt><i>list</i></tt>
is is of length zero, or an atom (in which case its
length is considered to be zero) then the above
remarks about position
<i>n</i>

apply to an
<tt><i>index</i></tt>
value of zero: if
<tt><i>list</i></tt>
is a syntactic place, then the position denotes
<tt><i>list</i></tt>
itself, otherwise the position doesn't exist as a place.
</p><p>
If
<tt><i>list</i></tt>
contains one or more elements, then
<tt><i>index</i></tt>
value of zero denotes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of its last cons cell. Storing a value to this
place overwrites the terminating atom.
</p><p>

</p></dd></dl>
<a name=3D"N-01E2C334">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.23">9.10.23<=
/a> Accessor <tt>butlastn</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(butlastn </tt><tt><i>num</i></tt><tt> </tt><tt><i>list</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(set (butlastn </tt><tt><i>num</i></tt><tt> </tt><tt><i>lis=
t</i></tt><tt>) new-value )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">butlastn<=
/a></tt>
function calculates that initial portion of
<tt><i>list</i></tt>
which excludes the last
<tt><i>num</i></tt>
elements.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">butlastn<=
/a></tt>
function doesn't support non-list sequences as sequences;
it treats them as the terminating atom of a zero-length improper list.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">butlast</=
a></tt>
sequence function supports non-list sequences. If
<tt>x</tt>
is a list, then the following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
E2C334">butlastn</a> n x)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#N-026BB6FA">butlast</a> x n)
</tt></pre><tt>

</tt>

<p>
If
<tt><i>num</i></tt>
is zero, or negative, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">butlastn<=
/a></tt>
returns
<tt><i>list</i></tt>.
</p><p>
If
<tt><i>num</i></tt>
is positive, and meets or exceeds the length of
<tt><i>list</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">butlastn<=
/a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">butlastn<=
/a></tt>
form is used as a syntactic place, then
<tt><i>list</i></tt>
must be a place. Assigning to the form causes
<tt><i>list</i></tt>
to be replaced with a new list which is a catenation
of the new value and the last
<tt><i>num</i></tt>
elements of the original list, according to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">=
butlastn</a> n x) v)

  &lt;--&gt;

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> x (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a> v (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#N-02FC66FA">nthlast</a> n x))=
) v)
</tt></pre><tt>

</tt>

<p>
except that
<tt>n</tt>,
<tt>x</tt>
and
<tt>v</tt>
are evaluated only once, in left-to-right order.
</p><p>

</p></dd></dl>
<a name=3D"N-0039F3FB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.24">9.10.24<=
/a> Accessor <tt>nth</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(nth </tt><tt><i>index</i></tt><tt> </tt><tt><i>object</i><=
/tt><tt>)=20




<br>&nbsp;&nbsp;(set (nth </tt><tt><i>index</i></tt><tt> </tt><tt><i>object=
</i></tt><tt>) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0039F3FB">nth</a></=
tt>
function performs random access on a list, retrieving the n-th
element indicated by the zero-based index value given by
<tt><i>index</i></tt>.
The
<tt><i>index</i></tt>
argument must be a non-negative integer.
</p><p>
If
<tt><i>index</i></tt>
indicates an element beyond the end of the list, then
the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
39F3FB">nth</a> 0 list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-0043">car</a> 0) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-02D60463">first</a> list)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0039F3FB">nth</a> 1 =
list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209=
CEE">cadr</a> list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-01B0FA33">second</a> list)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0039F3FB">nth</a> 2 =
list) &lt;--&gt; (caddr list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-01B0FA33">third</a> list)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0039F3FB">nth</a> x =
y) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">ca=
r</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr=
</a> x y))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03D71D22">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.25">9.10.25<=
/a> Accessor <tt>nthcdr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(nthcdr </tt><tt><i>index</i></tt><tt> </tt><tt><i>list</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(set (nthcdr </tt><tt><i>index</i></tt><tt> </tt><tt><i>lis=
t</i></tt><tt>) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a=
></tt>
function retrieves the n-th cons cell of a list, indexed from zero.
The
<tt><i>index</i></tt>
parameter must be a non-negative integer. If
<tt><i>index</i></tt>
specifies a nonexistent cons beyond the end of the list,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a=
></tt>
yields nil.
</p><p>
The following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
D71D22">nthcdr</a> 0 list) &lt;--&gt; list
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a>=
 1 list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
69">cdr</a> list)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a>=
 2 list) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
209CEE">cddr</a> list)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a> x y)) &=
lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0039F3FB">nt=
h</a> x y)
</tt></pre><tt>

</tt>

<p>
An
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a=
></tt>
place designates the storage location which holds the n-th cell,
as indicated by the value of
<tt><i>index</i></tt>.
Indices beyond the last cell of
<tt><i>list</i></tt>
do not designate a valid place.
If
<tt><i>list</i></tt>
is itself a place, then the zeroth index is permitted and the
resulting place denotes
<tt><i>list</i></tt>.
Storing a value to
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a> <=
/tt><tt><i>0</i></tt><tt> </tt><tt><i>list)</i></tt><tt>=20

</tt>

overwrites
<tt><i>list</i></tt>.
Otherwise if
<tt><i>list</i></tt>
isn't a syntactic place, then the zeroth index does not designate a valid
place;
<tt><i>index</i></tt>
must have a positive value. A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a=
></tt>
place does not support deletion.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


In Common Lisp,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a=
></tt>
is only a function, not an accessor;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D71D22">nthcdr</a=
></tt>
forms do not denote places.
</p><p>

</p></dd></dl>
<a name=3D"N-00B8D7B5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.26">9.10.26<=
/a> Function <tt>tailp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tailp </tt><tt><i>object</i></tt><tt> </tt><tt><i>list)</i=
></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B8D7B5">tailp</a>=
</tt>
function tests whether
<tt><i>object</i></tt>
is a tail of
<tt><i>list</i></tt>.
This means that
<tt><i>object</i></tt>
is either
<tt><i>list</i></tt>
itself, or else one of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells of
<tt><i>list</i></tt>
or else the terminating atom of
<tt><i>list</i></tt>.
</p><p>
More formally, a recursive definition follows.
If
<tt><i>object</i></tt>
and
<tt><i>list</i></tt>
are the same object (thus equal under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
function) then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B8D7B5">tailp</a>=
</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
If
<tt><i>list</i></tt>
is an atom, and is not
<tt><i>object</i></tt>,
then the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise,
<tt><i>list</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
that is not
<tt><i>object</i></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B8D7B5">tailp</a>=
</tt>
yields the same value as the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B8D7B5">tailp</a> </=
tt><tt><i>object</i></tt><tt> (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-0069">cdr</a> </tt><tt><i>list</i></tt><tt>))=20

</tt>

expression.
</p><p>

</p></dd></dl>
<a name=3D"N-00209CEE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.27">9.10.27<=
/a> Accessors <tt>caar</tt>, <tt>cadr</tt>, <tt>cdar</tt>, <tt>cddr</tt>, <=
tt>...</tt> and <tt>cdddddr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(caar </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(cadr </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(cdar </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(cddr </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;...=20




<br>&nbsp;&nbsp;(cdddr </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (caar </tt><tt><i>object</i></tt><tt>) </tt><tt><i>new=
-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (cadr </tt><tt><i>object</i></tt><tt>) </tt><tt><i>new=
-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;...=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<i>a-d accessors</i>

provide a shorthand notation for accessing two to five
levels deep into a cons-cell-based tree structure. For instance, the
the equivalent of the nested function call expression
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> (<a href=3D"http=
://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> </tt><tt><i>object</i></=
tt><tt>)))=20

</tt>

can be achieved using the single function call
<tt>




(caadr </tt><tt><i>object</i></tt><tt>).=20

</tt>

The symbol names of the a-d accessors are a generalization of the words
"car" and "cdr". They encode the pattern of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
traversal of the structure using a sequence of the the letters
<tt>a</tt>
and
<tt>d</tt>
placed between
<tt>c</tt>
and
<tt>r</tt>.
The traversal is encoded in right-to-left order, so that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209CEE">cadr</a><=
/tt>
indicates a traversal of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
link, followed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>.
This order corresponds to the nested function call notation, which also
encodes the traversal right-to-left. The following diagram illustrates
the straightforward relationship:
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
69">cdr</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> x)))
    ^    ^    ^
    |   /     |
    |  /     /
    | / ____/
    || /
  (cdadr x)
</tt></pre><tt>

</tt>

<p>
<b>TXR Lisp</b> provides all possible a-d accessors up to five levels deep,=
 from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209CEE">caar</a><=
/tt>
all the way through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00209CEE">cdddddr</=
a></tt>.
</p><p>
Expressions involving a-d accessors are places. For example,
<tt>(caddr x)</tt>
denotes the same place as
<tt>(car (cddr x))</tt>,
and
<tt>(cdadr x)</tt>
denotes the same place as
<tt>(cdr (cadr x))</tt>.
</p><p>
The a-d accessor places support deletion, with semantics derived from
the deletion semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
places. For example,
<tt>(del (caddr x))</tt>
means the same as
<tt>(del (car (cddr x)))</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0226672B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.28">9.10.28<=
/a> Functions <tt>flatten</tt> and <tt>flatten*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flatten </tt><tt><i>list</i></tt><tt>)=20




<br>&nbsp;&nbsp;(flatten* </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a></=
tt>
function produces a list whose elements are all of the
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
atoms contained in the structure of
<tt><i>list</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0226672B">flatten*<=
/a></tt>
function
works like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a></=
tt>
except that it produces a lazy list. It can be used to lazily flatten an
infinite lazy structure.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
19">flatten</a> '(1 2 () (3 4))) -&gt; (1 2 3 4)

  ;; equivalent to previous, since
  ;; nil is the same thing as ()
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a> '(=
1 2 nil (3 4))) -&gt; (1 2 3 4)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a> ni=
l) -&gt; nil

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0019">flatten</a> '(=
((()) ()))) -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01FF2F12">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.29">9.10.29<=
/a> Functions <tt>flatcar</tt> and <tt>flatcar*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flatcar </tt><tt><i>tree</i></tt><tt>)=20




<br>&nbsp;&nbsp;(flatcar* </tt><tt><i>tree</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF2F12">flatcar</=
a></tt>
function produces a list of all the atoms contained in the
tree structure
<tt><i>tree</i></tt>,
in the order in which they appear, when the structure is traversed
left to right.
</p><p>
This list includes those
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
atoms which appear in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields.
</p><p>
The list excludes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
atoms which appear in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF2F12">flatcar*<=
/a></tt>
function
works like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF2F12">flatcar</=
a></tt>
except that it produces a lazy list. It can be used to lazily flatten an
infinite lazy structure.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
FF2F12">flatcar</a> '(1 2 () (3 4))) -&gt; (1 2 nil 3 4)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF2F12">flatcar</a=
> '(a (b . c) d (e) (((f)) . g) (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-015134D8">nil</a> . z) nil . h))

  --&gt; (a b c d e f g nil z nil h)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0149BC05">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.30">9.10.30<=
/a> Function <tt>tree-find</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-find </tt><tt><i>obj</i></tt><tt> </tt><tt><i>tree</i=
></tt><tt> </tt><tt><i>test-function</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0149BC05">tree-find=
</a></tt>
function searches
<tt><i>tree</i></tt>
for an occurrence of
<tt><i>obj</i></tt>.
Tree can be
any atom, or a cons. If
<tt><i>tree</i></tt>
it is a cons, it is understood to be a proper
list whose elements are also trees.
</p><p>
The equivalence test is performed by
<tt><i>test-function</i></tt>
which must take two
arguments, and has conventions similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0149BC05">tree-find=
</a></tt>
works as follows.  If
<tt><i>tree</i></tt>
is equivalent to
<tt><i>obj</i></tt>
under
<tt><i>test-function</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned to announce a successful finding.
If this test fails, and
<tt><i>tree</i></tt>
is an atom,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned immediately to
indicate that the find failed.  Otherwise,
<tt><i>tree</i></tt>
is taken to be a proper list,
and tree-find is recursively applied to each element of the list in turn, u=
sing
the same
<tt><i>obj</i></tt>
and
<tt><i>test-function</i></tt>
arguments, stopping at the first element
which returns a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value.
</p><p>

</p></dd></dl>
<a name=3D"N-0387CD82">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.31">9.10.31<=
/a> Functions <tt>memq</tt>, <tt>memql</tt> and <tt>memqual</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(memq </tt><tt><i>object</i></tt><tt> </tt><tt><i>list</i><=
/tt><tt>)=20




<br>&nbsp;&nbsp;(memql </tt><tt><i>object</i></tt><tt> </tt><tt><i>list</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(memqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>list</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387CD82">memq</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387CD82">memql</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387CD82">memqual</=
a></tt>
functions search
<tt><i>list</i></tt>
for a member
which is, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>object</i></tt>.
(See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
functions above.)
</p><p>
If no such element found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
Otherwise, that suffix of
<tt><i>list</i></tt>
is returned whose first element
is the matching object.
</p><p>

</p></dd></dl>
<a name=3D"N-0176FBE7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.32">9.10.32<=
/a> Functions <tt>member</tt> and <tt>member-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(member </tt><tt><i>key</i></tt><tt> </tt><tt><i>sequence</=
i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><=
tt>]])=20




<br>&nbsp;&nbsp;(member-if </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>seq=
uence</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member-if=
</a></tt>
functions search through
<tt><i>sequence</i></tt>
for an item which
matches a key, or satisfies a predicate function, respectively.
</p><p>
The
<tt><i>keyfun</i></tt>
argument specifies a function which is applied to the elements
of the sequence to produce the comparison key. If this argument is omitted,
then the untransformed elements of the sequence themselves are examined.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member</a=
></tt>
function's
<tt><i>testfun</i></tt>
argument specifies the test function which is
used to compare the comparison keys taken from the sequence to the search k=
ey.
If this argument is omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is used.
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member</a=
></tt>
does not find a matching element, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise it
returns the suffix of
<tt><i>sequence</i></tt>
which begins with the matching element.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member-if=
</a></tt>
function's
<tt><i>predfun</i></tt>
argument specifies a predicate function
which is applied to the successive comparison keys pulled from the sequence
by applying the key function to successive elements.  If no match is found,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned, otherwise what is returned is the suffix of
<tt><i>sequence</i></tt>
which begins with the matching element.
</p><p>

</p></dd></dl>
<a name=3D"N-0188A56C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.33">9.10.33<=
/a> Functions <tt>rmemq</tt>, <tt>rmemql</tt>, <tt>rmemqual</tt>, <tt>rmemb=
er</tt> and <tt>rmember-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rmemq </tt><tt><i>object</i></tt><tt> </tt><tt><i>list</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(rmemql </tt><tt><i>object</i></tt><tt> </tt><tt><i>list</i=
></tt><tt>)=20




<br>&nbsp;&nbsp;(rmemqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>list<=
/i></tt><tt>)=20




<br>&nbsp;&nbsp;(rmember </tt><tt><i>key</i></tt><tt> </tt><tt><i>sequence<=
/i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt>=
<tt>]])=20




<br>&nbsp;&nbsp;(rmember-if </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>se=
quence</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions are counterparts to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387CD82">memq</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387CD82">memql</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387CD82">memqual</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member-if=
</a></tt>
which look for the right-most
element which matches
<tt><i>object</i></tt>,
rather than for the left-most element.
</p><p>

</p></dd></dl>
<a name=3D"N-00BBCCAA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.10.34">9.10.34<=
/a> Functions <tt>conses</tt> and <tt>conses*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(conses </tt><tt><i>list</i></tt><tt>)=20




<br>&nbsp;&nbsp;(conses* </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions return a list whose elements are the conses which make
up
<tt><i>list</i></tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BBCCAA">conses*</=
a></tt>
function does this in a lazy way, avoiding the
computation of the entire list: it returns a lazy list of the conses of
<tt><i>list</i></tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BBCCAA">conses</a=
></tt>
function computes the entire list before returning.
</p><p>
The input
<tt><i>list</i></tt>
may be proper or improper.
</p><p>
The first cons of
<tt><i>list</i></tt>
is that
<tt><i>list</i></tt>
itself. The second cons is the rest
of the list, or
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> </tt><tt=
><i>list</i></tt><tt>).=20

</tt>

The third cons is
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> </tt><tt><i>list=
</i></tt><tt>))=20

</tt>

and so on.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
BBCCAA">conses</a> '(1 2 3)) -&gt; ((1 2 3) (2 3) (3))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
These functions are useful for simulating the
<tt>maplist</tt>
function found in other dialects like Common Lisp.
</p><p>
<b>TXR Lisp</b>'s
<tt>(conses x)</tt>
can be expressed in Common Lisp as
<tt>(maplist #'identity x)</tt>.
</p><p>
Conversely, the Common Lisp operation
<tt>(maplist function list)</tt>
can be computed in <b>TXR Lisp</b> as
<tt>(mapcar function (conses list))</tt>.
</p><p>
More generally, the Common Lisp operation
</p><p>
<tt>
</tt></p><pre><tt>  (maplist function list0 list1 ... listn)
</tt></pre><tt>

</tt>

<p>
can be expressed as:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> function (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-00BBCCAA">conses</a> list0)
                   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B=
BCCAA">conses</a> list1) ... (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00BBCCAA">conses</a> listn))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-02BC98A1">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11">9.11</a> As=
sociation Lists</h3>



<p>


</p><p>
Association lists are ordinary lists formed according to a special conventi=
on.
Firstly, any empty list is a valid association list. A non-empty associatio=
n
list contains only cons cells as the key elements. These cons cells are
understood to represent key/value associations, hence the name "association
list".
</p><p>

<a name=3D"N-00E9306D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.1">9.11.=
1</a> Function <tt>assoc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(assoc </tt><tt><i>key</i></tt><tt> </tt><tt><i>alist</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E9306D">assoc</a>=
</tt>
function searches an association list
<tt><i>alist</i></tt>
for a cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field is equivalent to
<tt><i>key</i></tt>
under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function.
The first such cons is returned. If no such cons is found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-00123702">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.2">9.11.2</a=
> Functions <tt>assq</tt> and <tt>assql</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(assq </tt><tt><i>key</i></tt><tt> </tt><tt><i>alist</i></t=
t><tt>)=20




<br>&nbsp;&nbsp;(assql </tt><tt><i>key</i></tt><tt> </tt><tt><i>alist</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00123702">assq</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00123702">assql</a>=
</tt>
functions are very similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E9306D">assoc</a>=
</tt>,
with the only difference being that they determine equality using,
respectively, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
functions rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-03B49598">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.3">9.11.3</a=
> Functions <tt>rassq</tt>, <tt>rassql</tt> and <tt>rassoc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rassq </tt><tt><i>value</i></tt><tt> </tt><tt><i>alist</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(rassql </tt><tt><i>value</i></tt><tt> </tt><tt><i>alist</i=
></tt><tt>)=20




<br>&nbsp;&nbsp;(rassoc </tt><tt><i>value</i></tt><tt> </tt><tt><i>alist</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassq</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassql</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassoc</a=
></tt>
functions are reverse lookup counterparts to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00123702">assql</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E9306D">assoc</a>=
</tt>.
When searching, they examine the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of the pairs of
<tt><i>alist</i></tt>
rather than the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassoc</a=
></tt>
function searches association list
<tt><i>alist</i></tt>
for a cons whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field equivalent to
<tt><i>value</i></tt>
according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function. If such a cons is found, it is returned.
Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassq</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassql</a=
></tt>
functions search in the same way as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B49598">rassoc</a=
></tt>
but compares values using, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02E9343D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.4">9.11.4</a=
> Function <tt>acons</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(acons </tt><tt><i>car</i></tt><tt> </tt><tt><i>cdr</i></tt=
><tt> </tt><tt><i>alist</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9343D">acons</a>=
</tt>
function constructs a new alist by consing a new cons to the
front of
<tt><i>alist</i></tt>.
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
E9343D">acons</a> car cdr alist) &lt;--&gt; (<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-02D6CEDA">cons</a> (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-02D6CEDA">cons</a> car cdr) alist)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0371BAFA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.5">9.11.5</a=
> Function <tt>acons-new</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(acons-new </tt><tt><i>car</i></tt><tt> </tt><tt><i>cdr</i>=
</tt><tt> </tt><tt><i>alist</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0371BAFA">acons-new=
</a></tt>
function searches
<tt><i>alist</i></tt>,
as if using the assoc function,
for an existing cell which matches the key provided by the car argument.
If such a cell exists, then its cdr field is overwritten with the
<tt><i>cdr</i></tt>
argument, and then the
<tt><i>alist</i></tt>
is returned. If no such cell exists, then
a new list is returned by adding a new cell to the input list consisting
of the
<tt><i>car</i></tt>
and
<tt><i>cdr</i></tt>
values, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9343D">acons</a>=
</tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-01E315BD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.6">9.11.6</a=
> Function <tt>aconsql-new</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(aconsql-new </tt><tt><i>car</i></tt><tt> </tt><tt><i>cdr</=
i></tt><tt> </tt><tt><i>alist</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E315BD">aconsql-n=
ew</a></tt>
function has similar same parameters and semantics as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0371BAFA">acons-new=
</a></tt>,
except that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
function is used
for equality testing. Thus, the list is searched for an existing cell
as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00123702">assql</a>=
</tt>
function rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E9306D">assoc</a>=
</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001A53C4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.7">9.11.7</a=
> Function <tt>alist-remove</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(alist-remove </tt><tt><i>alist</i></tt><tt> </tt><tt><i>ke=
ys</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001A53C4">alist-rem=
ove</a></tt>
function takes association list
<tt><i>alist</i></tt>
and produces a
duplicate from which cells matching the specified keys have been removed. T=
he
<tt><i>keys</i></tt>
argument is a list of the keys not to appear in the output list.
</p><p>

</p></dd></dl>
<a name=3D"N-000CD07F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.8">9.11.8</a=
> Function <tt>alist-nremove</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(alist-nremove </tt><tt><i>alist</i></tt><tt> </tt><tt><i>k=
eys</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CD07F">alist-nre=
move</a></tt>
function is like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001A53C4">alist-rem=
ove</a></tt>,
but potentially destructive.
The input list
<tt><i>alist</i></tt>
may be destroyed and its structural material re-used to
form the output list. The application should not retain references to the i=
nput
list.
</p><p>

</p></dd></dl>
<a name=3D"N-037A7464">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.11.9">9.11.9</a=
> Function <tt>copy-alist</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-alist </tt><tt><i>alist</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037A7464">copy-alis=
t</a></tt>
function duplicates
<tt>alist</tt>.
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006ED237">copy-list=
</a></tt>,
which only duplicates list structure,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037A7464">copy-alis=
t</a></tt>
also duplicates each cons
cell of the input alist. That is to say, each element of the output list
is produced as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037EBB77">copy-cons=
</a></tt>
function applied to the corresponding
element of the input list.
</p><p>
</p></dd></dl>
<a name=3D"N-019B9951">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.12">9.12</a> Pr=
operty Lists</h3>



<p>


A
<i>property list,</i>

also referred to as a
<i>plist</i>,

is a flat list of even length consisting of interleaved
pairs of property names (usually symbols) and their values (arbitrary
objects). An example property list is (:a 1 :b "two") which contains
two properties, :a having value 1, and :b having value "two".
</p><p>
An
<i>improper plist</i>

represents Boolean properties in a condensed way, as property
indicators which are not followed by a value. Such properties
only indicate their presence or absence, which is useful for
encoding a Boolean value. If it is absent, then the property
is false. Correctly using an improper plist requires that the
exact set of Boolean keys is established by convention.
</p><p>
In this document, the unqualified terms
<i>property list</i>

and
<i>plist</i>

refer strictly to an ordinary plist, not to an improper plist.
</p><p>
</p><dl>
<dt>Dialect Note:</dt><dd>
<p>


</p><p>
Unlike in some other Lisp dialects, including ANSI Common Lisp,
symbols do not have property lists in <b>TXR Lisp</b>. Improper plists
aren't a concept in ANSI CL.
</p><p>

</p></dd></dl>
<a name=3D"N-01C6D406">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.12.1">9.12.1</a=
> Function <tt>prop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(prop </tt><tt><i>plist</i></tt><tt> </tt><tt><i>key</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C6D406">prop</a><=
/tt>
function searches property list
<tt><i>plist</i></tt>
for key
<tt><i>key</i></tt>.
If the key is found, then the value next to it is returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
It is ambiguous whether
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned due to the property not being
found, or due to the property being present with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
value.
</p><p>
The indicators in
<tt><i>plist</i></tt>
are compared with
<tt><i>key</i></tt>
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
equality, allowing them to be symbols, characters or
<tt>fixnum</tt>
integers.
</p><p>

</p></dd></dl>
<a name=3D"N-03C6CE65">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.12.2">9.12.2</a=
> Function <tt>memp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(memp </tt><tt><i>key</i></tt><tt> </tt><tt><i>plist</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6CE65">memp</a><=
/tt>
function searches property list
<tt><i>plist</i></tt>
for key
<tt><i>key</i></tt>,
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
equality.
</p><p>
If the key is found, then the entire suffix of
<tt><i>plist</i></tt>
beginning with the indicator is returned, such that the first
element of the returned list is
<tt><i>key</i></tt>
and the second element is the property value.
</p><p>
Note the reversed argument convention relative to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C6D406">prop</a><=
/tt>
function, harmonizing with functions in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member</a=
></tt>
family.
</p><p>

</p></dd></dl>
<a name=3D"N-006E31B5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.12.3">9.12.3</a=
> Functions <tt>plist-to-alist</tt> and <tt>improper-plist-to-alist</tt></h=
4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(plist-to-alist </tt><tt><i>plist</i></tt><tt>)=20




<br>&nbsp;&nbsp;(improper-plist-to-alist </tt><tt><i>imp-plist</i></tt><tt>=
 </tt><tt><i>bool-keys</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E31B5">plist-to-=
alist</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E31B5">improper-=
plist-to-alist</a></tt>
convert, respectively, a property list and improper property
list to an association list.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E31B5">plist-to-=
alist</a></tt>
function scans
<tt><i>plist</i></tt>
and returns the indicator-property pairs as a list of cons
cells, such that each
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
is the indicator, and each
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is the value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E31B5">improper-=
plist-to-alist</a></tt>
is similar, except that it handles the Boolean properties
which, by convention, aren't followed by a value. The list of
all such indicators is specified by the
<tt>bool-keys</tt>
argument.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
6E31B5">plist-to-alist</a> '(a 1 b 2))  --&gt;  ((a . 1) (b . 2))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E31B5">improper-p=
list-to-alist</a> '(:x 1 :blue :y 2) '(:blue))
  --&gt;  ((:x . 1) (:blue) (:y . 2))
</tt></pre><tt>

</tt>

<p>
</p><p>
</p></dd></dl>
<a name=3D"N-0135C6D1">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.13">9.13</a> Li=
st Sorting</h3>



<p>


</p><p>
Note: these functions operate on lists. The principal sorting function
in <b>TXR Lisp</b> is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>,
described under Sequence Manipulation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a></tt=
>
function described here provides access to an elementary step
of the algorithm used internally by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
when operating on lists.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0132852F">multi-sor=
t</a></tt>
operation sorts multiple lists in parallel. It is implemented using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>.
</p><p>

<a name=3D"N-01093AE7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.13.1">9.13.=
1</a> Function <tt>merge</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(merge </tt><tt><i>seq1</i></tt><tt> </tt><tt><i>seq2</i></=
tt><tt> [</tt><tt><i>lessfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]=
])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0028">merge</a></tt=
>
function merges two sorted sequences
<tt><i>seq1</i></tt>
and
<tt><i>seq2</i></tt>
into a single
sorted sequence. The semantics and defaulting behavior of the
<tt><i>lessfun</i></tt>
and
<tt><i>keyfun</i></tt>
arguments are the same as those of the sort function.
</p><p>
The sequence which is returned is of the same kind as
<tt><i>seq1</i></tt>.
</p><p>
This function is destructive of any inputs that are lists. If the output
is a list, it is formed out of the structure of the input lists.
</p><p>

</p></dd></dl>
<a name=3D"N-0132852F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.13.2">9.13.2</a=
> Function <tt>multi-sort</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(multi-sort </tt><tt><i>columns</i></tt><tt> </tt><tt><i>le=
ss-funcs</i></tt><tt> [</tt><tt><i>key-funcs</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0132852F">multi-sor=
t</a></tt>
function regards a list of lists to be the columns of a
database. The corresponding elements from each list constitute a record.
These records are to be sorted, producing a new list of lists.
</p><p>
The
<tt><i>columns</i></tt>
argument supplies the list of lists which comprise the columns of
the database. The lists should ideally be of the same length. If the lists =
are
of different lengths, then the shortest list is taken to be the length of t=
he
database. Excess elements in the longer lists are ignored, and do not appea=
r in
the sorted output.
</p><p>
The
<tt><i>less-funcs</i></tt>
argument supplies a list of comparison functions which are
applied to the columns. Successive functions correspond to successive
columns. If
<tt><i>less-funcs</i></tt>
is an empty list, then the sorted database will
emerge in the original order. If
<tt><i>less-funcs</i></tt>
contains exactly one function,
then the rows of the database is sorted according to the first column. The
remaining columns simply follow their row. If
<tt><i>less-funcs</i></tt>
contains more than
one function, then additional columns are taken into consideration if the i=
tems
in the previous columns compare
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
For instance if two elements from column
one compare
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
then the corresponding second column elements are compared
using the second column comparison function.
The
<tt><i>less-funcs</i></tt>
argument may be a function object, in which case it is treated as if
it were a one-element list containing that function object.
</p><p>
The optional
<tt><i>key-funcs</i></tt>
argument supplies transformation functions through
which column entries are converted to comparison keys, similarly to the sin=
gle
key function used in the sort function and others.  If there are more key
functions than less functions, the excess key functions are ignored.
</p><p>
</p></dd></dl>
<a name=3D"N-01F26AB7">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14">9.14</a> La=
zy Lists and Lazy Evaluation</h3>



<p>



<a name=3D"N-038B9EC2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.1">9.14.=
1</a> Function <tt>make-lazy-cons</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-lazy-cons </tt><tt><i>function</i></tt><tt> [</tt><tt=
><i>car</i></tt><tt> [</tt><tt><i>cdr</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>
makes a special kind of cons cell called a lazy
cons, whose type is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>.
Lazy conses are useful for implementing lazy lists.
</p><p>
Lazy lists are lists which are not allocated all at once. Rather,
the elements of its structure materialize just before they are accessed.
</p><p>
A lazy cons has
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields like a regular cons, and those
fields are initialized to the values of the
<tt><i>car</i></tt>
and
<tt><i>cdr</i></tt>
arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>
when the lazy cons is created. These arguments default to
<tt><i>nil</i></tt>
if omitted.  A lazy cons also
has an update function, which is specified by the
<tt><i>function</i></tt>
argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>.
</p><p>
The
<tt><i>function</i></tt>
argument must be a function that may be called with exactly one
parameter.
</p><p>
When either the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields of a cons are accessed for the first time to retrieve their value,
<tt><i>function</i></tt>
is automatically invoked first, and is given the lazy cons
as a parameter. That function has the opportunity
to store new values into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields. Once the function is called, it is removed
from the lazy cons: the lazy cons no longer has an update function.
If the update function itself attempts to retrieve the value of the
lazy cons cell's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field, it will be recursively invoked.
</p><p>
The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03598F4D">lcons-car=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03598F4D">lcons-cdr=
</a></tt>
may be used to access the fields of a lazy cons without
triggering the update function.
</p><p>
Storing a value into either the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field does not have the effect of invoking the update function.
</p><p>
If the function terminates by returning normally, the access to the value o=
f
the field then proceeds in the ordinary manner, retrieving whatever value h=
as
most recently been stored.
</p><p>
The return value of the function is ignored.
</p><p>
To perpetuate the growth of a lazy list, the function can make another call=
 to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>
and install the resulting cons as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of the lazy cons.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;;; lazy list of integers between min and max
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
integer-range (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643=
">min</a> max)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((counter min))
      ;; min is greater than max; just return empty list,
      ;; otherwise return a lazy list
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (&g=
t; min max)
        nil
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make=
-lazy-cons</a>
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</=
a>)
            ;; install next number into car
            (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rpla=
ca</a> lcons counter)
            ;; now deal wit cdr field
            (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">=
cond</a>
              ;; max reached, terminate list with nil!
              ((eql counter max)
               (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">r=
placd</a> lcons nil))
              ;; max not reached: increment counter
              ;; and extend with another lazy cons
              (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8=
">t</a>
                (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AA=
BD">inc</a> counter)
                (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">=
rplacd</a> lcons
                        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-038B9EC2">make-lazy-cons</a>
                          (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-02E1BA6F">lcons-fun</a> lcons))))))))))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02E217A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.2">9.14.2</a=
> Function <tt>lconsp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lconsp </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E217A2">lconsp</a=
></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>value</i></tt>
is a lazy cons cell. Otherwise
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
even if
<tt><i>value</i></tt>
is an ordinary cons cell.
</p><p>

</p></dd></dl>
<a name=3D"N-02E1BA6F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.3">9.14.3</a=
> Function <tt>lcons-fun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lcons-fun </tt><tt><i>lazy-cons</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E1BA6F">lcons-fun=
</a></tt>
function retrieves the update function of a lazy cons.
Once a lazy cons has been accessed, it no longer has an update function
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E1BA6F">lcons-fun=
</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
While the update function of a lazy cons is
executing, it is still accessible. This allows the update function
to retrieve a reference to itself and propagate itself into
another lazy cons (as in the example under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>).
</p><p>

</p></dd></dl>
<a name=3D"N-03598F4D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.4">9.14.4</a=
> Functions <tt>lcons-car</tt> and <tt>lcons-cdr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lcons-car </tt><tt><i>lazy-cons</i></tt><tt>)=20




<br>&nbsp;&nbsp;(lcons-cdr </tt><tt><i>lazy-cons</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03598F4D">lcons-car=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03598F4D">lcons-cdr=
</a></tt>
retrieve the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields of
<tt><i>lazy-cons</i></tt>,
without triggering the invocation of its associated update function.
</p><p>
The
<tt><i>lazy-cons</i></tt>
argument must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>.
Unlike the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
These functions cannot be applied to any other type of object.
</p><p>
Note: these functions may be used by the update function to retrieve
the values which were stored into
<tt><i>lazy-cons</i></tt>
by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>
constructor, without triggering recursion. The function may then
overwrite either or both of these values.  This allows the fields of the la=
zy
cons to store state information necessary for the propagation of a lazy lis=
t.
If that state information consists of no more than two values, then
no additional context object need be allocated.
</p><p>

</p></dd></dl>
<a name=3D"N-013CC637">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.5">9.14.5</a=
> Macro <tt>lcons</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lcons </tt><tt><i>car-expression</i></tt><tt> </tt><tt><i>=
cdr-expression</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>
macro simplifies the construction of structures based on lazy conses.
Syntactically, it resembles the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
function. However, the arguments are expressions rather than values.
The macro generates code which, when evaluated, immediately produces
a lazy cons. The expressions
<tt><i>car-expression</i></tt>
and
<tt><i>cdr-expression</i></tt>
are not immediately evaluated. Rather, when either the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of the lazy cons cell is accessed, these expressions are both
evaluated at that time, in the order that they appear in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>
expression, and in the original lexical scope in which that
expression was evaluated. The return values of these expressions
are used, respectively, to initialize the corresponding fields
of the lazy cons.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>
macro may be understood in terms of the following reference
implementation, as a syntactic sugar combining the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make-lazy=
-cons</a></tt>
constructor with a lexical closure provided by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
function:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> lcons (car-form cdr-form)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((lc (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym<=
/a>)))
       ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038B9EC2">make=
-lazy-cons</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">l=
ambda</a> (,lc)
                          (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-000B">rplaca</a> ,lc ,car-form)
                          (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0013">rplacd</a> ,lc ,cdr-form)))))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Given the following function ...

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
fib-generator (a b)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a=
> a (fib-generator b (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
07C">+</a> a b))))

  ;; ... the following function call generates the Fibonacci
  ;; sequence as an infinite lazy list.

  (fib-generator 1 1) -&gt; (1 1 2 3 5 8 13 ...)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00B65D06">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.6">9.14.6</a=
> Functions <tt>lazy-stream-cons</tt> and <tt>get-lines</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lazy-stream-cons </tt><tt><i>stream</i></tt><tt>)=20




<br>&nbsp;&nbsp;(get-lines [</tt><tt><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
functions are synonyms, except that the
<tt><i>stream</i></tt>
argument is optional in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
and defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>.
Thus, the following
description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
also applies to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
returns a lazy cons which generates a lazy list based on
reading lines of text from input stream
<tt><i>stream</i></tt>,
which form the elements of
the list. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
function is called on demand to add elements to the
list.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
function itself makes the first call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
on the stream. If this returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the stream is closed and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is
returned. Otherwise, a lazy cons is returned whose update function will ins=
tall
that line into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of the lazy cons, and continue the lazy list
by making another call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>,
installing the result into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
inspects the real-time property of a stream
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0121FDEB">real-time=
-stream-p</a></tt>
function. This determines which of two
styles of lazy list are returned. For an ordinary (non-real-time) stream,
the lazy list treats the end-of-file condition accurately: an empty
file turns into the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
a one line file into a one-element
list which contains that line and so on. This accuracy requires one
line of lookahead which is not acceptable in real-time streams, and
so a different type of lazy list is used, which generates an extra
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
item after the last line. Under this type of lazy list, an empty input stre=
am
translates to the list
<tt>(nil)</tt>;
a one-line stream translates to
<tt>

("line" nil)
</tt>

and so forth.
</p><p>

</p></dd></dl>
<a name=3D"N-00DCE524">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.7">9.14.7</a=
> Macro <tt>delay</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(delay </tt><tt><i>expression</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The delay operator arranges for the delayed (or "lazy") evaluation of
<tt><i>expression</i></tt>.
This means that the expression is not evaluated immediately.
Rather, the delay expression produces a promise object.
</p><p>
The promise object can later be passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
function (described
later in this document). The force function will trigger the evaluation
of the expression and retrieve the value.
</p><p>
The expression is evaluated in the original scope, no matter where
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
takes place.
</p><p>
The expression is evaluated at most once, by the first call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>.
Additional calls to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
only retrieve a cached value.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; list is popped only once: the value is computed
  ;; just once when force is called on a given promise
  ;; for the first time.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
get-it (promise)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "*list* is ~s\n" *list*)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "item is ~s\n" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
07223D">force</a> promise))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "item is ~s\n" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
07223D">force</a> promise))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "*list* is ~s\n" *list*))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a>=
 *list* '(1 2 3))

  (get-it (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE524">de=
lay</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop<=
/a> *list*)))

  Output:

  *list* is (1 2 3)
  item is 1
  item is 1
  *list* is (2 3)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0307223D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.8">9.14.8</a=
> Accessor <tt>force</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(force </tt><tt><i>promise</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (force </tt><tt><i>promise</i></tt><tt>) </tt><tt><i>n=
ew-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
function accepts a promise object produced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE524">delay</a>=
</tt>
macro.
The first time
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
is invoked, the
<tt><i>expression</i></tt>
which was wrapped inside
<tt><i>promise</i></tt>
by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE524">delay</a>=
</tt>
macro is evaluated (in its original lexical environment, regardless of wher=
e in
the program the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
call takes place). The value of
<tt><i>expression</i></tt>
is
cached inside
<tt><i>promise</i></tt>
and returned, becoming the return value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
function call.  If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
function is invoked additional times on
the same promise, the cached value is retrieved.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
form is a syntactic place, denoting the value cache location within
<tt><i>promise</i></tt>.
</p><p>
Storing a value in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
place causes future accesses to the
<tt><i>promise</i></tt>
to return that value.
</p><p>
If the promise had not yet been forced, then
storing a value into it prevents that from ever happening. The
delayed
<tt><i>expression</i></tt>
will never be evaluated.
</p><p>
If, while a promise is being forced, the evaluation of
<tt><i>expression</i></tt>
itself causes an assignment to the promise, it is not specified whether
the promise will take on the value of
<tt><i>expression</i></tt>
or the assigned value.
</p><p>

</p></dd></dl>
<a name=3D"N-00C7553F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.9">9.14.9</a=
> Function <tt>promisep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(promisep </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C7553F">promisep<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is a promise object: an object created by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE524">delay</a>=
</tt>
macro.  Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: promise objects are conses. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F81275">typeof</a=
></tt>
function applied to a promise returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-008216E0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.10">9.14.10<=
/a> Macro <tt>mlet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mlet ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i>=
</tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i><=
/tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a><=
/tt>
macro ("magic let" or "mutual let") implements a variable binding construct
similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
</p><p>
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a><=
/tt>,
the scope of the bindings of the
<tt><i>sym</i></tt>
variables extends over the
<tt><i>init-form</i></tt>-s,
as well as the
<tt><i>body-form</i></tt>-s.
</p><p>
Unlike the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
construct, each
<tt><i>init-form</i></tt>
has each
<tt><i>sym</i></tt>
in scope. That is to say, an
<tt><i>init-form</i></tt>
can refer not only to previous variables, but also to later variables
as well as to its own variable.
</p><p>
The variables are not initialized until their values are accessed for
the first time. Any
<tt><i>sym</i></tt>
whose value is not accessed is not initialized.
</p><p>
Furthermore, the evaluation of each
<tt><i>init-form</i></tt>
does not take place until the time when its value is needed
to initialize the associated
<tt><i>sym</i></tt>.
This evaluation takes place once. If a given
<tt><i>sym</i></tt>
is not accessed during the evaluation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a><=
/tt>
construct, then its
<tt><i>init-form</i></tt>
is never evaluated.
</p><p>
The bound variables may be assigned. If, before initialization, a variable =
is
updated in such a way that its prior value is not needed, it is unspecified
whether initialization takes place, and thus whether its
<tt><i>init-form</i></tt>
is evaluated.
</p><p>
Direct circular references are erroneous and are diagnosed. This takes
place when the macro-expanded form is evaluated, not during the
expansion of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a><=
/tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Dependent calculations in arbitrary order
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a> (=
(x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> y 3))
         (z (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> x 1))
         (y 4))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> z 4)) =
 --&gt;  12

  ;; Error: circular reference:
  ;; x depends on y, y on z, but z on x again.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a> (=
(x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> y 1))
         (y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> z 1))
         (z (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> x 1)))
    z)

  ;; Okay: lazy circular reference because lcons is used
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a> (=
(list (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons<=
/a> 1 list)))
    list)  --&gt;  (1 1 1 1 1 ...) ;; circular list
</tt></pre><tt>

</tt>

<p>
In the last example, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
variable is accessed for the first time in the body of the <tt><a href=3D"h=
ttp://nongnu.org/txr/txr-manpage.html#N-008216E0">mlet</a></tt>
form. This causes the evaluation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>
form. This form evaluates its arguments lazily, which means that it
is not a problem that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
is not yet initialized. The form produces a lazy cons, which is then used
to initialize
<tt>list.</tt>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields of the lazy cons are accessed, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
expression in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013CC637">lcons</a>=
</tt>
argument is accessed. By that time, the variable is initialized
and holds the lazy cons itself, which creates the circular reference,
and a circular list.
</p><p>

</p></dd></dl>
<a name=3D"N-02F671F4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.11">9.14.11<=
/a> Functions <tt>generate</tt>, <tt>giterate</tt> and <tt>ginterate</tt></=
h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(generate </tt><tt><i>while-fun</i></tt><tt> </tt><tt><i>ge=
n-fun</i></tt><tt>)=20




<br>&nbsp;&nbsp;(giterate </tt><tt><i>while-fun</i></tt><tt> </tt><tt><i>ge=
n-fun</i></tt><tt> [</tt><tt><i>value</i></tt><tt>])=20




<br>&nbsp;&nbsp;(ginterate </tt><tt><i>while-fun</i></tt><tt> </tt><tt><i>g=
en-fun</i></tt><tt> [</tt><tt><i>value</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
function produces a lazy list which dynamically produces items
according to the following logic.
</p><p>
The arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
are functions which do not take any arguments.  The
return value of generate is a lazy list.
</p><p>
When the lazy list is accessed, for instance with the functions car and cdr=
, it
produces items on demand. Prior to producing each item,
<tt><i>while-fun</i></tt>
is
called. If it returns a true Boolean value (any value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>),
then
the
<tt><i>gen-fun</i></tt>
function is called, and its return value is incorporated as
the next item of the lazy list. But if
<tt><i>while-fun</i></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the lazy list immediately terminates.
</p><p>
Prior to returning the lazy list, generate invokes the
<tt><i>while-fun</i></tt>
one time.
If
<tt>while-fun</tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
returns the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
instead of a lazy list. Otherwise, it instantiates a lazy list, and invokes=
 the
<tt>gen-fun</tt>
to populate it with the first item.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">giterate<=
/a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>,
except that
<tt><i>while-fun</i></tt>
and
<tt><i>gen-fun</i></tt>
are functions of one argument rather than functions of
no arguments. The optional
<tt><i>value</i></tt>
argument defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and is threaded through the function calls. That is to say, the lazy
list returned is
<tt>




(</tt><tt><i>value</i></tt><tt> [</tt><tt><i>gen-fun</i></tt><tt> </tt><tt>=
<i>value</i></tt><tt>] [</tt><tt><i>gen-fun</i></tt><tt> [</tt><tt><i>gen-f=
un</i></tt><tt> </tt><tt><i>value</i></tt><tt>]] ...).=20

</tt>

</p><p>
The lazy list terminates when a value fails to satisfy
<tt><i>while-fun</i></tt>.
That is to say, prior to generating each value, the lazy list tests
the value using
<tt><i>while-fun</i></tt>.
If that function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the item is not added, and the sequence terminates.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">giterate<=
/a></tt>
could be written in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
like this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> giterate (w g v)
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generat=
e</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>=
 () [w v])
               (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">l=
ambda</a> () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8"=
>prog1</a> v (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set=
</a> v [g v])))))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">ginterate=
</a></tt>
function is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">giterate<=
/a></tt>
which includes the test-failing item in the generated sequence.
That is to say
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">ginterate=
</a></tt>
generates the next value and adds it to the lazy list.
The value is then tested using
<tt><i>while-fun</i></tt>.
If that function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the list is terminated, and no more items are produced.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
F671F4">giterate</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
068EA9D">op</a> &gt; 5) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0068EA9D">op</a> + 1) 0) -&gt; (0 1 2 3 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">ginterate<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> &=
gt; 5) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a=
> + 1) 0) -&gt; (0 1 2 3 4 5)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-023B6B64">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.12">9.14.12<=
/a> Function <tt>expand-right</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(expand-right </tt><tt><i>gen-fun</i></tt><tt> </tt><tt><i>=
value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023B6B64">expand-ri=
ght</a></tt>
function is a complement to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-ri=
ght</a></tt>,
with lazy semantics.
</p><p>
The
<tt><i>gen-fun</i></tt>
parameter is a function, which must accept a single argument,
and return either a cons pair
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>value</i></tt>
parameter is any value.
</p><p>
The first call to
<tt><i>gen-fun</i></tt>
receives
<tt><i>value</i></tt>.
</p><p>
The return value is interpreted as follows. If
<tt><i>gen-fun</i></tt>
returns a cons cell pair
<tt>




(</tt><tt><i>elem</i></tt><tt> . </tt><tt><i>next</i></tt><tt>)=20

</tt>

then
<tt><i>elem</i></tt>
specifies the element to be added to the lazy list,
and
<tt><i>next</i></tt>
specifies the value to be passed to the next call
to
<tt><i>gen-fun</i></tt>.
If
<tt><i>gen-fun</i></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then the lazy list ends.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Count down from 5 to 1 using explicit lambda
  ;; for gen-fun:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023B6B64">expand-rig=
ht</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (=
item)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a> item) nil
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons=
</a> item (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">pr=
ed</a> item))))
    5)
  --&gt; (5 4 3 2 1)

  ;; Using functional combinators:
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023B6B64">expand-rig=
ht</a> [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</=
a> zerop nilf [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21=
">callf</a> cons identity pred]] 5]
  --&gt; (5 4 3 2 1)

  ;; Include zero:
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023B6B64">expand-rig=
ht</a>
    [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a> =
null
       nilf
       [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21">callf=
</a> cons identity [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000=
E3A74">iff</a> zerop nilf pred]]] 5]
  --&gt; (5 4 3 2 1 0)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00E168FE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.13">9.14.13<=
/a> Functions <tt>expand-left</tt> and <tt>nexpand-left</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(expand-left </tt><tt><i>gen-fun</i></tt><tt> </tt><tt><i>v=
alue</i></tt><tt>)=20




<br>&nbsp;&nbsp;(nexpand-left </tt><tt><i>gen-fun</i></tt><tt> </tt><tt><i>=
value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">expand-le=
ft</a></tt>
function is a companion to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023B6B64">expand-ri=
ght</a></tt>.
</p><p>
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023B6B64">expand-ri=
ght</a></tt>,
it has eager semantics: it calls
<tt>gen-fun</tt>
repeatedly and accumulates an output list, not returning
until
<tt>gen-fun</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The semantics is as follows.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">expand-le=
ft</a></tt>
initializes an empty accumulation list. Then
<tt><i>gen-fun</i></tt>
is called, with
<tt><i>value</i></tt>
as its argument.
</p><p>
If
<tt><i>gen-fun</i></tt>
it returns a cons cell, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
of that cons cell is pushed onto the accumulation list,
and the procedure is repeated:
<tt><i>gen-fun</i></tt>
is called again, with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
taking the place of
<tt><i>value</i></tt>.
</p><p>
If
<tt><i>gen-fun</i></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the accumulation list is returned.
</p><p>
If the expression
<tt>(expand-right f v)</tt>
produces a terminating list, then the following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
E168FE">expand-left</a> f v) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-03D8471B">reverse</a> (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-023B6B64">expand-right</a> f v))
</tt></pre><tt>

</tt>

<p>
The equivalence cannot hold for arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">expand-le=
ft</a></tt>
which produce an infinite list.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">nexpand-l=
eft</a></tt>
function is a destructive version of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">expand-le=
ft</a></tt>.
</p><p>
The list returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">nexpand-l=
eft</a></tt>
is composed of the cons cells returned by
<tt>gen-fun</tt>
whereas the list returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E168FE">expand-le=
ft</a></tt>
is composed of freshly allocated cons cells.
</p><p>

</p></dd></dl>
<a name=3D"N-011DC272">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.14">9.14.14<=
/a> Function <tt>repeat</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(repeat </tt><tt><i>list</i></tt><tt> [</tt><tt><i>count</i=
></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>list</i></tt>
is empty, then repeat returns an empty list.
</p><p>
If
<tt><i>count</i></tt>
is omitted, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat</a></t=
t>
function produces an infinite lazy list
formed by catenating together copies of
<tt><i>list</i></tt>.
</p><p>
If
<tt><i>count</i></tt>
is specified and is zero or negative, then an empty list is
returned.
</p><p>
Otherwise a list is returned consisting of
<tt><i>count</i></tt>
repetitions of
<tt><i>list</i></tt>
catenated together.
</p><p>

</p></dd></dl>
<a name=3D"N-0247F5FA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.15">9.14.15<=
/a> Function <tt>pad</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pad </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>object</=
i></tt><tt> [</tt><tt><i>count</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0247F5FA">pad</a></=
tt>
function produces a lazy list which consists of all of the
elements of
<tt><i>sequence</i></tt>
followed by repetitions of
<tt><i>object</i></tt>.
</p><p>
If
<tt><i>count</i></tt>
is omitted, then the repetition of
<tt><i>object</i></tt>
is infinite. Otherwise the specified number of repetitions
occur.
</p><p>
Note that
<tt><i>sequence</i></tt>
may be a lazy list which is infinite. In that case, the repetitions
of
<tt><i>object</i></tt>
will never occur.
</p><p>

</p></dd></dl>
<a name=3D"N-0208F32F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.16">9.14.16<=
/a> Function <tt>weave</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(weave {</tt><tt><i>sequence</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F32F">weave</a>=
</tt>
function interleaves elements from the sequences given as arguments.
</p><p>
If called with no arguments, it returns the empty list.
</p><p>
If called with a single sequence, it returns the elements of that sequence
as a new lazy list.
</p><p>
When called with two or more sequences,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F32F">weave</a>=
</tt>
returns a lazy list which draws elements from the sequences in a round-robi=
n
fashion, repeatedly scanning the sequences from left to right, and
taking an item from each one, removing it from the sequence.
Whenever a sequence runs out of items, it is deleted; the weaving then
continues with the remaining sequences. The weaved sequence terminates
when all sequences are eliminated. (If at least one of the sequences
is an infinite lazy list, then the weaved sequence is infinite.)
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Weave negative integers with positive ones:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F32F">weave</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a> 1)=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a> -=
1 : -1)) -&gt; (1 -1 2 -2 3 -3 ...)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F32F">weave</a> =
"abcd" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range=
</a> 1 3) '(x x x x x x x))
  --&gt; (#\a 1 x #\b 2 x #\c 3 x #\d x x x x)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0323BEBD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.17">9.14.17<=
/a> Macros <tt>gen</tt> and <tt>gun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(gen </tt><tt><i>while-expression</i></tt><tt> </tt><tt><i>=
produce-item-expression</i></tt><tt>)=20




<br>&nbsp;&nbsp;(gun </tt><tt><i>produce-item-expression</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
macro operator produces a lazy list, in a manner similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
function. Whereas the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
function takes functional arguments,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
operator takes two expressions, which is often more convenient.
</p><p>
The return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
is a lazy list. When the lazy list is accessed, for
instance with the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
it produces items on demand. Prior to
producing each item, the
<tt><i>while-expression</i></tt>
is evaluated, in its original
lexical scope.  If the expression yields a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value, then
<tt><i>produce-item-expression</i></tt>
is evaluated, and its return value is incorporated as
the next item of the lazy list. If the expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the lazy list immediately terminates.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
operator itself immediately evaluates
<tt><i>while-expression</i></tt>
before
producing the lazy list. If the expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the operator
returns the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise, it instantiates the lazy list and
invokes the
<tt><i>produce-item-expression</i></tt>
to force the first item.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gun</a></=
tt>
macro similarly creates a lazy list according to the following
rules. Each successive item of the lazy list is obtained as a result of
evaluating
<tt><i>produce-item-expression</i></tt>.
However, when
<tt><i>produce-item-expression</i></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the list terminates (without adding that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
as an item).
</p><p>
Note 1: the form
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gun</a></=
tt>
can be implemented as a macro-expanding to
an instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
operator, like this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> gun (expr)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((var (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym=
</a>)))
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</=
a> (,var)
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> ,va=
r ,expr)
              ,var))))
</tt></pre><tt>

</tt>

<p>
This exploits the fact that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
operator returns the value that is
assigned, so the set expression is tested as a condition by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>,
while having the side effect of storing the next item temporarily
in a hidden variable.
</p><p>
In turn,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
can be implemented as a macro expanding to some
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
functions which are passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generate<=
/a></tt>
function:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> gen (while-expr produce-expr)
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F671F4">generat=
e</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>=
 () ,while-expr)
               (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">l=
ambda</a> () ,produce-expr)))
</tt></pre><tt>

</tt>

<p>
Note 2:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a></=
tt>
can be considered as an acronym for Generate, testing Expression
before Next item, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gun</a></=
tt>
stands for Generate Until Null.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Make a lazy list of integers up to 1000
  ;; access and print the first three.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a> (=
(counter 0)
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">lis=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0323BEBD">gen</a=
> (&lt; counter 1000) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
03A0AABD">inc</a> counter))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "~s ~s ~s\n" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F=
39D2">pop</a> list) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
7F39D2">pop</a> list) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
017F39D2">pop</a> list)))

  Output:
  1 2 3
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-033BE5A1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.18">9.14.18<=
/a> Functions <tt>range</tt> and <tt>range*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(range [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to</i></=
tt><tt> [</tt><tt><i>step</i></tt><tt>]]])=20




<br>&nbsp;&nbsp;(range* [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to</i><=
/tt><tt> [</tt><tt><i>step</i></tt><tt>]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range*</a=
></tt>
functions generate a lazy sequence of integers, with a
fixed step between successive values.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range*</a=
></tt>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range*</a=
></tt>
excludes the endpoint.
For instance
<tt>(range 0 3)</tt>
generates the list
<tt>(0 1 2 3)</tt>,
whereas
<tt>(range* 0 3)</tt>
generates
<tt>(0 1 2)</tt>.
</p><p>
All arguments are optional. If the
<tt><i>step</i></tt>
argument is omitted, then it defaults
to
<tt>1</tt>:
each value in the sequence is greater than the previous one by
<tt>1</tt>.
Positive or negative step sizes are allowed. There is no check for a step s=
ize
of zero, or for a step direction which cannot meet the endpoint.
</p><p>
The
<tt><i>to</i></tt>
argument specifies the endpoint value, which, if it occurs in the
sequence, is excluded from it by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range*</a=
></tt>
function, but included by the range
function. If
<tt><i>to</i></tt>
is missing, or specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then there is no endpoint,
and the sequence which is generated is infinite, regardless of
<tt><i>step</i></tt>.
</p><p>
If
<tt><i>from</i></tt>
is omitted, then the sequence begins at zero, otherwise
<tt><i>from</i></tt>
must be an integer which specifies the initial value.
</p><p>
The sequence stops if it reaches the endpoint value (which is included in t=
he
case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>=
</tt>,
and excluded in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>=
</tt>*).
However, a sequence with a stepsize greater than
<tt>1</tt>
or less than
<tt>-1</tt>
might step over the endpoint value, and
therefore never attain it. In this situation, the sequence also stops, and =
the
excess value which surpasses the endpoint is excluded from the sequence.
</p><p>

</p></dd></dl>
<a name=3D"N-02FD60D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.14.19">9.14.19<=
/a> Functions <tt>rlist</tt> and <tt>rlist*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rlist </tt><tt><i>item</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(rlist* </tt><tt><i>item</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a>=
</tt>
("range list") function is useful for producing a list consisting of a mixt=
ure
of discontinuous numeric or character ranges and individual items.
</p><p>
The function returns a lazy list of elements. The items are produced
by converting the function's successive
<tt><i>item</i></tt>
arguments into lists, which are lazily catenated together to form the
output list.
</p><p>
Each
<tt><i>item</i></tt>
is transformed into a list as follows. Any item which is
<b>not</b>

a range object is trivially turned into a one-element list as if by the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> </t=
t><tt><i>item</i></tt><tt>*)=20

</tt>

expression.
</p><p>
Any item which is a range object, whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
field
<b>isn't</b>

a range is turned into a lazy list as if by evaluating the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a> </tt>=
<tt><i>item)</i></tt><tt>(<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-00AED1A7">to</a> </tt><tt><i>item))</i></tt><tt>=20

</tt>

expression. Thus for instance the argument
<tt>1..10</tt>
turns into the (lazy) list
<tt>(1 2 3 4 5 6 7 8 9 10)</tt>.
</p><p>
Any item which is a range object such that its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
field is also a range is turned into a lazy  list as if by evaluating the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a> </tt>=
<tt><i>item)</i></tt><tt>(<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-00AED1A7">from</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
00AED1A7">to</a> </tt><tt><i>item))</i></tt><tt>(<a href=3D"http://nongnu.o=
rg/txr/txr-manpage.html#N-00AED1A7">to</a> (<a href=3D"http://nongnu.org/tx=
r/txr-manpage.html#N-00AED1A7">to</a> </tt><tt><i>item)))</i></tt><tt>=20

</tt>

expression. Thus for instance the argument expression
<tt>1..10..2</tt>
produces an
<tt><i>item</i></tt>
which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a>=
</tt>
turns into the lazy list
<tt>(1 3 5 7 9)</tt>
as if by the call
<tt>(range 1 10 2)</tt>.
Note that the expression
<tt>1..10..2</tt>
stands for the expression
<tt>(rcons 1 (rcons 10 2))</tt>
which evaluates to
<tt>#R(1 #R(10 2))</tt>.
</p><p>
The
<tt>#R(1 #R(10 2))</tt>
range literal syntax can be passed as an argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a>=
</tt>
with the same result as
<tt>1..10..2</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist*</a=
></tt>
function differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a>=
</tt>
in one regard: under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist*</a=
></tt>,
the ranges denoted by the range notation exclude the endpoint. That is,
the ranges are generated as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range*</a=
></tt>
function rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>=
</tt>.
</p><p>
Note: it is permissible for
<tt><i>item</i></tt>
objects to specify infinite ranges.
It is also permissible to apply an infinite argument list to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a>=
</tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
FD60D0">rlist</a> 1 "two" :three)  -&gt;  (1 "two" :three)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a> =
10 15..16 #\a..#\d 2) -&gt; (10 15 16 #\a #\b #\c #\d 2)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6D433">take</a> 7=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD60D0">rlist</a> 1=
 2 5..:)) -&gt; (1 2 5 6 7 8 9)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-01884DC2">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.15">9.15</a> Ra=
nges</h3>



<p>


Ranges are objects that aggregate two values, not unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells. However, they are atoms, and are primarily intended to hold numeric =
or
character values in their two fields. These fields are called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
which are the names of the functions which access them. These fields
are not mutable; a new value cannot be stored into either field of
a range.
</p><p>
The printed notation for a range object consists of the prefix
<tt>#R</tt>
(hash R) followed by the two values expressed as a two-element
list.  Ranges can be constructed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>
function. The notation
<tt>x..y</tt>
corresponds to
<tt>(rcons x y)</tt>.
</p><p>
Ranges behave as a numeric type and support a subset of the numeric
operations. Two ranges can be added or subtracted, which obeys
these equivalences:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
7C">+</a> a..b c..d)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#D-007C">+</a> a c)..(<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-007C">+</a> b d)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> a..b c..=
d)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">=
-</a> a c)..(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a=
> b d)
</tt></pre><tt>

</tt>

<p>
A range
<tt>a..b</tt>
can be combined with a character or number
<tt>n</tt>
using addition or subtractions, which obeys these equivalences:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
7C">+</a> a..b n)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#D-007C">+</a> n a..b)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr=
/txr-manpage.html#D-007C">+</a> a n)..(<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#D-007C">+</a> b n)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> a..b n) =
 &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</=
a> a n)..(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> b=
 n)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> n a..b) =
 &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</=
a> n a)..(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> n=
 b)
</tt></pre><tt>

</tt>

<p>
A range can be multiplied by a number:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
2396F7">*</a> a..b n)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-022396F7">*</a> n a..b)  &lt;--&gt;  (<a href=3D"http://nongnu=
.org/txr/txr-manpage.html#N-022396F7">*</a> a n)..(<a href=3D"http://nongnu=
.org/txr/txr-manpage.html#N-022396F7">*</a> b n)
</tt></pre><tt>

</tt>

<p>
A range can be divided by a number using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>
functions, but a number cannot be divided by a range:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2A">trunc</a> a..b n)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-002A">trunc</a> a n)..(<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-002A">trunc</a> b n)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a> a..b n) =
     &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007"=
>/</a> a n)..(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</=
a> b n)
</tt></pre><tt>

</tt>

<p>
Ranges can be compared using the equality and inequality functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001A">&gt;=3D</a></=
tt>.
Equality obeys this equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
6A">=3D</a> a..b c..d)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#D-0049">and</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-006A">=3D</a> a c) (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-006A">=3D</a> b d))
</tt></pre><tt>

</tt>

<p>
Inequality comparisons treat the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
component with precedence over
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
such that only if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
components of the two ranges are not equal under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
function, then the inequality is based solely on them.
If they are equal, then the inequality is based on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
components. This gives rise to the following equivalences:
</p><p>
<tt>
</tt></p><pre><tt>  (&lt; a..b c..d)   &lt;--&gt;  (<a href=3D"http://nongn=
u.org/txr/txr-manpage.html#D-0039">if</a> (<a href=3D"http://nongnu.org/txr=
/txr-manpage.html#D-006A">=3D</a> a c) (&lt; b d) (&lt; a c))
  (&gt; a..b c..d)   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#D-0039">if</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-006A">=3D</a> a c) (&gt; b d) (&gt; a c))
  (&gt;=3D a..b c..d)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-0039">if</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-006A">=3D</a> a c) (&gt;=3D b d) (&gt; a c))
  (&lt;=3D a..b c..d)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-0039">if</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-006A">=3D</a> a c) (&lt;=3D b d) (&lt; a c))
</tt></pre><tt>

</tt>

<p>
Ranges can be negated with the one-argument form of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
function, which is equivalent to subtraction from zero:
the negation distributes over the two range components.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0032">abs</a></tt>
function also applies to ranges and distributes into
their components.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">succ</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">pred</a><=
/tt>
family of functions also operate on ranges.
</p><p>
The length of a range may be obtained with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function;
</p><p>
The length of the range
<tt>a..b</tt>
is defined as
<tt>(- b a)</tt>,
and may be obtained using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</a>=
</tt>
function accepts ranges and tests them for zero length.
</p><p>

<a name=3D"N-02E9003D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.15.1">9.15.=
1</a> Function <tt>rcons</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rcons </tt><tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>
function constructs a range object which holds the values
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>.
</p><p>
Though range objects are effectively binary cells like conses, they are ato=
ms.
They also aren't considered sequences, nor are they structures.
</p><p>
Range objects are used for indicating numeric ranges, such as substrings of
lists, arrays and strings. The dotdot notation serves as a syntactic sugar =
for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>.
The syntax
<tt>a..b</tt>
denotes the expression
<tt>(rcons a b)</tt>.
</p><p>
Note that ranges are immutable, meaning that it is not possible to
replace the values in a range.
</p><p>

</p></dd></dl>
<a name=3D"N-00DDB00B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.15.2">9.15.2</a=
> Function <tt>rangep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rangep </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DDB00B">rangep</a=
></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>value</i></tt>
is a range. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00AED1A7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.15.3">9.15.3</a=
> Functions <tt>from</tt> and <tt>to</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(from </tt><tt><i>range</i></tt><tt>)=20




<br>&nbsp;&nbsp;(to </tt><tt><i>range</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
functions retrieve, respectively, the from and to fields
of a range.
</p><p>
Note that these functions are not accessors, which is because
ranges are immutable.
</p><p>

</p></dd></dl>
<a name=3D"N-02C56FB6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.15.4">9.15.4</a=
> Functions <tt>in-range</tt> and <tt>in-range*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(in-range </tt><tt><i>range</i></tt><tt> </tt><tt><i>value<=
/i></tt><tt>)=20




<br>&nbsp;&nbsp;(in-range* </tt><tt><i>range</i></tt><tt> </tt><tt><i>value=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C56FB6">in-range<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C56FB6">in-range*=
</a></tt>
functions test whether the
<tt><i>value</i></tt>
argument lies in the range represented by the
<tt><i>range</i></tt>
argument, indicating the Boolean result using one of the values
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>range</i></tt>
argument must be a range object.
</p><p>
It is expected that the range object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
value does not exceed the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
value; a reversed range is considered empty.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C56FB6">in-range*=
</a></tt>
function differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C56FB6">in-range<=
/a></tt>
in that it excludes the
upper endpoint.
</p><p>
The implicit comparison against the range endpoints is performed
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">lequal</a=
></tt>
functions, as appropriate.
</p><p>
The following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
C56FB6">in-range</a> r x)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#D-0049">and</a> (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-00A3E42D">lequal</a> (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-00AED1A7">from</a> r) x)
                             (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00A3E42D">lequal</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-00AED1A7">to</a> r)))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C56FB6">in-range*<=
/a> r x)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0049">and</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D=
">lequal</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7"=
>from</a> r) x)
                              (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-01D6CEA1">less</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00AED1A7">to</a> r)))
</tt></pre><tt>

</tt>

</dd></dl>
<a name=3D"N-031A46B6">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16">9.16</a> Ch=
aracters and Strings</h3>



<p>



<a name=3D"N-033DD796">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.1">9.16.=
1</a> Function <tt>mkstring</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mkstring </tt><tt><i>length</i></tt><tt> [</tt><tt><i>char=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033DD796">mkstring<=
/a></tt>
function constructs a string object of a length specified
by the
<tt><i>length</i></tt>
parameter.  Every position in the string is initialized
with
<tt><i>char</i></tt>,
which must be a character value.
</p><p>
If the optional argument
<tt><i>char</i></tt>
is not specified, it defaults to the space character.
</p><p>

</p></dd></dl>
<a name=3D"N-02FE763D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.2">9.16.2</a=
> Function <tt>copy-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FE763D">copy-str<=
/a></tt>
function constructs a new string whose contents are identical
to
<tt><i>string</i></tt>.
</p><p>
If
<tt><i>string</i></tt>
is a lazy string, then a lazy string is constructed with the
same attributes as
<tt><i>string</i></tt>.
The new lazy string has its own copy of the prefix portion of
<tt><i>string</i></tt>
which has been forced so far. The unforced list and separator
string are shared between
<tt><i>string</i></tt>
and the newly constructed lazy string.
</p><p>

</p></dd></dl>
<a name=3D"N-029EEA82">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.3">9.16.3</a=
> Function <tt>upcase-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(upcase-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-029EEA82">upcase-st=
r</a></tt>
function produces a copy of
<tt><i>string</i></tt>
such that all lower-case
characters of the English alphabet are mapped to their upper case counterpa=
rts.
</p><p>

</p></dd></dl>
<a name=3D"N-03DA541E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.4">9.16.4</a=
> Function <tt>downcase-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(downcase-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DA541E">downcase-=
str</a></tt>
function produces a copy of
<tt><i>string</i></tt>
such that
all upper case characters of the English alphabet are mapped to their
lower case counterparts.
</p><p>

</p></dd></dl>
<a name=3D"N-03D5358A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.5">9.16.5</a=
> Function <tt>string-extend</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(string-extend </tt><tt><i>string</i></tt><tt> </tt><tt><i>=
tail</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D5358A">string-ex=
tend</a></tt>
function destructively increases the length of
<tt><i>string</i></tt>,
which must be an ordinary dynamic string.  It is an error to invoke this
function on a literal string or a lazy string.
</p><p>
The
<tt><i>tail</i></tt>
argument can be a character, string or integer. If it is a string or
character, it specifies material which is to be added to the end of the str=
ing:
either a single character or a sequence of characters. If it is an integer,=
 it
specifies the number of characters to be added to the string.
</p><p>
If
<tt><i>tail</i></tt>
is an integer, the newly added characters have indeterminate contents.
The string appears to be the original one because of an internal terminatin=
g
null character remains in place, but the characters beyond the terminating =
zero
are indeterminate.
</p><p>

</p></dd></dl>
<a name=3D"N-00BB392B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.6">9.16.6</a=
> Function <tt>stringp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(stringp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BB392B">stringp</=
a></tt>
function returns t if
<tt><i>obj</i></tt>
is one of the several
kinds of strings. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03E6D841">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.7">9.16.7</a=
> Function <tt>length-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E6D841">length-st=
r</a></tt>
function returns the length
<tt><i>string</i></tt>
in characters.  The argument must be a string.
</p><p>

</p></dd></dl>
<a name=3D"N-0167F423">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.8">9.16.8</a=
> Function <tt>coded-length</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(coded-length </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0167F423">coded-len=
gth</a></tt>
function returns the number of bytes required to encode
<tt><i>string</i></tt>
in UTF-8.
</p><p>
The argument must be a character string.
</p><p>
If the string contains only characters in the ASCII range U+0001 to U+007F
range, then the value returned shall be the same as that returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E6D841">length-st=
r</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0257180F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.9">9.16.9</a=
> Function <tt>search-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(search-str </tt><tt><i>haystack</i></tt><tt> </tt><tt><i>n=
eedle</i></tt><tt> [</tt><tt><i>start</i></tt><tt> [</tt><tt><i>from-end</i=
></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0257180F">search-st=
r</a></tt>
function finds an occurrence of the string
<tt><i>needle</i></tt>
inside
the
<tt><i>haystack</i></tt>
string and returns its position. If no such occurrence exists,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If a
<tt><i>start</i></tt>
argument is not specified, it defaults to zero. If it is
a non-negative integer, it specifies the starting character position for
the search.  Negative values of
<tt><i>start</i></tt>
indicate positions from the end of the
string, such that
<tt>-1</tt>
is the last character of the string.
</p><p>
If the
<tt><i>from-end</i></tt>
argument is specified and is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it means
that the search is conducted right-to-left. If multiple matches are possibl=
e,
it will find the rightmost one rather than the leftmost one.
</p><p>

</p></dd></dl>
<a name=3D"N-02783DAA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.10">9.16.10<=
/a> Function <tt>search-str-tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(search-str-tree </tt><tt><i>haystack</i></tt><tt> </tt><tt=
><i>tree</i></tt><tt> [</tt><tt><i>start</i></tt><tt> [</tt><tt><i>from-end=
</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02783DAA">search-st=
r-tree</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0257180F">search-st=
r</a></tt>,
except that instead of
searching
<tt><i>haystack</i></tt>
for the occurrence of a single needle string, it searches
for the occurrence of numerous strings at the same time.  These search stri=
ngs
are specified, via the
<tt><i>tree</i></tt>
argument, as an arbitrarily structured tree whose
leaves are strings.
</p><p>
The function finds the earliest possible match, in the given search directi=
on,
from among all of the needle strings.
</p><p>
If
<tt><i>tree</i></tt>
is a single string, the semantics is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0257180F">search-st=
r</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03FF771E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.11">9.16.11<=
/a> Function <tt>match-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(match-str </tt><tt><i>bigstring</i></tt><tt> </tt><tt><i>l=
ittlestring</i></tt><tt> [</tt><tt><i>start</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Without the
<tt><i>start</i></tt>
argument, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FF771E">match-str=
</a></tt>
function determines whether
<tt><i>littlestring</i></tt>
is a prefix of
<tt><i>bigstring</i></tt>,
returning a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
indication.
</p><p>
If the
<tt><i>start</i></tt>
argument is specified, and is a non-negative integer, then the
function tests whether
<tt><i>littlestring</i></tt>
matches a prefix of that portion of
<tt><i>bigstring</i></tt>
which starts at the given position.
</p><p>
If the
<tt><i>start</i></tt>
argument is a negative integer, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FF771E">match-str=
</a></tt>
determines
whether
<tt><i>littlestring</i></tt>
is a suffix of
<tt><i>bigstring</i></tt>,
ending on that position
of bigstring, where
<tt>-1</tt>
denotes the last character of
<tt><i>bigstring</i></tt>,
<tt>-2</tt>
the second last one and so on.
</p><p>
If
<tt><i>start</i></tt>
is
<tt>-1</tt>,
then this corresponds to testing whether
<tt><i>littlestring</i></tt>
is a suffix of
<tt><i>bigstring</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01859E7F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.12">9.16.12<=
/a> Function <tt>match-str-tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(match-str-tree </tt><tt><i>bigstring</i></tt><tt> </tt><tt=
><i>tree</i></tt><tt> [</tt><tt><i>start</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01859E7F">match-str=
-tree</a></tt>
function is a generalization of match-str which matches
multiple test strings against
<tt><i>bigstring</i></tt>
at the same time. The value
reported is the longest match from among any of the strings.
</p><p>
The strings are specified as an arbitrarily shaped tree structure which has
strings at the leaves.
</p><p>
If
<tt><i>tree</i></tt>
is a single string atom, then the function behaves
exactly like match-str.
</p><p>

</p></dd></dl>
<a name=3D"N-03CFFEF2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.13">9.16.13<=
/a> Accessor <tt>sub-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sub-str </tt><tt><i>str</i></tt><tt> [</tt><tt><i>from</i>=
</tt><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(set (sub-str </tt><tt><i>str</i></tt><tt> [</tt><tt><i>fro=
m</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]]) </tt><tt><i>new-value</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
function has the same parameters and semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
function,
function, except that the first argument is operated upon
using string operations.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
form is used as a place, it denotes a subrange of
<tt><i>list</i></tt>
as if it were a storage location. The previous value of this location,
if needed, is fetched by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>.
Storing
<tt><i>new-value</i></tt>
to the place is performed by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02059F0A">replace-s=
tr</a></tt>.
In an update operation which accesses the prior value and stores a new valu=
e,
the arguments
<tt><i>str</i></tt>,
<tt><i>from</i></tt>,
<tt><i>to</i></tt>
and
<tt><i>new-value</i></tt>
are evaluated once.
</p><p>
The
<tt><i>str</i></tt>
argument is not itself required to be a place; it is not updated
when a value is written to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
storage location.
</p><p>

</p></dd></dl>
<a name=3D"N-02059F0A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.14">9.16.14<=
/a> Function <tt>replace-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(replace-str </tt><tt><i>string</i></tt><tt> </tt><tt><i>it=
em-sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to</i>=
</tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02059F0A">replace-s=
tr</a></tt>
function has the same parameters and semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function, except that the first argument is operated upon
using string operations.
</p><p>

</p></dd></dl>
<a name=3D"N-00B6ACE3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.15">9.16.15<=
/a> Functions <tt>cat-str</tt>, <tt>join-with</tt> and <tt>join</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cat-str </tt><tt><i>item-seq</i></tt><tt> [</tt><tt><i>sep=
</i></tt><tt>])=20




<br>&nbsp;&nbsp;(join-with </tt><tt><i>sep</i></tt><tt> </tt><tt><i>item</i=
></tt><tt>*)=20




<br>&nbsp;&nbsp;(join </tt><tt><i>item</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">cat-str</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join-with=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join</a><=
/tt>
functions combine items, into
a single string, which is returned.
</p><p>
Every
<tt><i>item</i></tt>
argument must be a character or string object. The same is true of the
<tt><i>sep</i></tt>
argument, if present.
The
<tt><i>item-seq</i></tt>
argument must be a sequence of any mixture of characters or strings.
Note that this means that if
<tt><i>item-seq</i></tt>
is a character string, it is a valid argument, since it is a sequence
of characters.
</p><p>
If
<tt><i>item-seq</i></tt>
is empty, or no
<tt><i>item</i></tt>
arguments are present, then all three functions return an
empty string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">cat-str</=
a></tt>
function receives the items as a single list. If the
<tt><i>sep</i></tt>
argument is present, the items are catenated together such that
<tt><i>sep</i></tt>
is interposed between them. If
<tt><i>item-seq</i></tt>
contains
<i>n</i>

items, then
<i>n - 1</i>

copies of
<tt><i>sep</i></tt>
occur in the resulting string.
</p><p>
If
<tt><i>sep</i></tt>
is absent, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">cat-str</=
a></tt>
catenates the items together directly, without any separator.
</p><p>
Copies of the items appear in the resulting string in the same
order as the items appear in
<tt><i>item-seq</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join-with=
</a></tt>
function receives the items as arguments rather than a single
<tt><i>item-seq</i></tt>
arguments. The arguments are joined into a single character string
in order, with
<tt><i>sep</i></tt>
interposed between them.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6ACE3">join</a><=
/tt>
function takes no
<tt><i>sep</i></tt>
argument. It joins all of its argument items into a single
string, in order.
</p><p>

</p></dd></dl>
<a name=3D"N-000386B4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.16">9.16.16<=
/a> Function <tt>split-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(split-str </tt><tt><i>string</i></tt><tt> </tt><tt><i>sep<=
/i></tt><tt> [</tt><tt><i>keep-between</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>
function breaks the
<tt><i>string</i></tt>
into pieces, returning a list
thereof. The
<tt><i>sep</i></tt>
argument must be one of three types: a string, a character
or a regular expression. It determines the separator character
sequences within
<tt><i>string</i></tt>.
</p><p>
All non-overlapping matches for
<tt><i>sep</i></tt>
within
<tt><i>string</i></tt>
are identified in left
to right order, and are removed from
<tt><i>string</i></tt>.
The string is broken into pieces
according to the gaps left behind by the removed separators, and a list
of the remaining pieces is returned.
</p><p>
If
<tt><i>sep</i></tt>
is the empty string, then the separator pieces removed from the
string are considered to be the empty strings between its
characters. In this case, if
<tt><i>string</i></tt>
is of length one or zero, then it is considered to have no such pieces, and=
 a
list of one element is returned containing the original string.
These remarks also apply to the situation when
<tt><i>sep</i></tt>
is a regular expression which matches only an empty
substring of
<tt><i>string</i></tt>.
</p><p>
If a match for
<tt><i>sep</i></tt>
is not found in the string at all (not even an empty match), then the strin=
g is
not split at all: a list of one element is returned containing the original
string.
</p><p>
If
<tt><i>sep</i></tt>
matches the entire string, then a list of two empty strings is
returned, except in the case that the original string is empty, in which ca=
se a
list of one element is returned, containing the empty string.
</p><p>
Whenever two adjacent matches for
<tt><i>sep</i></tt>
occur, they are considered separate
cuts with an empty piece between them.
</p><p>
This operation is nondestructive:
<tt><i>string</i></tt>
is not modified in any way.
</p><p>
If the optional
<tt><i>keep-between</i></tt>
argument is specified and is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
If an argument is given and is true, then
<tt><i>split-str</i></tt>
incorporates the matching separating pieces of
<tt><i>string</i></tt>
into the resulting list, such that if the resulting
list is catenated, a string equivalent to the original
string will be produced.
</p><p>
Note: to split a string into pieces of length one such that an empty string
produces
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
rather than
<tt>()</tt>,
use the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</a> =
</tt><tt><i>string</i></tt><tt> #/./)=20

</tt>

pattern.
</p><p>
Note: the function call
<tt>(split-str s r t)</tt>
produces a resulting list identical to
<tt>(tok-str s r t)</tt>,
for all values of
<tt>r</tt>
and
<tt>s</tt>,
provided that
<tt>r</tt>
does not match empty strings. If
<tt>r</tt>
matches empty strings, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
call returns extra elements compared to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>,
because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
allows empty matches to take place and extract empty tokens
before the first character of the string, and after the
last character, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>
does not recognize empty separators at these outer limits
of the string.
</p><p>

</p></dd></dl>
<a name=3D"N-03C7F5FA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.17">9.16.17<=
/a> Function <tt>spl</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(spl </tt><tt><i>sep</i></tt><tt> [</tt><tt><i>keep-between=
</i></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7F5FA">spl</a></=
tt>
function performs the same computation as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>.
The same-named parameters of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7F5FA">spl</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>
have the same semantics. The difference is the argument order.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7F5FA">spl</a></=
tt>
function takes the
<tt><i>sep</i></tt>
argument first.
The last argument is always
<tt><i>string</i></tt>
whether or not there are two arguments or three. If there are
three arguments, then
<tt><i>keep-between</i></tt>
is the middle one.
</p><p>
Note: the argument conventions of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7F5FA">spl</a></=
tt>
facilitate less verbose partial application, such as with macros in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
family, in the common situation when
<tt><i>string</i></tt>
is the unbound argument.
</p><p>

</p></dd></dl>
<a name=3D"N-0296195B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.18">9.16.18<=
/a> Functions <tt>split-str-set</tt> and <tt>sspl</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(split-str-set </tt><tt><i>string</i></tt><tt> </tt><tt><i>=
set</i></tt><tt>)=20




<br>&nbsp;&nbsp;(sspl </tt><tt><i>set</i></tt><tt> </tt><tt><i>string</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0296195B">split-str=
-set</a></tt>
function breaks the
<tt><i>string</i></tt>
into pieces, returning a list
thereof. The
<tt><i>set</i></tt>
argument must be a string. It specifies a set of
characters.  All occurrences of any of these characters within
<tt><i>string</i></tt>
are
identified, and are removed from
<tt><i>string</i></tt>.
The string is broken into pieces
according to the gaps left behind by the removed separators.
</p><p>
Adjacent occurrences of characters from
<tt><i>set</i></tt>
within
<tt><i>string</i></tt>
are considered to
be separate gaps which come between empty strings.
</p><p>
This operation is nondestructive:
<tt><i>string</i></tt>
is not modified in any way.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0296195B">sspl</a><=
/tt>
function performs the same operation; the only difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0296195B">sspl</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0296195B">split-str=
-set</a></tt>
is argument order.
</p><p>

</p></dd></dl>
<a name=3D"N-0225F28F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.19">9.16.19<=
/a> Functions <tt>tok-str</tt> and <tt>tok-where</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tok-str </tt><tt><i>string</i></tt><tt> </tt><tt><i>regex<=
/i></tt><tt> [</tt><tt><i>keep-between</i></tt><tt>])=20




<br>&nbsp;&nbsp;(tok-where </tt><tt><i>string</i></tt><tt> </tt><tt><i>rege=
x</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
function searches
<tt><i>string</i></tt>
for tokens, which are defined as
substrings of
<tt><i>string</i></tt>
which match the regular expression
<tt><i>regex</i></tt>
in the
longest possible way, and do not overlap. These tokens are extracted from t=
he
string and returned as a list.
</p><p>
Whenever
<tt><i>regex</i></tt>
matches an empty string, then an empty token is returned, and
the search for another token within
<tt><i>string</i></tt>
resumes after advancing by one
character position. However, if an empty match occurs immediately
after a non-empty token, that empty match is not turned into
a token.
</p><p>
So for instance,
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</a> =
"abc" #/a?/)
</tt>

returns
<tt>

("a" "" "").
</tt>

After the token
<tt>"a"</tt>

is extracted from a non-empty match
for the regex, an empty match for the regex occurs just
before the character
<tt>b</tt>.
This match is discarded because it is an empty match which
immediately follows the non-empty match. The character
<tt>b</tt>
is skipped. The next match is an empty match between the
<tt>b</tt>
and
<tt>c</tt>
characters. This match causes an empty token to be
extracted. The character
<tt>c</tt>
is skipped, and one more empty match occurs after that
character and is extracted.
</p><p>
If the
<tt><i>keep-between</i></tt>
argument is specified, and is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the behavior
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
changes in the following way. The pieces of
<tt><i>string</i></tt>
which are
skipped by the search for tokens are included in the output. If no token is
found in
<tt><i>string</i></tt>,
then a list of one element is returned, containing
<tt><i>string</i></tt>.
Generally, if N tokens are found, then the returned list consists of 2N + 1
elements. The first element of the list is the (possibly empty) substring w=
hich
had to be skipped to find the first token. Then the token follows. The next
element is the next skipped substring and so on. The last element is the
substring of
<tt><i>string</i></tt>
between the last token and the end.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-where=
</a></tt>
function works similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>,
but instead of returning
the extracted tokens themselves, it returns a list of the character positio=
n
ranges within
<tt><i>string</i></tt>
where matches for
<tt><i>regex</i></tt>
occur. The ranges
are pairs of numbers, represented as cons cells, where the first number
of the pair gives the starting character position, and the second number
is one position past the end of the match.  If a match is empty, then the
two numbers are equal.
</p><p>
The tok-where function does not support the
<tt><i>keep-between</i></tt>
parameter.
</p><p>

</p></dd></dl>
<a name=3D"N-0117F60C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.20">9.16.20<=
/a> Function <tt>tok</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tok </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>keep-betwe=
en</i></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117F60C">tok</a></=
tt>
function performs the same computation as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>.
The same-named parameters of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117F60C">tok</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
have the same semantics. The difference is the argument order.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117F60C">tok</a></=
tt>
function takes the
<tt><i>regex</i></tt>
argument first.
The last argument is always
<tt><i>string</i></tt>
whether or not there are two arguments or three. If there are
three arguments, then
<tt><i>keep-between</i></tt>
is the middle one.
</p><p>
Note: the argument conventions of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117F60C">tok</a></=
tt>
facilitate less verbose partial application, such as  with macros in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
family, in the common situation when
<tt><i>string</i></tt>
is the unbound argument.
</p><p>

</p></dd></dl>
<a name=3D"N-0236023D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.21">9.16.21<=
/a> Function <tt>list-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(list-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0236023D">list-str<=
/a></tt>
function converts a string into a list of characters.
</p><p>

</p></dd></dl>
<a name=3D"N-00E6E63B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.22">9.16.22<=
/a> Function <tt>trim-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trim-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6E63B">trim-str<=
/a></tt>
function produces a copy of
<tt><i>string</i></tt>
from which leading and
trailing tabs, spaces and newlines are removed.
</p><p>

</p></dd></dl>
<a name=3D"N-02C6CEED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.23">9.16.23<=
/a> Function <tt>chrp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chrp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a character, otherwise nil.
</p><p>

</p></dd></dl>
<a name=3D"N-01B18DF0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.24">9.16.24<=
/a> Function <tt>chr-isalnum</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isalnum </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an alphanumeric character, otherwise nil. Alphanumeric
means one of the upper or lower case letters of the English alphabet found =
in
ASCII, or an ASCII digit. This function is not affected by locale.
</p><p>

</p></dd></dl>
<a name=3D"N-00F18E1B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.25">9.16.25<=
/a> Function <tt>chr-isalpha</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isalpha </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an alphabetic character, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Alphabetic
means one of the upper or lower case letters of the English alphabet found =
in
ASCII. This function is not affected by locale.
</p><p>

</p></dd></dl>
<a name=3D"N-0171941F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.26">9.16.26<=
/a> Function <tt>chr-isascii</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isascii </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0171941F">chr-isasc=
ii</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the code of character
<tt><i>char</i></tt>
is in the range 0 to 127 inclusive. For characters outside of this range, i=
t
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02A1A5A8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.27">9.16.27<=
/a> Function <tt>chr-iscntrl</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-iscntrl </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1A5A8">chr-iscnt=
rl</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the character
<tt><i>char</i></tt>
is a character whose code
ranges from 0 to 31, or is 127. In other words, any non-printable ASCII
character. For other characters, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01ED5020">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.28">9.16.28<=
/a> Functions <tt>chr-isdigit</tt> and <tt>chr-digit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isdigit </tt><tt><i>char</i></tt><tt>)=20




<br>&nbsp;&nbsp;(chr-digit </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>char</i></tt>
is is an ASCII decimal digit character,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01ED5020">chr-isdig=
it</a></tt>
returns the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01ED5020">chr-digit=
</a></tt>
returns the integer value corresponding to that digit character,
a value in the range 0 to 9.  Otherwise, both functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00617BD5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.29">9.16.29<=
/a> Function <tt>chr-isgraph</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isgraph </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00617BD5">chr-isgra=
ph</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is a non-space printable ASCII character.
It returns nil if it is a space or control character.
</p><p>
It also returns nil for non-ASCII characters: Unicode characters with a cod=
e
above 127.
</p><p>

</p></dd></dl>
<a name=3D"N-02BB58D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.30">9.16.30<=
/a> Function <tt>chr-islower</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-islower </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB58D0">chr-islow=
er</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an ASCII lower case letter. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001B5076">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.31">9.16.31<=
/a> Function <tt>chr-isprint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isprint </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001B5076">chr-ispri=
nt</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an ASCII character which is not a
control character.  It also returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for all non-ASCII characters: Unicode
characters with a code above 127.
</p><p>

</p></dd></dl>
<a name=3D"N-011B4F35">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.32">9.16.32<=
/a> Function <tt>chr-ispunct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-ispunct </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011B4F35">chr-ispun=
ct</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an ASCII character which is not a
control character.  It also returns nil for all non-ASCII characters: Unico=
de
characters with a code above 127.
</p><p>

</p></dd></dl>
<a name=3D"N-002B4C59">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.33">9.16.33<=
/a> Function <tt>chr-isspace</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isspace </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B4C59">chr-isspa=
ce</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an ASCII whitespace character: any of the
characters in the set
<tt>#\space</tt>,
<tt>#\tab</tt>,
<tt>#\linefeed</tt>,
<tt>#\newline</tt>,
<tt>#\return</tt>,
<tt>#\vtab</tt>
and
<tt>#\page</tt>.
For all other characters, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0251A159">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.34">9.16.34<=
/a> Function <tt>chr-isblank</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isblank </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0251A159">chr-isbla=
nk</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is a space or tab: the character
<tt>#\space</tt>
or
<tt>#\tab</tt>.
For all other characters, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00DB3D75">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.35">9.16.35<=
/a> Function <tt>chr-isunisp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isunisp </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DB3D75">chr-isuni=
sp</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is a Unicode whitespace character. This the case for
all the characters for which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B4C59">chr-isspa=
ce</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
It also returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
for these additional characters:
<tt>#\xa0</tt>,
<tt>#\x1680</tt>,
<tt>#\x180e</tt>,
<tt>#\x2000</tt>,
<tt>#\x2001</tt>,
<tt>#\x2002</tt>,
<tt>#\x2003</tt>,
<tt>#\x2004</tt>,
<tt>#\x2005</tt>,
<tt>#\x2006</tt>,
<tt>#\x2007</tt>,
<tt>#\x2008</tt>,
<tt>#\x2009</tt>,
<tt>#\x200a</tt>,
<tt>#\x2028</tt>,
<tt>#\x2029</tt>,
<tt>#\x205f</tt>,
and
<tt>#\x3000</tt>.
For all other characters, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02BB451C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.36">9.16.36<=
/a> Function <tt>chr-isupper</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isupper </tt><tt><i>char</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB451C">chr-isupp=
er</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>char</i></tt>
is an ASCII upper case letter. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-021C89F4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.37">9.16.37<=
/a> Functions <tt>chr-isxdigit</tt> and <tt>chr-xdigit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-isxdigit </tt><tt><i>char</i></tt><tt>)=20




<br>&nbsp;&nbsp;(chr-xdigit </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>char</i></tt>
is a hexadecimal digit character,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021C89F4">chr-isxdi=
git</a></tt>
returns the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021C89F4">chr-xdigi=
t</a></tt>
returns the integer value corresponding to that digit character,
a value in the range 0 to 15.  Otherwise, both functions returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A hexadecimal digit is one of the ASCII
digit characters
<tt>0</tt>
through
<tt>9</tt>,
or else one of the letters
<tt>A</tt>
through
<tt>F</tt>
or their lower-case equivalents
<tt>a</tt>
through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
denoting the values 10 to 15.
</p><p>

</p></dd></dl>
<a name=3D"N-015A451C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.38">9.16.38<=
/a> Function <tt>chr-toupper</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-toupper </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If character
<tt><i>char</i></tt>
is a lower case ASCII letter character, this function
returns the upper case equivalent character. If it is some other
character, then it just returns
<tt><i>char</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-015A58D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.39">9.16.39<=
/a> Function <tt>chr-tolower</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-tolower </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If character
<tt><i>char</i></tt>
is an upper case ASCII letter character, this function
returns the lower case equivalent character. If it is some other
character, then it just returns
<tt><i>char</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-000AEC8B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.40">9.16.40<=
/a> Functions <tt>int-chr</tt> and <tt>chr-int</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(int-chr </tt><tt><i>char</i></tt><tt>)=20




<br>&nbsp;&nbsp;(chr-int </tt><tt><i>num</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The argument
<tt><i>char</i></tt>
must be a character. The
<tt>num-chr</tt>
function returns that
character's Unicode code point value as an integer.
</p><p>
The argument
<tt><i>num</i></tt>
must be a fixnum integer in the range
<tt>0</tt>
to
<tt>#\x10FFFF</tt>.
The argument is taken to be a Unicode code point value and the
corresponding character object is returned.
</p><p>
Note: these functions are also known by the obsolescent names
<tt>num-chr</tt>
and
<tt>chr-num</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0378FEF2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.41">9.16.41<=
/a> Accessor <tt>chr-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-str </tt><tt><i>str</i></tt><tt> </tt><tt><i>idx</i></=
tt><tt>)=20




<br>&nbsp;&nbsp;(set (chr-str </tt><tt><i>str</i></tt><tt> </tt><tt><i>idx<=
/i></tt><tt>) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
function performs random access on string
<tt><i>str</i></tt>
to retrieve
the character whose position is given by integer
<tt><i>idx</i></tt>,
which must
be within range of the string.
</p><p>
The index value 0 corresponds to the first (leftmost) character of the stri=
ng
and so non-negative values up to one less than the length are possible.
</p><p>
Negative index values are also allowed, such that -1 corresponds to the
last (rightmost) character of the string, and so negative values down to
the additive inverse of the string length are possible.
</p><p>
An empty string cannot be indexed. A string of length one supports index 0 =
and
index -1. A string of length two is indexed left to right by the values 0 a=
nd
1, and from right to left by -1 and -2.
</p><p>
If the element
<tt><i>idx</i></tt>
of string
<tt><i>str</i></tt>
exists, and the string is modifiable, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
form denotes a place.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
place
supports deletion. When a deletion takes place,
then the character at
<tt><i>idx</i></tt>
is removed from the string. Any characters
after that position move by one position
to close the gap, and the length of the string
decreases by one.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
Direct use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
is equivalent to the DWIM bracket notation except
that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
must be a string. The following relation holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
78FEF2">chr-str</a> s i) --&gt; [s i]
</tt></pre><tt>

</tt>

<p>
since
<tt>[s i] &lt;--&gt; (ref s i)</tt>,
this also holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
78FEF2">chr-str</a> s i) --&gt; (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-01A419FB">ref</a> s i)
</tt></pre><tt>

</tt>

<p>
However, note the following difference. When the expression
<tt>[s i]</tt>
is used as a place, then the subexpression
<tt>s</tt>
must be a place. When
<tt>(chr-str s i)</tt>
is used as a place,
<tt>s</tt>
need not be a place.
</p><p>

</p></dd></dl>
<a name=3D"N-01743140">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.42">9.16.42<=
/a> Function <tt>chr-str-set</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chr-str-set </tt><tt><i>str</i></tt><tt> </tt><tt><i>idx</=
i></tt><tt> </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
function performs random access on string
<tt><i>str</i></tt>
to overwrite
the character whose position is given by integer
<tt><i>idx</i></tt>,
which must
be within range of the string. The character at
<tt><i>idx</i></tt>
is overwritten
with character
<tt><i>char</i></tt>.
</p><p>
The
<tt><i>idx</i></tt>
argument works exactly as in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>.
</p><p>
The
<tt><i>str</i></tt>
argument must be a modifiable string.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
Direct use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
is equivalent to the DWIM bracket notation provided that
<tt><i>str</i></tt>
is a string and
<tt><i>idx</i></tt>
an integer. The following relation holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
743140">chr-str-set</a> s i c) --&gt; (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#D-002F">set</a> [s i] c)
</tt></pre><tt>

</tt>

<p>
Since
<tt>(set [s i] c) &lt;--&gt; (refset s i c)</tt>
for an integer index
<tt>i</tt>,
this also holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
78FEF2">chr-str</a> s i) --&gt; (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-01A419FB">refset</a> s i c)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0394CA3A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.43">9.16.43<=
/a> Function <tt>span-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(span-str </tt><tt><i>str</i></tt><tt> </tt><tt><i>set</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0394CA3A">span-str<=
/a></tt>
function determines the longest prefix of string
<tt><i>str</i></tt>
which
consists only of the characters in string
<tt><i>set</i></tt>,
in any combination.
</p><p>

</p></dd></dl>
<a name=3D"N-0171717F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.44">9.16.44<=
/a> Function <tt>compl-span-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compl-span-str </tt><tt><i>str</i></tt><tt> </tt><tt><i>se=
t</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0171717F">compl-spa=
n-str</a></tt>
function determines the longest prefix of string
<tt><i>str</i></tt>
which
consists only of the characters which do not appear in
<tt><i>set</i></tt>,
in any combination.
</p><p>

</p></dd></dl>
<a name=3D"N-00A9DB25">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.16.45">9.16.45<=
/a> Function <tt>break-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(break-str </tt><tt><i>str</i></tt><tt> </tt><tt><i>set</i>=
</tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A9DB25">break-str=
</a></tt>
function returns an integer which represents the position of the
first character in string
<tt><i>str</i></tt>
which appears in string
<tt><i>set</i></tt>.
</p><p>
If there is no such character, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
</p></dd></dl>
<a name=3D"N-017F3F15">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17">9.17</a> La=
zy Strings</h3>



<p>


Lazy strings are objects that were developed for the <b>TXR</b> pattern mat=
ching
language, and are exposed via <b>TXR Lisp</b>. Lazy strings behave much lik=
e strings,
and can be substituted for strings. However, unlike regular strings, which
exist in their entirety, first to last character, from the moment they are
created, lazy strings do not exist all at once, but are created on demand. =
 If
character at index N of a lazy string is accessed, then characters 0 throug=
h N
of that string are forced into existence. However, characters at indices
beyond N need not necessarily exist.
</p><p>
A lazy string dynamically grows by acquiring new text from a list of string=
s
which is attached to that lazy string object.  When the lazy string is acce=
ssed
beyond the end of its hitherto materialized prefix, it takes enough strings
from the list in order to materialize the index. If the list doesn't have
enough material, then the access fails, just like an access beyond the end =
of a
regular string.  A lazy string always takes whole strings from the attached
list.
</p><p>
Lazy string growth is achieved via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0212FED6">lazy-str-=
force-upto</a></tt>
function which
forces a string to exist up to a given character position. This function is
used internally to handle various situations.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03269DEF">lazy-str-=
force</a></tt>
function forces the entire string to materialize.  If the
string is connected to an infinite lazy list, this will exhaust all memory.
</p><p>
Lazy strings are specially recognized in many of the regular string functio=
ns,
which do the right thing with lazy strings. For instance when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
is invoked on a lazy string, a special version of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
logic is
used which handles various lazy string cases, and can potentially return
another lazy string. Taking a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
of a lazy string from a given character position
to the end does not force the entire lazy string to exist,
and in fact the operation will work on a lazy string that is infinite.
</p><p>
Furthermore, special lazy string functions are provided which allow program=
s to
be written carefully to take better advantage of lazy strings. What careful=
ly
means is code that avoids unnecessarily forcing the lazy string.  For insta=
nce,
in many situations it is necessary to obtain the length of a string, only t=
o
test it for equality or inequality with some number. But it is not necessar=
y to
compute the length of a string in order to know that it is greater than som=
e
value.
</p><p>

<a name=3D"N-02AFF63D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.1">9.17.=
1</a> Function <tt>lazy-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lazy-str </tt><tt><i>string-list</i></tt><tt> [</tt><tt><i=
>terminator</i></tt><tt> [</tt><tt><i>limit-count</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AFF63D">lazy-str<=
/a></tt>
function constructs a lazy string which draws material from
<tt><i>string-list</i></tt>
which is a list of strings.
</p><p>
If the optional
<tt><i>terminator</i></tt>
argument is given, then it specifies a string
which is appended to every string from
<tt><i>string-list</i></tt>,
before that string is
incorporated into the lazy string. If
<tt><i>terminator</i></tt>
is not given,
then it defaults to the string
<tt>"\n"</tt>,
and so the strings from
<tt><i>string-list</i></tt>
are effectively treated as lines which get terminated by newlines
as they accumulate into the growing prefix of the lazy string.
To avoid the use of a terminator string, a null string
<tt><i>terminator</i></tt>
argument
must be explicitly passed. In that case, the lazy string grows simply
by catenating elements from
<tt><i>string-list</i></tt>.
</p><p>
If the
<tt><i>limit-count</i></tt>
argument is specified, it must be a positive integer.  It
expresses a maximum limit on how many elements will be consumed from
<tt><i>string-list</i></tt>
in order to feed the lazy string. Once that many elements are
drawn, the string ends, even if the list has not been exhausted.
</p><p>

</p></dd></dl>
<a name=3D"N-0381BB2A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.2">9.17.2</a=
> Function <tt>lazy-stringp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lazy-stringp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0381BB2A">lazy-stri=
ngp</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a lazy
string. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0212FED6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.3">9.17.3</a=
> Function <tt>lazy-str-force-upto</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lazy-str-force-upto </tt><tt><i>lazy-str</i></tt><tt> </tt=
><tt><i>index</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0212FED6">lazy-str-=
force-upto</a></tt>
function tries to instantiate the lazy string such that
the position given by
<tt><i>index</i></tt>
materializes. The
<tt><i>index</i></tt>
is a character
position, exactly as used in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0378FEF2">chr-str</=
a></tt>
function.
</p><p>
Some positions beyond
<tt><i>index</i></tt>
may also materialize, as a side effect.
</p><p>
If the string is already materialized through to at least
<tt><i>index</i></tt>,
or if it is
possible to materialize the string that far, then the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned to indicate success.
</p><p>
If there is insufficient material to force the lazy string through to the
<tt><i>index</i></tt>
position, then nil is returned.
</p><p>
It is an error if the
<tt><i>lazy-str</i></tt>
argument isn't a lazy string.
</p><p>

</p></dd></dl>
<a name=3D"N-03269DEF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.4">9.17.4</a=
> Function <tt>lazy-str-force</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lazy-str-force </tt><tt><i>lazy-str</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>lazy-str</i></tt>
argument must be a lazy string. The lazy string is forced
to fully materialize.
</p><p>
The return value is an ordinary, non-lazy string equivalent to the fully
materialized lazy string.
</p><p>

</p></dd></dl>
<a name=3D"N-012701D6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.5">9.17.5</a=
> Function <tt>lazy-str-get-trailing-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lazy-str-get-trailing-list </tt><tt><i>string</i></tt><tt>=
 </tt><tt><i>index</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012701D6">lazy-str-=
get-trailing-list</a></tt>
function can be considered, in some way, an inverse operation to
the production of the lazy string from its associated list.
</p><p>
First,
<tt><i>string</i></tt>
is forced up through the position
<tt><i>index</i></tt>.
That is the only extent to which
<tt><i>string</i></tt>
is modified by this function.
</p><p>
Next, the suffix of the materialized part of the lazy string starting at
position
<tt><i>index</i></tt>,
is split into pieces on occurrences of the
terminator character (which had been given as the
<tt><i>terminator</i></tt>
argument in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AFF63D">lazy-str<=
/a></tt>
constructor, and defaults to newline).   If the
<tt><i>index</i></tt>
position is beyond the part of the string which can be materialized
(in adherence with the lazy string's
<tt><i>limit-count</i></tt>
constructor parameter), then the list of pieces is considered
to be empty.
</p><p>
Finally, a list is returned consisting of the pieces produced by the split,
to which is appended the remaining list of the string which has not yet bee=
n
forced to materialize.
</p><p>

</p></dd></dl>
<a name=3D"N-016D8C45">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.6">9.17.6</a=
> Functions <tt>length-str-&gt;</tt>, <tt>length-str-&gt;=3D</tt>, <tt>leng=
th-str-&lt;</tt> and <tt>length-str-&lt;=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length-str-&gt; </tt><tt><i>string</i></tt><tt> </tt><tt><=
i>len</i></tt><tt>)=20




<br>&nbsp;&nbsp;(length-str-&gt;=3D </tt><tt><i>string</i></tt><tt> </tt><t=
t><i>len</i></tt><tt>)=20




<br>&nbsp;&nbsp;(length-str-&lt; </tt><tt><i>string</i></tt><tt> </tt><tt><=
i>len</i></tt><tt>)=20




<br>&nbsp;&nbsp;(length-str-&lt;=3D </tt><tt><i>string</i></tt><tt> </tt><t=
t><i>len</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions compare the lengths of two strings. The following
equivalences hold, as far as the resulting value is concerned:
</p><p>
<tt>
</tt></p><pre><tt>  (length-str-&gt; s l) &lt;--&gt; (&gt; (<a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-03E6D841">length-str</a> s) l)
  (length-str-&gt;=3D s l) &lt;--&gt; (&gt;=3D (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-03E6D841">length-str</a> s) l)
  (length-str-&lt; s l) &lt;--&gt; (&lt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-03E6D841">length-str</a> s) l)
  (length-str-&lt;=3D s l) &lt;--&gt; (&lt;=3D (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-03E6D841">length-str</a> s) l)
</tt></pre><tt>

</tt>

<p>
The difference between the functions and the equivalent forms is that if th=
e
string is lazy, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E6D841">length-st=
r</a></tt>
function will fully force it in order to
calculate and return its length.
</p><p>
These functions only force a string up to position
<tt><i>len</i></tt>,
so they are not
only more efficient, but on infinitely long lazy strings they are usable.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E6D841">length-st=
r</a></tt>
cannot compute the length of a lazy string with an unbounded
length; it will exhaust all memory trying to force the string.
</p><p>
These functions can be used to test such as string whether it is longer
or shorter than a given length, without forcing the string beyond
that length.
</p><p>

</p></dd></dl>
<a name=3D"N-0143A273">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.7">9.17.7</a=
> Function <tt>cmp-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cmp-str </tt><tt><i>left-string</i></tt><tt> </tt><tt><i>r=
ight-string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0143A273">cmp-str</=
a></tt>
function returns -1 if
<tt><i>left-string</i></tt>
is lexicographically prior to
<tt><i>right-string</i></tt>.
If the reverse relationship holds, it returns 1.
Otherwise the strings are equal
and zero is returned.
</p><p>
If either or both of the strings are lazy, then they are only forced to the
minimum extent necessary for the function to reach a conclusion and return =
the
appropriate value, since there is no need to look beyond the first characte=
r
position in which they differ.
</p><p>
The lexicographic ordering is naive, based on the character code point
values in Unicode taken as integers, without regard for locale-specific
collation orders.
</p><p>
Note: in <b>TXR</b> 232 and earlier versions,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0143A273">cmp-str</=
a></tt>
conforms to a weaker requirements: any negative integer value
may be returned rather than -1, and any positive integer value
can be returned instead of 1.
</p><p>

</p></dd></dl>
<a name=3D"N-01AA954A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.8">9.17.8</a=
> Functions <tt>str=3D</tt>, <tt>str&lt;</tt>, <tt>str&gt;</tt>, <tt>str&gt=
;=3D</tt> and <tt>str&lt;=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(str=3D </tt><tt><i>left-string</i></tt><tt> </tt><tt><i>ri=
ght-string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(str&lt; </tt><tt><i>left-string</i></tt><tt> </tt><tt><i>r=
ight-string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(str&gt; </tt><tt><i>left-string</i></tt><tt> </tt><tt><i>r=
ight-string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(str&lt;=3D </tt><tt><i>left-string</i></tt><tt> </tt><tt><=
i>right-string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(str&gt;=3D </tt><tt><i>left-string</i></tt><tt> </tt><tt><=
i>right-string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions compare
<tt><i>left-string</i></tt>
and
<tt><i>right-string</i></tt>
lexicographically,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0143A273">cmp-str</=
a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AA954A">str=3D</a=
></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the two strings are exactly the same, character
for character, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AA954A">str&lt;</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>left-string</i></tt>
is lexicographically before
<tt><i>right-string</i></tt>,
otherwise nil.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AA954A">str&gt;</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>left-string</i></tt>
is lexicographically after
<tt><i>right-string</i></tt>,
otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AA954A">str&lt;</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>left-string</i></tt>
is lexicographically before
<tt><i>right-string</i></tt>,
or if they are exactly the same, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AA954A">str&lt;</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>left-string</i></tt>
is lexicographically after
<tt><i>right-string</i></tt>,
or if they are exactly the same, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03ABBED1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.17.9">9.17.9</a=
> Function <tt>string-lt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(string-lt </tt><tt><i>left-str</i></tt><tt> </tt><tt><i>ri=
ght-str</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03ABBED1">string-lt=
</a></tt>
is a deprecated alias for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AA954A">str&lt;</=
a></tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-00BAB6A4">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18">9.18</a> Ve=
ctors</h3>



<p>



<a name=3D"N-02B6C6F1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.1">9.18.=
1</a> Function <tt>vector</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vector </tt><tt><i>length</i></tt><tt> [</tt><tt><i>initva=
l</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B6C6F1">vector</a=
></tt>
function creates and returns a vector object of the specified
length.  The elements of the vector are initialized to
<tt><i>initval</i></tt>,
or to nil if
<tt><i>initval</i></tt>
is omitted.
</p><p>

</p></dd></dl>
<a name=3D"N-0297F5F5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.2">9.18.2</a=
> Function <tt>vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vec </tt><tt><i>arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">vec</a></=
tt>
function creates a vector out of its arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-03B9C3E5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.3">9.18.3</a=
> Function <tt>vectorp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vectorp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B9C3E5">vectorp</=
a></tt>
function returns t if
<tt><i>obj</i></tt>
is a vector, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01723847">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.4">9.18.4</a=
> Function <tt>vec-set-length</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vec-set-length </tt><tt><i>vec</i></tt><tt> </tt><tt><i>le=
n</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01723847">vec-set-l=
ength</a></tt>
modifies the length of
<tt><i>vec</i></tt>,
making it longer or
shorter. If the vector is made longer, then the newly added elements
are initialized to nil. The
<tt><i>len</i></tt>
argument must be nonnegative.
</p><p>
The return value is
<tt><i>vec</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001963BF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.5">9.18.5</a=
> Accessor <tt>vecref</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vecref </tt><tt><i>vec</i></tt><tt> </tt><tt><i>idx</i></t=
t><tt>)=20




<br>&nbsp;&nbsp;(set (vecref </tt><tt><i>vec</i></tt><tt> </tt><tt><i>idx</=
i></tt><tt>) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001963BF">vecref</a=
></tt>
function performs indexing into a vector. It retrieves
an element of
<tt><i>vec</i></tt>
at position
<tt><i>idx</i></tt>,
counted from zero.
The
<tt><i>idx</i></tt>
value must range from 0 to one less than the
length of the vector. The specified element is returned.
</p><p>
If the element
<tt><i>idx</i></tt>
of vector
<tt><i>vec</i></tt>
exists, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001963BF">vecref</a=
></tt>
form denotes a place.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001963BF">vecref</a=
></tt>
place
supports deletion. When a deletion takes place,
then if
<tt><i>idx</i></tt>
denotes the last element in the vector, the
vector's length is decreased by one, so that
the vector no longer has that element.
Otherwise, if
<tt><i>idx</i></tt>
isn't the last element, then each elements
values at a higher index than
<tt><i>idx</i></tt>
shifts by one one element position to the
adjacent lower index. Then, the length of the
vector is decreased by one, so that the last
element position disappears.
</p><p>

</p></dd></dl>
<a name=3D"N-01693B82">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.6">9.18.6</a=
> Function <tt>vec-push</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vec-push </tt><tt><i>vec</i></tt><tt> </tt><tt><i>elem</i>=
</tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01693B82">vec-push<=
/a></tt>
function extends the length of a vector
<tt><i>vec</i></tt>
by one element, and
sets the new element to the value
<tt><i>elem</i></tt>.
</p><p>
The previous length of the vector (which is also the position of
<tt><i>elem</i></tt>)
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03D6D851">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.7">9.18.7</a=
> Function <tt>length-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length-vec </tt><tt><i>vec</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D6D851">length-ve=
c</a></tt>
function returns the length of vector
<tt><i>vec</i></tt>.
It performs
similarly to the generic
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function, except that the argument must
be a vector.
</p><p>

</p></dd></dl>
<a name=3D"N-01000634">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.8">9.18.8</a=
> Function <tt>size-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(size-vec </tt><tt><i>vec</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01000634">size-vec<=
/a></tt>
function returns the number of elements for which storage
is reserved in the vector
<tt><i>vec</i></tt>.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
of the vector can be extended up to this size without any memory
allocation operations having to be performed.
</p><p>

</p></dd></dl>
<a name=3D"N-03295612">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.9">9.18.9</a=
> Function <tt>vec-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vec-list </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03295612">vec-list<=
/a></tt>
function returns a vector which contains all of the same elements
and in the same order as list
<tt><i>list</i></tt>.
</p><p>
Note: this function is also known by the obsolescent name
<tt>vector-list</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00460235">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.10">9.18.10<=
/a> Function <tt>list-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(list-vec </tt><tt><i>vec</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00460235">list-vec<=
/a></tt>
function returns a list of the elements of vector
<tt><i>vec</i></tt>.
</p><p>
Note: this function is also known by the obsolescent name
<tt>list-vector</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-010E7635">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.11">9.18.11<=
/a> Function <tt>copy-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-vec </tt><tt><i>vec</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010E7635">copy-vec<=
/a></tt>
function returns a new vector object of the same length
as
<tt><i>vec</i></tt>
and containing the same elements in the same order.
</p><p>

</p></dd></dl>
<a name=3D"N-03BFFF0A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.12">9.18.12<=
/a> Accessor <tt>sub-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sub-vec </tt><tt><i>vec</i></tt><tt> [</tt><tt><i>from</i>=
</tt><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(set (sub-vec </tt><tt><i>vec</i></tt><tt> [</tt><tt><i>fro=
m</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]]) </tt><tt><i>new-value</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BFFF0A">sub-vec</=
a></tt>
function has the same parameters and semantics as the
function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>,
except that the
<tt><i>vec</i></tt>
argument must be a vector.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BFFF0A">sub-vec</=
a></tt>
form is used as a place, it denotes a subrange of
<tt><i>list</i></tt>
as if it were a storage location. The previous value of this location,
if needed, is fetched by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BFFF0A">sub-vec</=
a></tt>.
Storing
<tt><i>new-value</i></tt>
to the place is performed by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F59E62">replace-v=
ec</a></tt>.
In an update operation which accesses the prior value and stores a new valu=
e,
the arguments
<tt><i>vec</i></tt>,
<tt><i>from</i></tt>,
<tt><i>to</i></tt>
and
<tt><i>new-value</i></tt>
are evaluated once.
</p><p>
The
<tt><i>vec</i></tt>
argument is not itself required to be a place; it is not updated
when a value is written to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BFFF0A">sub-vec</=
a></tt>
storage location.
</p><p>

</p></dd></dl>
<a name=3D"N-01F59E62">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.13">9.18.13<=
/a> Function <tt>replace-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(replace-vec </tt><tt><i>vec</i></tt><tt> </tt><tt><i>item-=
sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to</i></t=
t><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F59E62">replace-v=
ec</a></tt>
is like the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function except that the
<tt><i>vec</i></tt>
argument must be a vector.
</p><p>

</p></dd></dl>
<a name=3D"N-01AEB28B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.18.14">9.18.14<=
/a> Function <tt>cat-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cat-vec </tt><tt><i>vec-list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>vec-list</i></tt>
argument is a list of vectors. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AEB28B">cat-vec</=
a></tt>
function
produces a catenation of the vectors listed in
<tt><i>vec-list</i></tt>.
It returns
a single large vector formed by catenating those vectors together in
order.
</p><p>
</p></dd></dl>
<a name=3D"N-01BCCCA1">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19">9.19</a> Bu=
ffers</h3>



<p>


</p><p>

<a name=3D"N-038187CC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.1">9.19.=
1</a> The <tt>buf</tt> type</h4>



<p>
Object of the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
are
<i>buffers</i>:

vector-like objects specialized for holding binary data represented as
a sequence of 8 bit bytes.  Buffers support operations specialized toward t=
he
encoding of Lisp values into machine-oriented data types, and decoding such
data types into Lisp values.
</p><p>
Buffers are particularly useful in conjunction with the Foreign Function
Interface (FFI), since they can be used to prepare arbitrary data which
can be passed into and out of a function by pointer. They are also useful f=
or
binary I/O.
</p><p>

<a name=3D"N-035546D9">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.2">9.19.=
2</a> Conventions Used by the <tt>buf-put-</tt> Functions</h4>



<p>
Buffers support a number of similar functions for converting Lisp numeric
values into common data types, which are placed into the buffer. These
functions are named starting with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035546D9">buf-put-<=
/a></tt>
prefix, followed by an abbreviated type name.
</p><p>
Each of these functions takes three arguments:
<tt><i>buf</i></tt>
specifies the buffer,
<tt><i>pos</i></tt>
specifies the byte offset position into the buffer which receives
the low-order byte of the data transfer, and
<tt><i>val</i></tt>
indicates the value.
</p><p>
If
<tt><i>pos</i></tt>
has a value such that any portion of the data transfer would
like outside of the buffer, the buffer is automatically extended
in length to contain the data transfer. If this extension causes
any padding bytes to appear between the previous length of the
buffer and
<tt><i>pos</i></tt>,
those bytes are initialized to zero.
</p><p>
The argument
<tt><i>val</i></tt>
giving the value to be stored must be an integer or character,
except in the case of the types
<tt><i>float</i></tt>
and
<tt><i>double</i></tt>(the
functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D2408">buf-put-f=
loat</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006A81D9">buf-put-d=
ouble</a></tt>)
for which it is required to be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>,
and in case of the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03690764">buf-put-c=
ptr</a></tt>
which expects the
<tt><i>val</i></tt>
argument to be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object.
</p><p>
The
<tt><i>val</i></tt>
argument must be in range for the data type, or an exception
results.
</p><p>
Unless otherwise indicated, the stored datum is in the local format
used by the machine with regard to byte order and other representational
details.
</p><p>

<a name=3D"N-0095470A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.3">9.19.=
3</a> Conventions Used by the <tt>buf-get-</tt> Functions</h4>



<p>
Buffers support a number of similar functions for extracting
common data types, and converting them into Lisp values.
These functions are named starting with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095470A">buf-get-<=
/a></tt>
prefix, followed by an abbreviated type name.
</p><p>
Each of these functions takes two arguments:
<tt><i>buf</i></tt>
specifies the buffer and
<tt><i>pos</i></tt>
specifies the byte offset position into the buffer which holds
the low-order byte of the datum to be extracted.
</p><p>
If any portion of requested datum lies outside of the boundaries
of the buffer, an error exception is thrown.
</p><p>
The extracted value is converted to a Lisp datum. For the
majority of these functions, the returned value is of type
integer. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D239A">buf-get-f=
loat</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006C6EB9">buf-get-d=
ouble</a></tt>
return a floating-point value.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E90766">buf-get-c=
ptr</a></tt>
function returns a value of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
</p><p>

<a name=3D"N-011445E1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.4">9.19.=
4</a> Function <tt>make-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-buf </tt><tt><i>len</i></tt><tt> [</tt><tt><i>init-va=
l</i></tt><tt> [</tt><tt><i>alloc-size</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011445E1">make-buf<=
/a></tt>
function creates a new buffer object which holds
<tt><i>len</i></tt>
bytes. This argument may be zero.
</p><p>
If
<tt><i>init-val</i></tt>
is present, it specifies the value with which the first
<tt><i>len</i></tt>
byte of the buffer are initialized. If omitted, it
defaults to zero.
bytes. The value of
<tt><i>init-val</i></tt>
must lie in the range 0 to 255.
</p><p>
The
<tt><i>alloc-size</i></tt>
parameter indicates how much memory to actually allocate for
the buffer.
If an argument is not given, the parameter takes on
the same value as
<tt><i>len</i></tt>.
If an argument is given, its value must not be less than
<tt><i>len</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02C6CEE4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.5">9.19.5</a=
> Function <tt>bufp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bufp </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C6CEE4">bufp</a><=
/tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>,
otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0026D89A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.6">9.19.6</a=
> Function <tt>length-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length-buf </tt><tt><i>buf</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026D89A">length-bu=
f</a></tt>
function retrieves the buffer length: how many bytes are stored
in the buffer.
</p><p>
Note: the generic
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function is also applicable to buffers.
</p><p>

</p></dd></dl>
<a name=3D"N-013A3727">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.7">9.19.7</a=
> Function <tt>buf-alloc-size</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-alloc-size </tt><tt><i>buf</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A3727">buf-alloc=
-size</a></tt>
function retrieves the allocation size of the buffer.
</p><p>

</p></dd></dl>
<a name=3D"N-0057FBE2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.8">9.19.8</a=
> Function <tt>buf-trim</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-trim </tt><tt><i>buf</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057FBE2">buf-trim<=
/a></tt>
function reduces the amount of memory allocated to the buffer
to the minimum required to hold it contents, effectively
setting the allocation size to the current length.
</p><p>
The previous allocation size is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-01208847">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.9">9.19.9</a=
> Function <tt>buf-set-length</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-set-length </tt><tt><i>buf</i></tt><tt> </tt><tt><i>le=
n</i></tt><tt> [</tt><tt><i>init-val</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01208847">buf-set-l=
ength</a></tt>
function changes the length of the buffer. If the buffer
is made longer, the newly added bytes appear at the end,
and are initialized to the value given by
<tt><i>init-val</i></tt>.
If
<tt><i>init-val</i></tt>
is specified, its value must be in the range 0 to 255.
It defaults to zero.
</p><p>

</p></dd></dl>
<a name=3D"N-00BE75E1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.10">9.19.10<=
/a> Function <tt>copy-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-buf </tt><tt><i>buf</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE75E1">copy-buf<=
/a></tt>
function returns a duplicate of
<tt><i>buf</i></tt>:
an object distinct from
<tt><i>buf</i></tt>
which has the same length and contents, and compares
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>buf</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-000FFE37">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.11">9.19.11<=
/a> Accessor <tt>sub-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sub-buf </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>from</i>=
</tt><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(set (sub-buf </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>fro=
m</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]]) </tt><tt><i>new-val</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000FFE37">sub-buf</=
a></tt>
function has the same semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
function, except that the first argument must be a buffer.
</p><p>
The extracted sub-range of a buffer is itself a buffer object.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000FFE37">sub-buf</=
a></tt>
is used as a syntactic place, the argument expressions
<tt><i>buf</i></tt>,
<tt><i>from</i></tt>,
<tt><i>to</i></tt>
and
<tt><i>new-val</i></tt>
are evaluated just once. The prior value, if required, is accessed by calli=
ng
<tt>buf-sub</tt>
and
<tt><i>new-val</i></tt>
is then stored via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C59E4E">replace-b=
uf</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01C59E4E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.12">9.19.12<=
/a> Function <tt>replace-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(replace-buf </tt><tt><i>buf</i></tt><tt> </tt><tt><i>item-=
sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to</i></t=
t><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C59E4E">replace-b=
uf</a></tt>
function has the same semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function, except that the first argument must be a buffer.
</p><p>
The elements of
<tt>item-sequence</tt>
are stored into
<tt><i>buf</i></tt>
as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002F6556">buf-put-u=
8</a></tt>
function and therefore must be suitable
<tt><i>val</i></tt>
arguments for that function.
</p><p>
The of the arguments, semantics and return value given for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
apply to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C59E4E">replace-b=
uf</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03E81617">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.13">9.19.13<=
/a> Function <tt>buf-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-list </tt><tt><i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E81617">buf-list<=
/a></tt>
function creates and returns a new buffer, whose contents are derived from =
the
elements of
<tt><i>list</i></tt>,
which may be any kind of sequence.
</p><p>
The elements of
<tt><i>list</i></tt>
must be integers whose values lie in the range 0 to 255, or else
characters whose code point values lie in that range.
These values are placed into the newly created buffer, which
therefore has the same length as
<tt><i>list</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-009FC934">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.14">9.19.14<=
/a> Function <tt>buf-put-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-buf </tt><tt><i>dst-buf</i></tt><tt> </tt><tt><i>p=
os</i></tt><tt> </tt><tt><i>src-buf</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009FC934">buf-put-b=
uf</a></tt>
function stores a copy of buffer
<tt><i>src-buf</i></tt>
into
<tt><i>dst-buf</i></tt>
at the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The source and destination memory regions may overlap.
</p><p>
The return value is
<tt><i>src-buf</i></tt>.
</p><p>
Note: the effect of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009FC934">buf-put-b=
uf</a></tt>
operation may also be performed by a suitable call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C59E4E">replace-b=
uf</a></tt>;
however,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009FC934">buf-put-b=
uf</a></tt>
is less general: it doesn't insert or delete by replacing
destination ranges with data of differing length,
and requires a source operand of buffer type.
</p><p>

</p></dd></dl>
<a name=3D"N-002F655F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.15">9.19.15<=
/a> Function <tt>buf-put-i8</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-i8 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</i=
></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002F655F">buf-put-i=
8</a></tt>
converts
<tt><i>val</i></tt>
into an eight bit signed integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-002F6556">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.16">9.19.16<=
/a> Function <tt>buf-put-u8</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-u8 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</i=
></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002F6556">buf-put-u=
8</a></tt>
converts
<tt><i>val</i></tt>
into an eight bit unsigned integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-019FC970">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.17">9.19.17<=
/a> Function <tt>buf-put-i16</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-i16 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019FC970">buf-put-i=
16</a></tt>
converts
<tt><i>val</i></tt>
into a sixteen bit signed integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-019FC960">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.18">9.19.18<=
/a> Function <tt>buf-put-u16</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-u16 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019FC960">buf-put-u=
16</a></tt>
converts
<tt><i>val</i></tt>
into a sixteen bit unsigned integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-035FC973">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.19">9.19.19<=
/a> Function <tt>buf-put-i32</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-i32 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035FC973">buf-put-i=
32</a></tt>
converts
<tt><i>val</i></tt>
into a 32 bit signed integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-035FC963">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.20">9.19.20<=
/a> Function <tt>buf-put-u32</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-u32 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035FC963">buf-put-u=
32</a></tt>
converts
<tt><i>val</i></tt>
into a 32 bit unsigned integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007FC973">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.21">9.19.21<=
/a> Function <tt>buf-put-i64</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-i64 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007FC973">buf-put-i=
64</a></tt>
converts
<tt><i>val</i></tt>
into a 64 bit signed integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007FC963">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.22">9.19.22<=
/a> Function <tt>buf-put-u64</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-u64 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007FC963">buf-put-u=
64</a></tt>
converts the value
<tt><i>val</i></tt>
into a 64 bit unsigned integer, and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00690748">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.23">9.19.23<=
/a> Function <tt>buf-put-char</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-char </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00690748">buf-put-c=
har</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
The return value is
<tt><i>val</i></tt>.
</p><p>
Note that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
type may be signed or unsigned.
</p><p>

</p></dd></dl>
<a name=3D"N-03BCF627">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.24">9.19.24<=
/a> Function <tt>buf-put-uchar</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-uchar </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BCF627">buf-put-u=
char</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt>unsigned char</tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-031CE904">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.25">9.19.25<=
/a> Function <tt>buf-put-short</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-short </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031CE904">buf-put-s=
hort</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">short</a>=
</tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-035696C9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.26">9.19.26<=
/a> Function <tt>buf-put-ushort</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-ushort </tt><tt><i>buf</i></tt><tt> </tt><tt><i>po=
s</i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035696C9">buf-put-u=
short</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt>unsigned short</tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007FC982">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.27">9.19.27<=
/a> Function <tt>buf-put-int</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-int </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007FC982">buf-put-i=
nt</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-018913CB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.28">9.19.28<=
/a> Function <tt>buf-put-uint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-uint </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018913CB">buf-put-u=
int</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt>unsigned int</tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00990DE3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.29">9.19.29<=
/a> Function <tt>buf-put-long</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-long </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00990DE3">buf-put-l=
ong</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">long</a><=
/tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-020CF007">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.30">9.19.30<=
/a> Function <tt>buf-put-ulong</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-ulong </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020CF007">buf-put-u=
long</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt>unsigned long</tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001D2408">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.31">9.19.31<=
/a> Function <tt>buf-put-float</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-float </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D2408">buf-put-f=
loat</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>
Note: the conversion of a <b>TXR Lisp</b> floating-point value
to the C type float may be inexact, reducing the
numeric precision.
</p><p>

</p></dd></dl>
<a name=3D"N-006A81D9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.32">9.19.32<=
/a> Function <tt>buf-put-double</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-double </tt><tt><i>buf</i></tt><tt> </tt><tt><i>po=
s</i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006A81D9">buf-put-d=
ouble</a></tt>
converts
<tt><i>val</i></tt>
into a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>
and stores it into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03690764">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.33">9.19.33<=
/a> Function <tt>buf-put-cptr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-put-cptr </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03690764">buf-put-c=
ptr</a></tt>
expects
<tt><i>val</i></tt>
to be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
It stores the object's pointer value into the buffer at
the offset indicated by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0013E55F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.34">9.19.34<=
/a> Function <tt>buf-get-i8</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-i8 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0013E55F">buf-get-i=
8</a></tt>
function extracts and returns signed eight bit integer from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0013E556">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.35">9.19.35<=
/a> Function <tt>buf-get-u8</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-u8 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0013E556">buf-get-u=
8</a></tt>
function extracts and returns an unsigned eight bit integer from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02E7C970">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.36">9.19.36<=
/a> Function <tt>buf-get-i16</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-i16 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7C970">buf-get-i=
16</a></tt>
function extracts and returns a signed 16 bit integer  from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02E7C960">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.37">9.19.37<=
/a> Function <tt>buf-get-u16</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-u16 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7C960">buf-get-u=
16</a></tt>
function extracts and returns an unsigned 16 bit integer  from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0127C970">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.38">9.19.38<=
/a> Function <tt>buf-get-i32</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-i32 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0127C970">buf-get-i=
32</a></tt>
function extracts and returns a signed 32 bit integer  from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0127C960">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.39">9.19.39<=
/a> Function <tt>buf-get-u32</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-u32 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0127C960">buf-get-u=
32</a></tt>
function extracts and returns an unsigned 32 bit integer  from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03C7C972">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.40">9.19.40<=
/a> Function <tt>buf-get-i64</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-i64 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7C972">buf-get-i=
64</a></tt>
function extracts and returns a signed 64 bit integer  from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03C7C962">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.41">9.19.41<=
/a> Function <tt>buf-get-u64</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-u64 </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7C962">buf-get-u=
64</a></tt>
function extracts and returns an unsigned 64 bit integer  from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03E9074A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.42">9.19.42<=
/a> Function <tt>buf-get-char</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-char </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9074A">buf-get-c=
har</a></tt>
function extracts and returns a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
may be signed or unsigned.
</p><p>

</p></dd></dl>
<a name=3D"N-03BCF5D1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.43">9.19.43<=
/a> Function <tt>buf-get-uchar</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-uchar </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BCF5D1">buf-get-u=
char</a></tt>
function extracts and returns a value of the C type
<tt>unsigned char</tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-031CE896">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.44">9.19.44<=
/a> Function <tt>buf-get-short</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-short </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031CE896">buf-get-s=
hort</a></tt>
function extracts and returns a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">short</a>=
</tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-035691E9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.45">9.19.45<=
/a> Function <tt>buf-get-ushort</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-ushort </tt><tt><i>buf</i></tt><tt> </tt><tt><i>po=
s</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035691E9">buf-get-u=
short</a></tt>
function extracts and returns a value of the C type
<tt>unsigned short</tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03C7C985">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.46">9.19.46<=
/a> Function <tt>buf-get-int</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-int </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C7C985">buf-get-i=
nt</a></tt>
function extracts and returns a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-030913C8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.47">9.19.47<=
/a> Function <tt>buf-get-uint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-uint </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030913C8">buf-get-u=
int</a></tt>
function extracts and returns a value of the C type
<tt>unsigned int</tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02190DE0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.48">9.19.48<=
/a> Function <tt>buf-get-long</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-long </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02190DE0">buf-get-l=
ong</a></tt>
function extracts and returns a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">long</a><=
/tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-020CEF9D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.49">9.19.49<=
/a> Function <tt>buf-get-ulong</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-ulong </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020CEF9D">buf-get-u=
long</a></tt>
function extracts and returns a value of the C type
<tt>unsigned long</tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001D239A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.50">9.19.50<=
/a> Function <tt>buf-get-float</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-float </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D239A">buf-get-f=
loat</a></tt>
function extracts and returns a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>,
returning that value as a Lisp floating-point number.
</p><p>

</p></dd></dl>
<a name=3D"N-006C6EB9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.51">9.19.51<=
/a> Function <tt>buf-get-double</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-double </tt><tt><i>buf</i></tt><tt> </tt><tt><i>po=
s</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006C6EB9">buf-get-d=
ouble</a></tt>
function extracts and returns a value of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>
from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>,
returning that value as a Lisp floating-point number.
</p><p>

</p></dd></dl>
<a name=3D"N-00E90766">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.52">9.19.52<=
/a> Function <tt>buf-get-cptr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-get-cptr </tt><tt><i>buf</i></tt><tt> </tt><tt><i>pos<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E90766">buf-get-c=
ptr</a></tt>
function extracts a C pointer from
<tt><i>buf</i></tt>
at the offset given by
<tt><i>pos</i></tt>,
returning that value as a Lisp object of type
<tt>cnum</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-021DB1B7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.53">9.19.53<=
/a> Function <tt>put-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(put-buf </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>pos</i><=
/tt><tt> [</tt><tt><i>stream</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
function writes the contents of buffer
<tt><i>buf</i></tt>,
starting at position
<tt><i>pos</i></tt>
to a stream, through to the last byte, if possible.
Successive bytes from the buffer are written to the stream as if by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
operation.
</p><p>
If
<tt><i>stream</i></tt>
is omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>.
</p><p>
If
<tt><i>pos</i></tt>
is omitted, it defaults to zero.
It indicates the starting position within the buffer.
</p><p>
The stream must support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
operation. Streams which support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
can be expected to support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
and, conversely, streams which do not support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
do not support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
function returns the position of the last byte that was successfully writte=
n.
If the buffer was written through to the end, then this value corresponds t=
o
the length of the buffer.
</p><p>
If an error occurs before any bytes are written, the function
throws an error.
</p><p>

</p></dd></dl>
<a name=3D"N-00D142E1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.54">9.19.54<=
/a> Functions <tt>fill-buf</tt> and <tt>fill-buf-adjust</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fill-buf </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>pos</i>=
</tt><tt> [</tt><tt><i>stream</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(fill-buf-adjust </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>=
pos</i></tt><tt> [</tt><tt><i>stream</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
reads bytes from
<tt><i>stream</i></tt>
and writes them into consecutive locations in buffer
<tt><i>buf</i></tt>
starting at position
<tt><i>pos</i></tt>.
The bytes are read as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
function.
</p><p>
If the
<tt><i>stream</i></tt>
argument is omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>.
</p><p>
If
<tt><i>pos</i></tt>
is omitted, it defaults to zero.
It indicates the starting position within the buffer.
</p><p>
The stream must support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
operation. Buffers which support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
can be expected to support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
and, conversely, streams which do not support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
do not support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
function returns the position that is one byte past the last byte that
was successfully read.
If an end-of-file or other error condition occurs before the buffer is fill=
ed
through to the end, then the value returned is smaller than the buffer leng=
th.
In this case, the area of the buffer beyond the read size retains its previ=
ous
content.
</p><p>
If an error situation occurs other than a premature end-of-file before
any bytes are read, then an exception is thrown.
</p><p>
If an end-of-file condition occurs before any bytes are read, then zero
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D142E1">fill-buf-=
adjust</a></tt>
differs usefully from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
as follows. Whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
doesn't manipulate the length of the buffer at any stage of the operation, =
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D142E1">fill-buf-=
adjust</a></tt>
begins by adjusting the length of the buffer to the underlying allocated si=
ze.
Then it performs the fill operation in
exactly the same manner as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>.
Finally, if the operation succeeds, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D142E1">fill-buf-=
adjust</a></tt>
adjusts the length of the buffer to match the position that is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-007FD2F9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.55">9.19.55<=
/a> Function <tt>get-line-as-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-line-as-buf [</tt><tt><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007FD2F9">get-line-=
as-buf</a></tt>
reads bytes from
<tt><i>stream</i></tt>
as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
function, until either a the newline character is encountered, or else the =
end
of input is encountered. The bytes which are read, exclusive of the newline
character, are returned in a new buffer object.  The newline character, if =
it
occurs, is consumed.
</p><p>
If
<tt><i>stream</i></tt>
is omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>.
</p><p>
The stream is required to support byte input.
</p><p>

</p></dd></dl>
<a name=3D"N-00FA177D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.56">9.19.56<=
/a> Functions <tt>file-get-buf</tt> and <tt>command-get-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(file-get-buf </tt><tt><i>name</i></tt><tt> [</tt><tt><i>ma=
x-bytes</i></tt><tt> [</tt><tt><i>skip-bytes</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(command-get-buf </tt><tt><i>cmd</i></tt><tt> [</tt><tt><i>=
max-bytes</i></tt><tt> [</tt><tt><i>skip-bytes</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FA177D">file-get-=
buf</a></tt>
function opens a binary stream over the file indicated by the string argume=
nt
<tt><i>name</i></tt>
for reading. By default, the entire file is read and its contents are retur=
ned as a
buffer object. The buffer's length corresponds to the number of bytes
read from the file.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FA177D">command-g=
et-buf</a></tt>
function opens a binary stream over an input command pipe created for
the command string
<tt><i>cmd</i></tt>,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function.  It read bytes from the pipe until the indication that no more
input is available. The bytes are returned aggregated into a buffer object.
</p><p>
If the
<tt><i>max-bytes</i></tt>
parameter is given an argument, it must be a non-negative integer.
That value specifies a limit on the number of bytes to read. A buffer
no longer than
<tt><i>max-bytes</i></tt>
shall be returned.
</p><p>
If the
<tt><i>skip-bytes</i></tt>
parameter is given an argument, it must be a non-negative integer.
That value specifies how many initial bytes of the input should be
discarded before accumulation of the buffer begins.
If possible, the semantics of this parameter is achieved by performing a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>
operation, falling back on reading and discarding bytes if the
stream doesn't support seeking.
</p><p>

</p></dd></dl>
<a name=3D"N-02AE3A31">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.57">9.19.57<=
/a> Functions <tt>file-put-buf</tt>, <tt>file-append-buf</tt> and <tt>comma=
nd-put-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(file-put-buf </tt><tt><i>name</i></tt><tt> </tt><tt><i>buf=
</i></tt><tt> </tt><tt><i>skip-bytes</i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-place-buf </tt><tt><i>name</i></tt><tt> </tt><tt><i>b=
uf</i></tt><tt> </tt><tt><i>skip-bytes</i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-append-buf </tt><tt><i>name</i></tt><tt> </tt><tt><i>=
buf</i></tt><tt>)=20




<br>&nbsp;&nbsp;(command-put-buf </tt><tt><i>cmd</i></tt><tt> </tt><tt><i>b=
uf</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE3A31">file-put-=
buf</a></tt>
function opens a text stream over the file indicated by the string argument
<tt><i>name</i></tt>,
writes the contents of the buffer object
<tt><i>buf</i></tt>
into the file, and then closes the file.  If the file doesn't exist, it is
created.  If it exists, it is truncated to zero length and overwritten.
The default value of the optional
<tt><i>skip-bytes</i></tt>
parameter is zero. If an argument is given, it must be a non-negative integ=
er.
If it is nonzero, then after opening the file, before writing the buffer,
the function will seek to an offset of that many bytes from the start of th=
e
file. The contents of
<tt><i>buf</i></tt>
will be written at that offset.
</p><p>
The
<tt>file-place-buf</tt>
function does not truncate an existing file to zero length.
In all other regards, it is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE3A31">file-put-=
buf</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE3A31">file-appe=
nd-buf</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE3A31">file-put-=
buf</a></tt>
except that if the file exists, it isn't overwritten. Rather, the buffer
is appended to the file.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE3A31">command-p=
ut-buf</a></tt>
function opens an output text stream over an output command pipe created
for the command specified in the string argument
<tt><i>cmd</i></tt>,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function.
It then writes the contents of buffer
<tt><i>buf</i></tt>
into the stream and closes the stream.
</p><p>
The return value of all three functions is that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
operation which is implicitly performed.
</p><p>

</p></dd></dl>
<a name=3D"N-012BF6AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.58">9.19.58<=
/a> Functions <tt>buf-str</tt> and <tt>str-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-str </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>null-ter=
m-p</i></tt><tt>])=20




<br>&nbsp;&nbsp;(str-buf </tt><tt><i>str</i></tt><tt> [</tt><tt><i>null-ter=
m-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012BF6AD">buf-str</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012BF6AD">str-buf</=
a></tt>
functions perform UTF-8 conversion between the buffer and character string
data types.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012BF6AD">buf-str</=
a></tt>
function takes the contents of buffer
<tt><i>buf</i></tt>
to be UTF-8 data, which is converted to a character string and returned.
Null bytes in the buffer are mapped to the pseudo-null character
<tt>#\xDC00</tt>.
If a true argument is given to the
<tt><i>null-term-p</i></tt>
parameter, then if the contents of
<tt><i>buf</i></tt>
end in a null byte, that byte is not included in the conversion.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012BF6AD">str-buf</=
a></tt>
function UTF-8-encodes
<tt><i>str</i></tt>
and returns a buffer containing the converted representation.
If a true argument is given to the
<tt><i>null-term-p</i></tt>
parameter, then a null terminating byte is added to the buffer.
This byte is added even if the previous byte is already a null byte
from the conversion of a pseudo-null character occurring in
<tt><i>str</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0291625A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.59">9.19.59<=
/a> Functions <tt>buf-int</tt> and <tt>buf-uint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-int </tt><tt><i>integer</i></tt><tt> )=20




<br>&nbsp;&nbsp;(buf-uint </tt><tt><i>integer</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-int</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-uint<=
/a></tt>
functions convert a signed and unsigned integer, respectively, or else a
character, into a binary representation, which is returned as a buffer obje=
ct.
</p><p>
Under both functions, the representation uses big endian byte order: most
significant byte first.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-uint<=
/a></tt>
function requires a non-negative
<tt><i>integer</i></tt>
argument, which may be a character. The representation stored in the
buffer is a pure binary representation of the value using the smallest
number of bytes required for the given
<tt><i>integer</i></tt>
value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-int</=
a></tt>
function requires an integer or character argument. The representation
stored in the buffer is a two's complement representation of
<tt><i>integer</i></tt>
using the smallest number of bytes which can represent that value.
If
<tt><i>integer</i></tt>
is non-negative, then the first byte of the buffer lies in the range
0 to 127.
If
<tt><i>integer</i></tt>
is negative, then the first byte of the buffer lies in the range 128 to 255=
.
The integer 255 therefore doesn't convert to the buffer
<tt>#b'ff'</tt>
but rather
<tt>#b'00ff'</tt>.
The buffer
<tt>#b'ff'</tt>
represents -1.
</p><p>
If the
<tt><i>integer</i></tt>
argument is a character object, it is taken to be its Unicode code
point value, as returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000AEC8B">int-chr</=
a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-00DCFA5F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.19.60">9.19.60<=
/a> Functions <tt>int-buf</tt> and <tt>uint-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(int-buf </tt><tt><i>buf</i></tt><tt> )=20




<br>&nbsp;&nbsp;(uint-buf </tt><tt><i>buf</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">int-buf</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">uint-buf<=
/a></tt>
functions recover an integer value from its binary form which appears
inside
<tt><i>buf</i></tt>,
which must be a buffer object. These functions expect
<tt><i>buf</i></tt>
to contain the representation produced by, respectively, the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-int</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-uint<=
/a></tt>.
</p><p>
If
<tt><i>buf</i></tt>
holds the representation of an integer value
<tt><i>n</i></tt>,
as produced by
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-int</a> =
</tt><tt><i>n</i></tt><tt>)=20

</tt>

then
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">int-buf</a> =
</tt><tt><i>buf</i></tt><tt>)=20

</tt>

returns
<tt><i>n</i></tt>.
</p><p>
The same relationship holds between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-uint<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">uint-buf<=
/a></tt>.
</p><p>
Thus, these equalities hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
6A">=3D</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">=
int-buf</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">=
buf-int</a> </tt><tt><i>n</i></tt><tt>)) </tt><tt><i>n</i></tt><tt>)=20
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCFA5F">uint-buf</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-uint</a> </tt=
><tt><i>n</i></tt><tt>)) </tt><tt><i>n</i></tt><tt>)=20
</tt></pre><tt>

</tt>

<p>
provided that
<tt><i>n</i></tt>
is of integer type and, in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0291625A">buf-uint<=
/a></tt>,
nonnegative.
</p><p>
</p></dd></dl>
<a name=3D"N-03ACAF25">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20">9.20</a> St=
ructures</h3>



<p>


</p><p>
<b>TXR</b> supports application-defined types in the form of structures. St=
ructures
are objects which hold multiple storage locations called slots, which are n=
amed
by symbols.  Structures can be related to each other by inheritance. Multip=
le
inheritance is permitted.
</p><p>
The type of a structure is itself an object, of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>.
</p><p>
When the program defines a new structure type, it does so by creating a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
instance, with properties which describe the new structure type: its
name, its list of slots, its initialization and "boa constructor" functions=
,
and the structures type it inherits from (the
<i>supertypes</i>).

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
object is then used to generate instances.
</p><p>
Structures instances are not only containers which hold named slots, but th=
ey
also indicate their struct type. Two structures which have the same number =
of
slots having the same names are not necessarily of the same type.
</p><p>
Structure types and structures may be created and manipulated using
a programming interface based on functions.
</p><p>
For more convenient and clutter-free expression of structure-based
program code, macros are also provided.
</p><p>
Furthermore, concise and expressive slot access syntax is provided courtesy=
 of
the referencing dot and unbound referencing dot syntax, a syntactic sugar
for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
macros.
</p><p>
Structure types have a name, which is a symbol. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F81275">typeof</a=
></tt>
function, when applied to any struct type, returns the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>.
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F81275">typeof</a=
></tt>
is applied to a struct instance, it returns the name of
the struct type. Effectively, struct names are types.
</p><p>
The consequences are unspecified if an existing struct name is re-used for =
a
different struct type, or an existing type name is used for a struct type.
</p><p>
<a name=3D"N-00BFD56E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.1">9.20.=
1</a> Static Slots</h4>


<p>
Structure slots can be of two kinds: they can be the ordinary instance slot=
s or
they can be static slots.  The instances of a given structure type have the=
ir
own instance of a given instance slot. However, they all share a single
instance of a static slot.
</p><p>
Static slots are allocated in a global area associated with a structure typ=
e
and are initialized when the structure type is created. They are useful for
efficiently representing properties which have the same value for all insta=
nces
of a struct. These properties don't have to occupy space in each instance, =
and
time doesn't have to be wasted initializing them each time a new instance i=
s
created.  Static slots are also useful for struct-specific global variables=
.
Lastly, static slots are also useful for holding methods and functions.
Although structures can have methods and functions in their instances, usua=
lly,
all structures of the same type share the same functions. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro supports a special syntax for defining methods and struct-specific
functions at the same time when a new structure type is defined.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
macro can be used for adding new methods and functions to an existing
structure and its descendants.
</p><p>
Static slots may be assigned just like instance slots. Changing a static
slot changes that slot in every structure of the same type.
</p><p>
Static slots are not listed in the
<tt>#S(...)</tt>
notation when a structure is printed. When the structure notation is
read from a stream, if static slots are present, they will be processed
and their values stored in the static locations they represent, thus
changing their values for all instances.
</p><p>
Static slots are inherited just like instance slots. The following
simplified discussion is restricted to single inheritance. A detailed
description of multiple inheritance is given in the Multiple Inheritance
section below.  If a given structure
<tt><i>B</i></tt>
has some static slot
<tt><i>s</i></tt>,
and a new structure
<tt><i>D</i></tt>
is derived from
<tt><i>B</i></tt>,
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>,
and does not define a slot
<tt><i>s</i></tt>,
then
<tt><i>D</i></tt>
inherits
<tt><i>s</i></tt>.
This means that
<tt><i>D</i></tt>
shares the static slot with
<tt><i>B</i></tt>:
both types share a single instance of that slot.
</p><p>
On the other hand if
<tt>D</tt>
defines a static slot
<tt><i>s</i></tt>
then that slot will have its own instance in the
<tt><i>D</i></tt>
structure type;
<tt><i>D</i></tt>
will not inherit the
<tt><i>B</i></tt>
instance of slot
<tt><i>s</i></tt>.
Moreover, if the the definition of
<tt>D</tt>
omits the
<tt><i>init-form</i></tt>
for slot
<tt><i>s</i></tt>,
then that slot will be initialized with a copy of the current value of slot
<tt><i>s</i></tt>
of the
<tt><i>B</i></tt>
base type, which allows derived types to obtain the value of base type's
static slot, yet have that in their own instance.
</p><p>
The slot type can be overridden. A structure type deriving from another
type can introduce slots which have the same names as the supertype,
but are of a different kind: an instance slot in the supertype
can be replaced by a static slot in the derived type or
<i>vice versa</i>.

</p><p>
Note that, in light of the above type overriding possibility, the static sl=
ot
value propagation happens only from the immediate supertype.
If
<tt>D</tt>
is is derived from
<tt>G</tt>
which has a static slot
<tt>s</tt>,
whereas
<tt>D</tt>
specifies
<tt>s</tt>
as an instance slot, but then
<tt>B</tt>
again specifies a static slot
<tt>s</tt>,
then
<tt>B</tt>'s
slot
<tt>s</tt>
will not inherit the value from
<tt>G</tt>'s
<tt>s</tt>
slot.
Simply,
<tt>B</tt>'s
supertype is
<tt>D</tt>
and that supertype is not considered to have a static slot
<tt>s</tt>.
</p><p>
A structure type is associated with a static initialization function
which may be used to store initial values into static slots. This function
is invoked once in a type's life time, when the type is created.
The function is also inherited by derived struct types and invoked when
they are created.
</p><p>
<a name=3D"N-02FDE09D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.2">9.20.=
2</a> Multiple Inheritance</h4>


When a structure type is defined, two or more supertypes may be specified. =
 The
new structure type then potentially inherits instance and static slots from=
 all
of the specified supertypes, and is considered to be a subtype of all of th=
em.
This situation with two or more supertypes is called
<i>multiple inheritance</i>.

The contrasting term is
<i>single inheritance</i>,

denoting the situation when a structure has exactly one supertype.
<b>TXR Lisp</b>'s struct types initially permitted only single inheritance.
Multiple inheritance support was introduced in version 229, as a
straightforward extension of single inheritance semantics.
<p>
In the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
function and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro, a list of supertypes can be given instead of just one.
The type then inherits slots from all of the specified types.
If any conflicts arise among the supertypes due to slots having the same na=
me,
the leftmost supertype dominates: that type's slot will be inherited.
If the leftmost slot is static, then that static slot will be inherited.
Otherwise, the instance slot will be inherited.
</p><p>
Of course, any slot which is specified in the newly defined type itself
dominates over any same-named slots among the supertypes.
</p><p>
The new structure type inherits all of the slot initializing expressions, a=
s
well as
<tt>:init</tt>
and
<tt>:postinit</tt>
methods of all of its supertypes.
</p><p>
Each time the structure is instantiated, the
<tt>:init</tt>
initializing expressions inherited from the supertypes, together with the s=
lot
initializing expressions, are all evaluated, in right-to-left order:
the initializations contributed by each supertype are performed before
considering the next supertype to the left.
The
<tt>:postinit</tt>
methods are similarly invoked in right-to-left order, before the
<tt>:postinit</tt>
methods of the new type itself.
Thus the order is: supertype inits, own inits, supertype post-inits,
own post-inits.
</p><p>
<a name=3D"N-00EF8767">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.3">9.20.=
3</a> Duplicate Supertypes</h4>


Multiple inheritance makes it possible for a type to inherit the
same supertype more than once, either directly (by naming it more than
once as a direct supertype) or indirectly (by inheriting two or
more different types, which have a common ancestor).
The latter situation is sometimes referred to as the
<i>diamond problem</i>.

<p>
Until <b>TXR</b> 242, the situation of duplicate supertypes was
ignored for the purposes of object initialization. It was documented that i=
f a
supertype is referenced by inheritance, directly or indirectly, two or more
times, then its initializing expressions are evaluated that many times.
</p><p>
Starting in <b>TXR</b> 243, duplicate supertypes no longer give rise to dup=
licate
initialization. When an object is instantiated, only one initialization of =
a
duplicated supertype occurs. The subsequent initializations that would take
place in the absence of duplicate detection are suppressed.
</p><p>
Note also that the
<tt>:fini</tt>
mechanism is tied to initialization. Initialization of an object
registers the finalizers, and so in <b>TXR</b> 242,
<tt>:fini</tt>
finalizers are also executed multiple times, if
<tt>:init</tt>
initializers are.
</p><p>
</p><dl>
<dt>Examples:</dt><dd>
<p>


</p><p>
Consider following program:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
1CC672">defstruct</a> base ()
    (:init (me) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163=
C3">put-line</a> "base init"))
    (:fini (me) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163=
C3">put-line</a> "base fini")))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> d1 (base)
    (:init (me) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163=
C3">put-line</a> "d1 init"))
    (:fini (me) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163=
C3">put-line</a> "d1 fini")))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> d2 (base)
    (:init (me) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163=
C3">put-line</a> "d2 init"))
    (:fini (me) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163=
C3">put-line</a> "d2 fini")))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> s (d1 d2))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-final=
izers</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">ne=
w</a> s))
</tt></pre><tt>

</tt>

<p>
Under <b>TXR</b> 242, and earlier versions that support multiple inheritanc=
e, it
produces the output:
</p><p>
<tt>
</tt></p><pre><tt>  base init
  d2 init
  base init
  d1 init
  d1 fini
  base fini
  d2 fini
  base fini
</tt></pre><tt>

</tt>

<p>
The supertypes are initialized in a right-to-left traversal of the
type lattice, without regard for
<tt>base</tt>
being duplicated.
</p><p>
Starting with <b>TXR</b> 243, the output is:
</p><p>
<tt>
</tt></p><pre><tt>  base init
  d2 init
  d1 init
  d1 fini
  d2 fini
  base fini
</tt></pre><tt>

</tt>

<p>
The rightmost duplicate of the base is initialized, so that the initializat=
ion
is complete prior to the initializations of any dependent types.
Likewise, the same rightmost duplicate of the base is finalized, so that
finalization takes place after that of any dependent struct types.
</p><p>
Note, however, that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0151798B">derived</=
a></tt>
function function mechanism is not required to detect duplicated direct
supertypes.
If a supertype implements the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0151798B">derived</=
a></tt>
function to detect situations when it is the target of inheritance,
and some subtype inherits that type more than once, that function
may be called more than once. The behavior is unspecified.
</p><p>
</p></dd></dl>
<a name=3D"N-035A698D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.4">9.20.4</a=
> Dirty Flags</h4>


All structure instances contain a Boolean flag called the
<i>dirty flag</i>.

This flag is not a slot, but rather a meta-data property that is exposed
to program access. When the flag is set, an object is said to be dirty;
otherwise it is clean.
<p>
Newly constructed objects come into existence dirty. The dirty flag
state can be tested with the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-dirt=
y</a></tt>.
An object can be marked as clean by clearing its dirty flag with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">clear-dir=
ty</a></tt>.
A combined operation
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-clea=
r-dirty</a></tt>
is provided which clears the dirty flag, and
returns its previous value.
</p><p>
The dirty flag is set whenever a new value is stored into the instance
slot of an object.
</p><p>
Note: the dirty flag can be used to support support the caching of values
derived from an object's slots. The derived values don't have to be
re-computed while an object remains clean.
</p><p>
<a name=3D"N-02CDB347">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.5">9.20.=
5</a> Equality Substitution</h4>


<p>
In object-based or object-oriented programming, sometimes it is necessary f=
or a
new data type to provide its own notion of equality: its own requirements f=
or
when two distinct instances of the type are considered equal. Furthermore,
types sometimes have to implement their own notion, also, of inequality: th=
e
requirements for the manner in which one instance is considered lesser or
greater than another.
</p><p>
<b>TXR Lisp</b> structures implement a concept called
<i>equality substitution</i>

which provides a simple, unified way for the implementor of an object to
encode the requirements for both equality and inequality.
Equality substitution allows for objects to be used as keys in a hash
table according to the custom equality, without the programmer being
burdened with the responsibility of developing a custom hashing function.
</p><p>
An object participates in equality substitution by implementing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method takes no arguments other than the object itself. It returns
a representative value which is used in place of that object
for the purposes of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
comparison.
</p><p>
Whenever an object which supports equality substitution is used as an argum=
ent
of any of the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216A942">nequal</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">gequal</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">lequal</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000455E">hash-equa=
l</a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method of that object is invoked, and the return value of that method
is taken in place of that object.
</p><p>
The same is true if an object which supports equality substitution is used =
as a
key in an
<tt>:equal-based</tt>
hash table.
</p><p>
The substitution is applied repeatedly: if the return value of the object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method is an object which itself supports equality substitution,
than that returned object's method is invoked on that object
to fetch its equality substitute. This repeats as many times as necessary
until an object is determined which isn't a structure that supports
equality substitution.
</p><p>
Once the equality substitute is determined, then the given function proceed=
s
with the replacement object. Thus for example
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
compares the replacement object in place of the original, and an
<tt>:equal-based</tt>
hash table uses the replacement object as the key for the purposes of
hashing and comparison.
</p><p>

<a name=3D"N-021CC672">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.6">9.20.=
6</a> Macro <tt>defstruct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct {</tt><tt><i>name</i></tt><tt> | (</tt><tt><i>na=
me</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*)} </tt><tt><i>super</i></tt><=
tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>slot-specifier</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro defines a new structure type and registers it under
<tt><i>name</i></tt>,
which must be a bindable symbol, according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function. Likewise, the name of every
<tt><i>slot</i></tt>
must also be a bindable symbol.
</p><p>
The
<tt><i>super</i></tt>
argument must either be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
or a symbol which names an existing struct type,
or else a list of such symbols.
The newly defined struct type will inherit all slots,
as well as initialization behaviors from the specified
struct types.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro is implemented using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
function, which is more general. The macro analyzes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
argument syntax, and synthesizes arguments which are then
used to call the function. Some remarks in the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
only apply to structure types defined using that macro.
</p><p>
Slots are specified using zero or more
<i>slot specifiers</i>.

Slot specifiers come in the following variety:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt><tt><i>name</i></tt><tt> </tt></tt></dt><dd>



The simplest slot specifier is just a name, which must be a bindable
symbol, as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function. This form is a short form for the
<tt>




(:instance </tt><tt><i>name</i></tt><tt>)=20

</tt>

syntax.



</dd><dt><tt>(<tt><i>name</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>) =
</tt></tt></dt><dd>



This syntax is a short form for the
<tt>




(:instance </tt><tt><i>name</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>=
)=20

</tt>

syntax.



</dd><dt><tt>(:instance <tt><i>name</i></tt><tt> [</tt><tt><i>init-form</i>=
</tt><tt>]) </tt></tt></dt><dd>



This syntax specifies an instance slot called
<tt><i>name</i></tt>
whose initial value is obtained by evaluating
<tt><i>init-form</i></tt>
whenever a new instance of the structure is created.
This evaluation takes place in the original lexical environment in which th=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form occurs. If
<tt><i>init-form</i></tt>
is omitted, the slot is initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.



</dd><dt><tt>(:static <tt><i>name</i></tt><tt> [</tt><tt><i>init-form</i></=
tt><tt>]) </tt></tt></dt><dd>



This syntax specifies a static slot called
<tt><i>name</i></tt>
whose initial value is obtained by evaluating
<tt><i>init-form</i></tt>
once, during the evaluation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form in which it occurs, if the
<tt><i>init-form</i></tt>
is present. If
<tt><i>init-form</i></tt>
is absent, and a static slot with the same name
exists in the
<tt><i>super</i></tt>
base type, then this slot is initialized
with the value of that slot.
Otherwise it is initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
The definition of a static slot in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
causes the new type to have its own instance
that slot, even if a same-named static
slot occurs in the
<tt><i>super</i></tt>
base type, or its bases.



</p></dd><dt><tt>(:method <tt><i>name</i></tt><tt> (</tt><tt><i>param</i></=
tt><tt>+) </tt><tt><i>body-form</i></tt><tt>*) </tt></tt></dt><dd>



This syntax creates a static slot called
<tt><i>name</i></tt>
which is initialized with an anonymous function.
The anonymous function is created during the
evaluation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form. The function takes the arguments specified
by the
<tt><i>param</i></tt>
symbols, and its body consists of the
<tt><i>body-form</i></tt>-s.
There must be at least one
<tt><i>param</i></tt>.
When the function is invoked as a method, as intended,
the leftmost
<tt><i>param</i></tt>
receives the structure instance.
The
<tt><i>body-form</i></tt>-s
are evaluated in a context in which a block named
<tt><i>name</i></tt>
is visible. Consequently,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
may be used to terminate the execution of a method
and return a value.
Methods are invoked
using the
<tt>instance.(name arg ...)</tt>
syntax, which implicitly inserts the instance into the argument list.
<p>
Due to the semantics of static slots, methods are naturally
inherited from a base structure to a derived one,
and defining a method in a derived class which also exists
in a base class performs OOP-style overriding.



</p></dd><dt><tt>(:function <tt><i>name</i></tt><tt> (</tt><tt><i>param</i>=
</tt><tt>*) </tt><tt><i>body-form</i></tt><tt>*) </tt></tt></dt><dd>



This syntax creates a static slot called
<tt><i>name</i></tt>
which is initialized with an anonymous function.
The anonymous function is created during the
evaluation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form. The function takes the arguments specified
by the
<tt><i>param</i></tt>
symbols, and its body consists of the
<tt><i>body-form</i></tt>-s.
This specifier differs from
<tt>:method</tt>
only in one respect: there may be zero
parameters. A structure function defined this way is
intended to be used as a utility function which doesn't
receive the structure instance as an argument.
The
<tt><i>body-form</i></tt>-s
are evaluated in a context in which a block named
<tt><i>name</i></tt>
is visible. Consequently,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
may be used to terminate the execution of the function
and return a value.
Such functions are called using the
<tt>(call instance.name arg ...)</tt>
or else the DWIM brackets syntax
<tt>[instance.name arg ...]</tt>.
<p>
The remarks about inheritance and overriding
in the description of
<tt>:method</tt>
also apply to
<tt>:function</tt>.



</p></dd><dt><tt>(:init (<tt><i>param</i></tt><tt>) </tt><tt><i>body-form</=
i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:init</tt>
specifier doesn't describe a slot. Rather, it specifies code
which is executed when a structure is instantiated, before
the slot initializations specific to the structure type
are performed. The code consists of
<tt><i>body-form</i></tt>-s
which are evaluated in order in a lexical scope in
which the variable
<tt><i>param</i></tt>
is bound to the structure object.
<p>
The
<tt>:init</tt>
specifier may not appear more than once in a given
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form.
</p><p>
When an object with one or more levels of inheritance
is instantiated, the
<tt>:init</tt>
code of a base structure type, if any, is executed
before any initializations specific to a derived
structure type. Under multiple inheritance, the
<tt>:init</tt>
code of the rightmost base type is executed first,
then that of the remaining bases in right-to-left
order.
</p><p>
The
<tt>:init</tt>
initializations are executed before any other
slot initializations. The argument values passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
operator or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
function are not yet stored in the object's slots,
and are not accessible. Initialization code which needs
these values to be stable can be defined with
<tt>:postinit</tt>.
</p><p>
Initializers in base structures must be careful about assumptions about slo=
t
kinds, because derived structures can alter static slots to instance slots =
or
<i>vice versa</i>.

To avoid an unwanted initialization being applied to the
wrong kind of slot, initialization code can be made conditional on the
outcome of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032FD510">static-sl=
ot-p</a></tt>
applied to the slot.
(Code generated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
for initializing instance slots performs this kind of check).
</p><p>
The
<tt><i>body-form</i></tt>-s
of an
<tt>:init</tt>
specifier are not surrounded by an implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>.



</p></dd><dt><tt>(:postinit (<tt><i>param</i></tt><tt>) </tt><tt><i>body-fo=
rm</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:postinit</tt>
specifier is similar to
<tt>:init</tt>.
Both specify forms which are evaluated during object instantiation.
The difference is that the
<tt>body-form</tt>-s
of a
<tt>:postinit</tt>
are evaluated after other initializations have taken
place, including the
<tt>:init</tt>
initializations, as a second pass. By the time
<tt>:postinit</tt>
initialization runs, the argument material from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
invocation has already been processed and stored
into slots.
Like
<tt>:init</tt>
actions,
<tt>:postinit</tt>
actions registered at different levels of the type's
inheritance hierarchy are invoked in the base-to-derived
order, and in right-to-left order among multiple bases
at the same level.



</dd><dt><tt>(:fini (<tt><i>param</i></tt><tt>) </tt><tt><i>body-form</i></=
tt><tt>*) </tt></tt></dt><dd>



The
<tt>:fini</tt>
specifier doesn't describe a slot. Rather, it specifies
a finalization function which is associated with the
structure instance, as if by use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize<=
/a></tt>
function. This finalization registration takes place
as the first step when an instance of the structure
is created, before the slots are initialized and
the
<tt>:init</tt>
code, if any, has been executed. The registration
takes place as if by the evaluation of the form
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize</a>=
 </tt><tt><i>obj</i></tt><tt> (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-004F">lambda</a> (</tt><tt><i>param</i></tt><tt>) </tt><tt><i>body-=
form</i></tt><tt>...) t)=20

</tt>

where
<tt><i>obj</i></tt>
denotes the structure instance. Note the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
argument which requests reverse order of registration, ensuring that if an
object has multiple finalizers registered at different levels of inheritanc=
e
hierarchy, the finalizers specified for a derived structure type are called
before inherited finalizers.
<p>
The
<tt><i>body-form</i></tt>-s
of a
<tt>:fini</tt>
specifier are not surrounded by an implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>.
</p><p>
Note that an object's finalizers can be called explicitly with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>.
</p></dd></dl>
</dl>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AECEBA">with-obje=
cts</a></tt>
macro arranges for finalizers to be called on objects when the execution
of a scope terminates by any means.
<p>
The slot names given in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
must all be unique among themselves, but they
may match the names of existing slots in the
<tt><i>super</i></tt>
base type.
</p><p>
A given structure type can have only one slot under a given
symbolic name.  If a newly specified  slot matches the name of an existing =
slot
in the
<tt><i>super</i></tt>
type or that type's chain of ancestors, it is called a
<i>repeated slot</i>.

</p><p>
The kind of the repeated slot (static or instance) is not inherited; it
is established by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
and may be different from the type of the same-named slot in the
supertype or its ancestors.
</p><p>
If a repeated slot is introduced as a static slot, and
has no
<tt><i>init-form</i></tt>
then it receives the current of the a static of the same name from
the nearest supertype which has such a slot.
</p><p>
If a repeated slot is an instance slot, no such inheritance of value
takes place; only the local
<tt><i>init-form</i></tt>
applies to it; if it is absent, the slot it initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in each newly created instance of the new type.
</p><p>
However,
<tt>:init</tt>
and
<tt>:postinit</tt>
initializations are inherited from a base type and they apply to
the repeated slots, regardless of their kind.  These initializations
take place on the instantiated object, and the slot references
resolve accordingly.
</p><p>
The initialization for slots which are specified using the
<tt>:method</tt>
or
<tt>:function</tt>
specifiers is re-ordered with regard to
<tt>:static</tt>
slots. Regardless of their placement in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form,
<tt>:method</tt>
and
<tt>:function</tt>
slots are initialized before
<tt>:static</tt>
slots. This ordering is useful, because it means that when the initializati=
on
expression for a given static slot constructs an instance of the struct typ=
e,
any instance initialization code executing for that instance can use
all functions and methods of the struct type.
However, note the static slots which follow that slot in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
syntax are not yet initialized. If it is necessary for a structure's
initialization code to have access to all static slots, even when the
structure is instantiated during the initialization of a static slot,
a possible solution may be to use lazy instantiation using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
operator, rather than ordinary eager instantiation via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>.
It is also necessary to ensure that that the instance isn't accessed until =
all
static initializations are complete, since access to the instance slots of =
a
lazily instantiated structure triggers its initialization.
</p><p>
The structure name is specified using two forms, plain
<tt><i>name</i></tt>
or the syntax
<tt>




(</tt><tt><i>name</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*)=20

</tt>

If the second form is used, then the structure type will support
"boa construction", where "boa" stands for "by order of arguments".
The
<tt><i>arg</i></tt>-s
specify the list of slot names which are to be initialized in the
by-order-of-arguments style. For instance, if three slot names
are given, then those slots can be optionally initialized by giving three
arguments in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
macro or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
function.
</p><p>
Slots are first initialized according to their
<tt><i>init-form</i></tt>-s,
regardless of whether they are involved in boa construction
</p><p>
A slot initialized in this style still has a
<tt><i>init-form</i></tt>
which is processed independently of the existence of, and prior to,
boa construction.
</p><p>
The boa constructor syntax can specify optional parameters, delimited
by a colon, similarly to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
syntax. However, the optional parameters may not be arbitrary symbols;
they must be symbols which name
slots. Moreover, the
<tt>




(</tt><tt><i>name</i></tt><tt> </tt><tt><i>init-form</i></tt><tt> [</tt><tt=
><i>present-p</i></tt><tt>])=20

</tt>

optional parameter syntax isn't supported.
</p><p>
When boa construction is invoked with optional arguments missing,
the default values for those arguments come from the
<tt><i>init-form</i></tt>-s
in the remaining
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
syntax.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
9DD0E7">defvar</a> *counter* 0)

  ;; New struct type foo with no super type:
  ;; Slots a and b initialize to nil.
  ;; Slot c is initialized by value of (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#N-03A0AABD">inc</a> *counter*).
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> foo nil (a b (c (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
A0AABD">inc</a> *counter*))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> fo=
o) -&gt; #S(foo a nil b nil c 1)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> fo=
o) -&gt; #S(foo a nil b nil c 2)

  ;; New struct bar inheriting from foo.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> bar foo (c 0) (d 100))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> ba=
r) -&gt; #S(bar a nil b nil c 0 d 100)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> ba=
r) -&gt; #S(bar a nil b nil c 0 d 100)

  ;; counter was still incremented during
  ;; construction of d:
  *counter* -&gt; 4

  ;; override slots with new arguments
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> fo=
o a "str" c 17) -&gt; #S(foo a "str" b nil c 17)

  *counter* -&gt; 5

  ;; boa initialization
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> (point x : y) nil (x 0) (y 0))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> po=
int) -&gt; #S(point x 0 y 0)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> (p=
oint 1 1)) -&gt; #S(point x 1 y 1)

  ;; property list style initialization
  ;; can always be used:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> po=
int x 4 y 5) -&gt; #S(point x 4 y 5)

  ;; boa applies last:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> (p=
oint 1 1) x 4 y 5) -&gt; #S(point x 1 y 1)

  ;; boa with optional argument omitted:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> (p=
oint 1)) -&gt; #S(point x 1 y 0)

  ;; boa with optional argument omitted and
  ;; with property list style initialization:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> (p=
oint 1) x 5 y 5) -&gt; #S(point x 1 y 5)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0047C7E8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.7">9.20.7</a=
> Macro <tt>defmeth</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defmeth </tt><tt><i>type-name</i></tt><tt> </tt><tt><i>nam=
e</i></tt><tt> </tt><tt><i>param-list</i></tt><tt> </tt><tt><i>body-form</i=
></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Unless
<tt><i>name</i></tt>
is one of the two symbols
<tt>:init</tt>
or
<tt>:postinit</tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
macro installs a function into the static slot named by the symbol
<tt><i>name</i></tt>
in the struct type indicated by
<tt><i>type-name</i></tt>.
</p><p>
If the structure type doesn't already have such a static slot, it is
first added, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E71F31">static-sl=
ot-ensure</a></tt>
function, subject to the same checks.
</p><p>
If the function has at least one argument, it can be used as a method. In t=
hat
situation, the leftmost argument passes the structure instance on which the
method is being invoked.
</p><p>
The function takes the arguments specified
by the
<tt><i>param-list</i></tt>
symbols, and its body consists of the
<tt><i>body-form</i></tt>-s.
</p><p>
The
<tt><i>body-form</i></tt>-s
are placed into a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>.
</p><p>
A method named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
allows a structure to be used as if it were a function. When arguments
are applied to the structure as if it were a function, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method is invoked with those arguments, with the object itself inserted
into the leftmost argument position.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
is used to redefine an existing method, the semantics can be inferred
from that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E71F31">static-sl=
ot-ensure</a></tt>.
In particular, the method will be imposed into all subtypes which inherit
(do not override) the method.
</p><p>
If
<tt><i>name</i></tt>
is the keyword symbol
<tt>:init</tt>,
then instead of operating on a static slot, the macro redefines the
<tt><i>initfun</i></tt>
of the given structure type, as if by a call to the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00946F18">struct-se=
t-initfun</a></tt>.
</p><p>
Similarly, if
<tt><i>name</i></tt>
is the keyword symbol
<tt>:postinit</tt>,
then the macro redefines the
<tt><i>postinitfun</i></tt>
of the given structure type, as if by a call to the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00946F18">struct-se=
t-postinitfun</a></tt>.
</p><p>
When redefining
<tt>:initfun</tt>
the admonishments given in the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00946F18">struct-se=
t-initfun</a></tt>
apply: if the type has an
<tt><i>initfun</i></tt>
generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro, then that
<tt><i>initfun</i></tt>
is what implements all of the slot initializations given in the
slot specifier syntax. These initializations are lost if the
<tt><i>initfun</i></tt>
is overwritten.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
macro returns a method name: a unit of syntax of the form
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>type-name</i></tt><tt> </tt><tt><i>name)</i></tt><tt>=20

</tt>

which can be used as an argument to the accessor
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
and other situations.
</p><p>

</p></dd></dl>
<a name=3D"N-0230059D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.8">9.20.8</a=
> Macros <tt>new</tt> and <tt>lnew</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(new {</tt><tt><i>name</i></tt><tt> | (</tt><tt><i>name</i>=
</tt><tt> </tt><tt><i>arg</i></tt><tt>*)} {</tt><tt><i>slot</i></tt><tt> </=
tt><tt><i>init-form</i></tt><tt>}*)=20




<br>&nbsp;&nbsp;(lnew {</tt><tt><i>name</i></tt><tt> | (</tt><tt><i>name</i=
></tt><tt> </tt><tt><i>arg</i></tt><tt>*)} {</tt><tt><i>slot</i></tt><tt> <=
/tt><tt><i>init-form</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
macro creates a new instance of the structure type named by
<tt><i>name</i></tt>.
</p><p>
If the structure supports "boa construction", then, optionally, the
arguments may be given using the syntax
<tt>




(</tt><tt><i>name</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*)=20

</tt>

instead of
<tt><i>name</i></tt>.
</p><p>
Slot values may also be specified by the
<tt><i>slot</i></tt>
and
<tt><i>init-form</i></tt>
arguments.
</p><p>
Note: the evaluation order in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
is surprising: namely,
<tt><i>init-form</i></tt>-s
are evaluated before
<tt><i>arg</i></tt>-s
if both are present.
</p><p>
When the object is constructed, all default initializations take place
first. If the object's structure type has a supertype, then the supertype
initializations take place. Then the type's initializations take
place, followed by the
<tt><i>slot</i></tt>
<tt><i>init-form</i></tt>
overrides from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
macro, and lastly the "boa constructor" overrides.
</p><p>
If any of the initializations abandon the evaluation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
by a non-local exit such as an exception throw, the object's
finalizers, if any, are invoked.
</p><p>
The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
differs from new in that it specifies the construction of a
lazy struct, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C734D9">make-lazy=
-struct</a></tt>
function.
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
is used to construct an instance, a lazy struct is returned
immediately, without evaluating any of the the
<tt><i>arg</i></tt>
and
<tt><i>init-form</i></tt>
expressions.
The expressions are evaluated when any of the object's
instance slots is accessed for the first time. At that time,
these expressions are evaluated (in the same order as under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>)
and initialization proceeds in the same way.
</p><p>
If any of the initializations abandon the delayed initializations steps
arranged by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
by a non-local exit such as an exception throw, the object's
finalizers, if any, are invoked.
</p><p>
Lazy initialization does not detect cycles. Immediately prior to the lazy
initialization of a struct, the struct is marked as no longer requiring
initialization. Thus, during initialization, its instance slots may be
freely accessed. Slots not yet initialized evaluate as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-021E6FDC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.9">9.20.9</a=
> Macros <tt>new*</tt> and <tt>lnew*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(new* {</tt><tt><i>expr</i></tt><tt> | (</tt><tt><i>expr</i=
></tt><tt> </tt><tt><i>arg</i></tt><tt>*)} {</tt><tt><i>slot</i></tt><tt> <=
/tt><tt><i>init-form</i></tt><tt>}*)=20




<br>&nbsp;&nbsp;(lnew* {</tt><tt><i>expr</i></tt><tt> | (</tt><tt><i>expr</=
i></tt><tt> </tt><tt><i>arg</i></tt><tt>*)} {</tt><tt><i>slot</i></tt><tt> =
</tt><tt><i>init-form</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021E6FDC">new*</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021E6FDC">lnew*</a>=
</tt>
macros are variants, respectively, of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>.
</p><p>
The only difference in behavior in these macros relative to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">lnew</a><=
/tt>
is that the
<tt><i>name</i></tt>
argument is replaced with an expression
<tt><i>expr</i></tt>
which is evaluated. The value of
<tt><i>expr</i></tt>
must be a struct type, or a symbol which is the name of a struct type.
</p><p>

</p></dd></dl>
<a name=3D"N-00C411A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.10">9.20.10<=
/a> Macro <tt>with-slots</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-slots ({</tt><tt><i>slot</i></tt><tt> | (</tt><tt><i>=
sym</i></tt><tt> </tt><tt><i>slot</i></tt><tt>)}*) </tt><tt><i>struct-expr<=
/i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-slot=
s</a></tt>
binds lexical macros to serve as aliases for the slots of a structure.
</p><p>
The
<tt><i>struct-expr</i></tt>
argument is expected to be an expression which evaluates to a struct
object. It is evaluated once, and its value is retained. The aliases are th=
en
established to the slots of the resulting struct value.
</p><p>
The aliases are specified as zero or more expressions which consist of eith=
er
a single symbol
<tt><i>slot</i></tt>
or a
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>slot</i></tt><tt>)=20

</tt>

pair. The simple form binds a macro named
<tt><i>slot</i></tt>
to a slot also named
<tt><i>slot</i></tt>.
The pair form binds a macro named
<tt><i>sym</i></tt>
to a slot named
<tt><i>slot</i></tt>.
</p><p>
The lexical aliases are syntactic places: assigning to an alias causes
the value to be stored into the slot which it denotes.
</p><p>
After evaluating
<tt><i>struct-expr</i></tt>
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-slot=
s</a></tt>
macro arranges for the evaluation of
<tt><i>body-form</i></tt>-s
in the lexical scope in which the aliases are visible.
</p><p>
</p></dd><dt>Dialect Notes:</dt><dd>
<p>


</p><p>
The intent of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-slot=
s</a></tt>
macro is to help reduce the verbosity of code which makes multiple
references to the same slot. Use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-slot=
s</a></tt>
is less necessary in <b>TXR Lisp</b> than other Lisp dialects
thanks to the dot operator for accessing struct slots.
</p><p>
Lexical aliases to struct places can also be
arranged with considerable convenience using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
operator. However,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
will not bind multiple aliases to multiple slots of the same object
such that the expression which produces the object is evaluated only
once.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
1CC672">defstruct</a> point nil x y)

  ;; Here, with-slots introduces verbosity because
  ;; each slot is accessed only once. The function
  ;; is equivalent to:
  ;;
  ;; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</=
a> point-delta (p0 p1)
  ;;   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</=
a> point x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a>=
 p1.x p0.x) y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-<=
/a> p1.y p0.y)))
  ;;
  ;; Also contrast with the use of placelet:
  ;;
  ;; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</=
a> point-delta (p0 p1)
  ;;   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">place=
let</a> ((x0 p0.x) (y0 p0.y)
  ;;              (x1 p1.x) (y1 p1.y))
  ;;     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new=
</a> point x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</=
a> x1 x0) y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a=
> y1 y0)))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
point-delta (p0 p1)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-slo=
ts</a> ((x0 x) (y0 y)) p0
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-s=
lots</a> ((x1 x) (y1 y)) p1
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new<=
/a> point x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a=
> x1 x0) y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a>=
 y1 y0)))))

</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03A212AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.11">9.20.11<=
/a> Macro <tt>qref</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(qref </tt><tt><i>object-form</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {</tt><tt><i>slot</i></tt><tt> | (</tt><tt><i>=
slot</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*) | [</tt><tt><i>slot</i></t=
t><tt> </tt><tt><i>arg</i></tt><tt>*]}+)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
macro ("quoted reference") performs structure slot access.  Structure slot
access is more conveniently expressed using the referencing dot notation, w=
hich
works by translating to qref
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
syntax, according to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  a.b.c.d &lt;--&gt; (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#D-0058">qref</a> a b c d)  ;; a b c d must not be numbers
</tt></pre><tt>

</tt>

<p>
(See the Referencing Dot section under Additional Syntax.)
</p><p>
The leftmost argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
is an expression which is evaluated. This argument is followed by one or mo=
re
reference designators.
If there are two or more designators, the following equivalence applies:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
58">qref</a> obj d1 d2 ...)  &lt;---&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-0058">qref</a> (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#D-0058">qref</a> obj d1) d2 ...)
</tt></pre><tt>

</tt>

<p>
That is to say,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
is applied to the object and a single designator. This must yield
an object, which to which the next designator is applied as if by
another
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
operation, and so forth.
</p><p>
If the null-safe syntax
<tt>(t ...)</tt>
is present, the equivalence becomes more complicated:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
58">qref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8"=
>t</a> obj) d1 d2 ...)  &lt;---&gt; (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#D-0058">qref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0058">qref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
015134D8">t</a> obj) d1) d2 ...)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> obj (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a> d1) d2 =
...)  &lt;---&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058=
">qref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> ob=
j d1)) d2 ...)
</tt></pre><tt>

</tt>

<p>
Thus,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
can be understood in terms of the semantics of the
binary form
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> </tt><t=
t><i>object-form</i></tt><tt> </tt><tt><i>designator</i></tt><tt>)=20

</tt>

</p><p>
Designators come in three basic forms: a lone symbol, an ordinary compound =
expression
consisting of a symbol followed by arguments, or a DWIM expression
consisting of a symbol followed by arguments.
</p><p>
A lone symbol designator indicates the slot of that name. That is to say, t=
he
following equivalence applies:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
58">qref</a> o n)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-0326F62D">slot</a> o 'n)
</tt></pre><tt>

</tt>

<p>
where
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F62D">slot</a><=
/tt>
is the structure slot accessor function. Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F62D">slot</a><=
/tt>
is an accessor, this form denotes the slot as a syntactic place;
slots can be modified via assignment to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
form and the referencing dot syntax.
</p><p>
The slot name being implicitly quoted is the basis of the term
"quoted reference", giving rise to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
name.
</p><p>
A compound designator indicates that the named slot is a function,
and arguments are to be applied to it. The following equivalence applies
in this case, except that
<tt>o</tt>
is evaluated only once:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
58">qref</a> o (n arg ...)) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#N-0386C775">call</a> (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-0326F62D">slot</a> o 'n) o arg ...)
</tt></pre><tt>

</tt>

<p>
A DWIM designator similarly indicates that the named slot is a function,
and arguments are to be applied to it. The following equivalence applies:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
58">qref</a> obj [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557=
906">name</a> arg ...])  &lt;--&gt;  [(slot obj 'name) o arg ...]
</tt></pre><tt>

</tt>

<p>
Therefore, under this equivalence, this syntax provides the usual Lisp-1-st=
yle
evaluation rule via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
If the
<tt><i>object-form</i></tt>
has the syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a> </tt><=
tt><i>expression</i></tt><tt>)=20

</tt>

this indicates null-safe access: if
<tt><i>expression</i></tt>
evaluates to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then the entire expression
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> (<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a> </tt><tt><i>e=
xpression</i></tt><tt>) </tt><tt><i>designator</i></tt><tt>)=20

</tt>

form yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This syntax is produced by the
<tt>.?</tt>
notation.
</p><p>
The null-safe access notation prevents not only slot access, but also
method or function calls on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
When a method or function call is suppressed due to the object being
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
no aspect of the method or function call is evaluated; not only
is the slot not accessed, but the argument expressions are not evaluated.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
1CC672">defstruct</a> foo nil
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">vec</a> 1 =
2 3))
    (increment (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">l=
ambda</a> (self index delta)
                 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0A=
ABD">inc</a> [self.array index] delta))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> s (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> =
foo))

  ;; access third element of s.array:
  [s.array 2]  --&gt;  3

  ;; increment first element of array by 42
  s.(increment 0 42)  --&gt;  43

  ;; access array member
  s.array  --&gt;  #(43 2 3)
</tt></pre><tt>

</tt>

<p>
Note how
<tt>increment</tt>
behaves much like a single-argument-dispatch object-oriented method.
Firstly, the syntax
<tt>

s.(increment 0 42)
</tt>

effectively selects the
<tt>increment</tt>
function which is particular to the
<tt>s</tt>
object.  Secondly, the object is passed to the selected function as the
leftmost argument, so that the function has access to the object.
</p><p>

</p></dd></dl>
<a name=3D"N-03A211AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.12">9.20.12<=
/a> Macro <tt>uref</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(uref {</tt><tt><i>slot</i></tt><tt> | (</tt><tt><i>slot</i=
></tt><tt> </tt><tt><i>arg</i></tt><tt>*) | [</tt><tt><i>slot</i></tt><tt> =
</tt><tt><i>arg</i></tt><tt>*]}+)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
macro ("unbound reference") expands to an expression which evaluates to a
function.  The function takes exactly one argument: an object.
When the function is invoked on an object, it references slots
or methods relative to that object.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
syntax may be used directly, but it is also produced by the unbound referen=
cing
dot syntactic sugar:
</p><p>
<tt>
</tt></p><pre><tt>  .a          --&gt;  (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-03A211AB">uref</a> a)
  .?a         --&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
03A211AB">uref</a> t a)
  .(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> x) =
     --&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB"=
>uref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f<=
/a> x))
  .(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> x).=
b    --&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB"=
>uref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f<=
/a> x) b)
  .a.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> x=
).b  --&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB"=
>uref</a> a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">=
f</a> x) b)
</tt></pre><tt>

</tt>

<p>
The macro may be understood in terms of the following translation
scheme:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
A211AB">uref</a> a b ...)    --&gt;  (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#D-004F">lambda</a> (o) (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#D-0058">qref</a> o a b ...))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a> t=
 a b ...)  --&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004=
F">lambda</a> (o) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039=
">if</a> o (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref<=
/a> o a b ...)))
</tt></pre><tt>

</tt>

<p>
where
<tt>o</tt>
is understood to be a unique symbol (for instance, as produced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
function).
</p><p>
When only one
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
argument is present, these equivalences also hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
A211AB">uref</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BD=
FA9">f</a> a b c ...))  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-02ECA31C">umeth</a> f a b c ...)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a> s=
)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BF39D=
D">usl</a> s)
</tt></pre><tt>

</tt>

<p>
The terminology "unbound reference" refers to the property that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
expressions produce a function which isn't bound to a structure
object.  The function binds a slot or method; the call to that function the=
n
binds an object to that function, as an argument.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
Suppose that the objects in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
have slots
<tt>a</tt>
and
<tt>b</tt>.
Then, a list of the
<tt>a</tt>
slot values may be obtained using:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> .a list)
</tt></pre><tt>

</tt>

<p>
because this is equivalent to
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004=
F">lambda</a> (o) o.a) list)
</tt></pre><tt>

</tt>

<p>
Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
produces a function, its result can be operated upon by
functional combinators. For instance, we can use the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0106CD7F">juxt</a><=
/tt>
combinator to produce a list of two-element lists,
which hold the
<tt>a</tt>
and
<tt>b</tt>
slots from each object in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010=
6CD7F">juxt</a> .a .b) list)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02C216C3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.13">9.20.13<=
/a> Macro <tt>meth</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(meth </tt><tt><i>struct</i></tt><tt> </tt><tt><i>slot</i><=
/tt><tt> </tt><tt><i>curried-expr</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a><=
/tt>
macro allows indirection upon a method-like function stored
in a function slot.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a><=
/tt>
macro binds
<tt><i>struct</i></tt>
as the leftmost argument of the function stored in
<tt><i>slot</i></tt>,
returning a function which takes the remaining arguments.
That is to say, it returns a function
<tt><i>f</i></tt>
such that
<tt>




[</tt><tt><i>f</i></tt><tt> </tt><tt><i>arg</i></tt><tt> ... ]=20

</tt>

calls
<tt>




[</tt><tt><i>struct.slot</i></tt><tt> </tt><tt><i>struct</i></tt><tt> </tt>=
<tt><i>arg</i></tt><tt> ... ]=20

</tt>

except that
<tt><i>struct</i></tt>
is evaluated only once.
</p><p>
If one or more
<tt><i>curried-expr</i></tt>
expressions are present, their values are bound inside
<tt><i>f</i></tt>
also, and when
<tt><i>f</i></tt>
is invoked, these are passed to the function stored in the slot.
Thus if
<tt><i>f</i></tt>
is produced by
<tt>(meth struct slot c1 c2 c3 ...)</tt>
then
<tt>




[</tt><tt><i>f</i></tt><tt> </tt><tt><i>arg</i></tt><tt> ... ]=20

</tt>

calls
<tt>




[</tt><tt><i>struct.slot</i></tt><tt> </tt><tt><i>struct</i></tt><tt> </tt>=
<tt><i>c1v</i></tt><tt> </tt><tt><i>c2v</i></tt><tt> </tt><tt><i>c3v</i></t=
t><tt> ... arg ... ]=20

</tt>

except that
<tt><i>struct</i></tt>
is evaluated only once, and
<tt><i>c1v</i></tt>,
<tt><i>c2v</i></tt>
and
<tt><i>c3v</i></tt>
are the values of expressions
<tt>c1</tt>,
<tt>c2</tt>
and
<tt>c3</tt>.
</p><p>
The argument
<tt><i>struct</i></tt>
must be an expression which evaluates to a struct.
The
<tt><i>slot</i></tt>
argument is not evaluated, and must be a symbol denoting a slot.
The syntax can be understood as a translation to a call of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022200C1">method</a=
></tt>
function:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
C216C3">meth</a> a b)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-022200C1">method</a> a 'b)
</tt></pre><tt>

</tt>

<p>
If
<tt><i>curried-arg</i></tt>
expressions are present, the translation may be be understood
as:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
C216C3">meth</a> a b c1 c2 ...)  &lt;--&gt;  [(fun method) a 'b c1 c2 ...]
</tt></pre><tt>

</tt>

<p>
In other words the
<tt><i>curried-arg</i></tt>
expressions are evaluated under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator evaluation rules.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; struct for counting atoms eq to key
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> (counter key) nil
    key
    (count 0)
    (:method increment (self key)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a> self.key=
 key)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc<=
/a> self.count))))

  ;; pass all atoms in tree to func
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
map-tree (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tre=
e</a> func)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a> tree)
      [func tree]
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn<=
/a> (map-tree (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">ca=
r</a> tree) func)
             (map-tree (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0069">cdr</a> tree) func))))

  ;; count occurrences of symbol a
  ;; using increment method of counter,
  ;; passed as func argument to map-tree.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
c (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> (c=
ounter 'a)))
        (tr '(a (b (a a)) c a d)))
    (map-tree tr (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C21=
6C3">meth</a> c increment))
    c)
  --&gt; #S(counter key a count 4
                 increment #&lt;function: type 0&gt;)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02ECA31C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.14">9.20.14<=
/a> Macro <tt>umeth</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(umeth </tt><tt><i>slot</i></tt><tt> </tt><tt><i>curried-ex=
pr</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ECA31C">umeth</a>=
</tt>
macro binds the symbol
<tt><i>slot</i></tt>
to a function and returns that function.
</p><p>
The
<tt><i>curried-expr</i></tt>
arguments, if present, are evaluated as if they were
arguments to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
When that function is called, it expects at least one argument.
The leftmost argument must be an object of struct type.
</p><p>
The slot named
<tt><i>slot</i></tt>
is retrieved from that object, and is expected to be a function.
That function is called with the object, followed by the values
of the
<tt><i>curried-expr</i></tt>-s,
if any, followed by that function's arguments.
</p><p>
The syntax can be understood as a translation to a call of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000BCBC5">umethod</=
a></tt>
function:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
ECA31C">umeth</a> s ...)  &lt;--&gt;  [<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#N-000BCBC5">umethod</a> 's ...]
</tt></pre><tt>

</tt>

<p>
The macro merely provides the syntactic sugar of not having to quote the
symbol, and automatically treating the curried argument expressions
using Lisp-1 semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>   ;; seal and dog are variables which hold structures of
   ;; different types. Both have a method called bark.

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> (=
(bark-fun (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ECA31C">um=
eth</a> bark)))
     [bark-fun dog]     ;; same effect as dog.(bark)
     [bark-fun seal])   ;; same effect as seal.(bark)
</tt></pre><tt>

</tt>

<p>
The
<tt>u</tt>
in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ECA31C">umeth</a>=
</tt>
stands for "unbound". The function produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ECA31C">umeth</a>=
</tt>
is not bound to any specific object; it binds to an object whenever it is
invoked by retrieving the actual method from the object's slot at call time=
.
</p><p>

</p></dd></dl>
<a name=3D"N-00BF39DD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.15">9.20.15<=
/a> Macro <tt>usl</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(usl </tt><tt><i>slot</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BF39DD">usl</a></=
tt>
macro binds the symbol
<tt><i>slot</i></tt>
to a function and returns that function.
</p><p>
When that function is called, it expects exactly one argument.
That argument must be an object of struct type.
The slot named
<tt><i>slot</i></tt>
is retrieved from that object and returned.
</p><p>
The name
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BF39DD">usl</a></=
tt>
stands for "unbound slot". The term "unbound" refers to the returned
function not being bound to a particular object. The binding of the
slot to an object takes place whenever the function is called.
</p><p>

</p></dd></dl>
<a name=3D"N-022EEF2D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.16">9.20.16<=
/a> Function <tt>make-struct-type</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-struct-type </tt><tt><i>name</i></tt><tt> </tt><tt><i=
>super</i></tt><tt> </tt><tt><i>static-slots</i></tt><tt> </tt><tt><i>slots=
</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>static-initfun</i><=
/tt><tt> </tt><tt><i>initfun</i></tt><tt> </tt><tt><i>boactor</i></tt><tt>=
=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>boactor</i></tt><tt=
> </tt><tt><i>postinitfun</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
function creates a new struct type.
</p><p>
The
<tt><i>name</i></tt>
argument must be a bindable symbol, according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function. It specifies the name property of the struct
type as well as the name under which the struct type
is globally registered.
</p><p>
The
<tt><i>super</i></tt>
argument indicates the supertype for the struct type.
It must be either a value of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>,
a symbol which names a struct type, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
indicating that the newly created struct type has no supertype.
</p><p>
The
<tt><i>static-slots</i></tt>
argument is a list of symbol which specify static slots.
The symbols must be bindable and the list must not contain duplicates.
</p><p>
The
<tt><i>slots</i></tt>
argument is a list of symbols which specifies the instance slots.
The symbols must be bindable and there must not be any duplicates
within the list, or against entries in the
<tt><i>static-slots</i></tt>
list.
</p><p>
The new struct type's effective list of slots is formed by appending
together
<tt><i>static-slots</i></tt>
and
<tt><i>slots</i></tt>,
and then appending that to the list of the supertype's slots, and
de-duplicating the resulting list as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6D456">uniq</a><=
/tt>
function. Thus, any slots which are already present in the supertype are
removed. If the structure has no supertype, then the list of supertype
slots is taken to be empty. When a structure is instantiated, it shall have=
 all
the slots specified in the effective list of slots. Each instance slot
shall be initialized to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
prior to the invocation of
<tt><i>initfun</i></tt>
and
<tt><i>boactor</i></tt>.
</p><p>
The
<tt><i>static-initfun</i></tt>
argument either specifies an initialization function, or is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
which is equivalent to specifying a function which does nothing.
</p><p>
Prior to the invocation of
<tt><i>static-initfun</i></tt>,
each new static slot shall be initialized the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Inherited static slots retain their values from the supertype.
</p><p>
If specified,
<tt><i>static-initfun</i></tt>
function must
accept one argument. When the structure type is created (before
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
function returns) the
<tt><i>static-initfun</i></tt>
function is invoked, passed the newly created
structure type as its argument.
</p><p>
The
<tt><i>initfun</i></tt>
argument either specifies an initialization function, or is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
which is equivalent to specifying a function which does nothing.
If specified, this function must
accept one argument. When a structure is instantiated, every
<tt><i>initfun</i></tt>
in its chain of supertype ancestry is invoked, in order of inheritance,
so that the root supertype's
<tt><i>initfun</i></tt>
is called first and the structure's own specific
<tt><i>initfun</i></tt>
is called last. These calls occur before the slots are initialized
from the
<tt><i>arg</i></tt>
arguments
or the
<tt><i>slot-init-plist</i></tt>
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>.
Each function is passed the newly created structure
object, and may alter its slots.
If multiple inheritance occurs, the
<tt><i>initfun</i></tt>
functions of multiple supertypes are called in right-to-left order.
</p><p>
The
<tt><i>boactor</i></tt>
argument either specifies a by-order-of-arguments initialization
function ("boa constructor") or is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
which is equivalent to specifying a constructor which does nothing.
If specified, it must be a function which takes at least one argument.
When a structure is instantiated, and boa arguments are given, the
<tt><i>boactor</i></tt>
is invoked, with the structure as the leftmost argument, and
the boa arguments as additional arguments. This takes place
after the processing of
<tt><i>initfun</i></tt>
functions, and after the processing of the
<tt><i>slot-init-plist</i></tt>
specified in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
call.  Note that the
<tt><i>boactor</i></tt>
functions of the supertypes are not called, only the
<tt><i>boactor</i></tt>
specific to the type being constructed.
</p><p>
The
<tt><i>postinitfun</i></tt>
argument either specifies an initialization function, or is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
which is equivalent to specifying a function which does nothing.
If specified, this function must accept one argument.
The
<tt><i>postinitfun</i></tt>
function is similar to
<tt><i>initfun</i></tt>.
The difference is that
<tt><i>postinitfun</i></tt>
functions are called after all other initialization processing,
rather than before. They are are also called in order of
inheritance: the
<tt><i>postinitfun</i></tt>
of a structure's supertype is called before its own,
and in right-to-left order among multiple supertypes
under multiple inheritance.
</p><p>

</p></dd></dl>
<a name=3D"N-01E5EEA7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.17">9.20.17<=
/a> Function <tt>find-struct-type</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(find-struct-type </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E5EEA7">find-stru=
ct-type</a></tt>
returns a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
object corresponding to the symbol
<tt><i>name</i></tt>.
</p><p>
If no struct type is registered under
<tt><i>name</i></tt>,
then it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
object exists for each structure type and holds information about it.
These objects are not themselves structures and are all of the
same type,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00717410">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.18">9.20.18<=
/a> Function <tt>struct-type-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct-type-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00717410">struct-ty=
pe-p</a></tt>
function returns t if
<tt><i>obj</i></tt>
is a structure type, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A structure type is an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>,
returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E5EEA7">find-stru=
ct-type</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00088BD7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.19">9.20.19<=
/a> Function <tt>struct-type-name</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct-type-name </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00088BD7">struct-ty=
pe-name</a></tt>
function returns the symbol which serves as the name of
<tt><i>type</i></tt>,
which must be either a struct type object (such as the return value of
a successful lookup via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E5EEA7">find-stru=
ct-type</a></tt>),
or else a struct type name.
</p><p>

</p></dd></dl>
<a name=3D"N-03D8EEEE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.20">9.20.20<=
/a> Function <tt>super</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(super </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8EEEE">super</a>=
</tt>
function returns the struct type object which is the
supertype of
<tt><i>type</i></tt>,
or returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if
<tt><i>type</i></tt>
has no supertype.
</p><p>
The
<tt><i>type</i></tt>
argument must be either a struct type object, a
a symbol which names a struct type (which is resolved to that type),
or else a structure instance (which is resolved to its structure type).
</p><p>

</p></dd></dl>
<a name=3D"N-002B3F64">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.21">9.20.21<=
/a> Function <tt>make-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-struct </tt><tt><i>type</i></tt><tt> </tt><tt><i>slot=
-init-plist</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
function returns a new object which is an instance of the
structure type
<tt><i>type</i></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must either be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
object, or else a symbol which is the name of a structure.
</p><p>
The
<tt><i>slot-init-plist</i></tt>
argument gives a list of slot initializations in the
style of a property list, as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C6D406">prop</a><=
/tt>
function. It may be empty, in which case
it has no effect. Otherwise, it specifies slot names
and their values. Each slot name which is given must
be a slot of the structure type. The corresponding value
will be stored into the slot of the newly created object. If a slot is
repeated, it is unspecified which value takes effect.
</p><p>
The optional
<tt><i>arg</i></tt>-s
specify arguments to the structure type's boa constructor.
If the arguments are omitted, the boa constructor is not invoked.
Otherwise the boa constructor is invoked on the structure object
and those arguments.  The argument list must match the trailing parameters =
of
the boa constructor (the remaining parameters which follow the leftmost
argument which passes the structure to the boa constructor).
</p><p>
When a new structure is instantiated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>,
its slot values are first initialized by the structure type's registered
functions as described under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>.
Then, the
<tt><i>slot-init-plist</i></tt>
is processed, if not empty, and finally, the
<tt><i>arg</i></tt>-s
are processed, if present, and passed to the boa constructor.
</p><p>
If any of the initializations abandon the evaluation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
by a non-local exit such as an exception throw, the object's
finalizers, if any, are invoked.
</p><p>

</p></dd></dl>
<a name=3D"N-01C734D9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.22">9.20.22<=
/a> Function <tt>make-lazy-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-lazy-struct </tt><tt><i>type</i></tt><tt> </tt><tt><i=
>argfun</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C734D9">make-lazy=
-struct</a></tt>
function returns a new object which is an instance of the
structure type
<tt><i>type</i></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must either be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
object, or else a symbol which is the name of a structure.
</p><p>
The
<tt><i>argfun</i></tt>
argument should be a function which can be called with no parameters
and returns a cons cell. More requirements are specified below.
</p><p>
The object returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C734D9">make-lazy=
-struct</a></tt>
is a lazily-initialized struct instance, or
<i>lazy struct</i>.

</p><p>
A lazy struct remains uninitialized until just before the first access
to any of its instance slots. Just before an instance slot is
accessed, initialization
takes place as follows. The
<tt><i>argfun</i></tt>
function is invoked with no arguments. Its return value must be a cons
cell. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
of the cons cell is taken to be a property list, as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C6D406">prop</a><=
/tt>
function.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field is taken to be a list of arguments. These values are treated
as if they were, respectively, the
<tt><i>slot-init-plist</i></tt>
and the boa constructor arguments given in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
invocation. Initialization of the structure proceeds as described
in the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01515451">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.23">9.20.23<=
/a> Functions <tt>struct-from-plist</tt> and <tt>struct-from-args</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct-from-plist </tt><tt><i>type</i></tt><tt> {</tt><tt>=
<i>slot</i></tt><tt> </tt><tt><i>value</i></tt><tt>}*)=20




<br>&nbsp;&nbsp;(struct-from-arg </tt><tt><i>type</i></tt><tt> </tt><tt><i>=
arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01515451">struct-fr=
om-plist</a></tt>
and
<tt>struct-from-arg</tt>
are interfaces to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01515451">struct-fr=
om-plist</a></tt>
function passes its
<tt><i>slot</i></tt>
and
<tt><i>value</i></tt>
arguments as the
<tt><i>slot-init-plist</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>.
It passes no boa constructor arguments.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01515451">struct-fr=
om-plist</a></tt>
function calls
<tt><i>make-struct</i></tt>
with an empty
<tt><i>slot-init-plist</i></tt>,
passing down the list of
<tt><i>arg</i></tt>-s.
</p><p>
The following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
515451">struct-from-plist</a> a s0 v0 s1 v1 ...)
  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64=
">make-struct</a> a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
06CE91">list</a> s0 v0 s1 v1 ...))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01515451">struct-fro=
m-args</a> a v0 v1 v2 ...)
  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64=
">make-struct</a> a nil v0 v1 v2 ...)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03168BF2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.24">9.20.24<=
/a> Function <tt>allocate-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(allocate-struct </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03168BF2">allocate-=
struct</a></tt>
provides a low-level allocator for structure objects.
</p><p>
The
<tt><i>type</i></tt>
argument must either be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
object, or else a symbol which is the name of a structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03168BF2">allocate-=
struct</a></tt>
creates and returns a new instance of
<tt><i>type</i></tt>
all of whose instance slots take on the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
No initializations are performed. The struct type's
registered initialization functions are not invoked.
</p><p>

</p></dd></dl>
<a name=3D"N-032B3FDC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.25">9.20.25<=
/a> Function <tt>copy-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-struct </tt><tt><i>struct-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032B3FDC">copy-stru=
ct</a></tt>
function creates and returns a new object which is a duplicate of
<tt><i>struct-obj</i></tt>,
which must be a structure.
</p><p>
The duplicate object is a structure of the same type as
<tt><i>struct-obj</i></tt>
and has the same slot values.
</p><p>
The creation of a duplicate does not involve calling any of the
struct type's initialization functions.
</p><p>
Only instance slots participate in the duplication. Since
the original structure and copy are of the same structure type,
they already share static slots.
</p><p>
This is a low-level, "shallow" copying mechanism. If an object design
calls for a higher level cloning mechanism with deep copying or other
additional semantics, one can be built on top of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032B3FDC">copy-stru=
ct</a></tt>.
For instance, a structure can have a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
method similar to the following:
</p><p>
<tt>
</tt></p><pre><tt>  (:method copy (me)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((my-copy (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032B3FDC">co=
py-struct</a> me)))
      ;; inform the copy that it has been created
      ;; by invoking its copied method.
      my-copy.(copied)
      my-copy))
</tt></pre><tt>

</tt>

<p>
since this logic is generic, it can be placed in a base
method. The
<tt>copied</tt>
method which it calls is the means by which the new object is notified that=
 it
is a copy. This method takes on whatever special responsibilities are requi=
red
when a copy is produced, such as registering the object in various necessar=
y
associations, or performing a deeper copy of some of the objects held
in the slots.
</p><p>
The
<tt>copied</tt>
handler can be implemented at multiple levels of an inheritance hierarchy. =
The
initial call to
<tt>copied</tt>
from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
will call the most derived override of that method.
</p><p>
To call the corresponding method in the base class, a given derived method
can use the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223E999">call-supe=
r-fun</a></tt>
function, or else the
<tt>(meth ...)</tt>
syntax in the first position of a compound form, in place of a function nam=
e.
Examples of both are given in the documentation for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223E999">call-supe=
r-fun</a></tt>.
</p><p>
Thus derived structs can inherit the copy handling logic from base structs,=
 and
extend it with their own.
</p><p>

</p></dd></dl>
<a name=3D"N-0326F62D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.26">9.20.26<=
/a> Accessor <tt>slot</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(slot </tt><tt><i>struct-obj</i></tt><tt> </tt><tt><i>slot-=
name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (slot </tt><tt><i>struct-obj</i></tt><tt> </tt><tt><i>=
slot-name</i></tt><tt>) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F62D">slot</a><=
/tt>
function retrieves a structure's slot. The
<tt><i>struct-obj</i></tt>
argument must be a structure, and
<tt><i>slot-name</i></tt>
must be a symbol which names a slot in that structure.
</p><p>
Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F62D">slot</a><=
/tt>
is an accessor, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F62D">slot</a><=
/tt>
form is a syntactic place which denotes the
slot's storage location.
</p><p>
A syntactic place expressed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F62D">slot</a><=
/tt>
does not support deletion.
</p><p>

</p></dd></dl>
<a name=3D"N-02657437">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.27">9.20.27<=
/a> Function <tt>slotset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(slotset </tt><tt><i>struct-obj</i></tt><tt> </tt><tt><i>sl=
ot-name</i></tt><tt> </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02657437">slotset</=
a></tt>
function stores a value in a structure's slot.
<br>&nbsp;The
<tt><i>struct-obj</i></tt>
argument must be a structure, and
<tt><i>slot-name</i></tt>
must be a symbol which names a slot in that structure.
</p><p>
The
<tt><i>new-value</i></tt>
argument specifies the value to be stored in the slot.
</p><p>
If a successful store takes place to an instance slot of
<tt><i>struct-obj</i></tt>,
then the dirty flag of that object is set, causing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-dirt=
y</a></tt>
function to report true for that object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02657437">slotset</=
a></tt>
function returns
<tt><i>new-value</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03AB857D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.28">9.20.28<=
/a> Functions <tt>test-dirty</tt>, <tt>clear-dirty</tt> and <tt>test-clear-=
dirty</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(test-dirty </tt><tt><i>struct-obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(clear-dirty </tt><tt><i>struct-obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(test-clear-dirty </tt><tt><i>struct-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-dirt=
y</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">clear-dir=
ty</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-clea=
r-dirty</a></tt>
functions comprise the interface for interacting with structure
dirty flags.
</p><p>
Each structure instance has a dirty flag. When this flag is set, the
structure instance is said to be dirty, otherwise it is said to be clean. A
newly created structure is dirty.  A structure remains dirty until its dirt=
y
flag is explicitly reset.  If a structure is clean, and one of its instance
slots is overwritten with a new value, it becomes dirty.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-dirt=
y</a></tt>
function returns the dirty flag of
<tt><i>struct-obj</i></tt>:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>struct-obj</i></tt>
is dirty, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">clear-dir=
ty</a></tt>
function clears the dirty flag of
<tt><i>struct-obj</i></tt>
and returns
<tt><i>struct-obj</i></tt>
itself.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB857D">test-clea=
r-dirty</a></tt>
flag combines these operations: it makes a note of the dirty flag of
<tt><i>struct-obj</i></tt>
and clears it. Then it returns the noted value,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01BB3FB3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.29">9.20.29<=
/a> Function <tt>structp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(structp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BB3FB3">structp</=
a></tt>
function returns t if
<tt><i>obj</i></tt>
is a structure, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02C33D76">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.30">9.20.30<=
/a> Function <tt>struct-type</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct-type </tt><tt><i>struct-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C33D76">struct-ty=
pe</a></tt>
function returns the structure type object which
represents the type of the structure object instance
<tt><i>struct-obj</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03A968CA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.31">9.20.31<=
/a> Function <tt>clear-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(clear-struct </tt><tt><i>struct-obj</i></tt><tt> [</tt><tt=
><i>value</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A968CA">clear-str=
uct</a></tt>
replaces all instance slots of
<tt><i>struct-obj</i></tt>
with
<tt><i>value</i></tt>,
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if omitted.
</p><p>
Note that finalizers are not executed prior to replacing
the slot values.
</p><p>

</p></dd></dl>
<a name=3D"N-002A609F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.32">9.20.32<=
/a> Function <tt>reset-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(reset-struct </tt><tt><i>struct-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002A609F">reset-str=
uct</a></tt>
function reinitializes the structure object
<tt><i>struct-obj</i></tt>
as if it were being newly created.
First, all the slots are set to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A968CA">clear-str=
uct</a></tt>
function. Then the slots are initialized by invoking the
initialization functions, in order of the supertype ancestry, just as would=
 be
done for a new structure object created by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>
with an empty
<tt><i>slot-init-plist</i></tt>
and no boa arguments.
</p><p>
Note that finalizers registered against
<tt><i>struct-obj</i></tt>
are not invoked prior to the reset operation, and remain registered.
</p><p>
If the structure has state which is cleaned up by
finalizers, it is advisable to invoke them using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
prior to using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002A609F">reset-str=
uct</a></tt>,
or to take other measures to deal with the
situation.
</p><p>
If the structure specifies
<tt>:fini</tt>
handlers, then the reinitialization will cause
these to registered, just like when a new object
it constructed. Thus if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
is not used prior to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002A609F">reset-str=
uct</a></tt>,
this will result in the existence of duplicate registrations of the
finalization functions.
</p><p>
Finalizers registered against
<tt><i>struct-obj</i></tt>
<b>are</b>

invoked if an exception is thrown
during the reinitialization, just like when a new
structure is being constructed.
</p><p>

</p></dd></dl>
<a name=3D"N-01A8343B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.33">9.20.33<=
/a> Function <tt>replace-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(replace-struct </tt><tt><i>target-obj</i></tt><tt> </tt><t=
t><i>source-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A8343B">replace-s=
truct</a></tt>
function causes
<tt><i>target-obj</i></tt>
to take on the attributes of
<tt><i>source-obj</i></tt>
without changing its identity.
</p><p>
The type of
<tt>target-obj</tt>
is changed to that of
<tt>source-obj</tt>.
</p><p>
All instance slots of
<tt>target-obj</tt>
are discarded, and it is given new slots,
which are copies of the instance slots of
<tt>source-obj</tt>.
</p><p>
Because of the type change,
<tt>target-obj</tt>
implicitly loses all of its original static slots,
and acquires those of
<tt>source obj</tt>.
</p><p>
Note that finalizers registered against
<tt><i>target-obj</i></tt>
are not invoked, and remain registered.
If
<tt><i>target-obj</i></tt>
has state which is cleaned up by
finalizers, it is advisable to invoke them using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
prior to using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A8343B">replace-s=
truct</a></tt>,
or to take other measures to handle the situation.
</p><p>
If the
<tt><i>target-obj</i></tt>
and
<tt><i>source-obj</i></tt>
arguments are the same object,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A8343B">replace-s=
truct</a></tt>
has no effect.
</p><p>
The return value is
<tt><i>target-obj</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-022200C1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.34">9.20.34<=
/a> Function <tt>method</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(method </tt><tt><i>struct-obj</i></tt><tt> </tt><tt><i>slo=
t-name</i></tt><tt> </tt><tt><i>curried-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022200C1">method</a=
></tt>
function retrieves a function
<tt><i>m</i></tt>
from a structure's slot
and returns a new function which binds that function's
left argument. If
<tt><i>curried-arg</i></tt>
arguments are present, then they are also stored in
the returned function. These are the
<i>curried arguments</i>.

</p><p>
The
<tt><i>struct-obj</i></tt>
argument must be a structure, and
<tt><i>slot-name</i></tt>
must be a symbol denoting a slot in that structure.
The slot must hold a function of at least one
argument.
</p><p>
The function
<tt><i>f</i></tt>
which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022200C1">method</a=
></tt>
function returns, when invoked,
calls the function
<tt><i>m</i></tt>
previously retrieved from the object's
slot, passing to that function
<tt><i>struct-obj</i></tt>
as the leftmost argument, followed by the curried
arguments, followed by all of
<tt><i>f</i></tt>'s
own arguments.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a><=
/tt>
macro is an alternative interface which is suitable if
the slot name isn't a computed value.
</p><p>

</p></dd></dl>
<a name=3D"N-02AC8367">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.35">9.20.35<=
/a> Function <tt>super-method</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(super-method </tt><tt><i>struct-obj</i></tt><tt> </tt><tt>=
<i>slot-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC8367">super-met=
hod</a></tt>
function retrieves a function from a static
slot belonging to one of the direct supertypes of the structure type of
<tt><i>struct-obj</i></tt>.
</p><p>
It then returns a function which binds
that function's left argument to the structure.
</p><p>
The
<tt><i>struct-obj</i></tt>
argument must be a structure which has at least one supertype, and
<tt><i>slot-name</i></tt>
must be a symbol denoting a static slot in one of those supertypes.
The slot must hold a function of at least one
argument. The supertypes are searched from left to right for a static
slot named
<tt><i>slot-name</i></tt>;
when the first such slot is found, its value is used.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC8367">super-met=
hod</a></tt>
function returns a function which, when invoked,
calls the function previously retrieved from
the supertype's static slot, passing to that function
<tt><i>struct-obj</i></tt>
as the leftmost argument, followed by the function's
own arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-000BCBC5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.36">9.20.36<=
/a> Function <tt>umethod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(umethod </tt><tt><i>slot-name</i></tt><tt> </tt><tt><i>cur=
ried-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000BCBC5">umethod</=
a></tt>
returns a function which represents the set of all methods named by
the slot
<tt><i>slot-name</i></tt>
in all structure types, including ones not yet defined.
The
<tt><i>slot-name</i></tt>
argument must be a symbol.
</p><p>
If one or more
<tt><i>curried-arg</i></tt>
argument are present, these values represent the
<i>curried arguments</i>

which are stored in the function object which is returned.
</p><p>
This returned function must be called with at least one argument. Its leftm=
ost
argument must be an object of structure type, which has a slot named
<tt><i>slot-name</i></tt>.
The function will retrieve the value of the slot from that object,
expecting it to be a function, and calls it, passing to it the following
arguments: the object itself; all of the curried arguments, if any; and
all of its remaining arguments.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000BCBC5">umethod</=
a></tt>
name stands for "unbound method". Unlike the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022200C1">method</a=
></tt>
function,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000BCBC5">umethod</=
a></tt>
doesn't return a method whose leftmost argument is already bound to
an object; the binding occurs at call time.
</p><p>

</p></dd></dl>
<a name=3D"N-01F8E0A1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.37">9.20.37<=
/a> Function <tt>uslot</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(uslot </tt><tt><i>slot-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F8E0A1">uslot</a>=
</tt>
returns a function which represents all slots named
<tt><i>slot-name</i></tt>
in all structure types, including ones not yet defined.
The
<tt><i>slot-name</i></tt>
argument must be a symbol.
</p><p>
The returned function must be called with exactly one argument.
The argument must be a structure which has a slot named
<tt><i>slot-name</i></tt>.
The function will retrieve the value of the slot from that object
and return it.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F8E0A1">uslot</a>=
</tt>
name stands for "unbound slot". The returned function
isn't bound to a particular object. The binding of
<tt>slot-name</tt>
to a slot in the structure object occurs when the function is called.
</p><p>

</p></dd></dl>
<a name=3D"N-00E90177">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.38">9.20.38<=
/a> Function <tt>slots</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(slots </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E90177">slots</a>=
</tt>
function returns a list of all of the slots of struct type
<tt><i>type</i></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must be a structure type, or else a symbol
which names a structure type.

</p></dd></dl>
<a name=3D"N-00B90177">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.39">9.20.39<=
/a> Function <tt>slotp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(slotp </tt><tt><i>type</i></tt><tt> </tt><tt><i>name</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B90177">slotp</a>=
</tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if name
<tt><i>name</i></tt>
is a symbol which names a slot in the structure type
<tt><i>type</i></tt>.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must be a structure type, or else a symbol
which names a structure type.
</p><p>

</p></dd></dl>
<a name=3D"N-032FD510">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.40">9.20.40<=
/a> Function <tt>static-slot-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(static-slot-p </tt><tt><i>type</i></tt><tt> </tt><tt><i>na=
me</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032FD510">static-sl=
ot-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if name
<tt><i>name</i></tt>
is a symbol which names a slot in the structure type
<tt><i>type</i></tt>,
and if that slot is a static slot.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must be a structure type, or else a symbol
which names a structure type.
</p><p>

</p></dd></dl>
<a name=3D"N-02C47D17">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.41">9.20.41<=
/a> Function <tt>static-slot</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(static-slot </tt><tt><i>type</i></tt><tt> </tt><tt><i>name=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C47D17">static-sl=
ot</a></tt>
function retrieves the value of the static slot
named by symbol
<tt><i>name</i></tt>
of the structure type
<tt><i>type</i></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must be a structure type or a symbol which names a
structure type, and
<tt><i>name</i></tt>
must be a static slot of this type.
</p><p>

</p></dd></dl>
<a name=3D"N-0017D1B5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.42">9.20.42<=
/a> Function <tt>static-slot-set</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(static-slot-set </tt><tt><i>type</i></tt><tt> </tt><tt><i>=
name</i></tt><tt> </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0017D1B5">static-sl=
ot-set</a></tt>
function stores
<tt><i>new-value</i></tt>
into the static slot named by symbol
<tt><i>name</i></tt>
of the structure type
<tt><i>type</i></tt>.
</p><p>
It returns
<tt><i>new-value</i></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must be a structure type or the name of a structure type, and
<tt><i>name</i></tt>
must be a static slot of this type.
</p><p>

</p></dd></dl>
<a name=3D"N-02E71F31">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.43">9.20.43<=
/a> Function <tt>static-slot-ensure</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(static-slot-ensure </tt><tt><i>type</i></tt><tt> </tt><tt>=
<i>name</i></tt><tt> </tt><tt><i>new-value</i></tt><tt> [</tt><tt><i>no-err=
or-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E71F31">static-sl=
ot-ensure</a></tt>
ensures, if possible, that the struct type
<tt><i>type</i></tt>,
as well as possibly one or more struct types derived from it,
have a static slot called
<tt><i>name</i></tt>,
that this slot is not shared with a supertype,
and that the value stored in it is
<tt><i>new-value</i></tt>.
</p><p>
Note: this function supports the redefinition of methods,
as the implementation underlying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
macro; its semantics is designed to harmonize with expected
behaviors in that usage.
</p><p>
The function operates as follows.
</p><p>
If
<tt><i>type</i></tt>
itself already has an instance slot called
<tt><i>name</i></tt>
then an error is thrown, and the function has no effect, unless a
true argument is specified for the
<tt><i>no-error-p</i></tt>
Boolean parameter. In that case, in the same situation, the function
has no effect and simply returns
<tt><i>new-value</i></tt>.
</p><p>
If
<tt><i>type</i></tt>
already has a non-inherited static slot called
<tt><i>name</i></tt>
then this slot is overwritten with
<tt><i>new-value</i></tt>
and the function returns
<tt><i>new-value</i></tt>.
Types derived from
<tt><i>type</i></tt>
may also have this slot, via inheritance; consequently, its value
changes in those types also.
</p><p>
If
<tt><i>type</i></tt>
already has an inherited static slot called
<tt><i>name</i></tt>
then its inheritance is severed; the slot is converted
to a non-inherited static slot of
<tt><i>type</i></tt>
and initialized with
<tt><i>new-value</i></tt>.
Then all struct types derived from
<tt><i>type</i></tt>
are scanned. In each such type, if the original inherited
static slot is found, it is replaced with the same
newly converted static slot that was just introduced into
<tt><i>type</i></tt>,
so that all these types now inherit this new slot from
<tt><i>type</i></tt>
rather than the original slot from some supertype of
<tt><i>type</i></tt>.
These types all share a single instance of the slot with
<tt><i>type</i></tt>,
but not with supertypes of
<tt><i>type</i></tt>.
</p><p>
In the remaining case,
<tt><i>type</i></tt>
has no slot called
<tt><i>name</i></tt>.
The slot is added as a static slot to
<tt><i>type</i></tt>.
Then it is added to every struct type derived from
<tt><i>type</i></tt>
which does not already have a slot by that name, as if
by inheritance.  That is to say, types to which this slot is introduced sha=
re a
single instance of that slot.  The value of the new slot is
<tt><i>new-value</i></tt>,
which is also returned from the function.  Any subtypes of
<tt><i>type</i></tt>
which already have a slot called
<tt><i>name</i></tt>
are ignored, as are their subtypes.
</p><p>

</p></dd></dl>
<a name=3D"N-01F88B0D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.44">9.20.44<=
/a> Function <tt>static-slot-home</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(static-slot-home </tt><tt><i>type</i></tt><tt> </tt><tt><i=
>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F88B0D">static-sl=
ot-home</a></tt>
method determines which structure type actually defines the
static slot
<tt><i>name</i></tt>
present in struct type
<tt><i>type</i></tt>.
</p><p>
If
<tt><i>type</i></tt>
isn't a struct type, or the name of a struct type,
the function throws an error. Likewise, if
<tt><i>name</i></tt>
isn't a static slot of
<tt><i>type</i></tt>.
</p><p>
If
<tt><i>name</i></tt>
is a static slot of
<tt><i>type</i></tt>
then the function returns a struct type name symbol which is either
then name of
<tt><i>type</i></tt>
itself, if the slot is defined specifically for
<tt><i>type</i></tt>
or else the most distant ancestor of
<tt><i>type</i></tt>
from which the slot is inherited.
</p><p>

</p></dd></dl>
<a name=3D"N-016185D1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.45">9.20.45<=
/a> Function <tt>call-super-method</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call-super-method </tt><tt><i>struct-obj</i></tt><tt> </tt=
><tt><i>name</i></tt><tt> </tt><tt><i>argument</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016185D1">call-supe=
r-method</a></tt>
function is deprecated. Solutions involving
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016185D1">call-supe=
r-method</a></tt>
should be reworked in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223E999">call-supe=
r-fun</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016185D1">call-supe=
r-method</a></tt>
retrieves the function stored in the static slot
<tt><i>name</i></tt>
of one of the direct supertypes of
<tt><i>struct-obj</i></tt>
and invokes it, passing to that function
<tt><i>struct-obj</i></tt>
as the leftmost argument, followed by the given
<tt><i>argument</i></tt>-s,
if any.
</p><p>
The
<tt><i>struct-obj</i></tt>
argument must be of structure type. Moreover,
that structure type must be derived from one or more supertypes,
and
<tt><i>name</i></tt>
must name a static slot available from at least one of those supertypes.
The supertypes are searched left to right in search of this slot.
</p><p>
The object retrieved from that static slot must be
callable as a function, and accept the arguments.
</p><p>
Note that it is not correct for a method that is defined
against a particular type to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016185D1">call-supe=
r-method</a></tt>
to call the same method (or any other method) in the supertype
of that particular type. This is because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016185D1">call-supe=
r-method</a></tt>
refers to the type of the object instance
<tt><i>struct-obj</i></tt>,
not to the type against which the calling method is defined.
</p><p>

</p></dd></dl>
<a name=3D"N-0223E999">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.46">9.20.46<=
/a> Function <tt>call-super-fun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call-super-fun </tt><tt><i>type</i></tt><tt> </tt><tt><i>n=
ame</i></tt><tt> </tt><tt><i>argument</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223E999">call-supe=
r-fun</a></tt>
retrieves the function stored in the slot
<tt><i>name</i></tt>
of one of the supertypes of
<tt><i>type</i></tt>
and invokes it, passing to that function the given
<tt><i>argument</i></tt>-s,
if any.
</p><p>
The
<tt><i>type</i></tt>
argument must be a structure type. Moreover,
that structure type must be derived from one or more supertypes,
and
<tt><i>name</i></tt>
must name a static slot available from at least one of those supertypes.
The supertypes are searched left to right in search of this slot.
</p><p>
The object retrieved from that static slot must be
callable as a function, and accept the arguments.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Print a message and call supertype method:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
1CC672">defstruct</a> base nil)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> derived base)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</a=
> base fun (obj arg)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "base fun method called with arg ~s\n" arg))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</a=
> derived fun (obj arg)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "derived fun method called with arg ~s\n" arg)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223E999">call-sup=
er-fun</a> 'derived 'fun obj arg))

  ;; Interactive Listener:
  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new<=
/a> derived).(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C"=
>fun</a> 42)
  derived fun method called with arg 42
  base fun method called with arg 42
</tt></pre><tt>

</tt>

<p>
Note that a static method or function in any structure type
can be invoked by using the
<tt>(meth ...)</tt>
name syntax in the first position of a compound form, as
a function name. Thus, the above
<tt>derived fun</tt>
can also be written:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
47C7E8">defmeth</a> derived fun (obj arg)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "derived fun method called with arg ~s\n" arg)
    ((meth base fun) obj arg))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03946F2A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.47">9.20.47<=
/a> Functions <tt>struct-get-initfun</tt> and <tt>struct-get-postinitfun</t=
t></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct-get-initfun </tt><tt><i>type</i></tt><tt>)=20




<br>&nbsp;&nbsp;(struct-get-postinitfun </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03946F2A">struct-ge=
t-initfun</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03946F2A">struct-ge=
t-postinitfun</a></tt>
functions retrieve, respectively, a structure type's
<tt><i>initfun</i></tt>
and
<tt><i>postinitfun</i></tt>
functions. These are the functions which are initially configured in the ca=
ll to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
via the
<tt><i>initfun</i></tt>
and
<tt><i>postinitfun</i></tt>
arguments.
</p><p>
Either one may be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
indicating that the type has no
<tt><i>initfun</i></tt>
or
<tt><i>postinitfun</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00946F18">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.48">9.20.48<=
/a> Functions <tt>struct-set-initfun</tt> and <tt>struct-set-postinitfun</t=
t></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct-set-initfun </tt><tt><i>type</i></tt><tt> </tt><tt>=
<i>function</i></tt><tt>)=20




<br>&nbsp;&nbsp;(struct-set-postinitfun </tt><tt><i>type</i></tt><tt> </tt>=
<tt><i>function</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00946F18">struct-se=
t-initfun</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00946F18">struct-se=
t-postinitfun</a></tt>
functions overwrite, respectively, a structure type's
<tt><i>initfun</i></tt>
and
<tt><i>postinitfun</i></tt>
functions. These are the functions which are initially configured in the ca=
ll to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
via the
<tt><i>initfun</i></tt>
and
<tt><i>postinitfun</i></tt>
arguments.
</p><p>
The
<tt><i>function</i></tt>
argument must either be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or else a function which accepts one argument.
</p><p>
Note that
<tt><i>initfun</i></tt>
has the responsibility for all instance slot initializations. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
syntax compiles the initializing expressions in the slot specifier syntax
into statements which are placed into a function, which becomes the
<tt><i>initfun</i></tt>
of the struct type.
</p><p>

</p></dd></dl>
<a name=3D"N-00AECEBA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.20.49">9.20.49<=
/a> Macro <tt>with-objects</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-objects ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>i=
nit-form</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AECEBA">with-obje=
cts</a></tt>
macro provides a binding construct similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
</p><p>
Each
<tt><i>sym</i></tt>
must be a symbol suitable for use as a variable name.
</p><p>
Each
<tt><i>init-form</i></tt>
is evaluated in sequence, and a binding is established for its
corresponding
<tt><i>sym</i></tt>
which is initialized with the value of that form. The binding
is visible to subsequent
<tt><i>init-form</i></tt>-s.
</p><p>
Additionally, the values of the
<tt><i>init-form</i></tt>-s
are noted as they are produced.  When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AECEBA">with-obje=
cts</a></tt>
form terminates, by any means, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
function is invoked on each value which was returned by an
<tt><i>init-form</i></tt>
and had been noted. These calls are performed in the
reverse order relative to the original evaluation of the forms.
</p><p>
After the variables are established and initialized, the
<tt><i>body-form</i></tt>-s
are evaluated in the scope of the variables. The value of the
last form is returned, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no forms. The invocations of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
take place just before the value of the last form is returned.
</p><p>
</p></dd></dl>
<a name=3D"N-007C2511">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21">9.21</a> Sp=
ecial Structure Functions</h3>



<p>


</p><p>
Special structure functions are user-defined methods or structure functions
which are specially recognized by certain functions in <b>TXR Lisp</b>. The=
y endow
structure objects with the ability to participate in certain usage scenario=
s,
or to participate in a customized way.
</p><p>
Special functions are required to bound to static slots, which is the
case if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>
macro is used, or when methods or functions are defined using syntax
inside a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
form. If a special function or method is defined as an instance slot,
then the behavior of library functions which depend on this method is
unspecified.
</p><p>
Special functions introduced below by the word "Method" receive an object
instance as an argument. Their syntax is indicated using the same notation
which may be used to invoke them, such as:
</p><p>
<tt>
</tt></p><pre><tt>  </tt><tt><i>object</i></tt><tt>.(function-name </tt><tt=
><i>arg</i></tt><tt> </tt><tt><i>...</i></tt><tt>)=20
</tt></pre><tt>

</tt>

<p>
However, those introduced as "Function" do not operate on an instance.
Their syntax is likewise indicated using the notation that may be used
to invoke them:
</p><p>
<tt>
</tt></p><pre><tt>  '['</tt><tt><i>object</i></tt><tt>.function-name </tt><=
tt><i>arg</i></tt><tt> </tt><tt><i>...</i></tt><tt>']'=20
</tt></pre><tt>

</tt>

<p>
If such a invocation is actually used, the
<tt><i>object</i></tt>
instance only serves for identifying the struct type whose static slot
<tt>function-name</tt>
provides the function;
<tt><i>object</i></tt>
doesn't participate in the call. An object is not strictly required since
the function can be called using
</p><p>
<tt>
</tt></p><pre><tt>  [(static-slot </tt><tt><i>type</i></tt><tt> 'function-n=
ame) </tt><tt><i>arg</i></tt><tt> </tt><tt><i>...</i></tt><tt>]=20
</tt></pre><tt>

</tt>

<p>
which looks up the function in the struct
<tt><i>type</i></tt>
directly.
</p><p>

<a name=3D"N-00790C76">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.1">9.21.=
1</a> Method <tt>equal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(equal)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Normally, two struct values are not considered the same under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function unless they are the same object.
</p><p>
However, if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method is defined for a structure type, then instances of
that structure type support
<i>equality substitution</i>.

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method must not require any arguments other than
<tt><i>object</i></tt>.
Moreover, the method must never return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
When a struct which supports equality substitution is compared using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>,
its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method is invoked, and the return value is used in place of that
structure for the purposes of the comparison.
</p><p>
The same applies when an struct is hashed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000455E">hash-equa=
l</a></tt>
function, or implicitly by an
<tt>:equal-hash</tt>
hash table.
</p><p>
Note: if an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method is defined or redefined with different semantics for a struct
type whose instances have already been inserted as keys in an
<tt>:equal-based</tt>
hash table, the behavior of subsequent insertion and lookup operations
on that hash table becomes unspecified.
</p><p>

</p></dd></dl>
<a name=3D"N-00F8B869">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.2">9.21.2</a=
> Method <tt>print</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(print </tt><tt><i>stream</=
i></tt><tt> </tt><tt><i>pretty-p</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If a method named by the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
is defined for a structure type, then it is used for printing instances
of that type.
</p><p>
The
<tt><i>stream</i></tt>
argument specifies the output stream to which the printed representation
is to be written.
</p><p>
The
<tt><i>pretty-p</i></tt>
argument is a Boolean flag indicating whether pretty-printing
is requested. Its value may simply be passed to recursive calls to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>,
or used to select between
<tt>~s</tt>
or
<tt>~a</tt>
formatting if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
is used.
</p><p>
The value returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
method is significant. If the special keyword symbol
<tt>:</tt>
(colon) is returned, then the system will print the object
in the default way, as if no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
method existed: it is understood that the method declined
the responsibility for printing the object.
</p><p>
If any other value is returned, then it is understood
that the method
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
method accepted the responsibility for printing the object,
and the system consequently will generate into
<tt><i>stream</i></tt>
any output output pertaining to
<tt><i>object</i></tt>'s
representation.
</p><p>

</p></dd></dl>
<a name=3D"N-02E775FE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.3">9.21.3</a=
> Method <tt>lambda</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(lambda </tt><tt><i>arg</i>=
</tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If a structure type provides a method called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
then it can be used as a function.
</p><p>
This method can be called by name, using the syntax given
in the above syntactic description.
</p><p>
However, the intended use is that it allows the structure instance itself t=
o be
used as a function.  When arguments are applied to a structure object as if=
 it
were a function, this is erroneous, unless that object has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method. In that case, the arguments are passed to the lambda method.
The leftmost argument of the method is the structure instance
itself.
</p><p>
That is to say, the following equivalences apply, except that
<tt>s</tt>
is evaluated only once:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> s args ...)  &lt;--&gt;  s.(<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#D-004F">lambda</a> args ...)

  [s args ...]  &lt;--&gt;  [s.lambda s args ...]

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 s list)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0202F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2C216C3">meth</a> s lambda) list)
</tt></pre><tt>

</tt>

<p>
Note: a form such as
<tt>[s args ...]</tt>
where
<tt>s</tt>
is a structure can be treated as a place if the method
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
is also implemented.
</p><p>

</p></dd></dl>
<a name=3D"N-02FEBA97">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.4">9.21.4</a=
> Method <tt>lambda-set</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(lambda-set </tt><tt><i>arg=
</i></tt><tt>* </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method, in conjunction with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method, allows structures to be used as place accessors. If
structure
<tt>s</tt>
supports a
<tt><i>lambda-set</i></tt>
with four arguments, then the following use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator is possible:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> [s a b c d] v)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a> s a b c d) v)=
 ;; precisely equivalently
</tt></pre><tt>

</tt>

<p>
This has an effect which can be described by the following code:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F7A8B8">progn</a>
    s s.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lamb=
da-set</a> a b c d v)
    v)
</tt></pre><tt>

</tt>

<p>
except that
<tt>s</tt>
and
<tt>v</tt>
are evaluated only once, and
<tt>a</tt>
through
<tt>d</tt>
are evaluated using the Lisp-1 semantics due the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
If a place-mutating operator is used on this form which requires the prior
value, such as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
macro, then the structure must support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
function also.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
takes
<i>n</i>

arguments, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
should take
<i>n+1</i>

arguments. The first
<i>n</i>

arguments of these two methods are congruent; the extra rightmost argument
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
is the new value to be stored into the place denoted by the prior
arguments.
</p><p>
The return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
is ignored.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method is also used by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
function, if no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
method exists.
</p><p>
</p></dd><dt>Example</dt><dd>
<p>


</p><p>
The following defines a structure with a single instance
slot
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
which holds a hash table, as well as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
methods:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
1CC672">defstruct</a> hash-wrapper nil
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a>))

    (:method lambda (self key)
      [self.hash key])

    (:method lambda-set (self key new-val)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> [s=
elf.hash key] new-val) self))
</tt></pre><tt>

</tt>

<p>
An instance of this structure can now be used as follows:
</p><p>
<tt>
</tt></p><pre><tt>   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
13AF20B">let</a> ((s (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
230059D">new</a> hash-wrapper)))
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> [s =
"apple"] 3
          [s "orange] 4)
     [s "apple"]) -&gt; 3
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-025D84CE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.5">9.21.5</a=
> Method <tt>length</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(length)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If a structure has
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
method, then it can be used as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function.
</p><p>
Structures which implement the methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
can be treated as abstract vector-like sequences, because such
structures support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
functions.
</p><p>
For instance, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">nreverse<=
/a></tt>
function will operate on such objects.
</p><p>
Note: a structure which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
method also supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function, in a different way. Such a structure is treated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
as a list-like sequence, and its length is measured by walking the
sequence with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
operations. If a structure supports both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
preference is given to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>,
which is likely to be much more efficient.
</p><p>

</p></dd></dl>
<a name=3D"N-035F2D99">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.6">9.21.6</a=
> Methods <tt>car</tt>, <tt>cdr</tt> and <tt>nullify</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(car)=20




<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(cdr)=20




<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(nullify)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Structures may be treated as sequences if they define methods named
by the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>.
</p><p>
If a structure supports these methods, then these methods are used
by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</a>=
</tt>
and various other sequence manipulating functions derived from them, when t=
hose
functions are applied to that object.
</p><p>
An object which implements these three methods can be considered to represe=
nt a
<i>list-like</i>

abstract sequence.
</p><p>
The object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
method should return the first value in that abstract sequence, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if that sequence is empty.
</p><p>
The object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
method should return an object denoting the remainder of the sequence,
or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the sequence is empty or contains only one value.  This returned object =
can
be of any type: it may be of the same structure type as that object, a
different structure type, a list, or whatever else.  If a non-sequence obje=
ct
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
method should return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the object is considered to denote an empty sequence. Otherwise it
should either return that object itself, or else return the sequence which
that object represents.
</p><p>

</p></dd></dl>
<a name=3D"N-0002B267">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.7">9.21.7</a=
> Methods <tt>rplaca</tt> and <tt>rplacd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(rplaca </tt><tt><i>new-car=
-value</i></tt><tt>)=20




<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(rplacd </tt><tt><i>new-cdr=
-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If a structure type defines the methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
then, respectively, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
functions will use these methods if they are applied to instances of that t=
ype.
</p><p>
That is to say, when the function call
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a> </tt>=
<tt><i>o</i></tt><tt> </tt><tt><i>v</i></tt><tt>)=20

</tt>

is evaluated, and
<tt><i>o</i></tt>
is a structure type, the function inquires whether
<tt><i>o</i></tt>
supports a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
method. If so, then, effectively,
<tt>




</tt><tt><i>o</i></tt><tt>. (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-000B">rplaca</a> </tt><tt><i>v)</i></tt><tt>=20

</tt>

is invoked. The return value of this method call is ignored;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
returns
<tt><i>o</i></tt>.
The analogous requirements apply to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
in relation to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0013">rplacd</a></t=
t>
method.
</p><p>
Note: if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
method doesn't exist, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
function falls back on trying to store
<tt><i>new-car-value</i></tt>
by means of the structure type's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method, using an index of zero. That is to say, if the type has no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
method, but does have a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method, then
<tt>




</tt><tt><i>o</i></tt><tt>. (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-02FEBA97">lambda-set</a> 0 </tt><tt><i>v)</i></tt><tt>=20

</tt>

is invoked.
</p><p>

</p></dd></dl>
<a name=3D"N-01FFD230">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.8">9.21.8</a=
> Function <tt>from-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;'['</tt><tt><i>object</i></tt><tt>.from-list </tt><tt><i>li=
st</i></tt><tt>']'=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FFD230">from-list=
</a></tt>
structure function is defined for a structure type, it is called in certain
situations with an argument which is a list object. The function's purpose
is to construct a new instance of the structure type, derived from that
list.
</p><p>
The purpose of this function is to allow sequence processing operations
such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
and
<tt>remove</tt>
to operate on a structure object as if it were a sequence, and return a
transformed sequence of the same type.  This is analogous to the way such
functions can operate on a vector or string, and return a vector or string.
</p><p>
If a structure object behaves as a sequence thanks to providing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
methods, but does not have a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FFD230">from-list=
</a></tt>
function, then those sequence-processing operations which return a sequence
will always return a plain list of items.
</p><p>

</p></dd></dl>
<a name=3D"N-0151798B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.9">9.21.9</a=
> Function <tt>derived</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;'['</tt><tt><i>object</i></tt><tt>.derived </tt><tt><i>supe=
rtype</i></tt><tt> </tt><tt><i>subtype</i></tt><tt>']'=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If a structure type supports a function called
<tt><i>derived</i></tt>,
this function is called whenever a new type is defined which names
that type as its supertype.
</p><p>
The function is called with two arguments which are both struct types.
The
<tt><i>supertype</i></tt>
argument gives the type that is being inherited from.
The
<tt><i>subtype</i></tt>
gives the new type that is inheriting from
<tt><i>supertype</i></tt>.
</p><p>
When a new structure type is defined, its list of immediate
supertypes is considered. For each of those supertypes which defines the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0151798B">derived</=
a></tt>
function, the function is invoked.
</p><p>
The function is not retroactively invoked. If it is defined for
a structure type from which subtypes have already been derived,
it is not invoked for those existing subtypes.
</p><p>
If
<tt><i>derived</i></tt>
directly inherits
<tt><i>supertype</i></tt>
more than once, it is not specified whether this function is called
once, or multiple times.
</p><p>
Note: the
<tt><i>supertype</i></tt>
parameter exists because the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0151798B">derived</=
a></tt>
function is itself inherited. If the same version of this function is share=
d by
multiple structure types due to inheritance, this argument informs the func=
tion
which of those types it is being invoked for.
</p><p>

</p></dd></dl>
<a name=3D"N-0227EA90">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.10">9.21.10<=
/a> Methods <tt>iter-begin</tt> and <tt>iter-reset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(iter-begin)=20




<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(iter-reset </tt><tt><i>ite=
r</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If an object supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method, it is considered iterable; the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01156AE3">iterable<=
/a></tt>
function will return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if invoked on this object.
</p><p>
The responsibility of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method is to return an iterator object: an object which supports
certain special methods related to iteration, according to one of two
protocols, described below.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
method is optional. It is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
but takes an additional
<tt><i>iter</i></tt>
argument, an iterator object that was previously returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method of the same
<tt><i>object</i></tt>.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
determines that
<tt><i>iter</i></tt>
can be re-used for a new iteration, then it can suitably mutate the
state of
<tt><i>iter</i></tt>
and return it.  Otherwise, it behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
and returns a new iterator.
</p><p>
There are two protocols for iteration: the fast protocol, and the canonical
protocol.
Both protocols require the iterator object returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method to provide the methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>.
If the iterator also provides the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method, then the protocol which applies is the canonical protocol. If
that method is absent, then the fast protocol is followed.
</p><p>
Under the fast protocol, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method does not exist and is not involved. The iterable object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method must return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the abstract sequence is empty. If an iterator is returned, it is assume=
d
that an object can be retrieved from the iterator by invoking its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
method. The iterator's
<tt>iter-next</tt>
method should return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no more objects in the abstract sequence, or else it should
return an iterator that obeys the fast protocol (possibly itself).
</p><p>
Under the canonical protocol, the iterator implements the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function. The iterable object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
always returns an iterator object. The iterator object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method is always invoked to determine whether another item is available
from the sequence. The iterator object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
method is expected to return an iterator object which conforms to the
canonical protocol.
</p><p>

</p></dd></dl>
<a name=3D"N-000891B1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.11">9.21.11<=
/a> Method <tt>iter-item</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(iter-item)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
method is invoked on an iterator
<tt><i>object</i></tt>
to retrieve the next item in the sequence.
</p><p>
Under the fast protocol, it
is assumed that if
<tt><i>object</i></tt>
was returned by an iterable object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method, or by an iterator's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
method, that an item is available. This method will be unconditionally invo=
ked.
</p><p>
Under the canonical protocol for iteration, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method will be invoked on
<tt><i>object</i></tt>
first. If that method yields true, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
is expected to yield the next available item in the sequence.
</p><p>
Note: calls to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
function, with
<tt><i>object</i></tt>
as its argument, invoke the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
method. It is possible for an application to call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
through this function or directly as a method call
without first calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>.
No iteration mechanism in the <b>TXR Lisp</b> standard library behaves this=
 way.
If the iterator
<tt><i>object</i></tt>
has no more items available and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
is invoked anyway, no requirements apply to its behavior or return value.
</p><p>

</p></dd></dl>
<a name=3D"N-00387731">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.12">9.21.12<=
/a> Method <tt>iter-step</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(iter-step)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
method is invoked on an iterator object to produce an iterator object for t=
he
remainder of the sequence, excluding the current item.
</p><p>
Under the fast iteration protocol, this method returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no more items in the sequence.
</p><p>
Under the canonical iteration protocol, this method always returns
an iterator object. If no items remain in the sequence, then that
iterator object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Furthermore, under this protocol,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
is not called if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: calls to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
function, with
<tt><i>object</i></tt>
as its argument, invoke the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
method. It is possible for an application to call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
through this function or directly as a method call
without first calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>.
No iteration mechanism in the <b>TXR Lisp</b> standard library behaves this=
 way.
If the iterator
<tt><i>object</i></tt>
has no more items available and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
is invoked anyway, no requirements apply to its behavior or return value.
</p><p>

</p></dd></dl>
<a name=3D"N-00889268">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.21.13">9.21.13<=
/a> Method <tt>iter-more</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>object</i></tt><tt>.(iter-more)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If an iterator
<tt><i>object</i></tt>
returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method, then the canonical iteration protocol applies to that iteration
session. All subsequent iterators that are involved in the iteration
are assumed to conform to the protocol and should implement the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method also. The behavior is unspecified otherwise.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method is used to interrogate an iterator whether more unvisited items
remain in the sequence. This method does not advance the iteration,
and does not change the state of the iterator. It is idempotent: if it is
called multiple times without any intervening call to any other method,
it yields the same value.
</p><p>
If an iterator does not implement the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method, then if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function is applied to that iterator, it unconditionally returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
</p></dd></dl>
<a name=3D"N-027F768C">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22">9.22</a> Se=
quence Manipulation</h3>



<p>


</p><p>
Functions in this category uniformly manipulate abstract sequences. Lists,
strings and vectors are sequences.
</p><p>
Structure objects can behave
like sequences, either list-like or vector-like sequences, if they have
certain methods: see the previous section Special Structure Functions.
</p><p>
Moreover, hash tables behave like sequences of key-value entries represente=
d by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
pairs. Not all sequence-processing functions accept hash table sequences.
</p><p>
Additionally, some sequence-processing functions work not only with sequenc=
es
but with all iterable objects: objects that can be used as arguments to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
function. Such arguments are called
<tt><i>iterable</i></tt>
rather than
<tt><i>sequence</i></tt>,
possibly abbreviated to
<tt><i>iter</i></tt>
with or without a numeric suffix.
Hash tables are always supported if they appear as
<tt><i>iterable</i></tt>
arguments.
</p><p>

<a name=3D"N-03C6CAE0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.1">9.22.=
1</a> Function <tt>seqp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(seqp </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6CAE0">seqp</a><=
/tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is a sequence, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Lists, vectors and strings are sequences. The object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
denotes
the empty list and so is a sequence.
</p><p>
Objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
are sequences, as are hash tables.
</p><p>
Structures which implement the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
methods are considered sequences.
</p><p>
No other objects are sequences. However, future revisions of
the language may specify additional objects that are sequences.
</p><p>

</p></dd></dl>
<a name=3D"N-01156AE3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.2">9.22.2</a=
> Function <tt>iterable</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iterable </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01156AE3">iterable<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is iterable, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>object</i></tt>
is a sequence according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6CAE0">seqp</a><=
/tt>
function, then it is iterable.
</p><p>
If
<tt><i>object</i></tt>
is a structure which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method, then it is iterable.
</p><p>
Additional objects that are not sequences are also iterable:
numeric or character ranges, and numbers. Future revisions
of the language may specify additional iterable objects.
</p><p>

</p></dd></dl>
<a name=3D"N-01C1D23C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.3">9.22.3</a=
> Function <tt>make-like</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-like </tt><tt><i>list</i></tt><tt> </tt><tt><i>object=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>list</i></tt>
argument must be a list.  If
<tt><i>object</i></tt>
is a sequence type,
then
<tt><i>list</i></tt>
is converted to the same type of sequence and returned.
Otherwise the original
<tt><i>list</i></tt>
is returned.
</p><p>
Conversion is supported to string and vector type.
</p><p>
Conversion to a structure type is possible for structures. If
<tt><i>object</i></tt>
is an object of a structure type which has a static function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FFD230">from-list=
</a></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C1D23C">make-like=
</a></tt>
calls that function, passing to it, and the resulting value is returned.
<tt><i>list</i></tt>
and returns whatever value that function returns.
</p><p>
If
<tt><i>object</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>,
then
<tt><i>list</i></tt>
is passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E825E0">carray-li=
st</a></tt>
function, and the resulting value is returned. The second argument in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E825E0">carray-li=
st</a></tt>
call is the element type taken from
<tt><i>object</i></tt>.
The third argument is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
indicating that the resulting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is not to be null terminated.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C1D23C">make-like=
</a></tt>
function is a helper which supports the development of
unoptimized versions of a generic function that accepts any type of
sequence as input, and produces a sequence of the same type as output.
The implementation of such a function can internally accumulate a list, and
then convert the resulting list to the same type as an input value
by using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C1D23C">make-like=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02F0880D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.4">9.22.4</a=
> Functions <tt>list-seq</tt>, <tt>vec-seq</tt> and <tt>str-seq</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(list-seq </tt><tt><i>iterable</i></tt><tt>)=20




<br>&nbsp;&nbsp;(vec-seq </tt><tt><i>iterable</i></tt><tt>)=20




<br>&nbsp;&nbsp;(str-seq </tt><tt><i>iterable</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">list-seq<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">vec-seq</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">str-seq</=
a></tt>
functions convert an iterable object of any type into a list, vector
or string, respectively.
</p><p>
The list returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">list-seq<=
/a></tt>
is lazy.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">list-seq<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">vec-seq</=
a></tt>
iterate the items of
<tt><i>iterable</i></tt>
and accumulate these items into a new list or vector.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0880D">str-seq</=
a></tt>
similarly iterates the items of
<tt><i>iterable</i></tt>,
requiring them to be a mixture of characters and strings.
</p><p>

</p></dd></dl>
<a name=3D"N-03AD172A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.5">9.22.5</a=
> Functions <tt>length</tt> and <tt>len</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length </tt><tt><i>iterable</i></tt><tt>)=20




<br>&nbsp;&nbsp;(len </tt><tt><i>iterable</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function returns the number of items contained in
<tt><i>iterable</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AD172A">len</a></=
tt>
function is a synonym of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>.
</p><p>
An attempt to calculate the length of infinite lazy lists will not terminat=
e.
Iterable objects representing infinite ranges, such as integers and charact=
ers
are invalid arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-004918EB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.6">9.22.6</a=
> Function <tt>empty</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(empty </tt><tt><i>iterable</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>iterable</i></tt>
is a suitable argument for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</a>=
</tt>
Returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a> </tt>=
<tt><i>iterable</i></tt><tt>)=20

</tt>

is zero, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</a>=
</tt>
function also supports certain objects not suitable as arguments for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>.
</p><p>
An infinite lazy list is not empty, and so
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004918EB">empty</a>=
</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for such an object.
</p><p>
The function also returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for iterable objects representing non-empty spaces, even if
those spaces are infinite. For instance
<tt>(empty 0)</tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
because the set of integers beginning with 0 isn't empty.
</p><p>

</p></dd></dl>
<a name=3D"N-03E5C1DE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.7">9.22.7</a=
> Function <tt>nullify</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(nullify </tt><tt><i>iterable</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if
<tt><i>iterable</i></tt>
denotes an empty sequence.
Otherwise, if
<tt><i>iterable</i></tt>
is not an empty sequence, or isn't a sequence, then
<tt><i>iterable</i></tt>
itself is returned.
</p><p>
If
<tt><i>iterable</i></tt>
is a structure object which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
method, then that method is called. If it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
method returns a substitute object other than the
<tt><i>iterable</i></tt>
object itself, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
is invoked on that returned substitute object.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
function is a helper to support unoptimized generic
traversal of sequences.  Thanks to the generalized behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
non-list sequences can be traversed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>,
similarly to proper lists, by checking for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
returning the terminating value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
However, empty non-list sequences are handled incorrectly because
since they are not the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
object, they look non-empty under this paradigm of traversal.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
function provides a correction: if the input sequence is filtered
through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>
then the subsequent list-like iteration works correctly.
</p><p>
Examples:
</p><p>
<tt>
</tt></p><pre><tt>  ;; Incorrect for empty strings:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
print-chars (string)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while</a=
> string
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop</a> =
string))))

  ;; Corrected with nullify:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
print-chars (string)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((s (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a> =
string)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while<=
/a> s
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prin=
l</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop</a=
> s)))))
</tt></pre><tt>

</tt>

<p>
Note: optimized generic iteration is available in the form of iteration
based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>/=
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0012">nullify</a></=
tt>.
</p><p>
Examples:
</p><p>
<tt>
</tt></p><pre><tt>  ;; Efficient with iterators,
  ;; at the cost of verbosity:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
print-chars (string)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((i (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</=
a> string)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">while<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a=
> i)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prin=
l</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item<=
/a> s))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> =
s (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a> =
s)))))

  ;; Using mapping function built on iterators:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
print-chars (string)
    [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a=
> prinl string])
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01D9F42F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.8">9.22.8</a=
> Accessor <tt>sub</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sub </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>from</i=
></tt><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(set (sub </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>fr=
om</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]]) </tt><tt><i>new-val</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
function extracts a slice from input sequence
<tt><i>sequence</i></tt>.
The slice is
a sequence of the same type as
<tt><i>sequence</i></tt>.
</p><p>
If the
<tt><i>from</i></tt>
argument is omitted, it defaults to
<tt>0</tt>.
If the
<tt><i>to</i></tt>
parameter is
omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Thus
<tt>(sub a)</tt>
means
<tt>(sub a 0 t)</tt>.
</p><p>
The following semantic equivalence exists between a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
function and
the DWIM-bracket syntax, except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
is an ordinary function call form, which doesn't apply the
Lisp-1 evaluation semantics to its arguments:
</p><p>
<tt>
</tt></p><pre><tt>  ;; from is not a list
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a> se=
q from to) &lt;--&gt; [seq from..to]
</tt></pre><tt>

</tt>

<p>
The description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator=E2=80=94in particular, the section
on Range Indexing=E2=80=94explains the semantics of the range specification=
.
</p><p>
The output sequence may share structure with the input sequence.
</p><p>
If
<tt><i>sequence</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object, then the function behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF5BC5">carray-su=
b</a></tt>.
</p><p>
If
<tt><i>sequence</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object, then the function behaves like
<tt>buf-sub</tt>.
</p><p>
If
<tt><i>sequence</i></tt>
is a structure, it must support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
operation is transformed into a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method according to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
D9F42F">sub</a> o from to) &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#D-004F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-02E9003D">rcons</a> from to))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a> o =
: to)    &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
004F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E90=
03D">rcons</a> : to))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a> o =
from)    &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
004F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E90=
03D">rcons</a> from :))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a> o)=
         &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
004F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E90=
03D">rcons</a> : :))
</tt></pre><tt>

</tt>

<p>
That is to say, the
<tt><i>from</i></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
arguments are converted to range object. If either argument
is missing, the symbol
<tt>:</tt>
is used for the corresponding element of the range.
</p><p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
form is used as a syntactic place, that place denotes a slice of
<tt><i>seq</i></tt>.
The
<tt><i>seq</i></tt>
argument must be itself be syntactic place, because
receives a new value, which may be different from its original value in
cases when
<tt><i>seq</i></tt>
is a list.
</p><p>
Overwriting that slice is equivalent to using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function. The following equivalences give the semantics, except that
<tt>x</tt>,
<tt>a</tt>,
<tt>b</tt>
and
<tt>v</tt>
are evaluated only once, in left-to-right order:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">=
sub</a> x a b) v)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-03F7A8B8">progn</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-002F">set</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-035991E1">replace</a> x v a b))
                                    v)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a> x a b))   =
 &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8"=
>prog1</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">s=
ub</a> x a b)
                                    (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#D-002F">set</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-035991E1">replace</a> x nil a b)))
</tt></pre><tt>

</tt>

<p>
Note that the value of
<tt>x</tt>
is overwritten with the value returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>.
If
<tt>x</tt>
is a vector or string, then the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
is just
<tt>x</tt>:
the identity of the object doesn't change under mutation.
However, if
<tt>x</tt>
is a list, its identity changes when items are added to or removed from
the front of the list, and in those cases
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
will return a value different from its first argument.
Similarly, if
<tt>x</tt>
is an object with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method, that method's return value becomes the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
and must be taken into account.
</p><p>

</p></dd></dl>
<a name=3D"N-035991E1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.9">9.22.9</a=
> Function <tt>replace</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(replace </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>repl=
acement-sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>t=
o</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(replace </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>repl=
acement-sequence</i></tt><tt> </tt><tt><i>index-list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>replace</i></tt>
function modifies
<tt><i>sequence</i></tt>
in the ways described below.
</p><p>
The operation is destructive: it may work "in place" by modifying
the original sequence. The caller should retain the return value
and stop relying on the original input sequence.
</p><p>
The return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
is the modified
version of
<tt><i>sequence</i></tt>.
This may be the same object as
<tt><i>sequence</i></tt>
or it may be a newly allocated object.
</p><p>
Note that the form:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> seq (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991=
E1">replace</a> seq new fr to))
</tt></pre><tt>

</tt>

<p>
has the same effect on the variable
<tt>seq</tt>
as the form:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> [seq fr..to] new)
</tt></pre><tt>

</tt>

<p>
except that the former
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
form returns the entire modified sequence, whereas the latter
returns the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
argument.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function has two invocation styles, distinguished by the
type of the third argument. If the third argument is a sequence, then it
is deemed to be the
<tt><i>index-list</i></tt>
parameter of the second form.
Otherwise, if the third argument is missing, or is not a list, then
it is deemed to be the
<tt><i>from</i></tt>
argument of the first form.
</p><p>
The first form of the replace function replaces a contiguous subsequence of=
 the
<tt><i>sequence</i></tt>
with
<tt><i>replacement-sequence</i></tt>.
The replaced subsequence may be empty,
in which case an insertion is performed. If
<tt><i>replacement-sequence</i></tt>
is empty
(for example, the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>),
then a deletion is performed.
</p><p>
If the
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
arguments are omitted, their values default
to
<tt>0</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
respectively.
</p><p>
The description of the dwim operator=E2=80=94in particular, the section
on Range Indexing=E2=80=94explains the semantics of the range specification=
.
</p><p>
The second form of the replace function replaces a subsequence of
elements from
<tt><i>sequence</i></tt>
given by
<tt><i>index-list</i></tt>,
with their counterparts
from
<tt><i>replacement-sequence</i></tt>.
This form of the replace function does not insert
or delete; it simply overwrites elements. If
<tt><i>replacement-sequence</i></tt>
and
<tt><i>index-list</i></tt>
are of different lengths, then the shorter of the two determines
the maximum number of elements which are overwritten.
Whenever a negative value occurs in
<tt><i>index-list</i></tt>
the length of
<tt><i>sequence</i></tt>
is added to that value.
Furthermore, similar restrictions apply on
<tt><i>index-list</i></tt>
as under the
select function. Namely, the replacement stops when an index value
in
<tt><i>index-list</i></tt>
is encountered which is out of range for
<tt><i>sequence</i></tt>.
furthermore, if
<tt><i>sequence</i></tt>
is a list, then
<tt><i>index-list</i></tt>
must
be monotonically increasing, after consideration of the
displacement of negative values.
</p><p>
If
<tt><i>replacement-sequence</i></tt>
shares storage with the target range of
<tt><i>sequence</i></tt>,
or, in the case when that range is resized by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
operation, shares storage with any portion of
<tt><i>sequence</i></tt>
above that range, then the effect of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
on either object is unspecified.
</p><p>
If
<tt><i>sequence</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AAF602">carray-re=
place</a></tt>.
</p><p>
If
<tt><i>sequence</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
behaves like
<tt>buf-replace</tt>.
</p><p>
If
<tt><i>sequence</i></tt>
is a structure, then the structure must support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
operation is translated into a call of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method according to the following equivalences:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
5991E1">replace</a> o items from to)
  &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA9=
7">lambda-set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9=
003D">rcons</a> from to) items)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</a=
> o items index-list)
  &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA9=
7">lambda-set</a> index-list items)
</tt></pre><tt>

</tt>

<p>
Thus, the
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
arguments are converted to single range object,
whereas an
<tt><i>index-list</i></tt>
is passed as-is.
It is an error if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
argument is a sequence, indicating an
<tt><i>index-list</i></tt>,
and a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
argument is also given; the situation is diagnosed. If either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
are omitted, the range object contains the
<tt>:</tt>
symbol in the corresponding place:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
5991E1">replace</a> o items from)
  &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA9=
7">lambda-set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9=
003D">rcons</a> from :) items)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</a=
> o items : to)
  &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA9=
7">lambda-set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9=
003D">rcons</a> : to) items)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</a=
> o items)
  &lt;--&gt; o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA9=
7">lambda-set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9=
003D">rcons</a> : :) items)
</tt></pre><tt>

</tt>

<p>
It is the responsibility of the object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method to implement semantics consistent with the
description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00F6D433">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.10">9.22.10<=
/a> Function <tt>take</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(take </tt><tt><i>count</i></tt><tt> </tt><tt><i>sequence</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6D433">take</a><=
/tt>
function returns
<tt><i>sequence</i></tt>
with all except the first
<tt><i>count</i></tt>
items removed.
</p><p>
If
<tt><i>sequence</i></tt>
is a list, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6D433">take</a><=
/tt>
returns a lazy list which produces the first
<tt><i>count</i></tt>
items of sequence.
</p><p>
For other kinds of sequences, including lazy strings,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6D433">take</a><=
/tt>
works eagerly.
</p><p>
If
<tt><i>count</i></tt>
exceeds the length of
<tt><i>sequence</i></tt>
then a sequence is returned which has all the items.
This object may be
<tt><i>sequence</i></tt>
itself, or a copy.
</p><p>
If
<tt><i>count</i></tt>
is negative, it is treated as zero.
</p><p>

</p></dd></dl>
<a name=3D"N-01E42C4C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.11">9.22.11<=
/a> Functions <tt>take-while</tt> and <tt>take-until</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(take-while </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>se=
quence</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20




<br>&nbsp;&nbsp;(take-until </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>se=
quence</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E42C4C">take-whil=
e</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E42C4C">take-unti=
l</a></tt>
functions return a prefix of
<tt><i>sequence</i></tt>
whose items satisfy certain conditions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E42C4C">take-whil=
e</a></tt>
function returns the longest prefix of
<tt><i>sequence</i></tt>
whose elements, accessed through
<tt><i>keyfun</i></tt>
satisfy the function
<tt><i>predfun</i></tt>.
</p><p>
The
<tt><i>keyfun</i></tt>
argument defaults to the identity function: the elements
of
<tt><i>sequence</i></tt>
are examined themselves.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E42C4C">take-unti=
l</a></tt>
function returns the longest prefix of
<tt><i>sequence</i></tt>
which consists of elements, accessed through
<tt><i>keyfun</i></tt>,
that do
<b>not</b>

satisfy
<tt><i>predfun</i></tt>
followed by an element which does satisfy
<tt><i>predfun</i></tt>.
If
<tt><i>sequence</i></tt>
has no such prefix, then an empty sequence
is returned of the same kind as
<tt><i>sequence</i></tt>.
</p><p>
If
<tt><i>sequence</i></tt>
is a list, then these functions return a lazy list.
</p><p>

</p></dd></dl>
<a name=3D"N-01C6C906">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.12">9.22.12<=
/a> Function <tt>drop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(drop </tt><tt><i>count</i></tt><tt> </tt><tt><i>sequence</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C6C906">drop</a><=
/tt>
function returns
<tt><i>sequence</i></tt>
with the first
<tt><i>count</i></tt>
items removed.
</p><p>
If
<tt><i>count</i></tt>
is negative, it is treated as zero.
</p><p>
If
<tt><i>count</i></tt>
is zero, then
<tt><i>sequence</i></tt>
is returned.
</p><p>
If
<tt><i>count</i></tt>
exceeds the length of
<tt><i>sequence</i></tt>
then an empty sequence is returned
of the same kind as
<tt><i>sequence</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-011E5936">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.13">9.22.13<=
/a> Functions <tt>drop-while</tt> and <tt>drop-until</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(drop-while </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>se=
quence</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20




<br>&nbsp;&nbsp;(drop-until </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>se=
quence</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011E5936">drop-whil=
e</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011E5936">drop-unti=
l</a></tt>
functions return
<tt><i>sequence</i></tt>
with a prefix of that sequence removed,
according to conditions involving
<tt><i>predfun</i></tt>
and
<tt><i>keyfun</i></tt>.
</p><p>
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011E5936">drop-whil=
e</a></tt>
function removes the longest prefix of
<tt><i>sequence</i></tt>
whose elements, accessed through
<tt><i>keyfun</i></tt>
satisfy the function
<tt><i>predfun</i></tt>,
and returns the remaining sequence.
</p><p>
The
<tt><i>keyfun</i></tt>
argument defaults to the identity function: the elements
of
<tt><i>sequence</i></tt>
are examined themselves.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011E5936">drop-unti=
l</a></tt>
function removes the longest prefix of
<tt><i>sequence</i></tt>
which consists of elements, accessed through
<tt><i>keyfun</i></tt>,
that do
<b>not</b>

satisfy
<tt><i>predfun</i></tt>
followed by an element which does satisfy
<tt><i>predfun</i></tt>.
A sequence of the remaining elements is
returned.
</p><p>
If
<tt><i>sequence</i></tt>
has no such prefix, then a sequence
same as
<tt><i>sequence</i></tt>
is returned, which may be
<tt><i>sequence</i></tt>
itself or a copy.
</p><p>

</p></dd></dl>
<a name=3D"N-0326F3F2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.14">9.22.14<=
/a> Accessor <tt>last</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(last </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>num</i=
></tt><tt>])=20




<br>&nbsp;&nbsp;(set (last </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>n=
um</i></tt><tt>]) </tt><tt><i>new-value)</i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>last</i></tt>
function returns a subsequence of
<tt><i>sequence</i></tt>
consisting of the last
<tt><i>num</i></tt>
of its elements, where
<tt><i>num</i></tt>
defaults to 1.
</p><p>
If
<tt><i>num</i></tt>
is zero or negative, then an empty sequence is returned.
If
<tt><i>num</i></tt>
is positive, and greater than or equal to the length of sequence,
then sequence
<tt><i>sequence</i></tt>
is returned.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></tt>
form is used as a place, then
<tt>sequence</tt>
must be a place. The following equivalence gives the semantics
of assignment to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></tt>=
:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last=
</a> x n) v)   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-002F">set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D=
9F42F">sub</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009"=
>-</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">max</=
a> n 0)) t) v)
</tt></pre><tt>

</tt>

<p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></tt>
place is deletable. The semantics of deletion may be understood
in terms of the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
41">del</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last=
</a> x n))   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-0041">del</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F=
42F">sub</a> x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">max</a>=
 n 0)) t))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-026BB6FA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.15">9.22.15<=
/a> Accessor <tt>butlast</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(butlast </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>num=
</i></tt><tt>])=20




<br>&nbsp;&nbsp;(set (butlast </tt><tt><i>sequence</i></tt><tt> [</tt><tt><=
i>num</i></tt><tt>]) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">butlast</=
a></tt>
function returns the prefix of
<tt><i>sequence</i></tt>
consisting of a copy of it, with the last
<tt><i>num</i></tt>
items removed.
</p><p>
The parameter
<tt><i>num</i></tt>
defaults to 1
if an argument is omitted.
</p><p>
If
<tt><i>sequence</i></tt>
is empty, an empty sequence is returned.
</p><p>
If
<tt><i>num</i></tt>
is zero or negative, then
<tt><i>sequence</i></tt>
is returned.
</p><p>
If
<tt><i>num</i></tt>
is positive, and meets or exceeds the length of
<tt><i>sequence</i></tt>,
then an empty sequence is returned.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">butlast</=
a></tt>
form is used as a place, then
<tt><i>sequence</i></tt>
must itself be a place. The following equivalence gives the semantics
of assignment to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a></tt>=
:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2F">set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">=
butlast</a> x n) v)   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#D-002F">set</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-01D9F42F">sub</a> x 0 (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0009">-</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C36=
43">max</a> n 0))) v)
</tt></pre><tt>

</tt>

<p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">butlast</=
a></tt>
place is deletable. The semantics of deletion may be understood
in terms of the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
41">del</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last=
</a> x n))   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-0041">del</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F=
42F">sub</a> x 0 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009"=
>-</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">max</=
a> n 0))))
</tt></pre><tt>

</tt>

<p>
Note: the <b>TXR Lisp</b><tt><a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-00F6D433">take</a></tt>
function also computes the prefix of a list; however, it counts items
from the beginning, and provides lazy semantics which allow it
to work with infinite lists.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E2C334">butlastn<=
/a></tt>
accessor, which operates on lists. That function has useful semantics for
improper lists and treats an atom as the terminator of a zero-length improp=
er
list.
</p><p>
Dialect Note: a destructive function similar to Common Lisp's
<tt>nbutlast</tt>
isn't provided. Assignment to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">butlast</=
a></tt>
form is destructive; Common Lisp doesn't support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026BB6FA">butlast</=
a></tt>
as a place.
</p><p>

</p></dd></dl>
<a name=3D"N-02193773">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.16">9.22.16<=
/a> Function <tt>ldiff</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ldiff </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>tail-s=
equence</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
function is a somewhat generalized version of the same-named classic Lisp
function found in traditional Lisp dialects.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
function supports the original
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
semantics when both inputs are lists. It determines whether the
<tt><i>tail-sequence</i></tt>
list is a structural suffix of
<tt><i>sequence</i></tt>;
which is to say: is
<tt><i>tail-sequence</i></tt>
one of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells which comprise
<tt><i>sequence</i></tt>?
If so, then a list is returned consisting of all the items of
<tt><i>sequence</i></tt>
before
<tt><i>tail-sequence</i></tt>:
a copy of
<tt><i>sequence</i></tt>
with the
<tt><i>tail-sequence</i></tt>
part removed, and replaced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
terminator. If
<tt><i>tail-sequence</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or the lists are unrelated, then
<tt><i>sequence</i></tt>
is returned.
</p><p>
The <b>TXR Lisp</b><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
02193773">ldiff</a></tt>
function supports the following additional semantics.
</p><p>
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
The basic description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
is extended to work with list-like sequences, not
merely lists; that is to say, objects which support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
method.
</dd><dt>2.</dt><dd>
If
<tt><i>sequence</i></tt>
is any kind of sequence, and
<tt><i>tail-sequence</i></tt>
is any kind of empty sequence, then
<tt><i>sequence</i></tt>
is returned.
</dd><dt>3.</dt><dd>
If either argument is an atom that is not a sequence,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
returns
<tt><i>sequence</i></tt>.
</dd><dt>4.</dt><dd>
If
<tt><i>sequence</i></tt>
is a list-like sequence, and
<tt><i>tail-sequence</i></tt>
isn't, then the terminating atom of
<tt><i>sequence</i></tt>
is determined. This atom is compared using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to the
<tt><i>tail-sequence</i></tt>
object. If they are equal, then a proper list is
returned containing the items of
<tt><i>sequence</i></tt>
excluding the terminating atom.
</dd><dt>5.</dt><dd>
If both arguments are vector-like sequences, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
determines whether
<tt><i>sequence</i></tt>
has a suffix which is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>tail-sequence</i></tt>.
If this is the case, then a sequence is returned, of the same kind as
<tt><i>sequence</i></tt>,
consisting of the items of
<tt><i>sequence</i></tt>
before that suffix.
If
<tt><i>tail-sequence</i></tt>
is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to a suffix of
<tt><i>sequence</i></tt>,
then
<tt><i>sequence</i></tt>
is returned.
</dd><dt>6.</dt><dd>
In all other cases,
<tt><i>sequence</i></tt>
and
<tt><i>tail-sequence</i></tt>
are compared with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
If the comparison is true,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned, otherwise
<tt><i>sequence</i></tt>
is returned.
</dd></dl>
</dl>
<p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;;; unspecified: the compiler could make
  ;;; '(2 3) a suffix of '(1 2 3),
  ;;; or they could be separate objects.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
'(1 2 3) '(2 3)) -&gt; either (1) or (1 2 3)

  ;; b is the (1 2) suffix of a, so the ldiff is (1)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a> (=
(a '(1 2 3)) (b (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">=
cdr</a> a)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a=
> a b))
  -&gt; (1)

  ;; Rule 5: strings and vector
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
"abc" "bc") -&gt; "a"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
"abc" nil) -&gt; "abc"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
#(1 2 3) #(3)) -&gt; #(1 2)

  ;; Rule 5: mixed vector kinds
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
"abc" #(#\b #\c)) -&gt; "abc"

  ;; Rule 6:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
#(1 2 3) '(3)) -&gt; #(1 2 3)

  ;; Rule 4:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
'(1 2 3) #(3)) -&gt; '(1 2 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
'(1 2 3 . #(3)) #(3)) -&gt; '(1 2 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
'(1 2 3 . 4) #(3)) -&gt; '(1 2 3 . 4)

  ;; Rule 6
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
1 2) -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a> =
1 1) -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-015D8676">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.17">9.22.17<=
/a> Function <tt>search</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(search </tt><tt><i>haystack</i></tt><tt> </tt><tt><i>needl=
e</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></t=
t><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a=
></tt>
function determines whether the sequence
<tt><i>needle</i></tt>
occurs as substring
within
<tt><i>haystack</i></tt>,
under the given comparison function
<tt><i>testfun</i></tt>
and
key function
<tt><i>keyfun</i></tt>.
If this is the case, then the zero-based position of
the leftmost occurrence of
<tt><i>key</i></tt>
within
<tt><i>haystack</i></tt>
is returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned to indicate that
<tt><i>key</i></tt>
does not occur within
<tt><i>haystack</i></tt>.
If
<tt><i>key</i></tt>
is empty, then zero is always returned.
</p><p>
The arguments
<tt><i>haystack</i></tt>
and
<tt><i>needle</i></tt>
are sequences. They may not be hash tables.
</p><p>
If
<tt><i>needle</i></tt>
is not empty, then it occurs at some position N within
<tt><i>haystack</i></tt>
if
the first element of
<tt><i>needle</i></tt>
matches the element at position N of
<tt><i>haystack</i></tt>,
the second element of
<tt><i>needle</i></tt>
matches the element at position N+1 of
<tt><i>haystack</i></tt>
and so forth, for all elements of
<tt><i>needle</i></tt>.
A match between elements
is determined by passing each element through
<tt><i>keyfun</i></tt>,
and then comparing the resulting values using
<tt><i>testfun</i></tt>.
</p><p>
If
<tt><i>testfun</i></tt>
is supplied, it must be a function which can be
called with two arguments. If it is not supplied, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>.
</p><p>
If
<tt><i>keyfun</i></tt>
is supplied, it must be a function which can be called
with one argument. If it is not supplied, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; fails because 3.0 doesn't match 3
  ;; under the default eql function
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a>=
 #(1.0 3.0 4.0 7.0) '(3 4)] -&gt; nil

  ;; occurrence found at position 1:
  ;; (3.0 4.0) matches (3 4) under =3D
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a>=
 #(1.0 3.0 4.0 7.0) '(3 4) =3D] -&gt; 1

  ;; "even odd odd odd even" pattern
  ;; matches at position 2
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a>=
 #(1 1 2 3 5 7 8) '(2 1 1 1 2) : evenp] -&gt; 2

  ;; Case insensitive string search
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a>=
 "abcd" "CD" : chr-toupper] -&gt; 2

  ;; Case insensitive string search
  ;; using vector of characters as key
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a>=
 "abcd" #(#\C #\D) : chr-toupper] -&gt; 2
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-010AB2D7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.18">9.22.18<=
/a> Function <tt>contains</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(contains </tt><tt><i>needle</i></tt><tt> </tt><tt><i>hayst=
ack</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i><=
/tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The syntax of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010AB2D7">contains<=
/a></tt>
function differs from that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a=
></tt>:
that the
<tt><i>needle</i></tt>
and
<tt><i>haystack</i></tt>
arguments are reversed. The semantics is identical.
</p><p>

</p></dd></dl>
<a name=3D"N-03405F7D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.19">9.22.19<=
/a> Function <tt>rsearch</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rsearch </tt><tt><i>haystack</i></tt><tt> </tt><tt><i>need=
le</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></=
tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03405F7D">rsearch</=
a></tt>
function is like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015D8676">search</a=
></tt>
except for two differences.
</p><p>
Firstly, if
<tt><i>needle</i></tt>
matches
<tt><i>haystack</i></tt>
in multiple places,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03405F7D">rsearch</=
a></tt>
returns the right-most matching position rather than
the leftmost.
</p><p>
Secondly, if
<tt><i>needle</i></tt>
is an empty sequence, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03405F7D">rsearch</=
a></tt>
returns the length of
<tt>haystack</tt>,
thereby effectively declaring that the rightmost match for an empty
<tt><i>needle</i></tt>
key occurs at the imaginary position past the element of
<tt><i>haystack</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01A419FB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.20">9.22.20<=
/a> Functions <tt>ref</tt> and <tt>refset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ref </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>index</i=
></tt><tt>)=20




<br>&nbsp;&nbsp;(refset </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>index=
</i></tt><tt> </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
functions perform array-like indexing into sequences, as well as
objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
</p><p>
If the
<tt><i>sequence</i></tt>
parameter is a hash, then these functions perform
has retrieval and storage; in that case
<tt><i>index</i></tt>
isn't restricted to an integer value.
</p><p>
If
<tt><i>sequence</i></tt>
is a structure, it supports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
directly if it has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method. The
<tt><i>index</i></tt>
argument is passed to that method, and the resulting value is
returned.
If a structure lacks a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
method, but has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
method, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
treats it as a list, traversing the structure using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>/=
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
operations. In the absence of support for these operations,
the function fails with an error exception.
</p><p>
Similarly, a structure supports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
directly if it has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method. This gets called with
<tt><i>index</i></tt>
and
<tt><i>new-value</i></tt>
as arguments. Then
<tt><i>new-value</i></tt>
is returned.
If a structure lacks a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FEBA97">lambda-se=
t</a></tt>
method, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
treats it as a list, traversing the structure using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>/=
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
operations, and storing
<tt><i>new-value</i></tt>
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>.
In the absence of support for these operations,
the function fails with an error exception.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
function retrieves an element of
<tt><i>sequence</i></tt>,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
overwrites an
element of
<tt><i>sequence</i></tt>
with a new value.
</p><p>
If
<tt><i>sequence</i></tt>
is a sequence then
<tt><i>index</i></tt>
argument must be an integer. The first element of the sequence
is indexed by zero. Negative values are permitted,
denoting backward indexing from the end of the sequence, such that
the last element is indexed by -1, the second last by -2 and so on.
See also the Range Indexing section under the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
If
<tt><i>sequence</i></tt>
is a list, then out-of-range indices, whether positive or negative,
are treated leniently by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>:
such accesses produce the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
rather than an error. For other sequence types, such accesses
are erroneous. For hashes, accesses to nonexistent elements
are treated leniently, and produce
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
function is strict for out-of-range indices over all sequences,
including lists. In the case of hashes, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
of a nonexistent key creates the key.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
function returns
<tt>new-value</tt>.
</p><p>
The following equivalences hold between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>,
and the DWIM bracket syntax, provided that
<tt><i>idx</i></tt>
is a scalar index and
<tt><i>sequence</i></tt>
is a sequence object, rather than a hash.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
A419FB">ref</a> seq idx) &lt;--&gt; [seq idx]

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a>=
 seq idx new) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-002F">set</a> [seq idx] new)
</tt></pre><tt>

</tt>

<p>
The difference is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>
are first class functions which
can be used in functional programming as higher order functions, whereas th=
e
bracket notation is syntactic sugar, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
is an operator, not a function.
Therefore the brackets cannot replace all uses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">ref</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A419FB">refset</a=
></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0327B17E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.21">9.22.21<=
/a> Function <tt>update</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(update </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>funct=
ion</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0327B17E">update</a=
></tt>
function replaces each elements in
<tt><i>sequence</i></tt>
in a hash table, with the result of
<tt><i>function</i></tt>
being applied to that element value.
</p><p>
The
<tt><i>sequence</i></tt>
is returned.
</p><p>
The
<tt><i>sequence</i></tt>
may be a hash table. In that case,
<tt><i>function</i></tt>
is invoked with each hash value, which is replaced with the function's retu=
rn
value.
</p><p>

</p></dd></dl>
<a name=3D"N-000ECD82">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.22">9.22.22<=
/a> Functions <tt>remq</tt>, <tt>remql</tt> and <tt>remqual</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(remq </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence<=
/i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(remql </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence=
</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(remqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequen=
ce</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remq</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remql</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remqual</=
a></tt>
functions produce a new sequence based on
<tt><i>sequence</i></tt>,
removing the elements whose associated keys are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>object</i></tt>.
</p><p>
The input
<tt><i>sequence</i></tt>
is unmodified, but the returned sequence may share substructure
with it. If no items are removed, it is possible that the return value
is
<tt><i>sequence</i></tt>
itself.
</p><p>
If
<tt><i>key-function</i></tt>
is omitted, then the element keys compared to
<tt><i>object</i></tt>
are the elements themselves.
Otherwise,
<tt><i>key-function</i></tt>
is applied to each element and the resulting value
is that element's key which is compared to
<tt><i>object</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00B85CD2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.23">9.22.23<=
/a> Functions <tt>remq*</tt>, <tt>remql*</tt> and <tt>remqual*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(remq* </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(remql* </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt>)=20




<br>&nbsp;&nbsp;(remqual* </tt><tt><i>object</i></tt><tt> </tt><tt><i>seque=
nce</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B85CD2">remq*</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B85CD2">remql*</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B85CD2">remqual*<=
/a></tt>
functions are lazy analogs of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remq</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remql</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remqual</=
a></tt>.
Rather than computing the entire new sequence
prior to returning, these functions return a lazy list.
</p><p>
Caution: these functions can still get into infinite looping behavior.
For instance, in
<tt>(remql* 0 (repeat '(0)))</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000ECD82">remql</a>=
</tt>
will keep consuming
the
<tt>0</tt>
values coming out of the infinite list, looking for the first item that
does not have to be deleted, in order to instantiate the first lazy value.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; Return a list of all the natural numbers, excluding =
13,
  ;; then take the first 100 of these.
  ;; If remql is used, it will loop until memory is exhausted,
  ;; because (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1"=
>range</a> 1) is an infinite list.

  [(remql* 13 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1=
">range</a> 1)) 0..100]
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00583609">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.24">9.22.24<=
/a> Functions <tt>keepq</tt>, <tt>keepql</tt> and <tt>keepqual</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(keepq </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence=
</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(keepql </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(keepqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>seque=
nce</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00583609">keepq</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00583609">keepql</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00583609">keepqual<=
/a></tt>
functions produce a new sequence based on
<tt><i>sequence</i></tt>,
removing the items whose keys are not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>object</i></tt>.
</p><p>
The input
<tt><i>sequence</i></tt>
is unmodified, but the returned sequence may share substructure
with it. If no items are removed, it is possible that the return value
is
<tt><i>sequence</i></tt>
itself.
</p><p>
The optional
<tt><i>key-function</i></tt>
is applied to each element from the
<tt><i>sequence</i></tt>
to convert it to a key which is compared to
<tt><i>object</i></tt>.
If
<tt><i>key-function</i></tt>
is omitted, then each element itself of
<tt><i>sequence</i></tt>
is compared to
<tt><i>object</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01413802">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.25">9.22.25<=
/a> Functions <tt>remove-if</tt>, <tt>keep-if</tt>, <tt>remove-if*</tt> and=
 <tt>keep-if*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(remove-if </tt><tt><i>predicate-function</i></tt><tt> </tt=
><tt><i>sequence</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(keep-if </tt><tt><i>predicate-function</i></tt><tt> </tt><=
tt><i>sequence</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(remove-if* </tt><tt><i>predicate-function</i></tt><tt> </t=
t><tt><i>sequence</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20




<br>&nbsp;&nbsp;(keep-if* </tt><tt><i>predicate-function</i></tt><tt> </tt>=
<tt><i>sequence</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if=
</a></tt>
function produces a sequence whose contents are those of
<tt><i>sequence</i></tt>
but with those elements removed which satisfy
<tt><i>predicate-function</i></tt>.
Those elements which are not removed appear in the same order.
The result sequence may share substructure with the input sequence,
and may even be the same sequence object if no items are removed.
</p><p>
The optional
<tt><i>key-function</i></tt>
specifies how each element from the
<tt><i>sequence</i></tt>
is transformed to an argument to
<tt><i>predicate-function</i></tt>.
If this argument is omitted
then the predicate function is applied to the elements directly, a behavior
which is identical to
<tt><i>key-function</i></tt>
being
<tt>(fun identity)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if</=
a></tt>
function is exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if=
</a></tt>,
except the sense of
the predicate is inverted. The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if</=
a></tt>
retains those items
which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if=
</a></tt>
will delete, and removes those that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if=
</a></tt>
will preserve.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if=
*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if*<=
/a></tt>
functions are like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if</=
a></tt>,
but produce lazy lists.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; remove any element numerically equal to 3.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> =
=3D 3) '(1 2 3 4 3.0 5)) -&gt; (1 2 4 5)

  ;; remove those pairs whose first element begins with "abc"
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> e=
qual [@1 0..3] "abc")
             '(("abcd" 4) ("defg" 5))
             car]
  -&gt; (("defg" 5))

  ;; equivalent, without test function
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">remove-if<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> e=
qual [(car @1) 0..3] "abc")
             '(("abcd" 4) ("defg" 5)))
  -&gt; (("defg" 5))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01DF131F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.26">9.22.26<=
/a> Functions <tt>countqual</tt>, <tt>countql</tt> and <tt>countq</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(countq </tt><tt><i>object</i></tt><tt> </tt><tt><i>iterabl=
e</i></tt><tt>)=20




<br>&nbsp;&nbsp;(countql </tt><tt><i>object</i></tt><tt> </tt><tt><i>iterab=
le</i></tt><tt>)=20




<br>&nbsp;&nbsp;(countqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>iter=
able</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DF131F">countq</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DF131F">countql</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DF131F">countqual=
</a></tt>
functions count the number of objects
in
<tt><i>iterable</i></tt>
which are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>object</i></tt>,
and return the count.
</p><p>

</p></dd></dl>
<a name=3D"N-00BBC726">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.27">9.22.27<=
/a> Function <tt>count-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(count-if </tt><tt><i>predicate-function</i></tt><tt> </tt>=
<tt><i>iterable</i></tt><tt> [</tt><tt><i>key-function</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BBC726">count-if<=
/a></tt>
function counts the number of elements of
<tt><i>iterable</i></tt>
which satisfy
<tt><i>predicate-function</i></tt>
and returns the count.
</p><p>
The optional
<tt><i>key-function</i></tt>
specifies how each element from
<tt><i>iterable</i></tt>
is transformed to an argument to
<tt><i>predicate-function</i></tt>.
If this argument is omitted
then the predicate function is applied to the elements directly, a behavior
which is identical to
<tt><i>key-function</i></tt>
being
<tt>(fun identity)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00A2B785">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.28">9.22.28<=
/a> Functions <tt>posq</tt>, <tt>posql</tt> and <tt>posqual</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(posq </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence<=
/i></tt><tt>)=20




<br>&nbsp;&nbsp;(posql </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(posqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequen=
ce</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A2B785">posq</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A2B785">posql</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A2B785">posqual</=
a></tt>
functions return the zero-based position of the
first item in
<tt><i>sequence</i></tt>
which is, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to
<tt><i>object</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02C2BBDB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.29">9.22.29<=
/a> Functions <tt>pos</tt> and <tt>pos-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pos </tt><tt><i>key</i></tt><tt> </tt><tt><i>sequence</i><=
/tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>=
]])=20




<br>&nbsp;&nbsp;(pos-if </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>sequen=
ce</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C2BBDB">pos</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C2BBDB">pos-if</a=
></tt>
functions search through
<tt><i>sequence</i></tt>
for an item which matches
<tt><i>key</i></tt>,
or satisfies the predicate function
<tt><i>predfun</i></tt>,
respectively.
They return the zero-based position of the matching item.
</p><p>
The
<tt><i>keyfun</i></tt>
argument specifies a function which is applied to the elements
of
<tt><i>sequence</i></tt>
to produce the comparison key. If this argument is omitted,
then the untransformed elements of
<tt><i>sequence</i></tt>
are examined.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C2BBDB">pos</a></=
tt>
function's
<tt><i>testfun</i></tt>
argument specifies the test function which
is used to compare the comparison keys from
<tt><i>sequence</i></tt>
to
<tt><i>key</i></tt>.
If this argument is omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is used.
The position of the first element
<tt><i>sequence</i></tt>
whose comparison key (as
retrieved by
<tt><i>keyfun</i></tt>)
matches the search (under
<tt><i>testfun</i></tt>)
is
returned. If no such element is found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C2BBDB">pos-if</a=
></tt>
function's
<tt><i>predfun</i></tt>
argument specifies a predicate function
which is applied to the successive comparison keys taken from
<tt><i>sequence</i></tt>
by applying
<tt><i>keyfun</i></tt>
to successive elements. The position of
the first element for which
<tt><i>predfun</i></tt>
yields true is returned. If
no such element is found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-01F68300">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.30">9.22.30<=
/a> Functions <tt>rposq</tt>, <tt>rposql</tt>, <tt>rposqual</tt>, <tt>rpos<=
/tt> and <tt>rpos-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rposq </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequence=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rposql </tt><tt><i>object</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rposqual </tt><tt><i>object</i></tt><tt> </tt><tt><i>seque=
nce</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rpos </tt><tt><i>key</i></tt><tt> </tt><tt><i>sequence</i>=
</tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt=
>]])=20




<br>&nbsp;&nbsp;(rpos-if </tt><tt><i>predfun</i></tt><tt> </tt><tt><i>seque=
nce</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions are counterparts of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F68300">rposq</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F68300">rposql</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F68300">rposqual<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F68300">rpos</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F68300">rpos-if</=
a></tt>
which report position of the right-most matching item,
rather than the left-most.
</p><p>

</p></dd></dl>
<a name=3D"N-027D45DD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.31">9.22.31<=
/a> Functions <tt>pos-max</tt> and <tt>pos-min</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pos-max </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>tes=
tfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(pos-min </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>tes=
tfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-min</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-max</=
a></tt>
functions implement exactly the same algorithm; they
differ only in their defaulting behavior with regard to the
<tt><i>testfun</i></tt>
argument.  If
<tt><i>testfun</i></tt>
is not given, then the pos-max function defaults
<tt><i>testfun</i></tt>
to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>
function, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-min</=
a></tt>
defaults it to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function.
</p><p>
If
<tt><i>sequence</i></tt>
is empty, both functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Without a
<tt><i>testfun</i></tt>
argument, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-max</=
a></tt>
function finds the zero-based
position index of the numerically maximum value occurring in
<tt><i>sequence</i></tt>,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-min</=
a></tt>
without a
<tt><i>testfun</i></tt>
argument finds the index of the minimum
value.
</p><p>
If a
<tt><i>testfun</i></tt>
argument is given, the two functions are equivalent.
The
<tt><i>testfun</i></tt>
function must be callable with two arguments.
If
<tt><i>testfun</i></tt>
behaves like a greater-than comparison, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-max</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-min</=
a></tt>
return the index of the maximum element. If
<tt><i>testfun</i></tt>
behaves like a
<tt>less-than</tt>
comparison, then the functions return
the index of the minimum element.
</p><p>
The
<tt><i>keyfun</i></tt>
argument defaults to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function. Each element
from
<tt><i>sequence</i></tt>
is passed through this one-argument function, and
the resulting value is used in its place.
</p><p>
If a sequence contains multiple equivalent maxima,
whether the position of the leftmost or rightmost such maximum is reported
depends on whether
<tt><i>testfun</i></tt>
compares for strict inequality, or whether it reports true for
equal arguments also. Under the default
<tt><i>testfun</i></tt>,
which is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-max</=
a></tt>
function will return the position leftmost of a duplicate set of maximum
elements. To find the rightmost of the maxima, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A3E42D">lequal</a=
></tt>
function can be substituted. Analogous reasoning applies to other
test functions.
</p><p>

</p></dd></dl>
<a name=3D"N-03164F4F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.32">9.22.32<=
/a> Function <tt>mismatch</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mismatch </tt><tt><i>left-seq</i></tt><tt> </tt><tt><i>rig=
ht-seq</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</=
i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03164F4F">mismatch<=
/a></tt>
function compares corresponding elements from the sequences
<tt><i>left-seq</i></tt>
and
<tt><i>right-seq</i></tt>,
returning the position at which the first mismatch occurs.
</p><p>
If the sequences are of the same length, and their corresponding
elements are the same, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If one sequence is shorter than the other, and matches a prefix
of the other, then the mismatching position returned is one position
after the last element of the shorter sequence, the same value
as its length. An empty sequence is a prefix of every sequence.
</p><p>
The
<tt><i>keyfun</i></tt>
argument defaults to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function. Each element
from
<tt><i>sequence</i></tt>
is passed to
<tt><i>keyfun</i></tt>
and the resulting value is used in its place.
</p><p>
After being converted through
<tt><i>keyfun</i></tt>,
items are then compared using
<tt><i>testfun</i></tt>,
which must accept two arguments, and defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-0208F1DE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.33">9.22.33<=
/a> Function <tt>where</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(where </tt><tt><i>function</i></tt><tt> </tt><tt><i>iterab=
le</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>iterable</i></tt>
is a sequence, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F1DE">where</a>=
</tt>
function returns
a lazy list of the numeric indices of those of its elements which satisfy
<tt><i>function</i></tt>.
The numeric indices appear in increasing order.
</p><p>
If
<tt><i>iterable</i></tt>
is a hash, the following special behavior applies:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F1DE">where</a>=
</tt>
returns a lazy list of
of keys which have values which satisfy
<tt><i>function</i></tt>.
These keys are not subject to an order.
</p><p>
<tt><i>function</i></tt>
must be a function that can be called with one argument.
For each element of
<tt><i>iterable</i></tt>,
<tt><i>function</i></tt>
is called with that element
as an argument.  If a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value is returned, then the zero-based index of
that element is added to a list. Finally, the list is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-008F3C16">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.34">9.22.34<=
/a> Function <tt>rmismatch</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rmismatch </tt><tt><i>left-seq</i></tt><tt> </tt><tt><i>ri=
ght-seq</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun<=
/i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03164F4F">mismatch<=
/a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008F3C16">rmismatch=
</a></tt>
function compares corresponding elements from the sequences
<tt><i>left-seq</i></tt>
and
<tt><i>right-seq</i></tt>,
returning the position at which the first mismatch occurs.
All of the arguments have the same semantics as that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03164F4F">mismatch<=
/a></tt>.
</p><p>
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03164F4F">mismatch<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008F3C16">rmismatch=
</a></tt>
compares the sequences right-to-left, finding the suffix
which they have in common, rather than prefix.
</p><p>
If the sequences match, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. Otherwise, a negative index is returned giving the
mismatching position, regarded from the end. If the sequences
match only in the rightmost element, then -1 is returned. If they
match in two elements then -2 and so forth.
</p><p>

</p></dd></dl>
<a name=3D"N-004955D4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.35">9.22.35<=
/a> Functions <tt>starts-with</tt> and <tt>ends-with</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(starts-with </tt><tt><i>short-seq</i></tt><tt> </tt><tt><i=
>long-seq</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfu=
n</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(ends-with </tt><tt><i>short-seq</i></tt><tt> </tt><tt><i>l=
ong-seq</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun<=
/i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004955D4">starts-wi=
th</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004955D4">ends-with=
</a></tt>
functions compare corresponding elements from sequences
<tt><i>short-seq</i></tt>
and
<tt><i>long-seq</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004955D4">starts-wi=
th</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>short-seq</i></tt>
is prefix of
<tt><i>long-seq</i></tt>;
otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004955D4">ends-with=
</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>short-seq</i></tt>
is suffix of
<tt><i>long-seq</i></tt>;
otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Element from both sequences are mapped to comparison keys using
<tt><i>keyfun</i></tt>,
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>.
</p><p>
Comparison keys are compared using
<tt><i>testfun</i></tt>
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-031D7F72">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.36">9.22.36<=
/a> Function <tt>select</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(select </tt><tt><i>sequence</i></tt><tt> {</tt><tt><i>inde=
x-list</i></tt><tt> | </tt><tt><i>function</i></tt><tt>})=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a=
></tt>
function returns a sequence, of the same kind as
<tt><i>sequence</i></tt>,
which consists of those elements of
<tt><i>sequence</i></tt>
which are identified by
the indices in
<tt><i>index-list</i></tt>,
which may be a list or a vector.
</p><p>
If
<tt><i>function</i></tt>
is given instead of
<tt><i>index-list</i></tt>,
then
<tt><i>function</i></tt>
is invoked with
<tt><i>sequence</i></tt>
as its argument. The return value is then taken as
if it were the
<tt><i>index-list</i></tt>
argument .
</p><p>
If
<tt><i>sequence</i></tt>
is a sequence, then
<tt><i>index-list</i></tt>
consists of numeric
indices. The length of the sequence, as reported by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
function, is added to every
<tt><i>index-list</i></tt>
value which is negative.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a=
></tt>
function stops collecting values upon encountering an index value which is
greater than or equal to the length of the sequence.
(Rationale: without
this strict behavior,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a=
></tt>
would not be able to terminate if
<tt><i>index-list</i></tt>
is infinite.)
</p><p>
If
<tt><i>sequence</i></tt>
is, more specifically, a list-like sequence, then
<tt><i>index-list</i></tt>
must contain monotonically increasing
numeric values, even if no value is out of range, since the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a=
></tt>
function
makes a single pass through the list based on the assumption that indices
are ordered. (Rationale: optimization.)
This requirement for monotonicity applies to the values which
result after negative indices are displaced by the sequence length
Also, in this list-like sequence case, values taken from
<tt><i>index-list</i></tt>
which are still negative after being displaced by the sequence length are
ignored.
</p><p>
If
<tt><i>sequence</i></tt>
is a hash, then
<tt><i>index-list</i></tt>
is a list of keys. A new hash is
returned which contains those elements of
<tt><i>sequence</i></tt>
whose keys appear
in
<tt><i>index-list</i></tt>.
All of
<tt><i>index-list</i></tt>
is processed, even if it contains
keys which are not in
<tt><i>sequence</i></tt>.
The nonexistent keys are ignored.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7F72">select</a=
></tt>
function also supports objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>,
in a manner similar to vectors. The indicated elements are extracted
from the input sequence, and a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is returned whose storage is initialized by converting the extracted
values back to the foreign representation.
</p><p>

</p></dd></dl>
<a name=3D"N-031DC0F2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.37">9.22.37<=
/a> Function <tt>reject</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(reject </tt><tt><i>sequence</i></tt><tt> {</tt><tt><i>inde=
x-list</i></tt><tt> | </tt><tt><i>function</i></tt><tt>})=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031DC0F2">reject</a=
></tt>
function returns a sequence, of the same kind as
<tt><i>sequence</i></tt>,
which consists of all those elements of
<tt><i>sequence</i></tt>
which are not identified by the indices in
<tt><i>index-list</i></tt>,
which may be a list or a vector.
</p><p>
If
<tt><i>function</i></tt>
is given instead of
<tt><i>index-list</i></tt>,
then
<tt><i>function</i></tt>
is invoked with
<tt><i>sequence</i></tt>
as its argument. The return value is then taken as
if it were the
<tt><i>index-list</i></tt>
argument .
</p><p>
If
<tt>sequence</tt>
is a hash, then
<tt><i>index-list</i></tt>
represents a list of keys. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031DC0F2">reject</a=
></tt>
function returns a duplicate of the hash, in which
the keys specified in
<tt><i>index-list</i></tt>
do not appear.
</p><p>
Otherwise if
<tt><i>sequence</i></tt>
is a vector-like sequence, then the behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031DC0F2">reject</a=
></tt>
may be understood by the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
1DC0F2">reject</a> seq idx)  --&gt;  (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-01C1D23C">make-like</a>
                           [<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-026C3723">apply</a> append (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-02FD4882">split*</a> seq idx)]
                           seq)
</tt></pre><tt>

</tt>

<p>
where it is to be understood that
<tt><i>seq</i></tt>
is evaluated only once.
</p><p>
If
<tt><i>sequence</i></tt>
is a list, then, similarly, the following equivalence applies:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
1DC0F2">reject</a> seq idx)  --&gt;  (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-01C1D23C">make-like</a>
                           [<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-026C3723">apply</a> append* (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-02FD4882">split*</a> seq idx)]
                           seq)
</tt></pre><tt>

</tt>

<p>
The input sequence is split into pieces at the indicated indices, such that
the elements at the indices are removed and do not appear in the pieces. Th=
e
pieces are then appended together in order, and the resulting list is coerc=
ed
into the same type of sequence as the input sequence.
</p><p>

</p></dd></dl>
<a name=3D"N-032DBF7E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.38">9.22.38<=
/a> Function <tt>relate</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(relate </tt><tt><i>domain-seq</i></tt><tt> </tt><tt><i>ran=
ge-seq</i></tt><tt> [</tt><tt><i>default-val</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DBF7E">relate</a=
></tt>
function returns a one-argument function which implements the relation form=
ed
by mapping the elements of
<tt><i>domain-seq</i></tt>
to the positionally corresponding elements of
<tt><i>range-seq</i></tt>.
That is to say, the function searches through the sequence
<tt><i>domain-seq</i></tt>
to determine the position where its argument occurs, using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
as the comparison function.
Then it returns the element from that position in the
<tt><i>range-seq</i></tt>
sequence. This returned function is called the
<i>relation function</i>.

</p><p>
If the relation function's argument is not found in
<tt><i>domain-seq</i></tt>,
then the behavior depends on the optional parameter
<tt><i>default-val</i></tt>.
If an argument is given for
<tt><i>default-val</i></tt>,
then the relation function returns that value.
Otherwise, the relation function returns its argument.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DBF7E">relate</a=
></tt>
function may be understood in terms of the following equivalences:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
2DBF7E">relate</a> d r)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#D-004F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-02133AA5">arg</a>)
                        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-02DA21F6">iflet</a> ((p (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-00A2B785">posqual</a> arg d)))
                          [r p]
                          arg))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DBF7E">relate</a>=
 d r v)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
04F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133A=
A5">arg</a>)
                          (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-02DA21F6">iflet</a> ((p (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-00A2B785">posqual</a> arg d)))
                            [r p]
                            v))
</tt></pre><tt>

</tt>

<p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DBF7E">relate</a=
></tt>
may return a hash table instead of a function, if such an object
can satisfy the semantics required by the arguments.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032=
DBF7E">relate</a> "_" "-") "foo_bar")  -&gt;  "foo-bar"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DBF7E">relate</a> =
"0123456789" "ABCDEFGHIJ" "X") "139D-345")
  -&gt; "BJDXXDEF"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DBF7E">relate</a> =
'(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a>) '(=
0)) '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a>=
 1 2 nil 4)) -&gt; (0 1 2 0 4)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-016BE41C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.39">9.22.39<=
/a> Function <tt>in</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(in </tt><tt><i>sequence</i></tt><tt> </tt><tt><i>key</i></=
tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]=
])=20




<br>&nbsp;&nbsp;(in </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016BE41C">in</a></t=
t>
function tests whether
<tt><i>key</i></tt>
is found inside
<tt><i>sequence</i></tt>
or
<tt><i>hash</i></tt>.
</p><p>
If the
<tt><i>testfun</i></tt>
argument is specified, it specifies the function
which is used to comparison keys from the sequence
to
<tt><i>key</i></tt>.
Otherwise the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is used.
</p><p>
If the
<tt><i>keyfun</i></tt>
argument is specified, it specifies a function which
is applied to the elements of
<tt><i>sequence</i></tt>
to produce the comparison keys. Without this
argument, the elements themselves are taken
as the comparison keys.
</p><p>
If the object being searched is a hash, then if neither of the arguments
<tt><i>keyfun</i></tt>
nor
<tt><i>testfun</i></tt>
is specified,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016BE41C">in</a></t=
t>
performs a hash lookup for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>,
returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the key is found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise.
If either of
<tt><i>keyfun</i></tt>
or
<tt><i>testfun</i></tt>
is specified, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016BE41C">in</a></t=
t>
performs an exhaustive search of the hash table, as if it were
a sequence of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields are keys, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
keys are values. Thus to search by key, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function must be specified as
<tt><i>keyfun</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016BE41C">in</a></t=
t>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it finds
<tt><i>key</i></tt>
in
<tt><i>sequence</i></tt>
or
<tt><i>hash</i></tt>,
otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0142889E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.40">9.22.40<=
/a> Function <tt>partition</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(partition </tt><tt><i>sequence</i></tt><tt> {</tt><tt><i>i=
ndex-list</i></tt><tt> | </tt><tt><i>index</i></tt><tt> | </tt><tt><i>funct=
ion</i></tt><tt>})=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>sequence</i></tt>
is empty, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
returns an empty list, and the
second argument is ignored; if it is
<tt><i>function</i></tt>,
it is not called.
</p><p>
Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
returns a lazy list of partitions of
<tt><i>sequence</i></tt>.
Partitions are consecutive, non-overlapping, non-empty sub-strings of
<tt><i>sequence</i></tt>,
of the same kind as
<tt><i>sequence</i></tt>,
such that if these sub-strings are catenated together in their order
of appearance, a sequence
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to the original is produced.
</p><p>
If the second argument is of the form
<tt><i>index-list</i></tt>,
or if an
<tt><i>index-list</i></tt>
was produced from the
<tt><i>index</i></tt>
or
<tt><i>function</i></tt>
arguments, each value in that list must be an integer. Each integer
value which is non-negative specifies the index position
given by its value. Each integer value which is negative
specifies an index position given by adding the length of
<tt><i>sequence</i></tt>
to its value. The sequence index positions thus denoted by
<tt><i>index-list</i></tt>
shall be strictly non-decreasing. Each successive element
is expected to designate an index position at least as high
as all previous elements, otherwise the behavior is unspecified.
Leading index positions which are (still) negative, or zero, are effectivel=
y
ignored.
</p><p>
If
<tt><i>index-list</i></tt>
is empty then a one-element list containing the entire
<tt><i>sequence</i></tt>
is returned.
</p><p>
If
<tt><i>index-list</i></tt>
is an infinite lazy list, the function shall terminate if that
list eventually produces an index position which is greater than or equal t=
o
the length of
<tt><i>sequence</i></tt>.
</p><p>
If the second argument is a function, then this function is applied
to
<tt><i>sequence</i></tt>,
and the return value of this call is then used in place of the
second argument, which must be a single index value, which is then
taken as if it were the
<tt><i>index</i></tt>
argument, or else a list of indices, which are taken as the
<tt><i>index-list</i></tt>
argument.
</p><p>
If the second argument is an atom other than a function, it is assumed to b=
e
an integer index, and is turned into an
<tt><i>index-list</i></tt>
of one element.
</p><p>
After the
<tt><i>index-list</i></tt>
is obtained as an argument, or determined from the
<tt><i>index</i></tt>
or
<tt><i>function</i></tt>
arguments, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
function then divides
<tt><i>sequence</i></tt>
according to the indices given by that list.
The first partition begins with the first element of
<tt><i>sequence</i></tt>.
The second partition begins at the first position in
<tt><i>index-list</i></tt>,
and so on. Indices beyond the length of the sequence are ignored,
as are indices less than or equal to zero.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
42889E">partition</a> '(1 2 3) 1) -&gt; ((1) (2 3))

  ;; split the string where there is a "b"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition<=
/a> "abcbcbd" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D=
">op</a> where (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9=
D">op</a> eql #\b))) -&gt; ("a" "bc"
                                                    "bc" "bd")
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02FD4882">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.41">9.22.41<=
/a> Functions <tt>split</tt> and <tt>split*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(split </tt><tt><i>sequence</i></tt><tt> {</tt><tt><i>index=
-list</i></tt><tt> | </tt><tt><i>index</i></tt><tt> | </tt><tt><i>function<=
/i></tt><tt>})=20




<br>&nbsp;&nbsp;(split* </tt><tt><i>sequence</i></tt><tt> {</tt><tt><i>inde=
x-list</i></tt><tt> | </tt><tt><i>index</i></tt><tt> | </tt><tt><i>function=
</i></tt><tt>})=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>sequence</i></tt>
is empty, then both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split*</a=
></tt>
return an empty list, and the
second argument is ignored; if it is
<tt><i>function</i></tt>,
it is not called.
</p><p>
Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
returns a lazy list of pieces of
<tt><i>sequence</i></tt>:
consecutive, non-overlapping, possibly empty sub-strings of
<tt><i>sequence</i></tt>,
of the same kind as
<tt><i>sequence</i></tt>.
A catenation of these pieces in the order they appear would produce
a sequence that is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to the original sequence.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split*</a=
></tt>
function differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
in that the elements indicated by the split indices are removed.
</p><p>
The
<tt><i>index</i></tt>,
<tt><i>index-list</i></tt>,
and
<tt><i>function</i></tt>
arguments are subject to the same restrictions and treatment
as the corresponding arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
function, with the following difference: the index positions indicated by
<tt>index-list</tt>
are required to be strictly increasing, rather than non-decreasing.
</p><p>
If the second argument is of the form
<tt><i>index-list</i></tt>,
or if an
<tt><i>index-list</i></tt>
was produced from the
<tt><i>index</i></tt>
or
<tt><i>function</i></tt>
arguments, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
function divides
<tt><i>sequence</i></tt>
according to the indices indicated in the list. The first piece always begi=
ns
with the first element of
<tt><i>sequence</i></tt>.
Each subsequent piece begins with the position indicated by
an element of
<tt><i>index-list</i></tt>.
Negative indices are ignored.
If
<tt><i>index-list</i></tt>
includes index zero,
then an empty first piece is generated.
If
<tt><i>index-list</i></tt>
includes an index greater than or equal to the length of
<tt><i>sequence</i></tt>
(equivalently, an index beyond the last element of the sequence)
then an additional empty last piece is generated.
The length of
<tt><i>sequence</i></tt>
is added to any negative indices. An index which is still negative
after being thus displaced is discarded.
</p><p>
Note: the principal difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
does not produce empty pieces.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
FD4882">split</a> '(1 2 3) 1) -&gt; ((1) (2 3))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" 0) -&gt; ("" "abc")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" 3) -&gt; ("abc" "")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" 1) -&gt; ("a" "bc")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" '(0 1 2 3)) -&gt; ("" "a" "b" "c" "")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" '(1 2)) -&gt; ("a" "b" "c")

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" '(-1 1 2 15)) -&gt; ("a" "b" "c")

  ;; triple split at makes two additional empty pieces
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a> =
"abc" '(1 1 1)) -&gt; ("a" "" "" "bc")

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split*</a>=
 "abc" 0) -&gt; ("" "bc") ;; "a" is removed

  ;; all characters removed
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split*</a>=
 "abc" '(0 1 2)) -&gt; ("" "" "" "")
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03951D7A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.42">9.22.42<=
/a> Function <tt>partition*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(partition* </tt><tt><i>sequence</i></tt><tt> {</tt><tt><i>=
index-list</i></tt><tt> | </tt><tt><i>index</i></tt><tt> | </tt><tt><i>func=
tion</i></tt><tt>})=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>sequence</i></tt>
is empty, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03951D7A">partition=
*</a></tt>
returns an empty list, and the
second argument is ignored; if it is
<tt><i>function</i></tt>,
it is not called.
</p><p>
The
<tt><i>index</i></tt>,
<tt><i>index-list</i></tt>,
and
<tt><i>function</i></tt>
arguments are subject to the same restrictions and treatment
as the corresponding arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
function, with the following difference: the index positions indicated by
<tt>index-list</tt>
are required to be strictly increasing, rather than non-decreasing.
</p><p>
If the second argument is of the form
<tt><i>index-list</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03951D7A">partition=
*</a></tt>
produces a
lazy list of pieces taken from
<tt><i>sequence</i></tt>.
The pieces are formed by deleting from
<tt><i>sequence</i></tt>
the elements at the positions given
in
<tt><i>index-list</i></tt>,
such that the pieces are the remaining non-empty sub-strings from
between the deleted elements, maintaining their order.
</p><p>
If
<tt><i>index-list</i></tt>
is empty then a one-element list containing the entire
<tt><i>sequence</i></tt>
is returned.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
951D7A">partition*</a> '(1 2 3 4 5) '(0 2 4)) -&gt; ((2) (4))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03951D7A">partition*=
</a> "abcd" '(0 3)) -&gt; "bc"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03951D7A">partition*=
</a> "abcd" '(0 1 2 3)) -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-005431FF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.43">9.22.43<=
/a> Functions <tt>find</tt> and <tt>find-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(find </tt><tt><i>key</i></tt><tt> </tt><tt><i>sequence</i>=
</tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt=
>]])=20




<br>&nbsp;&nbsp;(find-if </tt><tt><i>predfun</i></tt><tt> {</tt><tt><i>sequ=
ence</i></tt><tt> | </tt><tt><i>hash</i></tt><tt>}
 &lt;&gt; [ keyfun ])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find-if</=
a></tt>
functions search through a sequence for an item which
matches a key, or satisfies a predicate function, respectively.
</p><p>
The
<tt><i>keyfun</i></tt>
argument specifies a function which is applied to the elements
of
<tt><i>sequence</i></tt>
to produce the comparison key. If this argument is omitted,
then the untransformed elements of the
<tt><i>sequence</i></tt>
are searched.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find</a><=
/tt>
function's
<tt><i>testfun</i></tt>
argument specifies the test function which
is used to compare the comparison keys from
<tt><i>sequence</i></tt>
to the search key.
If this argument is omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is used.
The first element from the list whose comparison key (as retrieved by
<tt><i>keyfun</i></tt>)
matches the search (under
<tt><i>testfun</i></tt>)
is returned. If no such element is found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find-if</=
a></tt>
function's
<tt><i>predfun</i></tt>
argument specifies a predicate function
which is applied to the successive comparison keys pulled from the list
by applying
<tt><i>keyfun</i></tt>
to successive elements. The first element
for which
<tt><i>predfun</i></tt>
yields true is returned. If no such
element is found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find-if</=
a></tt>,
a hash table may be specified instead of a sequence.
The
<tt><i>hash</i></tt>
is treated as if it were a sequence of hash key and hash
value pairs represented as cons cells, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
slots of which are the hash keys, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of which are the hash values.  If the caller doesn't specify a
<tt><i>keyfun</i></tt>
then these cells are taken as their keys.
</p><p>

</p></dd></dl>
<a name=3D"N-0301CDB6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.44">9.22.44<=
/a> Functions <tt>rfind</tt> and <tt>rfind-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rfind </tt><tt><i>key</i></tt><tt> </tt><tt><i>sequence</i=
></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><t=
t>]])=20




<br>&nbsp;&nbsp;(rfind-if </tt><tt><i>predfun</i></tt><tt> {</tt><tt><i>seq=
uence</i></tt><tt> | </tt><tt><i>hash</i></tt><tt>}
 &lt;&gt; [ keyfun ])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0301CDB6">rfind</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0301CDB6">rfind-if<=
/a></tt>
functions are almost exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find-if</=
a></tt>
except that if there are multiple matches for
<tt><i>key</i></tt>
in
<tt><i>sequence</i></tt>,
they return the right-most element rather than
the leftmost.
</p><p>
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0301CDB6">rfind-if<=
/a></tt>
when a
<tt><i>hash</i></tt>
is specified instead of a
<tt><i>sequence</i></tt>,
the function searches through the hash entries in the same order as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005431FF">find-if</=
a></tt>,
but finds the last match rather than the first.
Note: hashes are inherently not ordered; the relative order of items in
a hash table can change when other items are inserted or deleted.
</p><p>

</p></dd></dl>
<a name=3D"N-02BB4231">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.45">9.22.45<=
/a> Functions <tt>find-max</tt> and <tt>find-min</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(find-max {</tt><tt><i>sequence</i></tt><tt> | </tt><tt><i>=
hash</i></tt><tt>} [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i=
></tt><tt>]])=20




<br>&nbsp;&nbsp;(find-min {</tt><tt><i>sequence</i></tt><tt> | </tt><tt><i>=
hash</i></tt><tt>} [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i=
></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-min<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-max<=
/a></tt>
function implement exactly the same algorithm; they
differ only in their defaulting behavior with regard to the
<tt><i>testfun</i></tt>
argument.  If
<tt><i>testfun</i></tt>
is not given, then the find-max function defaults it to
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC1F73">greater</=
a></tt>
function, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-min<=
/a></tt>
defaults it to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function.
</p><p>
Without a
<tt><i>testfun</i></tt>
argument, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-max<=
/a></tt>
function finds the numerically
maximum value occurring in
<tt><i>sequence</i></tt>,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-min</=
a></tt>
without a
<tt><i>testfun</i></tt>
argument finds the minimum value.
</p><p>
If a
<tt><i>testfun</i></tt>
argument is given, the two functions are equivalent.
The
<tt><i>testfun</i></tt>
function must be callable with two arguments.
If
<tt><i>testfun</i></tt>
behaves like a greater-than comparison, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-max<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4231">find-min<=
/a></tt>
both return the maximum element. If
<tt><i>testfun</i></tt>
behaves like a less-than comparison, then the functions return
the minimum element.
</p><p>
The
<tt><i>keyfun</i></tt>
argument defaults to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function. Each element
from
<tt><i>sequence</i></tt>
is passed through this one-argument function, and
the resulting value is used in its place for the purposes of the
comparison. However, the original element is returned.
</p><p>
A hash table may be specified instead of a sequence.
The
<tt><i>hash</i></tt>
is treated as if it were a sequence of hash key and hash
value pairs represented as cons cells, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
slots of which are the hash keys, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of which are the hash values.  If the caller doesn't specify a
<tt><i>keyfun</i></tt>
then these cells are taken as their keys. To find the hash
table's key-value cell with the maximum key, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function can be specified as
<tt><i>keyfun</i></tt>.
To find the entry holding the maximum value, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
function can be specified.
</p><p>
If there are multiple equivalent maxima, then under the default
<tt><i>testfun</i></tt>,
that being
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>,
the leftmost one is reported. See the notes under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D45DD">pos-max</=
a></tt>
regarding duplicate maxima.
</p><p>

</p></dd></dl>
<a name=3D"N-0385B074">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.46">9.22.46<=
/a> Functions <tt>uni</tt>, <tt>isec</tt>, <tt>diff</tt> and <tt>symdiff</t=
t></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(uni </tt><tt><i>iter1</i></tt><tt> </tt><tt><i>iter1</i></=
tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]=
])=20




<br>&nbsp;&nbsp;(isec </tt><tt><i>iter1</i></tt><tt> </tt><tt><i>iter1</i><=
/tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>=
]])=20




<br>&nbsp;&nbsp;(diff </tt><tt><i>iter1</i></tt><tt> </tt><tt><i>iter1</i><=
/tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>=
]])=20




<br>&nbsp;&nbsp;(symdiff </tt><tt><i>iter1</i></tt><tt> </tt><tt><i>iter2</=
i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><=
tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">uni</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">isec</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">diff</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">symdiff</=
a></tt>
treat the sequences
<tt><i>iter1</i></tt>
and
<tt><i>iter2</i></tt>
as if they were sets.
</p><p>
They, respectively, compute the set union, set intersection,
set difference and symmetric difference of
<tt><i>iter1</i></tt>
and
<tt><i>iter2</i></tt>,
returning a new sequence.
</p><p>
The arguments
<tt><i>iter1</i></tt>
and
<tt><i>iter2</i></tt>
need not be of the same kind. They may be hash tables.
</p><p>
The returned sequence is of the same kind as
<tt><i>iter1</i></tt>.
If
<tt><i>iter1</i></tt>
is a hash table, the returned sequence is a list.
</p><p>
For the purposes of these functions, an input which is a hash table
is considered as if it were a sequence of hash key and hash
value pairs represented as cons cells, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
slots of which are the hash keys, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of which are the hash values. This means that if no
<tt><i>keyfun</i></tt>
is specified, these pairs are taken as keys.
</p><p>
Since the input sequences are defined as representing sets, they are assume=
d
not to contain duplicate elements. These functions are not required, but ma=
y,
de-duplicate the sequences.
</p><p>
The union sequence produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">uni</a></=
tt>
contains all of the elements which occur in both
<tt><i>iter1</i></tt>
and
<tt><i>iter2</i></tt>.
If a given element occurs exactly once only in
<tt><i>iter1</i></tt>
or exactly once only in
<tt><i>iter2</i></tt>,
or exactly once in both sequences, then it occurs exactly once in the union
sequence.  If a given element occurs at least once in either
<tt><i>iter1</i></tt>,
<tt><i>iter2</i></tt>
or both, then it occurs at least once in the union sequence.
</p><p>
The intersection sequence produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">isec</a><=
/tt>
contains all of the elements which occur in both
<tt><i>iter1</i></tt>
and
<tt><i>iter2</i></tt>.
If a given element occurs exactly once in
<tt><i>iter1</i></tt>
and exactly once in
<tt><i>iter2</i></tt>,
then in occurs exactly once in the intersection sequence.
If a given element occurs at least once in
<tt><i>iter1</i></tt>
and at least once in
<tt><i>iter2</i></tt>,
then in occurs at least once in the intersection sequence.
</p><p>
The difference sequence produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">diff</a><=
/tt>
contains all of the elements which occur in
<tt><i>iter1</i></tt>
but do not occur in
<tt><i>iter2</i></tt>.
If an element occurs exactly once in
<tt><i>iter1</i></tt>
and does not occur in
<tt><i>iter2</i></tt>,
then it occurs exactly once in the difference sequence.
If an element occurs at least once in
<tt><i>iter1</i></tt>
and does not occur in
<tt><i>iter2</i></tt>,
then it occurs at least once in the difference sequence.
If an element occurs at least once in
<tt><i>iter2</i></tt>,
then it does not occur in the difference sequence.
</p><p>
The symmetric difference sequence produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">symdiff</=
a></tt>
contains all of the elements of
<tt><i>iter1</i></tt>
which do not occur in
<tt><i>iter2</i></tt>
and
<i>vice versa</i>:

it also contains all of the elements of
<tt><i>iter2</i></tt>
which do not occur in
<tt><i>iter1</i></tt>.
</p><p>
Element equivalence is determined by a combination of
<tt><i>testfun</i></tt>
and
<tt><i>keyfun</i></tt>.
Elements are compared pairwise, and each element of a pair is passed throug=
h
<tt><i>keyfun</i></tt>
function to produce a comparison value. The comparison values
are compared using
<tt><i>testfun</i></tt>.
If
<tt><i>keyfun</i></tt>
is omitted, then the
untransformed elements themselves are compared, and if
<tt><i>testfun</i></tt>
is omitted,
then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is used.
</p><p>
Note: a function similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">diff</a><=
/tt>
named
<tt>set-diff</tt>
exists. This became deprecated starting in <b>TXR</b> 184.
For the
<tt>set-diff</tt>
function, the requirement was specified to preserve the original
order of items from
<tt><i>iter1</i></tt>
that survive into the output sequence.
This requirement is not documented for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0385B074">diff</a><=
/tt>
function, but is
<i>de facto</i>

honored by the implementation for at as long as the
<tt>set-diff</tt>
synonym continues to be available.
The
<tt>set-diff</tt>
function doesn't support hash tables and is inefficient for vectors and
strings.
</p><p>
Note: these functions are not efficient for the processing of hash tables,
even when both inputs are hashes, the
<tt><i>keyfun</i></tt>
argument is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
and
<tt><i>testfun</i></tt>
matches the equality used by both hash table inputs.
If applicable, the operations
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-uni<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-isec=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-diff=
</a></tt>
should be used instead.
</p><p>

</p></dd></dl>
<a name=3D"N-0202F92F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.47">9.22.47<=
/a> Functions <tt>mapcar</tt>, <tt>mappend</tt>, <tt>mapcar*</tt> and <tt>m=
append*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mapcar </tt><tt><i>function</i></tt><tt> </tt><tt><i>itera=
ble</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(mappend </tt><tt><i>function</i></tt><tt> </tt><tt><i>iter=
able</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(mapcar* </tt><tt><i>function</i></tt><tt> </tt><tt><i>iter=
able</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(mappend* </tt><tt><i>function</i></tt><tt> </tt><tt><i>ite=
rable</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



When given only one argument, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<tt><i>function</i></tt>
is never called.
</p><p>
When given two arguments, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
function applies
<tt><i>function</i></tt>
to each elements of
<tt><i>iterable</i></tt>
and returns a sequence of the resulting values
in the same order as the original values.
The returned sequence is the same kind as
<tt><i>iterable</i></tt>,
if possible. If the accumulated values cannot be
elements of that type of sequence, then a list is returned.
</p><p>
When additional sequences are given as arguments, this filtering behavior i=
s
generalized in the following way:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
traverses the sequences in parallel,
taking a value from each sequence as an argument to the function. If there
are two lists,
<tt><i>function</i></tt>
is called with two arguments and so forth.
The traversal is limited by the length of the shortest sequence.
The return values of the function are collected into a new sequence which i=
s
returned. The returned sequence is of the same kind as the leftmost
input sequence, unless the accumulated values cannot be elements of that ty=
pe of
sequence, in which case a list is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>
function works like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>,
with the following difference.
Rather than accumulating the values returned by the function into a sequenc=
e,
mappend expects the items returned by the function to be sequences which
are catenated with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>,
and the resulting sequence is returned. The returned sequence is of the sam=
e
kind as the leftmost input sequence, unless the values cannot be elements
of that type of sequence, in which case a list is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar*</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend*<=
/a></tt>
functions work like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>,
respectively.
However, they return lazy lists rather than generating the entire
output list prior to returning.
</p><p>
</p></dd><dt>Caveats:</dt><dd>
<p>


</p><p>
Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend*<=
/a></tt>
must "consume" empty lists. For instance,
if the function being mapped puts out a sequence of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>-s,
then the result must be the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
because
<tt>(append nil nil nil nil ...)</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
But suppose that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend*<=
/a></tt>
is used on inputs which are infinite lazy
lists, such that the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
values indefinitely.
For instance:
</p><p>
<tt>
</tt></p><pre><tt>  ;; Danger: infinite loop!!!
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend*</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> i=
dentity) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0052">repeat<=
/a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a>=
))) </tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend*<=
/a></tt>
function is caught in a loop trying to consume
and squash an infinite stream of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>-s,
and so doesn't return.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; multiply every element by two
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (ite=
m) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> 2 i=
tem)) '(1 2 3)) -&gt; (4 6 8)

  ;; "zipper" two lists together
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (le =
ri) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 le ri)) '(1 2 3) '(a b c))
  -&gt; '((1 a) (2 b) (3 c)))

  ;; like append, mappend allows a lone atom or a trailing atom:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> id=
entity) 3) -&gt; (3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> id=
entity) '((1) 2)) -&gt; (1 . 2)

  ;; take just the even numbers
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (it=
em) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a> x) (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> x))) '(1 2 =
3 4 5))
  -&gt; (2 4)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-015987D7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.48">9.22.48<=
/a> Functions <tt>maprod</tt>, <tt>maprend</tt> and <tt>maprodo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(maprod </tt><tt><i>function</i></tt><tt> </tt><tt><i>itera=
ble</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(maprend </tt><tt><i>function</i></tt><tt> </tt><tt><i>iter=
able</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(maprodo </tt><tt><i>function</i></tt><tt> </tt><tt><i>iter=
able</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprend</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprodo</=
a></tt>
functions resemble
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>,
respectively. When given no
<tt><i>iterable</i></tt>
arguments or exactly one
<tt><i>iterable</i></tt>
argument, they behave exactly like those three functions.
</p><p>
When two or more
<tt><i>iterable</i></tt>
arguments are present,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a=
></tt>
differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
in the following way, as do the remaining functions
from their aforementioned counterparts.
Whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
iterates over the
<tt><i>iterable</i></tt>
values in parallel, taking successive tuples of element
values and passing them to
<tt><i>function</i></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a=
></tt>
function iterates over all
<i>combinations</i>

of elements from the sequences: the Cartesian product. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">prod</a><=
/tt>
suffix stands for "product".
</p><p>
If one or more
<tt><i>iterable</i></tt>
arguments specify an empty sequence, then the Cartesian product is empty.
In this situation,
<tt><i>function</i></tt>
is not called. The result of the function is then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
converted to the same kind of sequence as the leftmost
<tt><i>iterable</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a=
></tt>
function collects the values into a list just as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
does. Just like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>,
it converts the resulting list into the same kind of sequence
as the leftmost
<tt><i>iterable</i></tt>
argument, if possible. For instance, if the resulting list is
a list or vector of characters, and the leftmost
<tt><i>iterable</i></tt>
is a character string, then the list or vector of characters
is converted to a character string and returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprend</=
a></tt>
function ("map product through function and append") iterates the
<tt><i>iterable</i></tt>
element combinations exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprod</a=
></tt>,
passing them as arguments to
<tt><i>function</i></tt>.
The values returned by
<tt><i>function</i></tt>
are then treated exactly as by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>
function. The return values are expected to be sequences which
are appended together as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>,
and the final result is converted to the same kind of sequence as the leftm=
ost
<tt><i>iterable</i></tt>
if possible.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprodo</=
a></tt>
function, like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>,
ignores the result of
<tt><i>function</i></tt>
and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The combination iteration gives priority to the rightmost
<tt><i>iterable</i></tt>,
which means that the rightmost element of each generated tuple varies
fastest: the tuples are traversed in "rightmost major" order.
This is made clear in the examples.
</p><p>
</p></dd><dt>Examples</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
5987D7">maprod</a> list '(0 1 2) '(a b) '(i ii iii)]
  -&gt;
  ((0 a i) (0 a ii) (0 a iii) (0 b i) (0 b ii) (0 b iii)
   (1 a i) (1 a ii) (1 a iii) (1 b i) (1 b ii) (1 b iii)
   (2 a i) (2 a ii) (2 a iii) (2 b i) (2 b ii) (2 b iii))

  ;; Vectors #(#\a #\x) #(#\a #\y) ... are appended
  ;; together resulting in #(#\a #\x #\a #\y ...)
  ;; which is converted to a string:

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprend</a=
> vec "ab" "xy"] -&gt; "axaybxby"

  ;; One of the sequences is empty, so the product is an
  ;; empty sequence of the same kind as the leftmost
  ;; sequence argument, thus an empty string:
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015987D7">maprend</a=
> vec "ab" ""] -&gt; ""
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03A943EE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.49">9.22.49<=
/a> Function <tt>mapdo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mapdo </tt><tt><i>function</i></tt><tt> </tt><tt><i>iterab=
le</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>,
but always returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
It is useful
when
<tt><i>function</i></tt>
performs some kind of side effect, hence the "do" in the name,
which is a mnemonic for the execution of imperative actions.
</p><p>
When only the
<tt><i>function</i></tt>
argument is given,
<tt><i>function</i></tt>
is never called,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If a single
<tt><i>iterable</i></tt>
argument is given, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>
iterates over
<tt><i>iterable</i></tt>,
invoking
<tt><i>function</i></tt>
on each element.
</p><p>
If two or more
<tt><i>iterable</i></tt>
arguments are given, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>
iterates over
the sequences in parallel, extracting parallel tuples of items. These
tuples are passed as arguments to
<tt><i>function</i></tt>,
which must accept as many
arguments as there are sequences.
</p><p>

</p></dd></dl>
<a name=3D"N-03AA85AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.50">9.22.50<=
/a> Functions <tt>transpose</tt> and <tt>zip</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(transpose </tt><tt><i>iterable</i></tt><tt>)=20




<br>&nbsp;&nbsp;(zip </tt><tt><i>iterable</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose=
</a></tt>
function performs a transposition on
<tt><i>iterable</i></tt>.
This means that the
elements of
<tt><i>iterable</i></tt>
must be iterable.  These iterables are understood to be
columns; transpose exchanges rows and columns, returning a sequence of the =
rows
which make up the columns.  The returned sequence is of the same kind as
<tt><i>iterable</i></tt>,
and the rows are also the same kind of sequence as the first column
of the original sequence. The number of rows returned is limited by the
shortest column among the sequences.
</p><p>
All of the input sequences (the elements of
<tt><i>iterable</i></tt>)
must have elements
which are compatible with the first sequence. This means that if the first
element of
<tt><i>iterable</i></tt>
is a string, then the remaining sequences must be
strings, or else sequences of characters, or of strings.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">zip</a></=
tt>
function takes variable arguments, and is equivalent to calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose=
</a></tt>
on a list of the arguments. The following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
3AA85AD">zip</a> . x) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-03AA85AD">transpose</a> x)

   [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
 zip x] &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A=
A85AD">transpose</a> x)
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; transpose list of lists
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose<=
/a> '((a b c) (c d e))) -&gt;  ((a c) (b d) (c e))

  ;; transpose vector of strings:
  ;; - string columns become string rows
  ;; - vector input becomes vector output
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose<=
/a> #("abc" "def" "ghij")) -&gt; #("adg" "beh" "cfi")

  ;; error: transpose wants to make a list of strings
  ;; but 1 is not a character
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose<=
/a> #("abc" "def" '(1 2 3))) ;; error!

  ;; String elements are catenated:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose<=
/a> #("abc" "def" ("UV" "XY" "WZ")))
  -&gt; #("adUV" "beXY" "cfWZ")

  ;; Transpose list of ranges
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">transpose<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 1..4 4..8 8..12))
  -&gt; ((1 4 8) (2 5 9) (3 6 10))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA85AD">zip</a> '(=
a b c) '(c d e)) -&gt;  ((a c) (b d) (c e))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-015AFD48">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.51">9.22.51<=
/a> Functions <tt>window-map</tt>, <tt>window-mappend</tt> and <tt>window-m=
apdo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(window-map </tt><tt><i>range</i></tt><tt> </tt><tt><i>boun=
dary</i></tt><tt> </tt><tt><i>function</i></tt><tt> </tt><tt><i>sequence</i=
></tt><tt>)=20




<br>&nbsp;&nbsp;(window-mappend </tt><tt><i>range</i></tt><tt> </tt><tt><i>=
boundary</i></tt><tt> </tt><tt><i>function</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt>)=20




<br>&nbsp;&nbsp;(window-mapdo </tt><tt><i>range</i></tt><tt> </tt><tt><i>bo=
undary</i></tt><tt> </tt><tt><i>function</i></tt><tt> </tt><tt><i>sequence<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015AFD48">window-ma=
p</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015AFD48">window-ma=
ppend</a></tt>
functions process the elements of
<tt><i>sequence</i></tt>
by passing arguments derived from each successive element to
<tt><i>function</i></tt>.
Both functions return, if possible, a sequence of the same kind as
<tt>sequence</tt>,
otherwise a list.
</p><p>
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015AFD48">window-ma=
p</a></tt>,
values returned by
<tt><i>function</i></tt>
are accumulated into a sequence of the same type as
<tt><i>sequence</i></tt>
and that sequence is returned.  Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015AFD48">window-ma=
ppend</a></tt>,
the values returned by the calls to
<tt><i>function</i></tt>
are expected to be sequence which are appended together to
form the output sequence.
</p><p>
These functions are analogous to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>.
Unlike these, they operate only on a single sequence, and over this sequenc=
e
they perform a
<i>sliding window mapping</i>,

whose description follows.
</p><p>
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015AFD48">window-ma=
ppend</a></tt>
avoids accumulating a sequence, and instead returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>;
it is analogous to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a>=
</tt>.
</p><p>
The argument to the
<tt><i>range</i></tt>
parameter must be a positive integer, not exceeding 512.
This parameter specifies the amount of ahead/behind context on either
side of each element which is processed. It indirectly determines
the window size for the mapping. The window size is twice
<tt><i>range</i></tt>,
plus one. For instance if range is 2, then the window size is 5:
the element being processed lies at the center of the window, flanked
by two elements on either side, making five.
</p><p>
The
<tt><i>function</i></tt>
argument must specify a function which accepts a number of arguments
corresponding to the window size. For instance if
<tt><i>range</i></tt>
is 2,
making the window size 5,
then
<tt><i>function</i></tt>
must accept 5 arguments. These arguments constitute the sliding
window being processed. Each time
<tt><i>function</i></tt>
is called, the middle argument is the element being processed,
and the arguments surrounding it are its window.
</p><p>
When an element is processed from somewhere in the interior of
a sequence, where it is flanked on either side by at least
<tt><i>range</i></tt>
elements, then the window is populated by those flanking elements
taken from
<tt><i>sequence</i></tt>.
</p><p>
The
<tt><i>boundary</i></tt>
parameter specifies the window contents which are used for the
processing of elements which are closer than
<tt><i>range</i></tt>
to either end of the sequence.  The argument may be a sequence containing
at least twice
<tt><i>range</i></tt>
number of elements (one less than the window size): if it has additional
elements, they are not used. If it is a list, it may be shorter than twice
<tt><i>range</i></tt>.
The argument
may also be one of the two keyword symbols
<tt>:wrap</tt>
or
<tt>:reflect</tt>,
described below.
</p><p>
If
<tt><i>boundary</i></tt>
is a sequence, it may be regarded as divided into two pieces of
<tt><i>range</i></tt>
length. If it is a list of insufficient length, then missing elements
are supplied as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to make two
<tt><i>range</i></tt>'s
worth of elements. These two pieces then flank
<tt>sequence</tt>
on either end. The left half of
<tt><i>boundary</i></tt>
is effectively prepended to the sequence, and the right half
effectively appended.
When the sliding window extends beyond the boundary of
<tt><i>sequence</i></tt>
near its start or end, the window is populated from these
flanking elements obtained from
<tt><i>boundary</i></tt>.
</p><p>
If
<tt><i>boundary</i></tt>
is the keyword
<tt>:wrap</tt>,
then the sequence is effectively flanked by copies of itself on both
ends, repeated enough times to satisfy the window. For instance if
the sequence is
<tt>(1 2 3)</tt>
and the window size is 9 due to the value of
<tt><i>range</i></tt>
being 7, then the behavior of
<tt>:wrap</tt>
is as if a
<tt><i>boundary</i></tt>
were specified consisting of
<tt>(3 1 2 3 1 2 3 1)</tt>.
The left flank is
<tt>(3 1 2 3)</tt>
and the right flank is
<tt>(1 2 3 4)</tt>
formed by repetitions of
<tt>(1 2 3)</tt>
surrounding it on either side, extending out to infinity, and chopped to
<tt><i>range</i></tt>.
</p><p>
If
<tt><i>boundary</i></tt>
is the keyword
<tt>:reflect</tt>,
then the sequence is effectively flanked by reversed copies of itself
on both ends, repeated enough times to satisfy the window.
For instance if the sequence is
<tt>(1 2 3)</tt>
and the window size is 9, then the behavior of
<tt>:reflect</tt>
is as if a
<tt><i>boundary</i></tt>
were specified consisting of
<tt>(1 3 2 1 3 2 1 3)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0030734D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.52">9.22.52<=
/a> Function <tt>interpose</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(interpose </tt><tt><i>sep</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose=
</a></tt>
function returns a sequence of the same type as
<tt><i>sequence</i></tt>,
in which the elements from
<tt><i>sequence</i></tt>
appear with the
<tt><i>sep</i></tt>
value inserted
between them.
</p><p>
If
<tt><i>sequence</i></tt>
is an empty sequence or a sequence of length 1, then a
sequence identical to
<tt><i>sequence</i></tt>
is returned. It may be a copy of
<tt><i>sequence</i></tt>
or it may be
<tt><i>sequence</i></tt>
itself.
</p><p>
If
<tt><i>sequence</i></tt>
is a character string, then the value
<tt><i>sep</i></tt>
must be a character.
</p><p>
It is permissible for
<tt><i>sequence</i></tt>,
or for a suffix of
<tt><i>sequence</i></tt>
to be a lazy
list, in which case interpose returns a lazy list, or a list with a lazy
suffix.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
30734D">interpose</a> #\- "xyz") -&gt; "x-y-z"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose<=
/a> t nil) -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose<=
/a> t #()) -&gt; #()
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose<=
/a> #\a "") -&gt; ""
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose<=
/a> t (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range<=
/a> 0 0)) -&gt; (0)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose<=
/a> t (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range<=
/a> 0 1)) -&gt; (0 t 1)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0030734D">interpose<=
/a> t (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range<=
/a> 0 2)) -&gt; (0 t 1 t 2)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00FB426F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.53">9.22.53<=
/a> Functions <tt>reduce-left</tt> and <tt>reduce-right</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(reduce-left </tt><tt><i>binary-function</i></tt><tt> </tt>=
<tt><i>list</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp; [</tt><tt><i>init-value</i></tt><tt> [</tt><tt><i>key-functio=
n</i></tt><tt>]])=20

</tt></p><p><tt>



<br>&nbsp;&nbsp;(reduce-right </tt><tt><i>binary-function</i></tt><tt> </tt=
><tt><i>list</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp; [</tt><tt><i>init-value</i></tt><tt> [</tt><tt><i>key-f=
unction</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-le=
ft</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-ri=
ght</a></tt>
functions reduce lists of operands specified
by
<tt><i>list</i></tt>
and
<tt><i>init-value</i></tt>
to a single value by the repeated application of
<tt><i>binary-function</i></tt>.
</p><p>
An effective list of operands is formed by combining
<tt><i>list</i></tt>
and
<tt><i>init-value</i></tt>.
If
<tt><i>key-function</i></tt>
is specified, then the items of
<tt><i>list</i></tt>
are
mapped to new values through
<tt><i>key-function</i></tt>,
as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a=
></tt>.
If
<tt><i>init-value</i></tt>
is supplied,
then in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-le=
ft</a></tt>,
the effective list of operands is formed by
prepending
<tt><i>init-value</i></tt>
to
<tt><i>list</i></tt>.
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-ri=
ght</a></tt>,
the effective operand list is produced by appending
<tt><i>init-value</i></tt>
to
<tt><i>list</i></tt>.
The
<tt><i>init-value</i></tt>
isn't mapped through
<tt><i>key-function</i></tt>.
</p><p>
The production of the effective list can be expressed like this,
though this is not to be understood as the actual implementation:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
14162F">append</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003=
9">if</a> init-value-present (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0206CE91">list</a> init-value))
          [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">ma=
pcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> =
key-function identity) list]))))
</tt></pre><tt>

</tt>

<p>
In the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-ri=
ght</a></tt>
case, the arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>
are reversed.
</p><p>
If the effective list of operands is empty, then
<tt><i>binary-function</i></tt>
is called
with no arguments at all, and its value is returned. This is the only
case in which
<tt><i>binary-function</i></tt>
is called with no arguments; in all
remaining cases, it is called with two arguments.
</p><p>
If the effective list contains one item, then that item is returned.
</p><p>
Otherwise, the effective list contains two or more items, and is decimated =
as
follows.
</p><p>
Note that an
<tt><i>init-value</i></tt>
specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is not the same as a missing
<tt><i>init-value</i></tt>;
this means that the initial value is the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Omitting
<tt><i>init-value</i></tt>
is the same as specifying a value of
<tt>:</tt>
(the colon symbol).
It is possible to specify
<tt><i>key-function</i></tt>
while omitting an
<tt><i>init-value</i></tt>
argument. This is achieved by explicitly specifying
<tt>:</tt>
as the
<tt><i>init-value</i></tt>
argument.
</p><p>
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-le=
ft</a></tt>,
the leftmost pair of operands is removed
from the list and passed as arguments to
<tt><i>binary-function</i></tt>,
in the same order
that they appear in the list, and the resulting value initializes an
accumulator. Then, for each remaining item in the list,
<tt><i>binary-function</i></tt>
is invoked on two arguments: the current accumulator value, and the next el=
ement
from the list. After each call, the accumulator is updated with the return
value of
<tt><i>binary-function</i></tt>.
The final value of the accumulator is returned.
</p><p>
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-ri=
ght</a></tt>,
the list is processed right to left.  The rightmost
pair of elements in the effective list is removed, and passed as arguments =
to
<tt><i>binary-function</i></tt>,
in the same order that they appear in the list. The
resulting value initializes an accumulator. Then, for each remaining item i=
n
the list,
<tt><i>binary-function</i></tt>
is invoked on two arguments:  the
next element from the list, in right to left order, and the current
accumulator value. After each call, the accumulator is updated with the ret=
urn
value of
<tt><i>binary-function</i></tt>.
The final value of the accumulator is returned.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;;; effective list is (1) so 1 is returned
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-lef=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a=
> +) () 1 nil)  -&gt;  1

  ;;; computes (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> 0 1) 2) 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-lef=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a=
> -) '(1 2 3) 0 nil) -&gt; -6

  ;;; computes (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-=
</a> 1 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> 2 (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> 3 0)))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-rig=
ht</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</=
a> -) '(1 2 3) 0 nil) -&gt; 2

  ;;; computes (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F=
7">*</a> 1 2 3)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-lef=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a=
> *) '((1) (2) (3)) nil (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-006E109C">fun</a> first)) -&gt; 6

  ;;; computes 1 because the effective list is empty
  ;;; and so * is called with no arguments, which yields 1.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-lef=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a=
> *) nil)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03D4DD08">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.54">9.22.54<=
/a> Functions <tt>some</tt>, <tt>all</tt> and <tt>none</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(some </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>predic=
ate-fun</i></tt><tt> [</tt><tt><i>key-fun</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(all </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>predica=
te-fun</i></tt><tt> [</tt><tt><i>key-fun</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(none </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>predic=
ate-fun</i></tt><tt> [</tt><tt><i>key-fun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a></tt>
functions apply a predicate test function
<tt><i>predicate-fun</i></tt>
over a list of elements.  If the argument
<tt><i>key-fun</i></tt>
is
specified, then elements of
<tt><i>sequence</i></tt>
are passed into
<tt><i>key-fun</i></tt>,
and
<tt><i>predicate-fun</i></tt>
is
applied to the resulting values. If
<tt><i>key-fun</i></tt>
is omitted, the behavior is
as if
<tt><i>key-fun</i></tt>
is the identity function. If
<tt><i>predicate-fun</i></tt>
is omitted,
the behavior is as if
<tt><i>predicate-fun</i></tt>
is the identity function.
</p><p>
These functions have short-circuiting semantics and return conventions simi=
lar
to the and and or operators.
</p><p>
The some function applies
<tt><i>predicate-fun</i></tt>
to successive values
produced by retrieving elements of
<tt><i>list</i></tt>
and processing them through
<tt><i>key-fun</i></tt>.
If the list is empty, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise it returns the
first
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
return value returned by a call to
<tt><i>predicate-fun</i></tt>
and
stops evaluating more elements. If
<tt><i>predicate-fun</i></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for all
elements, it returns
<tt><i>nil</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a></tt>
function applies
<tt><i>predicate-fun</i></tt>
to successive values
produced by retrieving elements of
<tt><i>list</i></tt>
and processing them through
<tt><i>key-fun</i></tt>.
If the list is empty, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise, if
<tt><i>predicate-fun</i></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for any value, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a></tt>
function immediately
returns without invoking
<tt><i>predicate-fun</i></tt>
on any more elements.
If all the elements are processed, then the all function returns
the value which
<tt><i>predicate-fun</i></tt>
yielded for the last element.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a></tt>
function applies
<tt><i>predicate-fun</i></tt>
to successive values
produced by retrieving elements of
<tt><i>list</i></tt>
and processing them through
<tt><i>key-fun</i></tt>.
If the list is empty, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise, if
<tt><i>predicate-fun</i></tt>
yields
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
for any value, the none function
immediately returns nil. If
<tt><i>predicate-fun</i></tt>
yields nil for all
values, the none function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; some of the integers are odd
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a> '(2 4=
 6 9) oddp] -&gt; t

  ;; none of the integers are even
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0054">none</a> '(1 3=
 4 7) evenp] -&gt; t
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-034946BA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.55">9.22.55<=
/a> Function <tt>multi</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(multi </tt><tt><i>function</i></tt><tt> </tt><tt><i>sequen=
ce</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034946BA">multi</a>=
</tt>
function distributes an arbitrary list processing function
<tt><i>multi</i></tt>
over multiple sequences given by the
<tt><i>list</i></tt>
arguments.
</p><p>
The
<tt><i>sequence</i></tt>
arguments are first transposed into a single list of tuples. Each
successive element of this transposed list consists of a tuple of the
successive items from the lists. The length of the transposed list is that
of the shortest
<tt><i>list</i></tt>
argument.
</p><p>
The transposed list is then passed to
<tt><i>function</i></tt>
as an argument.
</p><p>
The
<tt><i>function</i></tt>
is expected to produce a list of tuples, which are transposed
again to produce a list of lists which is then returned.
</p><p>
Conceptually, the input sequences are columns and
<tt><i>function</i></tt>
is invoked on
a list of the rows formed from these columns. The output of
<tt><i>function</i></tt>
is a transformed list of rows which is reconstituted into a list of columns=
.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Take three lists in parallel, and remove from all of=
 them
  ;; them the element at all positions where the third list
  ;; has an element of 20.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034946BA">multi</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> remov=
e-if (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> =
eql 20) @1 third)
         '(1 2 3)
         '(a b c)
         '(10 20 30))

  -&gt; ((1 3) (a c) (10 30))

  ;; The (2 b 20) "row" is gone from the three "columns".

  ;; Note that the (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006=
8EA9D">op</a> remove if (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0068EA9D">op</a> eql 20) @1 third)
  ;; expression can be simplified using the ap operator:
  ;;
  ;; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> =
remove-if (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap=
</a> eql @3 20))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01FE5176">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.56">9.22.56<=
/a> Functions <tt>sort</tt> and <tt>nsort</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sort </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>lessfu=
n</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(nsort </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>lessf=
un</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>
function destructively sorts
<tt><i>sequence</i></tt>,
producing a sequence
which is sorted according to the
<tt><i>lessfun</i></tt>
and
<tt><i>keyfun</i></tt>
arguments.
</p><p>
The
<tt><i>keyfun</i></tt>
argument specifies a function which is applied to elements
of the sequence to obtain the key values which are then compared
using the lessfun. If
<tt><i>keyfun</i></tt>
is omitted, the identity function is used
by default: the sequence elements themselves are their own sort keys.
</p><p>
The
<tt><i>lessfun</i></tt>
argument specifies the comparison function which determines
the sorting order. It must be a binary function which can be invoked
on pairs of keys as produced by the key function. It must
return a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value if the left argument is considered to be lesser
than the right argument. For instance, if the numeric function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
is used
on numeric keys, it produces an ascending sorted order. If the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
is used, then a descending sort is produced. If
<tt><i>lessfun</i></tt>
is omitted, then it defaults to the generic
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
function has the same argument requirements as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>
but is non-destructive: it returns a new object, leaving the input
<tt><i>sequence</i></tt>
unmodified, as if a copy of the input object were made using the
function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
and then that copy were sorted in-place using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>
functions are stable for sequences which are lists. This means that the
original order of items which are considered identical is preserved.
For strings and vectors,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
is not stable.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>
functions can be applied to hashes. It produces meaningful behavior
for a hash table which contains
<i>N</i>

keys which are the integers from 0 to
<i>N - 1</i>.

Such as hash is treated as if it were a vector. The values are sorted
and re-assigned to sorted order to the integer keys.
The behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
is not specified for hashes whose contents do not conform to this conventio=
n.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>
was introduced in <b>TXR</b> 238. Prior to that version,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
behaved like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00091853">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.57">9.22.57<=
/a> Function <tt>grade</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(grade </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>lessf=
un</i></tt><tt> [</tt><tt><i>keyfun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00091853">grade</a>=
</tt>
function returns a list of integer indices which indicate the position
of the elements of
<tt><i>sequence</i></tt>
in sorted order.
</p><p>
The
<tt><i>lessfun</i></tt>
and
<tt><i>keyfun</i></tt>
arguments behave like those of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
function.
</p><p>
The
<tt><i>sequence</i></tt>
object is not modified.
</p><p>
The internal sort performed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00091853">grade</a>=
</tt>
is not stable. The indices of any elements considered equivalent under
<tt>lessfun</tt>
may appear in any order in the returned index sequence.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00091853">grade</a>=
</tt>
function is inspired by the "grade up" and "grade down" operators
in the APL language.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Order of the 2 3 positions of the "l"
  ;; characters is not specified:

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00091853">grade</a> =
"Hello"] -&gt; (0 1 2 3 4)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00091853">grade</a> =
"Hello" &gt;] -&gt; (4 2 3 1 0)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01F12561">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.58">9.22.58<=
/a> Functions <tt>shuffle</tt> and <tt>nshuffle</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(shuffle </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>ran=
dom-state</i></tt><tt>])=20




<br>&nbsp;&nbsp;(nshuffle </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>ra=
ndom-state</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">nshuffle<=
/a></tt>
function pseudo-randomly rearranges the elements of
<tt><i>sequence</i></tt>.
This is performed in place:
<tt><i>sequence</i></tt>
object is modified.
</p><p>
The return value is
<tt><i>sequence</i></tt>
itself.
</p><p>
The rearrangement depends on pseudo-random numbers obtained from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A57C86">rand</a><=
/tt>
function. The
<tt><i>random-state</i></tt>
argument, if present, is passed to that function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">nshuffle<=
/a></tt>
function supports hash tables in a manner analogous to the way
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">nsort</a>=
</tt>
supports hash tables; the same remarks apply as in the description
of that function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">shuffle</=
a></tt>
function has the same argument requirements and
semantics, but differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">nshuffle<=
/a></tt>
in that it avoids in-place modification of
<tt><i>sequence</i></tt>:
a new, shuffled sequence is returned, as if a copy of
<tt><i>sequence</i></tt>
were made using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy</a><=
/tt>
and then that copy were shuffled in-place and returned.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">nshuffle<=
/a></tt>
was introduced in <b>TXR</b> 238. Prior to that version,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">shuffle</=
a></tt>
behaved like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">nshuffle<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01E65DDC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.59">9.22.59<=
/a> Function <tt>sort-group</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sort-group </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>=
keyfun</i></tt><tt> [</tt><tt><i>lessfun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E65DDC">sort-grou=
p</a></tt>
function sorts
<tt><i>sequence</i></tt>
according to the
<tt><i>keyfun</i></tt>
and
<tt><i>lessfun</i></tt>
arguments, and then breaks the resulting sequence into groups,
based on the equivalence of the elements under
<tt><i>keyfun</i></tt>.
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
E65DDC">sort-group</a> sq lf kf)

  &lt;--&gt;

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000167DF">partition-=
by</a> kf (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">so=
rt</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036CED9">copy<=
/a> sq) kf lf))
</tt></pre><tt>

</tt>

<p>
Note the reversed order of
<tt><i>keyfun</i></tt>
and
<tt><i>lessfun</i></tt>
arguments between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E65DDC">sort-grou=
p</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03B6D456">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.60">9.22.60<=
/a> Function <tt>uniq</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(uniq </tt><tt><i>sequence</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6D456">uniq</a><=
/tt>
function returns a sequence of the same kind as
<tt><i>sequence</i></tt>,
but with
duplicates removed. Elements of
<tt><i>sequence</i></tt>
are considered equal under
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function. The first occurrence of each element is retained,
and the subsequent duplicates of that element, of any, are suppressed,
such that the order of the elements is otherwise preserved.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6D456">uniq</a><=
/tt>
function is an alias for the one-argument case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0028147F">unique</a=
></tt>.
That is to say, this equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
B6D456">uniq</a> s) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-0028147F">unique</a> s)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0028147F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.61">9.22.61<=
/a> Function <tt>unique</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(unique </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>keyf=
un</i></tt><tt> {</tt><tt><i>hash-arg</i></tt><tt>}* ])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0028147F">unique</a=
></tt>
function is a generalization of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6D456">uniq</a><=
/tt>.
It returns a sequence of the same kind as
<tt><i>sequence</i></tt>,
but with duplicates removed.
</p><p>
If neither
<tt><i>keyfun</i></tt>
nor
<tt><i>hash-arg</i></tt>-s
are specified, then elements of sequence are considered equal under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
function. The first occurrence of each element is retained,
and the subsequent duplicates of that element, of any, are suppressed,
such that the order of the elements is otherwise preserved.
</p><p>
If
<tt><i>keyfun</i></tt>
is specified, then that function is applied to each element,
and the resulting values are compared for equality.
In other words, the behavior is as if
<tt><i>keyfun</i></tt>
were the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function.
</p><p>
If one or more
<tt><i>hash-arg</i></tt>-s
are present, these specify the arguments for the construction of
the internal hash table used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0028147F">unique</a=
></tt>.
The arguments are like those of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-00C801EF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.62">9.22.62<=
/a> Function <tt>tuples</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tuples </tt><tt><i>length</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt> [</tt><tt><i>fill-value</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C801EF">tuples</a=
></tt>
function produces a lazy list which represents a reorganization
of the elements of
<tt><i>sequence</i></tt>
into tuples of
<tt><i>length</i></tt>,
where
<tt><i>length</i></tt>
must be a positive integer.
</p><p>
The length of the sequence might not be evenly divisible by the tuple lengt=
h.
In this case, if a
<tt><i>fill-value</i></tt>
argument is specified, then the last tuple
is padded with enough repetitions of
<tt><i>fill-value</i></tt>
to make it have
<tt><i>length</i></tt>
elements. If
<tt><i>fill-value</i></tt>
is not specified, then the last tuple is left
shorter than
<tt><i>length</i></tt>.
</p><p>
The output of the function is a list, but the tuples themselves are sequenc=
es
of the same kind as
<tt><i>sequence</i></tt>.
If
<tt><i>sequence</i></tt>
is any kind of list, they
are lists, and not lazy lists.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
C801EF">tuples</a> 3 #(1 2 3 4 5 6 7 8) 0) -&gt; (#(1 2 3) #(4 5 6)
                                      #(7 8 0))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C801EF">tuples</a>=
 3 "abc") -&gt; ("abc")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C801EF">tuples</a>=
 3 "abcd") -&gt; ("abc" "d")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C801EF">tuples</a>=
 3 "abcd" #\z) -&gt; ("abc" "dzz")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C801EF">tuples</a>=
 3 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> =
1 2) #\z) -&gt; ((1 2 #\z))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-000167DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.22.63">9.22.63<=
/a> Function <tt>partition-by</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(partition-by </tt><tt><i>function</i></tt><tt> </tt><tt><i=
>sequence</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>sequence</i></tt>
is empty, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000167DF">partition=
-by</a></tt>
returns an empty list,
and
<tt><i>function</i></tt>
is never called.
</p><p>
Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000167DF">partition=
-by</a></tt>
returns a lazy list of partitions of the sequence
<tt><i>sequence</i></tt>.
Partitions are consecutive, non-empty sub-strings of
<tt><i>sequence</i></tt>,
of the same kind as
<tt><i>sequence</i></tt>.
</p><p>
The partitioning begins with the first element of
<tt><i>sequence</i></tt>
being placed into a partition.
</p><p>
The subsequent partitioning is done according to
<tt><i>function</i></tt>,
which is applied
to each element of
<tt><i>sequence</i></tt>.
Whenever, for the next element, the function
returns the same value as it returned for the previous element, the
element is placed into the same partition. Otherwise, the next element
is placed into, and begins, a new partition.
</p><p>
The return values of the calls to
<tt><i>function</i></tt>
are compared using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
0167DF">partition-by</a> identity '(1 2 3 3 4 4 4 5)] -&gt; ((1) (2) (3 3)
                                                 (4 4 4) (5))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000167DF">partition-=
by</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a=
> =3D 3) #(1 2 3 4 5 6 7)) -&gt; (#(1 2) #(3)
                                               #(4 5 6 7))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-0372EA61">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23">9.23</a> Op=
en Sequence Traversal</h3>



<p>


</p><p>
Functions in this category perform efficient traversal of sequences.
</p><p>
There are two flavors of these functions: functions in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
group, and functions in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068A845">seq-begin=
</a></tt>
group. The latter are obsolescent.
</p><p>
Application-defined iteration is possible via defining special methods on
structures. An object supports iteration by defining the special method
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
which is different from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
function. This special function returns an iterator object which supports
special methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>.
Two protocols are supported, one of which is more efficient by eliminating =
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method. Details are specified in the section
<b>Special Structure Functions</b>.

</p><p>

<a name=3D"N-024C86F4">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.1">9.23.=
1</a> Function <tt>iter-begin</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iter-begin </tt><tt><i>seq</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
function returns an iterator object specialized for the task of traversing =
the
<tt><i>seq</i></tt>
object. The
<tt><i>seq</i></tt>
argument may be any sequence. Additionally, it may be a character, number o=
r
a numeric or character range.
</p><p>
Note: if
<tt><i>seq</i></tt>
is a list-like sequence, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
may return
<tt><i>seq</i></tt>
itself as the iterator. Likewise if
<tt><i>seq</i></tt>
is a number.
</p><p>
A range is considered to be a numeric or character range if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
element is a number or character. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
is then required to to be either value which is comparable with that number
or character using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
function, or else it must be one of the two objects
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt>:</tt>,
either of which indicate that the range is unbounded. In this unbounded ran=
ge
case, the expressions
<tt>(iter-begin X..:)</tt>
and
<tt>(iter-begin X..t)</tt>
are equivalent to
<tt>(iter-begin X)</tt>.
</p><p>
If
<tt><i>seq</i></tt>
is a structure which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
method, then that method is called and its return value is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03B6130D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.2">9.23.2</a=
> Function <tt>iter-more</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iter-more </tt><tt><i>iter</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if there remain more elements to be traversed.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>iter</i></tt>
argument must be a valid iterator returned by a call to
<tt><i>iter-begin</i></tt>,
<tt><i>iter-step</i></tt>
or
<tt><i>iter-reset</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function doesn't change the state of
<tt><i>iter</i></tt>.
</p><p>
If
<tt>iter</tt>
is the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
may return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if its argument is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or any empty sequence, or an empty range (a range whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
fields are the same number or character).
</p><p>
If
<tt><i>iter</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
If
<tt><i>iter</i></tt>
is a number, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
This is the case even if calculating the successor of that number isn't pos=
sible
due to floating-point overflow or insufficient system resources.
</p><p>
If
<tt><i>iter</i></tt>
is a character, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>iter</i></tt>
isn't the highest possible character code, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>iter</i></tt>
was formed from a descending range, meaning that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
was invoked on a range with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
fielding exceeding its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
value, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
returns true while the current iterator value is greater than the
the limiting value given by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
field. For an ascending range, it returns true if the current iterator valu=
e is
lower than the limiting value. However, note the peculiar semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
with regard to descending range iteration.
</p><p>
If
<tt><i>iter</i></tt>
is a structure, then if it supports an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method, then that method is called with no arguments, and its return value
is returned. If the structure does not have an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
method, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-0036122B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.3">9.23.3</a=
> Function <tt>iter-item</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iter-item </tt><tt><i>iter</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function indicates that more items remain to be visited, then
the next item can be retrieved using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>.
</p><p>
The
<tt><i>iter</i></tt>
argument must be a valid iterator returned by a call to
<tt><i>iter-begin</i></tt>,
<tt><i>iter-step</i></tt>
or
<tt><i>iter-reset</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function doesn't change the state of
<tt><i>iter</i></tt>.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
is invoked on an iterator which indicates that no more items
remain to be visited, the return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>iter</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
returns the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of that cell.
</p><p>
If
<tt><i>iter</i></tt>
is a character or number, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
returns that character or number itself.
</p><p>
If
<tt><i>iter</i></tt>
is based on an ascending numeric or character range, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
returns the current iteration value, which is initialized by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
as a copy of the range's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
field. Thus, the range
<tt>0..3</tt>
traverses the values
<tt>0</tt>,
<tt>1</tt>
and
<tt>2</tt>,
excluding the
<tt>3</tt>.
</p><p>
If
<tt><i>iter</i></tt>
is based on a descending numeric or character range, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
returns the predecessor of the current iteration value, which is initialize=
d
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
as a copy of the range's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
field.
Thus, the range
<tt>3..0</tt>
traverses the values
<tt>2</tt>,
<tt>1</tt>
and
<tt>0</tt>,
excluding the
<tt>3</tt>:
exactly the same values are visited as for the range
<tt>0..3</tt>
only in reverse order.
</p><p>
If
<tt><i>iter</i></tt>
is a structure which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0008">iter-item</a>=
</tt>
method, then that method is called and its return value is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-0205F7AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.4">9.23.4</a=
> Function <tt>iter-step</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iter-step </tt><tt><i>iter</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0073">iter-more</a>=
</tt>
function indicates that more items remain to be visited, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
function may be used to consume the next item.
</p><p>
The function returns an iterator denoting the traversal of the
remaining items in the sequence.
</p><p>
The
<tt><i>iter</i></tt>
argument must be a valid iterator returned by a call to
<tt><i>iter-begin</i></tt>,
<tt><i>iter-step</i></tt>
or
<tt><i>iter-reset</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
function may return a new object, in which case it avoids
changing the state of
<tt><i>iter</i></tt>,
or else it may change the state of
<tt><i>iter</i></tt>
and return it.
</p><p>
If the application discontinues the use of
<tt><i>iter</i></tt>,
and continues the
traversal using the returned iterator, it will work correctly in either
situation.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
is invoked on an iterator which indicates that no more items
remain to be visited, the return value is unspecified.
</p><p>
If
<tt><i>iter</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
returns the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field of that cell. That value must itself be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
otherwise an error is thrown. This is to prevent iteration
from wrongly iterating into the non-null terminators of improper
lists. Without this rule, iteration of a list like
<tt>(1 2 . 3)</tt>
would reach the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell
<tt>(2 . 3)</tt>
at which point a subsequent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
would return the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field
<tt>3</tt>.
But that value is a valid iterator which will then continue by
stepping through
<tt>4</tt>,
<tt>5</tt>
and so on.
</p><p>
If
<tt><i>iter</i></tt>
is a list-like sequence, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is invoked on it and that value is returned.
The value must also be a list-like sequence, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The reasoning for this is the same as for the similar
restriction imposed in the case when
<tt><i>iter</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>.
</p><p>
If
<tt><i>iter</i></tt>
is a character or number, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
returns its successor, as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">succ</a><=
/tt>
function.
</p><p>
If
<tt><i>iter</i></tt>
is a structure which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005E">iter-step</a>=
</tt>
method, then that method is called and its return value is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03EE4725">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.5">9.23.5</a=
> Function <tt>iter-reset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iter-reset </tt><tt><i>iter</i></tt><tt> </tt><tt><i>seq</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
function returns an iterator object specialized for the task of traversing
the sequence
<tt><i>seq</i></tt>.
</p><p>
If it is possible for
<tt><i>iter</i></tt>
to be that object, then the function may adjust the state of
<tt><i>iter</i></tt>
and return it.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
doesn't use
<tt><i>iter</i></tt>,
then it behaves exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
being invoked on
<tt><i>seq</i></tt>.
</p><p>
If
<tt><i>seq</i></tt>
is a structure which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
method, then that method is called and its return value is returned.
Note the reversed arguments. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
method is of the
<tt><i>seq</i></tt>
object, not of
<tt><i>iter</i></tt>.
That is to say, the call
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a> <=
/tt><tt><i>iter</i></tt><tt> </tt><tt><i>obj)</i></tt><tt>=20

</tt>

results in the
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-003F">iter-reset</a> </tt><tt><i>iter</i></tt><tt>)=20

</tt>

call. If
<tt><i>seq</i></tt>
is a structure which doesn't support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003F">iter-reset</a=
></tt>
then
<tt><i>iter</i></tt>
is ignored,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0051">iter-begin</a=
></tt>
is invoked on
<tt><i>seq</i></tt>
and the result is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-0068A845">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.6">9.23.6</a=
> Function <tt>seq-begin</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(seq-begin </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The obsolescent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068A845">seq-begin=
</a></tt>
function returns an iterator object specialized to the task of traversing
the sequence represented by the input
<tt><i>object</i></tt>.
</p><p>
If
<tt><i>object</i></tt>
isn't a sequence, an exception is thrown.
</p><p>
Note that if
<tt><i>object</i></tt>
is a lazy list, the returned iterator maintains a reference to the
head of that list during the traversal; therefore, generic iteration
based on iterators from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068A845">seq-begin=
</a></tt>
is not suitable for indefinite iteration over infinite lists.
</p><p>

</p></dd></dl>
<a name=3D"N-02E3D643">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.7">9.23.7</a=
> Function <tt>seq-next</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(seq-next </tt><tt><i>iter</i></tt><tt> </tt><tt><i>end-val=
ue</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The obsolescent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3D643">seq-next<=
/a></tt>
function retrieves the next available item from the sequence iterated by
<tt><i>iter</i></tt>,
which must be an object returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068A845">seq-begin=
</a></tt>.
</p><p>
If the sequence has no more items to be traversed, then
<tt><i>end-value</i></tt>
is returned instead.
</p><p>
Note: to avoid ambiguities, the application should provide an
<tt><i>end-value</i></tt>
which is guaranteed distinct from any item in the sequence, such as a
freshly allocated object.
</p><p>

</p></dd></dl>
<a name=3D"N-01CA6912">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.23.8">9.23.8</a=
> Function <tt>seq-reset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(seq-reset </tt><tt><i>iter</i></tt><tt> </tt><tt><i>object=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The obsolescent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CA6912">seq-reset=
</a></tt>
re-initializes the existing iterator object
<tt><i>iter</i></tt>
to begin a new traversal over the given
<tt><i>object</i></tt>,
which must be a value of a kind that would be a suitable argument for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068A845">seq-begin=
</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CA6912">seq-reset=
</a></tt>
function returns
<tt><i>iter</i></tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-00F51820">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24">9.24</a> Pr=
ocedural List Construction</h3>



<p>


</p><p>
<b>TXR Lisp</b> provides an a structure type called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
which encapsulates state and methods for constructing lists procedurally.
Among the advantages of using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
is that lists can be constructed in the left to right direction without
requiring multiple traversals or reversal. For example,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
naturally combines with iteration or recursion: items visited in an
iterative or recursive process can be collected easily using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
in the order they are visited.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
type provides methods for adding and removing items at either end of
the list, making it suitable where a
<i>dequeue</i>

structure is required.
</p><p>
The basic workflow begins with the instantiation of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object. This object may be initialized with a piece of list material which
begins the to-be-constructed list, or it may be initialized to begin with a=
n
empty list.  Methods such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a><=
/tt>
are invoked on this object to extend the list with new elements.  At any po=
int,
the list constructed so far is available using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a></=
tt>
method, which is also how the final version of the list is eventually
retrieved.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
methods which add material to the list all return the list builder,
making chaining possible.
</p><p>
<tt>
</tt></p><pre><tt>   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
230059D">new</a> list-builder).(<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-03244398">add</a> 1).(<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-03244398">add</a> 2).(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-03975507">pend</a> '(3 4 5)).(<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-03D9F55D">get</a>)
   -&gt; (1 2 3 4 5)
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a>=
</tt>
macro is provided which syntactically streamlines the process.
It implicitly creates a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
instance and binds it to a hidden lexical variable.
It then evaluates forms in a lexical scope in which
short-hand macros are available for building the list.
</p><p>

<a name=3D"N-018F6666">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.1">9.24.=
1</a> Structure <tt>list-builder</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct list-builder nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;head tail)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
structure encapsulates the state for a list building process.
Programs should use the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a></tt>
function for creating an instance of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>.
The
<tt>head</tt>
and
<tt>tail</tt>
slots should be regarded as internal variables.
</p><p>

</p></dd></dl>
<a name=3D"N-0315C467">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.2">9.24.2</a=
> Function <tt>build-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(build-list [</tt><tt><i>initial-list</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a></tt>
function instantiates and returns an object of struct type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>.
</p><p>
If no
<tt><i>initial-list</i></tt>
argument is supplied, then the object is implicitly
with an empty list.
</p><p>
If the argument is supplied, then it is equivalent
to calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a></tt>
without an argument to produce an object
<tt><i>obj</i></tt>
the invoking the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-022F6E60">ncon</a> </tt><tt><i>initial-list</i></tt><tt>)=20

</tt>

on this object. The object produced by the expression
<tt><i>list</i></tt>
is installed (without being copied) into the
object as the prefix of the list to be constructed.
</p><p>
The
<tt><i>initial-list</i></tt>
argument can be a sequence other than a list.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>   ;; build the list (a b) trivially

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> (=
(lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-li=
st</a> '(a b))))
     lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get<=
/a>)
   -&gt; (a b)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03244398">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.3">9.24.3</a=
> Methods <tt>add</tt> and <tt>add*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(add </tt><tt><i>elem=
ent</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(add* </tt><tt><i>ele=
ment</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add*</a><=
/tt>
methods extend the list being constructed by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object by adding individual
elements to it. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a></=
tt>
method adds elements at the tail of the list,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add*</a><=
/tt>
adds elements at the front.
</p><p>
These methods return the
<tt><i>list-builder</i></tt>
object.
</p><p>
The precise semantics is as follows.
All of the
<tt><i>element</i></tt>
arguments are combined into a list as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
function, and the resulting list combined with the current contents of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>
function. The resulting list becomes the new contents.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Build the list (1 2 3 4)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a>)))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</=
a> 3 4)
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add*<=
/a> 1 2)
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
  -&gt; (1 2 3 4)

  ;; Add "c" to "abc"
  ;; same semantics as (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0014162F">append</a> "abc" #\c)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a> "ab")))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</=
a> #\c)
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
  -&gt; "abc"
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03975507">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.4">9.24.4</a=
> Methods <tt>pend</tt> and <tt>pend*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(pend </tt><tt><i>lis=
t</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(pend* </tt><tt><i>li=
st</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend*</a>=
</tt>
methods extend the list being constructed by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object by adding lists to it. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a><=
/tt>
method catenates the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
arguments together as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">append</a=
></tt>
function, then appends the resulting list to
the end of the list being constructed.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend*</a>=
</tt>
method is similar, except it prepends the
catenated lists to the front of the list
being constructed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend*</a>=
</tt>
operations do not mutate the input lists, but may cause the
resulting list to share structure with the input lists.
</p><p>
These functions may mutate the list already contained in
<tt><i>list-builder</i></tt>;
however, they avoid mutating those parts of the current list
that are shared with inputs that were given in earlier
calls to these functions.
</p><p>
These methods return the
<tt><i>list-builder</i></tt>
object.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Build the list (1 2 3 4)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a>)))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend<=
/a> '(3 4))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend*=
</a> '(1 2))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
  -&gt; (1 2 3 4)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-022F6E60">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.5">9.24.5</a=
> Methods <tt>ncon</tt> and <tt>ncon*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(ncon </tt><tt><i>lis=
t</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(ncon* </tt><tt><i>li=
st</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*</a>=
</tt>
methods extend the list being constructed by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object by adding lists to it. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon</a><=
/tt>
method destructively catenates the
<tt><i>list</i></tt>
arguments as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162F">nconc</a>=
</tt>
function. The resulting list is appended
to the list being constructed.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*</a>=
</tt>
method is similar, except it prepends
the catenated lists to the front of the
list being constructed.
</p><p>
These methods may destructively manipulate the list already contained in th=
e
<tt><i>list-builder</i></tt>
object, and likewise may destructively manipulate the input lists.
They may cause the list being constructed to share substructure with the in=
put
lists.
</p><p>
Additionally, these methods may destructively manipulate the list already
contained in the
<tt><i>list-builder</i></tt>
object without regard for shared structure between that list and inputs
given earlier any of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend*</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*</a>=
</tt>
functions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*</a>=
</tt>
function can be called with a single argument
which is an atom. This atom will simply be
installed as the terminating atom of the
list being constructed, if the current list is
an ordinary list.
</p><p>
These methods return the
<tt><i>list-builder</i></tt>
object.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Build the list (1 2 3 4 . 5)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a>)))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a=
> 1 2))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 3 4))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon<=
/a> 5)
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
  -&gt; (1 2 3 4 . 5)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03D9F55D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.6">9.24.6</a=
> Method <tt>get</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(get)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a></=
tt>
method retrieves the list constructed so far by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object. It doesn't change the state of the object.
The retrieved list may be passed as an argument
into the construction methods on the same object.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Build the circular list (1 1 1 1 ...)
  ;; by appending (1) to itself destructively:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a> '(1))))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*=
</a> lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get<=
/a>))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
  -&gt; (1 1 1 1 ...)

  ;; build the list (1 2 1 2 1 2 1 2)
  ;; by doubling (1 2) twice:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
lb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a>)))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</=
a> 1 2)
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend<=
/a> lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend<=
/a> lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
    lb.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</=
a>))
  -&gt; (1 2 1 2 1 2 1 2)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0166445C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.7">9.24.7</a=
> Methods <tt>del</tt> and <tt>del*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(del)=20




<br>&nbsp;&nbsp;</tt><tt><i>list-builder</i></tt><tt>.(del*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166445C">del*</a><=
/tt>
methods each remove an element from the list and return it.
If the list is empty, they return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
method removes an element from the front of the list, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166445C">del*</a><=
/tt>
removes an element from the end of the list.
</p><p>
Note: this orientation is opposite to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add*</a><=
/tt>.
Thus
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
pairs with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a></=
tt>
to produce FIFO queuing behavior.
</p><p>

</p></dd></dl>
<a name=3D"N-01346AAA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.24.8">9.24.8</a=
> Macros <tt>build</tt> and <tt>buildn</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(build </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(buildn </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">buildn</a=
></tt>
macros provide a shorthand notation for constructing lists using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
structure. They eliminate the explicit call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315C467">build-lis=
t</a></tt>
function to construct the object, and eliminate the explicit
references to the object.
</p><p>
Both of these macros create a lexical environment in which a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object is implicitly constructed and bound to a hidden variable.
This lexical environment also provides local functions named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add*</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend*</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166445C">del*</a><=
/tt>,
which mimic the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
methods, but operate implicitly on this hidden variable, so that
the object need not be mentioned as an argument.
With the exception of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166445C">del*</a><=
/tt>,
the local functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
unlike like the same-named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
methods, which return the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
object.
</p><p>
In this lexical environment, each
<tt><i>form</i></tt>
is evaluated in order.
</p><p>
When the last
<tt><i>form</i></tt>
is evaluated,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a>=
</tt>
returns the constructed list, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">buildn</a=
></tt>
returns the value of the last
<tt><i>form</i></tt>.
</p><p>
If no forms are enclosed, both macros return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: because the local function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
has the same name as a global macro, it is implemented as a
<tt>macrolet.</tt>
Inside a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a>=
</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">buildn</a=
></tt>,
if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
is invoked with no arguments, then it denotes a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018F6666">list-buil=
der</a></tt>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
method. If invoked with an argument, then it resolves to the global
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
macro for deleting a place.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Build the circular list (1 1 1 1 ...)
  ;; by appending (1) to itself destructively:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a> =
1)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022F6E60">ncon*</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a>)))=
 -&gt; (1 1 1 1 ...)

  ;; build the list (1 2 1 2 1 2 1 2)
  ;; by doubling (1 2) twice:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a> =
1 2)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a>))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03975507">pend</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F55D">get</a>))) =
-&gt; (1 2 1 2 1 2 1 2)

  ;; build a list by mapping over the local
  ;; add function:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">build</a> =
[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a> ad=
d (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a> =
1 3)]) -&gt; (1 2 3)

  ;; breadth-first traversal of nested list;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
bf-map (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree<=
/a> visit-fn)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01346AAA">buildn</=
a>
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">add</a=
> tree)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet=
</a> ((item (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del<=
/a>)))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0076C7BE">atom</a> item=
)
          [visit-fn item]
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">ea=
ch</a> ((el item))
            (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03244398">=
add</a> el))))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> (f=
lat)
    (bf-map '(1 (2 (3 4 (5))) ((6 7) 8)) (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#D-0061">do</a> push @1 flat))
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">nrevers=
e</a> flat))
  -&gt; (1 2 8 3 4 6 7 5)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-02E80A51">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.25">9.25</a> Pe=
rmutations and Combinations</h3>



<p>


</p><p>

<a name=3D"N-0176D3A1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.25.1">9.25.=
1</a> Function <tt>perm</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(perm </tt><tt><i>seq</i></tt><tt> [</tt><tt><i>len</i></tt=
><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188EBDE">rperm</a>=
</tt>
function returns a lazy list which consists of all
length
<tt><i>len</i></tt>
permutations of formed by items taken from
<tt><i>seq</i></tt>.
The permutations do not use any element of
<tt><i>seq</i></tt>
more than once.
</p><p>
Argument
<tt><i>len</i></tt>,
if present, must be a positive integer, and
<tt><i>seq</i></tt>
must be a sequence.
</p><p>
If
<tt><i>len</i></tt>
is not present, then its value defaults to the length of
<tt><i>seq</i></tt>:
the list of the full permutations of the entire sequence is returned.
</p><p>
The permutations in the returned list are sequences of the same kind as
<tt>seq</tt>.
</p><p>
If
<tt><i>len</i></tt>
is zero, then a list containing one permutation is returned, and that
permutation is of zero length.
</p><p>
If
<tt><i>len</i></tt>
exceeds the length of
<tt><i>seq</i></tt>,
then an empty list is returned,
since it is impossible to make a single non-repeating permutation that
requires more items than are available.
</p><p>
The permutations are lexicographically ordered.
</p><p>

</p></dd></dl>
<a name=3D"N-0188EBDE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.25.2">9.25.2</a=
> Function <tt>rperm</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rperm </tt><tt><i>seq</i></tt><tt> </tt><tt><i>len</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188EBDE">rperm</a>=
</tt>
function returns a lazy list which consists of all the repeating
permutations of length
<tt><i>len</i></tt>
formed by items taken from
<tt><i>seq</i></tt>.
"Repeating" means that the items from
<tt><i>seq</i></tt>
can appear more than
once in the permutations.
</p><p>
The permutations which are returned are sequences of the same kind as
<tt><i>seq</i></tt>.
</p><p>
Argument
<tt><i>len</i></tt>
must be a nonnegative integer, and
<tt><i>seq</i></tt>
must be a sequence.
</p><p>
If
<tt><i>len</i></tt>
is zero, then a single permutation is returned, of zero length.
This is true regardless of whether
<tt><i>seq</i></tt>
is itself empty.
</p><p>
If
<tt><i>seq</i></tt>
is empty and
<tt><i>len</i></tt>
is greater than zero, then no permutations are
returned, since permutations of a positive length require items, and the
sequence has no items. Thus there exist no such permutations.
</p><p>
The first permutation consists of
<tt><i>le</i></tt>
repetitions of the first element of
<tt><i>seq</i></tt>.
The next repetition, if there is one, differs from the first
repetition in that its last element is the second element of
<tt><i>seq</i></tt>.
That is to say, the permutations are lexicographically ordered.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
88EBDE">rperm</a> "01" 3) -&gt; ("000" "001" "010" "011"
                     "100" "101" "110" "111")

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188EBDE">rperm</a> =
#(1) 3) -&gt; (#(1 1 1))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188EBDE">rperm</a> =
'(0 1 2) 2) -&gt; ((0 0) (0 1) (0 2) (1 0)
                         (1 1) (1 2) (2 0) (2 1) (2 2))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02E6CEDD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.25.3">9.25.3</a=
> Function <tt>comb</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(comb </tt><tt><i>seq</i></tt><tt> </tt><tt><i>len</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E6CEDD">comb</a><=
/tt>
function returns a lazy list which consists of all
length
<tt><i>len</i></tt>
non-repeating combinations formed by taking items taken from
<tt><i>seq</i></tt>.
"Non-repeating combinations" means that the combinations do not use any
element of
<tt><i>seq</i></tt>
more than once. If
<tt><i>seq</i></tt>
contains no duplicates, then
the combinations contain no duplicates.
</p><p>
Argument
<tt><i>len</i></tt>
must be a nonnegative integer, and
<tt><i>seq</i></tt>
must be a sequence or a hash table.
</p><p>
The combinations in the returned list are objects of the same kind as
<tt><i>seq</i></tt>.
</p><p>
If
<tt><i>len</i></tt>
is zero, then a list containing one combination is returned, and that
combination is of zero length.
</p><p>
If
<tt><i>len</i></tt>
exceeds the number of elements in
<tt><i>seq</i></tt>,
then an empty list is returned, since it is impossible to make a single
non-repeating combination that requires more items than are available.
</p><p>
If
<tt><i>seq</i></tt>
is a sequence, the returned combinations are lexicographically ordered.
This requirement is not applicable when
<tt><i>seq</i></tt>
is a hash table.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>   ;; powerset function, in terms of comb.
   ;; Yields a lazy list of all subsets of s,
   ;; expressed as sequences of the same type as s.

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
 powerset (s)
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend=
*</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a>=
 comb s) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033BE5A1">ran=
ge</a> 0 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length<=
/a> s))))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02D9003C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.25.4">9.25.4</a=
> Function <tt>rcomb</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rcomb </tt><tt><i>seq</i></tt><tt> </tt><tt><i>len</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E6CEDD">comb</a><=
/tt>
function returns a lazy list which consists of all
length
<tt><i>len</i></tt>
repeating combinations formed by taking items taken from
<tt><i>seq</i></tt>.
"Repeating combinations" means that the combinations can use
an element of
<tt><i>seq</i></tt>
more than once.
</p><p>
Argument
<tt><i>len</i></tt>
must be a nonnegative integer, and
<tt><i>seq</i></tt>
must be a sequence.
</p><p>
The combinations in the returned list are sequences of the same kind as
<tt><i>seq</i></tt>.
</p><p>
If
<tt><i>len</i></tt>
is zero, then a list containing one combination is returned, and that
combination is of zero length. This is true even if
<tt><i>seq</i></tt>
is empty.
</p><p>
If
<tt><i>seq</i></tt>
is empty, and
<tt><i>len</i></tt>
is nonzero, then an empty list is returned.
</p><p>
The combinations are lexicographically ordered.
</p><p>
</p><p>
</p></dd></dl>
<a name=3D"N-0137A962">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26">9.26</a> Ma=
cros</h3>



<p>


Because <b>TXR Lisp</b> supports structural macros, <b>TXR</b> processes <b=
>TXR Lisp</b> expressions in
two separate phases: the expansion phase and the evaluation/compilation pha=
se.
During the expansion phase, a top-level expression is recursively traversed=
,
and all macro invocations in it are expanded. The result is a transformed
expression which contains only function calls and invocations of special
operators.  This expanded form is then evaluated or compiled, depending on =
the
situation.
</p><p>
Macro invocations are compound forms and whose operator symbol has a macro
definition in scope.  A macro definition is a kind of function which operat=
es
on syntax during macro-expansion, called upon to calculate a transformation=
 of
the syntax. The return value of a macro replaces its invocation, and is
traversed to look for more opportunities for macro expansion.
Macros differ from ordinary functions in three ways: they are called
at macro-expansion time, they receive pieces of unevaluated syntax as their
arguments, and their parameter lists are macro parameter lists which
support destructuring, as well as certain special parameters.
</p><p>
<b>TXR Lisp</b> also supports symbol macros. A symbol macro definition asso=
ciates
a symbol with an expansion. When that symbol appears as a form, the
macro-expander replaces it with the expansion.
</p><p>
<b>TXR</b> source files are treated somewhat differently with regard to mac=
ro
expansion compared to <b>TXR Lisp</b>. When <b>TXR Lisp</b> forms are read =
from a file by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
or read by the interactive listener, each form is expanded and evaluated
or compiled before the subsequent form is processed. In contrast,
when a <b>TXR</b> file is loaded, expansion of the Lisp forms are its argum=
ents
takes place during the parsing of the entire source file, and is complete
for the entire file before any of the code is executed.
</p><p>
<a name=3D"N-0131EFEE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.1">9.26.=
1</a> Macro parameter lists</h4>


<p>
<b>TXR</b> macros support destructuring, similarly to Common Lisp macros.
This means that macro parameter lists are like function argument lists,
but support nesting. A macro parameter list can specify a nested parameter
list in every place where an argument symbol may appear.  For instance,
consider this macro parameter list:
</p><p>
<tt>
</tt></p><pre><tt>  ((a (b c)) : (c frm) ((d e) frm2 de-p) . g)
</tt></pre><tt>

</tt>

<p>
The top-level of this nested form has the structure
</p><p>
<tt>




&nbsp;&nbsp; (</tt><tt><i>I</i></tt><tt> : </tt><tt><i>J</i></tt><tt> </tt>=
<tt><i>K</i></tt><tt> . </tt><tt><i>L</i></tt><tt>)=20

</tt>

</p><p>
in which we can identify the major constituent positions as
<tt><i>I</i></tt>,
<tt><i>J</i></tt>,
<tt><i>K</i></tt>
and
<tt><i>L</i></tt>.
</p><p>
The constituent at position
<tt><i>I</i></tt>
is the mandatory parameter
<tt>(a (b c))</tt>.
Position
<tt><i>J</i></tt>
holds the optional parameter
<tt>c</tt>
(with default init form
<tt>frm</tt>).
At
<tt><i>K</i></tt>
is found the optional parameter
<tt>(d e)</tt>
(with default init form
<tt>frm2</tt>
and presence-indicating variable
<tt>de-p</tt>).
Finally, the parameter in the dot position
<tt><i>L</i></tt>
is
<tt>g</tt>,
which captures trailing arguments.
</p><p>
Obviously, some of the parameters are compound expressions rather
than symbols:
<tt>(a (b c))</tt>
and
<tt>(d e)</tt>.
These compounds express nested macro parameter lists.
</p><p>
Nested macro parameter lists recursively match the corresponding structure
in the argument object.  For instance if a simple argument would capture
the structure
<tt>(1 (2 3))</tt>
then we can replace the argument with the nested argument list
<tt>(a (b c))</tt>
which destructures the
<tt>(1 (2 3))</tt>
such that the parameters
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>
will end up bound
to
<tt>1</tt>,
<tt>2</tt>
and
<tt>3</tt>,
respectively.
</p><p>
Nested macro parameter lists have all the features of the top-level
macro parameter lists: they can have optional arguments with default
values, use the dotted position, and contain the
<tt>:env</tt>,
<tt>:whole</tt>
and
<tt>:form</tt>
special parameters, which are described below.  In nested parameter lists, =
the binding strictness is relaxed for optional
parameters. If
<tt>(a (b c))</tt>
is optional, and the argument is, say,
<tt>(1)</tt>,
then
<tt>a</tt>
gets
<tt>1</tt>,
and
<tt>b</tt>
and
<tt>c</tt>
receive
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Macro parameter lists also supports three special keywords, namely
<tt>:env</tt>,
<tt>:whole</tt>
and
<tt>:form</tt>.
</p><p>
The parameter list
<tt>(:whole x :env y :form z)</tt>
will bind parameter
<tt>x</tt>
to the entire
macro parameter list, bind parameter
<tt>y</tt>
to the macro environment and bind parameter
<tt>z</tt>
to the entire macro form (the original compound form used to invoke the
macro).
</p><p>
The
<tt>:env</tt>,
<tt>:whole</tt>
and
<tt>:form</tt>
notations can occur anywhere in a macro parameter list, other than
to the right of the consing dot. They can be used in nested
macro parameter lists also.  Note that in a nested macro
parameter list,
<tt>:form</tt>
and
<tt>:env</tt>
do not change meaning: they bind the same object as they would in
the top-level of the macro parameter list.
However the
<tt>:whole</tt>
parameter inside has a restricted scope in a nested parameter
list: its parameter will capture just that part of the argument material wh=
ich
matches that parameter list, rather than the entire argument list.
</p><p>
The processing of macro parameter lists omits the feature that when the
keyword symbol
<tt>:</tt>
(colon) given as the argument to an optional parameter, that argument is
treated as a missing argument. This special logic is implemented only
in the function argument passing mechanism, not in the binding of macro
parameters to object structure. If the colon symbol appears in the object
structure and is matched against an optional parameter, it is an
ordinary value. That parameter is considered present, and takes on
that
<tt>:</tt>
keyword symbol as its value.
</p><p>
</p><dl>
<dt>Dialect Note:</dt><dd>
<p>


</p><p>
In ANSI Common Lisp, the lambda list keyword
<tt>&amp;whole</tt>
binds its corresponding variable to the entire macro form, whereas
<b>TXR Lisp</b>'s
<tt>:whole</tt>
binds its variable only to the arguments of the macro form.
</p><p>
Note, however, that ANSI CL distinguishes destructuring lambda lists
and macro lambda lists and the
<tt>&amp;whole</tt>
parameter has a different behavior between the two.  Under
<tt>destructuring-bind</tt>,
the
<tt>&amp;whole</tt>
parameter receives just the arguments, just like the behavior
of <b>TXR Lisp</b>'s
<tt>:whole</tt>
parameter.
</p><p>
<b>TXR Lisp</b> does not distinguish destructuring and macro lambda lists;
they are the same and behave the same way. Thus
<tt>:whole</tt>
is treated the same way in macros as in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
and related binding operators: it binds just the arguments
to the parameter. <b>TXR Lisp</b> has the special parameter
<tt>:form</tt>
by means of which macros can access their invoking form.
This parameter is also supported in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
and binds to the entire
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
form.
</p><p>

</p></dd></dl>
<a name=3D"N-0264A0BD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.2">9.26.2</a=
> Operator <tt>macro-time</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(macro-time </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
operator has a syntax similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
operator. Each
<tt><i>form</i></tt>
is evaluated from left to right, and the resulting value is that of the las=
t
form.
</p><p>
The special behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
is that the evaluation takes place during
the expansion phase, rather than during the evaluation phase.
</p><p>
Also,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
macro-expands each
<tt><i>form</i></tt>
and evaluates it before processing the next
<tt><i>form</i></tt>
in the same way. Thus, for instance, if a
<tt><i>form</i></tt>
introduces a global definition, that definition will be visible not
only during the evaluation of a subsequent
<tt><i>form</i></tt>,
but also during its macro-expansion time.
</p><p>
During the expansion phase, all
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
expressions which occur in a context
that calls for evaluation are evaluated, and replaced by their quoted value=
s.
For instance
<tt>(macro-time (list 1 2 3))</tt>
evaluates
<tt>(list 1 2 3)</tt>
to the object
<tt>(1 2 3)</tt>
and the entire
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
form is replaced by that value, quoted:
<tt>'(1 2 3)</tt>.
If the form is evaluated again at evaluation-time, the resulting value will=
 be
that of the quote, in this case
<tt>(1 2 3)</tt>.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
forms do not see the surrounding lexical environment; the see only
global function and variable bindings and macros.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
supports techniques that require a calculation to be performed in the
environment where the program is being compiled, and inserting the result o=
f
that calculation as a literal into the program source. Possibly, the
calculation can have some useful effect in that environment, or use
as an input information that is available in that environment.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
operator also inserts a calculated value as a
<i>de facto</i>

literal into the program, but it performs that calculation in the
environment where the compiled file is being loaded.
The two operators may be considered complementary in this sense.
</p><p>
Consider the source file:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> host-name-c () (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-0264A0BD">macro-time</a> (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-0308D954">uname</a>).nodename))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
host-name-l () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">l=
oad-time</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308D954"=
>uname</a>).nodename))
</tt></pre><tt>

</tt>

<p>
If this is compiled via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308D954">uname</a>=
</tt>
call in
<tt>host-name-c</tt>
takes place when it is macro-expanded. Thereafter, the compiled version
of the function returns the name of the machine where the
compilation took place, no matter in what environment it is subsequently
loaded and called.
</p><p>
In contrast, the compilation of
<tt>host-name-l</tt>
arranges for that function's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308D954">uname</a>=
</tt>
call to take place just one time, whenever the compiled file is loaded.
Each time the function is subsequently called, it will
return the name of the machine where it was loaded, without making
any additional calls to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308D954">uname</a>=
</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
operator can occasionally be required in order for some constructs to evalu=
ate
or compile. One way that occurs is when a construct that is being fully
expanded itself defines a macro which is later required in that same constr=
uct.
For example:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F7A8B8">progn</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CA=
EF0B">defmacro</a> mac () 42) (mac))
</tt></pre><tt>

</tt>

<p>
This specific example actually works under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
or file compilation, because in that situation it isn't fully expanded
all at once. When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
process a top-level form that is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>,
they treat its argument forms as individual, separate top-level forms. In
general, <b>TXR Lisp</b> is designed in such a way as to not to require, in=
 most ordinary
programs, extra verbiage to tell the compiler or evaluator that certain
definitions are required by macros. However, somewhat unusual situations ca=
n
arise which are not handled in this way.
</p><p>
Also,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>,
or the related
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028DBD1B">mdo</a>=
)</tt>
directive, can be occasionally necessary in <b>TXR</b>queries, which are pa=
rsed and subject to macro-expansion in their entirety
before being executed.
</p><p>

</p></dd></dl>
<a name=3D"N-02CAEF0B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.3">9.26.3</a=
> Operator <tt>defmacro</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defmacro </tt><tt><i>name</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</t=
t><tt><i>param</i></tt><tt>* [: </tt><tt><i>opt-param</i></tt><tt>* ] [. </=
tt><tt><i>rest-param</i></tt><tt> ])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
operator is evaluated at expansion time. It defines a
macro-expander function under the name
<tt><i>name</i></tt>,
effectively creating a new operator.
</p><p>
Note that the above syntax synopsis describes only the canonical
parameter syntax which remains after parameter list macros are
expanded. See the section Parameter List Macros.
</p><p>
Note that the parameter list is a macro parameter list, and not a
function parameter list. This means that each
<tt><i>param</i></tt>
and
<tt><i>opt-param</i></tt>
can be not only a symbol, but it can itself be a parameter list.
The corresponding argument is then treated as a structure which
matches that parameter list.  This nesting of parameter lists
can be carried to an arbitrary depth.
</p><p>
A macro is called like any other operator, and resembles a function.  Unlik=
e in
a function call, the macro receives the argument expressions themselves, ra=
ther
than their values.  Therefore it operates on syntax rather than on values.
Also, unlike a function call, a macro call occurs in the expansion phase,
rather than the evaluation phase.
</p><p>
The return value of the macro is the macro expansion. It is substituted in
place of the entire macro call form. That form is then expanded again;
it may itself be another macro call, or contain more macro calls.
</p><p>
A global macro defined using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
may decline to expand a macro form. Declining to expand is achieved by
returning the original unexpanded form, which may be captured using the
<tt>:form</tt>
parameter. When a global macro declines to expand a form, the form is
taken as-is. At evaluation time, it will be treated as a function call.
Note: when a local macro defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
declines, more complicated requirements apply; see the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>.
</p><p>
</p></dd><dt>Dialect Notes:</dt><dd>
<p>


A macro in the global namespace introduced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
may co-exist with a function of the same name introduced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>.
This is not permitted in ANSI Common Lisp.
</p><p>
ANSI Common Lisp doesn't describe the concept of declining to expand, excep=
t in
the area of compiler macros. Since TXR Lisp allows global macros and functi=
ons
of the same name to co-exist, ordinary macros can be used to optimize funct=
ions
in a manner similar to Common Lisp compiler macros. A macro can be written
of the same name as a function, and can optimize certain cases of the funct=
ion
call by expanding them to some alternative syntax. Cases which it doesn't
optimize are handled by declining to expand, in which case the form remains
as the original function call.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; dolist macro similar to Common Lisp's:
  ;;
  ;; The following will print 1, 2 and 3
  ;; on separate lines:
  ;; and return 42.
  ;;
  ;; (dolist (x '(1 2 3) 42)
  ;;   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">forma=
t</a> t "~s\n" x))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> dolist ((var list : result) . body)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((i (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</=
a>)))
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</=
a> ((,i ,list)) (,i ,result) ((set ,i (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#D-0069">cdr</a> ,i)))
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let=
</a> ((,var (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car<=
/a> ,i)))
           ,*body))))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00AC12C0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.4">9.26.4</a=
> Operator <tt>macrolet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(macrolet ({(</tt><tt><i>name</i></tt><tt> </tt><tt><i>macr=
o-style-params</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>macro-body-form</i></tt><tt>*)}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
binding operator extends the macro-time lexical environment
by making zero or more new local macros visible.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
symbol is followed by a list of macro definitions.
Each definition is a form which begins with a
<tt><i>name</i></tt>,
followed by
<tt><i>macro-style-params</i></tt>
which is a macro parameter list, and zero or more
<tt><i>macro-body-form</i></tt>-s.
These macro definitions are similar
to those globally defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
operator, except that they
are in a local environment.
</p><p>
The macro definitions are followed by optional
<tt><i>body-forms</i></tt>.
The macros specified in the definitions are visible to these
forms.
</p><p>
Forms inside the macro definitions such as the
<tt><i>macro-body-form</i></tt>-s,
and initializer forms appearing in the
<tt><i>macro-style-params</i></tt>
are subject
to macro-expansion in a scope in which none of the new macros being
defined are yet visible. Once the macro definitions are themselves
macro-expanded, they are placed into a new macro environment, which
is then used for macro expanding the
<tt><i>body-form</i></tt>-s.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
form is fully processed in the expansion phase of a form, and is
effectively replaced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
form which contains expanded versions of
<tt><i>body-form</i></tt>-s.
This expanded structure shows no evidence that any
macrolet forms ever existed in it. Therefore, it is impossible for the code
evaluated in the bodies and parameter lists of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
macros to have any visibility to any surrounding lexical variable bindings,
which are only instantiated in the evaluation phase, after expansion is don=
e
and macros no longer exist.
</p><p>
A local macro defined using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
may decline to expand a macro form. Declining to expand is achieved by retu=
rning the original
unexpanded form, which may be captured using the
<tt>:form</tt>
parameter. When a local macro declines to expand a form, the macro definiti=
on
is temporarily hidden, as if it didn't exist in the lexical scope. If anoth=
er
macro of the same name is thereby revealed (a global macro or another local=
 macro
at a shallower nesting level), then an expansion is tried with that macro. =
 If
no such macro is revealed, or if a lexical function binding of that name is
revealed, then no expansion takes place; the original form is taken as-is.
When another macro is tried, the process repeats, resulting in a search whi=
ch
proceeds as far as possible through outer lexical scopes and finally the
global scope.
</p><p>

</p></dd></dl>
<a name=3D"N-02AC86DE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.5">9.26.5</a=
> Function <tt>macro-form-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(macro-form-p </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>env=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-for=
m-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
represents the syntax of
a form which is a macro form: either a compound macro or a symbol macro.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A macro form is one that will transform under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd-1</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>;
an object which isn't a macro form will not undergo expansion.
</p><p>
The optional
<tt><i>env</i></tt>
parameter is a macroexpansion environment.
A macroexpansion environment is passed down to macros and can be received
via their special
<tt>:env</tt>
parameter.
</p><p>
<tt><i>env</i></tt>
is used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-for=
m-p</a></tt>
to determine whether
<tt><i>obj</i></tt>
is a macro in a lexical macro environment.
</p><p>
If
<tt><i>env</i></tt>
is not specified or is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-for=
m-p</a></tt>
only recognizes global macros.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; macro which translates to 'yes if its
  ;; argument is a macro from, or otherwise
  ;; transforms to the form 'no.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> ismacro (:env menv form)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-form-p</a> =
form menv)
     ''yes ''no))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet</=
a> ((local ()))
    (ismacro (local)))    ;; yields yes

  (ismacro (local))       ;; yields no

  (ismacro (ismacro foo)) ;; yields yes
</tt></pre><tt>

</tt>

<p>
During macro expansion, the global macro
<tt>ismacro</tt>
is handed the macro-expansion environment via
<tt>:env menv</tt>.
</p><p>
When the macro is invoked within the macrolet,
this environment includes the macro-time lexical scope in which the
<tt>local</tt>
macro is defined. So when global checks whether the argument form
<tt>(local)</tt>
is a macro, the conclusion is yes: the (local) form is a macro
call in that environment:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-for=
m-p</a></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
When
<tt>(global (local))</tt>
is invoked outside of the macrolet, no local macro is visible is
there, and so
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-for=
m-p</a></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02ED5471">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.6">9.26.6</a=
> Functions <tt>macroexpand-1</tt> and <tt>macroexpand</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(macroexpand-1 </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>en=
v</i></tt><tt>])=20




<br>&nbsp;&nbsp;(macroexpand </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>env<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>obj</i></tt>
is a macro form (an object for which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC86DE">macro-for=
m-p</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>),
these functions expand the macro form and return the expanded form.
Otherwise, they return
<tt><i>obj</i></tt>.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd-1</a></tt>
performs a single expansion, expanding just the macro
that is referenced by the symbol in the first position of
<tt><i>obj</i></tt>,
and returns the expansion. That expansion may itself be a macro form.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>
performs an expansion similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd-1</a></tt>.
If the result is
a macro form, then it expands that form, and keeps repeating this process
until the expansion yields a non-macro-form. That non-macro-form is then
returned.
</p><p>
The optional
<tt><i>env</i></tt>
parameter is a macroexpansion environment.
A macroexpansion environment is passed down to macros and can be received
via their special
<tt>:env</tt>
parameter. The environment they receive is their
lexically apparent macro-time environment in which local macros may be
visible.  A macro can use this environment to "manually" expand some
form in the context of that environment.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; (rem-num x) expands x, and if x begins with a number=
,
  ;; it removes  the number and returns the resulting
  ;; form. Otherwise, it returns the entire form.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> rem-num (:env menv some-form)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((expanded (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">m=
acroexpand</a> some-form menv)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">numberp</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> expanded))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a> =
expanded)
        some-form)))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet</=
a> ((foo () '(1 list 42))
             (bar () '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0206CE91">list</a> 'a)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 (rem-num (foo)) (rem-num (bar))))

  --&gt; ((42) (a))
</tt></pre><tt>

</tt>

<p>
The
<tt>rem-num</tt>
macro is able to expand the
<tt>(foo)</tt>
and
<tt>(bar)</tt>
forms it receives as
the
<tt>some-form</tt>
argument, even though these forms use local macro that are only
visible in their local scope. This is thanks to the macro
environment passed to
<tt>rem-num</tt>.
It is correctly able to work with the
expansions
<tt>(1 list 42)</tt>
and
<tt>(list 'a)</tt>
to produce
<tt>(list 42)</tt>
and
<tt>(list 'a)</tt>
which evaluate to
<tt>42</tt>
and
<tt>a</tt>
respectively.
</p><p>

</p></dd></dl>
<a name=3D"N-01E62179">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.7">9.26.7</a=
> Functions <tt>macroexpand-1-lisp1</tt> and <tt>macroexpand-lisp1</tt></h4=
>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(macroexpand-1-lisp1 </tt><tt><i>obj</i></tt><tt> [</tt><tt=
><i>env</i></tt><tt>])=20




<br>&nbsp;&nbsp;(macroexpand-lisp1 </tt><tt><i>obj</i></tt><tt> [</tt><tt><=
i>env</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E62179">macroexpa=
nd-1-lisp1</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E62179">macroexpa=
nd-lisp1</a></tt>
functions closely resemble, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd-1</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>.
</p><p>
The argument and return value syntax and semantics is almost
identical, except for one difference. These functions consider argument
<tt><i>obj</i></tt>
to be syntax in a Lisp-1 evaluation context, such as any argument
position of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator, or the equivalent DWIM Brackets notation.
</p><p>
This makes a difference because in a Lisp-1 evaluation context, an
inner function binding is able to shadow an outer symbol macro binding
of the same name.
</p><p>
The requirements about this language area are given in more
detail in the description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E62179">macroexpa=
nd-lisp1</a></tt>
function is useful to the implementor of a macro whose semantics requires
one or more argument forms to be treated in a Lisp-1 context, in situations
when such a macro needs to itself expand the material, rather than merely
insert it as-is into the output code template.
</p><p>

</p></dd></dl>
<a name=3D"N-00E0F5F5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.8">9.26.8</a=
> Functions <tt>expand</tt> and <tt>*expand</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(expand </tt><tt><i>form</i></tt><tt> [</tt><tt><i>env</i><=
/tt><tt>])=20




<br>&nbsp;&nbsp;(expand* </tt><tt><i>form</i></tt><tt> [</tt><tt><i>env</i>=
</tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E0F5F5">expand</a=
></tt>
and
<tt>expand*</tt>
both perform a complete expansion of
<tt><i>form</i></tt>
in the macro-environment
<tt><i>env</i></tt>,
and return that expansion.
</p><p>
If
<tt><i>env</i></tt>
is omitted, the expansion takes place in the global environment in
which only global macros are visible.
</p><p>
The returned object is a structure that
is devoid of any macro calls. Also, all
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>
blocks in form
<tt><i>form</i></tt>
are removed in the returned structure, replaced by their fully
expanded bodies.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E0F5F5">expand</a=
></tt>
and
<tt>expand*</tt>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E0F5F5">expand</a=
></tt>
suppresses any warning exceptions that are issued during expansion.
</p><p>

</p></dd></dl>
<a name=3D"N-0334827B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.9">9.26.9</a=
> Function <tt>expand-with-free-refs</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(expand-with-free-refs </tt><tt><i>form</i></tt><tt> [</tt>=
<tt><i>inner-env</i></tt><tt> [</tt><tt><i>outer-env</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0334827B">expand-wi=
th-free-refs</a></tt>
form performs a full expansion of
<tt><i>form</i></tt>,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E0F5F5">expand</a=
></tt>
function and returns a list containing that expansion, plus four additional
items which provide information about variable and function references whic=
h
occur in
<tt><i>form</i></tt>.
</p><p>
If both
<tt><i>inner-env</i></tt>
and
<tt><i>outer-env</i></tt>
are provided, then it is expected that
<tt><i>inner-env</i></tt>
is lexically nested within
<tt><i>outer-env</i></tt>.
</p><p>
Note: it is not required that
<tt><i>outer-env</i></tt>
be the immediate parent of
<tt><i>inner-env</i></tt>.
</p><p>
Note: a common usage situation is that
<tt><i>outer-env</i></tt>
is the environment of the invocation of a "parent" macro which generates a =
form
that contains local macros. The bodies of those local macros use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0334827B">expand-wi=
th-free-refs</a></tt>,
specifying their own environment as
<tt><i>inner-env</i></tt>
and that of their generating "parent" as
<tt><i>outer-env</i></tt>.
</p><p>
In detail, the five items of the returned list are
<tt>




(</tt><tt><i>expansion</i></tt><tt> </tt><tt><i>fv-inner</i></tt><tt> </tt>=
<tt><i>ff-inner</i></tt><tt> </tt><tt><i>fv-outer</i></tt><tt> </tt><tt><i>=
ff-outer</i></tt><tt>)=20

</tt>

whose descriptions are:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt><tt><i>expansion</i></tt><tt> </tt></tt></dt><dd>



The full expansion of
<tt><i>form</i></tt>,
containing no macro invocations, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
forms.



</dd><dt><tt><tt><i>fv-inner</i></tt><tt> </tt></tt></dt><dd>



A list of the free variables which occur in
<tt><i>form</i></tt>
relative to the
<tt><i>inner-env</i></tt>
environment. That is to say, variables that are not bound inside
<tt><i>form</i></tt>
and are not also bound in
<tt><i>inner-env</i></tt>.
If
<tt><i>inner-env</i></tt>
is omitted, then these are the absolutely free variables
occurring in
<tt><i>form</i></tt>.



</dd><dt><tt><tt><i>ff-inner</i></tt><tt> </tt></tt></dt><dd>



Exactly like
<tt><i>fv-inner</i></tt>
but informing about function bindings rather than variables.



</dd><dt><tt><tt><i>fv-outer</i></tt><tt> </tt></tt></dt><dd>



A list of the variables which which occur in
<tt><i>form</i></tt>
which would be free if the environments between
<tt><i>inner-env</i></tt>
and
<tt><i>outer-env</i></tt>
(including the former, excluding the latter)
were removed from consideration. A more detailed description of this semant=
ics
is given below. If
<tt><i>outer-env</i></tt>
is omitted, then these are the absolutely free variables
occurring in
<tt><i>form</i></tt>,
ignoring the
<tt><i>inner-env</i></tt>.



</dd><dt><tt><tt><i>ff-outer</i></tt><tt> </tt></tt></dt><dd>



Exactly like
<tt><i>fv-outer</i></tt>
but informing about function bindings rather than variables.
</dd></dl>
</dl>
<p>

The semantics of the treatment of
<tt><i>inner-env</i></tt>
and
<tt><i>outer-env</i></tt>
in the calculation of
<tt><i>fv-outer</i></tt>
and
<tt><i>ff-outer</i></tt>
is as follows.  A new environment
<tt><i>diff-env</i></tt>
is calculated from these two environments, and
<tt><i>form</i></tt>
is expanded in this environment. Variables and functions occurring in
<tt><i>form</i></tt>
which are not bound in
<tt><i>diff-env</i></tt>
are listed as
<tt><i>fv-outer</i></tt>
and
<tt><i>ff-outer</i></tt>.
</p><p>
This
<tt><i>diff-env</i></tt>
is calculated as follows. First
<tt><i>diff-env</i></tt>
is initialized as a copy of
<tt><i>outer-env</i></tt>.
Then, all environments below
<tt><i>outer-env</i></tt>
down to
<tt><i>inner-env</i></tt>
are examined for bindings which shadow bindings in
<tt><i>diff-env</i></tt>.
Those shadows are removed from
<tt><i>diff-env</i></tt>.
Therefore, what remains in
<tt><i>diff-env</i></tt>
are those bindings from
<tt><i>outer-env</i></tt>
that are
<i>not</i>

shadowed by the environments between
<tt><i>inner-env</i></tt>
and
<tt><i>outer-env</i></tt>.
</p><p>
Within each of the lists of variables returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0334827B">expand-wi=
th-free-refs</a></tt>,
the order of the variables is not specified.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Suppose that
<tt>mac</tt>
is a macro which somehow has access to the two indicated lexical environmen=
ts
in the following code snippet:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> (a c) ;; &lt;- outer-env
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
(b)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a=
> (c) ;; &lt;- inner-env
        (mac (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91"=
>list</a> a b c d)))))
</tt></pre><tt>

</tt>

<p>
Suppose that
<tt>mac</tt>
invokes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0334827B">expand-wi=
th-free-refs</a></tt>
function, passing in the
<tt>(list a b c d)</tt>
argument form as
<tt>form</tt>
and two macro-time environment objects corresponding to the indicated
environments.
</p><p>
Then the following object shall be a correct return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0334827B">expand-wi=
th-free-refs</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  ((list a b c d) (d) nil (d c b) nil)
</tt></pre><tt>

</tt>

<p>
A complete code example of this is given below.
</p><p>
Other correct return values are possible due to permitted variations in the
order of the variables within the four lists. For instance, instead of
<tt>(d c b)</tt>
the list
<tt>(c b d)</tt>
may appear.
</p><p>
The
<tt><i>fv-inner</i></tt>
list is
<tt>(d)</tt>
because this is the only variable that occurs in
<tt>(list a b c d)</tt>
which is free with regard to
<tt><i>inner-env</i></tt>.
The
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>
variables are not listed because they appear bound inside
<tt><i>inner-env</i></tt>.
</p><p>
The reported
<tt><i>fv-outer</i></tt>
list is
<tt>(b c d)</tt>
because the form is considered against
<tt><i>diff-env</i></tt>
which is formed by removing the shadowing bindings from
<tt><i>outer-env</i></tt>.
The difference between
<tt>(a c)</tt>
and
<tt>(b c)</tt>
is
<tt>a</tt>
and so the form is considered in an environment containing the binding
<tt>a</tt>
which leaves
<tt>(b c d)</tt>
free.
</p><p>
The following is a complete code sample demonstrating the above
descriptions:
</p><p>
<tt>
</tt></p><pre><tt>  ;; Given this macro:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> bigmac (:env out-env big-form)
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrole=
t</a> ((mac (:env in-env little-form)
                      ^',(<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0334827B">expand-with-free-refs</a>
                            little-form in-env ,out-env)))
      ,big-form))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> (a=
 c) ;; &lt;- outer-env, surrounding bigmac
    (bigmac
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a=
> (b)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let<=
/a> (c) ;; &lt;- inner-env, surrounding mac
          (mac (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE9=
1">list</a> a b c d))))))

  --&gt; ((list a b c d) (d) nil (d c b) nil)
</tt></pre><tt>

</tt>

<p>
Note: this information is useful because a set difference can be calculated
between the two reported sets. The set difference between the
<tt><i>fv-outer</i></tt>
variables
<tt>(b c d)</tt>
and the
<tt><i>fv-inner</i></tt>
variables
<tt>(d)</tt>
is
<tt>(b c)</tt>.
</p><p>
That set difference
<tt>(b c)</tt>
is significant because it precisely informs about the
<i>bound</i>

variables which occur in
<tt>(list a b c d)</tt>
which appear bound in
<tt><i>inner-env</i></tt>,
but are not bound due to a binding coming from
<tt><i>outer-env</i></tt>.
In the above example, these are the variables enclosed in the
<tt>bigmac</tt>
macro, but external to the inner
<tt>mac</tt>
macro.
</p><p>
The variable
<tt>d</tt>
is not listed in
<tt>(b c)</tt>
because it is not a bound variable.
The variable
<tt>a</tt>
is not in
<tt>(b c)</tt>
because though it is bound in
<tt><i>inner-env</i></tt>,
that binding comes from
<tt><i>outer-env</i></tt>.
</p><p>
The upshot of this logic is that it allows a macro to inspect a form in ord=
er
to discover the identities of the variables and functions which are used in=
side
that form, whose definitions come from a specific, bounded scope surroundin=
g
that form.
</p><p>

</p></dd></dl>
<a name=3D"N-007B1A53">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.10">9.26.10<=
/a> Functions <tt>lexical-var-p</tt> and <tt>lexical-fun-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lexical-var-p </tt><tt><i>env</i></tt><tt> </tt><tt><i>for=
m</i></tt><tt>)=20




<br>&nbsp;&nbsp;(lexical-fun-p </tt><tt><i>env</i></tt><tt> </tt><tt><i>for=
m</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These two functions are useful to macro writers. They are intended
to be called from the bodies of macro expanders, such as the bodies of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
forms.  The
<tt><i>env</i></tt>
argument is a macro-time environment, which is available to macros
via the special
<tt>:env</tt>
parameter. Using these functions, a macro can enquire whether
a given
<tt><i>form</i></tt>
is a symbol which has a variable binding or a function binding
in the lexical environment.
This information is known during macro expansion. The macro expander
recognizes lexical function and variable bindings, because these
bindings can shadow macros.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;;
  ;; this macro replaces itself with :lexical-var if its
  ;; argument is a lexical variable, :lexical-fun if
  ;; its argument is a lexical function, or with
  ;; :not-lex-fun-var if neither is the case.
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> classify (sym :env e)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</a>
      ((lexical-var-p e sym) :lexical-var)
      ((lexical-fun-p e sym) :lexical-fun)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a> =
:not-lex-fun-var)))

  ;;
  ;; This returns:
  ;;
  ;;   (:lexical-var :not-lex-fun-var :lexical-fun)
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
x 1) (y 2))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrol=
et</a> ((y x))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</=
a> ((f () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> =
2 2)))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list=
</a> (classify x) (classify y) (classify f)))))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Note:</dt><dd>
<p>


</p><p>
These functions do not call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>
on the form. In most cases, it is necessary for the macro writers
to do so. Not that in the above example,  symbol
<tt>y</tt>
is classified as neither a lexical function nor variable.
However, it can be macro-expanded to
<tt>x</tt>
which is a lexical variable.
</p><p>

</p></dd></dl>
<a name=3D"N-02D124AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.11">9.26.11<=
/a> Function <tt>lexical-lisp1-binding</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lexical-lisp1-binding </tt><tt><i>env</i></tt><tt> </tt><t=
t><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D124AB">lexical-l=
isp1-binding</a></tt>
function inspects the macro-time environment
<tt><i>env</i></tt>
to determine what kind of binding, if any, does
<tt><i>symbol</i></tt>
have in that environment, from a Lisp-1 perspective.
</p><p>
That is to say, it considers function bindings, variable bindings
and symbol macro bindings to be in a single name space and finds
the innermost binding of one of these types for
<tt><i>symbol</i></tt>.
</p><p>
If such a binding is found, then the function returns one of
the three keyword symbols
<tt>:var</tt>,
<tt>:fun</tt>,
or
<tt>:symacro</tt>.
</p><p>
If no such lexical binding is found, then the function
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note that a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
return doesn't mean that the symbol doesn't have a lexical binding.  It cou=
ld
have an operator macro lexical binding (a macro binding in the function
namespace established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>).
</p><p>

</p></dd></dl>
<a name=3D"N-0080256D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.12">9.26.12<=
/a> Operator <tt>defsymacro</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defsymacro </tt><tt><i>sym</i></tt><tt> </tt><tt><i>form</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
form introduces a symbol macro. A symbol macro consists of a binding
between a symbol
<tt><i>sym</i></tt>
and and a
<tt><i>form</i></tt>.
The binding denotes the form itself, rather than its value. How the
symbol macro works is that if
<tt><i>sym</i></tt>
occurs as a form in a scope where the symbol macro definition is
in scope,
<tt><i>sym</i></tt>
is replaced by
<tt><i>form</i></tt>.
Immediately after this replacement takes place,
<tt><i>form</i></tt>
itself is then processed for further replacement of macros and
symbol macros.
</p><p>
Symbol macros are also recognized in contexts
where
<tt><i>sym</i></tt>
denotes a place which is the target of an assignment operation
like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
and similar.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
form is implicitly executed at expansion time, and thus need
not be wrapped in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
form, just like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>.
</p><p>
Note: if a symbol macro expands to itself directly, expansion stops. Howeve=
r,
if a symbol macro expands to itself through a chain of expansions,
runaway expansion-time recursion will occur.
</p><p>
If a global variable exists by the name
<tt><i>sym</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
first removes that variable from the global environment, and if that
variable is special, the symbol's special marking is removed.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
doesn't alter the dynamic binding of a special variable. Any such
a binding remains intact.
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
is evaluated in a scope in which there is any lexical or dynamic binding
of
<tt><i>sym</i></tt>
in the variable namespace, whether as a variable or macro,
the global symbol macro is shadowed by that binding.
</p><p>

</p></dd></dl>
<a name=3D"N-00321AB1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.13">9.26.13<=
/a> Operator <tt>symacrolet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(symacrolet ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>for=
m</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>
operator binds local, lexically scoped macros that are
similar to the global symbol macros introduced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>.
</p><p>
Each
<tt><i>sym</i></tt>
in the bindings list is bound to its corresponding form, creating a
new extension of the expansion-time lexical macro environment.
</p><p>
Each
<tt><i>body-form</i></tt>
is subsequently macro-expanded in this new environment
in which the new symbol macros are visible.
</p><p>
Note: ordinary lexical bindings such as those introduced by let or by
function parameters lists shadow symbol macros. If a symbol
<tt>x</tt>
is bound by nested instances of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
and a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>,
then the scope enclosed by both
constructs will see whichever of the two bindings is more inner,
even though the bindings are active in completely separate phases of
processing.
</p><p>
From the perspective of the arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form, lexical function bindings also shadow symbol macros.
This is consistent with the Lisp-1-style name resolution which
applies inside a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form. Lexical operator macros do not shadow
symbol macros under any circumstances.
</p><p>

</p></dd></dl>
<a name=3D"N-0393C970">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.14">9.26.14<=
/a> Macros <tt>placelet</tt> and <tt>placelet*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(placelet ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>place=
</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(placelet* ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>plac=
e</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
macro binds lexically scoped symbol macros in such
a way that they behave as aliases for places
denoted by place forms.
</p><p>
Each
<tt><i>place</i></tt>
must be an expression denoting a syntactic place. The
corresponding
<tt><i>sym</i></tt>
is established as an alias for the storage location which that place denote=
s,
over the scope of the
<tt><i>body-form</i></tt>-s.
</p><p>
This binding takes place in such a way that each
<tt><i>place</i></tt>
is evaluated exactly once, only in order to determine its
storage location.  The corresponding
<tt><i>sym</i></tt>
then serves as an alias for that location, over the
scope of the
<tt><i>body-form</i></tt>-s.
This means that whenever
<tt><i>sym</i></tt>
is evaluated, it stands for the value of the storage
location, and whenever a value is apparently stored into
<tt><i>sym</i></tt>,
it is actually the storage location which receives it.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet*=
</a></tt>
variant implements an alternative scoping rule, which allows a later
<tt><i>place</i></tt>
form to refer to a
<tt><i>sym</i></tt>
bound to an earlier
<tt><i>place</i></tt>
form. In other words, a given
<tt><i>sym</i></tt>
binding is visible not only to the
<tt><i>body-form</i></tt>-s
but also to
<tt><i>place</i></tt>
forms which occur later.
</p><p>
Note: certain kinds of places, notably
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a> </=
tt><tt><i>promise</i></tt><tt>)=20

</tt>

expressions, must be accessed before they can be stored,
and this restriction continues to hold when those
places are accessed through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
aliases.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>
differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>
in that the forms themselves are not aliased, but the storage
locations which they denote.
<tt>(symacrolet ((x y)) z)</tt>
performs the syntactic substitution of symbol
<tt>x</tt>
by form
<tt>y</tt>,
wherever
<tt>x</tt>
appears inside
<tt>z</tt>
as an evaluated form, and is not shadowed by any inner binding.
Whereas
<tt>(placelet ((x y)) z)</tt>
generates code which arranges for
<tt>y</tt>
to be evaluated to a storage location, and syntactically replaces occurrenc=
es
of
<tt>x</tt>
with a form which directly denotes that storage location,
wherever
<tt>x</tt>
appears inside
<tt>z</tt>
as an evaluated form, and is not shadowed by any inner binding.
Also,
<tt>x</tt>
is not necessarily substituted by a single, fixed form,
as in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>.
Rather it may be substituted by one kind of form when it
is treated as a pure value, and another kind of form
when it is treated as a place.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">placelet<=
/a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> inc (place : (delta 1))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-gen=
syms</a> (p)
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0393C970">place=
let</a> ((,p ,place))
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a>=
 ,p (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> ,p ,de=
lta)))))
</tt></pre><tt>

</tt>

<p>
The gensym
<tt>p</tt>
is used to avoid accidental capture of references
emanating from the
<tt>delta</tt>
form.
</p><p>

</p></dd></dl>
<a name=3D"N-02ACCDDF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.15">9.26.15<=
/a> Macro <tt>equot</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(equot </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ACCDDF">equot</a>=
</tt>
macro ("expand and quote") performs a full expansion of
<tt>form</tt>
in the surrounding macro environment. Then it constructs a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>
form whose argument is the expansion. This quote form is
then returned as the macro replacement for the original
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ACCDDF">equot</a>=
</tt>
form.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
321AB1">symacrolet</a> ((a (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-007C">+</a> 2 2)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a> a=
) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ACCDDF">equot</a> =
a) a))
  --&gt; (a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> 2 2) 4)
</tt></pre><tt>

</tt>

<p>
Above, the expansion of
<tt>a</tt>
is
<tt>(+ 2 2)</tt>.
Thus the macro call
<tt>(equot a)</tt>
expands to
<tt>(quote (+ 2 2))</tt>.
When that is evaluated, it yields
<tt>(+ 2 2)</tt>.
</p><p>
If
<tt>a</tt>
is quoted, then the result is
<tt>a</tt>:
no expansion or evaluation takes place.
Whereas if
<tt>a</tt>
is presented for evaluation, then not only is it expanded to
<tt>(+ 2 2)</tt>,
but that expansion is reduced to 4.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ACCDDF">equot</a>=
</tt>
operator is a mongrel of these two semantics: it permits expansion to proce=
ed,
but then suppresses evaluation of the result.
</p><p>

</p></dd></dl>
<a name=3D"N-00A580D9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.16">9.26.16<=
/a> Operators <tt>tree-bind</tt> and <tt>mac-param-bind</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-bind </tt><tt><i>macro-style-params</i></tt><tt> </tt=
><tt><i>expr</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(mac-param-bind </tt><tt><i>context-expr</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>macro-style-params</i></tt><tt> </=
tt><tt><i>expr</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
operator evaluates
<tt>expr</tt>,
and then uses the
resulting value as a counterpart to a macro-style parameter list.
If the value has a tree structure which matches the parameters,
then those parameters are established as bindings, and the
<tt><i>form</i></tt>-s,
if any, are evaluated in the scope of those bindings.  The value
of the last
<tt><i>form</i></tt>
is returned. If there are no forms,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
Note: this operator throws an exception if there is a
structural mismatch between the parameters and the value of
<tt>expr</tt>.
</p><p>
One way to avoid this exception is to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">mac-param=
-bind</a></tt>
operator is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
except that it takes an extra argument,
<tt><i>context-expr</i></tt>.
This argument is an expression which is evaluated. It is expected to
evaluate to a compound form. If an error occurs during binding, the error
diagnostic message is based on information obtained from this form.
By contrast, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
operator's error diagnostic refers to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
form, which is cryptic if the binding is used for the implementation
of some other construct, hidden from the user of that construct.
</p><p>

</p></dd></dl>
<a name=3D"N-03D834A5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.17">9.26.17<=
/a> Operator <tt>tree-case</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-case </tt><tt><i>expr</i></tt><tt> {(</tt><tt><i>macr=
o-style-params</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>
operator evaluates
<tt><i>expr</i></tt>
and matches it against a succession
of zero or more cases. Each case defines a pattern match, expressed as a ma=
cro
style parameter list
<tt><i>macro-style-params</i></tt>.
</p><p>
If the object produced by
<tt><i>expr</i></tt>
matches
<tt><i>macro-style-params</i></tt>,
then the parameters are bound, becoming local variables, and the
<tt><i>form</i></tt>-s,
if any, are evaluated in order in the environment in which those variables =
are
visible.  If there are forms, the value of the last
<tt><i>form</i></tt>
becomes the result
value of the case, otherwise the result value of the case is nil.
</p><p>
If the result value of a case is the object
<tt>:</tt>
(the colon symbol), then processing continues with the next case. Otherwise=
 the
evaluation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>
terminates, returning the result value.
</p><p>
If the value of
<tt><i>expr</i></tt>
does not match the
<tt><i>macro-style-params</i></tt>
parameter list of a case, processing continues with the next case.
</p><p>
If no cases match, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>
terminates, returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; reverse function implemented using tree-case

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
tb-reverse (obj)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-cas=
e</a> obj
      (() ())      ;; the empty list is just returned
      ((a) obj)    ;; one-element list returned
      ((a . b) ^(,*(tb-reverse b) ,a)) ;; car/cdr recursion
      (a a)))     ;; atom is just returned
</tt></pre><tt>

</tt>

<p>
Note that in this example, the atom case is placed last, because an
argument list which consists of a symbol is a "catch all" match
that matches any object. We know that it matches an atom, because
the previous
<tt>(a . b)</tt>
case matches conses. In general, the order of the cases in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>
is important: even more so than the order of cases in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24">cond</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseql</a=
></tt>.
The one-element list case is unnecessary; it can be removed.
</p><p>

</p></dd></dl>
<a name=3D"N-02AB6E53">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.18">9.26.18<=
/a> Macro <tt>tb</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tb </tt><tt><i>macro-style-params</i></tt><tt> </tt><tt><i=
>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AB6E53">tb</a></t=
t>
macro is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
operator but its argument binding is based on a macro-style parameter list.
The name is an abbreviation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AB6E53">tb</a></t=
t>
form evaluates to a function which takes a variable number of
arguments.
</p><p>
When that function is called, those arguments are taken as a list object wh=
ich
is matched against
<tt><i>macro-style-params</i></tt>
as if by
<tt><i>tree-bind</i></tt>.
If the match is successful, then the parameters are bound to the
corresponding elements from the argument structure and each successive
<tt><i>form</i></tt>
is evaluated an environment in which those bindings are visible.
The value of the last
<tt><i>form</i></tt>
is the return value of the function. If there are no forms,
the function's return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The following equivalence holds, where
<tt>args</tt>
should be understood to be a globally unique symbol:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
AB6E53">tb</a> pattern body ...) &lt;--&gt; (<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#D-004F">lambda</a> (. args)
                               (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-00A580D9">tree-bind</a> pattern args body ...))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-029B6E53">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.19">9.26.19<=
/a> Macro <tt>tc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tc {(</tt><tt><i>macro-style-params</i></tt><tt> </tt><tt>=
<i>form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-029B6E53">tc</a></t=
t>
macro produces an anonymous function whose behavior is closely
based on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>
operator. Its name is an abbreviation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>.
</p><p>
The anonymous function takes a variable number of arguments.
Its argument list is taken to be the value macro is tested
against the multiple pattern clauses of an implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>.
The return value of the function is that of the implied
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D834A5">tree-case=
</a></tt>.
</p><p>
The following equivalence holds, where
<tt>args</tt>
should be understood to be a globally unique symbol:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
9B6E53">tc</a> clause1 clause2 ...) &lt;--&gt; (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#D-004F">lambda</a> (. args)
                                   (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-03D834A5">tree-case</a> args
                                      clause1 clause2 ...))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-034F045B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.26.20">9.26.20<=
/a> Macro <tt>with-gensyms</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-gensyms (</tt><tt><i>sym</i></tt><tt>*) </tt><tt><i>b=
ody-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-gens=
yms</a></tt>
evaluates the
<tt><i>body-form</i></tt>-s
in an environment in which each variable name symbol
<tt><i>sym</i></tt>
is bound to a new uninterned symbol ("gensym").
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The code:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((x (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
AA7FBB">gensym</a>))
        (y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">g=
ensym</a>))
        (z (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">g=
ensym</a>)))
    ^(,x ,y ,z))
</tt></pre><tt>

</tt>

<p>
may be expressed more conveniently using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-gens=
yms</a></tt>
shorthand:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
4F045B">with-gensyms</a> (x y z)
    ^(,x ,y ,z))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-00B4065C">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.27">9.27</a> Pa=
rameter List Macros</h3>



<p>


</p><p>
Parameter list macros, also more briefly called
<i>parameter macros</i>

are an original feature of <b>TXR Lisp</b>.
</p><p>
If the first element of a function or macro parameter list is a keyword
symbol other than
<tt>:env</tt>,
<tt>:whole</tt>,
<tt>:form</tt>
or
<tt>:</tt>
(the colon symbol),
it denotes a parameter macro. This keyword symbol is expected to
have a binding in the parameter macro namespace: a global namespace
which associates keyword symbols with parameter list expander
functions.
</p><p>
Expansion of a parameter list macro occurs at macro-expansion
time, when a function's parameter list is traversed by the
macro expander. It takes place as follows.
First, the keyword is removed from the parameter list.
The keyword's binding in the parameter macro namespace is
retrieved. If it doesn't exist, an exception is thrown.
Otherwise, the remaining parameter list is first recursively
processed for more occurrences of parameter macros.
This expansion produces a transformed parameter list,
along with a transformed function body. These two artifacts
are then passed to the transformer function retrieved from
the keyword symbol's binding. The function returns a
further transformed version of the parameter list and
body. These are processed for more parameter macros.
The process terminates when no more expansion is
possible, because a parameter list has been produced
which does not begin with a parameter macro. This
final parameter list and its accompanying body are then
taken in place of the original parameter list and
body.
</p><p>
<b>TXR Lisp</b> provides a two built-in parameter list macros.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
parameter macro endows a function keyword parameters.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
parameter macro allows a function to be expressed using pattern matching,
which requires the body to consist of pattern-matching clauses.
</p><p>
The implementation of both of these macros is written entirely using this
parameter list macro mechanism, by means of the public
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F25A5">define-pa=
ram-expander</a></tt>
macro.
</p><p>

<a name=3D"N-03B67ED8">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.27.1">9.27.=
1</a> Special variable <tt>*param-macro*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B67ED8">*param-ma=
cro*</a></tt>
holds a hash table which associates keyword symbols with
parameter list expander functions.
</p><p>
The functions are expected to conform to the following
syntax:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">=
lambda</a> (</tt><tt><i>params</i></tt><tt> </tt><tt><i>body</i></tt><tt> <=
/tt><tt><i>env</i></tt><tt> </tt><tt><i>form</i></tt><tt>) </tt><tt><i>form=
</i></tt><tt>*)=20

</tt>

</p><p>
The
<tt><i>params</i></tt>
parameter receives the parameter list of the function
which is undergoing parameter expansion. All other
parameter macros have already been expanded.
</p><p>
The
<tt><i>body</i></tt>
parameter receives the list of body forms.
The function is expected to return a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
contains the transformed parameter list, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
contains the transformed list of body forms.
Parameter expansion takes place at macro expansion time.
</p><p>
The
<tt><i>env</i></tt>
parameter receives the macro-expansion-time environment
which surrounds the function being expanded.
Note that this environment doesn't take into account the
parameters themselves; therefore, it is not the correct environment
for expanding macros among the
<tt><i>body</i></tt>
forms. For that purpose, it must be extended with
shadowing entries, the manner of doing which is
undocumented. However
<tt><i>env</i></tt>
may be used directly for expanding init forms
for optional parameters occurring in
<tt><i>params</i></tt>.
</p><p>
The
<tt><i>form</i></tt>
parameter receives the overall function-defining
form that is being processes, such as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
form. This is intended for error reporting.
</p><p>
A parameter transformer returns the transformed parameter list and body as =
a
single object: a list whose first element is the parameter list,
and whose remaining elements are the forms of the body. Thus, the following
is a correct null transformer:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
4F">lambda</a> (params body env form)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a>=
 params body))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-019F25A5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.27.2">9.27.2</a=
> Macro <tt>define-param-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(define-param-expander </tt><tt><i>name</i></tt><tt> (</tt>=
<tt><i>pvar</i></tt><tt> </tt><tt><i>bvar</i></tt><tt> : </tt><tt><i>evar</=
i></tt><tt> </tt><tt><i>fvar</i></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F25A5">define-pa=
ram-expander</a></tt>
macro provides syntax for defining parameter macros. Invocations
of this macro expand to code which constructs an anonymous
function and installs it into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B67ED8">*param-ma=
cro*</a></tt>
hash table, under the key given by
<tt><i>name</i></tt>.
</p><p>
The
<tt><i>name</i></tt>
parameter's argument should be a keyword symbol that is valid for use
as a parameter macro name.
</p><p>
The
<tt><i>pvar</i></tt>,
<tt><i>bvar</i></tt>,
<tt><i>evar</i></tt>
and
<tt><i>fvar</i></tt>
arguments must be symbols suitable for variable
binding. These symbols define the parameters of the
expander function which shall, respectively, receive
the parameter list, body forms, macro environment
and function form. If
<tt><i>evar</i></tt>
is omitted, a symbol generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
function is used. Likewise if
<tt><i>fvar</i></tt>
is omitted.
</p><p>
The
<tt><i>form</i></tt>
arguments constitute the body of the expander.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F25A5">define-pa=
ram-expander</a></tt>
form returns
<tt><i>name</i></tt>.
</p><p>
The parameter macro returns the transformed parameter list and body as a
single object: a list whose first element is the parameter list,
and whose remaining elements are the forms of the body.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following example shows the implementation
of a parameter macro
<tt>:memo</tt>
which provides rudimentary memoization.
Using the macro is extremely easy. It is a matter
of simply inserting the
<tt>:memo</tt>
keyword at the front of a function's parameter list.
The function is then memoized.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F36A75">defvarl</a> %memo% (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-0001">hash</a> :weak-keys))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
ensure-memo (sym)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5FA">gethash</a> %memo=
% sym)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0025A17A">seth=
ash</a> %memo% sym (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000=
1">hash</a>))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F25A5">define-par=
am-expander</a> :memo (param body)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a>=
 ((memo-parm [param 0..(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-00A2B785">posq</a> : param)])
           (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</=
a>))
           (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">k=
ey</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensy=
m</a>)))
      ^(,param (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20=
B">let</a>  ((,hash (ensure-memo ',hash))
                      (,key (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-0206CE91">list</a> ,*memo-parm)))
                 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034"=
>or</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5FA">geth=
ash</a> ,hash ,key)
                     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
025A17A">sethash</a> ,hash ,key (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-03F7A8B8">progn</a> ,*body)))))))
</tt></pre><tt>

</tt>

<p>
The above
<tt>:memo</tt>
macro may be used to define a memoized Fibonacci function
as follows:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> fib (:memo n)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (&lt;=
 n 2)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B940D4">clamp<=
/a> 0 1 n)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> (fib=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">pred</a> n)=
) (fib (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">ppred=
</a> n)))))
</tt></pre><tt>

</tt>

<p>
All that is required is the insertion of the
<tt>:memo</tt>
keyword.
</p><p>

</p></dd></dl>
<a name=3D"N-01697547">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.27.3">9.27.3</a=
> Parameter list macro <tt>:key</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(:key </tt><tt><i>non-key-param</i></tt><tt>*=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; [ -- {</tt><tt><i>sym</i></tt><tt> | (</tt><tt=
><i>sym</i></tt><tt> [</tt><tt><i>init-form</i></tt><tt> [</tt><tt><i>p-sym=
</i></tt><tt>]])}* ]=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; [ . rest-param ])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Parameter list macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
injects keyword parameter support into functions and macros.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
appears as the first item in a function parameter list, a special syntax is
recognized in the parameter list. After any required and optional parameter=
s,
the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
(two dashes) may appear. Parameters after this symbol are interpreted
as keyword parameters. After the keyword parameters, a rest parameter
may appear in the usual way as a symbol in the dotted position.
</p><p>
Keyword parameters use the same syntax as optional parameters, except
that if used in a macro parameter list, they do not support
destructuring whereas optional parameters do. That is to say, regardless
whether
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
is used in a function or macro, keyword parameters are symbols.
</p><p>
A keyword parameter takes three possible forms:
</p><p>
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt><tt><i>sym</i></tt><tt> </tt></tt></dt><dd>



A keyword parameter may be specified as a simple symbol
<tt><i>sym</i></tt>.
If the argument for such a keyword parameter is missing,
it takes on the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.



</dd><dt><tt>(<tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>) <=
/tt></tt></dt><dd>



If the keyword parameter symbol
<tt><i>sym</i></tt>
is enclosed in a list, then the second element of that list
specifies a default value, similarly to the default value for
an optional argument. If the function is called in such a way
that the argument for the parameter is missing, the
<tt><i>init-form</i></tt>
is evaluated and the resulting value is bound to the keyword parameter.
The evaluation takes place in a lexical scope in which the
required and optional parameters are are already visible,
and their values are bound. If there is a
<tt><i>rest-param</i></tt>
it is also visible in this scope, even though in the parameter
list it appears to the left.



</dd><dt><tt>(<tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt> </=
tt><tt><i>p-sym</i></tt><tt>) </tt></tt></dt><dd>



The three-element form of the keyword parameter specifies
an additional symbol
<tt><i>p-sym</i></tt>,
which names an argument that implicitly receives a Boolean
argument indicating the presence of the keyword argument.
If an argument is not passed for the keyword parameter
<tt><i>sym</i></tt>,
then parameter
<tt><i>sym-p</i></tt>
takes on the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If an argument is given for
<tt><i>sym</i></tt>,
then the
<tt><i>sym-p</i></tt>
argument takes on the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
This mechanism also closely resembles the analogous
one supported in optional arguments. See the previous
paragraph regarding the evaluation scope of
<tt><i>init-form</i></tt>.
</dd></dl>
</dl>
<p>

In a call to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>-enabled
function, keyword arguments begin after those arguments which satisfy
all of the required and optional parameters. Keyword arguments consist
of interleaved indicators and values, which are separate arguments.
Thus passing a keyword argument actually requires the passing of two
function arguments: an indicator keyword symbol, followed by the
associated value. The indicator keywords are expected to have the
same symbol name as the defined keyword parameters. For instance, the
indicator-value pair
<tt>:xyz 42</tt>
passes the value
<tt>42</tt>
to a keyword parameter that may be named
<tt>xyz</tt>
in any package: it may be
<tt>usr:xyz</tt>
or
<tt>mypackage:xyz</tt>
and so forth.
Arguments specifying unrecognized keywords are ignored.
</p><p>
If the function has a
<tt><i>rest-param</i></tt>,
then that parameter receives the keyword arguments as a list.
Since that list contains indicators and values, it is a
<i>de facto</i>

property list. In detail, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
mechanism generates a regular variadic function which receives the keyword
arguments as the trailing argument list. That function
parses the recognized keyword arguments out of the trailing list, and
binds them to the keyword parameter symbols as local variables. If a
<tt><i>rest-param</i></tt>
parameter is defined, then the entire keyword argument list is available
through that parameter, and the keyword argument parsing logic also refers =
to
the value of that parameter to gain access to the keyword arguments. If
there is no
<tt><i>rest-param</i></tt>
specified, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
macro adds a
<tt><i>rest-param</i></tt>
using a machine-generated symbol. The argument parsing logic then
refers to the value of that symbol.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Define a function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
with two required arguments
<tt>a b</tt>,
one optional argument
<tt>c</tt>,
two keyword arguments
<tt>foo</tt>
and
<tt>bar</tt>,
and a rest parameter
<tt>klist</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> fun (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
01697547">:key</a> a b : c -- foo bar . klist)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 a b c foo bar klist))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> 1 =
2 3 :bar 4) -&gt; (1 2 3 nil 4 (:bar 4))
</tt></pre><tt>

</tt>

<p>
Define a function with only keyword arguments, with default expressions and
Boolean indicator params:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> keyfun (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-01697547">:key</a> -- (a 10 a-p) (b 20 b-p))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 a a-p b b-p))

  (keyfun :a 3) -&gt; (3 t 20 nil)

  (keyfun :b 4) -&gt; (10 nil 4 t)

  (keyfun :c 4) -&gt; (10 nil 20 nil)

  (keyfun) -&gt; (10 nil 20 nil)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-00A7F3F6">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28">9.28</a> Mu=
tation of Syntactic Places</h3>



<p>



<a name=3D"N-033F39EB">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.1">9.28.=
1</a> Macro <tt>set</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(set {</tt><tt><i>place</i></tt><tt> </tt><tt><i>new-value<=
/i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
operator stores the values of expressions in places. It must
be given an even number of arguments.
</p><p>
If there are no arguments, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
does nothing and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If there are two arguments,
<tt><i>place</i></tt>
and
<tt><i>new-value</i></tt>,
then
<tt><i>place</i></tt>
is evaluated to determine its storage location, then
<tt><i>new-value</i></tt>
is evaluated to determine the value to be stored there,
and then the value is stored in that location. Finally,
the value is also returned as the result value.
</p><p>
If there are more than two arguments, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
performs multiple assignments in left to right order.
Effectively,
<tt>(set v1 e1 v2 e2 ... vn en)</tt>
is precisely equivalent to
<tt>(progn (set v1 e1) (set v2 e2) ... (set vn en))</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-008211EC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.2">9.28.2</a=
> Macro <tt>pset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pset {</tt><tt><i>place</i></tt><tt> </tt><tt><i>new-value=
</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The syntax of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a><=
/tt>
is similar to that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>,
and the semantics is similar also in that zero or more places are
assigned zero or more values. In fact, if there are no arguments, or
if there is exactly one pair of arguments,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a><=
/tt>
is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>.
</p><p>
If there are two or more argument pairs, then all of the arguments
are evaluated first, in left-to-right order.  No store takes place
until after every
<tt><i>place</i></tt>
is determined, and every
<tt><i>new-value</i></tt>
is calculated. During the calculation, the values to be stored
are retained in hidden, temporary locations. Finally, these values
are moved into the determined places. The rightmost value is returned
as the form's value.
</p><p>
The assignments thus appear to take place in parallel, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a><=
/tt>
is capable of exchanging the values of a pair of places, or rotating
the values among three or more places. (However, there are more convenient
operators for this, namely
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166291D">rotate</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042131D">swap</a><=
/tt>).
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; exchange x and y
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a> x=
 y y x)

  ;; exchange elements 0 and 1; and 2 and 3 of vector v:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
v (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">vec</a> 0 =
10 20 30))
        (i -1))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008211EC">pset</a>=
 [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">vec</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a> i)] [<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">vec</a> (<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a> i)]
          [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">ve=
c</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a=
> i)] [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0297F5F5">vec</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a> i)=
])
     vec)
  -&gt; #(10 0 30 20)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-037F3A8C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.3">9.28.3</a=
> Macro <tt>zap</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(zap </tt><tt><i>place</i></tt><tt> [</tt><tt><i>new-value<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037F3A8C">zap</a></=
tt>
macro assigns
<tt><i>new-value</i></tt>
to
<tt><i>place</i></tt>
and returns the previous value of
<tt><i>place</i></tt>.
</p><p>
If
<tt><i>new-value</i></tt>
is missing, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is used.
</p><p>
In more detail, first
<tt>place</tt>
is evaluated to determine the storage location.
Then, the location is accessed to retrieve the
previous value. Then, the
<tt>new-value</tt>
expression is evaluated, and that value is
placed into the storage location.
Finally, the previously retrieved value is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-0042153F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.4">9.28.4</a=
> Macro <tt>flip</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flip </tt><tt><i>place</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042153F">flip</a><=
/tt>
macro toggles the Boolean value stored in
<tt><i>place</i></tt>.
</p><p>
If
<tt><i>place</i></tt>
previously held
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it is set to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
and if it previously held a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it is set to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-036C7E9E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.5">9.28.5</a=
> Macros <tt>test-set</tt> and <tt>test-clear</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(test-set </tt><tt><i>place</i></tt><tt>)=20




<br>&nbsp;&nbsp;(test-clear </tt><tt><i>place</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036C7E9E">test-set<=
/a></tt>
macro examines the value of
<tt><i>place</i></tt>.
If it is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then it stores
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
into the place, and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise it leaves
<tt><i>place</i></tt>
unchanged and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036C7E9E">test-clea=
r</a></tt>
macro examines the value of
<tt><i>place</i></tt>.
If it is Boolean true (any value except
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>)
then it stores
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
into the place, and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise it leaves
<tt><i>place</i></tt>
unchanged and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02933F2A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.6">9.28.6</a=
> Macro <tt>compare-swap</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compare-swap </tt><tt><i>place</i></tt><tt> </tt><tt><i>cm=
p-fun</i></tt><tt> </tt><tt><i>cmp-val</i></tt><tt> </tt><tt><i>store-val</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02933F2A">compare-s=
wap</a></tt>
macro examines the value of
<tt><i>place</i></tt>
and compares it to
<tt><i>cmp-val</i></tt>
using the comparison function given by the function name
<tt><i>cmp-fun</i></tt>.
</p><p>
This comparison takes places as if by evaluating the expression
<tt>




(</tt><tt><i>cmp-fun</i></tt><tt> </tt><tt><i>value</i></tt><tt> </tt><tt><=
i>cmp-val</i></tt><tt>)=20

</tt>

where
<tt><i>value</i></tt>
denotes the current value of
<tt><i>place</i></tt>.
</p><p>
If the comparison is false,
<tt><i>place</i></tt>
is not modified, the
<tt><i>store-val</i></tt>
expression is not evaluated, and the macro returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If the comparison is true, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02933F2A">compare-s=
wap</a></tt>
evaluates the
<tt><i>store-val</i></tt>
expression, stores the resulting value into
<tt><i>place</i></tt>
and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-03A0AABD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.7">9.28.7</a=
> Macros <tt>inc</tt> and <tt>dec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(inc </tt><tt><i>place</i></tt><tt> [</tt><tt><i>delta</i><=
/tt><tt>])=20




<br>&nbsp;&nbsp;(dec </tt><tt><i>place</i></tt><tt> [</tt><tt><i>delta</i><=
/tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
macro increments
<tt><i>place</i></tt>
by adding
<tt><i>delta</i></tt>
to its value.
If
<tt><i>delta</i></tt>
is missing, the value used in its place the integer 1.
</p><p>
First the
<tt><i>place</i></tt>
argument is evaluated as a syntactic place to determine the location.
Then, the value currently stored in that location is retrieved.
Next, the
<tt><i>delta</i></tt>
expression is evaluated. Its value is added to the previously retrieved
value as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
function. The resulting value is stored in the place, and returned.
</p><p>
The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">dec</a></=
tt>
works exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
except that addition is replaced by subtraction. The similarly defaulted
<tt><i>delta</i></tt>
value is subtracted from the previous value of the place.
</p><p>

</p></dd></dl>
<a name=3D"N-00E4BC37">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.8">9.28.8</a=
> Macros <tt>pinc</tt> and <tt>pdec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pinc </tt><tt><i>place</i></tt><tt> [</tt><tt><i>delta</i>=
</tt><tt>])=20




<br>&nbsp;&nbsp;(pdec </tt><tt><i>place</i></tt><tt> [</tt><tt><i>delta</i>=
</tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E4BC37">pinc</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E4BC37">pdec</a><=
/tt>
are similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">dec</a></=
tt>.
</p><p>
The only difference is that they return the previous value of
<tt><i>place</i></tt>
rather than the incremented value.
</p><p>

</p></dd></dl>
<a name=3D"N-01A4228F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.9">9.28.9</a=
> Macros <tt>test-inc</tt> and <tt>test-dec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(test-inc </tt><tt><i>place</i></tt><tt> [</tt><tt><i>delta=
</i></tt><tt> [</tt><tt><i>from-val</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(test-dec </tt><tt><i>place</i></tt><tt> [</tt><tt><i>delta=
</i></tt><tt> [</tt><tt><i>to-val</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A4228F">test-inc<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A4228F">test-dec<=
/a></tt>
macros provide combined operations which change the value of a place and
provide a test whether, respectively, a certain previous value was
overwritten, or a certain new value was attained. By default, this tested
value is zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A4228F">test-inc<=
/a></tt>
macro notes the prior value of
<tt><i>place</i></tt>
and then updates it with that value, plus
<tt><i>delta</i></tt>,
which defaults to 1. If the prior value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
to
<tt><i>from-val</i></tt>
then it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The default value of
<tt><i>from-val</i></tt>
is zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A4228F">test-dec<=
/a></tt>
macro produces a new value by subtracting
<tt><i>delta</i></tt>
from the value of
<tt><i>place</i></tt>.
The argument
<tt><i>delta</i></tt>
defaults to 1. The new value is stored into
<tt><i>place</i></tt>.
If the new value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
to
<tt><i>to-val</i></tt>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0042131D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.10">9.28.10<=
/a> Macro <tt>swap</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(swap </tt><tt><i>left-place</i></tt><tt> </tt><tt><i>right=
-place</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042131D">swap</a><=
/tt>
macro exchanges the values of
<tt><i>left-place</i></tt>
and
<tt><i>right-place</i></tt>
and returns the value which is thereby transferred to
<tt><i>right-place</i></tt>.
</p><p>
First,
<tt><i>left-place</i></tt>
and
<tt><i>right-place</i></tt>
are evaluated, in that order, to determine their locations.
Then the prior values are retrieved, exchanged and stored back.
The value stored in
<tt><i>right-place</i></tt>
is also returned.
</p><p>
If
<tt><i>left-place</i></tt>
and
<tt><i>right-place</i></tt>
are ranges of the same sequence, the behavior is not specified
if the ranges overlap or are of unequal length.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166291D">rotate</a=
></tt>
macro's behavior is somewhat more specified in this regard.
Thus, although any correct
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042131D">swap</a><=
/tt>
expression can be expressed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0166291D">rotate</a=
></tt>,
but the reverse isn't true.
</p><p>

</p></dd></dl>
<a name=3D"N-01C211C1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.11">9.28.11<=
/a> Macro <tt>push</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(push </tt><tt><i>item</i></tt><tt> </tt><tt><i>place</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C211C1">push</a><=
/tt>
macro places
<tt><i>item</i></tt>
at the head of the list stored in
<tt><i>place</i></tt>
and returns the updated list which is stored back in
<tt><i>place</i></tt>.
</p><p>
First, the expression
<tt><i>item</i></tt>
is evaluated to produce the push value.
Then,
<tt><i>place</i></tt>
is evaluated to determine its storage location.
Next, the storage location is accessed to retrieve the
list value which is stored there. A new object is
produced as if by invoking
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
function on the push value and list value.
This object is stored into the location,
and returned.
</p><p>

</p></dd></dl>
<a name=3D"N-017F39D2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.12">9.28.12<=
/a> Macro <tt>pop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pop </tt><tt><i>place</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop</a></=
tt>
macro removes an element from the list stored in
<tt><i>place</i></tt>
and returns it.
</p><p>
First,
<tt><i>place</i></tt>
is evaluated to determine the place. The place is accessed to
retrieve the original value. Then a new value is calculated,
as if by applying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
function to the old value. This new value is stored.
Finally, a return value is calculated and returned, as if by applying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function to the original value.
</p><p>

</p></dd></dl>
<a name=3D"N-02C37AB0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.13">9.28.13<=
/a> Macro <tt>pushnew</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pushnew </tt><tt><i>item</i></tt><tt> </tt><tt><i>place</i=
></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></tt><t=
t>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C37AB0">pushnew</=
a></tt>
macro inspects the list stored in
<tt><i>place</i></tt>.
If the list already contains the item, then
it returns the list. Otherwise it creates a new list
with the item at the front and stores it back
into
<tt><i>place</i></tt>,
and returns it.
</p><p>
First, the expression
<tt><i>item</i></tt>
is evaluated to produce the push value.
Then,
<tt><i>place</i></tt>
is evaluated to determine its storage location.
Next, the storage location is accessed to retrieve the
list value which is stored there. The list is
inspected to check whether it already contains the push
value, as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176FBE7">member</a=
></tt>
function.  If that is the case, the list
is returned and the operation finishes.
Otherwise, a new object is
produced as if by invoking
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
function on the push value and list value.
This object is stored into the location
and returned.
</p><p>

</p></dd></dl>
<a name=3D"N-01AC8471">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.14">9.28.14<=
/a> Macro <tt>shift</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(shift </tt><tt><i>place</i></tt><tt>+ </tt><tt><i>shift-in=
-value)</i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AC8471">shift</a>=
</tt>
macro treats one or more places as a "multi-place shift register".
The values of the places are shifted one place to the left.
The first (leftmost) place receives the value of the second place,
the second receives that of the third, and so on.
The last (rightmost) place receives
<tt><i>shift-in-value</i></tt>
(which is not treated as a place, even if it is a syntactic place form).
The previous value of the first place is returned.
</p><p>
More precisely, all of the argument forms are evaluated left to right, in t=
he
process of which the storage locations of the places are determined,
<tt><i>shift-in-value</i></tt>
is reduced to its value.
</p><p>
The values stored in the places are sampled and saved.
</p><p>
Note that it is not specified whether the places are sampled in a separate
pass after the evaluation of the argument forms, or whether the
sampling is interleaved into the argument evaluation. This affects
the behavior in situations in which the evaluation of any of the
<tt><i>place</i></tt>
forms, or of
<tt><i>shift-in-value</i></tt>,
has the side effect of modifying later places.
</p><p>
Next, the places are updated by storing the saved value of the second
place into the first place, the third place into the second and so forth,
and the value of
<tt><i>shift-in-value</i></tt>
into the last place.
</p><p>
Finally, the saved original value of the first place is returned.
</p><p>
If any of the places are ranges which index into the same sequence,
and the behavior is not otherwise unspecified due to the issue
noted in an earlier paragraph, the effect upon the multiply-stored
sequence can be inferred from the above-described storage order.
Note that even if stores take place which change the length of
the sequence and move some elements, not-yet-processed stores whose ranges
to refer to these elements are not adjusted.
</p><p>
With regard to the foregoing paragraph, a recommended practice is
that if subranges of the same sequence object are shifted, they be
given to the macro in ascending order of starting index. Furthermore, the
semantics is simpler if the ranges do not overlap.
</p><p>

</p></dd></dl>
<a name=3D"N-0166291D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.15">9.28.15<=
/a> Macro <tt>rotate</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rotate </tt><tt><i>place</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Treats zero or more places as a "multi-place rotate register".
If there are no arguments, there is no effect and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. Otherwise, the last (rightmost) place receives
the value of the first (leftmost) place. The leftmost place
receives the value of the second place, and so on.
If there are two arguments, this equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042131D">swap</a><=
/tt>.
The prior value of the first place, which is the the value
rotated into the last place, is returned.
</p><p>
More precisely, the
<tt><i>place</i></tt>
arguments are evaluated left to right,
and the storage locations are thereby determined. The storage
locations are sampled, and then the sampled values are
stored back into the locations, but rotated by one place
as described above. The saved original value of the leftmost
<tt><i>place</i></tt>
is returned.
</p><p>
It is not specified whether the sampling of the original values
is a separate pass which takes place after the arguments
are evaluated, or whether this sampling it is interleaved into argument
evaluation. This affects
the behavior in situations in which the evaluation of any of the
<tt><i>place</i></tt>
forms has the side effect of modifying the value stored in
a later
<tt><i>place</i></tt>
form.
</p><p>
If any of the places are ranges which index into the same sequence,
and the behavior is not otherwise unspecified due to the issue
noted in the preceding paragraph, the effect upon the multiply-stored
sequence can be inferred from the above-described storage order.
Note that even if stores take place which change the length of
the sequence and move some elements, not-yet-processed stores whose ranges
to refer to these elements are not adjusted.
</p><p>
With regard to the foregoing paragraph, a recommended practice is
that if subranges of the same sequence object are shifted, they be
given to the macro in ascending order of starting index. Furthermore, the
semantics is simpler if the ranges do not overlap.
</p><p>

</p></dd></dl>
<a name=3D"N-02BF3A07">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.16">9.28.16<=
/a> Macro <tt>del</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(del </tt><tt><i>place</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
macro requests the deletion of
<tt>place</tt>.
If
<tt>place</tt>
doesn't support deletion, an exception is thrown.
</p><p>
First
<tt>place</tt>
is evaluated, thereby determining its location.
Then the place is accessed to retrieve its value.
The place is then subject to deletion. Finally, the
previously retrieved value is returned.
</p><p>
Precisely what deletion means depends on the kind of place.
The built-in places in <b>TXR Lisp</b> have deletion semantics which are
intended to be unsurprising to the programmer familiar with the
data structure which holds the place.
</p><p>
Generally, if a place denotes the element of a sequence, then deletion of t=
he
place implies deletion of the element, and deletion of the element implies =
that
the gap produced by the element is closed.  The deleted element is effectiv=
ely
replaced by its successor, that successor by its successor and so on. If a
place denotes a value stored in a dynamic data set such as a hash table,
then deletion of that place implies deletion of the entry which holds
that value. If the entry is identified by a key, that key is also removed.
</p><p>

</p></dd></dl>
<a name=3D"N-008216EC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.17">9.28.17<=
/a> Macro <tt>lset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lset {</tt><tt><i>place</i></tt><tt>}+ </tt><tt><i>sequenc=
e-expr</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216EC">lset</a><=
/tt>
operator's parameter list consists of one or more places followed
by an expression
<tt><i>sequence-expr</i></tt>.
</p><p>
The macro evaluates
<tt>sequence-expr</tt>,
which is expected to produce a sequence.
</p><p>
Successive elements of the resulting list are then assigned to each
successive
<tt>place</tt>.
</p><p>
If there are fewer elements in the sequence than places, the
unmatched places receive the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Excess elements in the sequence are ignored.
</p><p>
An error exception occurs if the sequence is an improper list with fewer
elements than places.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216EC">lset</a><=
/tt>
form produces the value of
<tt><i>sequence-expr</i></tt>
as its result value.
</p><p>

</p></dd></dl>
<a name=3D"N-033F39DC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.28.18">9.28.18<=
/a> Macro <tt>upd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(upd </tt><tt><i>place</i></tt><tt> </tt><tt><i>opip-arg</i=
></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39DC">upd</a></=
tt>
macro evaluates
<tt><i>place</i></tt>
and passes the value as an argument to the operational pipeline
function formed,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>
macro, from the
<tt><i>opip-arg</i></tt>
arguments.  The result of this function is then stored back into
<tt><i>place</i></tt>.
</p><p>
The following equivalence holds, except that place
<tt>p</tt>
is evaluated only once:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
3F39DC">upd</a> p x y z ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr=
/txr-manpage.html#D-002F">set</a> p (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-0386C775">call</a> (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-01937C5A">opip</a> x y z ...) p))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-004B0AB7">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29">9.29</a> Us=
er-Defined Places and Place Operators</h3>



<p>


<b>TXR Lisp</b> provides a number of place-modifying operators such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C211C1">push</a><=
/tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>.
It also provides a variety of kinds of syntactic places
which may be used with these operators.
</p><p>
Both of these categories are open-ended: <b>TXR Lisp</b> programs may exten=
d
the set of place-modifying operators, as well as the vocabulary of
forms which are recognized as syntactic places.
</p><p>
Regarding place operators, it might seem obvious that new place operators c=
an
be developed, since they are macros, and macros can expand to uses
of existing place operators. As an example, it may seem that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
operator could be written as a macro which uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> new-inc (place : (delta 1))
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> ,pl=
ace (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> ,place=
 ,delta)))
</tt></pre><tt>

</tt>

<p>
However, the above
<tt>new-inc</tt>
macro has a problem: the
<tt>place</tt>
argument form is inserted into two places in the expansion, which
leads to two evaluations. This is visibly incorrect if the place
form contains any side effects. It is also potentially inefficient.
</p><p>
<b>TXR Lisp</b> provides a framework for writing place update macros which
evaluate their argument forms once, even if they have to access
and update the same places.
</p><p>
The framework also supports the development of new kinds of place forms
as capsules of code which introduce the right kind of material into
the lexical environment of the body of an update macro, to enable
this special evaluation.
</p><p>
<a name=3D"N-0311B2B1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.1">9.29.=
1</a> Place-Expander Functions</h4>


The central design concept in <b>TXR Lisp</b> syntactic places are
<i>place-expander functions</i>.

Each compound place is defined by up to three place-expander functions,
which are associated with the place via the leftmost operator
symbol of the place form. One place-expander, the
<i>update expander</i>,

is mandatory. Optionally, a place may also provide a
<i>clobber expander</i>

as well as a
<i>delete expander</i>.

An update expander provides the expertise for evaluating a place form once
in its proper run-time context to determine its actual run-time storage
location, and to access and modify the storage location.
A clobber expander provides an optimized mechanism for uses that perform
a one-time store to a place without requiring its prior value.
If a place definition does not supply a clobber expander, then the syntacti=
c
places framework uses the update expander to achieve the functionality.
A delete expander provides the expertise for determining the actual run-tim=
e
storage location corresponding to a place, and obliterating it,
returning its prior value.  If a place does not supply a delete expander, t=
hen
the place does not support deletion. Operators which require deletion, such=
 as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
will raise an error when applied to that place.
<p>
The expanders operate independently, and it is expected that place-modifyin=
g
operators choose one of the three, and use only that expander. For example,
accessing a place with an update expander and then overwriting its value
with a clobber expander may result in incorrect code which contains multipl=
e
evaluations of the place form.
</p><p>
The programmer who implements a new place does not write expanders directly=
,
but rather defines them via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
macro.
</p><p>
The programmer who implements a new place update macro likewise does not
call the expanders directly. Usually, they are invoked via the macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clob=
ber-expander</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6E020">with-dele=
te-expander</a></tt>.
These are sufficient for most kind of macros.
In certain complicated cases, expanders may be invoked using the wrapper
functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-upda=
te-expander</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223827D">call-clob=
ber-expander</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021E7CC3">call-dele=
te-expander</a></tt>.
These convenience macros and functions perform certain common chores, like
macro-expanding the place in the correct environment, and choosing the
appropriate function.
</p><p>
The expanders are described in the following sections.
</p><p>
<a name=3D"N-01AF752D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.2">9.29.=
2</a> The Update Expander</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lambda (</tt><tt><i>getter-sym</i></tt><tt> </tt><tt><i>se=
tter-sym</i></tt><tt> </tt><tt><i>place-form</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><=
i>body-form</i></tt><tt>) ...)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The update expander is a code-writer. It takes a
<tt><i>body-form</i></tt>
argument, representing code, and returns a larger form which surrounds
this code with additional code.
</p><p>
This larger form returned by the update expander can be regarded as having =
two
abstract actions, when it is substituted and evaluated in the context where
<tt><i>place-form</i></tt>
occurs.  The first abstract action is to evaluate
<tt><i>place-form</i></tt>
exactly one time, in order to determine the actual run-time location to whi=
ch
that form refers.
The second abstract action is to evaluate the caller's
<tt><i>body-form</i></tt>-s,
in a lexical environment in which bindings exist for some lexical
functions or (more usually) lexical macros. These lexical macros
are explicitly referenced by the
<tt><i>body-form</i></tt>;
the update expander just provides their definition, under the names
it is given via the
<tt><i>getter-sym</i></tt>
and
<tt><i>setter-sym</i></tt>
arguments.
</p><p>
The update expander writes local functions or macros under these names: a
getter function and a setter function.  Usually, update expanders write
macros rather than functions, possibly in combination with some lexical
anonymous variables which hold temporary objects. Therefore the getter
and setter are henceforth referred to as macros.
</p><p>
The code being generated is with regard to some concrete instance of
<tt><i>place-form</i></tt>.
This argument is the actual form which occurs in a program. For
instance, the update expander for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
place might be called with an arbitrary variant of the
<tt><i>place-form</i></tt>
which might look like
<tt>(car (inc (third some-list)))</tt>.
</p><p>
In the abstract semantics, upfront code wrapped around the
<tt><i>body-form</i></tt>
by the update expander provides the logic to evaluate this place to
a location, which is retained in some hidden local context.
</p><p>
The getter local macro named by
<tt><i>getter-sym</i></tt>
must provide the logic for retrieving the value of this place.
The getter macro takes no arguments.
The
<tt><i>body-form</i></tt>
makes free use of the getter function; they may call it multiple times,
which must not trigger multiple evaluations of the original place
form.
</p><p>
The setter local macro named by
<tt><i>setter-sym</i></tt>
must generate the logic for storing a new value into the once-evaluated
version of
<tt><i>place-form</i></tt>.
The setter function takes exactly one argument, whose
value specifies the value to be stored into the place.
It is the caller's responsibility to ensure that the
argument form which produces the value to be stored via the setter is evalu=
ated
only once, and in the correct order.  The setter does not concern itself wi=
th
this form. Multiple calls to the setter can be expected to result in multip=
le
evaluations of its argument. Thus, if necessary, the caller must supply the=
 code
to evaluate the new value form to a temporary variable, and then pass the
temporary variable to the setter. This code can be embedded in
the
<tt><i>body-form</i></tt>
or can be added to the code returned by a call to the update expander.
</p><p>
The setter local macro or function must return the new value which is store=
d.
That is to say, when
<tt><i>body-form</i></tt>
invokes this local macro or function, it may rely on it yielding the
new value which was stored, as part of achieving its own semantics.
</p><p>
The update expander does not macro-expand
<tt>place-form</tt>.
It is assumed that the expander is invoked in such a way that the
place has been expanded in the correct environment. In other words, the
form matches the type of place which the expander handles.
If the expander had to macro-expand the place form, it would sometimes have
to come to the conclusion that the place form must be handled by a differen=
t
expander. No such consideration is the case: when an expander is called on
a form, that is final; it is certain that it is the correct expander, which
matches the symbol in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
position of the form, which is not a macro in the context where it occurs.
</p><p>
An update expander is free to assume that any place which is stored
(the setter local macro is invoked on it) is accessed at least once by
an invocation of the getter. A place update macro which relies on an update
expander, but uses only the store macro, might not work properly.
An example of an update expander which relies on this assumption is the
expander for the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a> </=
tt><tt><i>promise</i></tt><tt>)=20

</tt>

place type. If
<tt><i>promise</i></tt>
has not yet been forced, and only the setter is used, then
<tt><i>promise</i></tt>
might remain unforced as its internal value location is updated.
A subsequent access to the place will incorrectly trigger a force,
which will overwrite the value. The expected behavior is that storing
a value in an unforced
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0307223D">force</a>=
</tt>
place changes the place to forced state, preempting the evaluation of
the delayed form. Afterward, the promise exhibits the value which was
thus assigned.
</p><p>
The update expander is not responsible for all issues of evaluation order. =
 A
place update macro may consist of numerous places, as well as numerous
value-producing forms which are not places. Each of the places can provide =
its
registered update expander which provides code for evaluating just that pla=
ce,
and a means of accessing and storing the values.  The place update macro mu=
st
call the place expanders in the correct order, and generate any additional =
code
in the correct order, so that the macro achieves its required documented
evaluation order.
</p><p>
</p></dd><dt>Example Update Expander Call:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; First, capture the update expander
  ;; function for (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043=
">car</a> ...) places
  ;; in a variable, for clarity.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a>=
 car-update-expander [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
1A2C58A">*place-update-expander*</a> 'car])

  ;; Next, call it for the place (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#D-0043">car</a> [a 0]).
  ;; The body form specifies logic for
  ;; incrementing the place by one and
  ;; returning the new value.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> c=
ar-update-expander 'getit 'setit '(<a href=3D"http://nongnu.org/txr/txr-man=
page.html#D-0043">car</a> [a 0])
    '(setit (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> (getit) 1)))

  ;; --&gt; Resulting code:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a> (=
(#:g0032 [a 0]))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet=
</a> ((getit nil
                 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00141=
62F">append</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE=
91">list</a> 'car) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020=
6CE91">list</a> '#:g0032)))
               (setit (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
00DB04DD">val</a>)
                 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00141=
62F">append</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE=
91">list</a> 'sys:rplaca)
                         (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0206CE91">list</a> '#:g0032) (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-0206CE91">list</a> val))))
      (setit (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</=
a> (getit) 1))))

  ;; Same expander call as above, with a call to expand added
  ;; to show the fully expanded version of the returned code,
  ;; in which the ;; setit and getit calls have disappeared,
  ;; replaced by their macro-expansions.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E0F5F5">expand</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 car-update-expander 'getit 'setit '(<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#D-0043">car</a> [a 0])
      '(setit (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+<=
/a> (getit) 1))))

  ;; --&gt; Resulting code:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
#:g0032 [a 0]))
    (sys:rplaca #:g0032 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-007C">+</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">ca=
r</a> #:g0032) 1)))

</tt></pre><tt>

</tt>

The main noteworthy points about the generated code are:
<dl class=3D"indent">

<dl class=3D"items">
<dt>-</dt><dd>
the
<tt>(car [a 0])</tt>
place is evaluated by evaluating the embedded form
<tt>[a 0]</tt>
and storing storing the resulting object into a hidden local variable.
That's as close a reference as we can make to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field.
</dd><dt>-</dt><dd>
the getter macro expands to code which simply calls the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
function on the cell.
</dd><dt>-</dt><dd>
the setter uses a system function called
<tt>sys:rplaca</tt>,
which differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a></t=
t>
in that it returns the stored value, rather than the cell.
</dd></dl>
</dl>
<p>
</p></dd></dl>
<a name=3D"N-036C9591">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.3">9.29.3</a=
> The Clobber Expander</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lambda (</tt><tt><i>simple-setter-sym</i></tt><tt> </tt><t=
t><i>place-form</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><=
i>body-form</i></tt><tt>) ...)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The clobber expander is a code-writer similar to the update expander.
It takes a
<tt><i>body-form</i></tt>
argument, and returns a larger form which surrounds this form
with additional program code.
</p><p>
The returned block of code has one main abstract action.
It must arrange for the evaluation of
<tt><i>body-form</i></tt>
in a lexical environment in which a lexical macro or lexical function
exists which has the name requested by the
<tt><i>simple-setter-sym</i></tt>
argument.
</p><p>
The simple setter local macro written by the clobber expander is similar to=
 the
local setter written by the update expander. It has exactly the
same interface, performs the same action of storing a value into
the place, and returns the new value.
</p><p>
The difference is that its logic may be considerably simplified by the
assumption that the place is being subject to exactly one store,
and no access.
</p><p>
A place update macro which uses a clobber expander, and calls it more than
once, break the assumption; doing so may result in multiple evaluations
of the
<tt><i>place-form</i></tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-03BF73F8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.4">9.29.4</a=
> The Delete Expander</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lambda (</tt><tt><i>deleter-sym</i></tt><tt> </tt><tt><i>p=
lace-form</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><=
i>body-form</i></tt><tt>) ...)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The delete expander is a code-writer similar to clobber expander.
It takes a
<tt><i>body-form</i></tt>
arguments, and returns a larger form which surrounds this form
with additional program code.
</p><p>
The returned block of code has one main abstract action.
It must arrange for the evaluation of
<tt><i>body-form</i></tt>
in a lexical environment in which a lexical macro or lexical function
exists which has the name requested by the
<tt><i>deleter-sym</i></tt>
argument.
</p><p>
The deleter macro written by the clobber expander takes no arguments.
It may be called at most once. It returns the previous value of the
place, and arranges for its obliteration, whatever that means for
that particular kind of place.
</p><p>

</p></dd></dl>
<a name=3D"N-006EA023">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.5">9.29.5</a=
> Macro <tt>with-update-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-update-expander (</tt><tt><i>getter</i></tt><tt> </tt=
><tt><i>setter</i></tt><tt>) </tt><tt><i>place</i></tt><tt> </tt><tt><i>env=
</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>
macro evaluates the
<tt><i>body-form</i></tt>
argument, whose result is expected to be a Lisp form.
The macro adds additional code around this code, and the result is returned=
.
This additional code is called the
<i>place-access code</i>.

</p><p>
The
<tt><i>getter</i></tt>
and
<tt><i>setter</i></tt>
arguments must be symbols. Over the evaluation of the
<tt><i>body-form</i></tt>,
these symbols are bound to the names of local functions which
are provided in the place-access code.
</p><p>
The
<tt><i>place</i></tt>
argument is a form which evaluates to a syntactic place. The generated
place-access code is based on this place.
</p><p>
The
<tt><i>env</i></tt>
argument is a form which evaluates to a macro-expansion-time environment.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>
macro uses this environment to perform macro-expansion on the value of the
<tt><i>place</i></tt>
form, to obtain the correct update expander function for the fully
macro-expanded place.
</p><p>
The place-access code is generated by calling the update expander
for the expanded version of
<tt>place</tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following is an implementation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042131D">swap</a><=
/tt>
macro, which exchanges the contents of two places.
</p><p>
Two places are involved, and, correspondingly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>
macro is used twice, to add two instances of place-update code
to the macro's body.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> swap (place-0 place-1 :env env)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-gen=
syms</a> (tmp)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-u=
pdate-expander</a> (getter-0 setter-0) place-0 env
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with=
-update-expander</a> (getter-1 setter-1) place-1 env
          ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">l=
et</a> ((,tmp (,getter-0)))
             (,setter-0 (,getter-1))
             (,setter-1 ,tmp))))))
</tt></pre><tt>

</tt>

<p>
The basic logic for swapping two places is contained in the code template:
</p><p>
<tt>
</tt></p><pre><tt>  ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
13AF20B">let</a> ((,tmp (,getter-0)))
     (,setter-0 (,getter-1))
     (,setter-1 ,tmp))
</tt></pre><tt>

</tt>

<p>
The temporary variable named by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
symbol
<tt>tmp</tt>
is initialized by calling the getter function for
<tt><i>place-0</i></tt>.
Then the setter function of
<tt><i>place-0</i></tt>
is called in order to store the value of
<tt><i>place-1</i></tt>
into
<tt><i>place-0</i></tt>.
Finally, the setter for
<tt><i>place-1</i></tt>
is invoked to store the previously saved temporary value into
that place.
</p><p>
The name for the temporary variable is provided by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-gens=
yms</a></tt>
macro, but establishing the variable is the caller's responsibility;
this is seen as an explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
binding in the code template.
</p><p>
The names of the getter and setter functions are similarly provided
by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>
macros. However, binding those functions is the responsibility of that
macro. To achieve this, it adds the place-access code to the code generated=
 by
the
<tt>^(let ...)</tt>
backquote template.  In the following example macro-expansion, the addition=
al
code added around the template is seen. It takes the form of two
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
binding blocks, each added by an invocation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
ED5471">macroexpand</a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0042131D">swap</a> a b))

  --&gt;

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet</=
a> ((#:g0036 () 'a)      ;; getter macro for a
             (#:g0037 (val-expr)  ;; setter macro for a
               (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0014162=
F">append</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91=
">list</a> 'sys:setq) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0206CE91">list</a> 'a)
                       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0206CE91">list</a> val-expr))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet=
</a> ((#:g0038 () 'b)     ;; getter macro for b
               (#:g0039 (val-expr) ;; setter macro for b
                 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00141=
62F">append</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE=
91">list</a> 'sys:setq) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0206CE91">list</a> 'b)
                         (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0206CE91">list</a> val-expr))))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a=
> ((#:g0035 (#:g0036)))  ;; temp &lt;- a
        (#:g0037 (#:g0038))       ;; a &lt;- b
        (#:g0039 #:g0035))))      ;; b &lt;- temp
</tt></pre><tt>

</tt>

<p>
In this expansion, for example
<tt>#:g0036</tt>
is the generated symbol which forms the value of the
<tt>getter-0</tt>
variable in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042131D">swap</a><=
/tt>
macro. The getter is a macro which simply expands to a
<tt>a</tt>:
straightforward access to the variable a.
The
<tt>#:g0035</tt>
symbol is the value of the
<tt>tmp</tt>
variable. Thus the swap macro's
<tt>

^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((,=
tmp (,getter-0))) ...)
</tt>

has turned into
<tt>

^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((#=
:g0035 (#:g0036))) ...)
</tt>

</p><p>
A full expansion, with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
local macros expanded out:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
E0F5F5">expand</a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
42131D">swap</a> a b))

  --&gt;

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
#:g0035 a))
    (sys:setq a b)
    (sys:setq b #:g0035))
</tt></pre><tt>

</tt>

<p>
In other words, the original syntax
<tt>

(,getter-0)
</tt>

became
<tt>

(#:g0036)
</tt>

and finally just
<tt>a</tt>.
</p><p>
Similarly,
<tt>

(,setter-0 (,getter-1))
</tt>

became the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macrolet<=
/a></tt>
invocations
<tt>

(#:g0037 (#:g0038))
</tt>

which finally turned into:
<tt>(sys:setq a b)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0181ED4C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.6">9.29.6</a=
> Macro <tt>with-clobber-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-clobber-expander (</tt><tt><i>simple-setter</i></tt><=
tt>) </tt><tt><i>place</i></tt><tt> </tt><tt><i>env</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clob=
ber-expander</a></tt>
macro evaluates
<tt><i>body-form</i></tt>,
whose result is expected to be a Lisp form. The macro adds additional code
around this form, and the result is returned. This additional code is calle=
d
the
<i>place-access code</i>.

</p><p>
The
<tt><i>simple-setter</i></tt>
argument must be a symbol. Over the evaluation of the
<tt><i>body-form</i></tt>,
this symbol is bound to the name of a functions which
are provided in the place-access code.
</p><p>
The
<tt><i>place</i></tt>
argument is a form which evaluates to a syntactic place. The generated
place-access code is based on this place.
</p><p>
The
<tt><i>env</i></tt>
argument is a form which evaluates to a macro-expansion-time environment.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clob=
ber-expander</a></tt>
macro uses this environment to perform macro-expansion on the value of the
<tt><i>place</i></tt>
form, to obtain the correct update expander function for the fully
macro-expanded place.
</p><p>
The place-access code is generated by calling the update expander
for the expanded version of
<tt>place</tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following implements a simple assignment statement, similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
except that it only handles exactly two arguments:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> assign (place new-value :env env)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clo=
bber-expander</a> (setter) place env
      ^(,setter ,new-value)))
</tt></pre><tt>

</tt>

<p>
Note that the correct evaluation order of
<tt>place</tt>
and
<tt>new-value</tt>
is taken care of, because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clob=
ber-expander</a></tt>
generates the code which performs all the necessary evaluations of
<tt>place</tt>.
This evaluation occurs before the code which is generated by
<tt>

^(,setter ,new-value)
</tt>

part is evaluated, and that code is what evaluates
<tt>new-value</tt>.
</p><p>
Suppose that a macro were desired which allows assignment to be notated in =
a right to left
style, as in:
</p><p>
<tt>
</tt></p><pre><tt>   (assign 42 a)  ;; store 42 in variable a
</tt></pre><tt>

</tt>

<p>
Now, the new value must be evaluated prior to the place, if left to right
evaluation order is to be maintained. The standard
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C211C1">push</a><=
/tt>
macro has this property: the push value is on the left, and the place
is on the right.
</p><p>
Now, the code has to explicitly take care of the order, like this:
</p><p>
<tt>
</tt></p><pre><tt>  ;; WRONG! We can't just swap the parameters;
  ;; place is still evaluated first, then new-value:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> assign (new-value place :env env)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clo=
bber-expander</a> (setter) place env
      ^(,setter ,new-value)))

  ;; Correct: arrange for evaluation of new-value first,
  ;; then place:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> assign (new-value place :env env)
    (with-gensym (tmp)
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</=
a> ((,tmp ,new-value))
         ,(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">wi=
th-clobber-expander</a> (setter) place env
           ^(,setter ,tmp)))))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02A6E020">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.7">9.29.7</a=
> Macro <tt>with-delete-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-delete-expander (</tt><tt><i>deleter</i></tt><tt>) </=
tt><tt><i>place</i></tt><tt> </tt><tt><i>env</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6E020">with-dele=
te-expander</a></tt>
macro evaluates
<tt><i>body-form</i></tt>,
whose result is expected to be a Lisp form.
The macro adds additional code
around this code, and the resulting code is returned. This additional code =
is
called the
<i>place-access code</i>.

</p><p>
The
<tt><i>deleter</i></tt>
argument must be a symbol. Over the evaluation of the
<tt><i>body-form</i></tt>,
this symbol is bound to the name of a functions which
are provided in the place-access code.
</p><p>
The
<tt><i>place</i></tt>
argument is a form which evaluates to a syntactic place. The generated
place-access code is based on this place.
</p><p>
The
<tt><i>env</i></tt>
argument is a form which evaluates to a macro-expansion-time environment.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6E020">with-dele=
te-expander</a></tt>
macro uses this environment to perform macro-expansion on the value of the
<tt><i>place</i></tt>
form, to obtain the correct update expander function for the fully
macro-expanded place.
</p><p>
The place-access code is generated by calling the update expander
for the expanded version of
<tt>place</tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following implements the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
macro:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> del (place :env env)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6E020">with-del=
ete-expander</a> (deleter) place env
      ^(,deleter)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03B6BCE9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.8">9.29.8</a=
> Function <tt>call-update-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call-update-expander </tt><tt><i>getter</i></tt><tt> </tt>=
<tt><i>setter</i></tt><tt> </tt><tt><i>place</i></tt><tt> </tt><tt><i>env</=
i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><t=
t><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-upda=
te-expander</a></tt>
function provides an alternative interface for making use of an update
expander, complementary to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>.
</p><p>
Arguments
<tt><i>getter</i></tt>
and
<tt><i>setter</i></tt>
are symbols, provided by the caller. These are passed to the update
expander function, and are used for naming local functions in the
generated code which the update expander adds to
<tt><i>body-form</i></tt>.
</p><p>
The
<tt><i>place</i></tt>
argument is a place which has not been subject to macro-expansion.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-upda=
te-expander</a></tt>
function takes on the responsibility for macro-expanding the place.
</p><p>
The
<tt><i>env</i></tt>
parameter is the macro-expansion environment object required to
correctly expand
<tt>place</tt>
in its original environment.
</p><p>
The
<tt><i>body-form</i></tt>
argument represents the source code of a place update operation.
This code makes references to the local functions whose names
are given by
<tt><i>getter</i></tt>
and
<tt><i>setter</i></tt>.
Those arguments allow the update expander to write these functions
with the matching names expected by
<tt><i>body-form</i></tt>.
</p><p>
The return value is an object representing source code which incorporates
the
<tt><i>body-form</i></tt>,
augmenting it with additional code which evaluates
<tt>place</tt>
to determine its location, and provides place accessor local functions
expected by the
<tt><i>body-form</i></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following shows how to implement a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>
macro using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-upda=
te-expander</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> with-update-expander ((getter setter)
                                  unex-place env body)
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-ge=
nsyms</a> (,getter ,setter)
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-=
update-expander</a> ,getter ,setter
                             ,unex-place ,env ,body)))
</tt></pre><tt>

</tt>

<p>
Essentially, all that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006EA023">with-upda=
te-expander</a></tt>
does is to choose the names for the local functions, and bind them
to the local variable names it is given as arguments. Then it
calls
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-upda=
te-expander</a></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Implement the swap macro using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-upda=
te-expander</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> swap (place-0 place-1 :env env)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-gen=
syms</a> (tmp getter-0 setter-0 getter-1 setter-1)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call-u=
pdate-expander</a> getter-0 setter-0 place-0 env
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6BCE9">call=
-update-expander</a> getter-1 setter-1 place-1 env
          ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">l=
et</a> ((,tmp (,getter-0)))
             (,setter-0 (,getter-1))
             (,setter-1 ,tmp))))))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0223827D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.9">9.29.9</a=
> Function <tt>call-clobber-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call-clobber-expander </tt><tt><i>simple-setter</i></tt><t=
t> </tt><tt><i>place</i></tt><tt> </tt><tt><i>env</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <=
/tt><tt><i>body-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223827D">call-clob=
ber-expander</a></tt>
function provides an alternative interface for making use of a clobber
expander, complementary to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0181ED4C">with-clob=
ber-expander</a></tt>.
</p><p>
Argument
<tt><i>simple-setter</i></tt>
is a symbol, provided by the caller. It is passed to the clobber
expander function, and is used for naming a local function in the
generated code which the update expander adds to
<tt><i>body-form</i></tt>.
</p><p>
The
<tt><i>place</i></tt>
argument is a place which has not been subject to macro-expansion.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0223827D">call-clob=
ber-expander</a></tt>
function takes on the responsibility for macro-expanding the place.
</p><p>
The
<tt><i>env</i></tt>
parameter is the macro-expansion environment object required to
correctly expand
<tt>place</tt>
in its original environment.
</p><p>
The
<tt><i>body-form</i></tt>
argument represents the source code of a place update operation.
This code makes references to the local function whose name
is given by
<tt><i>simple-setter</i></tt>.
That argument allows the update expander to write this function
with the matching name expected by
<tt><i>body-form</i></tt>.
</p><p>
The return value is an object representing source code which incorporates
the
<tt><i>body-form</i></tt>,
augmenting it with additional code which evaluates
<tt>place</tt>
to determine its location, and provides the clobber local function
to the
<tt><i>body-form</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-021E7CC3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.10">9.29.10<=
/a> Function <tt>call-delete-expander</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call-delete-expander </tt><tt><i>deleter</i></tt><tt> </tt=
><tt><i>place</i></tt><tt> </tt><tt><i>env</i></tt><tt> </tt><tt><i>body-fo=
rm</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021E7CC3">call-dele=
te-expander</a></tt>
function provides an alternative interface for making use of a delete
expander, complementary to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6E020">with-dele=
te-expander</a></tt>.
</p><p>
Argument
<tt><i>deleter</i></tt>
is a symbol, provided by the caller. It is passed to the delete
expander function, and is used for naming a local function in the
generated code which the update expander adds to
<tt><i>body-form</i></tt>.
</p><p>
The
<tt><i>place</i></tt>
argument is a place which has not been subject to macro-expansion.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021E7CC3">call-dele=
te-expander</a></tt>
function takes on the responsibility for macro-expanding the place.
</p><p>
The
<tt><i>env</i></tt>
parameter is the macro-expansion environment object required to
correctly expand
<tt>place</tt>
in its original environment.
</p><p>
The
<tt><i>body-form</i></tt>
argument represents the source code of a place delete operation.
This code makes references to the local function whose name
is given by
<tt><i>deleter</i></tt>.
That argument allows the update expander to write this function
with the matching name expected by
<tt><i>body-form</i></tt>.
</p><p>
The return value is an object representing source code which incorporates
the
<tt><i>body-form</i></tt>,
augmenting it with additional code which evaluates
<tt>place</tt>
to determine its location, and provides the delete local function
to the
<tt><i>body-form</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-006E03C4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.11">9.29.11<=
/a> Macro <tt>define-modify-macro</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(define-modify-macro </tt><tt><i>name</i></tt><tt> </tt><tt=
><i>parameter-list</i></tt><tt> </tt><tt><i>function-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E03C4">define-mo=
dify-macro</a></tt>
macro provides a simplified way to write certain kinds of place update
macros. Specifically, it provides a way to write place update macros
which modify a place by retrieving the previous value, pass it through
a function (perhaps together with some additional arguments), and then stor=
e
the resulting value back into the place and return it.
</p><p>
The
<tt><i>name</i></tt>
parameter specifies the name for the place update macro to be written.
</p><p>
The
<tt><i>function-name</i></tt>
parameter must specify a symbol: the name of the update function.
</p><p>
The update macro and update function both take at least one parameter:
the place to be updated, and its value, respectively.
</p><p>
The
<tt><i>parameter-list</i></tt>
specifies the additional parameters for update function, which will also
become additional parameters of the macro. Because it is a
function parameter list, it cannot use the special destructuring features o=
f
macro parameter lists, or the
<tt>:env</tt>
or
<tt>:whole</tt>
special parameters. It can use optional parameters, and may be empty.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E03C4">define-mo=
dify-macro</a></tt>
macro writes a macro called
<tt><i>name</i></tt>.
The leftmost parameter of this macro is a place, followed by the additional=
 arguments
specified by
<tt><i>parameter-list</i></tt>.
The macro will arrange for the evaluation of the place argument to determin=
e
the place location.  It will then retrieve and save the prior value of the
place, and evaluate the remaining arguments. The prior value of the
place, and the values of the additional arguments, are all passed to
<tt><i>function</i></tt>
and the resulting value is then stored back into the location previously
determined for
<tt><i>place</i></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Some standard place update macros are implementable using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E03C4">define-mo=
dify-macro</a></tt>,
such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
macro reads the old value of the place, then passes it through the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
(plus) function, along with an extra argument: the delta value, which
defaults to one. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
macro could be written using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E03C4">define-mo=
dify-macro</a></tt>
as follows:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
6E03C4">define-modify-macro</a> inc (: (delta 1)) +)
</tt></pre><tt>

</tt>

<p>
Note that the argument list
<tt>(: (delta 1))</tt>
doesn't specify the place, because the place is the implicit leftmost
argument of the macro which isn't given a name. With the above definition
in place, when
<tt>(inc (car a))</tt>
is invoked, then
<tt>(car a)</tt>
is first reduced to a location, and that location's value is retrieved and
saved. Then the
<tt>delta</tt>
parameter s evaluated to its value, which has defaulted to 1, since
the argument was omitted.
Then these two values are passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
function, and so 1 is added to the value previously retrieved from
<tt>(car a)</tt>.
The resulting sum is then stored back
<tt>(car a)</tt>
without evaluating
<tt>(car a)</tt>
again.
</p><p>

</p></dd></dl>
<a name=3D"N-00F92066">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.12">9.29.12<=
/a> Macro <tt>defplace</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defplace </tt><tt><i>place-destructuring-args</i></tt><tt>=
 </tt><tt><i>body-sym</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</t=
t><tt><i>getter-sym</i></tt><tt> </tt><tt><i>setter-sym</i></tt><tt> </tt><=
tt><i>update-body</i></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [(</=
tt><tt><i>ssetter-sym</i></tt><tt> </tt><tt><i>clobber-body</i></tt><tt>)=
=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
; [(</tt><tt><i>deleter-sym</i></tt><tt> </tt><tt><i>delete-body</i></tt><t=
t>)]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>
macro is used to introduce a new kind of syntactic place.
It writes the update expander, and optionally clobber and delete
expander functions, from a simpler, more compact specification,
and automatically registers the resulting functions. The compact specificat=
ion
of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>
call contains only code fragments for the expander functions.
</p><p>
The name and syntax of the place is determined by the
<tt><i>place-destructuring-args</i></tt>
argument, which is macro-style parameter list whose structure
mimics that of the the place. In particular, its leftmost symbol
gives the name under which the place is registered.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>
macro provides automatic destructuring of the syntactic place,
so that the expander code fragments can refer to the components
of a place by name.
</p><p>
The
<tt><i>body-sym</i></tt>
parameter must be be a symbol. This symbol will capture the
<tt><i>body-forms</i></tt>
parameter which is passed to the update expander, clobber
expander or delete expander. The code fragments then have
access to the the body forms via this name.
</p><p>
The
<tt><i>getter-sym</i></tt>,
<tt><i>setter-sym</i></tt>,
and
<tt><i>update-body</i></tt>
parenthesized triplet specify the update expander fragment.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>
macro will bind
<tt><i>getter-sym</i></tt>
and
<tt><i>setter-sym</i></tt>
to symbols.  The
<tt><i>update-body</i></tt>
must then specify a template of code which evaluates the syntactic place to
determine its storage location, and provides a pair of local functions, usi=
ng
these two symbols as their name. The template must also insert the
<tt><i>body-sym</i></tt>
forms into the scope of these local functions, and the place determining co=
de.
</p><p>
The
<tt><i>setter-sym</i></tt>
and
<tt><i>clobber-body</i></tt>
arguments similarly specify an optional clobber expander fragment,
as a single optional argument. If specified, the
<tt><i>clobber-body</i></tt>
must generate a local function named using
<tt><i>setter-sym</i></tt>
wrapped around
<tt><i>body-sym</i></tt>
forms.
</p><p>
The
<tt><i>deleter-sym</i></tt>
and
<tt><i>deleter-body</i></tt>
likewise specify a delete expander fragment. If this is omitted,
then the place shall not support deletion.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Implementation of the place denoting the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
F92066">defplace</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
043">car</a> cell) body

    ;; the update expander fragment
    (getter setter
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034F045B">with-g=
ensyms</a> (cell-sym) ;; temporary symbol for cell
        ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let=
</a> ((,cell-sym ,cell)) ;; evaluate place to cell
           ;; getter and setter access cell via temp var
           (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">m=
acrolet</a> ((,getter ()
                         ^(<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0043">car</a> ,',cell-sym))
                      (,setter (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-00DB04DD">val</a>)
                         ^(sys:rplaca ,',cell-sym ,val)))

             ;; insert body form from place update macro
             ,body))))

    ;; clobber expander fragment: simpler: no need
    ;; to evaluate cell to temporary variable.
    (ssetter
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macro=
let</a> ((,ssetter (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D=
B04DD">val</a>)
                     ^(sys:rplaca ,',cell ,val)))
        ,body))

    ;; deleter: delegate to pop semantics:
    ;; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> a)) =3D=
=3D (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F39D2">pop</a> =
a).
    (deleter
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AC12C0">macro=
let</a> ((,deleter () ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-017F39D2">pop</a> ,',cell)))
         ,body)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0157E559">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.13">9.29.13<=
/a> Macro <tt>defset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defset </tt><tt><i>name</i></tt><tt> </tt><tt><i>params</i=
></tt><tt> </tt><tt><i>new-val-sym</i></tt><tt> </tt><tt><i>set-form</i></t=
t><tt>)=20




<br>&nbsp;&nbsp;(defset </tt><tt><i>get-fun-sym</i></tt><tt> </tt><tt><i>se=
t-fun-sym</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
macro provides a mechanism for introducing a new kind of syntactic place.
It is simpler to use than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>
and more concise, but not as general.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
macro is designed for situations in which a function or macro which evaluat=
es
all of its arguments is required to serve as a syntactic place.
It provides two flavors of syntax: the long form, indicated by giving
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
five arguments, and a short form, which uses two arguments.
</p><p>
In the long form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>,
the syntactic place is described by
<tt><i>name</i></tt>
and
<tt><i>params</i></tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
form expresses the request that call to the function or operator named
<tt><i>name</i></tt>
is to be treated as a syntactic place, which has arguments described by
the parameter list
<tt><i>params</i></tt>.
</p><p>
The
<tt><i>set-form</i></tt>
argument specifies an expression which generates the code for storing a new
value to the place.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
macro makes the necessary arrangements such that when an operator form
named by
<tt><i>name</i></tt>
is treated as a syntactic place, then at macro-expansion time, code is
generated to evaluate all of its argument expressions into machine-generate=
d
variables. The names of those variables are automatically bound to the
corresponding symbols given in the
<tt><i>params</i></tt>
argument list of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
syntax. Code is also generated to evaluate the expression which gives the
new value to be stored, and that is bound to a generated variable whose
name is bound to the
<tt>new-val-sym</tt>
symbol. Then arrangements are made to invoke the operator named by
<tt><i>name</i></tt>
and to evaluate the
<tt>set-form</tt>
in an environment in which these symbol bindings are visible.
The operator named
<tt><i>name</i></tt>
is invoked using an altered argument list which uses temporary symbols in p=
lace
of the original expressions. The task of
<tt>set-form</tt>
is to insert the values of the symbols from
<tt><i>params</i></tt>
and
<tt><i>new-val-sym</i></tt>
into a suitable code templates that will perform the store actions.
The code generated by
<tt>set-form</tt>
must also take on the responsibility of yielding the new value as its resul=
t.
</p><p>
If
<tt><i>params</i></tt>
list contains optional parameters, the default value expressions of those
parameters shall be evaluated in the scope of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
definition.
</p><p>
The
<tt><i>params</i></tt>
list may specify a rest parameter. In the expansion, this parameter will
capture a list of temporary symbols, corresponding to the list of variadic
argument expressions. For instance if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
parameter list for a place
<tt>g</tt>
is
<tt>(a b . c)</tt>,
featuring the rest parameter
<tt>c</tt>,
and its
<tt><i>set-form</i></tt>
is
<tt>^(s ,a ,b ,*c)</tt>
and the place is invoked as
<tt>(g (i) (j) (k) (l))</tt>
then parameter
<tt>c</tt>
will be bound to a list of gensyms such as
<tt>(#:g0123 #:g0124)</tt>
so that the evaluation of
<tt><i>set-form</i></tt>
will yield syntax resembling
<tt>(s #:g0121 #:g0122 #:g0123 #:g0124)</tt>.
Here, gensyms
<tt>#:g0123</tt>
and
<tt>#:g0124</tt>
are understood to be bound to the values of the expressions
<tt>(k)</tt>
and
<tt>(l)</tt>,
the two trailing parameters corresponding to the rest parameter
<tt>c</tt>.
</p><p>
Syntactic places defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
that have a rest parameter may be invoked with improper syntax such as
<tt>(set (g x y . z) v)</tt>.
In this situation, that rest parameter will be bound to the name of
a temporary variable which holds the value of
<tt>z</tt>
rather than to a list of temporary variable names holding the values
of trailing expressions.
The
<tt>set-form</tt>
must be prepared for this situation. In particular, the rest parameter's va=
lue
is an atom, then it cannot be spliced in the backquote syntax, except at th=
e
last position of a list.
</p><p>
Although syntactic places defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
perform macro-parameter-like destructuring of the place form, binding
unevaluated argument expressions to the parameter symbols,
nested macro parameter lists are not supported:
<tt><i>params</i></tt>
specifies a function parameter list.
</p><p>
The parameter list may use parameter macros, keeping in mind that
the parameter expansion is applied at the time the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
form is processed, specifying an expanded parameter list which
receives unevaluated expressions. The
<tt><i>set-form</i></tt>
may refer to all symbols produced by parameter list expansion, other
than generated symbols. For instance, if a parameter list macro
<tt>:addx</tt>
exists which adds the parameter symbol
<tt>x</tt>
to the parameter list, and this
<tt>:addx</tt>
is invoked in the
<tt><i>params</i></tt>
list of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>,
then
<tt>x</tt>
will be visible to the
<tt><i>set-form</i></tt>.
</p><p>
The short, two-argument form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
simply specifies the names of two functions or operators:
<tt>get-fun-sym</tt>
names the operator which accesses the place, and
<tt>set-fun-sym</tt>
names the operator which stores a new value into the place.
It is expected that all arguments of these operators are evaluated
expressions, and that the store operator takes one argument more
than the access operator. The operators are otherwise assumed to be
variadic: each instance of a place based on
<tt>get-fun-sym</tt>
individually determines how many arguments are passed to that operator
and to the one named by
<tt>set-fun-sym</tt>.
</p><p>
The definition
<tt>(defset g s)</tt>
means that
<tt>(inc (g x y))</tt>
will generate code which ensures that
<tt>x</tt>
and
<tt>y</tt>
are evaluated exactly once, and then those two values are passed as
arguments to
<tt>g</tt>
which returns the current value of the place. That value is then incremente=
d
by one, and stored into the place by calling the
<tt>s</tt>
function/operator with three arguments: the two values that were passed to
<tt>g</tt>
and the new value.  The exact number of arguments is determined by each
individual use of
<tt>g</tt>
as a place; the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
form doesn't specify the arity of
<tt>g</tt>
and
<tt>s</tt>,
only that
<tt>s</tt>
must accept one more argument relative to
<tt>g</tt>.
</p><p>
The following equivalence holds between the short and long forms:
</p><p>
<tt>
</tt></p><pre><tt>   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
157E559">defset</a> g s)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#N-0157E559">defset</a> g (. r) n ^(g ,*r) ^(s ,*r ,n))
</tt></pre><tt>

</tt>

<p>
Note:
the short form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
macro.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
as a syntactic place using a long form
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
57E559">defset</a> car (cell) new
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((n (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</=
a>)))
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet<=
/a> ((,n ,new))
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">pro=
gn</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a=
> ,cell ,n) ,n))))
</tt></pre><tt>

</tt>

<p>
Given such a definition, the expression
<tt>(inc (car (abc)))</tt>
expands to code closely resembling:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((#:g0048 (abc)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((#:g0050 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">su=
cc</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> #=
:g0048))))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000B">rplaca</a>=
 #:g0048 #:g0050)
      #:g0050))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
macro has arranged for the argument expression
<tt>(abc)</tt>
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
to be evaluated to a temporary variable
<tt>#:g0048</tt>,
a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>.
This, then, holds the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell being operated on.
At macro-expansion time, the variable
<tt>cell</tt>
from the parameter list specified by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>
is bound to this symbol. The access expression
<tt>(car #:0048)</tt>
to retrieve the prior value is automatically generated
by combining the name of the place
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
with the gensym to which its argument
<tt>(abc)</tt>
has been evaluated.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
variable was bound to the expression giving the new value, namely
<tt>(succ (car #:g0048))</tt>.
The
<tt><i>set-form</i></tt>
is careful to evaluate this only one time, storing its value into
the temporary variable
<tt>#:g0050</tt>,
referenced by the variable
<tt>n</tt>.
The
<tt><i>set-form</i></tt>'s
<tt>(rplaca ,cell ,n)</tt>
fragment thus turned into
<tt>(rplaca #:g0048 #:g0050)</tt>
where
<tt>#:g0048</tt>
references the cons cell being operated on, and
<tt>#:g0050</tt>
the calculated new value to be stored into its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field.
The
<tt><i>set-form</i></tt>
is careful to arrange for the new value
<tt>#:g0050</tt>
to be returned. Those place-mutating operators which yield the new value, s=
uch
as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
rely on this behavior.
</p><p>

</p></dd></dl>
<a name=3D"N-02C3089A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.14">9.29.14<=
/a> Macro <tt>define-place-macro</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(define-place-macro </tt><tt><i>name</i></tt><tt> </tt><tt>=
<i>macro-style-params</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



In some situations, an equivalence exists between two forms, only one
of which is recognized as a place. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C3089A">define-pl=
ace-macro</a></tt>
macro can be used to establish a form as a place in terms of a translation =
to
an equivalent form which is already a place.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C3089A">define-pl=
ace-macro</a></tt>
has the same syntax as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>.
It specifies a macro transformation for a compound form which has the
<tt><i>name</i></tt>
symbol in its leftmost position.
</p><p>
Place macro expansion doesn't use an environment; place macros are in a sin=
gle
global namespace, special to place macros. There are no lexically scoped pl=
ace
macros. Such an effect can be achieved by having a place macro expand to
an a form which is the target of a global or local macro, as necessary.
</p><p>
To support place macros, forms which are used as syntactic places are subje=
ct
to a modified macro-expansion algorithm:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
If a place macro exists for a form that is being used as a place, then the
that place macro is invoked to expand the
form, and the expansion is taken in place of the original form. This proces=
s
repeats until the form can no longer be expanded as a place macro, or
the place macro declines to expand the form by returning the unexpanded
input.
</dd><dt>2.</dt><dd>
A form that has been fully expanded as a place macro is then subject
to a single-round of macro-expansion, as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd-1</a></tt>,
which takes place in the original form's lexical environment.
If the form doesn't expand, or the result of expansion is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or a
non-symbolic atom, then the process terminates. Otherwise, the
process is repeated from step 1.
</dd></dl>
</dl>
<p>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C3089A">define-pl=
ace-macro</a></tt>
macro does not cause
<tt><i>name</i></tt>
to become
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">mboundp</=
a></tt>.
</p><p>
There can exist both an ordinary macro and a place macro of the same name.
In this situation, when the macro call appears as a place form, it is
expanded as a place macro, according to the above steps. When the macro cal=
l
appears as an evaluated form, not being used as a place, the form is
expanded using the ordinary macro.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D60463">first</a>=
</tt>
in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
C3089A">define-place-macro</a> first (obj)
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a> ,ob=
j))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-008212A0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.15">9.29.15<=
/a> Macro <tt>rlet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rlet ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form=
</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
operator. It establishes bindings for one or more
<tt><i>sym</i></tt>-s,
which are initialized using the values of
<tt><i>init-form</i></tt>-s.
</p><p>
Note that the simplified syntax for a variable which initializes to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
by default is not supported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>;
that is to say, the syntax
<tt><i>sym</i></tt>
cannot be used in place of the
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form</i></tt><tt>)=20

</tt>

syntax when
<tt><i>sym</i></tt>
is to be initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
macro differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
in that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
assumes that those
<tt><i>sym</i></tt>-s
whose
<tt><i>init-form</i></tt>-s,
after macro expansion,
are constant expressions
(according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A">constantp=
</a></tt>
function) may be safely implemented as a symbol macro rather than a lexical
variable.
</p><p>
Therefore
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
is suitable in situations in which simpler code is desired from the output
of certain kinds of machine-generated code, which binds local symbols:
code with fewer temporary variables.
</p><p>
On the other hand,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
is not suitable in some situations when true variables are required, which
are assignable, and provide temporary storage.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; WRONG! Real storage location needed.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a> (=
(flag nil))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042153F">flip</a>=
 flag)) ;; error: flag expands to nil

  ;; Demonstration of constant-propagation
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
a 42))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a>=
 ((x 1)
           (y a))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> x y)=
))  --&gt;  43

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E0F5F5">expand</a>
    '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a>=
 ((a 42))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</=
a> ((x 1)
             (y a))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> x =
y))))  --&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20=
B">let</a> ((a 42))
                           (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-013AF20B">let</a> ((y a))
                              (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-007C">+</a> 1 y)))
</tt></pre><tt>

</tt>

<p>
The last example shows that the
<tt>x</tt>
variable has disappeared in the expansion. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
macro turned it into into a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>
denoting the constant 1, which then propagated to the use site,
turning the expression
<tt>(+ x y)</tt>
into
<tt>(+ 1 y)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00821260">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.16">9.29.16<=
/a> Macro <tt>slet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(slet ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form=
</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00821260">slet</a><=
/tt>
a weaker form of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>
macro. Just like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00821260">slet</a><=
/tt>
reduces bindings initialized by constant expressions
to symbol macros. In addition, unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008212A0">rlet</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00821260">slet</a><=
/tt>
also reduces to symbol macros those bindings which
are initialized by symbol expressions (values of variables).
</p><p>

</p></dd></dl>
<a name=3D"N-008215E0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.17">9.29.17<=
/a> Macro <tt>alet</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(alet ({(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>init-form=
</i></tt><tt>)}*) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008215E0">alet</a><=
/tt>
("atomic" or "all") is a stronger form of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00821260">slet</a><=
/tt>
macro. All bindings initialized by constant expressions are
turned to symbol macros. Then, if all of the remaining bindings are
all initialized by symbol expressions, they are also turned to
symbol macros. Otherwise, none of the remaining bindings
are turned to symbol macros.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008215E0">alet</a><=
/tt>
macro can be used even in situations when it is possible that the initializ=
ing
forms the variables may have side effects through which they affect each
others' evaluations. In this situation
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008215E0">alet</a><=
/tt>
still propagates constants via symbol macros, and can eliminate the
remaining temporaries if they can all be made symbol macros for
existing variables: i.e. there doesn't exist any initialization form
with interfering side effects.
</p><p>

</p></dd></dl>
<a name=3D"N-03C5F850">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.18">9.29.18<=
/a> Macro <tt>define-accessor</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(define-accessor </tt><tt><i>get-function</i></tt><tt> </tt=
><tt><i>set-function</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
macro is used for turning a function into an accessor,
such that forms which call the function can be treated
as places.
</p><p>
Arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
are two symbols, which must name functions. When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
call is evaluated, the
<tt><i>get-function</i></tt>
symbol is registered as a syntactic place. Stores to the
place are handled via calls to
<tt><i>set-function</i></tt>.
</p><p>
If
<tt><i>get-function</i></tt>
names a function which takes N
arguments,
<tt><i>set-function</i></tt>
must name a function which takes N+1 arguments.
</p><p>
Moreover, in order for the accessor semantics to be correct
<tt><i>set-function</i></tt>
must treat its rightmost argument as the value being stored,
and must also return that value.
</p><p>
When a function call form targeting
<tt><i>get-function</i></tt>
is treated as a place which is subject
to an update operation (for instance an increment via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a></=
tt>
macro),
the accessor definition created by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
ensures that the arguments of
<tt><i>get-function</i></tt>
are evaluated only once, even though the update involves
a call to
<tt><i>get-function</i></tt>
and
<tt><i>set-function</i></tt>
with the same arguments. The argument forms are evaluated to
temporary variables, and these temporaries are used as the
arguments in the calls.
</p><p>
No other assurances are provided by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>.
</p><p>
In particular, if
<tt><i>get-function</i></tt>
and
<tt><i>set-function</i></tt>
internally each perform some redundant calculation over their arguments,
this cannot be optimized. Moreover, if that calculation has a visible effec=
t,
that effect is observed multiple times in an update operation.
</p><p>
If further optimization or suppression of multiple effects is required,
the more general
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F92066">defplace<=
/a></tt>
macro must be used to define the accessor. It may also be possible to
treat the situation  in a satisfactory way using a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C3089A">define-pl=
ace-macro</a></tt>
definition, which effectively then supplies inline code whenever a certain =
form
is used as a place, and that code itself is treated as a place.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C5F850">define-ac=
cessor</a></tt>
is similar to the short form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0157E559">defset</a=
></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01A2C58A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.19">9.29.19<=
/a> Special variables <tt>*place-update-expander*</tt>, <tt>*place-clobber-=
expander*</tt> and <tt>*place-delete-expander*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold hash tables, by means of which update expanders,
clobber expanders and delete expanders are registered, as associations
between symbols and functions.
</p><p>
If
<tt>[*place-update-expander* 'sym]</tt>
yields a function, then symbol
<tt>sym</tt>
is the basis for a syntactic place. If the expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then forms beginning with
<tt>sym</tt>
are not syntactic places. (The situation of a clobber accessor or delete
accessor being defined without an update expander is improper).
</p><p>

</p></dd></dl>
<a name=3D"N-01B680E6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.29.20">9.29.20<=
/a> Special variable <tt>*place-macro*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B680E6">*place-ma=
cro*</a></tt>
special variable holds the hash table of associations between
symbols and place macro expanders.
</p><p>
If the expression
<tt>[*place-macro* 'sym]</tt>
yields a function, then symbol
<tt>sym</tt>
has a binding as a place macro. If that
expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then there is no such binding: compound forms beginning with
<tt>sym</tt>
do not undergo place macro expansion.
</p><p>
</p></dd></dl>
<a name=3D"N-020A71DB">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.30">9.30</a> St=
ructural Pattern Matching</h3>



<p>


</p><p>
<a name=3D"N-018E0BFD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.30.1">9.30.=
1</a> Introduction</h4>


<p>
<b>TXR Lisp</b> provides a structural pattern matching system. Structural p=
attern
matching is a syntax which allows for the succinct expression of code
which classifies objects according to their shape and content, and which
accesses the elements within objects, or both.
</p><p>
The central concept in structural pattern matching is the resolution of a
pattern against an object. The pattern is specified as syntax which is part=
 of
the program code. The object is a run-time value of unknown type, shape and
other properties.  The primary pattern matching decision is Boolean: does t=
he
object match the pattern?  If the object matches the pattern, then it is
possible to execute an associated body of code in a scope in which variable=
s
occurring in the pattern take on values from the corresponding parts of the
object.
</p><p>
<a name=3D"N-03706E73">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.30.2">9.30.=
2</a> Pattern Matching Operators</h4>


<p>
Structural pattern matching is available via several different macro
operators, which are:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-matc=
h</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-mat=
ch</a></tt>.
Function and macro argument lists may also be augmented with pattern
matching using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
parameter macro.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-matc=
h</a></tt>
macro is the simplest. It tests an object against a pattern, and if there i=
s a
match, evaluates zero or more forms in an environment in which the pattern
variables have bindings to the corresponding elements of the object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match<=
/a></tt>
macro evaluates a single form if there is a match, in the scope of the
bindings established by the pattern, otherwise an alternative
form evaluated in a scope in which those bindings are absent.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
macro evaluates the same object against multiple clauses, each consisting o=
f a
pattern and zero or more forms. The first case whose pattern matches the ob=
ject
is selected. The forms associated with a matching clause are evaluated in
the scope the variables bound by that clause's pattern.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
macro provides a way to express an anonymous function whose argument list
is matched against multiple clauses similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-mat=
ch</a></tt>
provides a way to define a top-level function using the same concept.
</p><p>
<a name=3D"N-0289A0A7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.30.3">9.30.=
3</a> Syntax and Key Concepts</h4>


<p>
<b>TXR Lisp</b>'s structural pattern matching notation is template-based.
With the exception of structures and hash tables, objects are matched using
patterns which are based on their printed notation. For instance, the patte=
rn
<tt>(1 2 @a)</tt>
is a pattern matching the list
<tt>(1 2 3)</tt>
binding
<tt>a</tt>
to
<tt>3</tt>.
The notation supports lists, vectors, ranges and atoms. Atoms are compared
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function. Thus, in the above pattern, the 1 and 2 in the pattern match the
corresponding 1 and 2 atoms in the object using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
All parts of a pattern are static material which matches literally,
except those parts introduced by the meta prefix
<tt>@</tt>.
This prefix denotes variables like
<tt>@a</tt>
as well as useful pattern matching operators like
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a> </tt><t=
t><i>pattern</i></tt><tt>)=20

</tt>

which matches a list or sublist whose elements all match
<tt><i>pattern</i></tt>.
</p><p>
Structure objects are matched using a dedicated
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a> =
name ...)</tt>
operator rather than using
<tt>#S(name ...)</tt>
notation. The reason is that a struct literal produces an object
which loses information about how it was specified in the literal syntax,
but those details are critically important in pattern matching.
</p><p>
Similarly, hash objects are matched using a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a> ..=
.)</tt>
operator rather than
<tt>#H(...)</tt>
syntax. The reason is that the keys are not ordered in a hash
table, whereas the order of sub-patterns in a pattern operator
can be significant. One sub-pattern may be expected to produce
a match for a variable, which is then back-referenced in another
sub-pattern.
</p><p>
<a name=3D"N-0119500B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.30.4">9.30.=
4</a> Variables in Patterns</h4>


<p>
Patterns use meta-symbols for denoting variables. Variables must
be either bindable symbols, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
which has a special meaning: the pattern variable
<tt>@nil</tt>
matches any object, and binds no variable.
</p><p>
Pattern variables are ordinary Lisp variables. Whereas in ordinary non-patt=
ern
matching Lisp code, it is always unambiguous whether a variable is being bo=
und
or referenced, this is deliberately not the case in patterns. A variable
occurring in a pattern may be a fresh variable, or a reference to an existi=
ng
one. The difference between these situations is not apparent from the synta=
x
of the pattern; it depends on the context established by the scope.
</p><p>
With one exception, if a pattern contains a variable which is already in
the surrounding scope, including a global variable, then it refers to that
variable. Otherwise, it freshly binds the variable.
The exception is that pattern operator
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a>)=
</tt>
always binds a fresh variable.
</p><p>
When a pattern variable refers to an existing variable, then each occurrenc=
e
of that variable must match an object which is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to the value of that variable.
For instance, the following function returns the third element of a list, i=
f
the first two elements are repetitions of the
<tt>x</tt>
argument, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> x-x-y (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0206CE91">list</a> x)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-mat=
ch</a> (@x @x @y) list y))

  (x-x-y '(1 1 2) 1) -&gt; 2
  (x-x-y '(1 2 3) 1) -&gt; nil    ;; no @x @x match
  (x-x-y '(1 1 2 r2) 1) -&gt; nil ;; list too long
</tt></pre><tt>

</tt>

<p>
If the variable does not exist in the scope surrounding the pattern,
then the leftmost occurrence of the variable establishes a binding,
taking the value from is corresponding object being matched by that
occurrence of the variable. The remaining
occurrences of the variable, if any, must correspond to objects which are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to that value, or else there is no match.
For instance, the pattern
<tt>(@a @a)</tt>
matches the list like
<tt>(1 1)</tt>
as follows. First
<tt>@a</tt>
binds to the leftmost
<tt>1</tt>
and then the second
<tt>1</tt>
matches the existing value of that
<tt>a</tt>.
An input such as
<tt>(1 2)</tt>
fails to match because the second occurrence of
<tt>@a</tt>
retrieves an object that is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to that variable's existing value.
</p><p>
A pattern can contain multiple occurrences of the same symbol as a variable=
.
These may or may not refer to the same variable.  Two occurrences of the sa=
me
symbol refer to distinct variables if:
</p><p>
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
they are freshly bound in separate
branches of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a>)</tt=
>
operator; or
</dd><dt>2.</dt><dd>
one of the two variables is freshly bound by the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a>)=
</tt>
operator and the other variable occurs outside of that
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a>)=
</tt>;
or
</dd><dt>3.</dt><dd>
or both of the variables are freshly bound using
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a>)=
</tt>.
</dd></dl>
</dl>
<p>
Any other two or more occurrences same symbol occurring in the same pattern
refer to the same variable.
</p><p>
<a name=3D"N-02914C7A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.30.5">9.30.=
5</a> Comparison to Macro Parameter Lists</h4>


<p>
<b>TXR Lisp</b>'s macro-style parameter lists, appearing in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
and related macros, also provide a form of structural pattern matching.
Macro-style parameter list pattern matching is limited to objects of
one kind: tree structures made of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells. It is only useful for matching on
shape, not content. For example,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A580D9">tree-bind=
</a></tt>
cannot express the idea of matching a list whose first element is the symbo=
l
<tt>a</tt>
and whose third element is
<tt>42</tt>.
Moreover, every position in the tree pattern much specify a variable
which captures the corresponding element of the structure. For instance,
a pattern which matches a three-element list must specify three variables,
one for each list position. This is because macro-style parameter lists are
oriented toward writing macros, and macros usually make use of every parame=
ter
position.
</p><p>
<a name=3D"N-023B33E3">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31">9.31</a=
> Pattern Matching Notation</h3>



<p>


</p><p>
The pattern-matching notation is documented in the following
sections; a section describing the pattern matching macros follow.
</p><p>
<a name=3D"N-0372AD4F">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.1">9.31.=
1</a> Atom match</h4>


A pattern consisting of an atom other than a vector
matches a similar object. The similarity is determined using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function.
<p>
The atom is not subject to evaluation, which means that a symbolic atom sta=
nds
for itself, and not the value of a variable.
</p><p>
</p><dl>
<dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; the pattern 1 matches the object 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> 1 1 'yes 'no) --&gt; yes

  ;; the object 0 does not match
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> 1 0 'yes 'no) --&gt; no

  ;; a matches a, does not match b
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
sym 'a))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</a=
> a sym 'yes 'no)
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if=
-match</a> b sym 'yes 'no)))
  --&gt; (yes no)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-0195411E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.2">9.31.2</a=
> Variable match</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@</tt><tt><i>symbol</i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



A meta-symbol can be used as a pattern expression.
This pattern unconditionally matches an object of any kind.
</p><p>
The
<tt><i>symbol</i></tt>
is required to be a either a bindable symbol according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function, or else the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>symbol</i></tt>
is a bindable symbol, which has not binding in scope,
then a variable by that name is freshly bound, and takes
on the corresponding object as its value.
</p><p>
If
<tt><i>symbol</i></tt>
is a bindable symbol with an existing binding, then
the corresponding object must be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to that variable's existing value, or else the match fails.
</p><p>
If
<tt><i>symbol</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the match succeeds unconditionally, without binding a variable.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">when-match</a> @a 42 (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0206CE91">list</a> a)) -&gt; (42)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> (@a @b @c) '(1 2 3) (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0206CE91">list</a> c b a)) -&gt; (3 2 1)

  ;; No match: list is longer than pattern
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> (@a @b) '(1 2 3) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0206CE91">list</a> a b)) -&gt; nil

  ;; Use of nil in dot position to match longer list
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> (@a @b . @nil) '(1 2 3) (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0206CE91">list</a> a b)) -&gt; (1 2)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-0272CE71">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.3">9.31.3</a=
> List match</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(</tt><tt><i>pattern</i></tt><tt>+)=20




<br>&nbsp;&nbsp;(</tt><tt><i>pattern</i></tt><tt>+ . </tt><tt><i>pattern</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Pattern syntax consisting of a non-empty, possibly improper list
matches list structure. A pattern expression may be specified in the
dotted position. If it is omitted, then there is an implicit terminating
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
which constitutes an atom expression matching
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A list pattern matches a list of the same shape. For each
<tt><i>pattern</i></tt>
expressions, there must exist an item in the list.
</p><p>
A match occurs when every
<tt><i>pattern</i></tt>
matches the corresponding element of the list, including the
<tt><i>pattern</i></tt>
in the dotted position.
</p><p>
Because the dotted position
<tt><i>pattern</i></tt>
matches a list, it is possible for a short pattern
to match a longer list.
</p><p>
The syntax is indicated as requiring at least one
<tt><i>pattern</i></tt>
because otherwise the list is empty, which corresponds to the
atom pattern
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The syntax
<tt>




(. </tt><tt><i>pattern</i></tt><tt>)=20

</tt>

is valid, but indistinguishable from
<tt><i>pattern</i></tt>
and therefore is not a list pattern.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">if-match</a> (@a @b @c . @d) '(1 2 3 . 4) (<a href=3D"http://nongnu=
.org/txr/txr-manpage.html#N-0206CE91">list</a> d c b a))
  --&gt; (4 3 2 1)

  ;; 2 doesn't satisfy oddp
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> (@(oddp @a) @b @c . @d) '(2 x y z)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 a b c d)
    :no-match)
  --&gt; :no-match

  ;; 1 and 2 match, a takes (3 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> (1 2 . @a) '(1 2 3 4) a) --&gt; (3 4)

  ;; nesting
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> ((1 2 @a) @b) '((1 2 3) 4) (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-0206CE91">list</a> a b)) -&gt; (3 4)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-01E67541">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.4">9.31.4</a=
> Vector match</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;#(</tt><tt><i>pattern</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



A pattern match for a vector is expressed using vector notation enclosing
pattern expressions.  This pattern matches a vector object which contains
exactly as many elements as there are patterns.  Each pattern is applied
against the corresponding vector element.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; empty vector pattern matches empty vector
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> #() #() :yes :no) -&gt; :yes

  ;; empty vector pattern fails to match non-empty vector
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> #() #(1) :yes :no) -&gt; :no

  ;; match with nested list and vector
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> #((1 @a) #(3 @b)) #((1 2) #(3 4)) (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-0206CE91">list</a> a b))
  --&gt; (2 4)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-0381AB6D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.5">9.31.5</a=
> Range match</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;#R(</tt><tt><i>from-pattern</i></tt><tt> </tt><tt><i>to-pat=
tern</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



A pattern match for a range can be expressed by embedding pattern
expressions in the
<tt>#R</tt>
notation. The resulting pattern requires the corresponding object
to be a range, otherwise the match fails. If the corresponding
object is a range, then the
<tt><i>from-pattern</i></tt>
is matched against its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
and the
<tt><i>to-pattern</i></tt>
is matched against its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
part.
</p><p>
Note that if the range expression notation
<tt>a..b</tt>
is used as a pattern, that is actually a list pattern, due to
that being a syntactic sugar for
<tt>(rcons a b)</tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">if-match</a> #R(10 20) 10..20 :yes :no) -&gt; :yes
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> #R(10 20) #R(10 20) :yes :no) -&gt; :yes
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> #R(10 20) #R(1 2) :yes :no) -&gt; :no

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> #R(@a @b) 1..2 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
06CE91">list</a> a b)) -&gt; (1 2)

  ;; not a range match! rcons syntax match
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @a..@b '1..2 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206=
CE91">list</a> a b)) -&gt; (1 2)

  ;; above, de-sugared:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</=
a> @a @b) '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">r=
cons</a> 1 2) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91=
">list</a> a b)) -&gt; (1 2)

</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03DE4A45">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.6">9.31.6</a=
> Pattern operator <tt>struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(struct </tt><tt><i>name</i></tt><tt> {</tt><tt><i>slot-na=
me</i></tt><tt> </tt><tt><i>pattern</i></tt><tt>}*)=20




<br>&nbsp;&nbsp;@(struct </tt><tt><i>pattern</i></tt><tt> {</tt><tt><i>slot=
-name</i></tt><tt> </tt><tt><i>pattern</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
pattern operator matches a structure object. The operator
supports two modes of matching, the choice of which depends on whether the
first argument is a
<tt><i>name</i></tt>
or a
<tt><i>pattern</i></tt>.
</p><p>
The first argument is considered a
<tt><i>name</i></tt>
if it is a bindable symbol according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function. In this situation, the operator operates in
strict mode.  Otherwise, the operator is in loose mode.
</p><p>
The
<tt><i>name</i></tt>
or
<tt><i>pattern</i></tt>
argument is followed by zero or more
<tt><i>slot-name pattern</i></tt>
pairs, which are not enclosed in lists, similarly to the way
slots are presented in the
<tt>#S</tt>
struct syntax and in the argument conventions of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
macro.
</p><p>
In strict mode,
<tt><i>name</i></tt>
is assumed to be the name of an existing struct type.
The object being matched is tested whether it is a subtype of this type, as
if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00699D3B">subtypep<=
/a></tt>
function. If it isn't, the match fails.
</p><p>
In loose mode, the object being matched is tested whether it is a structure
object of any structure type. If it isn't, the match fails.
</p><p>
In strict mode, each
<tt><i>slot-name pattern</i></tt>
pair requires that the object's slot of that name contain
a value which matches
<tt><i>pattern</i></tt>.
The operator assumes that all the
<tt><i>slot-name</i></tt>-s
are slots of the struct type indicated by
<tt><i>name</i></tt>.
</p><p>
In loose mode, no assumption is made that the object actually has the
slots specified by the
<tt><i>slot-name</i></tt>
arguments. The object's structure type is inquired to
determine whether it has each of those slots. If it doesn't, the match fail=
s.
If the object has the required slots, then the values of those slots are
matched against the patterns.
</p><p>
In loose mode, the
<tt><i>pattern</i></tt>
given in the first argument position of the syntax is matched against the
object's structure type: the type itself, rather than its symbolic name.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; extract the month from a time structure
  ;; that is required to have a year of 2021.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a>=
 time year 2021 month @m)
              #S(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">=
time</a> year 2021 month 1)
    m) -&gt; 1

  ;; match any structure with name and value slots,
  ;; whose name is foo, and extract the value.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> widget ()
    name
    value)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> grommet ()
    name
    value)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">append-eac=
h</a> ((obj (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">=
list</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new=
</a> grommet name "foo" value :grom)
                           (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-0230059D">new</a> widget name "foo" value :widg))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-mat=
ch</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</=
a> @type name "foo" value @v) obj
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> =
type v))))

  --&gt; ((#&lt;struct-type grommet&gt; :grom)
       (#&lt;struct-type widget&gt; :widg))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-020988A5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.7">9.31.7</a=
> Pattern operator <tt>hash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(hash {(</tt><tt><i>key-pattern</i></tt><tt> </tt><tt><i>v=
alue-pattern</i></tt><tt>)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
pattern operator matches a hash table object by means of patterns
which target keys, values or both.
</p><p>
An important concept in the requirements governing the operation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
operator is that of a trivial pattern.
</p><p>
A pattern is non-trivial if it is a variable or operator pattern.
A pattern is also non-trivial if it is a list, vector or range pattern
containing at least one non-trivial pattern. Otherwise, it is trivial.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
operator requires the corresponding object to be a hash table,
otherwise the match fails.
</p><p>
If the corresponding object is a hash table, then matches each
<tt><i>key-pattern</i></tt>
and
<tt><i>value-pattern</i></tt>
pair against that object as described below. Each of
the pairs must successfully match, otherwise the overall
match fails.
</p><p>
If
<tt><i>key-pattern</i></tt>
is a trivial pattern, then the semantics of the match is that
<tt><i>key-pattern</i></tt>
is taken as a literal object representing a hash key. The hash
table is searched for that key. If the key is not found,
the match fails. Otherwise, the value corresponding to
that key is matched against the
<tt><i>value-pattern</i></tt>
which may be trivial or non-trivial.
</p><p>
If
<tt><i>key-pattern</i></tt>
is a simple variable pattern
<tt>




@</tt><tt><i>sym</i></tt><tt>=20

</tt>

and if
<tt><i>sym</i></tt>
has an existing binding, then the value of
<tt><i>sym</i></tt>
is looked up in the hash table. If it is not found, then
the match fails, otherwise the corresponding value is matched
against
<tt><i>value-pattern</i></tt>,
which may be trivial or non-trivial.
</p><p>
If
<tt><i>key-pattern</i></tt>
is a non-trivial pattern other than a variable pattern
for a variable which has an existing binding, and if
<tt><i>value-pattern</i></tt>
is trivial, then
<tt><i>value-pattern</i></tt>
is taken as a literal object, which is used for searching
the hash table for one or more keys, as if it were the
<tt><i>value</i></tt>
argument in a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBE776">hash-keys=
-of</a></tt>
function, to find all keys which have a value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to that value. If no keys are found, then the match
fails. Otherwise, the
<tt>key-pattern</tt>
is then matched against the retrieved list of hash keys.
</p><p>
Finally, if both
<tt><i>key-pattern</i></tt>
and
<tt><i>value-pattern</i></tt>
are non-trivial, then an exhaustive search is performed of the hash table.
Every key in the hash table is matched against
<tt><i>key-pattern</i></tt>
and if it matches, the value is matched against
<tt><i>value-pattern</i></tt>.
If both match, then the values from the matches are collected into lists.
At least one matching key-value pair must be found, otherwise
the overall match fails.
Note: this situation can be understood as if the hash table were associatio=
n
list of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells of the form
</p><p>
<tt>
</tt></p><pre><tt>  (</tt><tt><i>key</i></tt><tt> . </tt><tt><i>value</i></=
tt><tt>)=20
</tt></pre><tt>

</tt>

<p>
and as if the two patterns were combined into a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
operator against this list in the following way:
</p><p>
<tt>
</tt></p><pre><tt>  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
026">coll</a> (</tt><tt><i>key-pattern</i></tt><tt> . </tt><tt><i>value-pat=
tern</i></tt><tt>))=20
</tt></pre><tt>

</tt>

<p>
such that the semantics can then be understood in terms of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
operator matching against an association list.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; First, (x @y) has a trivial key pattern so the x
  ;; entry from the hash table is retrieved, the
  ;; value being the symbol k. This k is bound to @y.
  ;; Because y now a bound variable the pattern (@y @datum)
  ;; is interpreted as search of the hash table for
  ;; a single entry matching the value of @y. This
  ;; is the k entry, whose value is 42. The @datum
  ;; value match takes this 42.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a> (=
x @y) (@y @datum))
              #H(() (x k) (k 42)) datum)
  --&gt; 42

  ;; Again, (x @y) has a trivial key pattern so the x
  ;; entry from the hash table is retrieved, the
  ;; value being the symbol k. This k is bound to @y.
  ;; This time the second pattern has a @(<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-01C0BF69">symbolp</a>)
  ;; predicate operator. This is not a variable, and
  ;; so the pattern searches the entire
  ;; hash table. The @y variable has a binding to k,
  ;; so only the (k 42) entry is matched. The 42
  ;; value matches @datum, and is collected into a list.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a> (=
x @y) (@(symbolp @y) @datum))
              #H(() (x k) (k 42)) datum)
  --&gt; (42)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-028B26DD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.8">9.31.8</a=
> Pattern operator <tt>as</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(as </tt><tt><i>name</i></tt><tt> </tt><tt><i>pattern</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a></t=
t>
pattern operator binds the corresponding object to a fresh variable given b=
y
<tt><i>name</i></tt>,
similarly to the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
operator. If another variable called
<tt><i>name</i></tt>
exists, it is shadowed; thus, no back-referencing is performed.
</p><p>
The
<tt><i>name</i></tt>
argument must be a bindable symbol, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If
<tt><i>name</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then no name is bound. Thus
<tt>




@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a> nil =
</tt><tt><i>pattern</i></tt><tt>)=20

</tt>

is equivalent to
<tt><i>pattern</i></tt>.
Otherwise,
<tt><i>pattern</i></tt>
processed in a scope in which the new
<tt><i>name</i></tt>
binding is already visible.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a></t=
t>
operator succeeds if
<tt><i>pattern</i></tt>
matches.
</p><p>
Note: in a situation when it is necessary to bind a variable to an object
in parallel with one or more patterns, such that the variable can back-refe=
rence
to an existing occurrence, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
pattern operator can be used.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; w captures the entire (1 2 3) list:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a>=
 w (@a @b @c)) '(1 2 3) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0206CE91">list</a> w a b c))
  --&gt; ((1 2 3) 1 2 3)

  ;; match a list which has itself as the third element
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028B26DD">as</a>=
 a (1 2 @a 4)) '#1=3D(1 2 #1# 4) :yes)
  --&gt; :yes
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03098987">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.9">9.31.9</a=
> Pattern operator <tt>with</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(with [</tt><tt><i>main-pattern</i></tt><tt>] {</tt><tt><i=
>side-pattern</i></tt><tt> | </tt><tt><i>name</i></tt><tt>} </tt><tt><i>exp=
r</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03098987">with</a><=
/tt>
pattern operator matches the optional
<tt><i>main-pattern</i></tt>
against a corresponding object, while matching a
<tt><i>side-pattern</i></tt>
or
<tt><i>name</i></tt>
against the value of the expression
<tt><i>expr</i></tt>
which is embedded in the syntax.
</p><p>
First, if
<tt><i>main-pattern</i></tt>
is present in the syntax,
it is matched its corresponding object. This match must
succeed, or else the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03098987">with</a><=
/tt>
operator fails to match, in which case
<tt><i>expr</i></tt>
is not evaluated.
</p><p>
Next, if
<tt><i>main-pattern</i></tt>
successfully matched, or is absent,
<tt><i>expr</i></tt>
is evaluated in the scope of earlier pattern variables, including any
which that emanate from
<tt><i>main-pattern</i></tt>.
It is unspecified
whether later pattern variables are visible.
</p><p>
Finally,
<tt><i>side-pattern</i></tt>
is matched against the value of
<tt><i>expr</i></tt>.
If that succeeds, then the operator has successfully matched.
</p><p>
If a
<tt><i>name</i></tt>
is specified instead of a
<tt><i>side-pattern</i></tt>,
it must be a bindable symbol or else
<tt><i>nil</i></tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">when-match</a> (@(with @a x 42) @b @c) '(1 2 3) (<a href=3D"http://=
nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> a b c x))
  --&gt; (1 2 3 42)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
o 3))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-mat=
ch</a> (@(evenp @x) @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
3098987">with</a> @z @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
006B">oddp</a> y) o)) '(4 6)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> x y z)))
  --&gt; (4 3 6)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0268BD16">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.10">9.31.10<=
/a> Pattern operator <tt>require</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(require </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>cond=
ition</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The pattern operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a></=
tt>
applies the specified
<tt><i>pattern</i></tt>
to the corresponding object.
If the
<tt><i>pattern</i></tt>
matches, the operator then imposes the additional constraints
specified by zero or more
<tt><i>condition</i></tt>
forms.
Each
<tt><i>condition</i></tt>
is evaluated in a scope in which the variables from
<tt><i>pattern</i></tt>
have already been established.
</p><p>
For the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a></=
tt>
operator to be a successful match, every
<tt><i>condition</i></tt>
must evaluate true, otherwise the match fails.
</p><p>
The
<tt><i>condition</i></tt>
forms behave as if they were the arguments of an implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
operator, which implies left-to-right evaluation behavior, stopping
evaluation on the first
<tt><i>condition</i></tt>
which produces
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and defaulting to a result of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
when no
<tt><i>condition</i></tt>
forms are specified.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Match a (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#D-007C">+</a> a b) expression where a and b are similar:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> @a @b) (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a> a b)) '=
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> z z) (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> a b))
  --&gt; (z z)

  ;; Mismatched case
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> @a @b) (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a> a b)) '(<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> y z)
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a=
> a b)
     :no-match)
  --&gt; :no-match
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00F6E2A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.11">9.31.11<=
/a> Pattern operators <tt>all</tt> and <tt>all*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(all </tt><tt><i>pattern</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(all* </tt><tt><i>pattern</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6E2A2">all*</a><=
/tt>
pattern operators require the corresponding object to be a sequence.
</p><p>
The specified
<tt><i>pattern</i></tt>
is applied against every element of the sequence. The match is successful i=
f
<tt><i>pattern</i></tt>
matches every element.
</p><p>
Furthermore, in the case of a successful match, each variable that
is freshly bound by
<tt><i>pattern</i></tt>
is converted into a list of all of the objects which that variable
encounters from all elements of the sequence.  Those variables which alread=
y
have a binding from another
<tt><i>pattern</i></tt>
are not converted to lists. Their existing values are merely required to ma=
tch
each corresponding object they encounter.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6E2A2">all*</a><=
/tt>
is as follows. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a></tt>
operator respects the vacuous truth of the match when the sequence is empty=
.
In that case, the match is successful, and the variables are all bound to
the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
In contrast, the alternative
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6E2A2">all*</a><=
/tt>
operator behaves like a failed match when the sequence is empty.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; all elements of list match the pattern (x @a @b)
  ;; a is bound to (1 2 3); b to (a b c)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a> (x=
 @a @b))
             '((x 1 a) (x 2 b) (x 3 c))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 a b))
  --&gt; ((1 2 3) (a b c))

  ;; Match a two element list whose second element
  ;; consists of nothing but zero or more repetitions
  ;; of the first element. x is not turned into a list
  ;; because it has a binding due to @x.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(@x @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</=
a> x)) '(1 (1 1 1 1)) x) -&gt; 1

  ;; no match because of the 2
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(@x @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</=
a> x)) '(1 (1 1 1 2)) x) -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-033989E1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.12">9.31.12<=
/a> Pattern operator <tt>some</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(some </tt><tt><i>pattern</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a></tt>
pattern operator requires the corresponding object to be a sequence.
The specified
<tt><i>pattern</i></tt>
is applied against every element of the sequence. The match is successful i=
f
<tt><i>pattern</i></tt>
matches at least one element.
</p><p>
Variables are extracted from the first matching which is found.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; the second (x 2 b) element is the leftmost one
  ;; which matches the (x @a @b) pattern

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0077">some</a> (=
x @a @b))
             '((y 1 a) (x 2 b) (z 3 c))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 a b))
  -&gt; (2 b)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02C98DE1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.13">9.31.13<=
/a> Pattern operator <tt>coll</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(coll </tt><tt><i>pattern</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0026">coll</a></tt>
pattern operator requires the corresponding object to be a sequence.
The specified
<tt><i>pattern</i></tt>
is applied against every element of the sequence. The match is successful i=
f
<tt><i>pattern</i></tt>
matches at least one element.
</p><p>
Each variable that is freshly bound by the
<tt><i>pattern</i></tt>
is converted into a list of all of the objects which that variable
encounters from the matching elements of the sequence.  Those variables whi=
ch
already have a binding from another
<tt><i>pattern</i></tt>
are not converted to lists. Their existing values are merely required to ma=
tch
each corresponding object they encounter.
</p><p>
Variables are extracted from all matching elements, and collected into
parallel lists, just like with the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a>)</t=
t>
operator.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">when-match</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-0026">coll</a> (x @a @b))
             '((y 1 a) (x 2 b) (z 3 c) (x 4 d))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 a b))
  -&gt; ((2 4) (b d))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03A12201">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.14">9.31.14<=
/a> Pattern operators <tt>and</tt> and <tt>or</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(and </tt><tt><i>pattern</i></tt><tt>*)=20




<br>&nbsp;&nbsp;@(or </tt><tt><i>pattern</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operators match multiple patterns in parallel, against
the same object.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
operator matches if every
<tt><i>pattern</i></tt>
matches the object, otherwise there is no match.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operator requires one
<tt><i>pattern</i></tt>
to match. It tries the patterns in left to right order, and
stops at the first matching one, declaring failure if none match.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operators have different scoping rules.
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>,
later patterns are processed in the scopes of earlier patterns,
just like with other pattern operators. Duplicate variables
back-reference.
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>,
the patterns are processed in separate, parallel scopes.
No back-referencing takes place among same-named variables
introduced in separate patterns of the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
matches, the variables from all of the
patterns are bound.
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operator matches, the variables from all of the patterns
are also bound. However, only the variables from the matching
<tt><i>pattern</i></tt>
take on the values implied by that pattern.
The variables from the non-matching patterns that do not have
the same names as variables in the matching
<tt><i>pattern</i></tt>,
and that have been newly introduced in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operator, take on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
values.
</p><p>
</p></dd><dt>Examples</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">if-match</a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0049">and</a> (@x 2 3) (1 @y 3) (1 2 @z)) '(1 2 3)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 x y z)) -&gt; (1 2 3)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match</=
a> @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> (@x 3=
 3) (1 @x 3) (1 2 @x)) '(1 2 3)
    x) -&gt; 2
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-003BC1A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.15">9.31.15<=
/a> Pattern operator <tt>not</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(not </tt><tt><i>pattern</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The pattern operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>
provides logical inverse semantics. It matches if, and only if, the
<tt><i>pattern</i></tt>
does not match.
</p><p>
Whether or not the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>
operator matches, no variables are bound. If the embedded
<tt><i>pattern</i></tt>
matches, the variables which it binds are suppressed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>
operator.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>   ;; @a matches unconditionally, so @(<a href=3D"http://=
nongnu.org/txr/txr-manpage.html#D-0050">not</a> @a) always fails:
   (match-if @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">no=
t</a> @a) 1 :yes :no) -&gt; no

   ;; error: a is not bound
   (match-if @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">no=
t</a> @a) 1 :yes a) -&gt; error

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a> '(1 2 3)
     ((@(not 1) @b @c) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0206CE91">list</a> :case1 b c))
     ((@(not 0) @b @c) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0206CE91">list</a> :case2 c b)))
   --&gt; (:case2 3 2)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-02A534E4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.31.16">9.31.16<=
/a> Pattern predicate operator</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;@(</tt><tt><i>function</i></tt><tt> </tt><tt><i>arg</i></tt=
><tt>*)=20




<br>&nbsp;&nbsp;@(</tt><tt><i>function</i></tt><tt> </tt><tt><i>arg</i></tt=
><tt>* @</tt><tt><i>avar</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*)=20




<br>&nbsp;&nbsp;@(</tt><tt><i>function</i></tt><tt> </tt><tt><i>arg</i></tt=
><tt>* . @</tt><tt><i>avar</i></tt><tt>)=20




<br>&nbsp;&nbsp;@(@</tt><tt><i>rvar</i></tt><tt> (</tt><tt><i>function</i><=
/tt><tt> </tt><tt><i>arg</i></tt><tt>*))=20




<br>&nbsp;&nbsp;@(@</tt><tt><i>rvar</i></tt><tt> (</tt><tt><i>function</i><=
/tt><tt> </tt><tt><i>arg</i></tt><tt>* @</tt><tt><i>avar</i></tt><tt> </tt>=
<tt><i>arg</i></tt><tt>*))=20




<br>&nbsp;&nbsp;@(@</tt><tt><i>rvar</i></tt><tt> (</tt><tt><i>function</i><=
/tt><tt> </tt><tt><i>arg</i></tt><tt>* . @</tt><tt><i>avar</i></tt><tt>))=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Whenever the operator position of a pattern consists of a symbol which is n=
ot
the name of a pattern operator, the expression denotes a predicate pattern,
expected to conform to one of the first three syntax variations above.
Together, these three variations constitute the
<i>first form</i>

of the pattern predicate operator.
Whenever the operator position of a pattern consists of a meta-symbol, it i=
s
also a predicate pattern, expected to conform to one of the second three sy=
ntax
variations above. These three variations constitute the
<i>second form</i>

of the operator.
</p><p>
The first form of the predicate pattern consists of a compound form consist=
ing
of an operator and arguments. Exactly one of the arguments may be a pattern
variable
<tt><i>avar</i></tt>
("argument variable") which must be a bindable symbol. The pattern variable
may also appear in the dot position, rather than as an argument.  The role =
of
<tt><i>avar</i></tt>
and the consequences of omitting it are described below.
</p><p>
The second form of the predicate pattern consists of a meta-symbol
<tt><i>rvar</i></tt>
("result variable")
which must be a bindable symbol or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This is followed by a compound form which consists of an operator
symbol, followed by arguments, one of which may be a pattern
<tt>avar</tt>
as in the simple form.
If
<tt><i>rvar</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the predicate pattern is equivalent to the first form. That is to say,
the following are equivalent:
</p><p>
<tt>
</tt></p><pre><tt>  @(@nil (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-003BDFA9">f</a> ...))  &lt;--&gt;  @(<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-003BDFA9">f</a> ...)
</tt></pre><tt>

</tt>

<p>
The matching of the predicate pattern is processed as follows.
If the
<tt><i>avar</i></tt>
variable is present, then the predicate pattern first binds the
corresponding object to the
<tt><i>avar</i></tt>
variable, performing an ordinary variable match with the potential
back-referencing which that implies. If that succeeds, then the object is
inserted into the compound form, substituted in the position indicated by t=
he
<tt>




@</tt><tt><i>avar</i></tt><tt>=20

</tt>

variable, either an ordinary argument position or the dot position. This fo=
rm
is then evaluated. If it yields true, then the match is successful, otherwi=
se
the match fails.
</p><p>
If the
<tt><i>avar</i></tt>
variable is absent, then no initial variable matching takes place.
The corresponding object is added as an extra rightmost argument into the
compound form, which is evaluated. Its truth value then determines the succ=
ess
of the match, just like in the case with
<tt><i>avar</i></tt>.
</p><p>
If the second form is being processed, and specifies a
<tt><i>rvar</i></tt>
that is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and if the predicate has succeeded, then then an extra processing step take=
s
place. A variable match is performed to bind the
<tt><i>rvar</i></tt>
variable to the result of the predicate, with potential back-referencing.
If that match succeeds, then the predicate pattern succeeds.
</p><p>
The compound form may be headed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator, and therefore the DWIM bracket notation may be used.
For instance
<tt>@[f @x]</tt>
is equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a> f =
@x)</tt>
and is processed accordingly. Similarly,
<tt>@(@y [f @x])</tt>
is equivalent to
<tt>@(@y (dwim f @x))</tt>.
</p><p>
The dot position of
<tt><i>avar</i></tt>
in the predicate syntax denotes function application. So that is to say, th=
e
pattern predicate form
<tt>(f . @a)</tt>
where
<tt>@a</tt>
is in the dotted position invokes the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
as if by evaluation of the form
<tt>(f . x)</tt>
where
<tt>x</tt>
is hidden temporary variable holding the object corresponding to the patter=
n.
The form
<tt>(f . x)</tt>
is a standard <b>TXR Lisp</b> notation with the same meaning as
<tt>(apply (fun f) x)</tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CFBF5E">when-match</a> (@(evenp) @(<a href=3D"http://nongnu.org/txr/txr-man=
page.html#D-006B">oddp</a> @x)) '(2 3) x) -&gt; 3

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(&lt;=3D 1 @x 10) 4 x) -&gt; 4

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(@d (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01ED5020">ch=
r-digit</a> @c)) #\5 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
206CE91">list</a> d c)) -&gt; (5 #\5)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(&lt;=3D 1 @x 10) 11 x) -&gt; nil

  ;; use hash table as predicate:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
h #H(() (a 1) (b 2))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-mat=
ch</a> @[h @x] 'a x))
  -&gt; a

  ;; as above, also capture hash value
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
h #H(() (a 1) (b 2))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-mat=
ch</a> @(@y [h @x]) 'a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0206CE91">list</a> x y)))
  -&gt; (a 1)

  ;; apply (1 2 3) to &lt; using dot position
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-match=
</a> @(@x (&lt; . @sym)) '(1 2 3) (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0206CE91">list</a> x sym))
 - &gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a=
> (1 2 3))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-021716E7">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.32">9.32</a> Pa=
ttern Matching Macros</h3>



<p>


</p><p>

<a name=3D"N-00CFBF5E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.32.1">9.32.=
1</a> Macros <tt>when-match</tt> and <tt>if-match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(when-match </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>ex=
pr</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(if-match </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>expr=
</i></tt><tt> </tt><tt><i>then-form</i></tt><tt> [</tt><tt><i>else-form</i>=
</tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-matc=
h</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match<=
/a></tt>
macros conditionally evaluate code based on whether the value of
<tt><i>expr</i></tt>
matches
<tt><i>pattern</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">when-matc=
h</a></tt>
macro arranges for every
<tt><i>form</i></tt>
to be evaluated in the scope of the variables established by
<tt><i>pattern</i></tt>
when it matches the object produced by
<tt><i>expr</i></tt>.
The value of the last
<tt><i>form</i></tt>
is returned, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no forms.
If the match fails, the forms are not evaluated, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is produced.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CFBF5E">if-match<=
/a></tt>
macro evaluates
<tt><i>then-form</i></tt>
in the scope of the variables established by
<tt><i>pattern</i></tt>
if the match is successful, and yields the value of that form.
Otherwise, it evaluates
<tt><i>else-form</i></tt>,
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if it is not specified.
</p><p>

</p></dd></dl>
<a name=3D"N-012DEAC3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.32.2">9.32.2</a=
> Macro <tt>match-case</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(match-case </tt><tt><i>expr</i></tt><tt> {(</tt><tt><i>pat=
tern</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
macro successively matches the value of
<tt><i>expr</i></tt>
against zero or more patterns.
</p><p>
The syntax of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
consists of an expression
<tt><i>expr</i></tt>
followed by zero or more clauses.
Each clause is a compound expression whose first element is
<tt><i>pattern</i></tt>,
which is followed by zero or more forms.
</p><p>
First,
<tt><i>expr</i></tt>
is evaluated. Then, the value is matched against each
<tt><i>pattern</i></tt>
in succession, stopping at the first pattern which provides
a successful match.
If no pattern provides a successful match, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
terminates and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If a
<tt><i>pattern</i></tt>
matches successfully, then each
<tt><i>form</i></tt>
associated with the pattern is evaluated in the scope of the variable
bindings established by that
<tt><i>pattern</i></tt>.
Then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
terminates, returning the value of the last
<tt><i>form</i></tt>
or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no forms.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; classify sequence of objects by pattern matching,
  ;; returning a list of the results

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">collect-ea=
ch</a> ((obj (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91"=
>list</a> '(1 2 3)
                            '(4 5)
                            '(3 5)
                            #S(<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-005D">time</a> year 2021 month 1 day 1)
                            #(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0297F5F5">vec</a> tor))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-ca=
se</a> obj
      (@(struct time year @y) y)
      (#(@x @y) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE=
91">list</a> x y))
      ((@nil @nil @x) x)
      ((4 @x) x)
      ((@x 5) x)))

   --&gt; (3 5 3 2021 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0297F5F5">vec</a> tor))

   ;; default case can be represented by a guaranteed match

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a> 1
     (2 :two)
     (@x :default)) --&gt; :default
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-031E43FF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.32.3">9.32.3</a=
> Macro <tt>lambda-match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lambda-match {(</tt><tt><i>pattern</i></tt><tt> </tt><tt><=
i>form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
is conceptually similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>.
</p><p>
The arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
are zero or more clauses similar to those of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>,
each consisting of a compound expression headed by a
<tt><i>pattern</i></tt>
followed by zero or more
<tt><i>form</i></tt>-s.
</p><p>
The macro generates a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
expression which evaluates to an anonymous function
in the usual way.
</p><p>
When the anonymous function is called, each clause's
<tt><i>pattern</i></tt>
is matched against the the function's actual arguments. When a
match occurs, each
<tt><i>form</i></tt>
associated with the
<tt><i>pattern</i></tt>
is evaluated, and the value of the last
<tt><i>form</i></tt>
becomes the return value of the function.
If none of the clauses match, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
Whenever
<tt><i>pattern</i></tt>
is a list-like pattern, it is not matched against a list object, as is the
usual case with a list-like pattern, but against the actual arguments.
For instance, the pattern
<tt>(@a @b @c)</tt>
expects that the function was called with exactly three arguments. If
that is the case, the patterns are then matched to the arguments. The patte=
rn
<tt>@a</tt>
takes the first argument, binding it to variable
<tt>a</tt>
and so forth.
</p><p>
If
<tt><i>pattern</i></tt>
is a dotted list-like pattern, then the dot position is matched
against the remaining arguments. For instance, the pattern
<tt>(@a @b . @c)</tt>
requires at least two arguments. The first two are bound to
<tt>a</tt>
and
<tt>b</tt>,
respectively. The list of remaining arguments, if any, is bound to
<tt>c</tt>,
which will be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no remaining arguments.
</p><p>
Any non-list-like
<tt><i>pattern</i></tt>
<tt>P</tt>
is analyzed as an equivalent list-like dotted pattern due to
<tt>P</tt>
syntax being equivalent to
<tt>(. P)</tt>
syntax. Such a pattern matches the list of all arguments.
Thus, the following are all equivalent:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
1E43FF">lambda-match</a> (@a a))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-mat=
ch</a> ((. @a) a))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> a a=
)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (. =
a) a)
</tt></pre><tt>

</tt>

<p>
The characteristics of the resulting anonymous function are determined as
follows.
</p><p>
If at least one
<tt><i>pattern</i></tt>
specified in a
<tt><i>lambda-match</i></tt>
is a dotted pattern, the function is variadic.
</p><p>
The arity of the resulting anonymous function is determined as follows, fro=
m
the lengths of the patterns.  The length of a pattern is the number of
elements, not including the dotted element.
</p><p>
The length of the longest pattern determines the number of fixed
arguments. Unless the function is variadic, it may not be called with more
arguments than can be matched by the longest pattern.
</p><p>
The length of the shortest pattern determines the number of required argume=
nts.
The function may not be called with fewer arguments than can be matched
by the shortest pattern.
</p><p>
If these two lengths are unequal, then the function has a number of optiona=
l
arguments, equal to the difference.
</p><p>
Note: an anonymous function which takes one argument and matches that
object against clauses using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
can be obtained with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
operator, using the pattern:
<tt>(do match @1 ...)</tt>.
</p><p>
Note: the parameter macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
can also define a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
with pattern matching. Any
<tt>(lambda-match clauses ...)</tt>
form can be written as
<tt>(lambda (:match) clauses ...)</tt>.
The parameter macro offers the additional ability of defining
named arguments which are inserted before the implicit arguments
generated from the clauses, and combining with other parameter
macros.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((f (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
1E43FF">lambda-match</a>
             (() (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206C=
E91">list</a> 0 :args))
             ((@a) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020=
6CE91">list</a> 1 :arg a))
             ((@a @b) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0206CE91">list</a> 2 :args a b))
             ((@a @b . @c) (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-03593DE9">list*</a> '&gt; 2 :args a b c)))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 [f] [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 1=
] [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 1 2]=
 [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 1 2 3=
]))
  --&gt;
  ((0 :args) (1 :arg 1) (2 :args 1 2) (&gt; 2 :args 1 2 3))

  [(lambda-match
     ((0 1) :zero-one)
     ((1 0) :one-zero)
     ((@x @y) :no-match)) 1 0] --&gt; :one-zero

  [(lambda-match
     ((0 1) :zero-one)
     ((1 0) :one-zero)
     ((@x @y) :no-match)) 1 1] --&gt; :no-match

  [(lambda-match
     ((0 1) :zero-one)
     ((1 0) :one-zero)
     ((@x @y) :no-match)) 1 2 3] --&gt; ;; error
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02BF0F8C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.32.4">9.32.4</a=
> Macro <tt>defun-match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defun-match </tt><tt><i>name</i></tt><tt> {(</tt><tt><i>pa=
ttern</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-mat=
ch</a></tt>
macro can be used to define a top-level function in the style of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>.
</p><p>
It produces a form which has all of the properties of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>,
such as a block of the same
<tt><i>name</i></tt>
being established around the implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012DEAC3">match-cas=
e</a></tt>
so that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
is possible.
</p><p>
The
<tt>




(</tt><tt><i>pattern</i></tt><tt> </tt><tt><i>form</i></tt><tt>*)=20

</tt>

clauses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-mat=
ch</a></tt>
have exactly the same syntax and semantics as those of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>.
</p><p>
Note: instead of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-mat=
ch</a></tt>,
the parameter macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
may be used. The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> name (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-03B92C0D">:match</a>) ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-02BF0F8C">defun-match</a> ...)
</tt></pre><tt>

</tt>

<p>
The parameter macro offers the additional ability of defining
named arguments which are inserted before the implicit arguments
generated from the clauses, and combining with other parameter
macros.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Fibonacci
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-matc=
h</a> fib
    ((0) 1)
    ((1) 1)
    ((@x) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> =
(fib (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">pred</a=
> x)) (fib (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">p=
pred</a> x)))))

  (fib 0) -&gt; 1
  (fib 1) -&gt; 1
  (fib 2) -&gt; 2
  (fib 3) -&gt; 3
  (fib 4) -&gt; 5
  (fib 5) -&gt; 8

  ;; Ackermann
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF0F8C">defun-matc=
h</a> ack
    ((0 @n) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
> n 1))
    ((@m 0) (ack (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009"=
>-</a> m 1) 1))
    ((@m @n) (ack (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009=
">-</a> m 1) (ack m (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
09">-</a> n 1)))))

  (ack 3 7) -&gt; 1021
  (ack 1 1) -&gt; 3
  (ack 2 2) -&gt; 7
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03B92C0D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.32.5">9.32.5</a=
> Parameter list macro <tt>:match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(:match </tt><tt><i>left-param</i></tt><tt>* [-- </tt><tt><=
i>extra-param</i></tt><tt>*]) </tt><tt><i>clause</i></tt><tt>*=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Parameter list macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
allows any function to be expressed in the style of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>,
with extra features.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
macro expects the body of the function to consists of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
clauses, which are semantically treated in exactly the same manner as
under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>.
</p><p>
The following restrictions apply. The parameter list may not include
optional parameters delimited by
<tt>:</tt>
(colon symbol). The parameter list may not be dotted.
</p><p>
The macro produces a function which the
<tt><i>left-param</i></tt>
parameters, if any, are inserted to the left of the implicit parameters
generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
transformation.
</p><p>
Furthermore, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
parameter macro supports integration with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
parameter macro, or any other macro which uses a compatible
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
convention for delimiting special arguments.
If the parameter list includes the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
then that portion of the parameter list is set aside and not included in th=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
transformation. Then, that list is integrated into the resulting lambda.
</p><p>
A complete transformation can be described by the following diagram:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
4F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0=
D">:match</a> a b c ... -- s t u ...) clauses ...)

  --&gt;

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (a =
b c ... m n p ... -- s t u ... . z) body ...)
</tt></pre><tt>

</tt>

<p>
In this diagram,
<tt>a b c ...</tt>
denote the
<tt><i>left-param</i></tt>
parameters.
The
<tt>m n p ...</tt>
symbols denote the fixed parameters generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
transformation from the semantic analysis of
<tt><i>clauses</i></tt>.
The
<tt>s t u ...</tt>
symbols denote the original
<tt><i>extra-param</i></tt>
parameters. Finally,
<tt>z</tt>
denotes the dotted parameter generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031E43FF">lambda-ma=
tch</a></tt>
transform. If the transform produces no dotted parameter, then this is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The dotted parameter is thus separated from the
<tt>m n p ...</tt>
group to which it belongs.
</p><p>
When no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
and
<tt><i>extra-params</i></tt>
are present, the transformation reduces to:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
4F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0=
D">:match</a> a b c ...) clauses ...)

  --&gt;

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (a =
b c ... m n p ... . z) body ...)
</tt></pre><tt>

</tt>

<p>
Note: these requirements harmonize with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
parameter macro. If that is present to the left of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:match</a=
></tt>
it removes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
and the
<tt>s t u ...</tt>
keyword parameters, reuniting the
<tt>z</tt>
parameter with the
<tt>m n p</tt>
group. Furthermore, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">:key</a><=
/tt>
macro generates code which refers to the existing
<tt>z</tt>
dotted parameter as the source for the keyword parameters, unless
<tt>z</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
in which case it inserts its own generated symbol.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Match-style cond-like macro with unreachability diag=
nosis.
  ;; Demonstrates usefulness of :match, which allows the :form
  ;; parameter to be promoted through to the macro definition.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> my-cond (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B92C0D">:=
match</a> :form f)
    (() nil)
    (((@(and @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A=
">constantp</a> @test) @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0286C8B8">eval</a>))) . @rest)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</=
a> rest
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">comp=
ile-error</a> f "unreachable code after ~s" test))
      test)
    (((@(and @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A=
">constantp</a> @test) @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-0286C8B8">eval</a>)) . @forms) . @rest)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a> rest)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">comp=
ile-error</a> f "unreachable code after ~s" test))
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn=
</a> ,*forms))
    (((@test) . @rest)
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> ,t=
est (my-cond ,*rest)))
    (((@test . @forms) . @rest)
      ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> ,t=
est (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a=
> ,*forms)
         (my-cond ,*rest)))
    ((@else . @rest) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
32EA7D7">compile-error</a> f "bad syntax")))

  (my-cond (3)) --&gt; 3
  (my-cond (3 4)) --&gt; 4
  (my-cond (3 4) (5)) --&gt; ;; my-cond: unreachable code after 3
  (my-cond 42) --&gt; ;; my-cond: bad syntax
</tt></pre><tt>

</tt>

<p>
<tt>
</tt></p><pre><tt>  ;; Keyword parameter example.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> simple-widget ()
    name)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> widget (simple-widget)
    frobosity
    luminance)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> simple-point-widget (simple-widget)
    (:static width 0)
    (:static height 0))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> point-widget (widget)
    (:static width 0)
    (:static height 0))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct<=
/a> general-widget (widget)
    width
    height)

  ;; Note that in clauses with no . @rest parameter, there
  ;; is a mismatch if keyword arguments are present. The (0 0)
  ;; clause exploits this to match only when keywords are absent.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
make-widget (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01697547">=
:key</a> :match name -- frob lum)
    ((0 0) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">n=
ew</a> simple-point-widget name name))
    ((0 0 . @rest) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023=
0059D">new</a> point-widget name name
                                     frobosity frob
                                     luminance lum))
    ((@x @y . @rest) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
230059D">new</a> general-widget name name
                                         width x
                                         height x
                                         frobosity frob
                                         luminance lum)))

  (make-widget "abc" 0 0) --&gt; #S(simple-point-widget name "abc")

  (make-widget "abc" 0 0 :frob 42)
  --&gt; #S(point-widget name "abc" frobosity 42 luminance nil)

  (make-widget "abc" 0 0 :lum 9)
  --&gt; #S(point-widget name "abc" frobosity nil luminance 9)

  (make-widget "abc" 0 1 :lum 9)
  --&gt; #S(general-widget name "abc" frobosity nil luminance 9
                        width 0 height 0)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-0241C2DE">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.33">9.33</a> Qu=
asiquote Operator Syntax</h3>



<p>



<a name=3D"N-01665185">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.33.1">9.33.=
1</a> Macro <tt>qquote</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(qquote </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
(quasi-quote) macro operator implements a notation for convenient
list construction.  If
<tt><i>form</i></tt>
is an atom, or a list structure which
does not contain any
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
operators, then
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a> <=
/tt><tt><i>form</i></tt><tt>)=20

</tt>

is equivalent to
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a> <=
/tt><tt><i>form</i></tt><tt>).=20

</tt>

</p><p>
If
<tt><i>form</i></tt>,
however, is a list structure which contains
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
operators, then the substitutions implied by those operators are performed
on
<tt><i>form</i></tt>,
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
operator returns the resulting structure.
</p><p>
Note: how the qquote operator actually works is that it is compiled into
code. It becomes a Lisp expression which, when evaluated, computes the
resulting structure.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
can contain another
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>.
If an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
operator occurs
within a nested
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>,
it belongs to that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>,
and not to the outer one.
</p><p>
However, an unquote operator which occurs inside another one belongs one le=
vel
higher. For instance in
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
665185">qquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016=
65185">qquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B=
313D">unquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B=
313D">unquote</a> x))))
</tt></pre><tt>

</tt>

<p>
the leftmost
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
belongs with the rightmost unquote, and the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
belong together. When the outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
is evaluated,
it will insert the value of
<tt>x</tt>,
resulting in the object
<tt>(qquote (unquote [value-of-x]))</tt>.
If this resulting qquote value is evaluated again as Lisp syntax, then it w=
ill
yield
<tt>[value-of-value-of-x]</tt>,
the value of
<tt>[value-of-x]</tt>
when treated as a Lisp expression and evaluated.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
665185">qquote</a> a) -&gt; a

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a>=
 (a b c)) -&gt; (a b c)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a>=
 (1 2 3 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unqu=
ote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 =
2)) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 3)))=
 -&gt; (1 2 3 4 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">=
+</a> 2 3))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2))) -&=
gt; 4
</tt></pre><tt>

</tt>

<p>
In the second-to-last example, the
<tt>1 2 3</tt>
and the
<tt>(+ 2 3)</tt>
are quoted verbatim.
Whereas the
<tt>(unquote (+ 2 2))</tt>
operator caused the evaluation of
<tt>(+ 2 2)</tt>
and the substitution of the resulting value.
</p><p>
The last example shows that
<tt><i>form</i></tt>
can itself (the entire argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>)
can be an unquote operator.
However, note:
<tt>(quote (splice form))</tt>
is not valid.
</p><p>
Note: a way to understand the nesting behavior is a via a possible model of
quasi-quote expansion which recursively compiles any nested quasi quotes fi=
rst,
and then treats the result of their expansion. For instance, in the process=
ing
of
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
665185">qquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016=
65185">qquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B=
313D">unquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B=
313D">unquote</a> x))))
</tt></pre><tt>

</tt>

<p>
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
operator first encounters the
embedded
<tt>(qquote ...)</tt>
and compiles it to code. During that recursive
compilation, the syntax
<tt>(unquote (unquote x))</tt>
is encountered.  The inner quote
processes the outer unquote which belongs to it, and the inner
<tt>(unquote x)</tt>
becomes material that is embedded verbatim in the compilation, which will t=
hen
be found when the recursion pops back to the outer quasiquote, which will
then traverse the result of the inner compilation and find the
<tt>(unquote x)</tt>.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


</p><p>
In Lisp dialects which have a published quasiquoting operator syntax, there=
 is
the expectation that the quasiquote read syntax corresponds to it. That is =
to
say, that for instance the read syntax
<tt>^(a b ,c)</tt>
is expected translated to
<tt>(qquote b (unquote c))</tt>.
</p><p>
In <b>TXR Lisp</b>, this is not true! Although
<tt>^(b b ,c)</tt>
is translated to a
quasiquoting macro, it is an internal one, not based on the public
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
symbols being documented here.
</p><p>
This idea exists for hygiene. The quasiquote read syntax is not confused
by the presence of the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
in the template, since it doesn't treat them specially.
</p><p>
This also allows programmers to use the quasiquote read syntax to construct
quasiquote macros. For instance
</p><p>
<tt>
</tt></p><pre><tt>  ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
1665185">qquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
6B313D">unquote</a> ,x)) ;; does not mean ^^,,x !
</tt></pre><tt>

</tt>

<p>
To the quasiquote reader, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
symbols mean nothing special,
and so this syntax simply means that if the value of
<tt>x</tt>
is
<tt>foo</tt>,
the result of evaluating this expression will be
<tt>(qquote (unquote foo))</tt>.
</p><p>
The form's expansion is actually this:
</p><p>
<tt>
</tt></p><pre><tt>  (sys:qquote (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-01665185">qquote</a> (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-036B313D">unquote</a> (sys:unquote x))))
</tt></pre><tt>

</tt>

<p>
the
<tt>sys:qquote</tt>
macro recognizes
<tt>sys:unquote</tt>
embedded in the form, and
the other symbols not in the
<tt>sys:</tt>
package are just static template material.
</p><p>
The
<tt>sys:quote</tt>
macro and its associated
<tt>sys:unquote</tt>
and
<tt>sys:splice</tt>
operators work exactly like their ordinary counterparts. So in effect, <b>T=
XR</b> has
two nearly identical, independent quasi-quote implementations, one of which=
 is
tied to the read syntax, and one of which isn't. This is useful for writing
quasiquotes which write quasiquotes.
</p><p>

</p></dd></dl>
<a name=3D"N-036B313D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.33.2">9.33.2</a=
> Operator <tt>unquote</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(qquote (... (unquote </tt><tt><i>form</i></tt><tt>) ...))=
=20




<br>&nbsp;&nbsp;(qquote (unquote </tt><tt><i>form</i></tt><tt>))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
operator is not an operator
<i>per</i>

<i>se</i>.

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
symbol has no
binding in the global environment. It is a special syntax that is recognize=
d
within a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
form, to indicate forms within the quasiquote which are to be
evaluated and inserted into the resulting structure.
</p><p>
The syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</a> <=
/tt><tt><i>form</i></tt><tt>))=20

</tt>

is equivalent to
<tt><i>form</i></tt>:
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B313D">unquote</=
a></tt>
"cancel out".
</p><p>

</p></dd></dl>
<a name=3D"N-03BC798C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.33.3">9.33.3</a=
> Operator <tt>splice</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(qquote (... (splice </tt><tt><i>form</i></tt><tt>) ...))=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
operator is not an operator
<i>per</i>

<i>se</i>.

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
symbol has no
binding in the global environment. It is a special syntax that is recognize=
d
within a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a=
></tt>
form, to indicate forms within the quasiquote which are to be
evaluated and inserted into the resulting structure.
</p><p>
The syntax
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01665185">qquote</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a> </=
tt><tt><i>form</i></tt><tt>))=20

</tt>

is not permitted and raises an exception if evaluated. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
syntax must occur within a list, and not in the dotted position.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a=
></tt>
form differs from unquote in that
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BC798C">splice</a> <=
/tt><tt><i>form</i></tt><tt>)=20

</tt>

requires that
<tt><i>form</i></tt>
must evaluate to a list. That list is
integrated into the surrounding list.
</p><p>
</p></dd></dl>
<a name=3D"N-0043732C">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34">9.34</a> Ma=
th Library</h3>



<p>



<a name=3D"N-01F56DFE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.1">9.34.=
1</a> Functions <tt>+</tt> and <tt>-</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(+ </tt><tt><i>number</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(- </tt><tt><i>number</i></tt><tt> </tt><tt><i>number</i></=
tt><tt>*)=20




<br>&nbsp;&nbsp;(* </tt><tt><i>number</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
functions perform addition, subtraction and multiplication,
respectively.  Additionally, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
function performs additive inverse.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
function requires zero or more arguments. When called with no
arguments, it produces 0 (the identity element for addition), otherwise it
produces the sum over all of the arguments.
</p><p>
Similarly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
function requires zero or more arguments. When called
with no arguments, it produces 1 (the identity element for multiplication).
Otherwise it produces the product of all the arguments.
</p><p>
The semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
changes from subtraction to additive inverse
when there is only one argument. The argument is treated as a subtrahend,
against an implicit minuend of zero. When there are two or more
argument, the first one is the minuend, and the remaining are subtrahends.
</p><p>
When there are three or more operands, these operations are performed as if=
 by
binary operations, in a left-associative way. That is to say,
<tt>(+ a b c)</tt>
means
<tt>(+ (+ a b) c)</tt>.
The sum of
<tt>a</tt>
and
<tt>b</tt>
is computed first, and then this is added to
<tt>c</tt>.
Similarly
<tt>(- a b c)</tt>
means
<tt>(- (- a b) c)</tt>.
First,
<tt>b</tt>
is subtracted from
<tt>a</tt>,
and then
<tt>c</tt>
is subtracted from that result.
</p><p>
The arithmetic inverse is performed as if it were subtraction from integer =
0.
That is,
<tt>(- x)</tt>
means the same thing as
<tt>(- 0 x)</tt>.
</p><p>
The operands of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
can be characters, integers (fixnum and bignum), and
floats, in nearly any combination.
</p><p>
If two operands have different types, then one of them is converted to the
type of the one with the higher rank, according to this ranking:
character &lt; integer &lt; float.  For instance if one operand is integer,=
 and the
other float, the integer is converted to a float.
</p><p>
</p></dd><dt>Restrictions:</dt><dd>
<p>


</p><p>
Characters are not considered numbers, and participate in these operations =
in
limited ways. Subtraction can be used to computed the displacement between =
the
Unicode values of characters, and an integer displacement can be added to a
character, or subtracted from a character.  For instance
<tt>(- #\9 #\0) is 9</tt>.
The Unicode value of a character
<tt>C</tt>
can be found using
<tt>(- C #\x0)</tt>:
the displacement from the NUL character.
</p><p>
The rules can be stated as a set of restrictions:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
Two characters may not be added together.
</dd><dt>2.</dt><dd>
A character may not be subtracted from an integer (which also rules out
the possibility of computing the additive inverse of a character).
</dd><dt>3.</dt><dd>
A character operand may not be opposite to a floating point operand
in any operation.
</dd><dt>4.</dt><dd>
A character may not be an operand of multiplication.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-008424F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.2">9.34.2</a=
> Function <tt>/</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(/ </tt><tt><i>divisor</i></tt><tt>)=20




<br>&nbsp;&nbsp;(/ </tt><tt><i>dividend</i></tt><tt> </tt><tt><i>divisor</i=
></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
function performs floating-point division. Each operands is first
converted to floating-point type, if necessary. In the one-argument
form, the
<tt><i>dividend</i></tt>
argument is omitted. An implicit dividend is present, whose value is
<tt>1.0</tt>,
such that the one-argument form
<tt>(/ x)</tt>
is equivalent to the two-argument form
<tt>(/ 1.0 x)</tt>.
</p><p>
If there are two or more arguments, explicitly or by the above equivalence,
then a cumulative division is performed. The
<tt><i>divisor</i></tt>
value is taken into consideration, and divided by the first
<tt>divisor</tt>.
If another
<tt>divisor</tt>
follows, then that value is divided by that subsequent divisor.
This process repeats until all divisors are exhausted, and the
value of the last division is returned.
</p><p>
A division by zero throws an exception of type
<tt>numeric-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0163FFE2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.3">9.34.3</a=
> Functions <tt>sum</tt> and <tt>prod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sum </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>keyfun<=
/i></tt><tt>])=20




<br>&nbsp;&nbsp;(prod </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>keyfun=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">sum</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">prod</a><=
/tt>
functions operate on an effective sequence of numbers derived from
<tt><i>sequence</i></tt>.
</p><p>
If the
<tt><i>keyfun</i></tt>
argument is omitted, then the effective sequence is the
<tt><i>sequence</i></tt>
argument itself. Otherwise, the effective sequence is understood to be
a projection mapping of the elements of
<tt><i>sequence</i></tt>
through
<tt><i>keyfun</i></tt>
as would be calculated by the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a> <=
/tt><tt><i>keyfun</i></tt><tt> </tt><tt><i>sequence</i></tt><tt>)=20

</tt>

expression.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">sum</a></=
tt>
function returns the left-associative sum of the elements of
the effective sequence calculated as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
function.  Similarly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">prod</a><=
/tt>
function calculates the left-associative product of the elements of
the sequence as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
function.
</p><p>
If
<tt><i>sequence</i></tt>
is empty then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">sum</a></=
tt>
returns
<tt>0</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163FFE2">prod</a><=
/tt>
returns
<tt>1</tt>.
</p><p>
If the effective sequence contains one number, then both functions
return that number.
</p><p>

</p></dd></dl>
<a name=3D"N-026DDCEC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.4">9.34.4</a=
> Functions <tt>wrap</tt> and <tt>wrap*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(wrap </tt><tt><i>start</i></tt><tt> </tt><tt><i>end</i></t=
t><tt> </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(wrap* </tt><tt><i>start</i></tt><tt> </tt><tt><i>end</i></=
tt><tt> </tt><tt><i>number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026DDCEC">wrap</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026DDCEC">wrap*</a>=
</tt>
functions reduce
<tt><i>number</i></tt>
into the range specified by
<tt><i>start</i></tt>
and
<tt><i>end</i></tt>.
</p><p>
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026DDCEC">wrap</a><=
/tt>
the range is inclusive of the
<tt><i>end</i></tt>
value, whereas under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026DDCEC">wrap*</a>=
</tt>
it is exclusive.
</p><p>
The following equivalence holds
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
6DDCEC">wrap</a> a b c) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-026DDCEC">wrap*</a> a (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-038E636C">succ</a> b) c)
</tt></pre><tt>

</tt>

<p>
The expression
<tt>(wrap* x0 x1 x)</tt>
performs the following calculation:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">=
+</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> x x0) (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> x1 x0)) x0)=20

</tt>

</p><p>
In other words, first
<tt><i>start</i></tt>
is subtracted from
<tt><i>number</i></tt>.
Then the result is reduced modulo the displacement
between
<tt>start</tt>
and
<tt>end</tt>.
Finally,
<tt><i>start</i></tt>
is added back to that result, which is returned.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; perform ROT13 on the string "nop"
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 13) (<a href=
=3D"http://nongnu.org/txr/txr-manpage.html#N-026DDCEC">wrap</a> #\a #\z)) "=
nop"] -&gt; "abc"
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03D44645">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.5">9.34.5</a=
> Functions <tt>gcd</tt> and <tt>lcm</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(gcd </tt><tt><i>number</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(lcm </tt><tt><i>number</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D44645">gcd</a></=
tt>
function computes the greatest common divisor: the largest positive
integer which divides each
<tt><i>number</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D44645">lcm</a></=
tt>
function computes the lowest common multiple: the smallest positive
integer which is a multiple of
each
<tt><i>number</i></tt>.
</p><p>
Each
<tt><i>number</i></tt>
must be an integer.
</p><p>
Negative integers are replaced by their absolute values, so
<tt>(lcm -3 -4)</tt>
is
<tt>12</tt>
and
<tt>(gcd -12 -9)</tt>
yields
<tt>3</tt>.
</p><p>
The value of
<tt>(gcd)</tt>
is
<tt>0</tt>
and that of
<tt>(lcm)</tt>
is 1 .
</p><p>
The value of
<tt>(gcd x)</tt>
and
<tt>(lcm x)</tt>
is
<tt>(abs x)</tt>.
</p><p>
Any arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D44645">gcd</a></=
tt>
which are zero are effectively ignored so that
<tt>(gcd 0)</tt>
and
<tt>(gcd 0 0 0)</tt>
are both the same as
<tt>(gcd)</tt>
and
<tt>(gcd 1 0 2 0 3)</tt>
is the same as
<tt>(gcd 1 2 3)</tt>.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D44645">lcm</a></=
tt>
has any argument which is zero, it yields zero.
</p><p>

</p></dd></dl>
<a name=3D"N-02A088B3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.6">9.34.6</a=
> Function <tt>divides</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(divides </tt><tt><i>d</i></tt><tt> </tt><tt><i>n</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A088B3">divides</=
a></tt>
function tests whether integer
<tt><i>d</i></tt>
divides integer
<tt><i>n</i></tt>.
If this is true,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The integers 1 and -1 divide every other integer and themselves.
By established convention, every integer, except zero, divides zero.
</p><p>
For other values,
<tt><i>d</i></tt>
divides
<tt><i>n</i></tt>
if division of
<tt><i>n</i></tt>
by
<tt><i>d</i></tt>
leaves no remainder.
</p><p>

</p></dd></dl>
<a name=3D"N-0297F537">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.7">9.34.7</a=
> Function <tt>abs</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(abs </tt><tt><i>number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0032">abs</a></tt>
function computes the absolute value of
<tt><i>number</i></tt>.
If
<tt><i>number</i></tt>
is positive, it is returned. If
<tt><i>number</i></tt>
is negative, its additive inverse is
returned: a positive number of the same type with exactly the same magnitud=
e.
</p><p>

</p></dd></dl>
<a name=3D"N-03AD95A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.8">9.34.8</a=
> Function <tt>signum</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(signum </tt><tt><i>number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001F">signum</a></t=
t>
function calculates a representation of the sign of
<tt><i>number</i></tt>
as a numeric value.
</p><p>
If
<tt><i>number</i></tt>
is an integer, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001F">signum</a></t=
t>
returns -1 if the integer is negative, 1 if the integer is positive,
or else 0.
</p><p>
If
<tt><i>number</i></tt>
is a floating-point value then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001F">signum</a></t=
t>
returns -1.0 if the value is negative, 1.0 if the value is positive or
else 0.0.
</p><p>

</p></dd></dl>
<a name=3D"N-02084F55">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.9">9.34.9</a=
> Functions <tt>trunc</tt>, <tt>floor</tt>, <tt>ceil</tt> and <tt>round</tt=
></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trunc </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>divis=
or</i></tt><tt>])=20




<br>&nbsp;&nbsp;(floor </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>divis=
or</i></tt><tt>])=20




<br>&nbsp;&nbsp;(ceil </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>diviso=
r</i></tt><tt>])=20




<br>&nbsp;&nbsp;(round </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>divis=
or</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>,
<tt>ceiling</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
functions perform division of the
<tt><i>dividend</i></tt>
by the
<tt><i>divisor</i></tt>,
returning an integer quotient.
</p><p>
If the
<tt><i>divisor</i></tt>
is omitted, it defaults to 1.
</p><p>
A zero
<tt><i>divisor</i></tt>
results in an exception of type
<tt>numeric-error</tt>.
</p><p>
If both inputs are integers,
the result is of type integer.
</p><p>
If all inputs are numbers and at least one of them is
floating-point, the others are converted to floating-point
and the result is floating-point.
</p><p>
The
<tt>dividend</tt>
input may be a range. In this situation, the operation is
recursively distributed over the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
fields of the range, individually matched against the
<tt><i>divisor</i></tt>,
and the result is a range composed of these two individual
quotients.
</p><p>
When the quotient is a scalar value,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>
returns the closest integer, in the zero direction,
from the value of the quotient.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>
function returns the highest integer which does not exceed
the value of the quotient. That is to say, the division is
truncated to an integer value toward negative infinity.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a></tt>
function the lowest integer which is not below the value
of the quotient.
does not exceed the value of
<tt><i>dividend</i></tt>.
That is to say, the division is truncated to an integer
value toward positive infinity. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
function returns the nearest integer to the quotient.
Exact halfway cases are rounded to the integer away from
zero so that
<tt>(round -1 2)</tt>
yields
<tt>-1</tt>
and
<tt>(round 1 2)</tt>
yields 1.
</p><p>
Note that for large floating point values, due to the limited
precision, the integer value corresponding to the mathematical
floor or ceiling may not be available.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


In ANSI Common Lisp, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
function chooses the nearest even integer, rather than
rounding halfway cases away from zero. <b>TXR</b>'s choice
harmonizes with the semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
function in the C language.
</p><p>

</p></dd></dl>
<a name=3D"N-0047F5A8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.10">9.34.10<=
/a> Function <tt>mod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mod </tt><tt><i>dividend</i></tt><tt> </tt><tt><i>divisor<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a></tt>
function performs a modulus operation. Firstly, the absolute value
of
<tt><i>divisor</i></tt>
is taken to be a modulus. Then a residue of
<tt><i>dividend</i></tt>
with respect to
<tt><i>modulus</i></tt>
is calculated. The residue's sign follows
that of the sign of
<tt><i>divisor</i></tt>.
That is, it is the smallest magnitude
(closest to zero) residue of
<tt><i>dividend</i></tt>
with respect to the absolute
value of
<tt><i>divisor</i></tt>,
having the same sign as
<tt><i>divisor</i></tt>.
If the operands are integer, the result is an integer. If either operand
is of type float, then the result is a float. The modulus operation is
then generalized into the floating point domain. For instance the expressio=
n
<tt>(mod 0.75 0.5)</tt>
yields a residue of 0.25 because 0.5 "goes into" 0.75 only
once, with a "remainder" of 0.25.
</p><p>
If
<tt><i>divisor</i></tt>
is zero,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a></tt>
throws an exception of type
<tt>numeric-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02DE978F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.11">9.34.11<=
/a> Functions <tt>trunc-rem</tt>, <tt>floor-rem</tt>, <tt>ceil-rem</tt> and=
 <tt>round-rem</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trunc-rem </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>d=
ivisor</i></tt><tt>])=20




<br>&nbsp;&nbsp;(floor-rem </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>d=
ivisor</i></tt><tt>])=20




<br>&nbsp;&nbsp;(ceil-rem </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>di=
visor</i></tt><tt>])=20




<br>&nbsp;&nbsp;(round-rem </tt><tt><i>dividend</i></tt><tt> [</tt><tt><i>d=
ivisor</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions, respectively, perform the same division operation
as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a></tt>=
,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>,
referred to here as the respective target functions.
</p><p>
If the
<tt><i>divisor</i></tt>
is missing, it defaults to 1.
</p><p>
Each function returns a list of two values: a
<tt><i>quotient</i></tt>
and a
<tt><i>remainder</i></tt>.
The
<tt><i>quotient</i></tt>
is exactly the same value as what would be returned by the
respective target function for the same inputs.
</p><p>
The
<tt><i>remainder</i></tt>
value obeys the following identity:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B=
35">eql</a> </tt><tt><i>remainder</i></tt><tt> (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#D-0009">-</a> </tt><tt><i>dividend</i></tt><tt> (*</=
tt><tt><i>divisor</i></tt><tt> </tt><tt><i>quotient</i></tt><tt>)))=20

</tt>

</p><p>
If
<tt><i>divisor</i></tt>
is zero, these functions throw an exception of type
<tt>numeric-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00F5D388">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.12">9.34.12<=
/a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan</tt>, <tt>asin</tt>, <tt>=
acos</tt>, <tt>atan</tt> and <tt>atan2</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sin </tt><tt><i>radians</i></tt><tt>)=20




<br>&nbsp;&nbsp;(cos </tt><tt><i>radians</i></tt><tt>)=20




<br>&nbsp;&nbsp;(tan </tt><tt><i>radians</i></tt><tt>)=20




<br>&nbsp;&nbsp;(atan </tt><tt><i>slope</i></tt><tt>)=20




<br>&nbsp;&nbsp;(atan2 </tt><tt><i>y</i></tt><tt> </tt><tt><i>x</i></tt><tt=
>)=20




<br>&nbsp;&nbsp;(asin </tt><tt><i>num</i></tt><tt>)=20




<br>&nbsp;&nbsp;(acos </tt><tt><i>num</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These trigonometric functions convert their argument to floating point and
return a float result. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0018">sin</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0042">cos</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0070">tan</a></tt>
functions compute the sine and
cosine and tangent of the
<tt><i>radians</i></tt>
argument which represents an angle
expressed in radians. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0011">atan</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004B">acos</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0072">asin</a></tt>
are their respective inverse
functions.  The
<tt><i>num</i></tt>
argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0072">asin</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004B">acos</a></tt>
must be in the
range -1.0 to 1.0. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0015">atan2</a></tt=
>
function converts the rectilinear coordinates
<tt><i>x</i></tt>
and
<tt><i>y</i></tt>
to an angle in polar coordinates in the range [0, 2=CF=80).
</p><p>

</p></dd></dl>
<a name=3D"N-01DC05E9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.13">9.34.13<=
/a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>tanh</tt>, <tt>asinh</tt>, =
<tt>acosh</tt> and <tt>atanh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sinh </tt><tt><i>argument</i></tt><tt>)=20




<br>&nbsp;&nbsp;(cosh </tt><tt><i>argument</i></tt><tt>)=20




<br>&nbsp;&nbsp;(tanh </tt><tt><i>argument</i></tt><tt>)=20




<br>&nbsp;&nbsp;(atanh </tt><tt><i>argument</i></tt><tt>)=20




<br>&nbsp;&nbsp;(asinh </tt><tt><i>argument</i></tt><tt>)=20




<br>&nbsp;&nbsp;(acosh </tt><tt><i>argument</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions are the hyperbolic analogs of the trigonometric functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0018">sin</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0042">cos</a></tt>
and so forth. They convert their argument to floating point and
return a float result.
</p><p>

</p></dd></dl>
<a name=3D"N-02C4F18A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.14">9.34.14<=
/a> Functions <tt>exp</tt>, <tt>log</tt>, <tt>log10</tt> and <tt>log2</tt><=
/h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exp </tt><tt><i>arg</i></tt><tt>)=20




<br>&nbsp;&nbsp;(log </tt><tt><i>arg</i></tt><tt>)=20




<br>&nbsp;&nbsp;(log10 </tt><tt><i>arg</i></tt><tt>)=20




<br>&nbsp;&nbsp;(log2 </tt><tt><i>arg</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0060">exp</a></tt>
function calculates the value of the transcendental number e raised to
the exponent
<tt><i>arg</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007F">log</a></tt>
function calculates the base e logarithm of
<tt><i>arg</i></tt>,
which must be a positive value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0014">log10</a></tt=
>
function calculates the base 10 logarithm of
<tt><i>arg</i></tt>,
which must be a positive value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0063">log2</a></tt>
function calculates the base 2 logarithm of
<tt><i>arg</i></tt>,
which must be a positive value.
</p><p>

</p></dd></dl>
<a name=3D"N-0127A60B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.15">9.34.15<=
/a> Functions <tt>expt</tt>, <tt>sqrt</tt> and <tt>isqrt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(expt </tt><tt><i>base</i></tt><tt> </tt><tt><i>exponent</i=
></tt><tt>*)=20




<br>&nbsp;&nbsp;(sqrt </tt><tt><i>arg</i></tt><tt>)=20




<br>&nbsp;&nbsp;(isqrt </tt><tt><i>arg</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0066">expt</a></tt>
function raises
<tt><i>base</i></tt>
to zero or more exponents given
by the
<tt><i>exponent</i></tt>
arguments.
<tt>(expt x)</tt>
is equivalent to
<tt>(expt x 1)</tt>,
and yields
<tt>x</tt>
for all
<tt>x</tt>.
For three or more arguments, the operation is right-associative.
That is to say,
<tt>(expt x y z)</tt>
is equivalent to
<tt>(expt x (expt y z))</tt>,
similarly to the way nested exponents work in standard algebraic
notation.
</p><p>
Exponentiation is done pairwise using a binary operation.
If both operands to this binary operation are non-negative integers, then t=
he
result is an integer.
</p><p>
If the exponent is negative, and the base is zero, the situation is
treated as a division by zero: an exception of type
<tt>numeric-error</tt>
is thrown. Otherwise, a negative exponent is converted to floating-point,
if it already isn't, and a floating-point exponentiation is performed.
</p><p>
If either operand is a float, then the other
operand is converted to a float, and a floating point exponentiation
is performed. Exponentiation that would produce a complex number is
not supported.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004A">sqrt</a></tt>
function produces a floating-point square root of
<tt><i>arg</i></tt>,
which is converted from integer to floating-point if necessary.  Negative
operands are not supported.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0068">isqrt</a></tt=
>
function computes the integer square root of
<tt><i>arg</i></tt>,
which must be an integer.
The integer square root is a value which is the
greatest integer that is no greater than the real square root of
<tt><i>arg</i></tt>.
The input value must be an integer.
</p><p>

</p></dd></dl>
<a name=3D"N-034A37D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.16">9.34.16<=
/a> Function <tt>exptmod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exptmod </tt><tt><i>base</i></tt><tt> </tt><tt><i>exponent=
</i></tt><tt> </tt><tt><i>modulus</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0064">exptmod</a></=
tt>
function performs modular exponentiation and accepts only integer
arguments. Furthermore,
<tt><i>exponent</i></tt>
must be a non-negative and
<tt><i>modulus</i></tt>
must be positive.
</p><p>
The return value is
<tt><i>base</i></tt>
raised to
<tt><i>exponent</i></tt>,
and reduced to the
least positive residue modulo
<tt><i>modulus</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-012730BE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.17">9.34.17<=
/a> Function <tt>square</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(square </tt><tt><i>argument</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005C">square</a></t=
t>
function returns the product of
<tt><i>argument</i></tt>
with itself. The following
equivalence holds, except that
<tt>x</tt>
is evaluated only once in the the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005C">square</a></t=
t>
expression:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
5C">square</a> x)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-022396F7">*</a> x x)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03AB449B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.18">9.34.18<=
/a> Function <tt>cum-norm-dist</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cum-norm-dist </tt><tt><i>argument</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AB449B">cum-norm-=
dist</a></tt>
function calculates an approximation to the cumulative normal
distribution function: the integral, of the normal distribution function, f=
rom
negative infinity to the
<tt><i>argument</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0036EAFB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.19">9.34.19<=
/a> Function <tt>inv-cum-norm</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(inv-cum-norm </tt><tt><i>argument</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036EAFB">inv-cum-n=
orm</a></tt>
function calculates an approximate to the inverse of the cumulative
normal distribution function.  The argument, a value expected to lie
in the range [0, 1], represents the integral of the normal distribution
function from negative infinity to some domain point
<i>p</i>.

The function calculates the approximate value of
<i>p</i>.

The minimum value returned is -10, and the maximum value returned is 10,
regardless of how closely the argument approaches, respectively,
the 0 or 1 integral endpoints.  For values less than zero, or exceeding 1, =
the
values returned, respectively, are -10 and 10.
</p><p>

</p></dd></dl>
<a name=3D"N-02ACFDE6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.20">9.34.20<=
/a> Functions <tt>n-choose-k</tt> and <tt>n-perm-k</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(n-choose-k </tt><tt><i>n</i></tt><tt> </tt><tt><i>k</i></t=
t><tt>)=20




<br>&nbsp;&nbsp;(n-perm-k </tt><tt><i>n</i></tt><tt> </tt><tt><i>k</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ACFDE6">n-choose-=
k</a></tt>
function computes the binomial coefficient nCk which
expresses the number of combinations of
<tt><i>k</i></tt>
items that can be chosen from
a set of
<tt><i>n</i></tt>,
where combinations are subsets.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ACFDE6">n-perm-k<=
/a></tt>
function computes nPk: the number of permutations of size
<tt><i>k</i></tt>
that can be drawn from a set of
<tt><i>n</i></tt>,
where permutations are sequences,
whose order is significant.
</p><p>
The calculations only make sense when
<tt><i>n</i></tt>
and
<tt><i>k</i></tt>
are nonnegative integers, and
<tt><i>k</i></tt>
does not exceed
<tt><i>n</i></tt>.
The behavior is not specified if these conditions
are not met.
</p><p>

</p></dd></dl>
<a name=3D"N-03E9D6E1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.21">9.34.21<=
/a> Functions <tt>fixnump</tt>, <tt>bignump</tt>, <tt>integerp</tt>, <tt>fl=
oatp</tt> and <tt>numberp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fixnump </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(bignump </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(integerp </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(floatp </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(numberp </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions test the type of
<tt><i>object</i></tt>,
returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it is an object
of the implied type,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">fixnump</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">bignump</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">floatp</a=
></tt>
functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the object is of the basic type
<tt>fixnum</tt>,
<tt>bignum</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>.
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">integerp<=
/a></tt>
returns true of
<tt><i>object</i></tt>
is either a
<tt>fixnum</tt>
or
a
<tt>bignum</tt>.
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">numberp</=
a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is either
a
<tt>fixnum</tt>,
<tt>bignum</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0197FF9D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.22">9.34.22<=
/a> Functions <tt>zerop</tt> and <tt>nzerop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(zerop </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(nzerop </tt><tt><i>number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>
function tests
<tt><i>number</i></tt>
for equivalence to zero. The argument must be
a number or character. It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
for the integer value
<tt>0</tt>
and for the floating-point
value
<tt>0.0</tt>.
For other numbers, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
for the null character
<tt>#\nul</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for all other characters.
</p><p>
If
<tt><i>number</i></tt>
is a range, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if both of the range endpoints individually satisfy
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0197FF9D">nzerop</a=
></tt>
function is the logical inverse of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>:
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
for those arguments for which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and
<i>vice versa</i>.

</p><p>

</p></dd></dl>
<a name=3D"N-019BF656">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.23">9.34.23<=
/a> Functions <tt>plusp</tt> and <tt>minusp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(plusp </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(minusp </tt><tt><i>number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions test whether a number is positive or negative,
returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
as the case may be.
</p><p>
The argument may also be a character. All characters other than
the null character
<tt>#\nul</tt>
are positive. No character is negative.
</p><p>

</p></dd></dl>
<a name=3D"N-02140809">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.24">9.34.24<=
/a> Functions <tt>evenp</tt> and <tt>oddp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(evenp </tt><tt><i>integer</i></tt><tt>)=20




<br>&nbsp;&nbsp;(oddp </tt><tt><i>integer</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a></tt>
functions require integer arguments.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a></tt=
>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>integer</i></tt>
is even (divisible by two), otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>integer</i></tt>
is not divisible by two (odd), otherwise
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-038E636C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.25">9.34.25<=
/a> Functions <tt>succ</tt>, <tt>ssucc</tt>, <tt>sssucc</tt>, <tt>pred</tt>=
, <tt>ppred</tt> and <tt>pppred</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(succ </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(ssucc </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(sssucc </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(pred </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(ppred </tt><tt><i>number</i></tt><tt>)=20




<br>&nbsp;&nbsp;(pppred </tt><tt><i>number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">succ</a><=
/tt>
function adds 1 to its argument and returns the resulting value.
If the argument is an integer, then the return value is the successor
of that integer, and if it is a character, then the return value
is the successor of that character according to Unicode.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">pred</a><=
/tt>
function subtracts 1 from its argument, and under similar considerations
as above, the result represents the predecessor.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">ssucc</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">sssucc</a=
></tt>
functions add 2 and 3, respectively. Similarly,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">ppred</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038E636C">pppred</a=
></tt>
subtract 2 and 3 from their argument.
</p><p>

</p></dd></dl>
<a name=3D"N-02A1116F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.26">9.34.26<=
/a> Functions <tt>&gt;</tt>, <tt>&lt;</tt>, <tt>&gt;=3D</tt>, <tt>&lt;=3D</=
tt> and <tt>=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(&gt; </tt><tt><i>object</i></tt><tt> </tt><tt><i>object</i=
></tt><tt>*)=20




<br>&nbsp;&nbsp;(&lt; </tt><tt><i>object</i></tt><tt> </tt><tt><i>object</i=
></tt><tt>*)=20




<br>&nbsp;&nbsp;(&gt;=3D </tt><tt><i>object</i></tt><tt> </tt><tt><i>object=
</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(&lt;=3D </tt><tt><i>object</i></tt><tt> </tt><tt><i>object=
</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(=3D </tt><tt><i>object</i></tt><tt> </tt><tt><i>object</i>=
</tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These relational functions compare characters, numbers ranges and sequences=
 of
characters or numbers for numeric equality or inequality. The arguments mus=
t be
one or more numbers, characters, ranges, or sequences of these objects,
or, recursively, of sequences.
</p><p>
If just one argument is given, then these functions all return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
If two arguments are given then, they are compared as follows.
First, if the numbers do not have the same type, then the one
which has the lower ranking type is converted to the type of
the other, according to this ranking: character &lt; integer &lt; float.
For instance if a character and integer are compared, the character
is converted to integer. Then a straightforward numeric comparison
is applied.
</p><p>
Three or more arguments may be given, in which case the comparison proceeds
pairwise from left to right. For instance in
<tt>(&lt; a b c)</tt>,
the comparison
<tt>(&lt; a b)</tt>
is performed in isolation. If the comparison is false, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned, otherwise
the comparison
<tt>(&lt; b c)</tt>
is performed in isolation, and if that is false,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.  Note that it is possible for
<tt>b</tt>
to
undergo two different conversions.  For instance in the
<tt>




(&lt; </tt><tt><i>float</i></tt><tt> </tt><tt><i>character</i></tt><tt> </t=
t><tt><i>integer</i></tt><tt>)=20

</tt>

comparison,
<tt><i>character</i></tt>
will first convert to a floating-point representation
of its Unicode value so that it can be compared to
<tt><i>float</i></tt>,
and if that comparison succeeds, then in the second comparison,
<tt><i>character</i></tt>
will be converted to integer so that it can be compared to
<tt><i>integer</i></tt>.
</p><p>
Ranges may only be compared with ranges. Corresponding
fields of ranges are compared for equality by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
such that
<tt>#R(0 1)</tt>
and
<tt>#R(0 1.0)</tt>
are reported as equal.
The inequality comparisons are lexicographic, such that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
field of the range is considered more major than the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
field. For example the inequalities
<tt>(&lt; #R(1 2) #R(2 0))</tt>
and
<tt>(&lt; #R(1 2) #R(1 3))</tt>
hold.
</p><p>
Sequences may only be compared with sequences, but
mixtures of any kinds of sequences may be compared:
lists with vectors, vectors with strings, and so on.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
function considers a pair of sequences of unequal length
to be unequal, reporting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Sequences are equal if they have the same length
and their corresponding elements are recursively
equal under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
function.
</p><p>
The inequality functions treat sequences lexicographically.
A pair of sequences is compared by comparing corresponding
elements. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
function tests each successive pair of corresponding
elements recursively using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
function. If this recursive comparison reports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
then the function immediately returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
without considering any more pairs of elements.
Otherwise the same pair of elements is compared again
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
function. If that reports false, then the function reports false without
considering any more pairs of elements. Otherwise processing continues with=
 the
next pair, if any.  If all corresponding elements are equal, but the right
sequence is longer,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
otherwise the function reports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
function tests each successive pair of corresponding
elements recursively using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
function. If this returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
without considering any more pairs. Otherwise processing continues
with the next pair, if any.
If all corresponding elements satisfy the test, but the
left sequence is longer, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.
</p><p>
The inequality relations exhibit symmetry, which means that
the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001A">&gt;=3D</a></=
tt>
functions are equivalent, respectively, to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
with the order of the argument values reversed. For instance, the expressio=
n
<tt>(&lt; a b c)</tt>
is equivalent to
<tt>(&gt; c b a)</tt>
except for the difference in evaluation order of the
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>
operands themselves. Any semantic description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
applies, respectively, also to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001A">&gt;=3D</a></=
tt>
with the appropriate adjustment for argument order reversal.
</p><p>

</p></dd></dl>
<a name=3D"N-003BE40C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.27">9.34.27<=
/a> Function <tt>/=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(/=3D </tt><tt><i>number</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BE40C">/=3D</a><=
/tt>
may be numbers or characters.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BE40C">/=3D</a><=
/tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if no two of its arguments are numerically equal. That is to say, if there
exist some
<tt>a</tt>
and
<tt>b</tt>
which are distinct arguments such that
<tt>(=3D a b)</tt>
is true, then
the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-023C3643">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.28">9.34.28<=
/a> Functions <tt>max</tt> and <tt>min</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(max </tt><tt><i>first-arg</i></tt><tt> </tt><tt><i>arg</i>=
</tt><tt>*)=20




<br>&nbsp;&nbsp;(min </tt><tt><i>first-arg</i></tt><tt> </tt><tt><i>args</i=
></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">max</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">min</a></=
tt>
functions determine and return the highest or lowest
value from among their arguments.
</p><p>
If only
<tt><i>first-arg</i></tt>
is given, that value is returned.
</p><p>
These functions are type generic, since they compare arguments
using the same semantics as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function.
</p><p>
If two or more arguments are given, then
<tt>(max a b)</tt>
is equivalent to
<tt>(if (less a b) b a)</tt>,
and
<tt>(min a b)</tt>
is equivalent to
<tt>(if (less a b) a b)</tt>.
If the operands do not
have the same type, then one of them is converted to the type of the other;
however, the original unconverted values are returned. For instance
<tt>(max 4 3.0)</tt>
yields the integer
<tt>4</tt>,
not
<tt>4.0</tt>.
</p><p>
If three or more arguments are given,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">max</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">min</a></=
tt>
reduce the arguments in a left-associative manner.
Thus
<tt>(max a b c)</tt>
means
<tt>(max (max a b) c)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03B940D4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.29">9.34.29<=
/a> Function <tt>clamp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(clamp </tt><tt><i>low</i></tt><tt> </tt><tt><i>high</i></t=
t><tt> </tt><tt><i>val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B940D4">clamp</a>=
</tt>
function clamps value
<tt><i>val</i></tt>
into the range
<tt><i>low</i></tt>
to
<tt><i>high</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B940D4">clamp</a>=
</tt>
function returns
<tt><i>low</i></tt>
if
<tt><i>val</i></tt>
is less than
<tt><i>low</i></tt>.
If
<tt><i>val</i></tt>
is greater than or equal to
<tt><i>low</i></tt>,
but less than
<tt><i>high</i></tt>,
then it returns
<tt><i>val</i></tt>.
Otherwise it returns
<tt><i>high</i></tt>.
</p><p>
More precisely,
<tt>(clamp a b c)</tt>
is equivalent to
<tt>(max a (min b c))</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02400F97">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.30">9.34.30<=
/a> Function <tt>bracket</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bracket </tt><tt><i>value</i></tt><tt> </tt><tt><i>level</=
i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</=
a></tt>
function's arguments consist of one required
<tt><i>value</i></tt>
followed by
<i>n</i>

<tt><i>level</i></tt>
arguments.
The
<tt><i>level</i></tt>
arguments are optional; in other words,
<i>n</i>

may be zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</=
a></tt>
function calculates the
<i>bracket</i>

of the
<tt><i>value</i></tt>
argument: a zero-based positional index of the value, in relation to the
<tt><i>level</i></tt>
arguments.
</p><p>
Each of the
<tt><i>level</i></tt>
arguments, of which there may be none, is associated with
an integer index, starting at zero, in left to right order. The
<tt><i>level</i></tt>
arguments are examined in that order. When a
<tt><i>level</i></tt>
argument is encountered which exceeds
<tt><i>value</i></tt>,
that
<tt><i>level</i></tt>
argument's index is returned.
If
<tt><i>value</i></tt>
exceeds all of the
<tt><i>level</i></tt>
arguments, then
<i>n</i>

is returned.
</p><p>
Determining whether
<tt><i>value</i></tt>
exceeds a
<tt><i>level</i></tt>
is performed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
400F97">bracket</a> 42) -&gt; 0
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> 5 10) -&gt; 0
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> 15 10) -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> 15 10 20) -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> 15 10 20 30) -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> 20 10 20 30) -&gt; 2
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> 35 10 20 30) -&gt; 3
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> "a" "aardvark" "zebra") -&gt; 0
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> "ant" "aardvark" "zebra") -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02400F97">bracket</a=
> "zebu" "aardvark" "zebra") -&gt; 2
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-028043AE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.31">9.34.31<=
/a> Functions <tt>int-str</tt>, <tt>flo-str</tt> and <tt>num-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(int-str </tt><tt><i>string</i></tt><tt> [</tt><tt><i>radix=
</i></tt><tt>])=20




<br>&nbsp;&nbsp;(flo-str </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(num-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions extract numeric values from character string
<tt><i>string</i></tt>.
Leading whitespace in
<tt><i>string</i></tt>,
if any, is skipped. If no digits can be successfully extracted, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.  Trailing material which does not contribute to the number is
ignored.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>
function converts a string of digits in the specified
<tt><i>radix</i></tt>
to an integer value. If
<tt><i>radix</i></tt>
isn't specified, it defaults to 10.
Otherwise it must be an integer in the range 2 to 36, or else the character
<tt>#\c</tt>.
</p><p>
For radices above 10, letters of the alphabet
are used for digits:
<tt>A</tt>
represent a digit whose value is 10,
<tt>B</tt>
represents 11 and
so forth until
<tt>Z</tt>.
Upper and lower case letters are recognized.
Any character which is not a digit of the specified radix is regarded
as the start of trailing junk at which the extraction of the digits stops.
</p><p>
When
<tt><i>radix</i></tt>
is specified as the character object
<tt>#\c</tt>,
this indicates that a C-language-style integer constant should be
recognized.  If, after any optional sign, the remainder of
<tt><i>string</i></tt>
begins with the character pair
<tt>0x</tt>
then that pair is considered removed from the string, and it is treated
as base 16 (hexadecimal).  If, after any optional sign, the remainder of
<tt><i>string</i></tt>
begins with a leading zero not followed by
<tt>x</tt>,
then the radix is taken to be 8 (octal). In scanning these formats,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>
function is not otherwise constrained by C language representational
limitations. Specifically, the input values are taken to be the printed
representation of arbitrary-precision integers and treated accordingly.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">flo-str</=
a></tt>
function converts a floating-point decimal notation to a nearby
floating point value. The material which contributes to the value
is the longest match for optional leading space, followed by a
mantissa which consists of an optional sign followed by a mixture of at lea=
st
one digit, and at most one decimal point, optionally followed by an exponen=
t
part denoted by the letter
<tt>E</tt>
or
<tt>e</tt>,
an optional sign and one or more optional exponent digits.
If the value specified by
<tt><i>string</i></tt>
is out of range of the floating-point representation, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">num-str</=
a></tt>
function converts a decimal notation to either an integer as if by
a radix 10 application of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>,
or to a floating point value as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">flo-str</=
a></tt>.
The floating point interpretation is chosen if the possibly empty
initial sequence of digits (following any whitespace and optional sign) is
followed by a period, or by
<tt>e</tt>
or
<tt>E</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03F852CF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.32">9.34.32<=
/a> Functions <tt>int-flo</tt> and <tt>flo-int</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(int-flo </tt><tt><i>float</i></tt><tt>)=20




<br>&nbsp;&nbsp;(flo-int </tt><tt><i>integer</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions perform numeric conversion between integer and floating poi=
nt
type. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F852CF">int-flo</=
a></tt>
function returns an integer by truncating toward zero.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F852CF">flo-int</=
a></tt>
function returns an exact floating point value corresponding to
<tt><i>integer</i></tt>,
if possible, otherwise an approximation using a nearby
floating point value.
</p><p>

</p></dd></dl>
<a name=3D"N-01DBC9D7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.33">9.34.33<=
/a> Functions <tt>tofloat</tt> and <tt>toint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tofloat </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(toint </tt><tt><i>value</i></tt><tt> [</tt><tt><i>radix</i=
></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These convenience functions convert
<tt><i>value</i></tt>
to floating-point or integer, respectively.
</p><p>
If a floating-point value is passed into tofloat, or an integer value into
toint, then the value is simply returned.
</p><p>
If
<tt><i>value</i></tt>
is a character, then it is treated as a string of length one
containing that character.
</p><p>
If
<tt><i>value</i></tt>
is a string, then it is converted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">tofloat</=
a></tt>
as if by the function
<tt><i>flo-str</i></tt>,
, and by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>
as if by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028043AE">int-str</=
a></tt>.
</p><p>
If
<tt><i>value</i></tt>
is an integer, then it is converted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">tofloat</=
a></tt>
as if by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F852CF">flo-int</=
a></tt>.
</p><p>
If
<tt><i>value</i></tt>
is a floating-point number, then it is converted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>
as if by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F852CF">int-flo</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02A6CE24">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.34">9.34.34<=
/a> Variables <tt>fixnum-min</tt> and <tt>fixnum-max</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold, respectively, the most negative value of the
<tt>fixnum</tt>
integer type, and its most positive value. Integer values
from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6CE24">fixnum-mi=
n</a></tt>
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A6CE24">fixnum-ma=
x</a></tt>
are all of type
<tt>fixnum</tt>.
Integers outside of this range are
<tt>bignum</tt>
integers.
</p><p>

</p></dd></dl>
<a name=3D"N-03E2D4B8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.35">9.34.35<=
/a> Functions <tt>tofloatz</tt> and <tt>tointz</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tofloatz </tt><tt><i>value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(tointz </tt><tt><i>value</i></tt><tt> [</tt><tt><i>radix</=
i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions are closely related to, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">tofloat</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>.
They differ in that these functions return a floating-point
or integer zero, respectively, in some situations
in which those functions would return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or throw an error.
</p><p>
Whereas those functions reject a
<tt><i>value</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
for that same argument
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E2D4B8">tofloatz<=
/a></tt>
function returns 0.0 and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E2D4B8">tointz</a=
></tt>
returns 0.
</p><p>
Likewise, in cases when
<tt>value</tt>
contains a string or character which cannot be
converted to a number, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">tofloat</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>
would return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
these functions return 0.0 and 0, respectively.
</p><p>
In other situations, these functions behave
exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">tofloat</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0085F231">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.36">9.34.36<=
/a> Variables <tt>flo-min</tt>, <tt>flo-max</tt> and <tt>flo-epsilon</tt></=
h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold, respectively: the smallest positive floating-point
value; the largest positive floating-point value; and the difference
between 1.0 and the smallest representable value greater than 1.0.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085F231">flo-min</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085F231">flo-max</=
a></tt>
define the floating-point range, which consists
of three regions: values from
<tt>(- flo-max)</tt>
to
<tt>(- flo-min)</tt>;
the value 0.0, and values from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085F231">flo-min</=
a></tt>
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085F231">flo-max</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00998CE7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.37">9.34.37<=
/a> Variable <tt>flo-dig</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This variable holds an integer representing the number of decimal digits
in a decimal floating-point number such that this number can be converted
to a <b>TXR</b> floating-point number, and back to decimal, without a chang=
e in any of
the digits. This holds regardless of the value of the number, provided that=
 it
does not exceed the floating-point range.
</p><p>

</p></dd></dl>
<a name=3D"N-01A2123A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.38">9.34.38<=
/a> Variable <tt>flo-max-dig</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This variable holds an integer representing the maximum number of
decimal digits required to capture the value of a floating-point number
such that the resulting decimal form will convert back to the same
floating-point number. See also the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E97D03">*print-fl=
o-precision*</a></tt>
variable.
</p><p>

</p></dd></dl>
<a name=3D"N-03F0FA9E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.39">9.34.39<=
/a> Variables <tt>%pi%</tt> and <tt>%e%</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold an approximation of the mathematical constants =CF=80 =
and e.
To four digits of precision, =CF=80 is 3.142 and e is 2.718. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F0FA9E">%pi%</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F0FA9E">%e%</a></=
tt>
approximations are accurate to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00998CE7">flo-dig</=
a></tt>
decimal digits.
</p><p>

</p></dd></dl>
<a name=3D"N-03CC559E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.40">9.34.40<=
/a> Function <tt>digits</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(digits </tt><tt><i>number</i></tt><tt> [</tt><tt><i>radix<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CC559E">digits</a=
></tt>
function returns a list of the digits of
<tt><i>number</i></tt>
represented in the base given by
<tt><i>radix</i></tt>.
</p><p>
The
<tt><i>number</i></tt>
argument must be a non-negative integer, and
<tt><i>radix</i></tt>
must be an integer greater than one.
</p><p>
If
<tt><i>radix</i></tt>
is omitted, it defaults to 10.
</p><p>
The return value is a list of the digits in descending order of significanc=
e:
most significant to least significant.
The digits are integers. For instance, if
<tt><i>radix</i></tt>
is 42, then the digits are integer values in the range 0 to 41.
</p><p>
The returned list always contains at least one element, and
includes no leading zeros, except when
<tt><i>number</i></tt>
is zero. In that case, a one-element list containing zero is returned.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
CC559E">digits</a> 1234) -&gt; (1 2 3 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CC559E">digits</a>=
 1234567 1000) -&gt; (1 234 567)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CC559E">digits</a>=
 30 2) -&gt; (1 1 1 1 0)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CC559E">digits</a>=
 0) -&gt; (0)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-030C5561">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.41">9.34.41<=
/a> Function <tt>digpow</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(digpow </tt><tt><i>number</i></tt><tt> [</tt><tt><i>radix<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C5561">digpow</a=
></tt>
function decomposes the
<tt><i>number</i></tt>
argument into a power series whose terms add up to
<tt><i>number</i></tt>.
</p><p>
The
<tt><i>number</i></tt>
argument must be a non-negative integer, and
<tt><i>radix</i></tt>
must be an integer greater than one.
</p><p>
The returned power series consists of a list of nonnegative
integers.  It is formed from the digits of
<tt><i>number</i></tt>
in the given
<tt><i>radix</i></tt>,
which serve as coefficients which multiply successive
powers of the
<tt><i>radix</i></tt>,
starting at the zeroth power (one).
</p><p>
The terms are given in decreasing order of significance:
the term corresponding to the most significant digit of
<tt><i>number</i></tt>,
multiplying the highest power of
<tt><i>radix</i></tt>,
is listed first.
</p><p>
The returned list always contains at least one element, and
includes no leading zeros, except when
<tt><i>number</i></tt>
is zero. In that case, a one-element list containing zero is returned.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
0C5561">digpow</a> 1234) -&gt; (1000 200 30 4)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C5561">digpow</a>=
 1234567 1000) -&gt; (1000000 234000 567)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C5561">digpow</a>=
 30 2) -&gt; (16 8 4 2 0)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C5561">digpow</a>=
 0) -&gt; (0)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-026201AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.42">9.34.42<=
/a> Functions <tt>poly</tt> and <tt>rpoly</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(poly </tt><tt><i>arg</i></tt><tt> </tt><tt><i>coeffs</i></=
tt><tt>)=20




<br>&nbsp;&nbsp;(rpoly </tt><tt><i>arg</i></tt><tt> </tt><tt><i>coeffs</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">poly</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">rpoly</a>=
</tt>
functions evaluate a polynomial, for the given numeric argument value
<tt><i>arg</i></tt>
and the coefficients given by
<tt><i>coeffs</i></tt>,
a sequence of numbers.
</p><p>
If
<tt><i>coeffs</i></tt>
is an empty sequence, it denotes the zero polynomial, whose value
is zero everywhere; the functions return zero in this case.
</p><p>
Otherwise, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">poly</a><=
/tt>
function considers
<tt><i>coeffs</i></tt>
to hold the coefficients in the conventional order, namely in order
of decreasing degree of polynomial term. The first element of
<tt><i>coeffs</i></tt>
is the leading coefficient, and the constant term appears as the last eleme=
nt.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">rpoly</a>=
</tt>
function takes the coefficients in opposite order: the first element of
<tt><i>coeffs</i></tt>
gives the constant term coefficient, and the last element gives the
leading coefficient.
</p><p>
Note: except in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">rpoly</a>=
</tt>
operating on a list or list-like sequence of coefficients,
Horner's method of evaluation is
used: a single result accumulator is initialized with zero, and then for ea=
ch
successive coefficient, in order of decreasing term degree, the accumulator=
 is
multiplied by the argument, and the coefficient is added. When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">rpoly</a>=
</tt>
operates on a list or list-like sequence, it makes a single
pass through the coefficients in order, thus taking them in increasing
term degree.  It maintains two accumulators: one for successive powers of
<tt><i>arg</i></tt>
and one for the resulting value. For each coefficient, the power
accumulator is updated by a multiplication by
<tt><i>arg</i></tt>
and then this value is multiplied by the coefficient, and
that value is then added to the result accumulator.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;;           2
  ;; evaluate x  +  2x + 3  for x =3D 10.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">poly</a> 1=
0 '(1 2 3)) -&gt; 123

  ;;            2
  ;; evaluate 3x  +  2x + 1  for x =3D 10.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026201AD">rpoly</a> =
10 '(1 2 3)) -&gt; 321
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-020294AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.43">9.34.43<=
/a> Function <tt>bignum-len</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bignum-len </tt><tt><i>arg</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020294AB">bignum-le=
n</a></tt>
function reports the machine-specific
<i>bignum order</i>

of the integer or character argument
<tt><i>arg</i></tt>.
</p><p>
If
<tt><i>arg</i></tt>
is a character or
<tt>fixnum</tt>
integer, the function returns zero.
</p><p>
Otherwise
<tt><i>arg</i></tt>
is expected to be a
<tt>bignum</tt>
integer, and the function returns the number of "limbs" used for its
representation, a positive integer.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020294AB">bignum-le=
n</a></tt>
function is intended to be of use in algorithms whose performance
benefits from ordering the operations on multiple integer operands
according to the magnitudes of those operands. The function provides an
estimate of magnitude which trades accuracy for efficiency.
</p><p>

</p></dd></dl>
<a name=3D"N-013A1643">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.44">9.34.44<=
/a> Variables <tt>flo-near</tt>, <tt>flo-down</tt>, <tt>flo-up</tt> and <tt=
>flo-zero</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integer values suitable as arguments to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085ACA3">flo-set-r=
ound-mode</a></tt>
function, which controls the rounding mode for the results of floating-poin=
t
operations.  These variables are only defined on platforms which support
rounding control.
</p><p>
Their values have the following meanings:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt><tt>flo-near</tt></dt><dd>

Round to nearest: the result of an operation is rounded to the nearest
representable value.
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">=
flo-down</a></tt></dt><dd>

Round down: the result of an operation is rounded to the nearest representa=
ble
value that lies in the direction of negative infinity.
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">=
flo-up</a></tt></dt><dd>

Round up: the result of an operation is rounded to the nearest representabl=
e
value that lies in the direction of positive infinity.
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">=
flo-zero</a></tt></dt><dd>

Round to zero: the result of an operation is rounded to the nearest
representable value that lies in the direction of zero.
</dd></dl>
</dl>


</dd></dl>
<a name=3D"N-0085ACA3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.34.45">9.34.45<=
/a> Functions <tt>flo-get-round-mode</tt> and <tt>flo-set-round-mode</tt></=
h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flo-get-round-mode)=20




<br>&nbsp;&nbsp;(flo-set-round-mode </tt><tt><i>mode</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Sometimes floating-point operations produce a result which
requires more bits of precision than the floating point representation
can provide. A representable floating-point value must be substituted
for the true result and yielded by the operation.
</p><p>
On platforms which support rounding control, these functions are provided f=
or
selecting the decision procedure by which the floating-point representation
is taken.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085ACA3">flo-get-r=
ound-mode</a></tt>
returns the current rounding mode. The rounding mode is represented by
an integer value which is either equal to one of the four variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">flo-near<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">flo-down<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">flo-up</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">flo-zero<=
/a></tt>,
or else some other value specific to the host environment. Initially,
the value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013A1643">flo-near<=
/a></tt>.
Otherwise, the value returned is that which was stored by the most
recent successful call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085ACA3">flo-set-r=
ound-mode</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085ACA3">flo-set-r=
ound-mode</a></tt>
function changes the rounding mode. The argument to its
<tt><i>mode</i></tt>
parameter may be the value of one of the above four variables,
or else some other value supported by the host environment's
<tt>fesetround</tt>
C library function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085ACA3">flo-set-r=
ound-mode</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it is successful, otherwise the return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and the rounding mode is not changed.
</p><p>
If a value is is passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085ACA3">flo-set-r=
ound-mode</a></tt>
which is not the value of one of the above
four rounding mode variables, and the function succeeds anyway, then the
rounding behavior of floating-point operations depends on the host
environment's interpretation of that value.
</p><p>
</p></dd></dl>
<a name=3D"N-00842C88">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35">9.35</a> Bi=
t Operations</h3>



<p>


In <b>TXR Lisp</b>, similarly to Common Lisp, bit operations on integers ar=
e based
on a concept that might be called "infinite two's-complement".  Under infin=
ite two's complement, a positive number is regarded as having
a binary representation prefixed by an infinite stream of zero digits (for
example
<tt>1</tt>
is
<tt>...00001</tt>).
A negative number
in infinite two's complement is the bitwise negation of its positive counte=
rpart,
plus one: it carries an infinite prefix of 1 digits. So for instance the nu=
mber
<tt>-1</tt>
is represented by
<tt>...11111111</tt>:
an infinite sequence of
1
bits. There
is no specific sign bit; any operation which produces such an infinite sequ=
ence
of 1 digits on the left gives rise to a negative number. For instance, cons=
ider the
operation of computing the bitwise complement of the number
<tt>1</tt>.
Since the
number
<tt>1</tt>
is represented as
<tt>...0000001</tt>,
its complement is
<tt>...11111110</tt>.
Each one of the
<tt>0</tt>
digits in the infinite sequence is replaced by
<tt>1</tt>,
And this leading sequence means that the number
is negative, in fact corresponding to the two's-complement representation o=
f
the value
<tt>-2</tt>.
Hence, the infinite digit concept corresponds to an arithmetic
interpretation.
</p><p>
In fact <b>TXR Lisp</b>'s bignum integers do not use a two's complement
representation internally. Numbers are represented as an array which holds =
a
pure binary number. A separate field indicates the sign: negative,
or non-negative.  That negative numbers appear as two's-complement under th=
e
bit operations is merely a carefully maintained illusion (which makes bit
operations on negative numbers more expensive).
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
function, as well as a feature of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
function, allow bit
manipulation code to be written which works with positive numbers only, eve=
n if
complements are required. The trade off is that the application has to mana=
ge a
limit on the number of bits.
</p><p>

<a name=3D"N-02D5AF97">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.1">9.35.=
1</a> Functions <tt>logand</tt>, <tt>logior</tt> and <tt>logxor</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(logand </tt><tt><i>integer</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(logior </tt><tt><i>integer</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(logxor </tt><tt><i>int1</i></tt><tt> </tt><tt><i>int2</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These operations perform the familiar bitwise and, inclusive or, and exclus=
ive
or operations, respectively. Positive values inputs are treated as
pure binary numbers.  Negative inputs are treated as infinite-bit
two's-complement.
</p><p>
For example
<tt>(logand -2 7)</tt>
produces
<tt>6</tt>.
This is because
<tt>-2</tt>
is
<tt>...111110</tt>
in infinite-bit two's-complement.  And-ing this value with
<tt>7</tt>
(or
<tt>...000111</tt>)
produces
<tt>110</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
functions are variadic, and may be called with zero, one,
two, or more input values. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a></t=
t>
is called with no arguments, it produces
the value -1 (all bits 1). If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
is called with no arguments it produces
zero. In the one-argument case, the functions just return their argument va=
lue.
</p><p>
In the two-argument case, one of the operands may be a character, if the ot=
her
operand is a fixnum integer. The character operand is taken to be an intege=
r
corresponding to the character value's Unicode code point value. The result=
ing
value is regarded as a Unicode code point and converted to a character valu=
e
accordingly.
</p><p>
When three or more arguments are specified, the operation's semantics is
that of a left-associative reduction through two-argument invocations,
so that the three-argument case
<tt>(logand a b c)</tt>
is equivalent to the expression
<tt>(logand (logand a b) c)</tt>,
which features two two-argument cases..
</p><p>

</p></dd></dl>
<a name=3D"N-00B1548A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.2">9.35.2</a=
> Function <tt>logtest</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(logtest </tt><tt><i>int1</i></tt><tt> </tt><tt><i>int2</i>=
</tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1548A">logtest</=
a></tt>
function returns true if
<tt><i>int1</i></tt>
and
<tt><i>int2</i></tt>
have bits in
common. The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B1548A">logtest</a> a b) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#D-0050">not</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-0074">zerop</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
001C">logand</a> a b)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-006B7321">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.3">9.35.3</a=
> Functions <tt>lognot</tt> and <tt>logtrunc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lognot </tt><tt><i>value</i></tt><tt> [</tt><tt><i>bits</i=
></tt><tt>])=20




<br>&nbsp;&nbsp;(logtrunc </tt><tt><i>value</i></tt><tt> </tt><tt><i>bits</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
function performs a bitwise complement of
<tt><i>value</i></tt>.
When the one-argument form of lognot is used, then if
<tt><i>value</i></tt>
is nonnegative,
then the result is negative, and
<i>vice versa</i>,

according to the infinite-bit
two's complement representation. For instance
<tt>(lognot -2)</tt>
is
<tt>1</tt>,
and
<tt>(lognot 1)</tt>
is
<tt>-2</tt>.
</p><p>
The two-argument form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
produces a truncated complement. Conceptually,
a bitwise complement is first calculated, and then the resulting number is
truncated to the number of bits given by
<tt><i>bits</i></tt>,
which must be a nonnegative integer. The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
24">lognot</a> a b) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#D-0065">logtrunc</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-0024">lognot</a> a) b)
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
function truncates the integer
<tt><i>value</i></tt>
to the  specified number
of bits. If
<tt><i>value</i></tt>
is negative, then the two's-complement representation
is truncated. The return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
is always a non-negative integer.
</p><p>

</p></dd></dl>
<a name=3D"N-026F9F46">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.4">9.35.4</a=
> Function <tt>sign-extend</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sign-extend </tt><tt><i>value</i></tt><tt> </tt><tt><i>bit=
s</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</=
a></tt>
function first truncates the infinite-bit two's complement representation o=
f
the integer
<tt><i>value</i></tt>
to the specified number of bits, similarly to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
function. Then, this truncated value is regarded as a
<tt><i>bits</i></tt>
wide two's complement integer. The value of this integer is
calculated and returned.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
59">sign-extend</a> 127 8) -&gt; 127
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a=
> 128 8) -&gt; -128
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a=
> 129 8) -&gt; -127
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a=
> 255 8) -&gt; -1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a=
> 256 8) -&gt; 0
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a=
> -1  8) -&gt; -1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a=
> -255 8) -&gt; 0
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0107F533">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.5">9.35.5</a=
> Function <tt>ash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ash </tt><tt><i>value</i></tt><tt> </tt><tt><i>bits</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash</a></tt>
function shifts
<tt><i>value</i></tt>
by the specified number of
<tt><i>bits</i></tt>
producing a
new value.  If
<tt><i>bits</i></tt>
is positive, then a left shift takes place.  If
<tt><i>bits</i></tt>
is negative, then a right shift takes place. If
<tt><i>bit</i></tt>
is zero, then
<tt><i>value</i></tt>
is returned unaltered.  For positive numbers, a left shift by n bits is
equivalent to a multiplication by two to the power of n, or
<tt>(expt 2 n)</tt>.
A right shift by n bits of a positive integer is equivalent to integer
division by
<tt>(expt 2 n)</tt>,
with truncation toward zero.
For negative numbers, the bit shift is performed as if on the two's-complem=
ent
representation. Under the infinite two's-complement representation,
a right shift does not exhaust the infinite sequence of
<tt>1</tt>
digits which
extends to the left. Thus if
<tt>-4</tt>
is shifted right it becomes
<tt>-2</tt>
because
the bitwise representations of these values are
<tt>...111100</tt>
and
<tt>...11110</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0347F5A4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.6">9.35.6</a=
> Function <tt>bit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bit </tt><tt><i>value</i></tt><tt> </tt><tt><i>bit</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
function tests whether the integer or character
<tt><i>value</i></tt>
has a 1 in bit position
<tt><i>bit</i></tt>.
The
<tt><i>bit</i></tt>
argument must be a non-negative integer. A value of zero of
<tt><i>bit</i></tt>
indicates the least significant bit position of
<tt><i>value</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
function has a Boolean result, returning the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if bit
<tt><i>bit</i></tt>
of
<tt><i>value</i></tt>
is set, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>value</i></tt>
is negative, it is treated as if it had an infinite-bit two's
complement representation. For instance, if value is <tt>-2</tt>,
then the bit
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for a
<tt><i>bit</i></tt>
value of zero, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
for all other values,
since the infinite bit two's complement representation of
<tt>-2</tt>
is
<tt>...11110</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0056CEF1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.7">9.35.7</a=
> Function <tt>mask</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mask </tt><tt><i>integer</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a><=
/tt>
function takes zero or more integer arguments, and produces an integer
value which corresponds a bitmask made up of the bit positions specified by=
 the
integer values.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a><=
/tt>
is called with no arguments, then the return value is zero.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a><=
/tt>
is called with a single argument
<tt><i>integer</i></tt>
then the return value is the same as
that of the expression
<tt>(ash 1 &lt;integer&gt;)</tt>:
the value 1 shifted left by
<tt><i>integer</i></tt>
bit positions. If
<tt><i>integer</i></tt>
is zero, then the result is
<tt>1</tt>;
if
<tt><i>integer</i></tt>
is
<tt>1</tt>,
the
result is
<tt>2</tt>
and so forth.  If
<tt><i>value</i></tt>
is negative, then the result is zero.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a><=
/tt>
is called with two or more arguments, then the result is a bitwise or of
the masks individually computed for each of the values.
</p><p>
In other words, the following equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
56CEF1">mask</a>) &lt;--&gt; 0
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a> a=
) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash=
</a> 1 a)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a> a=
 b c ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
00A">logior</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CE=
F1">mask</a> a) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CE=
F1">mask</a> b) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CE=
F1">mask</a> c) ...)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0121D13B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.8">9.35.8</a=
> Function <tt>bitset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bitset </tt><tt><i>integer</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0067">bitset</a></t=
t>
function returns a list of the positions of bits which have a value of
1 in a positive
<tt><i>integer</i></tt>
argument, or the positions of bits which have a value of zero in a negative
<tt><i>integer</i></tt>
argument. The positions are ordered from least to greatest. The least
significant bit has position zero. If
<tt><i>integer</i></tt>
is zero, the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
A negative integer is treated as an infinite bit two's complement
representation.
</p><p>
The argument may be a character.
</p><p>
If
<tt><i>integer</i></tt>
<tt>x</tt>
is non-negative, the following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  x  &lt;--&gt;  [<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-026C3723">apply</a> mask (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#D-0067">bitset</a> x)]
</tt></pre><tt>

</tt>

<p>
That is to say, the value of
<tt>x</tt>
may be reconstituted by applying the bit positions returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0067">bitset</a></t=
t>
as arguments to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a><=
/tt>
function.
</p><p>
The value of a negative
<tt>x</tt>
may be reconstituted from its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0067">bitset</a></t=
t>
as follows:
</p><p>
<tt>
</tt></p><pre><tt>  x  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-038E636C">pred</a> (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#D-0009">-</a> [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
026C3723">apply</a> mask (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-0067">bitset</a> x)]))
</tt></pre><tt>

</tt>

<p>
also, more trivially, thus:
</p><p>
<tt>
</tt></p><pre><tt>  x  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#D-0009">-</a> [<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-026C3723">apply</a> mask (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-0067">bitset</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0009">-</a> x))])
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0338F21A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.9">9.35.9</a=
> Function <tt>width</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(width </tt><tt><i>integer</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



A two's complement representation of an integer consists of a sign bit and =
a
mantissa field.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0033">width</a></tt=
>
function computes the minimum number of bits required for the mantissa port=
ion
of the two's complement representation of the
<tt><i>integer</i></tt>
argument.
</p><p>
For a nonnegative argument, the width also corresponds to the number of bit=
s
required for a natural binary representation of that value.
</p><p>
Two integer values have a width of zero, namely 0 and -1. This means that t=
hese
two values can be represented in a one-bit two's complement, consisting of =
only
a sign bit: the one-bit two's complement bitfield 1 denotes -1, and 0 denot=
es
0.
</p><p>
Similarly, two integer values have a width of 1: 1 and -2. The two-bit
two's complement bitfield 01 denotes 1, and 10 denotes -2.
</p><p>
The argument may be a character.
</p><p>

</p></dd></dl>
<a name=3D"N-00A12EC7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.35.10">9.35.10<=
/a> Function <tt>logcount</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(logcount </tt><tt><i>integer</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006D">logcount</a><=
/tt>
function considers
<tt><i>integer</i></tt>
to have a two's complement representation. If the integer is positive,
it returns the count of bits in that representation whose value is 1.
If
<tt><i>integer</i></tt>
is negative, it returns the count of zero bits instead. If
<tt><i>integer</i></tt>
is zero, the value returned is zero.
</p><p>
The argument may be a character.
</p><p>
</p></dd></dl>
<a name=3D"N-014C0223">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36">9.36</a> Us=
er-Defined Arithmetic Types</h3>



<p>


</p><p>
<b>TXR Lisp</b> makes it possible for the user application program to defin=
e structure
types which can participate in arithmetic operations as if they were number=
s.
Under most arithmetic functions, a structure object may be used instead of =
a
number, if that structure object implements a specific method which is requ=
ired
by that arithmetic function.
</p><p>
The following paragraphs give general remarks about the method conventions.
Not all arithmetic and bit manipulation functions have a corresponding
method, and a small number of functions do not follow these conventions.
</p><p>
In the simplest case of arithmetic functions which are unary, the method
takes no argument other than the object itself. Most unary arithmetic funct=
ions
expect a structure argument to have a method which has the same name as tha=
t
function. For instance, if
<tt>x</tt>
is a structure, then
<tt>(cos x)</tt>
will invoke
<tt>x.(cos)</tt>.
If
<tt>x</tt>
has no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0042">cos</a></tt>
method, then an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
exception is thrown. A few unary methods are not named after the correspond=
ing function.
The unary case of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
function excepts an object to have a method named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C9F5F9">neg</a></=
tt>;
thus,
<tt>(- x)</tt>
invokes
<tt>x.(neg)</tt>.
Unary division requires a method called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B8BAB0">recip</a>=
</tt>;
thus,
<tt>(/ x)</tt>,
invokes
<tt>x.(recip)</tt>.
</p><p>
When a structure object is used as an argument in a two-argument (binary)
arithmetic function, there are several cases to consider. If the left argum=
ent
to a binary function is an object, then that object is expected to support =
a
binary method. That method is called with two arguments: the object itself,=
 of
course, and the right argument of the arithmetic operation.  In this case, =
the
method is named after the function. For instance, if
<tt>x</tt>
is an object, then
<tt>(+ x 3)</tt>
invokes
<tt>x.(+ 3)</tt>.
If the right argument, and only the right argument, of a binary operation i=
s an
object, then the situation falls into two cases depending on whether the op=
eration
is commutative. If the operation is commutative, then the same method is us=
ed
as in the case when the object is the left argument. The arguments are mere=
ly reversed.
Thus
<tt>(+ 3 x)</tt>
also invokes
<tt>x.(+ 3)</tt>.
If the operation is not commutative, then the object must supply an alterna=
tive
method. For most functions, that method is named by a symbol whose name beg=
ins
with a
<tt>r-</tt>
prefix.  For instance
<tt>(mod x 5)</tt>
invokes
<tt>x.(mod 5)</tt>
whereas
<tt>(mod 5 x)</tt>
invokes
<tt>x.(r-mod 5)</tt>.
Note: the "r" may be remembered as indicating that the object is the
<b>right</b>

argument
of the binary operation or that the arguments are
<b>reversed</b>.

Two functions do not follow the
<tt>r-</tt>
convention. These are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>.
For these, the methods used for the object as a right argument, respectivel=
y, are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0054C409">//</a></t=
t>.
Thus
<tt>(/ 5 x)</tt>
invokes
<tt>x.(// 5)</tt>
and
<tt>(- 5 x)</tt>
invokes
<tt>x.(-- 5)</tt>.
Several binary functions do not support an object as the right argument. Th=
ese are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>.
</p><p>
Variadic arithmetic functions, when given three or more arguments, are rega=
rded
as performing a left-associative decimation of the arguments through a bina=
ry
function. Thus for instance
<tt>(- 1 x 4)</tt>
is understood as
<tt>(- (- 1 x) 4)</tt>
where
<tt>x.(-- 1)</tt>
is evaluated first. If that method yields an object
<tt>o</tt>
then
<tt>o.(- 4)</tt>
is invoked.
</p><p>
Certain variadic arithmetic functions, if invoked with one argument, just
return that argument: for instance,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
are in this category. A special concession exists in these functions: if
their one and only argument is a structure, then that structure is returned
without any error checking, even if it implements no methods related
to arithmetic.
</p><p>
The following sections describe each of the methods that must be implemente=
d
by an object for the associated arithmetic function to work with that objec=
t,
either at all, or in a specific argument position, as the case may be.
These methods are not provided by <b>TXR Lisp</b>; the application is requi=
red to provide
them.
</p><p>
</p><p>
</p><p>
</p><p>
</p><p>
</p><p>
</p><p>
</p><p>
</p><p>

<a name=3D"N-021396F7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.1">9.36.=
1</a> Method <tt>+</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(+ </tt><tt><i>arg</i></tt><tt=
>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
method is invoked when a structure is used as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
function together with at least one other operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> </tt><tt><=
i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> </tt><tt><=
i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-007C">+</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01B396F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.2">9.36.2</a=
> Method <tt>-</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(- </tt><tt><i>arg</i></tt><tt=
>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> </tt><tt><=
i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0009">-</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0234C408">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.3">9.36.3</a=
> Method <tt>--</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(-- </tt><tt><i>arg</i></tt><t=
t>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> </tt><tt><=
i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0234C408">--</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02C9F5F9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.4">9.36.4</a=
> Method <tt>neg</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(neg)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C9F5F9">neg</a></=
tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> </tt><tt><=
i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-02C9F5F9">neg</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-022396F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.5">9.36.5</a=
> Method <tt>*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(* </tt><tt><i>arg</i></tt><tt=
>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
method is invoked when a structure is used as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
function together with at least one other operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> </tt><=
tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> </tt><=
tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-022396F7">*</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01D396F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.6">9.36.6</a=
> Method <tt>/</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(/ </tt><tt><i>arg</i></tt><tt=
>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a> </tt><tt><=
i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0007">/</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0054C409">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.7">9.36.7</a=
> Method <tt>//</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(// </tt><tt><i>arg</i></tt><t=
t>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0054C409">//</a></t=
t>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a> </tt><tt><=
i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0054C409">//</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01B8BAB0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.8">9.36.8</a=
> Method <tt>recip</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(recip)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B8BAB0">recip</a>=
</tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a> </tt><tt><=
i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-01B8BAB0">recip</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0309F553">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.9">9.36.9</a=
> Method <tt>abs</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(abs)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0032">abs</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0032">abs</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0032">abs</a> </tt><tt=
><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0032">abs</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03AA56EA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.10">9.36.10<=
/a> Method <tt>signum</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(signum)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001F">signum</a></t=
t>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001F">signum</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001F">signum</a> </tt>=
<tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-001F">signum</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03E8C8B8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.11">9.36.11<=
/a> Method <tt>trunc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(trunc </tt><tt><i>arg</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a> </tt><=
tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-002A">trunc</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02CD7330">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.12">9.36.12<=
/a> Method <tt>r-trunc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-trunc </tt><tt><i>arg</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CD7330">r-trunc</=
a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a> </tt><=
tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-02CD7330">r-trunc</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02E91F51">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.13">9.36.13<=
/a> Method <tt>trunc1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(trunc1)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E91F51">trunc1</a=
></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A">trunc</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-02E91F51">trunc1</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00D9F564">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.14">9.36.14<=
/a> Method <tt>mod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(mod </tt><tt><i>arg</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a> </tt><tt=
><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0076">mod</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02F8C918">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.15">9.36.15<=
/a> Method <tt>r-mod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-mod </tt><tt><i>arg</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F8C918">r-mod</a>=
</tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a> </tt><tt=
><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-02F8C918">r-mod</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0226C8EB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.16">9.36.16<=
/a> Method <tt>expt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(expt </tt><tt><i>arg</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0066">expt</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0066">expt</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0066">expt</a> </tt><t=
t><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0066">expt</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00192012">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.17">9.36.17<=
/a> Method <tt>r-expt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-expt </tt><tt><i>arg</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192012">r-expt</a=
></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0066">expt</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0066">expt</a> </tt><t=
t><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00192012">r-expt</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03462450">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.18">9.36.18<=
/a> Method <tt>exptmod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(exptmod </tt><tt><i>arg1</i><=
/tt><tt> </tt><tt><i>arg2</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0064">exptmod</a></=
tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0064">exptmod</a></=
tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with arguments
<tt><i>arg1</i></tt>
and
<tt><i>arg2</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0064">exptmod</a> </tt=
><tt><i>obj</i></tt><tt> </tt><tt><i>arg1</i></tt><tt> </tt><tt><i>arg2</i>=
</tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0064">exptmod</a> </tt><tt><i>arg1</i></tt><tt> </tt><tt><i>arg2</i>=
</tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.

</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0064">exptmod</a></=
tt>
function doesn't support structure objects in the second and
third argument positions. The
<tt><i>exponent</i></tt>
and
<tt><i>base</i></tt>
arguments must be integers.
</p><p>

</p></dd></dl>
<a name=3D"N-00F8DD02">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.19">9.36.19<=
/a> Method <tt>isqrt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(isqrt)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0068">isqrt</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0068">isqrt</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0068">isqrt</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0068">isqrt</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0129DBF6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.20">9.36.20<=
/a> Method <tt>square</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(square)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005C">square</a></t=
t>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005C">square</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005C">square</a> </tt>=
<tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-005C">square</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0136D9F9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.21">9.36.21<=
/a> Method <tt>&gt;</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(&gt; </tt><tt><i>arg</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
method is invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
function is invoked with two operands, and the structure
<tt><i>obj</i></tt>
is the left operand.
The method is also invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
function is invoked with two operands, and
<tt><i>obj</i></tt>
is the right operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(&gt; </tt><tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(&lt; </tt><tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(&gt; </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0136D95D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.22">9.36.22<=
/a> Method <tt>&lt;</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(&lt; </tt><tt><i>arg</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
method is invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
function is invoked with two operands, and the structure
<tt><i>obj</i></tt>
is the left operand.
The method is also invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
function is invoked with two operands, and
<tt><i>obj</i></tt>
is the right operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(&lt; </tt><tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(&gt; </tt><tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(&lt; </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0388136A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.23">9.36.23<=
/a> Method <tt>&gt;=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(&gt;=3D </tt><tt><i>arg</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001A">&gt;=3D</a></=
tt>
method is invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001A">&gt;=3D</a></=
tt>
function is invoked with two operands, and the structure
<tt><i>obj</i></tt>
is the left operand.
The method is also invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
function is invoked with two operands, and
<tt><i>obj</i></tt>
is the right operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(&gt;=3D </tt><tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(&lt;=3D </tt><tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(&gt;=3D </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-038809AA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.24">9.36.24<=
/a> Method <tt>&lt;=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(&lt;=3D </tt><tt><i>arg</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
method is invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003A">&lt;=3D</a></=
tt>
function is invoked with two operands, and the structure
<tt><i>obj</i></tt>
is the left operand.
The method is also invoked when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001A">&gt;=3D</a></=
tt>
function is invoked with two operands, and
<tt><i>obj</i></tt>
is the right operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(&lt;=3D </tt><tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(&gt;=3D </tt><tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(&lt;=3D </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02B396F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.25">9.36.25<=
/a> Method <tt>=3D</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(=3D </tt><tt><i>arg</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
method is invoked when a structure is used as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a> </tt><tt=
><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a> </tt><tt=
><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-006A">=3D</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03B8A374">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.26">9.36.26<=
/a> Method <tt>zerop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(zerop)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0074">zerop</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0074">zerop</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03B8D135">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.27">9.36.27<=
/a> Method <tt>plusp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(plusp)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0048">plusp</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0048">plusp</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0048">plusp</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0048">plusp</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02DDD586">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.28">9.36.28<=
/a> Method <tt>minusp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(minusp)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0010">minusp</a></t=
t>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0010">minusp</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0010">minusp</a> </tt>=
<tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0010">minusp</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00B90BF9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.29">9.36.29<=
/a> Method <tt>evenp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(evenp)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0036">evenp</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0036">evenp</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01E6D33E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.30">9.36.30<=
/a> Method <tt>oddp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(oddp)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-006B">oddp</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03D908C0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.31">9.36.31<=
/a> Method <tt>floor</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(floor </tt><tt><i>arg</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a> </tt><=
tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-004C">floor</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00BBC669">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.32">9.36.32<=
/a> Method <tt>r-floor</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-floor </tt><tt><i>arg</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BBC669">r-floor</=
a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a> </tt><=
tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00BBC669">r-floor</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01ED20D1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.33">9.36.33<=
/a> Method <tt>floor1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(floor1)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01ED20D1">floor1</a=
></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004C">floor</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-01ED20D1">floor1</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01A6CAA5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.34">9.36.34<=
/a> Method <tt>ceil</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(ceil </tt><tt><i>arg</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a> </tt><t=
t><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0071">ceil</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0399208F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.35">9.36.35<=
/a> Method <tt>r-ceil</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-ceil </tt><tt><i>arg</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0399208F">r-ceil</a=
></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a> </tt><t=
t><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-0399208F">r-ceil</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02C8FF28">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.36">9.36.36<=
/a> Method <tt>ceil1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(ceil1)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C8FF28">ceil1</a>=
</tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0071">ceil</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-02C8FF28">ceil1</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03F8B9F8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.37">9.36.37<=
/a> Method <tt>round</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(round </tt><tt><i>arg</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a> </tt><=
tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0002">round</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-031D7670">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.38">9.36.38<=
/a> Method <tt>r-round</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-round </tt><tt><i>arg</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D7670">r-round</=
a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a> </tt><=
tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-031D7670">r-round</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03EA1351">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.39">9.36.39<=
/a> Method <tt>round1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(round1)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EA1351">round1</a=
></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0002">round</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-03EA1351">round1</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0239F62C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.40">9.36.40<=
/a> Method <tt>sin</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(sin)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0018">sin</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0018">sin</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0018">sin</a> </tt><tt=
><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0018">sin</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0209F56C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.41">9.36.41<=
/a> Method <tt>cos</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(cos)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0042">cos</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0042">cos</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0042">cos</a> </tt><tt=
><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0042">cos</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0239F61E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.42">9.36.42<=
/a> Method <tt>tan</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(tan)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0070">tan</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0070">tan</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0070">tan</a> </tt><tt=
><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0070">tan</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0186CA8D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.43">9.36.43<=
/a> Method <tt>asin</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(asin)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0072">asin</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0072">asin</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0072">asin</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0072">asin</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00B6C9CC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.44">9.36.44<=
/a> Method <tt>acos</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(acos)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004B">acos</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004B">acos</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004B">acos</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-004B">acos</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0186CA7F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.45">9.36.45<=
/a> Method <tt>atan</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(atan)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0011">atan</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0011">atan</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0011">atan</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0011">atan</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00D8FB88">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.46">9.36.46<=
/a> Method <tt>atan2</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(atan2 </tt><tt><i>arg</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0015">atan2</a></tt=
>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0015">atan2</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0015">atan2</a> </tt><=
tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0015">atan2</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-03BBA063">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.47">9.36.47<=
/a> Method <tt>r-atan2</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-atan2 </tt><tt><i>arg</i></=
tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBA063">r-atan2</=
a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0015">atan2</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0015">atan2</a> </tt><=
tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-03BBA063">r-atan2</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0266D697">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.48">9.36.48<=
/a> Method <tt>sinh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(sinh)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0045">sinh</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0045">sinh</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0045">sinh</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0045">sinh</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0366CA96">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.49">9.36.49<=
/a> Method <tt>cosh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(cosh)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007E">cosh</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007E">cosh</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007E">cosh</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-007E">cosh</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0266D577">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.50">9.36.50<=
/a> Method <tt>tanh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(tanh)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0038">tanh</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0038">tanh</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0038">tanh</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0038">tanh</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0338FCA8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.51">9.36.51<=
/a> Method <tt>asinh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(asinh)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0005">asinh</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0005">asinh</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0005">asinh</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0005">asinh</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0239109D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.52">9.36.52<=
/a> Method <tt>acosh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(acosh)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0078">acosh</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0078">acosh</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0078">acosh</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0078">acosh</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0338FB88">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.53">9.36.53<=
/a> Method <tt>atanh</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(atanh)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0044">atanh</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0044">atanh</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0044">atanh</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0044">atanh</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00C9F560">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.54">9.36.54<=
/a> Method <tt>log</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(log)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007F">log</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007F">log</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007F">log</a> </tt><tt=
><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-007F">log</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00C6CADD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.55">9.36.55<=
/a> Method <tt>log2</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(log2)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0063">log2</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0063">log2</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0063">log2</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0063">log2</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01B901AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.56">9.36.56<=
/a> Method <tt>log10</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(log10)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0014">log10</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0014">log10</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0014">log10</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0014">log10</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0119F541">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.57">9.36.57<=
/a> Method <tt>exp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(exp)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0060">exp</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0060">exp</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0060">exp</a> </tt><tt=
><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0060">exp</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-0026D70F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.58">9.36.58<=
/a> Method <tt>sqrt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(sqrt)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004A">sqrt</a></tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004A">sqrt</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004A">sqrt</a> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-004A">sqrt</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-011D877D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.59">9.36.59<=
/a> Method <tt>logand</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(logand </tt><tt><i>arg</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a></t=
t>
method is invoked when a structure is used as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a></t=
t>
function together with at least one other operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a> </tt>=
<tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a> </tt>=
<tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-001C">logand</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02BD8EDD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.60">9.36.60<=
/a> Method <tt>logior</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(logior </tt><tt><i>arg</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
method is invoked when a structure is used as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function together with at least one other operand.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
either as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a> </tt>=
<tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

or as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a> </tt>=
<tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-000A">logior</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-031D8ED1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.61">9.36.61<=
/a> Method <tt>lognot</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(lognot </tt><tt><i>arg</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a> </tt>=
<tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0024">lognot</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00495055">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.62">9.36.62<=
/a> Method <tt>r-lognot</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-lognot </tt><tt><i>arg</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00495055">r-lognot<=
/a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a> </tt>=
<tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00495055">r-lognot</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-019541E2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.63">9.36.63<=
/a> Method <tt>lognot1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(lognot1)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019541E2">lognot1</=
a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the sole argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a> </tt>=
<tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-019541E2">lognot1</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-000B2006">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.64">9.36.64<=
/a> Method <tt>logtrunc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(logtrunc </tt><tt><i>arg</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a> </t=
t><tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0065">logtrunc</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-02439AC4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.65">9.36.65<=
/a> Method <tt>r-logtrunc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(r-logtrunc </tt><tt><i>arg</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02439AC4">r-logtrun=
c</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the right argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a><=
/tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0065">logtrunc</a> </t=
t><tt><i>arg</i></tt><tt> </tt><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-02439AC4">r-logtrunc</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-01EFD64C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.66">9.36.66<=
/a> Method <tt>sign-extend</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(sign-extend </tt><tt><i>arg</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</=
a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</=
a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</a> =
</tt><tt><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0059">sign-extend</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.

</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0059">sign-extend</=
a></tt>
function doesn't support a structure as the right argument,
<tt><i>bits</i></tt>,
which must be an integer.
</p><p>

</p></dd></dl>
<a name=3D"N-0099F56F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.67">9.36.67<=
/a> Method <tt>ash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(ash </tt><tt><i>arg</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash</a> </tt><tt=
><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-003D">ash</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.

</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003D">ash</a></tt>
function doesn't support a structure as the right argument,
<tt><i>bits</i></tt>,
which must be an integer.
</p><p>

</p></dd></dl>
<a name=3D"N-03D9F568">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.68">9.36.68<=
/a> Method <tt>bit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(bit </tt><tt><i>arg</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
method is invoked when the structure
<tt><i>obj</i></tt>
is used as the left argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is combined with an argument
<tt><i>arg</i></tt>,
as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a> </tt><tt=
><i>obj</i></tt><tt> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-000C">bit</a> </tt><tt><i>arg</i></tt><tt>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.

</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
function doesn't support a structure as the right argument,
<tt><i>bit</i></tt>,
which must be an integer.
</p><p>

</p></dd></dl>
<a name=3D"N-0138CDB7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.69">9.36.69<=
/a> Method <tt>width</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(width)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0033">width</a></tt=
>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0033">width</a></tt=
>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0033">width</a> </tt><=
tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0033">width</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-00E186C6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.70">9.36.70<=
/a> Method <tt>logcount</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(logcount)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006D">logcount</a><=
/tt>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006D">logcount</a><=
/tt>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006D">logcount</a> </t=
t><tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-006D">logcount</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.


</p></dd></dl>
<a name=3D"N-011DFB63">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.36.71">9.36.71<=
/a> Method <tt>bitset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>obj</i></tt><tt>.(bitset)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0067">bitset</a></t=
t>
method is invoked when a structure is used as the argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0067">bitset</a></t=
t>
function.
</p><p>
If an object
<tt><i>obj</i></tt>
is passed to the function as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0067">bitset</a> </tt>=
<tt><i>obj</i></tt><tt>)=20

</tt>

then, effectively, the method call
<tt>




</tt><tt><i>obj</i></tt><tt>.(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#D-0067">bitset</a>)=20

</tt>

takes place, and its return value is taken as the result
of the operation.

</p><p>
</p></dd></dl>
<a name=3D"N-0146B946">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37">9.37</a> Ex=
ception Handling</h3>



<p>


</p><p>
An
<i>exception</i>

in <b>TXR</b> is a special event in the execution of the program which
potentially results in a transfer of control. An exception is identified by=
 a
symbol, known as the
<i>exception type</i>,

and it carries zero or more arguments, called the
<i>exception arguments</i>.

</p><p>
When an exception is initiated, it is said to be
<i>thrown</i>.

This action is initiated by the following functions:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>,
and possibly other functions which invoke these.
When an exception is thrown, <b>TXR</b> enters into exception processing
mode. Exception processing mode terminates in one of several ways:
</p><dl class=3D"items">
<dt>-</dt><dd>
A
<i>catch</i>

is found which matches the exception, and control is transferred
to the catch by a non-local transfer which performs unwinding. Catches are
defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
macro.
</dd><dt>-</dt><dd>
A
<i>handler</i>

is found which matches the exception, and control is transferred to
the handler by invoking its function. The handler function accepts the
exception by performing a non-local transfer to a destination of its choice=
, or
else declines to accept the exception by returning.
Handlers are defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
operator or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
macro.
</dd><dt>-</dt><dd>
If no catch or accepting handler is found for an exception derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B4A4FB">*unhandle=
d-hook*</a></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then a built-in strategy for handling the exception is invoked,
consisting of unwinding, and then printing some informational messages and
terminating.
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B4A4FB">*unhandle=
d-hook*</a></tt>
variable contains a value that isn't
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then control is transferred to the function stored in the
that variable first; only if that function returns is the above
built-in strategy invoked.
</dd><dt>-</dt><dd>
If no catch or accepting handler is found for an exception derived from
<tt>warning</tt>,
then a warning diagnostic is issued on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream and a
<tt>continue</tt>
exception is thrown with no arguments. If no catch or handler is found
for that exception, then control returns normally to the site which
threw the warning exception.
</dd><dt>-</dt><dd>
If no catch or accepting handler is found for an exception that is
neither derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
nor from
<tt>warning</tt>,
then no control transfer takes place; control returns to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
function which returns normally, with a return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</dd></dl>
<p>

</p><p>
<a name=3D"N-0128B9FE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.1">9.37.=
1</a> Catches and Handlers</h4>


<p>
There are two ways by which exceptions are handled: catches and handlers.
Catches and handlers are similar, but different.
A catch is an exit point associated with an active scope. When an exception=
 is
handled by a catch, the form which threw the exception is abandoned, and un=
winding
takes place to the catch site, which receives the exception type and argume=
nts.
A handler is also associated with an active scope. However, it is a functio=
n,
and not a dynamic exit point.  When an exception is passed to handler,
unwinding does not take place; rather, the function is called. The function=
 then
either completes the exception handling by performing a non-local transfer,
or else declines the exception by performing an ordinary return.
</p><p>
Catches and handlers are identified by exception type symbols. A catch or
handler is eligible to process an exception if it handles a type which is
a supertype of the exception which is being processed. Handles and catches
are found by means of a combined search which proceeds from the innermost
nesting of dynamic scope to the outermost, without performing any unwinding=
.
When an eligible handler is encountered, its registered function is called,=
 thereby suspending the
search.  If the handler function returns, the search continues from that sc=
ope
to yet unvisited outer scopes. When an eligible catch is encountered rather
than a handler, the search terminates and a control transfer takes place to=
 the
catch site. That control transfer then performs unwinding, which requires i=
t to
make a second pass through the same nestings of dynamic scope that had just
been traversed in order to find that catch.
</p><p>
<a name=3D"N-00D2CFDD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.2">9.37.=
2</a> Handlers and Sandboxing</h4>


<p>
Because handlers execute in the dynamic context of the exception origin,
without any unwinding having taken place, they expose a potential route
of sandbox escape via the package system, unless special steps are taken.
The threat is that code at the handler site could take advantage of
the current value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>
variables established at the exception throw site to gain inappropriate acc=
ess
to symbols.
</p><p>
For this reason, when a handler is established, the current values of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>
are recorded into the handler frame.
When that handler is later invoked, it executes in a dynamic environment
in which those variables are bound to the previously noted values.
</p><p>
The catch mechanism doesn't do any such thing because the unwinding
which is performed prior to the invocation of a catch implicitly
restores the values of
<b>all</b>

special variables to the values they had at the time the frame was
established.
</p><p>
<a name=3D"N-01E13B7A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.3">9.37.=
3</a> Exception Type Hierarchy</h4>


<p>
Exception type symbols are arranged
in an inheritance hierarchy, at whose top the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is is the supertype of every exception type, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
symbol is at the bottom, the subtype of every exception type.
</p><p>
Keyword symbols may be used as exception types.
</p><p>
Every symbol is its own supertype and subtype. Thus whenever X is known to =
be a
subtype of Y, it is possible that X is exactly Y.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
macro registers exception supertype/subtype relationships among symbols.
</p><p>
The following tree diagram shows the relationships among <b>TXR Lisp</b>'s =
built-in
exception symbols. Not shown is the exception symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
subtype of every exception type:
</p><p>
<tt>
</tt></p><pre><tt>  t ----+--- warning
        |
        +--- restart ---+--- continue
        |               |
        |               +--- retry
        |               |
        |               +--- skip
        |
        +--- error ---+--- type-error
                      |
                      +--- internal-error
                      |
                      +--- panic
                      |
                      +--- numeric-error
                      |
                      +--- range-error
                      |
                      +--- query-error
                      |
                      +--- file-error -------+--- path-not-found
                      |                      |
                      |                      +--- path-exists
                      |                      |
                      |                      +--- path-permission
                      |
                      +--- process-error
                      |
                      +--- socket-error
                      |
                      +--- system-error
                      |
                      +--- alloc-error
                      |
                      +--- timeout-error
                      |
                      +--- assert
                      |
                      +--- syntax-error
                      |
                      +--- eval-error
</tt></pre><tt>

</tt>

<p>
Program designers are encouraged to derive new error exceptions from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
type. The
<tt>restart</tt>
type is intended to be the root of a hierarchy of exception
types used for denoting restart points: designers are encouraged
to derive restarts from this type.
A catch for the
<tt>continue</tt>
exception should be established around constructs which can throw an
error from which it is possible to recover. That exception provides
the entry point into the recovery which resumes execution.
A catch for
<tt>retry</tt>
should be provided in situations when it is possible and makes sense for a =
failed
operation to be tried again.
A catch for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
should be provided in situations when it is possible and sensible to contin=
ue
with subsequent operations even though an operation has failed.
</p><p>
<a name=3D"N-00F77525">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.4">9.37.=
4</a> Dialect Notes</h4>


<p>
Exception handling in <b>TXR Lisp</b> provides capabilities similar to the =
condition
system in ANSI Common Lisp. The implementation and terminology differ.
</p><p>
Most obviously, ANSI CL uses the "condition" term, whereas <b>TXR Lisp</b> =
uses "exception".
</p><p>
In ANSI CL, a condition is "raised", whereas a <b>TXR Lisp</b> exception is=
 "thrown".
</p><p>
In ANSI CL, when a condition is raised, a condition object is created. Cond=
ition
object are similar to class objects, but are not required to be in the Comm=
on Lisp
Object System. They are related by inheritance and can have properties. <b>=
TXR Lisp</b>exceptions are unencapsulated: they consist of a symbol, plus z=
ero or more
arguments. The symbols are related by inheritance.
</p><p>
When a condition is raised in ANSI CL, the dynamic scope is searched for a
handler, which is an ordinary function which receives the condition. No
unwinding or non-local transfer takes place.  The handler can return, in wh=
ich
case the search continues. Matching the condition to the handler is by
inheritance. Handler functions are bound to exception type names.
If a handler chooses to actually handle a condition (thereby terminating
the search) it must itself perform some kind of dynamic control transfer,
rather than return normally. ANSI CL provides a dynamic control mechanism
known as restarts which is usually used for this purpose. A condition handl=
er
may invoke a particular restart handler. Restart handlers are similar to
exception handlers: they are functions associated with symbols in the
dynamic environment.
</p><p>
In <b>TXR Lisp</b>, the special behavior which occurs for exceptions derive=
d from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
and those from
<tt>warning</tt>
is built into the exception handling system, and tied to those types.
When an error or warning exception is unhandled, the exception handling sys=
tem
itself reacts, so the special behaviors occur no matter how these exception=
s
are raised.  In ANSI CL, the special behavior for unhandled
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
conditions (of invoking the debugger) is implemented only in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
function;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
conditions signalled other than via that function are not subject to
any special behavior. There is a parallel situation with regard to
warnings: the
ANSI CL
<tt>warn</tt>
function implements a special behavior for unhandled warnings (of emitting
a diagnostic) but warnings not signalled via that function are not
treated that way.
Thus in <b>TXR Lisp</b>, there is no way to raise an error or warning that =
is simply
ignored due to being unhandled.
</p><p>
In <b>TXR Lisp</b> exceptions are a unification of conditions and restarts.=
 From an ANSI CL
perspective, <b>TXR Lisp</b> exceptions are a lot like CL restarts, except =
that the
symbols are arranged in an inheritance hierarchy. <b>TXR Lisp</b> exception=
s are used
both as the equivalent of ANSI CL conditions and as restarts.
</p><p>
In <b>TXR Lisp</b> the terminology "catch" and "handle" is used in a specif=
ic way.
To handle an exception means to receive it without unwinding, with the poss=
ibility
of declining to handle it, so that the search continues for another handler=
.
To catch an exception means to match an exception to a catch handler, termi=
nate
the search, unwind and pass control to the handler.
</p><p>
<b>TXR Lisp</b> provides an operator called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
for specifying handlers. It has a different syntax from ANSI CL's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>.
<b>TXR Lisp</b> provides a macro called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
which simplifies the use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>.
This macro superficially resembles ANSI CL's
<tt>handler-case</tt>,
but is semantically different. The most notable difference is that the bodi=
es
of handlers established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
execute without any unwinding taking place and may return normally, thereby
declining to take the exception. In other words,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
has the same semantics as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>,
providing only convenient syntax.
</p><p>
<b>TXR Lisp</b> provides a macro called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
which has the same syntax as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
but specifies a catch point for exceptions. If, during an exception search,=
 a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clause matches an exception, a dynamic control transfer takes place
from the throw site to the catch site. Then the clause body is executed.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
macro resembles ANSI CL's
<tt>restart-case</tt>
or possibly
<tt>handler-case</tt>,
depending on point of view.
</p><p>
<b>TXR Lisp</b> provides unified introspection over handler and catch frame=
s.
A program can programmatically discover what handler and catches are
available in a given dynamic scope. ANSI CL provides introspection
over restarts only; the standard doesn't specify any mechanism for
inquiring what condition handlers are bound at a given point in
the execution.
</p><p>
</p><dl>
<dt>Example:</dt><dd>
<p>


</p><p>
The following two examples express a similar approach  implemented
using ANSI Common Lisp conditions and restarts, and then using <b>TXR Lisp<=
/b>exceptions.
</p><p>
<tt>
</tt></p><pre><tt>  ;; Common Lisp
  (define-condition foo-error (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-015466AD">error</a>)
    ((arg :initarg :arg :reader foo-error-arg)))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
raise-foo-error (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133A=
A5">arg</a>)
    (restart-case
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a=
> ((c (make-condition 'foo-error :arg arg)))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">erro=
r</a> c))
      (recover (recover-arg)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">form=
at</a> t "recover, arg: ~s~%" recover-arg))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-bi=
nd</a> ((foo-error
                   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004=
F">lambda</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E24=
">cond</a>)
                     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
11ACA52">format</a> t "handling foo-error, arg: ~s~%"
                             (foo-error-arg cond))
                     (invoke-restart 'recover 100))))
    (raise-foo-error 200))
</tt></pre><tt>

</tt>

<p>
The output of the above is:
</p><p>
<tt>
</tt></p><pre><tt>  handling foo-error, arg: 200
  recover, arg: 100
</tt></pre><tt>

</tt>

<p>
The following is possible <b>TXR Lisp</b> equivalent for the above Common L=
isp example.
It produces identical output.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2B">defex</a> foo-error error)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a> reco=
ver restart) ;; recommended practice

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
raise-foo-error (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133A=
A5">arg</a>)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a>
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a> =
'foo-error arg)
      (recover (recover-arg)
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">form=
at</a> t "recover, arg: ~s\n" recover-arg))))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a>
    (raise-foo-error 200)
    (foo-error (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133AA=
5">arg</a>)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format=
</a> t "handling foo-error, arg: ~s\n" arg)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a> =
'recover 100)))
</tt></pre><tt>

</tt>

<p>
To summarize the differences: exceptions serve as both
conditions and restarts in <b>TXR</b>. The same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
function is used to initiate exception handling for
<tt>foo-error</tt>
and then to transfer control out of the handler
to the recovery code. The handler accepts one exception
by raising another.
</p><p>
When an exception symbol is used for restarting, it is
a recommended practice to insert it into the inheritance
hierarchy rooted at the
<tt>restart</tt>
symbol, either by inheriting directly from
<tt>restart</tt>
or from an exception subtype of that symbol.
</p><p>

</p></dd></dl>
<a name=3D"N-015466AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.5">9.37.5</a=
> Functions <tt>throw</tt>, <tt>throwf</tt> and <tt>error</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(throw </tt><tt><i>symbol</i></tt><tt> </tt><tt><i>arg</i><=
/tt><tt>*)=20




<br>&nbsp;&nbsp;(throwf </tt><tt><i>symbol</i></tt><tt> </tt><tt><i>format-=
string</i></tt><tt> </tt><tt><i>format-arg</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(error </tt><tt><i>format-string</i></tt><tt> </tt><tt><i>f=
ormat-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions generate an exception. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
functions generate
an exception identified by
<tt><i>symbol</i></tt>,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
throws an exception of
type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>.
The call
<tt>(error ...)</tt>
can be regarded as a shorthand for
<tt>(throwf 'error ...)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
function takes zero or more additional arguments. These arguments
become the arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
handler which takes the exception. The
handler will have to be capable of accepting that number of arguments.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
functions generate an exception which has a single
argument: a character string created by a formatted print to a string strea=
m
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
string and additional arguments.
</p><p>
Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
throws an error exception, it does not return. If an error exception
is not handled, <b>TXR</b> will issue diagnostic messages and terminate.
Likewise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
are used to generate an error exception, they do not return.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
functions are used to generate an exception not derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>,
and no handler is found which accepts the exception, they return normally, =
with
a value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0211F3D3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.6">9.37.6</a=
> Macros <tt>catch</tt>, <tt>catch*</tt> and <tt>catch**</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(catch </tt><tt><i>try-expression</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {(</tt><tt><i>symbol</i></tt><tt> (</tt><tt><i=
>arg</i></tt><tt>*) </tt><tt><i>body-form</i></tt><tt>*)}*)=20




<br>&nbsp;&nbsp;(catch* </tt><tt><i>try-expression</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {(</tt><tt><i>symbol</i></tt><tt> (</tt><tt><i=
>type-arg</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*) </tt><tt><i>body-form=
</i></tt><tt>*)}*)=20




<br>&nbsp;&nbsp;(catch** </tt><tt><i>try-expression</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {(</tt><tt><i>symbol</i></tt><tt> </tt><tt><i>=
desc</i></tt><tt> (</tt><tt><i>type-arg</i></tt><tt> </tt><tt><i>arg</i></t=
t><tt>*) </tt><tt><i>body-form</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
macro establishes an exception catching block around
the
<tt><i>try-expression</i></tt>.
The
<tt><i>try-expression</i></tt>
is followed by zero or more
catch clauses. Each catch clause consists of a symbol which denotes
an exception type, an argument list, and zero or more body forms.
</p><p>
If
<tt><i>try-expression</i></tt>
terminates normally, then the catch clauses
are ignored. The catch itself terminates, and its return value is
that of the
<tt><i>try-expression</i></tt>.
</p><p>
If
<tt><i>try-expression</i></tt>
throws an exception which is a subtype of one or more of
the type symbols given in the exception clauses, then the first (leftmost) =
such
clause becomes the exit point where the exception is handled.
The exception is converted into arguments for the clause, and the clause
body is executed. When the clause body terminates, the catch terminates,
and the return value of the catch is that of the clause body.
</p><p>
If
<tt><i>try-expression</i></tt>
throws an exception which is not a subtype of any of
the symbols given in the clauses, then the search for an exit point for
the exception continues through the enclosing forms. The catch clauses
are not involved in the handling of that exception.
</p><p>
When a clause catches an exception, the number of arguments in the catch mu=
st
match the number of elements in the exception.  A catch argument list
resembles a function or lambda argument list, and may be dotted.  For insta=
nce
the clause
<tt>(foo (a . b))</tt>
catches an exception subtyped from
<tt>foo</tt>,
with one or
more elements. The first element binds to parameter
<tt>a</tt>,
and the rest, if any,
bind to parameter
<tt>b</tt>.
If there is only one element,
<tt>b</tt>
takes on the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211F3D3">catch*</a=
></tt>
macro is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
with the following difference: when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211F3D3">catch*</a=
></tt>
invokes a clause, it passes the exception symbol as the leftmost argument
<tt><i>type-arg</i></tt>.
Then the exception arguments follow. In contrast,
only the exception arguments are passed to the clauses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211F3D3">catch**</=
a></tt>
macro is a further variant, which differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211F3D3">catch*</a=
></tt>
by requiring each catch clause to provide a description
<tt><i>desc</i></tt>,
an expression which evaluates to a character string.
The
<tt><i>desc</i></tt>
expressions are evaluated in left-to-right order prior to the
evaluation of
<tt><i>try-expression</i></tt>.
</p><p>
Also see: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-pr=
otect</a></tt>
operator, and the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>,
as well as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
operator and
<tt>handler</tt>
macro.
</p><p>

</p></dd></dl>
<a name=3D"N-03162B0C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.7">9.37.7</a=
> Operator <tt>unwind-protect</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(unwind-protect </tt><tt><i>protected-form</i></tt><tt> </t=
t><tt><i>cleanup-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-pr=
otect</a></tt>
operator evaluates
<tt><i>protected-form</i></tt>
in such a way that no matter how the execution of
<tt><i>protected-form</i></tt>
terminates, the
<tt><i>cleanup-form</i></tt>-s
will be executed.
</p><p>
The
<tt><i>cleanup-form</i></tt>-s,
however, are not protected. If a
<tt><i>cleanup-form</i></tt>
terminates via
some non-local jump, the subsequent
<tt><i>cleanup-form</i></tt>-s
are not evaluated.
</p><p>
<tt><i>cleanup-form</i></tt>-s
themselves can "hijack" a non-local control transfer such
as an exception. If a
<tt><i>cleanup-form</i></tt>
is evaluated during the processing of
a dynamic control transfer such as an exception, and that
<tt><i>cleanup-form</i></tt>
initiates its own dynamic control transfer, the original control transfer
is aborted and replaced with the new one.
</p><p>
The exit points for dynamic control transfers are removed as unwinding take=
s
place. That is to say, at the start of a dynamic control transfer, a search
takes place for the target exit point. That search might skip other exit po=
ints
which aren't targets of the control transfer. Those skipped exit points are=
 left
undisturbed and are still visible during unwinding until their individual
binding forms are abandoned. Thus at the time of execution of an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-pr=
otect</a></tt>
<tt><i>cleanup-form</i></tt>,
all of the exit points of dynamically surrounding forms are still visible, =
even
ones which are nearer than the targeted exit point.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
5A">block</a> foo
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-p=
rotect</a>
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-f=
rom</a> foo 42)
             (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52"=
>format</a> t "not reached!\n"))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format=
</a> t "cleanup!\n")))
</tt></pre><tt>

</tt>

<p>
In this example, the protected
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
form terminates by returning from
block
<tt>foo</tt>.
Therefore the form does not complete and so the
output
<tt>"not reached!"</tt>

is not produced. However, the cleanup form
executes, producing the output
<tt>"cleanup!"</tt>.
</p><p>
</p><p>

</p></dd></dl>
<a name=3D"N-007287AC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.8">9.37.8</a=
> Macro <tt>ignerr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ignerr </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007287AC">ignerr</a=
></tt>
macro operator evaluates each
<tt><i>form</i></tt>
similarly to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
operator. If no forms are present, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise it evaluates each
<tt><i>form</i></tt>
in turn, yielding the value of the last one.
</p><p>
If the evaluation of any
<tt><i>form</i></tt>
is abandoned due to an exception of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>,
the code generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007287AC">ignerr</a=
></tt>
macro catches this exception. In this situation,
the execution of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007287AC">ignerr</a=
></tt>
form terminates without evaluating the remaining
forms, and yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02552A58">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.9">9.37.9</a=
> Macro <tt>ignwarn</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ignwarn </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02552A58">ignwarn</=
a></tt>
macro resembles
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007287AC">ignerr</a=
></tt>.
It arranges for the evaluation of each
<tt><i>form</i></tt>
in left-to-right order. If all the forms are evaluated, then the
value of the last one is returned. If no forms are present, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If any
<tt><i>form</i></tt>
throws an exception of type
<tt>warning</tt>
then this exception is intercepted by a handler established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02552A58">ignwarn</=
a></tt>.
This handler reacts by throwing an exception of type
<tt>continue</tt>.
</p><p>
The effect is that the warning is ignored, since the handler
doesn't issue any diagnostic, and passes control to the warning's
continue point.
</p><p>
Note: all sites within <b>TXR</b> which throw a
<tt>warning</tt>
also provide a nearby catch for a
<tt>continue</tt>
exception, for resuming evaluation at the point where the warning
was issued.
</p><p>

</p></dd></dl>
<a name=3D"N-00A4ECC9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.10">9.37.10<=
/a> Operator <tt>handler-bind</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(handler-bind </tt><tt><i>function-form</i></tt><tt> </tt><=
tt><i>symbol-list</i></tt><tt> </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
operator establishes a handler for one or more
exception types, and evaluates zero or more
<tt><i>body-form</i></tt>-s
in a dynamic scope in which that handler is visible.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
form terminates normally, the handler is removed. The value of the
last
<tt><i>body-form</i></tt>
is returned, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no forms.
</p><p>
The
<tt><i>function-form</i></tt>
argument is an expression which must evaluate to a function. The function
must be capable of accepting the exception arguments. All exceptions functi=
ons
require at least one argument, since the leftmost argument in an exception =
handler
call is the exception type symbol.
</p><p>
The
<tt><i>symbol-list</i></tt>
argument is a list of symbols, not evaluated. If it is empty, then the hand=
ler
isn't eligible for any exceptions. Otherwise it is eligible for any excepti=
on
whose exception type is a subtype of any of the symbols.
</p><p>
If the evaluation of any
<tt><i>body-form</i></tt>
throws an exception which is not handled within that form, and the handler
is eligible for that exception, then the function is invoked. It receives
the exception's type symbol as the leftmost argument. If the exception has
arguments, they appear as additional arguments in the function call.
If the function returns normally, then the exception search continues.
The handler remains established until the exception is handled in such a wa=
y
that a dynamic control transfer abandons the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
form.
</p><p>
Note: while a handler's function is executing, the handler is disabled.
If the function throws an exception for which the handler is eligible,
the handler will not receive that exception; it will be skipped by the
exception search as if it didn't exist.  When the handler function terminat=
es,
either via a normal return or a nonlocal control transfer, then the handler=
 is
re-enabled.
</p><p>

</p></dd></dl>
<a name=3D"N-03F7D8B5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.11">9.37.11<=
/a> Macros <tt>handle</tt> and <tt>handle*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(handle </tt><tt><i>try-expression</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {(</tt><tt><i>symbol</i></tt><tt> (</tt><tt><i=
>arg</i></tt><tt>*) </tt><tt><i>body-form</i></tt><tt>*)}*)=20




<br>&nbsp;&nbsp;(handle* </tt><tt><i>try-expression</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {(</tt><tt><i>symbol</i></tt><tt> (</tt><tt><i=
>type-arg</i></tt><tt> </tt><tt><i>arg</i></tt><tt>*) </tt><tt><i>body-form=
</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
macro is a syntactic sugar for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
operator. Its syntax is exactly like that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>.
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
is that the clauses in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
are invoked without unwinding. That is to say,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
does not establish an exit point for an exception. When control passes to
a clause, it is by means of an ordinary function call and not a dynamic
control transfer. No evaluation frames are yet unwound when this takes plac=
e.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
macro establishes a handler, by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
whose
<tt><i>symbol-list</i></tt>
consists of every
<tt><i>symbol</i></tt>
gathered from every clause.
</p><p>
The handler function established in the generated
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
is synthesized from of all of the clauses, together with dispatch logic whi=
ch
which passes the exception and its arguments to the first
eligible clause.
</p><p>
The
<tt><i>try-expression</i></tt>
is evaluated in the context of this handler.
</p><p>
The clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
syntax can return normally, like a function, in which case the handler
is understood to have declined the exception, and exception processing
continues. To handle an exception, the clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
macro must perform a dynamic control transfer, such returning from a block
via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
or throwing an exception.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle*</=
a></tt>
macro is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
with the following difference: when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle*</=
a></tt>
invokes a clause, it passes the exception symbol as the leftmost argument
<tt><i>type-arg</i></tt>.
Then the exception arguments follow. In contrast,
only the exception arguments are passed to the clauses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-012CE06E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.12">9.37.12<=
/a> Macro <tt>with-resources</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-resources ({</tt><tt><i>sym</i></tt><tt> [</tt><tt><i=
>init-form</i></tt><tt> [</tt><tt><i>cleanup-form</i></tt><tt>*])}*)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-reso=
urces</a></tt>
macro provides a sequential binding construct similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>.
Every
<tt><i>sym</i></tt>
is established as a variable which is visible to the
<tt><i>init-form</i></tt>-s
of subsequent variables, to all subsequent
<tt><i>cleanup-form</i></tt>-s
including that of the same variable,
and to the
<tt><i>body-form</i></tt>-s.
</p><p>
If no
<tt><i>init-form</i></tt>
is supplied, then
<tt><i>sym</i></tt>
is bound to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If an
<tt><i>init-form</i></tt>
is supplied, but no
<tt><i>cleanup-form</i></tt>-s,
then
<tt><i>sym</i></tt>
is bound to the value of the
<tt><i>init-form</i></tt>.
</p><p>
If one or more
<tt><i>cleanup-form</i></tt>-s
are supplied in addition to
<tt><i>init-form</i></tt>,
they specifies forms to be executed upon the termination of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-reso=
urces</a></tt>
construct.
</p><p>
When an instance of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-reso=
urces</a></tt>
terminates, either normally or by a non-local control transfer,
then for each
<tt><i>sym</i></tt>
whose
<tt><i>init-form</i></tt>
had executed, thus causing that
<tt>sym</tt>
to be bound to a value, the
<tt><i>cleanup-form</i></tt>-s
corresponding to
<tt><i>sym</i></tt>
are evaluated in the usual left-to-right order.
</p><p>
The
<tt><i>sym</i></tt>-s
are cleaned up in reverse (right-to-left) order. The
<tt><i>cleanup-form</i></tt>-s
of the most recently bound
<tt><i>sym</i></tt>
are processed first; those of the least recently bound
<tt><i>sym</i></tt>
are processed last.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-reso=
urces</a></tt>
form terminates normally, the value of the last
<tt><i>body-form</i></tt>
is returned, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if no
<tt><i>body-form</i></tt>-s
are present.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following expression opens a text file and reads a line from it,
returning that line, while ensuring that the stream is closed
immediately:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
2CE06E">with-resources</a> ((f (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-02B8FBBD">open-file</a> "/etc/motd") (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#N-00596930">close-stream</a> f)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0154DC75">whilet</=
a> ((l (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line<=
/a> f)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-li=
ne</a> l)))
</tt></pre><tt>

</tt>

<p>
</p><p>
</p><p>

</p></dd></dl>
<a name=3D"N-02B4A4FB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.13">9.37.13<=
/a> Special variable <tt>*unhandled-hook*</tt></h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B4A4FB">*unhandle=
d-hook*</a></tt>
variable is initialized with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
by default.
<p>
It may instead be assigned a function which is capable of taking
three arguments.
</p><p>
When an exception occurs which has no handler, this function is called,
with the following arguments: the exception type symbol, the exception obje=
ct,
and a third value which is either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or else the form which was being evaluated when the exception was thrown.
The call occurs before any unwinding takes place.
</p><p>
If the variable is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
or isn't a function, or the function returns after being called,
then unwinding takes place, after which some informational messages are pri=
nted
about the exception, and the process exits with a failed termination status=
.
</p><p>
In the case when the variable contains a object other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
which isn't a function, a diagnostic message is printed on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream prior to unwinding.
</p><p>
Prior to the function being called, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B4A4FB">*unhandle=
d-hook*</a></tt>
variable is reset to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0370CD69">source-lo=
c</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0370CD69">source-lo=
c-str</a></tt>
may be applied to the third argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B4A4FB">*unhandle=
d-hook*</a></tt>
function to obtain more information about the form.
</p><p>

<a name=3D"N-00ECE51D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.14">9.37=
.14</a> Macro <tt>defex</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defex {</tt><tt><i>symbol</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
records hierarchical relationships among symbols, for the purposes
of the use of those symbols as exceptions. It is closely related to the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a>)<=
/tt>
directive in the <b>TXR</b> pattern language, performing the same function.
</p><p>
All symbols are considered to be exception subtypes, and every symbol
is implicitly its own exception subtype. This macro does not introduce
symbols as exception types; it only introduces subtype-supertype
relationships.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
is invoked with no arguments, it has no effect.
</p><p>
If arguments are present, they must be symbols.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
is invoked with only one symbol as its argument, it has no effect.
</p><p>
At least two
symbols must be specified for a useful effect to take place.  If exactly tw=
o
symbols are specified, then, subject to error checks,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
makes the left symbol an
<i>exception subtype</i>

of the right symbol.
</p><p>
This behavior generalizes to three or more arguments: if three or more symb=
ols
are specified, then each symbol other than the last is registered as a subt=
ype of
the symbol which follows.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
has three or more arguments, they are processed from left to right.
If errors are encountered during the processing, the correct registrations
already made for prior arguments remain in place.
</p><p>
Every symbol is implicitly considered to be its own exception subtype,
therefore it is erroneous to explicitly register a symbol as its
own subtype.
</p><p>
The symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is implicitly a subtype of every exception type. Therefore, it is erroneous
to attempt to specify it as a supertype in a registration.
Using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
as a subtype in a registration is silently permitted, but has no effect.
No explicit registration is recorded between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and its successor in the argument list.
</p><p>
The symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is implicitly the supertype of every exception type. Therefore, it
is erroneous to attempt to register it as an exception subtype.
Using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
as a supertype in a registration is also erroneous.
</p><p>
A symbol
<tt>a</tt>
may not be registered as a subtype of a symbol
<tt>b</tt>
if the reverse relationship already exists between those two symbols.
</p><p>
The foregoing rules allow redefinitions to take place, while forbidding cyc=
les
from being created in the exception subtype inheritance graph.
</p><p>
Keyword symbols may be used as exception types.
</p><p>

</p></dd></dl>
<a name=3D"N-005EB97F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.15">9.37.15<=
/a> Function <tt>register-exception-subtypes</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(register-exception-subtypes {</tt><tt><i>symbol</i></tt><t=
t>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005EB97F">register-=
exception-subtypes</a></tt>
function constitutes the underlying implementation for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
macro.
</p><p>
The following equivalence applies:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
2B">defex</a> a b ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-005EB97F">register-exception-subtypes</a> 'a 'b ...)
</tt></pre><tt>

</tt>

<p>
That is, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002B">defex</a></tt=
>
macro works as if by generating a call to the function, with
the arguments quoted.
</p><p>
The semantics of the function is precisely that of the macro.
</p><p>

</p></dd></dl>
<a name=3D"N-02E7F869">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.16">9.37.16<=
/a> Function <tt>exception-subtype-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exception-subtype-p </tt><tt><i>left-symbol</i></tt><tt> <=
/tt><tt><i>right-symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7F869">exception=
-subtype-p</a></tt>
function tests whether two symbols are in a relationship as exception types=
,
such that
<tt><i>left-symbol</i></tt>
is a direct or indirect exception subtype of
<tt><i>right-symbol</i></tt>.
</p><p>
If that is the case, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03ABFA6D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.17">9.37.17<=
/a> Function <tt>exception-subtype-map</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exception-subtype-map)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03ABFA6D">exception=
-subtype-map</a></tt>
function returns a tree structure which captures information
about all registered exception types.
</p><p>
The map appears as an association list which contains an entry
for every exception symbol, paired with that type's supertype path.
The first element in the supertype path is the exception's immediate
supertype. The next element is that type's supertype and so on. The
last element in every path is the grand supertype
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
For instance, if only the types
<tt>a</tt>,
<tt>b</tt>
and
<tt>c</tt>
existed in the system, and were linked according to this inheritance graph:
</p><p>
<tt>
</tt></p><pre><tt>  t ----+--- b --- a
        |
        +--- c
</tt></pre><tt>

</tt>

<p>
such that the supertype of
<tt>b</tt>
and
<tt>c</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
and
<tt>a</tt>
has
<tt>b</tt>
as supertype, then the function might return:
</p><p>
<tt>
</tt></p><pre><tt>  ((a b t) (b t) (c t) (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-015134D8">t</a>))
</tt></pre><tt>

</tt>

<p>
or any other equivalent permutation.
</p><p>
The returned list may share substructure, so that the
<tt>(t)</tt>
sublist is shared among all four entries, and
<tt>(b t)</tt>
between the first two.
</p><p>
If the program alters the tree structure returned by
<tt>exception-map-p</tt>,
the consequences are unspecified; this structure may be the actual object w=
hich
represents the type hierarchy.
</p><p>

</p></dd></dl>
<a name=3D"N-0233BAE3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.18">9.37.18<=
/a> Structures <tt>frame</tt>, <tt>catch-frame</tt> and <tt>handle-frame</t=
t></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct frame nil)=20




<br>&nbsp;&nbsp;(defstruct catch-frame frame types desc jump)=20




<br>&nbsp;&nbsp;(defstruct handle-frame frame types fun)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The structure types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">frame</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>
are used by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010405DA">get-frame=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
e</a></tt>
functions to represent information about the currently established
exception catches (see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
macro) and handlers
(see
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>
and
<tt>handler</tt>).
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">frame</a>=
</tt>
type serves as the common base for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>.
</p><p>
Modifying any of the slots of these structures has no effect on the
actual frame from which they are derived; the frame structures are only
representation which provides information about frames. They are not
the actual frames themselves.
</p><p>
Both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>
have a
<tt>types</tt>
slot. This holds the list of exception type symbols which are matched
by the catch or handler.
</p><p>
The
<tt>desc</tt>
slot of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
holds a list of the descriptions produced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211F3D3">catch**</=
a></tt>
macro. If there are no descriptions, then this member is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
otherwise it is a list whose elements are in correspondence
with the list in the
<tt>types</tt>
slot.
</p><p>
The
<tt>jump</tt>
slot of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
is an opaque
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
("C pointer")
object which is related to the stack address of the catch
frame. If it is altered, the catch frame object becomes invalid
for the purposes of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
slot of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>
is the registered handler function. Note that all the clauses of a
<tt>handler</tt>
macro are compiled to a single function, which is established via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A4ECC9">handler-b=
ind</a></tt>,
so an instance of the
<tt>handler</tt>
macro corresponds to a single
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-010405DA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.19">9.37.19<=
/a> Function <tt>get-frames</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-frames)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010405DA">get-frame=
s</a></tt>
function inquires the current dynamic environment in order to retrieve
information about established exception catch and handler frames.
The function returns a list, ordered from the innermost nesting
level to the outermost nesting, of structure objects derived from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">frame</a>=
</tt>
structure type. The list contains two kinds of objects: structures
of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
and of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>.
</p><p>
These objects are not the frames themselves, but only provide information
about frames. Modifying the slots in these structures has no effect on
the original frames. Also, these structures have their own lifetime and
can endure after the original frames have disappeared. This has implication=
s
for the use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>
structures have a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>
slot, which holds a function. It may be invoked directly.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
structure may be passed as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-02B97226">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.20">9.37.20<=
/a> Functions <tt>find-frame</tt> and <tt>find-frames</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(find-frame [</tt><tt><i>exception-symbol</i></tt><tt> [</t=
t><tt><i>frame-type</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(find-frames [</tt><tt><i>exception-symbol</i></tt><tt> [</=
tt><tt><i>frame-type</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
e</a></tt>
function locates the first (innermost) instance of a specific kind of
exception frame (a catch frame or a handler frame) which is eligible
for processing an exception of a specific type. If such a frame
is found, it is returned.  The returned frame object is of the same kind as=
 the
objects which comprise the list returned by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010405DA">get-frame=
s</a></tt>.
If such a frame is not found,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><i>exception-symbol</i></tt>
argument specifies a match by exception type: the candidate frame
must specify in its list of matches at least one type which is an exception
supertype of
<tt><i>exception-symbol</i></tt>.
If this argument is omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
which finds any handler that matches at least one type. There is no way to
search for handlers which match an empty set of types; the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
e</a></tt>
function skips such frames.
</p><p>
The
<tt><i>frame-type</i></tt>
argument specifies which frame type to find. Useful values for this
argument are the structure type names
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">handle-fr=
ame</a></tt>
or the actual structure type objects which these type names denote.
If any other value is specified, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If the argument is omitted, it defaults to the type of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
structure. That is to say, by default, the function looks for catch
frames.
</p><p>
Thus, if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
e</a></tt>
is called with no arguments at all it finds the innermost catch frame,
if any exists, or else returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
es</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
e</a></tt>
except that it returns all matching frames, ordered from the innermost nest=
ing
level to the outermost nesting. If called with no arguments, it returns a
list of the catch frames.
</p><p>

</p></dd></dl>
<a name=3D"N-0337FC1B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.21">9.37.21<=
/a> Function <tt>invoke-catch</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(invoke-catch </tt><tt><i>catch-frame</i></tt><tt> </tt><tt=
><i>symbol</i></tt><tt> </tt><tt><i>argument</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>
function abandons the current evaluation context to perform
a non-local control transfer directly to the catch
described by the
<tt><i>catch-frame</i></tt>
argument, which must be a structure of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
obtained using any of the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010405DA">get-frame=
s</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
es</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B97226">find-fram=
e</a></tt>.
</p><p>
The control transfer is possible only if the catch
frame represented by
<tt><i>catch-frame</i></tt>
structure is still established, and if the structure
hasn't been tampered with.
</p><p>
If a given
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0233BAE3">catch-fra=
me</a></tt>
structure is usable with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>,
then a copy of that structure made with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032B3FDC">copy-stru=
ct</a></tt>
is also usable, denoting the same catch frame.
</p><p>
The
<tt><i>symbol</i></tt>
argument should be an exception symbol. It is passed to the
exception frame, as if it had appeared as the first argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
function. Similarly, the
<tt><i>argument</i></tt>-s
are passed to the catch frame as if they were the trailing arguments
of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>.
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0337FC1B">invoke-ca=
tch</a></tt>
targets a specific catch frame as its exit point, rather than searching for=
 a
matching catch or handler frame. That specific frame receives the control.
The frame receives control even if it it is not otherwise eligible for
catching the exception type denoted by
<tt><i>symbol</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-005A3A6C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.37.22">9.37.22<=
/a> Macro <tt>assert</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(assert </tt><tt><i>expr</i></tt><tt> [</tt><tt><i>format-s=
tring</i></tt><tt> </tt><tt><i>format-arg</i></tt><tt>*])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
macro evaluates
<tt><i>expr</i></tt>.
If
<tt><i>expr</i></tt>
yields any true value, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
terminates normally, and that value is returned.
</p><p>
If instead
<tt><i>expr</i></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
throws an exception of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>.
The exception carries an informative character string that contains
a diagnostic detailing the expression which yielded
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and the source location of that expression, if available.
</p><p>
If the
<tt><i>format-string</i></tt>
and possibly additional format arguments are given to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002E">assert</a></t=
t>
then those arguments are used to format additional text which is appended t=
o
the diagnostic message after a separating character such as a colon.
</p><p>
</p></dd></dl>
<a name=3D"N-03351EE7">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38">9.38</a> St=
atic Error Diagnosis</h3>



<p>


</p><p>
This section describes a number of features related to the diagnosis
of errors during the static processing of program code prior to evaluation.
The material is of interest to developers of macros intended for broad
reuse.
</p><p>
<a name=3D"N-000C4E3D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.1">9.38.=
1</a> Error Exceptions</h4>


<p>
<b>TXR Lisp</b> uses exceptions of type
<tt>eval-error</tt>
to identify erroneous situations during both transformation of code
and its evaluation. These exceptions have one argument, which is a
character string. If not handled by program code,
<tt>eval-error</tt>
exceptions are specially recognized and treated by the built-in handling lo=
gic.
The message is incorporated into diagnostic output which includes
more information which is deduced.
</p><p>
<a name=3D"N-03C48985">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.2">9.38.=
2</a> Warning Exceptions</h4>


<p>
<b>TXR Lisp</b> uses exceptions of type
<tt>warning</tt>
to identify certain situations of interest. Ordinary non-deferrable
warnings have a structure identical to errors, except for the exception
symbol. <b>TXR</b>'s provides built-in "auto continue" handling for warning=
s. If a warning
exception is not intercepted by a catch or an accepting handler, then a
diagnostic is issued on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream, after which a
<tt>continue</tt>
exception is thrown with no arguments. If that
<tt>continue</tt>
exception is not handled, then control returns normally to the point that
exception to resume the computation which generated the warning.
</p><p>
Callers which invoke code that may generate warning exceptions are therefor=
e
not required to handle them. However, callers which do handle warning
exceptions expect to be able to throw a
<tt>continue</tt>
exception in order to resume the computation that triggered the warning,
without allowing other handlers to see the exception.
</p><p>
The generation of a warning should thus conform to the following pattern:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
23">catch</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a> 'w=
arning "message")
    (continue ()))
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-02BB661C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.3">9.38.=
3</a> Deferrable Warnings</h4>


<p>
<b>TXR</b> supports a form of diagnostic known as a
<i>deferrable warning</i>.

A deferrable warning is distinguished in two ways. Firstly, it is
either of the type
<tt>defr-warning</tt>
or subtyped from that type. The
<tt>defr-warning</tt>
type itself is a direct subtype of
<tt>warning</tt>.
</p><p>
Secondly, a deferrable warning carries an additional tag argument after the
exception message. A deferrable exception is thrown according to
this pattern:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
23">catch</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a> 'd=
efr-warning "message" . tag)
    (continue ()))
</tt></pre><tt>

</tt>

<p>
<b>TXR</b>'s built-in exception handling logic reacts specially to the
presence of the tag material in the exception. First, the global
<i>tentative definition list</i>

is searched for the presence of the tag, using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
equality. If the tag is found, then the warning is discarded.
If the tag is not found, then the exception argument list is added
to the global
<i>deferred warning list</i>.

In either case,
the
<tt>continue</tt>
exception is thrown to resume the computation which threw the warning,
as in the case of an ordinary non-deferrable warning.
</p><p>
The purpose of this mechanism is to suppress warnings which
become superfluous when more of the program code is examined.
For instance, a warning about a call to an undefined function is
superfluous if a definition of that function is supplied later,
yet before that function call is executed.
</p><p>
Deferred warnings accumulate in the deferred warning list
from which they can be removed. The list is purged at various
times such as when a top-level load completes, and the
deferred warnings are released, as if by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012F0BE9">release-d=
eferred-warnings</a></tt>
function.
</p><p>

<a name=3D"N-032EA7D7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.4">9.38.=
4</a> Functions <tt>compile-error</tt> and <tt>compile-warning</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compile-error </tt><tt><i>context-obj</i></tt><tt> </tt><t=
t><i>fmt-string</i></tt><tt> </tt><tt><i>fmt-arg</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(compile-warning </tt><tt><i>context-obj</i></tt><tt> </tt>=
<tt><i>fmt-string</i></tt><tt> </tt><tt><i>fmt-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-e=
rror</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-w=
arning</a></tt>
provide a convenient and uniform way for code transforming
functions such as macro-expanders to generate diagnostics.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-e=
rror</a></tt>
function throws an exception of type
<tt>eval-error</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-w=
arning</a></tt>
function throws an exception of type
<tt>warning</tt>
and internally provides a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
for the
<tt>continue</tt>
exception which allow a warning handler to resume execution
after the warning. If a handler throws a
<tt>continue</tt>
exception which is caught by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-w=
arning</a></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-w=
arning</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032EA7D7">compile-w=
arning</a></tt>
throws a non-error exception, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in the event that no catch is found for the exception, and no handler which
accepts it.
</p><p>
The argument conventions are the same for both functions.
The
<tt><i>context-obj</i></tt>
is typically a compound form to which the diagnostic
applies.
</p><p>
The functions produce a diagnostic message which
incorporates the location information and symbol
obtained from
<tt><i>context-obj</i></tt>
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>-style
arguments
<tt><i>fmt-string</i></tt>
and its
<tt><i>fmt-arg</i></tt>-s.
</p><p>

</p></dd></dl>
<a name=3D"N-0205E7AF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.5">9.38.5</a=
> Function <tt>compile-defr-warning</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compile-defr-warning </tt><tt><i>context-obj</i></tt><tt> =
</tt><tt><i>tag</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>fmt-string</i></tt><tt> </tt><tt><=
i>fmt-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0205E7AF">compile-d=
efr-warning</a></tt>
function throws an exception of type
<tt>defr-warning</tt>
and internally provides a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
for the
<tt>continue</tt>
exception needed to resume after the warning.
</p><p>
The function produces a diagnostic message which
incorporates the location information and symbol
obtained from
<tt><i>context-obj</i></tt>
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>-style
arguments
<tt><i>fmt-string</i></tt>
and its
<tt><i>fmt-arg</i></tt>-s.
This diagnostic message constitutes the first
argument of the exception. The
<tt><i>tag</i></tt>
argument is taken as the second argument.
</p><p>
If the exception isn't intercepted by a catch or by
an accepting handler,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0205E7AF">compile-d=
efr-warning</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
In also returns nil if it catches a
<tt>continue</tt>
exception.
</p><p>

</p></dd></dl>
<a name=3D"N-0077C4FE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.6">9.38.6</a=
> Function <tt>purge-deferred-warning</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(purge-deferred-warning </tt><tt><i>tag</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0077C4FE">purge-def=
erred-warning</a></tt>
removes all warnings marked with
<tt><i>tag</i></tt>
from the deferred list. It also removes all tags
matching
<tt><i>tag</i></tt>
from the tentative definition list.
Tags are compared using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-033CBAA9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.7">9.38.7</a=
> Function <tt>register-tentative-def</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(register-tentative-def </tt><tt><i>tag</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033CBAA9">register-=
tentative-def</a></tt>
function adds
<tt><i>tag</i></tt>
to the list of tentative definitions which are
used to suppress deferrable warnings.
</p><p>
The idea is that a definition of some construct has been seen,
but not yet executed. Thus the construct is not defined, but
it can reasonably be expected that it will be defined;
hence, warnings about its nonexistence can be suppressed.
</p><p>
For example, in the following code, when the expression
<tt>(foo)</tt>
is being expanded and transformed, the
<tt>foo</tt>
function does not exist:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F7A8B8">progn</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B4=
4934">defun</a> foo ()) (foo))
</tt></pre><tt>

</tt>

<p>
The function won't be defined until the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
is evaluated. Thus a warning is generated that
<tt>(foo)</tt>
refers to an undefined function.
However, this warning is discarded, because the
expander for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
registers a tentative definition tag for
<tt>foo</tt>.
</p><p>
When the definition of
<tt>foo</tt>
takes place, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
operator will call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0077C4FE">purge-def=
erred-warning</a></tt>
which will remove not only all accumulated warnings
related to the undefinedness of
<tt>foo</tt>
but also remove the tentative definition.
</p><p>
Note: this mechanism isn't perfect because it will
still suppresses the warning in situations like
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F7A8B8">progn</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039=
">if</a> nil (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934"=
>defun</a> foo ())) (foo))
</tt></pre><tt>

</tt>

<p>
</p><p>

</p></dd></dl>
<a name=3D"N-0186D1B7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.8">9.38.8</a=
> Function <tt>tentative-def-exists</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tentative-def-exists </tt><tt><i>tag</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0186D1B7">tentative=
-def-exists</a></tt>
function checks whether
<tt><i>tag</i></tt>
has been registered via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033CBAA9">register-=
tentative-def</a></tt>
and not yet purged by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0077C4FE">purge-def=
erred-warning</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001106AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.9">9.38.9</a=
> Function <tt>defer-warning</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defer-warning </tt><tt><i>args</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001106AB">defer-war=
ning</a></tt>
function attempts to register a deferred warning. The
<tt><i>args</i></tt>
argument corresponds to the arguments which are passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
function in order to generate a warning exception, not including the except=
ion
symbol.
</p><p>
Args is expected to have at least two elements, the second of which
is a deferred warning tag.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001106AB">defer-war=
ning</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: this function is intended for use in exception handlers. The
following example shows a handler which intercepts warnings. It defers
deferrable warnings, and prints ordinary warnings:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F7D8B5">handle</a>
    (some-form ..) ;; some code which might generate warnings
    (defr-warning (msg tag) ;; catch deferrable and defer
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001106AB">defer-=
warning</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">=
cons</a> msg tag))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a> =
'continue)) ;; warning processed: resume execution
    (warning (msg)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-li=
ne</a> `warning: @msg`) ;; print non-deferrable
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a> =
'continue))) ;; warning processed: resume execution
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-012F0BE9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.10">9.38.10<=
/a> Function <tt>release-deferred-warnings</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(release-deferred-warnings)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012F0BE9">release-d=
eferred-warnings</a></tt>
removes all warnings from the deferred list.
Then, it issues each deferred warning as an ordinary warning.
</p><p>
Note: there is normally no need for user programs to use this
function since deferred warnings are issued automatically.
</p><p>

</p></dd></dl>
<a name=3D"N-0335651E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.38.11">9.38.11<=
/a> Function <tt>dump-deferred-warnings</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dump-deferred-warnings </tt><tt><i>stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0335651E">dump-defe=
rred-warnings</a></tt>
empties the list of deferred warnings, and converts each one
into a diagnostic message sent to
sent to
<tt><i>stream</i></tt>.
After the diagnostics are printed, the list of pending warnings
is cleared.
</p><p>
Note: there is normally no need for user programs to use this
function since deferred warnings are issued automatically.
</p><p>
</p></dd></dl>
<a name=3D"N-01C4E6B4">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39">9.39</a> De=
limited Continuations</h3>



<p>


</p><p>
<b>TXR Lisp</b> supports delimited continuations, which are integrated with=
 the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
feature. Any named or anonymous block, including the implicit blocks
created around function bodies, can be used as the delimiting
<i>prompt</i>

for the capture of a continuation.
</p><p>
A delimited continuation is section of a possible future of the
computation, up to a delimiting prompt,
<i>reified</i>

as a first class function.
</p><p>
</p><dl>
<dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> receive (cont)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "cont returned ~a\n" (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-0386C775">call</a> cont 3)))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
function ()
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:capt=
ure-cont</a> 'abcd (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006=
E109C">fun</a> receive)))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> abcd
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</=
a> t "function returned ~a\n" (function))
    4)

  Output:

  function returned 3
  cont returned 4
  function returned t
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<p>

</p><p>
Evaluation begins with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
form. This form calls
<tt>function</tt>
which uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
to capture a continuation up to the
<tt>abcd</tt>
prompt.  The continuation is passed to the
<tt>receive</tt>
function as an argument.
</p><p>
This captured object represents the continuation of computation
up to that prompt.  It appears as a one-argument function which, when calle=
d,
resumes the captured computation. Its argument emerges out of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
call as a return value. When the computation eventually returns all
the way to the delimiting prompt, the return value of that prompt
will then appear as the return value of the continuation function.
</p><p>
In this example, the function
<tt>receive</tt>
immediately invokes the continuation function which it receives, passing
it the argument value
<tt>3</tt>.
And so,
evaluation now continues in the resumed future represented by the
continuation. Inside the continuation,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
appears to return, yielding the value
<tt>3</tt>.
This bubbles up through
<tt>function</tt>
up to the
<tt>block abcd</tt>
where a message is printed:
<tt>"function returned 3"</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
terminates, yielding the value 4. Thereby, the continuation ends, since
it is delimited up to that block.  Control now returns to the
<tt>receive</tt>
function which invoked the continuation, where the function call form
<tt>(call cont)</tt>
terminates, yielding the value
<tt>4</tt>
that was returned by the continuation's delimiting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
form. The message
<tt>"cont returned 4"</tt>

is printed. The
<tt>receive</tt>
function returns normally, returning the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
which emerged from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
call. Control is now back in
<tt>function</tt>
where the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
form terminates and returns the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
This bubbles up to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
which prints
<tt>"function returned t"</tt>.
</p><p>
In summary, a continuation represents, as a function, the subsequent
computation that is to take place starting at some point, up to some
recently established, dynamically enclosing delimiting prompt. When
the continuation is captured, that future doesn't have to take place;
an alternative future can carry out in which that continuation is
available as a function. That alternative future can invoke the continuatio=
n at
will.  Invocations (resumptions) of the continuation appear as additional
returns from the capture operator. A resumption of a continuation terminate=
s
when the delimiting prompt terminates, and the continuation yields the
value which emerges from the prompt.
</p><p>
Delimited continuations are implemented by capturing a segment of the
evaluation stack between the prompt and the capture point. When
a continuation is resumed, this saved copy of a stack segment is inserted o=
n
top of the current stack and the procedure context is resumed such
that evaluation appears to emerge from the capture operator.
As the continuation runs to completion, it simply pops these inserted
stack frames naturally. Eventually it pops out of the delimiting prompt,
at which point control ends up at the point which invoked the continuation
function.
</p><p>
The low-level operator for capturing a continuation is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>.
More expressive and convenient programming with continuations is
provided by the macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C791D0">obtain-bl=
ock</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E">yield</a>=
</tt>,
which create an abstraction which models the continuation as a suspended
procedure supporting two-way communication of data.
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7852D">suspend</=
a></tt>
operator is provided, which is more general. It is identical to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AC8471">shift</a>=
</tt>
operator described in various computer science literature about
delimited continuations, except that it refers to a specific delimiting
prompt by name.
</p><p>
Continuations raise the issue of what to do about unwinding.
The language Scheme provides the much criticized
<tt>dynamic-wind</tt>
operator which can execute initialization and clean-up code as
a continuation is entered and abandoned. <b>TXR</b> takes a simpler,
albeit risky approach. It provides a non-unwinding escape operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E20FE2">sys:absco=
nd-from</a></tt>
for use with continuations. Code which has captured a continuation
can use this operator to escape from the delimiting block without
triggering any unwinding among the frames between the capture point and the
delimiter. When the continuation is restarted, it will then do so
with all of the resources associated with it frames intact.
When the continuation executes normal returns within its context,
the unwinding takes place then.  Thus tidy, "thread-like" use
of continuations is possible with a small measure of coding discipline.
Unfortunately, the absconding operator is dangerous: its use
breaks the language guarantee that clean-up associated with a form is done =
no
matter how a form terminates.
</p><p>
<a name=3D"N-03404858">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.1">9.39.=
1</a> Comparison with Lexical Closures</h4>


<p>
Delimited continuations resemble lexical closures in some ways. Both
constructs provide a way to return to some context whose evaluation
has already been abandoned, and to access some aspects of that context.
However, lexical closures are statically scoped. Closures capture the lexic=
ally
apparent scope at a given point, and produce a function whose body has acce=
ss
to that scope, as well as to some arbitrary arguments. Thus, a lexical scop=
e
is reified as a first-class function. By contrast, a delimited continuation
is dynamic. It captures an an entire segment of a program activation chain,
up to the delimiting prompt. This segment includes scopes which are not
lexically visible at the capture point: the scopes of parent functions.
Moreover, the segment includes not only scopes, but also other aspects of
the evaluation context, such as the possibility of returning to callers,
and the (captured portion of) the original dynamic environment, such asexce=
ption handlers.  That is to say, a lexical closure's body cannot return to
the surrounding code or see any of its original dynamic environment; it can
only inspect the environment, and then return to its own caller.  Whereas a
restarted delimited continuation can continue evaluation of the surrounding
code, return to surrounding forms and parent functions, and access the dyna=
mic
environment. The continuation function returns to its caller when that enti=
re
restarted context terminates, whereas a closure returns to its caller as so=
on
as the closure body terminates.
</p><p>
<a name=3D"N-02608659">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.2">9.39.=
2</a> Differences in Compiled vs. Interpreted Behavior</h4>


<p>
Delimited continuations in <b>TXR</b> expose a behavioral difference betwee=
n
compiled and interpreted code which mutates the values of lexical variables=
.
</p><p>
When a continuation is captured in compiled code, it captures not only the
bindings of lexical variables, but also potentially their current values
at the time of capture. What this means is that whenever the continuation
is resumed, those variables will appear to have the captured values,
regardless of any mutations that have taken place since. In other words,
the captured future includes those specific values.  This is because in
compiled code, variables are allocated on the stack, which is copied as par=
t of
creating a continuation. Those variables are effectively newly instantiated=
 in
each resumption of the continuation, when the captured stack segment
is reinstated into the stack, and take on those original values.
</p><p>
In contrast, interpretation of code only maintains an
environment pointer on the stack; the lexical environment is a dynamically
allocated object whose contents aren't included in the continuation's
stack segment capture. If the captured variables are modified after the
capture, the continuation will see the updated values: all resumptions of t=
he
continuation share the same instance of the captured environment among
themselves, and with the original context where the capture took place.
</p><p>
An additional complication is that when compiled code captures lexical
closures, captured variables are moved into dynamic storage and then
they become shared: the semantics of the mutation of those variables
is then similar to the situation in interpreted code. Therefore, the
above described non-sharing capture behavior of compiled code is not requir=
ed
to hold.
</p><p>
In continuation-based code which relies on mutation of lexical variables
created with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
the macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01348099">hlet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01348099">hlet*</a>=
</tt>
can be used instead. These macros create variable bindings whose storage is
always outside of the stack, and therefore the variables will exhibit
consistent
</p><p>
If the affected variables are other kinds of bindings such as
function parameters or variables created with specialized binding
constructs such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013E33A2">with-stre=
am</a></tt>,
additional coding changes may be required to get interpreted code
working under compilation.
</p><p>

<a name=3D"N-02199305">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.3">9.39.=
3</a> Function <tt>sys:capture-cont</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sys:capture-cont </tt><tt><i>name</i></tt><tt> </tt><tt><i=
>receive-fun</i></tt><tt> [</tt><tt><i>context-form</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
function captures a continuation, and also serves as the resume point
for the resulting continuation. Which of these two situations is the
case (capture or resumption) is distinguished by the use of the
<tt><i>receive-fun</i></tt>
argument, which must be a function capable of being called with one
argument.
</p><p>
A block named
<tt><i>name</i></tt>
must be visible; the continuation is delimited by the closest
enclosing block of this name.
</p><p>
The optional
<tt><i>context-form</i></tt>
argument should be a compound form. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
reports an error, it reports it against this form,
and uses the form's operator symbol as the name of the function which
encountered the error.  If the argument is omitted,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
uses its own name.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
function captures a continuation, represented as a function.
It immediately calls
<tt><i>receive-fun</i></tt>,
passing it it the continuation function as an argument.
If
<tt><i>receive-fun</i></tt>
returns normally, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
returns whatever value
<tt><i>receive-fun</i></tt>
returns.
</p><p>
Resuming a continuation is done by invoking the continuation function.
When this happens, the entire continuation context is restored by re-creati=
ng
its captured evaluation frames on top of the current stack. Inside the
continuation, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
function call which captured the continuation now appears to return,
and yields a value. That value is precisely the value which was just
passed to the continuation function moments ago.
</p><p>
The resumed continuation can terminate in one of three ways. Firstly, it ca=
n
simply keep executing until it discards all of its evaluation frames below =
the
delimiting block, and then allows that block to terminate naturally by
evaluating the last form contained in the block.  Secondly, can use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
against its delimiting block to explicitly abandon all evaluations in betwe=
en
and terminate that block. Or it may perform
a non-local control transfer past the delimited block somewhere into the
evaluation frames of the caller. In the first two cases, the termination
of the block turns into an ordinary return from the continuation function, =
and
the result value of the terminated block becomes the return value of that
function call.  In the last case, the call of the continuation function is
abandoned and unwinding continues through the caller.
</p><p>
If the symbol
<tt>sys:cont-poison</tt>
is passed to the continuation function, the continuation will be
resumed in a different manner: its context will be restored as in the
ordinary resume case, whereupon it will be immediately abandoned by
a nonlocal exit, causing unwinding to take place across all of the
continuation's evaluation frames. The function then returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If the symbol
<tt>sys:cont-free</tt>
is passed to the continuation function, the continuation isn't
be resumed at all; rather, the buffer which holds the saved context
of the continuation is released. Thereafter, an attempt to resume
the continuation results in an error exception being thrown.
After releasing the buffer, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
The continuation function may be used any time after it is produced, and ma=
y be
called more than once, regardless of whether the originally captured dynami=
c
context is still executing. The continuation object may be communicated int=
o
the resumed continuation, which can then use it to call itself, resulting
in multiple nested resumptions of the same continuation. A delimited
continuation is effectively a first class function.
</p><p>
The underlying continuation object produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
stores a copy of the captured dynamic context.  Whenever the continuation
function is invoked, a copy of the captured is reinstated as if it were a n=
ew
context.  Thus each apparent return from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:captu=
re-cont</a></tt>
inside a resumed continuation is not actually made in the original context,=
 but
in a copy of that context. That context can be resumed multiple times
sequentially or recursively.
</p><p>
Just like lexical closures, continuations do not copy lexical environments;
they capture lexical environments by reference. If a continuation modifies
the values of captured lexical variables, those modifications are visible t=
o
other resumptions of the same continuation, to other continuations which
capture the same environment, to lexical closures which capture the same
environment and to the original context which created that environment, if =
it
is still active.
</p><p>
Unlike lexical closures, continuations do capture the local bindings
of special variables. That is to say, if
<tt>*var*</tt>
is a special variable, then a lexical closure created inside a
<tt>(let ((*var* 42)) ...)</tt>
form will not capture the local re-binding of
<tt>*var*</tt>
which holds 42.  When the closure is invoked and accesses
<tt>*var*</tt>,
it accesses whatever value of
<tt>*var*</tt>
is dynamically current, as dictated by the environment which calls the
closure, rather than the capturing environment.
</p><p>
With continuations, the behavior is different. If a continuation
is captured inside a
<tt>(let ((*var* 42)) ...)</tt>
form then it does capture the local binding. This is regardless whether
the delimited prompt of the capture is enclosed in this form, or
outside of the form.
The special variable has a binding in a dynamic environment. There is alway=
s a
reference to a current dynamic environment associated with every evaluation
context, and a continuation captures that reference.  Because it is a
reference, it means that the binding is shared. That is to say, all
invocations of all continuations which capture the same dynamic environment=
 in
which that
<tt>(let ((*var* 42)) ...)</tt>
binding was made share the same binding; if
<tt>*var*</tt>
is modified by assignment, the modification is visible to all those views.
</p><p>
Inside a resumed continuation, a form which binds a special variable such a=
s
<tt>(let ((*var* 42)) ...)</tt>
may terminate. As expected, this causes the binding to be removed,
revealing either another local binding of
<tt>*var*</tt>
or the global binding. However, this unbinding only affects only that
that executing continuation; it has no effect inside other instances of the
same continuation or other continuations which capture the same variable.
Unbinding isn't a mutation of the dynamic environment, but may be understoo=
d
as merely the restoration of an earlier dynamic environment reference.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
The following example shows an implementation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7852D">suspend</=
a></tt>
operator.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> suspend (:form form name var . body)
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02199305">sys:cap=
ture-cont</a> ',name (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
04F">lambda</a> (,var)
                                (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-02E20FE2">sys:abscond-from</a> ,name ,*body))
                       ',form))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02E20FE2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.4">9.39.4</a=
> Operator <tt>sys:abscond-from</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sys:abscond-from </tt><tt><i>name</i></tt><tt> [</tt><tt><=
i>value</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E20FE2">sys:absco=
nd-from</a></tt>
operator closely resembles
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
and performs the same function: it causes an enclosing block
<tt><i>name</i></tt>
to terminate with
<tt><i>value</i></tt>
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
However, unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E20FE2">sys:absco=
nd-from</a></tt>
does not perform any unwinding.
</p><p>
This operator should never be used for any purpose other than
implementing primitives for the use of delimited continuations.
It is used by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E">yield</a>=
</tt>
operators to escape out of a block in which a continuation has
been captured. Neglecting to unwind is valid due to the expectation
that control will return into a restarted copy of that context.
</p><p>

</p></dd></dl>
<a name=3D"N-02DF20E5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.5">9.39.5</a=
> Function <tt>sys:abscond*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sys:abscond* </tt><tt><i>name</i></tt><tt> [</tt><tt><i>va=
lue</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DF20E5">sys:absco=
nd*</a></tt>
function is similar to the the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E20FE2">sys:absco=
nd-from</a></tt>
operator, except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
is an ordinary function parameter, and so when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309887F">return*</=
a></tt>
is used, an argument expression must be specified which evaluates
to a symbol. Thus
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DF20E5">sys:absco=
nd*</a></tt>
allows the target block of a return to be dynamically computed.
</p><p>
The following equivalence holds between the operator and function:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
E20FE2">sys:abscond-from</a> a b)  &lt;--&gt;  (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-02DF20E5">sys:abscond*</a> 'a b)
</tt></pre><tt>

</tt>

<p>
Expressions used as
<tt><i>name</i></tt>
arguments to
<tt>abscond*</tt>
which do not simply quote a symbol have no equivalent in
<tt>abscond-from</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01556613">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.6">9.39.6</a=
> Macros <tt>obtain</tt> and <tt>yield-from</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(obtain </tt><tt><i>forms</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(yield-from </tt><tt><i>name</i></tt><tt> [</tt><tt><i>form=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
macros closely inter-operate.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
macro treats zero or more
<tt><i>form</i></tt>-s
as a suspendable execution context called the
<i>obtain block</i>.

It is expected that
<tt><i>form</i></tt>-s
establish a block named
<tt><i>name</i></tt>
and return its result value to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>.
</p><p>
Without evaluating any of the forms in the obtain block,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
returns a function, which takes one optional argument.
This argument, called the
<i>resume value</i>,

defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if it is omitted.
</p><p>
The function represents the suspended execution context.
</p><p>
The context is resumed whenever the function is called, and executes
until the next
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
statement which references the block named
<tt><i>name</i></tt>.
The function's reply argument is noted.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
specifies a
<tt><i>form</i></tt>
argument, then the execution context suspends, and the resume function
terminates and returns the value of that form. When the function is called
again to resume the context, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
returns the previously noted resume value (and the new resume
value just passed is noted in its place).
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
specifies no
<tt><i>form</i></tt>
argument, then it briefly suspends the execution context only
to retrieve the resume value, without producing an item. Since
no item is produced, the resume function does not return.
The execution context implicitly resumes.
</p><p>
When execution reaches the last form in the obtain block, the
resume value is discarded. The execution context terminates, and
the most recent call to the resume function returns the value of
that last form.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
macro registers a finalizer against the returned resume function.
The finalizer invokes the function, passing it the symbol
<tt>sys:cont-poison</tt>,
thereby triggering unwinding in the most recently captured
continuation. Thus, abandoned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
blocks are subject to unwinding when they become garbage.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
macro works by capturing a continuation and performing a nonlocal
exit to the nearest block called
<tt><i>name</i></tt>.
It passes a special yield object to that block. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
macro generates code which knows what to do with this special yield
object.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
The following example shows a function which recursively
traverses a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell structure, yielding all the
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
atoms it encounters. Finally, it returns the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The function is invoked on a list,
and the invocation is wrapped in an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
block to convert it to a generating function.
</p><p>
The generating function is then called six times
to retrieve the five atoms from the list,
and the final
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
value. These are collected into a list.
</p><p>
This example demonstrates the power of delimited
continuations to suspend and resume a recursive
procedure.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> yflatten (obj)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">labels</=
a> ((flatten-rec (obj)
               (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C9E2=
4">cond</a>
                 ((null obj))
                 ((atom obj) (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-01556613">yield-from</a> yflatten obj))
                 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01513=
4D8">t</a> (flatten-rec (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-0043">car</a> obj))
                    (flatten-rec (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#D-0069">cdr</a> obj))))))
      (flatten-rec obj)
      nil))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
f (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a>=
 (yflatten '(a (b (c . d)) e)))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 [f] [f] [f] [f] [f] [f]))
  --&gt; (a b c d e nil)
</tt></pre><tt>

</tt>

<p>
The following interactive session log exemplifies two-way communication bet=
ween
the main code and a suspending function.
</p><p>
Here,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</=
a></tt>
is invoked on a list of symbols representing fruit and vegetable names.
The objective is to return a list containing only fruits.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
function suspends execution and yields a question out of the
<tt>map</tt>
block. It then classifies
the item as a fruit or not according to the reply it receives. The reply
emerges as a the result value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
call.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
macro converts the block to a generating function. The first call to the
function is made with no argument, because the argument would be ignored
anyway. The function returns a question, asking whether the first item
in the list, the potato, is a fruit.
To answer negatively, the user calls the function again, passing in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The function returns the next question, which is answered in the
same manner.
</p><p>
When the question for the last item is answered, the function
call yields the final item: the ordinary result of the block, which is the =
list
of fruit names.
</p><p>
<tt>
</tt></p><pre><tt>  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-01556613">obtain</a>
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>=
 map
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">map=
pend</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda<=
/a> (item)
                    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
39">if</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">y=
ield-from</a> map `is @item a fruit?`)
                      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0206CE91">list</a> item)))
                  '(potato apple banana lettuce orange carrot))))
  #&lt;interpreted fun: lambda (: reply)&gt;
  2&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1)
  "is potato a fruit?"
  3&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 nil)
  "is apple a fruit?"
  4&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 t)
  "is banana a fruit?"
  5&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 t)
  "is lettuce a fruit?"
  6&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 nil)
  "is orange a fruit?"
  7&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 t)
  "is carrot a fruit?"
  8&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 nil)
  (apple banana orange)
</tt></pre><tt>

</tt>

<p>
The following example demonstrates an accumulator. Values passed to the
resume function are added to a counter which is initially zero.
Each call to the function returns the updated value of the accumulator.
Note the use of
<tt>(yield-from acc)</tt>
with no arguments to receive the value passed to the first
call to the resume function, without yielding an item.
The first return value
<tt>1</tt>
is produced by the
<tt>(yield-from acc sum)</tt>
form, not by
<tt>(yield-from acc)</tt>.
The latter only obtains the initial value
<tt>1</tt>
and uses it to establish the seed value of the accumulator. Without causing
the resume function to terminate and return, control passes into the loop,
which yields the first item, causing the resume function call
<tt>(call *1 1)</tt>
to return
<tt>1</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-01556613">obtain</a>
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a>=
 acc
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let=
</a> ((sum (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">y=
ield-from</a> acc)))
            (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">=
while</a> t (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">=
inc</a> sum (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">=
yield-from</a> acc sum))))))
  #&lt;interpreted fun: lambda (: resume-val)&gt;
  2&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 1)
  1
  3&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 2)
  3
  4&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 3)
  6
  5&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call=
</a> *1 4)
  10
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01C791D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.7">9.39.7</a=
> Macro <tt>obtain-block</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(obtain-block </tt><tt><i>name</i></tt><tt> </tt><tt><i>for=
ms</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C791D0">obtain-bl=
ock</a></tt>
macro combines
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
into a single expression.
The
<tt><i>form</i></tt>-s
are evaluated in a block named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>.
</p><p>
That is to say, the following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
C791D0">obtain-block</a> n f ...)  &lt;--&gt;  (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#N-01556613">obtain</a> (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#D-005A">block</a> n f ...))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02AE5C1E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.8">9.39.8</a=
> Macro <tt>yield</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(yield [</tt><tt><i>form</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E">yield</a>=
</tt>
macro is to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a=
></tt>
is to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>:
it yields from an anonymous block.
</p><p>
It is equivalent to calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
as the block name.
</p><p>
In other words, the following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
AE5C1E">yield</a> x)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01556613">yield-from</a> nil x)
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Yield the integers 0 to 4 from a for loop, taking
  ;; advantage of its implicit anonymous block:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> f (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a> (=
(i 0)) ((&lt; i 5)) ((inc i))
                       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-02AE5C1E">yield</a> i))))

  [f] -&gt; 0
  [f] -&gt; 1
  [f] -&gt; 2
  [f] -&gt; 3
  [f] -&gt; 4
  [f] -&gt; nil
  [f] -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0102F0EB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.9">9.39.9</a=
> Macros <tt>obtain*</tt> and <tt>obtain*-block</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(obtain* </tt><tt><i>forms</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(obtain*-block </tt><tt><i>name</i></tt><tt> </tt><tt><i>fo=
rms</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*-b=
lock</a></tt>
macros implement a useful variation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C791D0">obtain-bl=
ock</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*</=
a></tt>
macro differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
in exactly one regard: prior to returning the function, it invokes
it one time, with the argument value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Thus, the following equivalence holds
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
02F0EB">obtain*</a> forms ...)   &lt;--&gt;  (<a href=3D"http://nongnu.org/=
txr/txr-manpage.html#N-013AF20B">let</a> ((f (<a href=3D"http://nongnu.org/=
txr/txr-manpage.html#N-01556613">obtain</a> forms ...)))
                                (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-0386C775">call</a> f)
                                f)
</tt></pre><tt>

</tt>

<p>
In other words, the suspended block is immediately resumed, so that it exec=
utes
either to completion (in which case its value is discarded), or to its firs=
t
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E">yield</a>=
</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">yield-fro=
m</a></tt>
call (in which case the yielded value is discarded).
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*</=
a></tt>
macro is useful in creating suspensions which accept data rather than
produce data.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*-b=
lock</a></tt>
macro combines
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
in the same manner that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C791D0">obtain-bl=
ock</a></tt>
combines
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01556613">obtain</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Pass three values into suspended block,
  ;; which get accumulated into list.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
f (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0102F0EB">obtain*-bl=
ock</a> nil
             (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91"=
>list</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E">yi=
eld</a> nil) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E"=
>yield</a> nil) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C=
1E">yield</a> nil)))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f 1)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f 2)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f 3))  -&gt;  (1 2 3)

  ;; Under obtain, extra call is required:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
f (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C791D0">obtain-blo=
ck</a> nil
             (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91"=
>list</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E">yi=
eld</a> nil) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C1E"=
>yield</a> nil) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AE5C=
1E">yield</a> nil)))))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f nil)  ;; execute block to first yield
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f 1)    ;; resume first yield with 1
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f 2)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a>=
 f 3))  -&gt;  (1 2 3)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02E7852D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.10">9.39.10<=
/a> Macro <tt>suspend</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(suspend </tt><tt><i>block-name</i></tt><tt> </tt><tt><i>va=
r-name</i></tt><tt> </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7852D">suspend</=
a></tt>
operator captures a continuation up to the prompt given by the
symbol
<tt><i>block-name</i></tt>
and binds it to the variable name given by
<tt><i>var-name</i></tt>,
which must be a symbol suitable for binding variables with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>.
</p><p>
Each
<tt><i>body-form</i></tt>
is then evaluated in the scope of the variable
<tt><i>var-name</i></tt>.
</p><p>
When the last
<tt><i>body-form</i></tt>
is evaluated, a non-local exit takes place to the block
named by
<tt><i>block-name</i></tt>
(using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E20FE2">sys:absco=
nd-from</a></tt>
operator, so that unwinding isn't performed).
</p><p>
When the continuation bound to
<tt><i>var-name</i></tt>
is invoked, a copy of the entire block
<tt><i>block-name</i></tt>
is re-started, and in that copy, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7852D">suspend</=
a></tt>
call appears to return normally, yielding the value which had been
passed to the continuation.
</p><p>
</p></dd><dt>Example</dt><dd>
<p>


</p><p>
Define John McCarthy's
<tt>amb</tt>
function using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7852D">suspend</=
a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
CAEF0B">defmacro</a> amb-scope (. forms)
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005A">block</a> a=
mb-scope ,*forms))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
amb (. args)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7852D">suspend<=
/a> amb-scope cont
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</=
a> ((a args))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a> a (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> cont=
 a))
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">re=
turn-from</a> amb a)))))
</tt></pre><tt>

</tt>

<p>
Use
<tt>amb</tt>
to bind the of
<tt>x</tt>
and
<tt>y</tt>
which satisfy the predicate
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a> (<a =
href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> x y) 8)=20

</tt>

non-deterministically:
</p><p>
<tt>
</tt></p><pre><tt>  (amb-scope
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((x (amb 1 2 3))
          (y (amb 4 5 6)))
      (amb (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">e=
ql</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a>=
 x y) 8))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</=
a> x y)))
  -&gt; (2 4)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01348099">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.39.11">9.39.11<=
/a> Macros <tt>hlet</tt> and <tt>hlet*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hlet ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i>=
</tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i><=
/tt><tt>*)=20




<br>&nbsp;&nbsp;(hlet* ({</tt><tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i=
></tt><tt> </tt><tt><i>init-form</i></tt><tt>)}*) </tt><tt><i>body-form</i>=
</tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01348099">hlet</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01348099">hlet*</a>=
</tt>
macros behave exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>,
respectively except that they guarantee that the variable bindings are
allocated in storage which isn't captured by delimited continuations.
</p><p>
The
<tt>h</tt>
in the names stands for "heap", serving as a mnemonic based on the
implementation concept of these bindings being "heap-allocated".
</p><p>
</p></dd></dl>
<a name=3D"N-0272B88D">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40">9.40</a> Re=
gular Expression Library</h3>



<p>


</p><p>
<b>TXR</b> provides a "pure" regular expression implementation based on aut=
omata
theory, which equates regular expressions, finite automata and sets of stri=
ngs.
A regular expression determines whether or not a string of input characters
belongs to a set. <b>TXR</b> regular expressions do not support features su=
ch
as as "anchoring" a match to the start or end of a string, or capture of
parenthesized sub-expression matches into registers. Parenthesis syntax
denotes only grouping, with no additional meaning.
</p><p>
The semantics of whether a regular expression is used for a substring
search, prefix match, suffix match, string splitting and so forth comes fro=
m
the functions which use regular expressions to perform these operations.
</p><p>
<a name=3D"N-020216B7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.1">9.40.=
1</a> Regular Expressions as Functions</h4>


<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;[</tt><tt><i>regex</i></tt><tt> [</tt><tt><i>start</i></tt>=
<tt> [</tt><tt><i>from-end</i></tt><tt>]] </tt><tt><i>string</i></tt><tt> ]=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



A regular expression is callable as a function in <b>TXR Lisp</b>.
When used this way, it requires a string argument. It searches
the string for the leftmost match for itself, and returns
the matching substring, which could be empty. If no match is
found, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A regex takes one, two, or three arguments. The required
<tt><i>string</i></tt>
is always the rightmost argument. This allows for convenient
partial application of the optional arguments using
macros in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
family, and macros in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
syntax is implicit.
</p><p>
The optional arguments
<tt><i>start</i></tt>
and
<tt><i>from-end</i></tt>
are treated exactly as their like-named counterparts in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gst</a></tt>
function.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


Keep those elements from a list of strings which match
the regular expression
<tt>#/a.*b/</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
413802">keep-if</a> #/a.*b/ '#"abracadabra zebra hat adlib adobe deer")
  --&gt; ("abracadabra" "adlib" "adobe")
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0250D465">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.2">9.40.2</a=
> Functions <tt>search-regex</tt>, <tt>range-regex</tt> and <tt>search-regs=
t</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(search-regex </tt><tt><i>string</i></tt><tt> </tt><tt><i>r=
egex</i></tt><tt> [</tt><tt><i>start</i></tt><tt> [</tt><tt><i>from-end</i>=
</tt><tt>]])=20




<br>&nbsp;&nbsp;(range-regex </tt><tt><i>string</i></tt><tt> </tt><tt><i>re=
gex</i></tt><tt> [</tt><tt><i>start</i></tt><tt> [</tt><tt><i>from-end</i><=
/tt><tt>]])=20




<br>&nbsp;&nbsp;(search-regst </tt><tt><i>string</i></tt><tt> </tt><tt><i>r=
egex</i></tt><tt> [</tt><tt><i>start</i></tt><tt> [</tt><tt><i>from-end</i>=
</tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gex</a></tt>
function searches through
<tt><i>string</i></tt>
starting
at position
<tt><i>start</i></tt>
for a match for
<tt><i>regex</i></tt>.
</p><p>
If
<tt><i>start</i></tt>
is omitted, the search starts at position 0. If
<tt><i>from-end</i></tt>
is specified and has a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value, the search
proceeds in reverse, from the position just beyond the last character of
<tt><i>string</i></tt>,
toward
<tt><i>start</i></tt>.
</p><p>
if
<tt><i>start</i></tt>
exceeds the length of the string, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gex</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>start</i></tt>
is negative then it indicates positions from the end of the string,
such that -1 is the last character, -2 the second last and so forth.
If the value is so negative that it refers beyond the start of
the string, then the starting position is deemed to be zero.
</p><p>
If
<tt><i>start</i></tt>
is equal to the length of
<tt><i>string</i></tt>,
and thus refers to the position one character past its
length, then a match occurs at that position if
<tt><i>regex</i></tt>
admits such a match.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gex</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if no match is found, otherwise it returns
a cons, whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
indicates the position of the match, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
indicates the length of the match.
</p><p>
If
<tt><i>regex</i></tt>
is capable of matching empty strings, and no other kind of match
is found within
<tt><i>string</i></tt>,
then search regex reports a zero length match. If
<tt><i>from-end</i></tt>
is false, then this match is reported at
<tt><i>start</i></tt>,
otherwise it is reported at the position one character beyond
the end of the string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">range-reg=
ex</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gex</a></tt>,
except that when
a match is found, it returns a position range, rather than a position
and length. A range object is returned whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
field indicates the position
of the match, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
indicates the position one element past the
last character of the match. If the match is empty, the two integers
are equal.
</p><p>
Also see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>
function, which provides an alternative argument syntax for
the semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">range-reg=
ex</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gst</a></tt>
differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">search-re=
gex</a></tt>
in the representation of the return value in the matching case.
Rather than returning the position and length of the match,
it returns the matching substring of
<tt><i>string</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02E3A26F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.3">9.40.3</a=
> Functions <tt>match-regex</tt> and <tt>match-regst</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(match-regex </tt><tt><i>string</i></tt><tt> </tt><tt><i>re=
gex</i></tt><tt> [</tt><tt><i>position</i></tt><tt>])=20




<br>&nbsp;&nbsp;(match-regst </tt><tt><i>string</i></tt><tt> </tt><tt><i>re=
gex</i></tt><tt> [</tt><tt><i>position</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3A26F">match-reg=
ex</a></tt>
function tests whether
<tt><i>regex</i></tt>
matches at
<tt><i>position</i></tt>
in
<tt><i>string</i></tt>.
</p><p>
If
<tt><i>position</i></tt>
is not specified, it is taken to be zero. Negative values
of
<tt><i>position</i></tt>
index from the right end of the string such that -1
refers to the last character. Excessively negative
values which index before the first character cause
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to be returned.
</p><p>
If the regex matches, then the length of the match is returned.
If it does not match, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3A26F">match-reg=
st</a></tt>
differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3A26F">match-reg=
ex</a></tt>
in the representation of the return value in the matching case.
Rather than returning the length of the match, it returns
matching substring of
<tt><i>string</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-019430C5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.4">9.40.4</a=
> Functions <tt>match-regex-right</tt> and <tt>match-regst-right</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(match-regex-right </tt><tt><i>string</i></tt><tt> </tt><tt=
><i>regex</i></tt><tt> [</tt><tt><i>end-position</i></tt><tt>])=20




<br>&nbsp;&nbsp;(match-regst-right </tt><tt><i>string</i></tt><tt> </tt><tt=
><i>regex</i></tt><tt> [</tt><tt><i>end-position</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019430C5">match-reg=
ex-right</a></tt>
function tests whether some substring of
<tt><i>string</i></tt>
which terminates at the character position just before
<tt><i>end-position</i></tt>
matches
<tt><i>regex</i></tt>.
</p><p>
If
<tt><i>end-position</i></tt>
is not specified, it defaults to the length of the string, and the function
performs a right-anchored regex match.
</p><p>
The
<tt><i>end-position</i></tt>
argument can be a negative integer, in which case it denotes
positions from the end of the string, such that -1 refers
to the last character. If the value is excessively negative such
that the position immediately before it is before the start
of the string, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If
<tt><i>end-position</i></tt>
is a positive value beyond the length of
<tt><i>string</i></tt>,
then, likewise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If a match is found, then the length of the match is returned.
</p><p>
A more precise way of articulating the role of
<tt><i>end-position</i></tt>
is that for the purposes of matching,
<tt>string</tt>
is considered to terminate just before
<tt><i>end-position</i></tt>:
in other words, that
<tt><i>end-position</i></tt>
is the length of the string. The match is then anchored to the
end of this effective string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019430C5">match-reg=
st-right</a></tt>
differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019430C5">match-reg=
st-right</a></tt>
in the representation of the return value in the matching case.
Rather than returning the length of the match, it returns
the matching substring of
<tt><i>string</i></tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Return matching portion rather than length thereof.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
match-regex-right-substring (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-00C6B7C4">str</a> reg : end-pos)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> end-=
pos (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> end-p=
os (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a> st=
r)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> =
((len (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019430C5">match-=
regex-right</a> str reg end-pos)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> len
        [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a> end-po=
s len)..end-pos]
        nil)))

  (match-regex-right-substring "abc" #/c/) -&gt; ""

  (match-regex-right-substring "acc" #/c*/) -&gt; "cc"

  ;; Regex matches starting at multiple positions, but all
  ;; the matches extend past the limit.
  (match-regex-right-substring "acc" #/c*/ 2) -&gt; nil

  ;; If the above behavior is not wanted, then
  ;; we can extract the string up to the limiting
  ;; position and do the match on that.
  (match-regex-right-substring ["acc" 0..2] #/c*/) -&gt; "c"

  ;; Equivalent of above call
  (match-regex-right-substring "ac" #/c*/) -&gt; "c"
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02CE60DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.5">9.40.5</a=
> Function <tt>regex-prefix-match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regex-prefix-match </tt><tt><i>regex</i></tt><tt> </tt><tt=
><i>string</i></tt><tt> [</tt><tt><i>position</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pre=
fix-match</a></tt>
determines whether the input string might
might be the prefix of a string which matches regular expression
<tt><i>regex</i></tt>.
</p><p>
The result is true if the input string matches
<tt><i>regex</i></tt>
exactly. However, it is also true in situations in which
the input string doesn't match
<tt><i>regex</i></tt>,
yet can be extended with one or more additional characters beyond the end s=
uch
that the extended string
<b>does</b>

match.
</p><p>
The
<tt><i>string</i></tt>
argument must be a character string. The function takes the input string to=
 be
the suffix of
<tt><i>string</i></tt>
which starts at the character position indicated by the
<tt><i>position</i></tt>
argument. If that argument is omitted, then
<tt><i>string</i></tt>
is taken as the input in its entirety. Negative values index backwards from
the end of
<tt><i>string</i></tt>
according to the usual conventions elsewhere in the library.
</p><p>
Note: this function is not to be confused for the semantics
of a regex matching a prefix of a string: that capability is
provided by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3A26F">match-reg=
ex</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^</a></=
tt>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; The empty string is not a viable prefix match for
  ;; a regex that matches no strings at all:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/~.*/ "") -&gt; nil
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/[]/ "") -&gt; nil

  ;; The empty string is a viable prefix of any regex
  ;; which matches at least one string:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #// "") -&gt; t
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/abc/ "") -&gt; t

  ;; This string doesn't match the regex because
  ;; it doesn't end in b, but is a viable prefix:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/a*b/ "aa") -&gt; t

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/a*b/ "ab") -&gt; t

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/a*b/ "ac") -&gt; nil

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CE60DF">regex-pref=
ix-match</a> #/a*b/ "abc") -&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03BDC5F6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.6">9.40.6</a=
> Function <tt>regsub</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regsub {</tt><tt><i>regex</i></tt><tt> | </tt><tt><i>funct=
ion</i></tt><tt>} </tt><tt><i>replacement</i></tt><tt> </tt><tt><i>string</=
i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BDC5F6">regsub</a=
></tt>
function operates in two modes, depending on whether
the first argument is a regular expression,
or function.
</p><p>
If the first argument is a regular expression it searches
<tt><i>string</i></tt>
for multiple occurrences of non-overlapping matches for that
<tt><i>regex</i></tt>.
A new string is constructed
similar to
<tt><i>string</i></tt>
but in which each matching region is replaced
with using
<tt><i>replacement</i></tt>
as follows.
</p><p>
The
<tt><i>replacement</i></tt>
object may be a character or a string, in which
case it is simply taken to be the replacement for each match
of the regular expression.
</p><p>
The
<tt><i>replacement</i></tt>
object may be a function of one argument, in
which case for every match which is found, this function is invoked,
with the matching piece of text as an argument. The function's
return value is then taken to be the replacement text.
</p><p>
If the first argument is a function, then it is called, with
<tt><i>string</i></tt>
as its argument. The return value must be either a range
object (see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</a>=
</tt>
function) which indicates the extent of
<tt><i>string</i></tt>
to be replaced, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
which indicates that no replacement is to take place.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; match every lower case e or o, and replace by filter=
ing
  ;; through the upcase-str function:

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BDC5F6">regsub</a>=
 #/[eo]/ upcase-str "Hello world!"] -&gt; "HEllO wOrld!"

  ;; Replace Hello with Goodbye:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BDC5F6">regsub</a>=
 #/Hello/ "Goodbye" "Hello world!") -&gt; "Goodbye world!"

  ;; Left-anchored replacement with r^ function:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BDC5F6">regsub</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^</a> #/H=
/) "J" "Hello, hello!") -&gt; "Jello, hello!"
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03DDC533">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.7">9.40.7</a=
> Function <tt>regexp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regexp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DDC533">regexp</a=
></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a compiled regular expression
object. For any other object type, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00CF29CC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.8">9.40.8</a=
> Functions <tt>trim-left</tt> and <tt>trim-right</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trim-left {</tt><tt><i>regex</i></tt><tt> | </tt><tt><i>pr=
efix</i></tt><tt>} </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(trim-right {</tt><tt><i>regex</i></tt><tt> | </tt><tt><i>s=
uffix</i></tt><tt>} </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-left=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-righ=
t</a></tt>
functions return a new string, equivalent to
<tt><i>string</i></tt>
with a leading or trailing portion removed.
</p><p>
If the first argument is a regular expression
<tt><i>regex</i></tt>,
then, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-left=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-righ=
t</a></tt>
find a prefix or suffix of
<tt><i>string</i></tt>
which matches the regular expression.
If there is no match, or if the match is empty, then
<tt><i>string</i></tt>
is returned. Otherwise, a copy of
<tt><i>string</i></tt>
is returned in which the matching characters are removed.
If
<tt><i>regex</i></tt>
matches all of
<tt><i>string</i></tt>
then the empty string is returned.
</p><p>
If the first argument is a character string, then it is treated
as if it were a regular expression match for that literal
sequence of characters. Thus,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-left=
</a></tt>
interprets that string as a
<tt><i>prefix</i></tt>
to be removed, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-righ=
t</a></tt>
as a
<tt><i>suffix</i></tt>.
If
<tt><i>string</i></tt>
starts with
<tt><i>prefix</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-left=
</a></tt>
returns a copy of
<tt><i>string</i></tt>
with
<tt><i>prefix</i></tt>
removed. Otherwise,
<tt><i>string</i></tt>
is returned.
Likewise, if
<tt><i>string</i></tt>
ends with
<tt><i>suffix</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CF29CC">trim-righ=
t</a></tt>
returns a copy of
<tt><i>string</i></tt>
with
<tt><i>suffix</i></tt>
removed. Otherwise,
<tt><i>string</i></tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-0168C611">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.9">9.40.9</a=
> Function <tt>regex-compile</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regex-compile </tt><tt><i>form-or-string</i></tt><tt> [</t=
t><tt><i>error-stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-com=
pile</a></tt>
function takes the source code of a regular expression,
expressed as a Lisp data structure representing an abstract syntax tree, or
else a regular expression specified as a character string, and compiles it =
to a
regular expression object.
</p><p>
If
<tt><i>form-or-string</i></tt>
is a character string, it is parsed to an
abstract syntax tree first, if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
function.
If the parse is successful (the result is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>)
then
the resulting tree structure is compiled by a recursive call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-com=
pile</a></tt>.
</p><p>
The optional
<tt><i>error-stream</i></tt>
argument is passed down to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
as well as in the recursive call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-com=
pile</a></tt>,
if that call takes place.
</p><p>
If
<tt><i>error-stream</i></tt>
is specified, it must be a stream. Any error diagnostics are sent to that
stream.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; the equivalent of #/[a-zA-Z0-9_/
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-comp=
ile</a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a>=
 (#\a . #\z) (#\A . #\Z)
                       (#\0 . #\9) #\_))

  ;; the equivalent of #/.*/ and #/.+/
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-comp=
ile</a> '(0+ wild))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-comp=
ile</a> '(1+ wild))

  ;; #/a|b|c/
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-comp=
ile</a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a> #\a #\b) =
#\c))

  ;; string
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-comp=
ile</a> "a|b|c")
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0218BD2B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.10">9.40.10<=
/a> Function <tt>regex-source</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regex-source </tt><tt><i>regex</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0218BD2B">regex-sou=
rce</a></tt>
function returns the source code of compiled regular expression
<tt><i>regex</i></tt>.
</p><p>
The source code isn't the textual notation, but the Lisp
data structure representing the abstract syntax tree: the
same representation as what is returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01C9C361">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.11">9.40.11<=
/a> Function <tt>regex-parse</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regex-parse </tt><tt><i>string</i></tt><tt> [</tt><tt><i>e=
rror-stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
function parses a character string which contains a regular expression and
turns it into a Lisp data structure (the abstract syntax tree representatio=
n of
the regular expression).
</p><p>
The regular expression syntax
<tt>#/RE/</tt>
produces the same structure, but as a
literal which is processed at the time <b>TXR</b> source code is read; the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
function performs this parsing at run-time.
</p><p>
If there are parse errors, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The optional
<tt><i>error-stream</i></tt>
argument specifies a stream to which error messages
are sent from the parser. By default, diagnostic output goes to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdnull*=
</a></tt>
stream, which discards it. If
<tt><i>error-stream</i></tt>
is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
then the diagnostic output goes to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
stream.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
returns a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value, that structure is then something
which is suitable as input to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-com=
pile</a></tt>.
</p><p>
There is a small difference in the syntax accepted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
and the syntax of regular expression literals. Any
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(slash) characters occurring in any position within
<tt><i>string</i></tt>
are treated as ordinary characters, not as regular expression delimiters.
The call
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-parse<=
/a> "/a/")
</tt>

matches three characters: a slash, followed by the letter "a", followed
by another slash. Note that the slashes are not escaped.
</p><p>
Note: if a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>
call is written using a string literal as the
<tt><i>string</i></tt>
argument, then note that any backslashes which are to be processed
by the regular expression must be doubled up, otherwise they belong
to the string literal:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
C9C361">regex-parse</a> "\*")  ;; error, invalid string literal escape
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-pars=
e</a> "\\*") ;; correct: the \* literal match for *
</tt></pre><tt>

</tt>

<p>
The double backslash in the string literal produces a single backslash
in the resulting string object that is processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C9C361">regex-par=
se</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001D3F81">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.12">9.40.12<=
/a> Function <tt>read-until-match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(read-until-match </tt><tt><i>regex</i></tt><tt> [</tt><tt>=
<i>stream</i></tt><tt> [</tt><tt><i>include-match</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D3F81">read-unti=
l-match</a></tt>
function reads characters from
<tt><i>stream</i></tt>,
accumulating them into a string, which is returned.
</p><p>
If an argument is not specified for
<tt><i>stream</i></tt>,
then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream is used.
</p><p>
The
<tt><i>include-match</i></tt>
argument is Boolean, indicating whether the delimiting text
matched by
<tt><i>regex</i></tt>
is included in the returned string. It defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The accumulation of characters is terminated by a match on
<tt><i>regex</i></tt>,
the end of the stream, or an error.
</p><p>
This means that characters are read from the stream and accumulated while t=
he
stream has more characters available, and while its prefix does not match
<tt><i>regex</i></tt>.
</p><p>
If
<tt><i>regex</i></tt>
matches the stream before any characters are accumulated,
then an empty string is returned.
</p><p>
If the stream ends or an non-exception-throwing error occurs before any
characters are accumulated, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
When the accumulation of characters terminates by a match on
<tt><i>regex</i></tt>,
the longest possible matching sequence of characters is
removed from the stream.  If
<tt><i>include-match</i></tt>
is true, that matching text is included in
the returned string. Otherwise, it is discarded.
The next available character in the stream is the first
non-matching character following the matched text.
However, the next available character, as well as some number of
subsequent characters, may originate from the stream's push-back buffer,
rather than from the underlying operating system object,
due to this function's internal use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
function. Therefore, the stream position, as would be reported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>,
is unspecified.
</p><p>

</p></dd></dl>
<a name=3D"N-00EFD668">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.13">9.40.13<=
/a> Functions <tt>scan-until-match</tt> and <tt>count-until-match</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(scan-until-match </tt><tt><i>regex</i></tt><tt> [</tt><tt>=
<i>stream</i></tt><tt>])=20




<br>&nbsp;&nbsp;(count-until-match </tt><tt><i>regex</i></tt><tt> [</tt><tt=
><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00EFD668">scan-unti=
l-match</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00EFD668">count-unt=
il-match</a></tt>
read characters from
<tt><i>stream</i></tt>
until a match occurs in the stream for regular expression
<tt><i>regex</i></tt>,
the stream runs out of characters, or an error occurs.
</p><p>
If the stream runs out of characters, or a non-exception-throwing error
occurs, before a match for
<tt><i>regex</i></tt>
is identified, these functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If a match for
<tt><i>regex</i></tt>
occurs in
<tt><i>stream</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00EFD668">count-unt=
il-match</a></tt>
returns the number of characters that were read and discarded prior to
encountering the first matching character.
In the same situation, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00EFD668">scan-unti=
l-match</a></tt>
function returns a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
holds the count of discarded characters, that being the same value as what
would be returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00EFD668">count-unt=
il-match</a></tt>,
and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
holds a character string that comprises the text matched by
<tt><i>regex</i></tt>.
The text matched by
<tt><i>regex</i></tt>
is as long as possible, and is removed from the stream.
The next available character in the stream is the first
non-matching character following the matched text.
However, the next available character, as well as some number of
subsequent characters, may originate from the stream's push-back buffer,
rather than from the underlying operating system object,
due to these functions' internal use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
function. Therefore, the stream position, as would be reported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>,
is unspecified.
</p><p>

</p></dd></dl>
<a name=3D"N-02F44ECE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.14">9.40.14<=
/a> Functions <tt>m^$</tt>, <tt>m^</tt> and <tt>m$</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(m^$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</=
i></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(m^ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</i=
></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(m$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>end-positio=
n</i></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions provide functionality similar to the
<tt><i>match-regst</i></tt>
and
<tt><i>match-regst-right</i></tt>
functions, but under alternative interfaces which are more
convenient.
</p><p>
The
<tt>^</tt>
and
<tt>$</tt>
notation used in their names are an allusion to the
regular expression search anchoring operators found in
familiar POSIX utilities such as
<tt>grep</tt>.
</p><p>
The
<tt><i>position</i></tt>
argument, if omitted,
defaults to zero, so that the
entire
<tt><i>string</i></tt>
is operated upon.
</p><p>
The
<tt><i>end-position</i></tt>
argument defaults to the length of
<tt><i>string</i></tt>,
so that the end position coincides with the end of the
string.
</p><p>
If the
<tt><i>position</i></tt>
or
<tt><i>end-position</i></tt>
arguments are negative, they index backwards
from the length of
<tt><i>string</i></tt>
so that -1 denotes the last character.
</p><p>
A value in either parameter which is excessively
negative or positive, such that it indexes before
the start of the string or exceeds its length
results in a failed match and consequently
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
being returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^$</a></=
tt>
function tests whether the entire portion of
<tt><i>string</i></tt>
starting at
<tt><i>position</i></tt>
through to the end of the string is in the set of strings
matched by
<tt><i>regex</i></tt>.
If this is true, then that portion of the string is
returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^</a></t=
t>
function tests whether the portion of the
<tt><i>string</i></tt>
starting at
<tt><i>position</i></tt>
has a prefix which matches
<tt><i>regex</i></tt>.
If so, then this matching prefix is returned.
Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m$</a></t=
t>
function tests whether the portion of
<tt><i>string</i></tt>
ending just before
<tt><i>end-position</i></tt>
has a suffix which matches
<tt><i>regex</i></tt>.
If so, then this matching suffix is returned.
Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03BBB0C5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.15">9.40.15<=
/a> Functions <tt>r^$</tt>, <tt>r^</tt>, <tt>r$</tt> and <tt>rr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(r^$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</=
i></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(r^ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</i=
></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(r$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>end-positio=
n</i></tt><tt>] </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rr </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</i=
></tt><tt> [</tt><tt><i>from-end</i></tt><tt>]] </tt><tt><i>string</i></tt>=
<tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The first three of these functions perform the same operations as,
respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^$</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m$</a></t=
t>,
with the same argument conventions. They differ
in return value. When a match is found, they
return a range value indicating the extent of
the matching substring within
<tt><i>string</i></tt>
rather than the matching substring itself.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>
function performs the same operation as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">range-reg=
ex</a></tt>
with different conventions with regard to argument
order, harmonizing with those of the other three functions above.
</p><p>
The
<tt><i>position</i></tt>
argument, if omitted,
defaults to zero, so that the
entire
<tt><i>string</i></tt>
is operated upon.
</p><p>
The
<tt><i>end-position</i></tt>
argument defaults to the length of
<tt><i>string</i></tt>,
so that the end position coincides with the end of the
string.
</p><p>
With one exception, a value in either parameter which is excessively negati=
ve
or positive, such that it indexes before the start of the string or exceeds=
 its
length results in a failed match and consequently
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
being returned. The exception is that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>
function permits a negative
<tt><i>position</i></tt>
value which refers before the start of the string; this is effectively
treated as zero.
</p><p>
The
<tt><i>from-end</i></tt>
argument defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^$</a></=
tt>
function tests whether the entire portion of
<tt><i>string</i></tt>
starting at
<tt><i>position</i></tt>
through to the end of the string is in the set of strings
matched by
<tt><i>regex</i></tt>.
If this is true, then the matching range is returned,
as a range object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^</a></t=
t>
function tests whether the portion of the
<tt><i>string</i></tt>
starting at
<tt><i>position</i></tt>
has a prefix which matches
<tt><i>regex</i></tt>.
If so, then the matching range is returned, as a range object.
Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r$</a></t=
t>
function tests whether the portion of
<tt><i>string</i></tt>
ending just before
<tt><i>end-position</i></tt>
has a suffix which matches
<tt><i>regex</i></tt>.
If so, then the matching range is returned.
Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>
function searches
<tt><i>string</i></tt>
starting at
<tt><i>position</i></tt>
for a match for
<tt>regex</tt>.
If
<tt><i>from-end</i></tt>
is specified and true, the rightmost
match is reported.
If a match is found, it is reported
as a range.
</p><p>
A regular expression which matches empty
strings matches at the start position,
and every other position, including
the position just after the last
character, coinciding with the length of
<tt><i>string</i></tt>.
</p><p>
Except for the different argument order such that
<tt><i>string</i></tt>
is always the rightmost argument, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>
function is equivalent to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250D465">range-reg=
ex</a></tt>
function, such that correspondingly named
arguments have the same semantics.
</p><p>

</p></dd></dl>
<a name=3D"N-0177F5FF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.16">9.40.16<=
/a> Function <tt>rra</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rra </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>start</i><=
/tt><tt> [</tt><tt><i>end</i></tt><tt>]] </tt><tt><i>string</i></tt><tt>)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0177F5FF">rra</a></=
tt>
function searches
<tt><i>string</i></tt>
between the
<tt><i>start</i></tt>
and
<tt><i>end</i></tt>
position for matches for the regular expression
<tt><i>regex</i></tt>.
</p><p>
The matches are returned as a list of range objects.
</p><p>
The
<tt><i>start</i></tt>
argument defaults to zero, and
<tt><i>end</i></tt>
defaults to the length of the string (the position one
past the last character).
</p><p>
Negative values of
<tt><i>start</i></tt>
and
<tt><i>end</i></tt>
indicate positions from the end of the string, such that -1
denotes the last character, -2 the second-to-last and so forth.
</p><p>
If
<tt><i>start</i></tt>
is so negative that it refers before the start of
<tt><i>string</i></tt>,
it is treated as zero. If this situation is true of the
<tt><i>end</i></tt>
argument, then the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>start</i></tt>
refers to a character position beyond the length of
<tt><i>string</i></tt>
(two characters or more beyond the end of the string),
then the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If this situation is true of
<tt><i>end</i></tt>,
then
<tt><i>end</i></tt>
is is curtailed to the the string length.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0177F5FF">rra</a></=
tt>
function returns all non-overlapping matches, including
zero length matches. Zero length matches may occur before
the first character of the string, or after the last
character. If so, these are included.
</p><p>

</p></dd></dl>
<a name=3D"N-000B5ACD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.17">9.40.17<=
/a> Functions <tt>f^$</tt>, <tt>f^</tt> and <tt>f$</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(f^$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</=
i></tt><tt>])=20




<br>&nbsp;&nbsp;(f^ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</i=
></tt><tt>])=20




<br>&nbsp;&nbsp;(f$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>end-positio=
n</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These regular expression functions do not directly
perform regex operations. Rather, they each return
a function of one argument which performs a regex
operation.
</p><p>
The returned functions perform the same operations as,
respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^$</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m$</a></t=
t>.
</p><p>
The following equivalences nearly hold, except that the functions
on the right side produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
can accept two arguments when only
<tt>r</tt>
is curried, whereas the functions on the left take only
one argument:
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
0B5ACD">f^$</a> r]    &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0068EA9D">op</a> m^$ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^$</a> r =
p]  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA=
9D">op</a> m^$ r p)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^</a> r] =
    &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA=
9D">op</a> m^ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^</a> r p=
]   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA=
9D">op</a> m^ r p)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f$</a> r] =
    &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA=
9D">op</a> m$ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f$</a> r p=
]   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA=
9D">op</a> m$ r p)
</tt></pre><tt>

</tt>

<p>
That is to say,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^$</a></=
tt>
returns a function which binds
<tt><i>regex</i></tt>
and possibly the optional
<tt><i>position</i></tt>.
When this function is invoked, it must be given an argument
which is a string. It performs the same operation as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^$</a></=
tt>
being called on
<tt><i>regex</i></tt>
and possibly
<tt><i>position</i></tt>.
The same holds between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m^</a></t=
t>,
and between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f$</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F44ECE">m$</a></t=
t>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; produce list which contains only strings
  ;; beginning with "cat":
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^</a> #/c=
at/) '#"dog catalog cat fox catapult")
  --&gt; ("catalog" "cat" "catapult")

  ;; map all strings in a list to just their trailing
  ;; digits.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f$</a> #/\d=
*/) '#"a123 4 z bc465")
  --&gt; ("123" "4" "" "465")

  ;; check that all strings consist of digits after
  ;; the third position.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a> '#"ABC=
123 DFE45 12379" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5=
ACD">f^$</a> #/\d*/ 3))
  --&gt; "79"  ; i.e. true
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001B">all</a> '#"ABC=
123 DFE45 12379A" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B=
5ACD">f^$</a> #/\d*/ 3))
  --&gt; nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-031971BD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.40.18">9.40.18<=
/a> Functions <tt>fr^$</tt>, <tt>fr^</tt>, <tt>fr$</tt> and <tt>frr</tt></h=
4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fr^$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position<=
/i></tt><tt>])=20




<br>&nbsp;&nbsp;(fr^ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>position</=
i></tt><tt>])=20




<br>&nbsp;&nbsp;(fr$ </tt><tt><i>regex</i></tt><tt> [</tt><tt><i>end-positi=
on</i></tt><tt>])=20




<br>&nbsp;&nbsp;(frr </tt><tt><i>regex</i></tt><tt> [[</tt><tt><i>start-pos=
ition</i></tt><tt>] </tt><tt><i>from-end</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These regular expression functions do not directly
perform regex operations. Rather, they each return
a function of one argument which performs a regex
operation.
</p><p>
The returned functions perform the same operations as,
respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^$</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r$</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>.
</p><p>
The following equivalences nearly hold, except that some of the functions o=
n the right side produced by op
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
can accept additional arguments after the input string,
whereas the functions on the left produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B5ACD">f^$</a></=
tt>
<i>et al.</i>

accept only one parameter: the input string.
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
1971BD">fr^$</a> r]     &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-0068EA9D">op</a> m^$ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^$</a> r=
 p]   &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m^$ r p)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^</a> r]=
      &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m^ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^</a> r =
p]    &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m^ r p)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr$</a> r]=
      &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m$ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr$</a> r =
p]    &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m$ r p)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">frr</a> r]=
      &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m$ r)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">frr</a> r =
s]    &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m$ r s)
  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">frr</a> r =
s fe] &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> m$ r s fe)
</tt></pre><tt>

</tt>

<p>
That is to say,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^$</a><=
/tt>
returns a function which binds
<tt><i>regex</i></tt>
and possibly the optional
<tt><i>position</i></tt>.
When this function is invoked, it must be given an argument
which is a string. It performs the same operation as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^$</a></=
tt>
being called on
<tt><i>regex</i></tt>
and possibly
<tt><i>position</i></tt>,
and the string.
The same holds between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r^</a></t=
t>,
between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr$</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">r$</a></t=
t>,
and between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">frr</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BBB0C5">rr</a></t=
t>.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Remove leading digits from "123A456",
  ;; other than first digit:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BDC5F6">regsub</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031971BD">fr^</a> #/\=
d+/ 1) "" "123A456")
  --&gt; "1A456"
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-01559C04">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41">9.41</a> Ha=
shing Library</h3>



<p>


</p><p>
A hash table is an object which retains an association between pairs of
objects. Each pair consists of a key and value. Given an object which is
similar to a key in the hash table, it is possible to retrieve the
corresponding value. Entries in a hash table are not ordered in any way, an=
d
lookup is facilitated by hashing: quickly mapping a key object to a numeric
value which is then used to index into one of many buckets where the matchi=
ng
key will be found (if such a key is present in the hash table).
</p><p>
In addition to keys and values, a hash table contains a storage location
which allows it to be associated with user data.
</p><p>
Important to the operation of a hash table is the criterion by which keys a=
re
considered same. By default, this similarity follows the eql function.  A h=
ash
table will search for a stored key which is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
to the given search key.
A hash table constructed with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
property compares keys using
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function instead.
</p><p>
In addition to storing key-value pairs, a hash table can have a piece of
information associated with it, called the user data.
</p><p>
<b>TXR</b> hash tables contain a seed value which permutes the hashing oper=
ation,
at least for keys of certain types.  This feature, if the seed is randomize=
d,
helps to prevent software from being susceptible to hash collision
denial-of-service attacks. However, by default, the seed is not randomized.
Newly created hash tables for which a seed value is not specified take thei=
r
seed value from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
special variable, which is initialized to zero. That includes hash tables
created by parsing hash literal syntax.
Security-sensitive programs
requiring protection against collision attacks may use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002CFA72">gen-hash-=
seed</a></tt>
to create a randomized hash seed, and, depending on their specific need, ei=
ther
store that value in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>,
or pass the value to hash table constructors like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026D4158">make-hash=
</a></tt>,
or both.
Note: randomization of hash seeding isn't a default behavior because it aff=
ects
program reproducibility. The seed value affects the order in which keys are
traversed, which can change the output of programs whose inputs have not
changed, and whose logic is is otherwise deterministic.
</p><p>
A hash table can be traversed to visit all of the keys and data.  The order=
 of
traversal bears no relation to the order of insertion, or to any properties=
 of
the key type.
</p><p>
During an open traversal, new keys can be inserted into a hash table or del=
eted
from it while a a traversal is in progress. Insertion of a new key during
traversal will not cause any existing key to be visited twice or to be skip=
ped;
however, it is not specified whether the new key will be traversed. Similar=
ly,
if a key is deleted during traversal, and that key has not yet been visited=
, it
is not specified whether it will be visited during the remainder of the
traversal. These remarks apply not only to deletion via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0029C57A">remhash</=
a></tt>
or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0041">del</a></tt>
operator, but also to wholesale deletion of all keys via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00836D97">clearhash=
</a></tt>.
</p><p>
The garbage collection of hash tables supports weak keys and weak values.
If a hash table has weak keys, this means that from the point of view
of garbage collection, that table holds only weak references to the keys
stored in it.  Similarly, if a hash table has weak values, it means that it
holds a weak reference to each value stored. A weak reference is one
which does not prevent the reclamation of an object by the garbage
collector. That is to say, when the garbage collector discovers that the on=
ly
references to some object are weak references, then that object is consider=
ed
garbage, just as if it had no references to it. The object is reclaimed, an=
d
the weak references "lapse" in some way, which depends on what kind they ar=
e.
Hash table weak references lapse by entry removal.  When an object used
as a key in in one or more weak-key hash tables becomes unreachable, those =
hash
entries disappear. This happens even if the values are themselves reachable=
.
That is what it means that.
<i>Vice versa</i>,

when an object appearing as a value in
one or more hash table entries in weak-value hash tables becomes unreachabl=
e,
those entries disappear, even if the keys are reachable. When a hash table =
has
both weak keys and weak values, then its entries are removed when either ke=
ys
or values become unreachable.  In other words, both the key and value must =
be
reachable in order to retain the entry.
</p><p>
An open traversal of a hash table is performed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E6917D">maphash</=
a></tt>
function and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039105E8">dohash</a=
></tt>
operator. The traversal is open because code supplied by the program
is evaluated for each entry.
</p><p>
The functions
<tt>hash-keys</tt>,
<tt>hash-values</tt>,
<tt>hash-pairs</tt>,
and
<tt>hash-alist</tt>
also perform an open traversal, because they return
lazy lists. The traversal isn't complete until the returned lazy list
is fully instantiated. In the meanwhile, the
<b>TXR</b> program can mutate the hash table from which the lazy list
is being generated.
</p><p>
Certain hash operations expose access to the internal key-value association
entries of a hash table, which are represented as ordinary
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells. Modifying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of such a cell potentially violates the integrity of the hash table;
the behavior of subsequent lookup and insertion operations becomes unspecif=
ied.
</p><p>
Similarly, if an object is used as a key in an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
hash table, and that object is mutated in such a way that its equality to
other objects under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function is affected or its hash value under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000455E">hash-equa=
l</a></tt>
is altered, the behavior of subsequent lookup and insertion operations on t=
he
becomes unspecified.
</p><p>

<a name=3D"N-026D4158">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.1">9.41.=
1</a> Functions <tt>make-hash</tt> and <tt>hash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-hash </tt><tt><i>weak-keys</i></tt><tt> </tt><tt><i>w=
eak-vals</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
; </tt><tt><i>equal-based</i></tt><tt> [</tt><tt><i>hash-seed</i></tt><tt>]=
)=20




<br>&nbsp;&nbsp;(hash {:weak-keys | :weak-vals |=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :eql-based | :equal-ba=
sed |=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :eq-based | :userdata =
</tt><tt><i>obj</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions construct a new hash table.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026D4158">make-hash=
</a></tt>
takes three mandatory Boolean arguments. The
<tt><i>weak-keys</i></tt>
argument specifies whether the hash table shall have weak keys. The
<tt><i>weak-vals</i></tt>
argument specifies whether it shall have weak values, and
<tt><i>equal-based</i></tt>
specifies whether it is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based.
The hash function defaults
all three of these properties to false, and allows them to be overridden to
true by the presence of keyword arguments.
</p><p>
The optional
<tt><i>hash-seed</i></tt>
parameter must be an integer, if specified. Its value perturbs the hashing
function of the hash table, which affects
<tt>:equal-based</tt>
hash tables, when character strings and buffers are used as keys.
If
<tt><i>hash-seed</i></tt>
is omitted, then the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
variable is used as the seed.
</p><p>
It is an error to attempt to construct an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
hash table which has weak keys.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
function provides an alternative interface. It accepts optional
keyword arguments. The supported keyword symbols are:
<tt>:weak-keys</tt>,
<tt>:weak-vals</tt>,
<tt>:equal-based</tt>,
<tt>:eql-based</tt>
<tt>:eq-based</tt>
and
<tt>:userdata</tt>
which can be specified in any order to turn on the corresponding properties=
 in
the newly constructed hash table.
</p><p>
Only one of
<tt>:equal-based</tt>,
<tt>:eql-based</tt>
and
<tt>:eq-based</tt>
may be specified. If specified, then the hash table uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eq</a></t=
t>
equality, respectively, for considering two keys to be the same key.
If none of these is specified, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
function produces an
<tt>:equal-based</tt>
hash table by default.
</p><p>
If
<tt>:weak-keys</tt>
is specified, then
<tt>:equal-based</tt>
may not be specified.
</p><p>
If
<tt>:userdata</tt>
is present, it must be followed by an argument value; that value
specifies the user data for the hash table, which can be retrieved using th=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>
function.
</p><p>
Note: there doesn't exist a keyword for specifying the seed.
This omission is deliberate. These hash construction keywords may appear in=
 the
hash literal
<tt>#H</tt>
syntax. A seed keyword would allow literals to specify their own seed, whic=
h
would allow malicious hash literals to be crafted that perpetrate a hash
collision attack against the parser.
</p><p>

</p></dd></dl>
<a name=3D"N-017E6F4C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.2">9.41.2</a=
> Functions <tt>hash-construct</tt>, <tt>hash-from-pairs</tt> and <tt>hash-=
from-alist</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-construct </tt><tt><i>hash-args</i></tt><tt> </tt><tt=
><i>key-val-pairs</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-from-pairs </tt><tt><i>key-val-pairs</i></tt><tt> </t=
t><tt><i>hash-arg</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(hash-from-alist </tt><tt><i>alist</i></tt><tt> </tt><tt><i=
>hash-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017E6F4C">hash-cons=
truct</a></tt>
function constructs a populated hash in one step. The
<tt><i>hash-args</i></tt>
argument specifies a list suitable as an argument list in a call to the has=
h
function.  The
<tt><i>key-val-pairs</i></tt>
is a sequence of pairs, which are two-element
lists representing key-value pairs.
</p><p>
A hash is constructed as if by a call to
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> ha=
sh </tt><tt><i>hash-args</i></tt><tt>),=20

</tt>

then populated
with the specified pairs, and returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017E6F4C">hash-from=
-pairs</a></tt>
function is an alternative interface to the same semantics. The
<tt><i>key-val-pairs</i></tt>
argument is first, and the
<tt><i>hash-args</i></tt>
are passed as trailing variadic arguments, rather than a single list argume=
nt.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017E6F4C">hash-from=
-alist</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017E6F4C">hash-from=
-pairs</a></tt>,
except that the
<tt><i>alist</i></tt>
argument specifies they keys and values as an association list.
The elements of the list are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
cells, each of whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
is a key, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is the value.
</p><p>

</p></dd></dl>
<a name=3D"N-02EE9235">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.3">9.41.3</a=
> Function <tt>hash-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-list </tt><tt><i>key-list</i></tt><tt> </tt><tt><i>ha=
sh-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02EE9235">hash-list=
</a></tt>
function constructs a hash as if by a call to
<tt>




[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> ha=
sh </tt><tt><i>hash-args</i></tt><tt>],=20

</tt>

where
<tt><i>hash-args</i></tt>
is a list of the individual
<tt><i>hash-arg</i></tt>
variadic arguments.
</p><p>
The hash is then populated with keys taken from
<tt><i>key-list</i></tt>
and returned.
</p><p>
The value associated with each key is that key itself.
</p><p>

</p></dd></dl>
<a name=3D"N-02767282">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.4">9.41.4</a=
> Function <tt>hash-zip</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-zip </tt><tt><i>key-seq</i></tt><tt> </tt><tt><i>valu=
e-seq</i></tt><tt> </tt><tt><i>hash-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02767282">hash-zip<=
/a></tt>
function constructs a hash as if by a call to
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> ha=
sh </tt><tt><i>hash-args</i></tt><tt>),=20

</tt>

where
<tt><i>hash-args</i></tt>
is a list of the individual
<tt><i>hash-arg</i></tt>
variadic arguments.
</p><p>
The hash is then populated with keys taken from
<tt><i>key-seq</i></tt>
which are paired with values taken from from
<tt><i>value-seq</i></tt>,
and returned.
</p><p>
If
<tt><i>key-seq</i></tt>
is longer than
<tt><i>value-seq</i></tt>,
then the excess keys are ignored, and
<i>vice versa</i>.

</p><p>

</p></dd></dl>
<a name=3D"N-02DBCCC8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.5">9.41.5</a=
> Function <tt>hash-update</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-update </tt><tt><i>hash</i></tt><tt> </tt><tt><i>func=
tion</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DBCCC8">hash-upda=
te</a></tt>
function replaces each value in
<tt><i>hash</i></tt>,
with the value of
<tt><i>function</i></tt>
applied to that value.
</p><p>
The return value is
<tt><i>hash</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03EF9A2C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.6">9.41.6</a=
> Function <tt>hash-update-1</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-update-1 </tt><tt><i>hash</i></tt><tt> </tt><tt><i>ke=
y</i></tt><tt> </tt><tt><i>function</i></tt><tt> [</tt><tt><i>init</i></tt>=
<tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF9A2C">hash-upda=
te-1</a></tt>
function operates on a single entry in the hash table.
</p><p>
If
<tt><i>key</i></tt>
exists in the hash table, then its corresponding value is passed
into
<tt><i>function</i></tt>,
and the return value of
<tt><i>function</i></tt>
is then installed
in place of the key's value. The value is then returned.
</p><p>
If
<tt><i>key</i></tt>
does not exist in the hash table, and no
<tt><i>init</i></tt>
argument is given,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF9A2C">hash-upda=
te-1</a></tt>
does nothing and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>key</i></tt>
does not exist in the hash table, and an
<tt><i>init</i></tt>
argument is given,
then
<tt><i>function</i></tt>
is applied to
<tt><i>init</i></tt>,
and then
<tt><i>key</i></tt>
is inserted into
<tt><i>hash</i></tt>
with the value returned by
<tt><i>function</i></tt>
as the datum. This value
is also returned.
</p><p>

</p></dd></dl>
<a name=3D"N-02F6F229">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.7">9.41.7</a=
> Function <tt>group-by</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(group-by </tt><tt><i>func</i></tt><tt> </tt><tt><i>sequenc=
e</i></tt><tt> </tt><tt><i>option</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6F229">group-by<=
/a></tt>
function produces a hash table from
<tt><i>sequence</i></tt>,
which is a
list or vector. Entries of the hash table are not elements of
<tt><i>sequence</i></tt>,
but lists of elements of
<tt><i>sequence</i></tt>.
The function
<tt><i>func</i></tt>
is applied to
each element of
<tt><i>sequence</i></tt>
to compute a key. That key is used to determine
which list the item is added to in the hash table.
</p><p>
The trailing arguments
<tt>




</tt><tt><i>option</i></tt><tt>*=20

</tt>

if any, consist of the same keywords
that are understood by the hash function, and determine the properties
of the hash.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


Group the integers from 0 to 10 into three buckets keyed on 0, 1 and 2
according to the modulo 3 congruence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
F6F229">group-by</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
068EA9D">op</a> mod @1 3) (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-033BE5A1">range</a> 0 10)))

  -&gt; #H(() (0 (0 3 6 9)) (1 (1 4 7 10)) (2 (2 5 8)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-001A208F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.8">9.41.8</a=
> Function <tt>group-reduce</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(group-reduce </tt><tt><i>hash</i></tt><tt> </tt><tt><i>cla=
ssify-fun</i></tt><tt> </tt><tt><i>binary-fun</i></tt><tt> </tt><tt><i>seq<=
/i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; [</tt><tt><i>init-value</i></tt><tt> [</tt><tt=
><i>filter-fun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001A208F">group-red=
uce</a></tt>
updates hash table
<tt><i>hash</i></tt>
by grouping and reducing sequence
<tt><i>seq</i></tt>.
</p><p>
The function regards the hash table as being populated with
keys denoting accumulator values. Missing accumulators which
need to be created in the hash table are initialized with
<tt><i>init-value</i></tt>
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The function iterates over
<tt><i>seq</i></tt>
and treats each element according to the following steps:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
Each element is mapped to a hash key through
<tt><i>classify-fun</i></tt>.
</dd><dt>2.</dt><dd>
The value associated with the hash key (the accumulator for that
key) is retrieved. If it doesn't exist,
<tt><i>init-value</i></tt>
is used.
</dd><dt>3.</dt><dd>
The function
<tt><i>binary-fun</i></tt>
is invoked with two arguments: the accumulator from step 2, and the
original element from
<tt><i>seq</i></tt>.
</dd><dt>4.</dt><dd>
The resulting value from step 3 is stored back into the hash table under th=
e
key from step 2.
</dd></dl>
</dl>
<p>

After the above processing, one more step is performed if the
<tt><i>filter-fun</i></tt>
argument is present. In this case, the hash table is destructively mapped t=
hrough
<tt><i>filter-fun</i></tt>
before being returned. That is to say, every value in the hash table is
projected through
<tt><i>filter-fun</i></tt>
and stored back in the table under the same key, as if by an invocation the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DBCCC8">hash-update<=
/a> </tt><tt><i>hash</i></tt><tt> </tt><tt><i>filter-fun</i></tt><tt>)=20

</tt>

expression.
</p><p>

If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001A208F">group-red=
uce</a></tt>
is invoked on an empty hash table, its net result closely resembles a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6F229">group-by<=
/a></tt>
operation followed by separately performing a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-le=
ft</a></tt>
on each value in the hash.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
Frequency histogram:
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
1A208F">group-reduce</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-0001">hash</a>) identity (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#D-0061">do</a> inc @1)
    "fourscoreandsevenyearsago" 0]
  --&gt; #H(() (#\a 3) (#\c 1) (#\d 1) (#\e 4) (#\f 1)
        (#\g 1) (#\n 2) (#\o 3) (#\r 3) (#\s 3)
        (#\u 1) (#\v 1) (#\y 1))
</tt></pre><tt>

</tt>

<p>
Separate the integers 1-10 into even and odd, and sum these groups:
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
1A208F">group-reduce</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-0001">hash</a>) evenp + (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-033BE5A1">range</a> 1 10) 0]
  -&gt; #H(() (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8=
">t</a> 30) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">=
nil</a> 25))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-030E3A4A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.9">9.41.9</a=
> Functions <tt>make-similar-hash</tt> and <tt>copy-hash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-similar-hash </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(copy-hash </tt><tt><i>hash</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">make-simi=
lar-hash</a></tt>
and copy-hash functions create a new hash object based on
the existing
<tt><i>hash</i></tt>
object.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">make-simi=
lar-hash</a></tt>
produces an empty hash table which inherits all of the
attributes of
<tt><i>hash</i></tt>.
It uses the same kind of key equality, the
same configuration of weak keys and values, and has the same user data (see
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030B40A7">set-hash-=
userdata</a></tt>
function).
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">copy-hash=
</a></tt>
also produces a hash table similar to
<tt><i>hash</i></tt>,
in the same way as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">make-simi=
lar-hash</a></tt>.
However, rather than producing producing an empty hash table, it returns a
duplicate table which has all the same elements as
<tt><i>hash</i></tt>:
it contains the same key and value objects.
</p><p>

</p></dd></dl>
<a name=3D"N-0161147E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.10">9.41.10<=
/a> Function <tt>inhash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(inhash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i></=
tt><tt> [</tt><tt><i>init</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0161147E">inhash</a=
></tt>
function searches hash table
<tt><i>hash</i></tt>
for
<tt><i>key</i></tt>.
If
<tt><i>key</i></tt>
is found, then it return the hash table's cons cell which
represents the association between
<tt><i>hash</i></tt>
and
<tt><i>key</i></tt>.
Otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If argument
<tt><i>init</i></tt>
is specified, then the function will create
an entry for
<tt><i>key</i></tt>
in
<tt><i>hash</i></tt>
whose value is that of
<tt><i>init</i></tt>.
The cons cell representing that association is returned.
</p><p>
Note: for as long as the
<tt><i>key</i></tt>
continues to exist inside
<tt><i>hash</i></tt>.
modifying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of the returned cons has ramifications for the logical integrity of
the hash; doing so results in unspecified behavior for subsequent
insertion and lookup operations.
</p><p>
Modifying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field has the effect of updating the association with a new value.
</p><p>

</p></dd></dl>
<a name=3D"N-0203B5FA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.11">9.41.11<=
/a> Accessor <tt>gethash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(gethash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i><=
/tt><tt> [</tt><tt><i>alt</i></tt><tt>])=20




<br>&nbsp;&nbsp;(set (gethash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key=
</i></tt><tt> [</tt><tt><i>alt</i></tt><tt>]) </tt><tt><i>new-value</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5FA">gethash</=
a></tt>
function searches hash table
<tt><i>hash</i></tt>
for key
<tt><i>key</i></tt>.
If the
key is found then the associated value is returned. Otherwise, if
the
<tt><i>alt</i></tt>
argument was specified, it is returned. If the
<tt><i>alt</i></tt>
argument
was not specified,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
A valid
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5FA">gethash</=
a></tt>
form serves as a place. It denotes either an existing value in a hash
table or a value that would be created by the evaluation of the form.
The
<tt><i>alt</i></tt>
argument is meaningful when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5FA">gethash</=
a></tt>
is used as a place, and, if present, is always evaluated whenever the place=
 is
evaluated.
In place update operations, it provides the initial value, which defaults
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the argument is not specified. For example
<tt>(inc (gethash h k d))</tt>
will increment the value stored under key
<tt>k</tt>
in hash table
<tt>h</tt>
by one. If the key does not exist in the hash table, then
the value
<tt>(+ 1 d)</tt>
is inserted into the table under that key.
The expression
<tt>d</tt>
is always evaluated, whether or not its value is needed.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0203B5FA">gethash</=
a></tt>
place is subject to a deletion, but doesn't exist, it is not an error.
The operation does nothing, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is considered the prior value of the place yielded
by the deletion.
</p><p>

</p></dd></dl>
<a name=3D"N-0025A17A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.12">9.41.12<=
/a> Function <tt>sethash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sethash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i><=
/tt><tt> </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0025A17A">sethash</=
a></tt>
function places a value into
<tt><i>hash</i></tt>
table under the given
<tt><i>key</i></tt>.
If a similar key already exists in the hash table, then that key's
value is replaced by
<tt><i>value</i></tt>.
Otherwise, the
<tt><i>key</i></tt>
and
<tt><i>value</i></tt>
pair is
newly inserted into
<tt><i>hash</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0025A17A">sethash</=
a></tt>
function returns the
<tt><i>value</i></tt>
argument.
</p><p>

</p></dd></dl>
<a name=3D"N-022660B2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.13">9.41.13<=
/a> Function <tt>pushhash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pushhash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i>=
</tt><tt> </tt><tt><i>element</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022660B2">pushhash<=
/a></tt>
function is useful when the values stored in a hash table
are lists.  If the given
<tt><i>key</i></tt>
does not already exist in
<tt><i>hash</i></tt>,
then a list of
length one is made which contains
<tt><i>element</i></tt>,
and stored in
<tt><i>hash</i></tt>
table under
<tt><i>key</i></tt>.
If the
<tt><i>key</i></tt>
already exists in the hash table, then the corresponding
value must be a list. The
<tt><i>element</i></tt>
value is added to the front of that list,
and the extended list then becomes the new value under
<tt><i>key</i></tt>.
</p><p>
The return value is Boolean. If true, indicates that the hash table entry w=
as
newly created. If false, it indicates that the push took place on an existi=
ng
entry.
</p><p>

</p></dd></dl>
<a name=3D"N-0029C57A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.14">9.41.14<=
/a> Function <tt>remhash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(remhash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>key</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0029C57A">remhash</=
a></tt>
function searches
<tt><i>hash</i></tt>
for a key similar to the
<tt><i>key</i></tt>.
If that key is found, then that key and its corresponding value are
removed from the hash table.
</p><p>
If the key is found and removal takes place, then the associated value
is returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-00836D97">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.15">9.41.15<=
/a> Function <tt>clearhash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(clearhash </tt><tt><i>hash</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00836D97">clearhash=
</a></tt>
function removes all keys-value pairs from
<tt><i>hash</i></tt>,
causing it to be empty.
</p><p>
If
<tt><i>hash</i></tt>
is already empty prior to the operation, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
is returned.
</p><p>
Otherwise an integer is returned indicating the number of entries
that were purged from
<tt><i>hash</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00766C80">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.16">9.41.16<=
/a> Function <tt>hash-count</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-count </tt><tt><i>hash</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00766C80">hash-coun=
t</a></tt>
function returns an integer representing the number of
key-value pairs stored in
<tt><i>hash</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-038C1CEB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.17">9.41.17<=
/a> Accessor <tt>hash-userdata</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-userdata </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (hash-userdata </tt><tt><i>hash</i></tt><tt>) </tt><tt=
><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>
function retrieves the user data object associated with
<tt><i>hash</i></tt>.
</p><p>
A hash table can be created with user data using the
<tt>:userdata</tt>
keyword in a hash table literal or in a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
function, directly, or via other hash-constructing functions which take the
hash construction keywords, such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6F229">group-by<=
/a></tt>.
If a hash table is created without user data, its user
data is initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>
is an accessor, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>
form can be used as a place. Assigning a value to this place
causes the user data of
<tt><i>hash</i></tt>
to be replaced with that value.
</p><p>

</p></dd></dl>
<a name=3D"N-030B41A7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.18">9.41.18<=
/a> Function <tt>get-hash-userdata</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-hash-userdata </tt><tt><i>hash</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030B41A7">get-hash-=
userdata</a></tt>
function is a deprecated synonym for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038C1CEB">hash-user=
data</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-030B40A7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.19">9.41.19<=
/a> Function <tt>set-hash-userdata</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(set-hash-userdata </tt><tt><i>hash</i></tt><tt> </tt><tt><=
i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030B40A7">set-hash-=
userdata</a></tt>
replaces, with the
<tt><i>object</i></tt>,
the user data object
associated with
<tt><i>hash</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00B947EC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.20">9.41.20<=
/a> Function <tt>hashp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hashp </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B947EC">hashp</a>=
</tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the
<tt><i>object</i></tt>
is a hash table,
otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03E6917D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.21">9.41.21<=
/a> Function <tt>maphash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(maphash </tt><tt><i>hash</i></tt><tt> </tt><tt><i>binary-f=
unction</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E6917D">maphash</=
a></tt>
function successively invokes
<tt><i>binary-function</i></tt>
for each entry stored in
<tt><i>hash</i></tt>.
Each entry's key and value are passed as arguments
to
<tt>binary-function</tt>.
</p><p>
The function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02FBE776">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.22">9.41.22<=
/a> Functions <tt>hash-revget</tt> and <tt>hash-keys-of</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-revget </tt><tt><i>hash</i></tt><tt> </tt><tt><i>valu=
e</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></t=
t><tt>]])=20




<br>&nbsp;&nbsp;(hash-keys-of </tt><tt><i>hash</i></tt><tt> </tt><tt><i>val=
ue</i></tt><tt> [</tt><tt><i>testfun</i></tt><tt> [</tt><tt><i>keyfun</i></=
tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBE776">hash-revg=
et</a></tt>
function performs a reverse lookup on
<tt><i>hash</i></tt>.
</p><p>
It searches through the entries stored in
<tt><i>hash</i></tt>
for an entry whose value matches
<tt><i>value</i></tt>.
</p><p>
If such an entry is found, that entry's key is returned.
Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
If multiple matching entries exist, it is not specified which entry's
key is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBE776">hash-keys=
-of</a></tt>
function has exactly the same argument conventions, and likewise
searches the
<tt><i>hash</i></tt>.
However, it returns a list of all keys whose values match
<tt><i>value</i></tt>.
</p><p>
The
<tt><i>keyfun</i></tt>
function is applied to each value in
<tt><i>hash</i></tt>
and the resulting value is compared with
<tt><i>value</i></tt>.
The default
<tt><i>keyfun</i></tt>
is the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function.
</p><p>
The comparison is performed using
<tt><i>testfun</i></tt>.
</p><p>
The default
<tt><i>testfun</i></tt>
is the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-01D4F138">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.23">9.41.23<=
/a> Function <tt>hash-invert</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-invert </tt><tt><i>hash</i></tt><tt> [</tt><tt><i>joi=
nfun</i></tt><tt> [</tt><tt><i>unitfun</i></tt><tt> </tt><tt><i>hash-arg</i=
></tt><tt>*]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D4F138">hash-inve=
rt</a></tt>
function calculates and returns an inversion of hash table
<tt><i>hash</i></tt>.
The values in
<tt><i>hash</i></tt>
become keys in the returned hash table. Conversely, the values
in the returned hash table are derived from the keys.
</p><p>
The optional
<tt><i>joinfun</i></tt>
and
<tt><i>unitfun</i></tt>
arguments must be functions, if they are given.
These functions determine the behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D4F138">hash-inve=
rt</a></tt>
with regard to duplicate values in
<tt><i>hash</i></tt>
which turn into duplicate keys.
The
<tt><i>joinfun</i></tt>
function must be callable with two arguments, and
<tt><i>joinfun</i></tt>
must accept one argument.
If
<tt><i>joinfun</i></tt>
is omitted, it defaults to the
<tt>identity*</tt>
function;
<tt><i>unitfun</i></tt>
defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D4F138">hash-inve=
rt</a></tt>
function constructs a hash table as if by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
function, passing the
<tt><i>hash-arg</i></tt>
arguments which determine the properties of the newly created hash.
</p><p>
The new hash table is then populated by iterating over the key-value pairs =
of
<tt><i>hash</i></tt>
and inserting them as follows:
The key from
<tt><i>hash</i></tt>
is turned into a value
<tt><i>v1</i></tt>
by invoking the
<tt><i>unitfun</i></tt>
function on it, and taking the return value.
The value from
<tt><i>hash</i></tt>
is used as a key to perform a lookup in the new hash table.
If no entry exists, then a new entry is created, whose value is
<tt><i>v1</i></tt>.
Otherwise if the entry already exists, then the value
<tt><i>v0</i></tt>
of that entry is combined with
<tt><i>v1</i></tt>
by calling the
<tt><i>joinfun</i></tt>
on the arguments
<tt><i>v0</i></tt>
and
<tt><i>v1</i></tt>.
The entry is updated with the resulting value.
</p><p>
The new hash table is then returned.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Invert simple 1 to 1 table:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D4F138">hash-inver=
t</a> #H(() (a 1) (b 2) (c 3)))
  --&gt; #H(() (1 a) (2 b) (3 c))

  ;; Invert table such that the keys of duplicate values
  ;; are accumulated into lists:

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D4F138">hash-inver=
t</a> #H(() (1 a) (2 a) (3 c) (5 c) (7 d)) append list]
  --&gt; #H(() (d (7)) (c (3 5)) (a (1 2)))

  ;; Invert table such that keys of duplicate values are summed:

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D4F138">hash-inver=
t</a> #H(() (1 a) (2 a) (3 c) (5 c) (7 d)) +]
  --&gt; #H(() (d 7) (c 8) (a 3))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0000455E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.24">9.41.24<=
/a> Functions <tt>hash-eql</tt> and <tt>hash-equal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-eql </tt><tt><i>object</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-equal </tt><tt><i>object</i></tt><tt> [</tt><tt><i>ha=
sh-seed</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions each compute an integer hash value from the internal
representation of
<tt><i>object</i></tt>,
which satisfies the following properties.
If two objects
<tt>A</tt>
and
<tt>B</tt>
are the same under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
function, then
<tt>(hash-eql A)</tt>
and
<tt>(hash-eql B)</tt>
produce the same integer hash value.  Similarly,
if two objects
<tt>A</tt>
and
<tt>B</tt>
are the same under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function, then
<tt>(hash-equal A)</tt>
and
<tt>(hash-equal B)</tt>
each produce the same integer hash value.  In all other
circumstances, the hash values of two distinct objects are unrelated, and
may or may not be the same.
</p><p>
Object of struct type may support custom hashing by way of defining
an equality substitution via an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
method. See the Equality Substitution section under Structures.
</p><p>
The optional
<tt><i>hash-seed</i></tt>
value perturbs the hashing function used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000455E">hash-equa=
l</a></tt>
for strings and buffer objects.  This seed value must be a non-negative int=
eger
no wider than 32 bits: that is, in the range 0 to 4294967295.
If the value isn't specified, it defaults to zero.
Effectively, each possible value of the seed specifies a different hashing
function. If two objects
<tt>A</tt>
and
<tt>B</tt>
are the same under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function, then
<tt>(hash-equal A S)</tt>
and
<tt>(hash-equal B S)</tt>
each produce the same integer hash value for any valid seed value
<tt>S</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01BD56A5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.25">9.41.25<=
/a> Functions <tt>hash_keys</tt>, <tt>hash_values</tt>, <tt>hash_pairs</tt>=
 and <tt>hash_alist</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-keys </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-values </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-pairs </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-alist </tt><tt><i>hash</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions retrieve the bulk key-value data of hash table
<tt><i>hash</i></tt>
in various ways.
<tt>hash-keys</tt>
retrieves a list of the keys.
<tt>hash-values</tt>
retrieves a list of the values.
<tt>hash-pairs</tt>
retrieves a list of pairs,
which are two-element lists consisting of the key, followed by the value.
Finally,
<tt>hash-alist</tt>
retrieves the key-value pairs as a Lisp association list:
a list of cons cells whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields are keys, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields are the values. Note that
<tt>hash-alist</tt>
returns the actual entries from the hash table, which are
conses. Modifying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
fields of these conses constitutes modifying the hash values
in the original hash table. Modifying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
fields interferes with the integrity of the hash table,
resulting in unspecified behavior for subsequent hash insertion
and lookup operations.
</p><p>
These functions all retrieve the keys and values in the
same order. For example, if the keys are retrieved with
<tt>hash-keys</tt>,
and the values with
<tt>hash-values</tt>,
then the corresponding entries from
each list pairwise correspond to the pairs in
<tt><i>hash</i></tt>.
</p><p>
The list returned by each of these functions is lazy, and hence constitutes
an open traversal of the hash table.
</p><p>

</p></dd></dl>
<a name=3D"N-039105E8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.26">9.41.26<=
/a> Operator <tt>dohash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dohash (</tt><tt><i>key-var</i></tt><tt> </tt><tt><i>value=
-var</i></tt><tt> </tt><tt><i>hash-form</i></tt><tt> [</tt><tt><i>result-fo=
rm</i></tt><tt>])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039105E8">dohash</a=
></tt>
operator iterates over a hash table. The
<tt><i>hash-form</i></tt>
expression must
evaluate to an object of hash table type. The
<tt><i>key-var</i></tt>
and
<tt><i>value-var</i></tt>
arguments must be symbols suitable for use as variable names.
Bindings are established for these variables over the scope of the
<tt><i>body-form</i></tt>-s
and the optional
<tt><i>result-form</i></tt>.
</p><p>
For each element in the hash table, the
<tt><i>key-var</i></tt>
and
<tt><i>value-var</i></tt>
variables are set to the key and value of that entry, respectively,
and each
<tt><i>body-form</i></tt>,
if there are any, is evaluated.
</p><p>
When all of the entries of the table are thus processed, the
<tt><i>result-form</i></tt>
is evaluated, and its return value becomes the return value of the dohash f=
orm.
If there is no
<tt><i>result-form</i></tt>,
the return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>result-form</i></tt>
and
<tt><i>body-form</i></tt>-s
are in the scope of an implicit anonymous
block, which means that it is possible to terminate the execution of
dohash early using
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return</a> <=
/tt><tt><i>value</i></tt><tt>)=20

</tt>

or
<tt>(return)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02235BB2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.27">9.41.27<=
/a> Functions <tt>hash-uni</tt>, <tt>hash-diff</tt>, <tt>hash-symdiff</tt> =
and <tt>hash-isec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-uni </tt><tt><i>hash1</i></tt><tt> </tt><tt><i>hash2
 &gt;&gt; [ joinfun &gt;&gt; [ map1fun &lt;&gt; [ map2fun ]]])</i></tt><tt>=
=20




<br>&nbsp;&nbsp;(hash-diff </tt><tt><i>hash1</i></tt><tt> </tt><tt><i>hash2=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-symdiff </tt><tt><i>hash1</i></tt><tt> </tt><tt><i>ha=
sh2</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-isec </tt><tt><i>hash1</i></tt><tt> </tt><tt><i>hash2=
</i></tt><tt> [</tt><tt><i>joinfun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions perform basic set operations on hash tables in a nondestruc=
tive
way, returning a new hash table without altering the inputs. The arguments
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>
must be compatible hash tables.  This means that their keys
must use the same kind of equality.
</p><p>
The resulting hash table inherits attributes from
<tt><i>hash1</i></tt>,
as if created by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">make-simi=
lar-hash</a></tt>
function. If
<tt><i>hash1</i></tt>
has userdata, the resulting hash table
has the same userdata. If
<tt><i>hash1</i></tt>
has weak keys, the resulting table has weak
keys, and so forth.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-uni<=
/a></tt>
function performs a set union. The resulting hash contains all of
the keys from
<tt><i>hash1</i></tt>
and all of the keys from
<tt><i>hash2</i></tt>,
and their corresponding
values.  If a key occurs both in
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>,
then it occurs only once
in the resulting hash. In this case, if the
<tt><i>joinfun</i></tt>
argument is not given,
the value associated with this key is the one from
<tt><i>hash1</i></tt>.
If
<tt><i>joinfun</i></tt>
is specified then it is called with two arguments: the respective
data items from
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>.
The return value of this function is used
as the value in the union hash.
If
<tt><i>map1fun</i></tt>
is specified it must be a function that can be called with one
argument. All values from
<tt><i>hash1</i></tt>
are projected through this function: the function is applied
to each value, and the function's return value is used
in place of the original value.
Similarly, if
<tt><i>map2fun</i></tt>
is present, specifies a function through which values from
<tt><i>hash2</i></tt>
are projected.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-diff=
</a></tt>
function performs a set difference. First, a copy of
<tt><i>hash1</i></tt>
is made as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030E3A4A">copy-hash=
</a></tt>
function. Then from this copy, all keys which occur
in
<tt>hash2</tt>
are deleted.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-symd=
iff</a></tt>
function performs a symmetric difference. A new hash is returned which
contains all of the keys from
<tt><i>hash1</i></tt>
that are not in
<tt><i>hash2</i></tt>
and
<i>vice versa</i>:

all of the keys from
<tt><i>hash2</i></tt>
that are not in
<tt><i>hash1</i></tt>.
The keys carry their corresponding values from
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>,
respectively.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02235BB2">hash-isec=
</a></tt>
function performs a set intersection. The resulting hash contains
only those keys which occur both in
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>.
If
<tt><i>joinfun</i></tt>
is not
specified, the values selected for these common keys are those from
<tt><i>hash1</i></tt>.
If
<tt><i>joinfun</i></tt>
is specified, then for each key which occurs in both
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>,
it is called with two arguments: the respective data items. The return
value is then used as the data item in the intersection hash.
</p><p>

</p></dd></dl>
<a name=3D"N-024ACBBB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.28">9.41.28<=
/a> Functions <tt>hash-subset</tt> and <tt>hash-proper-subset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-subset </tt><tt><i>hash1</i></tt><tt> </tt><tt><i>has=
h2</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-proper-subset </tt><tt><i>hash1</i></tt><tt> </tt><tt=
><i>hash2</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024ACBBB">hash-subs=
et</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the keys in
<tt><i>hash1</i></tt>
are a subset of the keys in
<tt><i>hash2</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024ACBBB">hash-prop=
er-subset</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the keys in
<tt><i>hash1</i></tt>
are a proper subset of the keys in
<tt><i>hash2</i></tt>.
This means that
<tt><i>hash2</i></tt>
has all the keys which are in
<tt><i>hash1</i></tt>
and at least one which isn't.
</p><p>
Note: the return value may not be mathematically meaningful if
<tt><i>hash1</i></tt>
and
<tt><i>hash2</i></tt>
use different equality. In any case, the actual behavior
may be understood as follows. The implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024ACBBB">hash-subs=
et</a></tt>
tests whether each of the keys in
<tt><i>hash1</i></tt>
occurs in
<tt><i>hash2</i></tt>
using their respective equalities.
The implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024ACBBB">hash-prop=
er-subset</a></tt>
applies
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024ACBBB">hash-subs=
et</a></tt>
first, as above. If that is true, and the two hashes have the same number o=
f
elements, the result is falsified.
</p><p>

</p></dd></dl>
<a name=3D"N-0225209D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.29">9.41.29<=
/a> Functions <tt>hash-begin</tt>, <tt>hash-reset</tt>, <tt>hash-next</tt> =
and <tt>hash-peek</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(hash-begin </tt><tt><i>hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-reset </tt><tt><i>hash-iter</i></tt><tt> </tt><tt><i>=
hash</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-next </tt><tt><i>hash-iter</i></tt><tt>)=20




<br>&nbsp;&nbsp;(hash-peek </tt><tt><i>hash-iter</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-begi=
n</a></tt>
function returns a an iterator object capable of retrieving the
entries in stored in
<tt><i>hash</i></tt>
one by one.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-rese=
t</a></tt>
function changes the state of an existing iterator, such that it
becomes prepared to retrieve the entries stored in the newly given
<tt><i>hash</i></tt>,
which may be the same one as the previously associated hash.
In addition,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-rese=
t</a></tt>
may be given a
<tt><i>hash</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
which dissociates it from its hash table.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-next=
</a></tt>
function's
<tt><i>hash-iter</i></tt>
argument is a hash iterator returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-begi=
n</a></tt>.
If unvisited entries remain in
<tt><i>hash</i></tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-next=
</a></tt>
returns the next one as a cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
holds the key and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
holds the value. That entry is then considered visited by the iterator.
If no more entries remain to be visited,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-next=
</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-next=
</a></tt>
function also returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if the iterator has been dissociated from a hash table by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-rese=
t</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-peek=
</a></tt>
function returns the same value that a subsequent call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225209D">hash-next=
</a></tt>
will return for the same
<tt><i>hash-iter</i></tt>,
without changing the state of
<tt><i>hash-iter</i></tt>.
That is to say, if a cell representing a hash entry is returned, that entry
remains unvisited by the iterator.
</p><p>

</p></dd></dl>
<a name=3D"N-001B79C0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.30">9.41.30<=
/a> Macro <tt>with-hash-iter</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-hash-iter (</tt><tt><i>isym</i></tt><tt> </tt><tt><i>=
hash-form</i></tt><tt> [</tt><tt><i>ksym</i></tt><tt> [</tt><tt><i>vsym</i>=
</tt><tt>]])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001B79C0">with-hash=
-iter</a></tt>
macro evaluates
<tt><i>body-form</i></tt>-s
in an environment in which a lexically scoped function is visible.
</p><p>
The function is named by
<tt><i>isym</i></tt>
which must be a symbol suitable for naming functions with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209307D">flet</a><=
/tt>.
</p><p>
The
<tt><i>hash-form</i></tt>
argument must be a form which evaluates to a hash table object.
</p><p>
Invocations of the function retrieve successive entries of the hash table
as cons cell pairs of keys and values. The function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to indicate no more entries remain.
</p><p>
If either of the
<tt><i>ksym</i></tt>
or
<tt><i>vsym</i></tt>
arguments are present, they must be symbols suitable as variable names. The=
y
are bound as variables visible to
<tt><i>body-form</i></tt>-s,
initialized to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>ksym</i></tt>
is specified, then whenever the function
<tt><i>isym</i></tt>
macro is invoked and retrieves a hash table entry, the
<tt><i>ksym</i></tt>
variable is set to the key. If the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then the value of
<tt><i>ksym</i></tt>
is set to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Similarly, if
<tt><i>vsym</i></tt>
is specified, then the function stores the retrieved
hash value in that variable, or else sets the variable
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there is no next value.
</p><p>

</p></dd></dl>
<a name=3D"N-0041D85A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.31">9.41.31<=
/a> Special variable <tt>*hash-seed*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
special variable is initialized with a value of zero. Whenever a new
hash table is explicitly or implicitly created, it takes its seed from
the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
variable in the current dynamic environment.
</p><p>
The only situation in which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
is not used when creating a new hash table is when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026D4158">make-hash=
</a></tt>
is called with an argument given for the optional
<tt><i>hash-seed</i></tt>
argument.
</p><p>
Only
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
hash tables make use of their seed, and only for keys which are strings and
buffers.  The purpose of the seed is to scramble the hashing function, to m=
ake
a hash table resistant to a type of denial-of-service attack, whereby a
malicious input causes a hash table to be populated with a large number of =
keys
which all map to the same hash table chain, causing the performance to seve=
rely
degrade.
</p><p>
The value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
must be a non-negative integer, no wider than 32 bits.
</p><p>

</p></dd></dl>
<a name=3D"N-002CFA72">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.41.32">9.41.32<=
/a> Function <tt>gen-hash-seed</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(gen-hash-seed)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002CFA72">gen-hash-=
seed</a></tt>
function returns an integer value suitable for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041D85A">*hash-see=
d*</a></tt>
variable, or as the
<tt>hash-seed</tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026D4158">make-hash=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000455E">hash-equa=
l</a></tt>
functions.
</p><p>
The value is derived from the host environment, from information such
as the process ID and time of day.
</p><p>
</p></dd></dl>
<a name=3D"N-00E1FEB3">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42">9.42</a> Se=
arch Tree Library</h3>



<p>


</p><p>
<b>TXR Lisp</b> provides binary search trees, which are objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
Trees have a printed notation denoted by the
<tt>#T</tt>
prefix. A tree may be constructed by invoking the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>
function.
</p><p>
Binary search trees differ from hashes in that they maintain items in
order. They also differ from hashes in that they store only elements,
not key-value pairs. Every tree is associated with three
<i>key abstraction functions</i>:

It has a
<i>key function</i>

which is applied to the elements to map each one to a key.
It also has a
<i>less function</i>

and
<i>equal function</i>

for comparing keys.
</p><p>
If these three functions are not specified, they respectively default to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
which means that the tree uses its elements as keys directly, and
that they are compared using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
Note: these default functions work for simple elements such as character
strings or numbers, and also structures implementing
<i>equality substitution</i>.

</p><p>
The elements are stored inside a tree using tree nodes, which are objects
of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>,
whose printed notation is introduced by the
<tt>#N</tt>
prefix.
</p><p>
Several tree-related functions take
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
objects as arguments or return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
objects.
</p><p>

<a name=3D"N-0008DDFB">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.1">9.42.=
1</a> Function <tt>tnode</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tnode </tt><tt><i>key</i></tt><tt> </tt><tt><i>left</i></t=
t><tt> </tt><tt><i>right)</i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
function allocates, initializes and returns a single tree node.
A tree node has three fields
<tt><i>key</i></tt>,
<tt><i>left</i></tt>
and
<tt><i>right</i></tt>,
which are accessed using the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">left</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">right</a>=
</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00D8534F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.2">9.42.2</a=
> Function <tt>tnodep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tnodep </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D8534F">tnodep</a=
></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>value</i></tt>
is a tree node. Otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-020D5C1D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.3">9.42.3</a=
> Accessors <tt>key</tt>, <tt>left</tt> and <tt>right</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(key </tt><tt><i>node</i></tt><tt>)=20




<br>&nbsp;&nbsp;(left </tt><tt><i>node</i></tt><tt>)=20




<br>&nbsp;&nbsp;(right </tt><tt><i>node</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (car </tt><tt><i>object</i></tt><tt>) </tt><tt><i>new-=
value</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (key </tt><tt><i>node</i></tt><tt>) </tt><tt><i>new-ke=
y</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (left </tt><tt><i>node</i></tt><tt>) </tt><tt><i>new-l=
eft</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (right </tt><tt><i>node</i></tt><tt>) </tt><tt><i>new-=
right</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">left</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">right</a>=
</tt>
functions retrieve the corresponding fields of the
<tt><i>node</i></tt>
object, which must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>.
</p><p>
Forms based on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">left</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">right</a>=
</tt>
symbol are defined as syntactic places.
Assigning a value
<tt>v</tt>
to
<tt>(key n)</tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a></tt>
operator, as in
<tt>(set (key n) v)</tt>,
is equivalent to
<tt>(set-key n v)</tt>
except that the value of the expression is
<tt>v</tt>
rather than
<tt>n</tt>.
Similar statements hold true for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">left</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">right</a>=
</tt>
in relation to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7D05">set-left<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7D05">set-right=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-033F7D05">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.4">9.42.4</a=
> Functions <tt>set-key</tt>, <tt>set-left</tt> and <tt>set-right</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(set-key </tt><tt><i>node</i></tt><tt> </tt><tt><i>new-key<=
/i></tt><tt>)=20




<br>&nbsp;&nbsp;(set-left </tt><tt><i>node</i></tt><tt> </tt><tt><i>new-lef=
t</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set-right </tt><tt><i>node</i></tt><tt> </tt><tt><i>new-ri=
ght</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7D05">set-key</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7D05">set-left<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7D05">set-right=
</a></tt>
functions replace the corresponding fields of
<tt><i>node</i></tt>
with new values.
</p><p>
The
<tt><i>node</i></tt>
argument must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>.
</p><p>
These functions all return
<tt><i>node</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-018A17C0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.5">9.42.5</a=
> Function <tt>copy-tnode</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-tnode </tt><tt><i>node</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018A17C0">copy-tnod=
e</a></tt>
function creates a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
objects, whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">left</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">right</a>=
</tt>
fields are copied from
<tt>node</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02F6D50B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.6">9.42.6</a=
> Function <tt>tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree [</tt><tt><i>elems</i></tt><tt> [</tt><tt><i>keyfun</=
i></tt><tt> [</tt><tt><i>lessfun</i></tt><tt> [</tt><tt><i>equalfun</i></tt=
><tt>]]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>
function constructs and returns a new tree object. All arguments are option=
al.
</p><p>
The
<tt><i>elems</i></tt>
argument specifies a sequence of the elements to be stored in the tree.
If the argument is absent or the sequence is empty, then an empty
tree is created.
</p><p>
The
<tt><i>keyfun</i></tt>
argument specifies the function which is applied to every element
to produce a key. If omitted, the the tree object shall behave as if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
function were used, taking the elements themselves to be keys.
</p><p>
The
<tt><i>lessfun</i></tt>
argument specifies the function by which two keys are compared for
inequality. If omitted, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function is used. A function used as
<tt><i>lessfun</i></tt>
should take two arguments, produce a Boolean result, and have ordering
properties similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
function.
</p><p>
The
<tt><i>equalfun</i></tt>
argument specifies the function by which two keys are compared for
equality. The default value is the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function. A function used as
<tt><i>equalfun</i></tt>
should take two arguments, produce a Boolean result, and have the
properties of an equivalence relation.
</p><p>
These three functions are collectively referred to as the tree's
<i>key abstraction functions</i>.

</p><p>

</p></dd></dl>
<a name=3D"N-03B8E442">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.7">9.42.7</a=
> Function <tt>treep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(treep </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B8E442">treep</a>=
</tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>value</i></tt>
is a tree. Otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-008B4AD9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.8">9.42.8</a=
> Function <tt>tree-insert-node</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-insert-node </tt><tt><i>tree</i></tt><tt> </tt><tt><i=
>node</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001E">tree-insert-n=
ode</a></tt>
function inserts an existing
<tt><i>node</i></tt>
object into a search tree.
</p><p>
The
<tt><i>tree</i></tt>
object must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>,
and
<tt><i>node</i></tt>
must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>
field of the
<tt><i>node</i></tt>
object holds the element that is being inserted. The actual search key
which is associated with this element is determined by applying
<tt><i>tree</i></tt>'s
<tt><i>keyfun</i></tt>
to the the
<tt><i>node</i></tt>'s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a></=
tt>
value.
</p><p>
The
<tt><i>node</i></tt>
object must not currently be inserted into any existing tree.
The values stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">left</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">right</a>=
</tt>
fields of
<tt><i>node</i></tt>
are overwritten as required by the semantics of the insertion operation.
Their original values are ignored.
</p><p>
If
<tt><i>tree</i></tt>
already contains node with with a matching key, then
<tt><i>node</i></tt>
replaces that node; that node is deleted from the tree.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001E">tree-insert-n=
ode</a></tt>
function returns the
<tt><i>node</i></tt>
argument.
</p><p>

</p></dd></dl>
<a name=3D"N-034ADC20">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.9">9.42.9</a=
> Function <tt>tree-insert-node</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-insert </tt><tt><i>tree</i></tt><tt> </tt><tt><i>elem=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>tree-insert</tt>
function inserts
<tt><i>elem</i></tt>
into
<tt><i>tree</i></tt>.
</p><p>
The
<tt><i>tree</i></tt>
argument must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
</p><p>
The
<tt><i>elem</i></tt>
value may be of any type which is semantically compatible with
<tt><i>tree</i></tt>'s
key abstraction functions.
</p><p>
The
<tt>tree-insert</tt>
function allocates a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
as if by invoking
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a> </=
tt><tt><i>elem</i></tt><tt> nil nil)=20

</tt>

function, and inserts that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
as if by using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001E">tree-insert-n=
ode</a></tt>
function.
</p><p>
The
<tt>tree-insert</tt>
function returns the newly inserted
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008DDFB">tnode</a>=
</tt>
object.
</p><p>

</p></dd></dl>
<a name=3D"N-03FE4877">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.10">9.42.10<=
/a> Function <tt>tree-lookup-node</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-lookup-node </tt><tt><i>tree</i></tt><tt> </tt><tt><i=
>key</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE4877">tree-look=
up-node</a></tt>
searches
<tt><i>tree</i></tt>
for an element which matches
<tt><i>key</i></tt>.
</p><p>
The
<tt><i>tree</i></tt>
argument must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
</p><p>
The
<tt><i>key</i></tt>
argument may be a value of any type.
</p><p>
An element inside
<tt><i>tree</i></tt>
matches
<tt><i>key</i></tt>
if the tree's
<tt><i>keyfun</i></tt>
applied to that element produces a key value which is equal to
<tt><i>key</i></tt>
under the tree's
<tt><i>equalfun</i></tt>
function.
</p><p>
If such an element is found, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE4877">tree-look=
up-node</a></tt>
returns the tree node which contains that element as its
<tt><i>key</i></tt>
field.
</p><p>
If no such element is found, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE4877">tree-look=
up-node</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01D63E47">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.11">9.42.11<=
/a> Function <tt>tree-lookup</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-lookup </tt><tt><i>tree</i></tt><tt> </tt><tt><i>key<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D63E47">tree-look=
up</a></tt>
function finds an element inside
<tt><i>tree</i></tt>
which matches the given
<tt><i>key</i></tt>.
</p><p>
If the element is found, it is returned. Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
Note: the semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D63E47">tree-look=
up</a></tt>
function can be understood in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE4877">tree-look=
up-node</a></tt>.
A possible implementation is this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> tree-lookup (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-02F6D50B">tree</a> key)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a=
> ((node (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE4877">tre=
e-lookup-node</a> tree key)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a=
> node)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00772FAE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.12">9.42.12<=
/a> Function <tt>tree-delete-node</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-delete-node </tt><tt><i>tree</i></tt><tt> </tt><tt><i=
>key</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00772FAE">tree-dele=
te-node</a></tt>
function searches
<tt><i>tree</i></tt>
for an element which matches
<tt><i>key</i></tt>.
</p><p>
The
<tt><i>tree</i></tt>
argument must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
</p><p>
The
<tt><i>key</i></tt>
argument may be a value of any type which is semantically compatible with
<tt><i>tree</i></tt>'s
key abstraction functions.
</p><p>
If the matching element is found, then its node is removed from
the tree, and returned.
</p><p>
Otherwise, if a matching element is not found, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-022035DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.13">9.42.13<=
/a> Function <tt>tree-delete</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-delete </tt><tt><i>tree</i></tt><tt> </tt><tt><i>key<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022035DF">tree-dele=
te</a></tt>
function tries to removes from
<tt><i>tree</i></tt>
the element which matches
<tt><i>key</i></tt>.
</p><p>
If successful, it returns that element, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: the semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022035DF">tree-dele=
te</a></tt>
function can be understood in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00772FAE">tree-dele=
te-node</a></tt>.
A possible implementation is this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> tree-delete (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-02F6D50B">tree</a> key)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DA21F6">iflet</a=
> ((node (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00772FAE">tre=
e-delete-node</a> tree key)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">key</a=
> node)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0149BF2D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.14">9.42.14<=
/a> Function <tt>tree-root</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-root </tt><tt><i>tree</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0149BF2D">tree-root=
</a></tt>
function returns the root node of
<tt><i>tree</i></tt>,
which must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>
object.
</p><p>
If
<tt><i>tree</i></tt>
is empty, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03C88274">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.15">9.42.15<=
/a> Function <tt>tree-clear</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-root </tt><tt><i>tree</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C88274">tree-clea=
r</a></tt>
function deletes all elements from
<tt><i>tree</i></tt>,
which must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>
object.
</p><p>
If
<tt><i>tree</i></tt>
is already empty, then the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
otherwise it returns an integer which gives the count of the number
of deleted nodes.
</p><p>

</p></dd></dl>
<a name=3D"N-01EBE427">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.16">9.42.16<=
/a> Function <tt>copy-search-tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-search-tree </tt><tt><i>tree</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EBE427">copy-sear=
ch-tree</a></tt>
returns a new tree object which is a copy of
<tt><i>tree</i></tt>.
</p><p>
The
<tt><i>tree</i></tt>
argument must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
</p><p>
The returned object has the same key abstraction functions as
<tt><i>tree</i></tt>
and contains the same elements.
</p><p>
The nodes held inside the new tree are freshly allocated,
but their key objects are shared with the original tree.
</p><p>

</p></dd></dl>
<a name=3D"N-02887FCA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.17">9.42.17<=
/a> Function <tt>tree-begin</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-begin </tt><tt><i>tree</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02887FCA">tree-begi=
n</a></tt>
function returns a new object of type
<tt>tree-iter</tt>
which provides in-order traversal of the elements stored in the tree.
</p><p>
The
<tt><i>tree</i></tt>
argument must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6D50B">tree</a><=
/tt>.
</p><p>
Note: the elements are traversed by applying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0049D1B0">tree-next=
</a></tt>
function to the
<tt>tree-iter</tt>
object.
</p><p>

</p></dd></dl>
<a name=3D"N-0049D1B0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.18">9.42.18<=
/a> Function <tt>tree-next</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tree-next </tt><tt><i>iter</i></tt><tt> )=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0049D1B0">tree-next=
</a></tt>
function returns the next node in sequence from the tree iterator
<tt><i>iter</i></tt>,
which must be an object of type
<tt>tree-iter</tt>.
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02887FCA">tree-begi=
n</a></tt>
function returns such a
<tt>tree-iter</tt>
object.
</p><p>
If there are no more nodes to be visited, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If, during the traversal of a tree, nodes are inserted or deleted,
the behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0049D1B0">tree-next=
</a></tt>
on
<tt>tree-iter</tt>
object that were obtained prior to the insertion or deletion is
not specified. An attempt to complete the iteration may not successfully
visit all keys that should be visited.
</p><p>

</p></dd></dl>
<a name=3D"N-025AB9C9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.42.19">9.42.19<=
/a> Special variable <tt>*tree-fun-whitelist*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025AB9C9">*tree-fun=
-whitelist*</a></tt>
variable holds a list of function names
that may be used in the
<tt>#T</tt>
tree literal syntax as the
<tt><i>keyfun</i></tt>,
<tt><i>lessfun</i></tt>
or
<tt><i>equalfun</i></tt>
operations of a tree. The initial value of this variable is a list which
holds at least the following three symbols:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D6CEA1">less</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
</p><p>
The application may change the value of this variable, or dynamically
bind it, in order to allow
<tt>#T</tt>
literals to be processed which specify functions other than these three.
</p><p>
</p></dd></dl>
<a name=3D"N-038348D3">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43">9.43</a> Pa=
rtial Evaluation and Combinators</h3>



<p>



<a name=3D"N-0068EA9D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.1">9.43.=
1</a> Macros <tt>op</tt> and <tt>do</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(op </tt><tt><i>form</i></tt><tt>+)=20




<br>&nbsp;&nbsp;(do </tt><tt><i>oper</i></tt><tt> </tt><tt><i>form</i></tt>=
<tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Like the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
operator, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
macro denotes an anonymous function.
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
the arguments of the function are implicit, or
optionally specified within the expression, rather than as a formal
parameter list which precedes a body.
</p><p>
The
<tt><i>form</i></tt>
arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
are implicitly turned into a DWIM expression,
which means that argument evaluation follows Lisp-1 rules.  (See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator).
</p><p>
The argument forms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
are arbitrary expressions, within which special
conventions is permitted regarding the use of certain implicit variables:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>@<tt><i>num</i></tt><tt> </tt></tt></dt><dd>



A number preceded by a
<tt>@</tt>
is, syntactically, a metanumber. If it appears inside
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
as an expression, it behaves as a positional argument, whose
existence it implies. For instance
<tt>@2</tt>
means that the function shall have at least two arguments,
the second argument of which is be substituted in place of the
<tt>@2</tt>.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
generates a function which has a number of required arguments equal to the
highest value of
<tt><i>num</i></tt>
appearing in a
<tt>




@</tt><tt><i>num</i></tt><tt>=20

</tt>

construct in the body. For instance
<tt>(op car @3)</tt>
generates a three-argument function (which passes its third
argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>,
returning the result, and ignores its first two arguments).
There is no way to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
to generate functions which have optional arguments.  The positional
arguments are mutable; they may be assigned.



</dd><dt><tt><tt><i>@rest</i></tt><tt> </tt></tt></dt><dd>



If the meta-symbol
<tt><i>@rest</i></tt>
appears in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
syntax as an expression, it explicitly denotes and evaluates to the list of
trailing arguments. Like the metanumber positional arguments, it
may be assigned.



</dd><dt><tt><tt><i>@rec</i></tt><tt> </tt></tt></dt><dd>



If the meta-symbol
<tt><i>@rec</i></tt>
appears in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
syntax as an expression, it denotes a mutable variable which is bound to th=
e
function itself which is generated by that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
expression.



</dd><dt><tt>@(<tt><i>rec</i></tt><tt> ...) </tt></tt></dt><dd>



If this syntax appears inside
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>,
it specifies a recursive call the function.
</dd></dl>
</dl>
<p>

Functions generated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
are always variadic; they always take additional arguments after
any required ones, whether or not the
<tt><i>@rest</i></tt>
syntax is used.
</p><p>
If the body does not contain
any
<tt><i>@num</i></tt>
or
<tt><i>@rest</i></tt>
syntax, then
<tt>@rest</tt>
is implicitly inserted.  What this means is that, for example, since
the form
<tt>(op foo)</tt>
does not contain any implicit positional arguments like
<tt>@1</tt>,
and does not contain
<tt>@rest</tt>,
it is actually a shorthand for
<tt>(op foo . @rest)</tt>:
a function which applies all of its arguments to
<tt>foo</tt>.
If the body does contain at least one
<tt><i>@num</i></tt>
or
<tt><i>@rest</i></tt>,
then
<tt><i>@rest</i></tt>
isn't implicitly inserted. The notation
<tt>(op foo @1)</tt>
denotes a function which takes any number of arguments, and ignores
all but the first one, which is passed to
<tt>foo</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
operator is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
op, with the following three differences:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
The first argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>,
namely
<tt><i>oper</i></tt>,
is an operator. This argument is not processed for the presence of
implicit variables. Thus for instance
<tt>(do @1 ...)</tt>
is invalid. By contrast,
<tt>(op @1 ...)</tt>
is possible and make sense under the right circumstances.
The
<tt><i>oper</i></tt>
argument may be the name of a macro or special operator, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
doesn't support the invocation of macros or special operators.
For instance
<tt>(do let ((x @1)) (+ x 1))</tt>
is possible.
</dd><dt>2.</dt><dd>
The
<tt><i>form</i></tt>
arguments of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
are not implicitly treated as DWIM expressions,
but as ordinary expressions.
</dd><dt>3.</dt><dd>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
syntax doesn't contain any references to implicit variables (metanumbers or
<tt>@rest</tt>)
then a variadic function is generated which requires one argument.
That argument is added to the form. Thus for instance
<tt>(do set x)</tt>
effectively serves as a shorthand for
<tt>(do set x @1)</tt>.
The corresponding defaulting behavior in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
is that a variadic function is generated which requires no arguments.
All of the available arguments are applied. Thus
<tt>(op f x)</tt>
is effectively a shorthand for
<tt>(op f x . @rest)</tt>.
</dd></dl>
</dl>

Because it accepts operators,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
can be used with imperative constructs
which are not functions, like set: like set: for instance
<tt>(do set x)</tt>
produces an anonymous function which, if called with one argument, stores t=
hat
argument into
<tt>x</tt>.
<p>
The actions of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
be understood by these examples, which convey how the syntax is
is rewritten to lambda.  However, note that the real translator
uses generated symbols for the arguments, which are not equal to any
symbols in the program.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
68EA9D">op</a>) -&gt; invalid

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> +) =
-&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>=
 rest [<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> . re=
st])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> + f=
oo) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda=
</a> rest [<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> =
foo . rest])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> @1 =
@2) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda=
</a> (arg1 arg2 . rest) [arg1 arg2])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> @1 =
. @rest) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">l=
ambda</a> (arg1 . rest) [arg1 . @rest])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> @1 =
@rest) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lam=
bda</a> (arg1 . rest) [arg1 @rest])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> @1 =
@2) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda=
</a> (arg1 arg2 . rest) [arg1 arg2])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> foo=
 @1 (@2) (bar @3)) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-004F">lambda</a> (arg1 arg2 arg3 . rest)
                                  [foo arg1 (arg2) (bar arg3)])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> foo=
 @rest @1) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F"=
>lambda</a> (arg1 . rest) [foo rest arg1])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a> + foo) =
-&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>=
 (arg1 . rest) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+=
</a> foo arg1))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a> @1 @2) =
-&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a>=
 (arg1 arg2 . rest) (@1 arg2)) ;; invalid!

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a> foo @re=
st @1) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lam=
bda</a> (arg1 . rest) (foo rest arg1))
</tt></pre><tt>

</tt>

<p>
Note that if argument
<tt><i>@n</i></tt>
appears in the syntax, it is not necessary
for arguments
<tt><i>@1</i></tt>
through
<tt><i>@n-1</i></tt>
to appear. The function will have
<tt>n</tt>
arguments:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
68EA9D">op</a> @3) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#D-004F">lambda</a> (arg1 arg2 arg3 . rest) [arg3])
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
operators can be nested, in any combination. This raises the
question: if an expression like
<tt>@1</tt>,
<tt>@rest</tt>
or
<tt>@rec</tt>
occurs in an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
that is nested
within an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>,
what is the meaning?
</p><p>
An expression with a single
<tt>@</tt>
always belongs with the innermost
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
operator. So for instance
<tt>(op (op @1))</tt>
means that an
<tt>(op @1)</tt>
expression is nested
within an outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
expression that contains no references to its implicit variables.
The
<tt>@1</tt>
belongs to the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>.
</p><p>
There is a way for an inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
to refer to the implicit variables of an outer one. This is
expressed by adding an extra
<tt>@</tt>
prefix for every level of escape. For example in
<tt>(op (op @@1))</tt>
the
<tt>@@1</tt>
belongs to the outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>:
it is the same as
<tt>@1</tt>
appearing in the outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>.
That is to say,
in the expression
<tt>(op @1 (op @@1))</tt>,
the
<tt>@1</tt>
and
<tt>@@1</tt>
are the same thing:
both are parameter 1 of the lambda function generated by the outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>.
By contrast, in the expression
<tt>(op @1 (op @1))</tt>
there are two different parameters:
the first
<tt>@1</tt>
is argument of the outer function, and the second
<tt>@1</tt>
is the first argument of the inner function. If there
are three levels of nesting, then three
<tt>@</tt>
meta-prefixes are needed to insert
a parameter from the outermost
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
into the innermost
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>.
</p><p>
Note that the implicit variables belonging to an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
can be used in the dot position of a function call, such as:
</p><p>
<tt>
</tt></p><pre><tt>  [(op list 1 . @1) 2] -&gt; (1 . 2)
</tt></pre><tt>

</tt>

<p>
This is a consequence of the special transformations described
in the paragraph
<b>Dot Position in Function Calls</b>

in the subsection
<b>Additional Syntax</b>

of the
<b>TXR Lisp</b>

section.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
syntax works in conjunction with quasiliterals which are nested within it.
The metanumber notation as well as
<tt>@rest</tt>
are recognized without requiring an additional
<tt>@</tt>
escape, which is effectively optional:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
6C3723">apply</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068=
EA9D">op</a> list `@1-@rest`) '(1 2 3)) -&gt; "1-2 3"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> list =
`@@1-@@rest`) '(1 2 3)) -&gt; "1-2 3"
</tt></pre><tt>

</tt>

<p>
Though they produce the same result, the above two examples differ in that
<tt>@rest</tt>
embeds a metasymbol into the quasiliteral structure, whereas
<tt>@@rest</tt>
embeds the Lisp expression
<tt>@rest</tt>
into the quasiliteral. Either way, in the scope of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>,
<tt>@rest</tt>
undergoes the macro-expansion which renames it to the machine-generated
function argument symbol of the implicit function denoted by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
macro form.
</p><p>
This convenient omission of the
<tt>@</tt>
character isn't supported for reaching the arguments of an outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
from a quasiliteral within a nested
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>:
</p><p>
<tt>
</tt></p><pre><tt>  ;; To reach @@1, @@@1 must be written.
  ;; @@1 Lisp expression introduced by @.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> ...=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> ... =
`@@@1`))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ((c 0))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> co=
ns (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">inc</a> c=
)) '(a b c)))
  --&gt; ((1 . a) (2 . b) (3 . c))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-lef=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a>=
 + (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> 10 =
@1) @2) '(1 2 3)) --&gt; 123
</tt></pre><tt>

</tt>


</dd></dl>
<a name=3D"N-017F3A22">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.2">9.43.2</a=
> Macro <tt>lop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(lop </tt><tt><i>form</i></tt><tt>+)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a></=
tt>
macro is variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
with special semantics.
</p><p>
The
<tt><i>form</i></tt>
arguments support the same notation as those of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
operator.
</p><p>
If only one
<tt><i>form</i></tt>
is given then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a></=
tt>
is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>.
</p><p>
If two or more
<tt><i>form</i></tt>
arguments are present, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a></=
tt>
generates a variadic function which inserts all of its trailing
arguments between the first and second
<tt><i>form</i></tt>-s.
</p><p>
That is to say, trailing arguments coming into the anonymous function
become the left arguments of the function or function-like object
denoted by the first
<tt><i>form</i></tt>
and the remaining
<tt><i>form</i></tt>-s
give additional arguments. Hence the name
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a></=
tt>,
which stands for "left-inserting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>".
</p><p>
This left insertion of the trailing arguments takes place regardless of whe=
ther
<tt>@rest</tt>
occurs in any
<tt><i>form</i></tt>.
</p><p>
The
<tt><i>form</i></tt>
syntax determines the number of required arguments of the
generated function, according to the highest-valued meta-number. The traili=
ng
arguments which are inserted into the left position are any arguments in ex=
cess
of the required arguments.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a></=
tt>
macro's expansion can be understood via the following equivalences,
except that in the real implementation, the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02288559">rest</a><=
/tt>
and
<tt>arg1</tt>
through
<tt>arg3</tt>
are replaced with hygienic, unique symbols.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
7F3A22">lop</a> f)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-0068EA9D">op</a> f)   &lt;--&gt;   (<a href=3D"http://nongnu.org/=
txr/txr-manpage.html#D-004F">lambda</a> (. rest) [<a href=3D"http://nongnu.=
org/txr/txr-manpage.html#N-003BDFA9">f</a> . rest])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a> f =
x y)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F=
">lambda</a> (. rest)
                       [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-026C3723">apply</a> f (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0014162F">append</a> rest [<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-0206CE91">list</a> x y])])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a> f =
x @3 y)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
04F">lambda</a> (arg1 arg2 arg3 . rest)
                          [<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-026C3723">apply</a> f
                                 (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-0014162F">append</a> rest
                                         [<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-0206CE91">list</a> x arg3 y])])
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017=
F3A22">lop</a> list 3) '(a b c)) --&gt; ((a 3) (b 3) (c 3))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a> lis=
t @1) '(a b c)) --&gt; ((a) (b) (c))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F3A22">lop</a> lis=
t @1) '(a b c) '(d e f))
  --&gt; ((d a) (e b) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
003BDFA9">f</a> c))

</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03EF3A27">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.3">9.43.3</a=
> Macro <tt>ldo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ldo </tt><tt><i>oper</i></tt><tt> </tt><tt><i>form</i></tt=
><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF3A27">ldo</a></=
tt>
macro provides a shorthand notation for uses of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
macro which inserts the first argument of the anonymous function
as the leftmost argument of the specified operator.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF3A27">ldo</a></=
tt>
syntax can be understood in terms of these equivalences:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
EF3A27">ldo</a> f)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#D-0061">do</a> f @1)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF3A27">ldo</a> f =
x)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">=
do</a> f @1 x)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF3A27">ldo</a> f =
x y)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061=
">do</a> f @1 x y)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF3A27">ldo</a> f =
x @2 y)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
061">do</a> f @1 x @2 y)
</tt></pre><tt>

</tt>

<p>
The implicit argument
<tt>@1</tt>
is always inserted as the leftmost argument of the operator
specified by the first form.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; push elements of l1 onto l2.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
l1 '(a b c)) l2)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A943EE">mapdo</a=
> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EF3A27">ldo</a> pu=
sh l2) l1)
    l2)
  --&gt; (c b a)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00BE749A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.4">9.43.4</a=
> Macros <tt>ap</tt>, <tt>ip</tt>, <tt>ado</tt> and <tt>ido.</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ap </tt><tt><i>form</i></tt><tt>+)=20




<br>&nbsp;&nbsp;(ip </tt><tt><i>form</i></tt><tt>+)=20




<br>&nbsp;&nbsp;(ado </tt><tt><i>form</i></tt><tt>+)=20




<br>&nbsp;&nbsp;(ido </tt><tt><i>form</i></tt><tt>+)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
macro is based on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
macro and has identical argument
conventions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
macro analyzes its arguments and produces a function
<tt><i>f</i></tt>,
in exactly the same same way as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
macro.  However, instead of returning
<tt><i>f</i></tt>,
directly, it returns a different function
<tt><i>g</i></tt>,
which is a one-argument function  which accepts a list,
and then applies the list as arguments to
<tt><i>f</i></tt>.
</p><p>
In other words, the following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
BE749A">ap</a> form ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-012A7E6A">apf</a> (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-0068EA9D">op</a> form ...))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
macro nests properly with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>,
in any combination, in regard to the
<tt><i>...@@n</i></tt>
notation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ip</a></t=
t>
macro is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
macro, except that it is based
on the semantics of the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>
rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>,
according
to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
BE749A">ip</a> form ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-m=
anpage.html#N-012A7E6A">ipf</a> (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-0068EA9D">op</a> form ...))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ado</a></=
tt>
and
<tt>ido</tt>
macros are related to do macro in the same way that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ip</a></t=
t>
are related to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>.
They produce a one-argument function which works
as if by applying its arguments to the function generated by do,
according to the following equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
BE749A">ado</a> form ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-012A7E6A">apf</a> (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#D-0061">do</a> form ...))

  (ido form ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-012A7E6A">ipf</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-0061">do</a> form ...))
</tt></pre><tt>

</tt>

<p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">apf</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">ipf</a></=
tt>
functions.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Take a list of pairs and produce a list in which tho=
se pairs
  ;; are reversed.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a> list=
 @2 @1) '((1 2) (a b)))   -&gt;   ((2 1) (b a))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01937C5A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.5">9.43.5</a=
> Macros <tt>opip</tt> and <tt>oand</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(opip </tt><tt><i>clause</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(oand </tt><tt><i>clause</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">oand</a><=
/tt>
operators make it possible to chain together functions which are expressed
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
syntax. (See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
operator for more information).
</p><p>
Both macros perform the same transformation except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>
translates its arguments to a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chain</a>=
</tt>
function, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">oand</a><=
/tt>
translates its arguments in the same way to a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chand</a>=
</tt>
function.
</p><p>
More precisely, these macros perform the following rewrites:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
937C5A">opip</a> arg1 arg2 ... argn) -&gt; [<a href=3D"http://nongnu.org/tx=
r/txr-manpage.html#N-00C53CF7">chain</a> {arg1} {arg2} ... {argn}]
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">oand</a> a=
rg1 arg2 ... argn) -&gt; [<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-00C53CF7">chand</a> {arg1} {arg2} ... {argn}]
</tt></pre><tt>

</tt>

<p>
where the above
<tt>{arg}</tt>
notation denotes the following transformation applied to each argument:
</p><p>
<tt>
</tt></p><pre><tt>  (function ...) -&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-0068EA9D">op</a> function ...)
  (operator ...) -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0061">do</a> operator ...)
  (macro ...)    -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D=
-0061">do</a> macro ...)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a> ...) =
    -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</=
a> ...)
  [...]          -&gt; [...]
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a> ...) =
    -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</=
a> ...)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a> .=
..)     -&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB=
">uref</a> ...)
  .slot          -&gt; .slot
  .(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022200C1">method</a=
> ...)  -&gt; .(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022200C=
1">method</a> ...)
  atom           -&gt; atom
</tt></pre><tt>

</tt>

<p>
In other words, compound forms whose leftmost symbol is a macro or operator
are translated to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
notation. Compound forms denoting function calls are translated to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
notation. Compound forms which are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
invocations, either explicit or via the DWIM brackets notation, are
used without transformation. Used without transformation also are forms
denoting struct slot access, either explicitly using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A211AB">uref</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
or the respective dot notations, as well as any atom forms.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">oand</a><=
/tt>
macros use their macro environment in determining whether a form is a
macro call, thereby respecting lexical scoping.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


Take each element from the list
<tt>(1 2 3 4)</tt>
and multiply it by three, then add 1.
If the result is odd, collect that into the resulting list:
</p><p>
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a> 3)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007=
C">+</a>&nbsp;1)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000=
E3A74">iff</a>&nbsp;oddp&nbsp;list])
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>&nbsp;1&nbsp;4))
</tt>

</p><p>
The above is equivalent to:
</p><p>
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mappend</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chain</a> (<=
a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a> * 3)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-0068EA9D">op</a>&nbsp;+&nbsp;1)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;[<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-000E3A74">iff</a>&nbsp;oddp&nbsp;list])
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-033BE5A1">range</a>&nbsp;1&nbsp;4))
</tt>

</p><p>
The
<tt>(* 3)</tt>
and
<tt>(+ 1)</tt>
terms are rewritten to
<tt>(op * 3)</tt>
and
<tt>(op + 1)</tt>,
respectively, whereas
<tt>[iff oddp list]</tt>
is passed through untransformed.
</p><p>

</p></dd></dl>
<a name=3D"N-033F39EF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.6">9.43.6</a=
> Macro <tt>ret</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ret </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39EF">ret</a></=
tt>
macro's
<tt><i>form</i></tt>
argument is treated similarly to the second and subsequent arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
operator.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39EF">ret</a></=
tt>
macro produces a function which takes any number of arguments,
and returns the value specified by
<tt><i>form</i></tt>.
</p><p>
<tt><i>form</i></tt>
can contain
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
meta syntax like
<tt>@n</tt>
and
<tt>@rest</tt>.
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
3F39EF">ret</a> x) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-0068EA9D">op</a> identity x))
</tt></pre><tt>

</tt>

<p>
Thus the expression
<tt>(ret @2)</tt>
returns a function similar to
<tt>(lambda (x y . z) y)</tt>,
and the expression
<tt>(ret 42)</tt>
returns a function similar to
<tt>(lambda (. rest) 42)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-008216A8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.7">9.43.7</a=
> Macro <tt>aret</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(aret </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216A8">aret</a><=
/tt>
macro's
<tt><i>form</i></tt>
argument is treated similarly to the second and subsequent arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
operator.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008216A8">aret</a><=
/tt>
macro produces a function which takes any number of arguments,
and returns the value specified by
<tt><i>form</i></tt>.
</p><p>
<tt><i>form</i></tt>
can contain
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
meta syntax like
<tt><i>@n</i></tt>
and
<tt>@rest</tt>.
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
8216A8">aret</a> x) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-00BE749A">ap</a> identity x))
</tt></pre><tt>

</tt>

<p>
Thus the expression
<tt>(aret @2)</tt>
returns a function similar to
<tt>(lambda (. rest) (second rest))</tt>,
and the expression
<tt>(aret 42)</tt>
returns a function similar to
<tt>(lambda (. rest) 42)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0387F549">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.8">9.43.8</a=
> Function <tt>dup</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dup </tt><tt><i>func</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387F549">dup</a></=
tt>
function returns a one-argument function which calls the two-argument
function
<tt><i>func</i></tt>
by duplicating its argument.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; square the elements of a list
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a>=
 [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387F549">dup</a> *] =
'(1 2 3)) -&gt; (1 4 9)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02D06BA4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.9">9.43.9</a=
> Function <tt>flipargs</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flipargs </tt><tt><i>func</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D06BA4">flipargs<=
/a></tt>
function returns a two-argument function which calls the two-argument
function
<tt><i>func</i></tt>
with reversed arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-00C53CF7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.10">9.43.10<=
/a> Functions <tt>chain</tt> and <tt>chand</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chain </tt><tt><i>func</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(chand </tt><tt><i>func</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chain</a>=
</tt>
function accepts zero or more functions as arguments, and returns
a single function, called the chained function, which represents the chaine=
d
application of those functions, in left to right order.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chain</a>=
</tt>
is given no arguments, then it returns a variadic function which
ignores all of its arguments and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Otherwise, the first function may accept any number of arguments. The secon=
d
and subsequent functions, if any, must accept one argument.
</p><p>
The chained function can be called with an argument list which is acceptabl=
e
to the first function. Those arguments are in fact passed to the first
function. The return value of that call is then passed to the second
function, and the return value of that call is passed to the third function
and so on. The final return value is returned to the caller.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chand</a>=
</tt>
function is similar, except that it combines the functionality of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">andf</a><=
/tt>
into chaining. The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chain</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chand</a>=
</tt>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chand</a>=
</tt>
immediately terminates and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
whenever any of the functions returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
without calling the remaining functions.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53=
CF7">chain</a> + (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068E=
A9D">op</a> * 2)] 3 4) -&gt; 14
</tt></pre><tt>

</tt>

<p>
In this example, a two-element chain is formed from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
function
and the function produced by
<tt>(op * 2)</tt>
which is a one-argument
function that returns the value of its argument multiplied by two.
(See the definition of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
operator).
</p><p>
The chained function is invoked using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>
function, with the arguments
<tt>3</tt>
and
<tt>4</tt>.
The chained evaluation begins by passing
<tt>3</tt>
and
<tt>4</tt>
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>,
which yields
<tt>7</tt>.
This
<tt>7</tt>
is then passed to the
<tt>(op * 2)</tt>
doubling function, resulting in
<tt>14</tt>.
</p><p>
A way to write the above example without the use of the DWIM brackets and t=
he
op operator is this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
86C775">call</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53=
CF7">chain</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109=
C">fun</a> +) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">la=
mbda</a> (x) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7"=
>*</a> 2 x))) 3 4)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0106CD7F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.11">9.43.11<=
/a> Function <tt>juxt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(juxt </tt><tt><i>func</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0106CD7F">juxt</a><=
/tt>
function accepts a variable number of arguments which are functions.  It
combines these into a single function which, when invoked, passes its argum=
ents
to each of these functions, and collects the results into a list.
</p><p>
Note: the juxt function can be understood in terms of the following referen=
ce
implementation:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> juxt (funcs)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> (=
. args)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a>)
                (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C37=
23">apply</a> fun args))
              funcs)))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21">callf</a>=
</tt>
function generalizes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0106CD7F">juxt</a><=
/tt>
by allowing the combining function to be specified.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>   ;; separate list (1 2 3 4 5 6) into lists of evens and=
 odds,
   ;; which end up juxtaposed in the output list:

   [(op [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0106CD7F">juxt=
</a> keep-if remove-if] evenp)
    '(1 2 3 4 5 6)] -&gt; ((2 4 6) (1 3 5))

   ;; call several functions on 1, collecting their results:
   [[juxt (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op=
</a> + 1) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op=
</a> - 1) evenp sin cos] 1]'
   -&gt; (2 0 nil 0.841470984807897 0.54030230586814)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01E7D2AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.12">9.43.12<=
/a> Functions <tt>andf</tt> and <tt>orf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(andf </tt><tt><i>func</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(orf </tt><tt><i>func</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">andf</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">orf</a></=
tt>
functions are the functional equivalent of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0034">or</a></tt>
operators. These functions accept multiple functions and return a new funct=
ion
which represents the logical combination of those functions.
</p><p>
The input functions should have the same arity. Failing that, there should
exist some common argument arity with which each of these can be invoked. T=
he
resulting combined function is then callable with that many arguments.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">andf</a><=
/tt>
function returns a function which combines the input functions with
a short-circuiting logical conjunction. The resulting function passes its
arguments to the functions successively, in left to right order. As soon as=
 any
of the functions returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then nil is returned immediately, and the
remaining functions are not called.  Otherwise, if none of the functions re=
turn
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the value returned by the last function is returned. If the list of
functions is empty, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.  That is,
<tt>(andf)</tt>
returns a function
which accepts any arguments, and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">orf</a></=
tt>
function combines the input functions with a short-circuiting logical
disjunction. The function produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">orf</a></=
tt>
passes its arguments down to the
functions successively, in left to right order.  As soon as any function
returns a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value, that value is returned and the remaining functions are
not called. If all functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. The expression
<tt>(orf)</tt>
returns a function which accepts any arguments and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0026CE18">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.13">9.43.13<=
/a> Function <tt>notf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(notf </tt><tt><i>function</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026CE18">notf</a><=
/tt>
function returns a function which is the Boolean negation
of
<tt><i>function</i></tt>.
</p><p>
The returned function takes a variable number of arguments. When
invoked, it passes all of these arguments to
<tt><i>function</i></tt>
and then inverts the result as if by application of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-000E3A74">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.14">9.43.14<=
/a> Functions <tt>iff</tt> and <tt>iffi</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(iff </tt><tt><i>condfun</i></tt><tt> [</tt><tt><i>thenfun<=
/i></tt><tt> [</tt><tt><i>elsefun</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(iffi </tt><tt><i>condfun</i></tt><tt> </tt><tt><i>thenfun<=
/i></tt><tt> [</tt><tt><i>elsefun</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>
function is the functional equivalent of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
operator. It accepts
functional arguments and returns a function.
</p><p>
The resulting function takes its arguments, if any, and applies them to
<tt><i>condfun</i></tt>.
If
<tt><i>condfun</i></tt>
yields true, then the arguments are passed to
<tt><i>thenfun</i></tt>
and the
resulting value is returned. Otherwise the arguments are passed to
<tt><i>elsefun</i></tt>
and the resulting value is returned.
</p><p>
If
<tt><i>thenfun</i></tt>
is omitted then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>
is used as default. This omission is not permitted by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a><=
/tt>,
only
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>.
</p><p>
If
<tt><i>elsefun</i></tt>
needs to be called, but is omitted, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a><=
/tt>
function differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>
only in the defaulting behavior with respect
to the
<tt><i>elsefun</i></tt>
argument. If
<tt><i>elsefun</i></tt>
is omitted in a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a><=
/tt>
then the default function is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0137D341">identity<=
/a></tt>.
This is useful in situations when one value is to be
replaced with another one when the condition is true, otherwise
preserved.
</p><p>
The following equivalences hold between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
0E3A74">iffi</a> a b c)            &lt;--&gt; (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#N-000E3A74">iff</a> a b c)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a> a=
 b)              &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-000E3A74">iff</a> a b identity)

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a> a=
 b nilf]         &lt;--&gt; [<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-000E3A74">iff</a> a b]

  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iffi</a> a=
 identity nilf]  &lt;--&gt; [<a href=3D"http://nongnu.org/txr/txr-manpage.h=
tml#N-000E3A74">iff</a> a]
</tt></pre><tt>

</tt>

<p>
The following equivalences illustrate
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>
with both optional arguments omitted:
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
0E3A74">iff</a> a]  &lt;---&gt;  [<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-000E3A74">iff</a> a identity nilf]  &lt;---&gt;  a
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-032070EB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.15">9.43.15<=
/a> Functions <tt>tf</tt> and <tt>nilf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tf </tt><tt><i>arg</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(nilf </tt><tt><i>arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">tf</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">nilf</a><=
/tt>
functions take zero or more arguments, and ignore them.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">tf</a></t=
t>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">nilf</a><=
/tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: the following equivalences hold between these functions and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39EF">ret</a></=
tt>
operator, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026CB20">retf</a><=
/tt>
function.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
6E109C">fun</a> tf) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-033F39EF">ret</a> t) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/=
txr-manpage.html#N-0026CB20">retf</a> t)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> ni=
lf) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39E=
F">ret</a> nil) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-033F39EF">ret</a>) &lt;--&gt; (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-0026CB20">retf</a> nil)
</tt></pre><tt>

</tt>

<p>
In Lisp-1-style code,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">tf</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">nilf</a><=
/tt>
behave like constants which can replace uses of
<tt>(ret t)</tt>
and
<tt>(ret nil)</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
02F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033=
F39EF">ret</a> nil) list] &lt;--&gt; [<a href=3D"http://nongnu.org/txr/txr-=
manpage.html#N-0202F92F">mapcar</a> nilf list]
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; tf and nilf are useful when functions are chained to=
gether.
  ;; test whether (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002A=
">trunc</a> n 2) is odd.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
trunc-n-2-odd (n)
    [[chain (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">=
op</a> trunc @1 2) [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000=
E3A74">iff</a> oddp tf nilf]] n])
</tt></pre><tt>

</tt>

<p>
In this example, two functions are chained together, and
<tt>n</tt>
is passed
through the chain such that it is first divided by two via the
function denoted by
<tt>(op trunc @1 2)</tt>
and then the result is passed into the
function denoted by
<tt>[iff oddp tf nilf]</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>
function passes its argument into
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a></tt>=
,
and if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006B">oddp</a></tt>
yields true, it passes the same argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">tf</a></t=
t>.
Here
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">tf</a></t=
t>
proves its utility by ignoring that value and returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
If the argument (the divided value) passed into
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000E3A74">iff</a></=
tt>
is even, then iff passes it into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032070EB">nilf</a><=
/tt>
function, which ignores the value and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0026CB20">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.16">9.43.16<=
/a> Function <tt>retf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(retf </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026CB20">retf</a><=
/tt>
function returns a function. That function can take zero or
more arguments. When called, it ignores its arguments and returns
<tt><i>value</i></tt>.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39EF">ret</a></=
tt>
macro.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; the function returned by (<a href=3D"http://nongnu.o=
rg/txr/txr-manpage.html#N-0026CB20">retf</a> 42)
  ;; ignores 1 2 3 and returns 42.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> (=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026CB20">retf</a> 42) =
1 2 3) -&gt; 42
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-012A7E6A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.17">9.43.17<=
/a> Functions <tt>apf</tt> and <tt>ipf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(apf </tt><tt><i>function</i></tt><tt> </tt><tt><i>arg</i><=
/tt><tt>*)=20




<br>&nbsp;&nbsp;(ipf </tt><tt><i>function</i></tt><tt> </tt><tt><i>arg</i><=
/tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">apf</a></=
tt>
function returns a one-argument function whose argument conventions
are similar to those of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>
function: it accepts one or more arguments, the last of which should
be a list.  When that function is called, it applies these arguments to
<tt><i>function</i></tt>
as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>.
It then returns whatever
<tt><i>function</i></tt>
returns.
</p><p>
If one or more additional
<tt><i>arg</i></tt>-s
are passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">apf</a></=
tt>,
then these are stored in the function which is returned.
When the function is invoked, it prepends all of these stored
arguments to those that it is being given, and the resulting combined
arguments are applied. Thus the
<tt><i>arg</i></tt>-s
become the leftmost arguments of
<tt><i>function</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">ipf</a></=
tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">apf</a></=
tt>,
except that the argument conventions of the function returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">ipf</a></=
tt>
are based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>,
and that function applies arguments as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">iapply</a=
></tt>
rather than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026C3723">apply</a>=
</tt>.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE749A">ap</a></t=
t>
macro.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Function returned by [<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-012A7E6A">apf</a> +] accepts the
  ;; (1 2 3) list and applies it to +, as
  ;; if (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 1 =
2 3) were called.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> [=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A7E6A">apf</a> +] '(=
1 2 3)) -&gt; 6
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00192C21">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.18">9.43.18<=
/a> Function <tt>callf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(callf </tt><tt><i>main-function</i></tt><tt> </tt><tt><i>a=
rg-function</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21">callf</a>=
</tt>
function returns a function which applies its arguments to each
<tt><i>arg-function</i></tt>,
juxtaposing the return values of these calls to form arguments
which are then passed to
<tt><i>main-function</i></tt>.
The return value of
<tt><i>main-function</i></tt>
is returned.
</p><p>
The following equivalence holds, except for the order of evaluation of
arguments:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
192C21">callf</a> fm f0 f1 f2 ...) &lt;--&gt; (<a href=3D"http://nongnu.org=
/txr/txr-manpage.html#N-00C53CF7">chain</a> (<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-0106CD7F">juxt</a> f0 f1 f2 ...)
                                      (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#N-012A7E6A">apf</a> fm))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Keep those pairs which are two of a kind

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01413802">keep-if</a=
> [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21">callf</a> =
eql first second] '((1 1) (2 3) (4 4) (5 6)))
  -&gt; ((1 1) (4 4))
</tt></pre><tt>

</tt>

<p>
The following equivalence holds between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0106CD7F">juxt</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21">callf</a>=
</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
06CD7F">juxt</a> f0 f1 f2 ...]  &lt;--&gt;  [<a href=3D"http://nongnu.org/t=
xr/txr-manpage.html#N-00192C21">callf</a> list f0 f1 f2 ...]:w
</tt></pre><tt>

</tt>

<p>
Thus,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0106CD7F">juxt</a><=
/tt>
may be regarded as a specialization of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00192C21">callf</a>=
</tt>
in which the main function is implicitly
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0026CEF1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.43.19">9.43.19<=
/a> Function <tt>mapf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mapf </tt><tt><i>main-function</i></tt><tt> </tt><tt><i>ar=
g-function</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026CEF1">mapf</a><=
/tt>
function returns a function which distributes its arguments
into the
<tt><i>arg-function</i></tt>-s.
That is to say, each successive argument of the returned
function is associated with a successive
<tt><i>arg-function</i></tt>.
</p><p>
Each
<tt><i>arg-function</i></tt>
is called, passed the corresponding argument. The return
values of these functions are then passed as arguments
to
<tt><i>main-function</i></tt>
and the resulting value is returned.
</p><p>
If the returned function is called with fewer arguments than there
are
<tt><i>arg-function</i></tt>-s,
then only that many functions are used. Conversely, if the function is
called with more arguments than there are
<tt><i>arg-function</i></tt>-s,
then those arguments are ignored.
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
26CEF1">mapf</a> fm f0 f1 ...) &lt;--&gt; (<a href=3D"http://nongnu.org/txr=
/txr-manpage.html#D-004F">lambda</a> (. rest)
                              [<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-026C3723">apply</a> fm [<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-0202F92F">mapcar</a> call
                                                (<a href=3D"http://nongnu.o=
rg/txr/txr-manpage.html#N-0206CE91">list</a> f0 f1 ...)
                                                rest]])
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Add the squares of 2 and 3
  [[mapf + [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387F549">d=
up</a> *] [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387F549">du=
p</a> *]] 2 3] -&gt; 13

</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-019F37B4">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44">9.44</a> In=
put and Output (Streams)</h3>



<p>


<b>TXR Lisp</b> supports input and output streams of various kinds, with
generic operations that work across the stream types.
</p><p>
In general, I/O errors are usually turned into exceptions. When the descrip=
tion
of error reporting is omitted from the description of a function, it can be
assumed that it throws an error.
</p><p>

<a name=3D"N-006566FB">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.1">9.44.=
1</a> Special variables <tt>*stdout*</tt>, <tt>*stddebug*</tt>, <tt>*stdin*=
</tt>, <tt>*stderr*</tt> and <tt>*stdnull*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold predefined stream objects. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
streams closely correspond to the underlying operating system streams.
Various I/O functions require stream objects as arguments.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stddebug=
*</a></tt>
stream goes to the same destination as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>,
but is a separate object which can be redirected independently, allowing
debugging output to be separated from normal output.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdnull*=
</a></tt>
stream is a special kind of stream called a null stream.
This stream is not connected to any device or file.  It is similar to
the
<tt>/dev/null</tt>
device on Unix, but does not involve the operating system.
</p><p>

</p></dd></dl>
<a name=3D"N-02B252AA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.2">9.44.2</a=
> Special variables <tt>*print-flo-format*</tt> and <tt>*pprint-flo-format*=
</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*print-fl=
o-format*</a></tt>
variable determines the conversion format which is applied when
a floating-point value is converted to decimal text by the
functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostring<=
/a></tt>.
</p><p>
The default value is
<tt>~s</tt>.
</p><p>
The related variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*pprint-f=
lo-format*</a></tt>
similarly determines the conversion format applied to floating-point
values by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostringp=
</a></tt>.
</p><p>
The default value is
<tt>~a</tt>.
</p><p>
The format string in either variable must specify the consumption of
exactly one
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
argument.
</p><p>
The conversion string may use embedded width and precision values:
for instance,
<tt>~3,4f</tt>
is a valid value for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*print-fl=
o-format*</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*pprint-f=
lo-format*</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02E97D03">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.3">9.44.3</a=
> Special variable <tt>*print-flo-precision*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E97D03">*print-fl=
o-precision*</a></tt>
special variable specifies the default floating-point printing
precision which is used when the
<tt>~a</tt>
or
<tt>~s</tt>
conversion specifier of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function is used for printing a floating-point value, and no precision
is specified.
</p><p>
Note that since the default value of the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*print-fl=
o-format*</a></tt>
is the string
<tt>~s</tt>,
the
<tt>*printf-flo-precision*</tt>
variable, by default, also determines the precision which applies when
floating-point values are converted to decimal text by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostring<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostringp=
</a></tt>.
</p><p>
The default value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E97D03">*print-fl=
o-precision*</a></tt>
is that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00998CE7">flo-dig</=
a></tt>
variable.
</p><p>
Note: to print floating-point values in such a way that their values
can be precisely recovered from the printed representation, it is
recommended to override
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E97D03">*print-fl=
o-precision*</a></tt>
to the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A2123A">flo-max-d=
ig</a></tt>
variable.
</p><p>

</p></dd></dl>
<a name=3D"N-00F41F6C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.4">9.44.4</a=
> Special variable <tt>*print-flo-digits*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E97D03">*print-fl=
o-precision*</a></tt>
special variable specifies the default floating-point printing
precision which is used when the
<tt>~f</tt>
or
<tt>~e</tt>
conversion specifier of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function is used for printing a floating-point value, and no precision
is specified.
</p><p>
Its default value is
<tt>3</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01DD07CC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.5">9.44.5</a=
> Special variable <tt>*print-base*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD07CC">*print-ba=
se*</a></tt>
variable controls the base (radix) used for printing integer values.
It applies when the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostring<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostringp=
</a></tt>
process an integer value.
It also applies when the
<tt>~a</tt>
and
<tt>~s</tt>
conversion specifiers of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function are used for printing an integer value.
</p><p>
The default value of the variable is
<tt>10</tt>.
</p><p>
Meaningful values are:
<tt>2</tt>,
<tt>8</tt>,
<tt>10</tt>
and
<tt>16</tt>.
</p><p>
When base 16 is selected, hexadecimal digits are printed as upper-case
characters.
</p><p>

</p></dd></dl>
<a name=3D"N-01FC9977">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.6">9.44.6</a=
> Special variable <tt>*print-circle*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FC9977">*print-ci=
rcle*</a></tt>
variable is a Boolean which controls whether the circle notation is
in effect for printing aggregate objects: conses, ranges, vectors, hash tab=
les
and structs. The initial value of this variable is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>:
circle notation printing is disabled.
</p><p>
The circle notation works for structs also, including structs which have
user-defined
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
methods. When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
method calls functions which print objects, such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
on the same stream, the detection of circularity and substructure sharing
continues in these recursive invocations.
</p><p>
However, there are limitations in the degree of support for circle notation
printing across
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
methods. Namely, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
method of a struct
<tt><i>S</i></tt>
must not procure and submit for printing objects which are not part of the
ordinary structure that is reachable from the (static or instance) slots of
<tt><i>S</i></tt>,
if those objects have already been printed prior to invoking the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
method, and have been printed without a
<tt>#=3D</tt>
circle notation label.  The "ordinary structure that is reachable from the
slots" denotes structure that is directly reachable by traversing conses,
ranges, vectors, hashes and struct slots: all printable aggregate objects.
</p><p>

</p></dd></dl>
<a name=3D"N-011ACA52">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.7">9.44.7</a=
> Function <tt>format</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(format </tt><tt><i>stream-designator</i></tt><tt> </tt><tt=
><i>format-string</i></tt><tt> </tt><tt><i>format-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function performs output to a stream given by
<tt><i>stream-designator</i></tt>,
by interpreting the actions implicit in a
<tt><i>format-string</i></tt>,
incorporating material pulled from additional arguments given by
<tt>




</tt><tt><i>format-arg</i></tt><tt>*.=20

</tt>

Though the function is simple to invoke, there is complexity in format stri=
ng
language, which is documented below.
</p><p>
The
<tt><i>stream-designator</i></tt>
argument can be a stream object, or one of the values
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
serves as a shorthand for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>.
The value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
means that the function will send output into a newly instantiated string
output stream, and then return the resulting string.
</p><p>
</p></dd><dt>Format string syntax:</dt><dd>
<p>


</p><p>
Within
<tt><i>format-string</i></tt>,
most characters represent themselves. Those
characters are simply output. The character
<tt>~</tt>
(tilde) introduces formatting
directives, which are denoted by a single character, usually a letter.
</p><p>
The special sequence
<tt>~~</tt>
(tilde-tilde) encodes a single tilde. Nothing is
permitted between the two tildes.
</p><p>
The syntax of a directive is generally as follows:
</p><p>
<tt>




<br>&nbsp;&nbsp;~[</tt><tt><i>width</i></tt><tt>] [,</tt><tt><i>precision</=
i></tt><tt>] </tt><tt><i>letter</i></tt><tt>=20

</tt>

</p><p>
In other words, the
<tt>~</tt>
(tilde) character, followed by a
<tt><i>width</i></tt>
specifier, a
<tt><i>precision</i></tt>
specifier introduced by a comma,
and a
<tt><i>letter</i></tt>,
such that
<tt><i>width</i></tt>
and
<tt><i>precision</i></tt>
are independently optional: either or both may be omitted.
No whitespace is allowed between these elements.
</p><p>
The
<tt><i>letter</i></tt>
is a single alphabetic character which determines the
general action of the directive. The optional width and precision
are specified as follows:
</p><p>
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt><tt><i>width</i></tt><tt> </tt></tt></dt><dd>



The width specifier consists of an optional
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
(left angle bracket) character or
<tt>^</tt>
(caret)
character followed by an optional width specification.
<p>
If the leading
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
character is present, then the printing will be left-adjusted within
this field. If the
<tt>^</tt>
character is present, the printing will be centered within the field.
Otherwise it will be right-adjusted by default.
</p><p>
The width can be specified as a decimal integer with an optional leading
minus sign, or as the character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
notation means that instead of digits, the value of the next argument is
consumed, and expected to be an integer which specifies the width. If the
width, specified either way, is negative, then the field will be left-adjus=
ted.
If the value is positive, but either the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
or
<tt>^</tt>
prefix character is present in the width
specifier, then the field is adjusted according to that character.
</p><p>
The padding calculations for alignment and centering take into account
character display width, as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0263C039">display-w=
idth</a></tt>
function. For instance, a character string containing four Chinese
characters (kanji) has a display width of 8, not 4.
</p><p>
The width specification does not restrict the printed portion of a datum.
Rather, for some kinds of conversions, it is the precision specification th=
at
performs such truncation.  A datum's display width (or that of its printed
portion, after such truncation is applied) can equal or exceed the specifie=
d
field width.  In this situation it overflows the field: the printed portion=
 is
rendered in its entirety without any padding applied on either side for
alignment or centering.
</p><p>



</p></dd><dt><tt><tt><i>precision</i></tt><tt> </tt></tt></dt><dd>



The precision specifier is introduced by a leading comma. If this comma app=
ears
immediately after the directive's
<tt>~</tt>
character, then it means that
<tt><i>width</i></tt>
is being omitted; there is only a precision field.
<p>
The precision specifier may begin with these optional characters:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt><tt>0</tt></dt><dd>

(the "leading zero flag"),
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
></tt></dt><dd>

(print a sign for positive values")
</dd><dt>space</dt><dd>
(print a space in place of a positive sign).
</dd></dl>
</dl>
<p>
The precision specifier itself is either a decimal integer that does not
begin with a zero digit, or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
character.
</p><p>
The precision field's components have a meaning which depends on the type o=
f
object printed and the conversion specifier.
</p><p>
For integer arguments, the precision value specifies the minimum number of =
digits
to print.  If the precision field has a leading zero flag, then the integer=
 is
padded with zeros to the required number of digits, otherwise the number is
padded with spaces instead of zeros.  If zero or space padding is present, =
and
a leading positive or negative sign must be printed, then it is placed befo=
re
leading zeros, or after leading spaces, as the case may be.
</p><p>
For floating-point values, the meaning of the precision value depends on wh=
ich
specific conversion specifier
(<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></t=
t>,
<tt>e</tt>,
<tt>a</tt>
or
<tt>s</tt>)
is used. The details are
documented in the description of each of these, below. The leading zero fla=
g is
also taken into account for floating-point values, and treated uniformly by
these directives.  If the flag is present, then the printed value's integer
part will be padded with leading zeros up to the width of the field such th=
at
one character of unused space remains in the field, in case a positive or
negative sign needs also to be rendered.
</p><p>
For integer or floating-point arguments, if the precision specifier has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
sign
among the special characters, then a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
sign is printed for positive numbers. If
the precision specifier has a leading space instead of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
sign, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
sign is rendered as a space for positive numbers. If there is no leading sp=
ace
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>,
then a sign character is omitted for positive numbers. Negative
numbers are unconditionally prefixed with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
sign.
</p><p>
For all other objects, the precision specifies the maximum number of
print positions to occupy, taking into account the display width of each
character of the printed representation of the object, as according
to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0263C039">display-w=
idth</a></tt>
function.  The object's printed representation is truncated, if necessary, =
to
the maximum number of characters which will not exceed the specified number=
 of
print positions.
</p><p>
</p></dd></dl>
</dl>
<p>
</p></dd><dt>Format directives:</dt><dd>
<p>


</p><dl class=3D"indent">

Format directives are case sensitive, so that for example
<tt>~x</tt>
and
<tt>~X</tt>
have a
different effect, and
<tt>~A</tt>
doesn't exist whereas
<tt>~a</tt>
does. They are:
<p>
</p><dl class=3D"items">
<dt><tt>a</tt></dt><dd>

Prints any object in an aesthetic way, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
function.
The aesthetic notation violates read-print consistency: this notation
is not necessarily readable if it is implanted in <b>TXR</b> source code.
The field width specifier is honored, including the left-right adjustment
semantics.
<p>
When this specifier is used for floating-point values, the precision specif=
ies
the maximum number of total significant figures, which do not include any
digits in the exponent, if one is printed. Numbers are printed in exponenti=
al
notation if their magnitude is small, or else if their exponent exceeds the=
ir
precision. If the precision is not specified, then it is obtained from
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E97D03">*print-fl=
o-precision*</a></tt>
special variable, whose default value is the same as that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00998CE7">flo-dig</=
a></tt>
variable.
Floating point values which are integers are
printed without a trailing
<tt>.0</tt>
(point zero).
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
flag in the precision is honored for rendering an explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
sign on non-negative values.
If a leading zero is specified in the precision, and a nonzero width is
specified, then the printed value's integer part will be padded with leadin=
g
zeros up to one less than the field width. These zeros are placed before th=
e
sign.
</p><p>
</p></dd><dt><tt>s</tt></dt><dd>

Prints any object in a standard way, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
function.  Objects for
which read-print consistency is possible are printed in a way such that
if their notation is implanted in <b>TXR</b> source, they are readable.
The field width specifier is honored, including the left-right adjustment
semantics. The precision field is treated similarly to the
<tt>~a</tt>
format directive, except that non-exponentiated floating point numbers that
would be mistaken for integers include a trailing
<tt>.0</tt>
for the sake of read-print
consistency. Objects truncated by precision may not have read-print
consistency. For instance, if a string object is truncated, it loses its
trailing closing quote, so that the resulting representation is no longer
a properly formed string object. For integer objects, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD07CC">*print-ba=
se*</a></tt>
variable is honored. Effectively, an integer is printed by the
<tt>s</tt>
directive as if by the
<tt>b</tt>,
<tt>o</tt>,
<tt>d</tt>,
or
<tt>x</tt>
directive, depending on the value of the variable.
<p>
</p></dd><dt><tt>d</tt></dt><dd>

Requires an argument of integer or character type type. The integer
value or character code is printed in decimal.
<p>
</p></dd><dt><tt>x</tt></dt><dd>

Requires an argument of character or integer type. The integer value or
character code is printed in hexadecimal, using lower-case letters
for the digits
<tt>a</tt>
through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>.
Width and precision semantics
are as described for the
<tt>a</tt>
format directive, for integers.
<p>
</p></dd><dt><tt>X</tt></dt><dd>

Like the
<tt>x</tt>
directive, but the hexadecimal digits
<tt>a</tt>
through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
are rendered in upper case.
<p>
</p></dd><dt><tt>o</tt></dt><dd>

Like the
<tt>x</tt>
directive, but octal is used instead of hexadecimal.
<p>
</p></dd><dt><tt>b</tt></dt><dd>

Like the
<tt>x</tt>
directive, but binary is used instead of hexadecimal.
<p>
</p></dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDF=
A9">f</a></tt></dt><dd>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
directive prints numbers in a fixed point decimal notation, with
a fixed number of digits after the decimal point. It requires a numeric
argument. (Unlike
<tt>x</tt>,
<tt>X</tt>
and
<tt>o</tt>,
it does not allow an argument of character type).
The precision specifier gives the number of digits past the decimal point.
The number is rounded off to the specified precision, if necessary.
Furthermore, that many digits are always printed, regardless of the actual
precision of the number or its type.  If it is omitted, then the value
is obtained from the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F41F6C">*print-fl=
o-digits*</a></tt>,
whose default value is three: three digits past the decimal point. A precis=
ion
of zero means no digits pas the decimal point, and in this case the decimal
point is suppressed (regardless of whether the numeric argument is
floating-point or integer).
<p>
</p></dd><dt><tt>e</tt></dt><dd>

The
<tt>e</tt>
directive prints numbers in exponential notation. It requires
a numeric argument. (Unlike
<tt>x</tt>,
<tt>X</tt>
and
<tt>o</tt>,
it does not allow an argument of character type).
The precision specifier gives the number of digits past the decimal point
printed in the exponential notation, not counting the digits in the exponen=
t.
Exactly that many digits are printed, regardless of the precision of the
number.  If the precision is omitted, then the number of digits after the
decimal point is obtained from the value of the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F41F6C">*print-fl=
o-digits*</a></tt>,
whose default value is three. If the precision is zero, then a decimal port=
ion
is truncated off entirely, including the decimal point.
<p>
</p></dd><dt><tt>p</tt></dt><dd>

The
<tt>p</tt>
directive prints a numeric representation in hexadecimal of the bit pattern
of the object, which is meaningful to someone familiar with the internals
of <b>TXR</b>.  If the object is a pointer to heaped data, that value
has a correspondence to its address.
<p>
</p></dd><dt><tt>!</tt></dt><dd>

The
<tt>!</tt>
directive establishes hanging indentation, and turns on the stream's
indentation mode. Subsequent lines printed within the execution of the
same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
call will be automatically indented. If no width is specified, then
the directive sets the hanging indentation to the current printing
column position. If a width is specified, then it represents an offset
(positive or negative). If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
prefix character is present, the hanging indentation is set to the
specified offset relative to the current printing column.
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0022">&lt;</a></tt>
prefix is present on the width field, then the offset is applied
relative to the indentation which was saved on entry into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function.
<p>
The indentation mode and indentation column are automatically restored to t=
heir
previous values when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function terminates, naturally or via an exception or non-local jump.
</p><p>
The effect of a precision field (even if zero) combined with the
<tt>!</tt>
directive is currently not specified, and reserved for future extension.
The precision field is processed syntactically, and no error occurs, howeve=
r.
</p></dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-0347F537">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.8">9.44.8</a=
> Function <tt>fmt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fmt </tt><tt><i>format-string</i></tt><tt> </tt><tt><i>for=
mat-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0347F537">fmt</a></=
tt>
function provides a shorthand for formatting to a string, according
to the following equivalence which holds between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0347F537">fmt</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
47F537">fmt</a> s arg ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/t=
xr-manpage.html#N-011ACA52">format</a> nil s arg ...)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02FCCE0D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.9">9.44.9</a=
> Functions <tt>print</tt>, <tt>pprint</tt>, <tt>prinl</tt>, <tt>pprinl</tt=
>, <tt>tostring</tt> and <tt>tostringp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(print </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>stream</i>=
</tt><tt> [</tt><tt><i>pretty-p</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(pprint </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>stream</i=
></tt><tt>])=20




<br>&nbsp;&nbsp;(prinl </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>stream</i>=
</tt><tt>])=20




<br>&nbsp;&nbsp;(pprinl </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>stream</i=
></tt><tt>])=20




<br>&nbsp;&nbsp;(tostring </tt><tt><i>obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(tostringp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
functions render a printed character representation of the
<tt><i>obj</i></tt>
argument into
<tt><i>stream</i></tt>.
</p><p>
If the
<tt><i>stream</i></tt>
argument is not supplied, then
the destination is the stream currently stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
variable.
</p><p>
If Boolean argument
<tt><i>pretty-p</i></tt>
is not supplied or is explicitly specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
function renders in a way which strives for read-print
consistency: an object is printed in a notation which is recognized as
a similar object of the same kind when it appears in <b>TXR</b> source code=
.
Floating-point objects are printed as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function, with formatting controlled by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*print-fl=
o-format*</a></tt>
variable.
</p><p>
If
<tt><i>pretty-p</i></tt>
is true, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
does not strive for read-print consistency.
Strings are printed by sending their characters to the output
stream, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
function, rather than being rendered in the string literal notation
consisting of double quotes, and escape sequences for control
characters.  Likewise, character objects are printed via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>
rather than the
<tt>#\</tt>
notation. Buffer objects are printed by sending their bytes to the
output stream using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
rather than being rendered in the
<tt>#b</tt>
notation.
Symbols are printed without their package prefix, except that
symbols from the keyword package are still printed with the leading colon.
Floating-point objects are printed as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function, with formatting controlled by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*pprint-f=
lo-format*</a></tt>
variable.
</p><p>
When aggregate objects like conses, ranges and vectors are printed,
the notations of these objects themselves are unaffected by the
<tt>pretty-p</tt>
flag; however, that flag is distributed to the elements.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
function returns
<tt><i>obj</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
("pretty print") function is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>,
with the
<tt><i>pretty-p</i></tt>
argument hard-coded true.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>
function ("print and new line") behaves like a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
with
<tt><i>pretty-p</i></tt>
defaulting to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
followed by issuing a newline characters to the stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>
function ("pretty print and new line") behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
followed by issuing a newline to the stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostring<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostringp=
</a></tt>
functions are like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>,
but they do not accept a stream argument. Instead they print to a freshly
instantiated string stream, and return the resulting string.
</p><p>
The following equivalences hold between calls to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a=
></tt>
function and calls to the above functions:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
1ACA52">format</a> stream "~s" obj)  &lt;--&gt;  (<a href=3D"http://nongnu.=
org/txr/txr-manpage.html#D-007D">print</a> obj stream)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a>=
 t "~s" obj)       &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#D-007D">print</a> obj)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a>=
 t "~s\n" obj)     &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-02FCCE0D">prinl</a> obj)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a>=
 nil "~s" obj)     &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-02FCCE0D">tostring</a> obj)
</tt></pre><tt>

</tt>

<p>
For
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">tostringp=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>,
the equivalence is produced by using
<tt>~a</tt>
in format rather than
<tt>~s</tt>.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


For floating-point numbers, the above description of the behavior in
terms of the format specifiers
<tt>~s</tt>
and
<tt>~a</tt>
only applies with respect to the default values of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*print-fl=
o-format*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B252AA">*pprint-f=
lo-format*</a></tt>.
</p><p>
For characters, the print function behaves as follows: most control
characters in the Unicode
<tt>C0</tt>
and
<tt>C1</tt>
range are rendered using the
<tt>#\x</tt>
notation,
using two hex digits. Codes in the range
<tt>D800</tt>
to
<tt>DFFF</tt>,
and the codes
<tt>FFFE</tt>
and
<tt>FFFF</tt>
are printed in the
<tt>#\xNNNN</tt>
with four hexadecimal digits, and
character above this range are printed using the same notation, but with si=
x
hexadecimal digits. Certain characters in the
<tt>C0</tt>
range are printed using
their names such as
<tt>#\nul</tt>
and
<tt>#\return</tt>,
which are documented
in the Character Literals section.
The
<tt>DC00</tt>
character is printed as
<tt>#\pnul</tt>.
All other characters are printed as
<tt>




#\</tt><tt><i>char</i></tt><tt>=20

</tt>

where
<tt><i>char</i></tt>
is the actual character.
</p><p>
Caution: read-print consistency is affected by trailing material. If additi=
onal
digits are printed immediately after a number without intervening whitespac=
e,
they extend that number. If hex digits are printed after the character
<tt>x</tt>,
which is rendered as
<tt>#\x</tt>,
they look like a hex character code.
</p><p>

</p></dd></dl>
<a name=3D"N-0217DE45">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.10">9.44.10<=
/a> Function <tt>tprint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tprint </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>stream</i=
></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a=
></tt>
function prints a representation of
<tt><i>obj</i></tt>
on
<tt><i>stream</i></tt>.
</p><p>
If the stream argument is not supplied, then
the destination is the stream currently stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
variable.
</p><p>
For all object types except lists and vectors,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a=
></tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>.
</p><p>
If
<tt>obj</tt>
is a list or vector, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a=
></tt>
recurses: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a=
></tt>
function is applied to each element.  An empty list or vector
results in no output at all.  This effectively means that an arbitrarily ne=
sted
structure of lists and vectors is printed flattened, with one element on ea=
ch
line.
</p><p>

</p></dd></dl>
<a name=3D"N-0263C039">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.11">9.44.11<=
/a> Function <tt>display-width</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(display-width </tt><tt><i>char</i></tt><tt>)=20




<br>&nbsp;&nbsp;(display-width </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0263C039">display-w=
idth</a></tt>
function calculates the number of places occupied by the printed representa=
tion
of
<tt><i>char</i></tt>
or
<tt><i>string</i></tt>
on a monospace display which renders certain characters, such as the East A=
sian
kanji and other characters, using two places.
</p><p>
For a
<tt><i>string</i></tt>
argument, this value is the sum of the individual display width of the
string's constituent characters. The display width of an empty string is ze=
ro.
</p><p>
Control characters are assigned a display width of zero, regardless of
their display control semantics, if any.
</p><p>
Characters marked by Unicode as being wide or full width, have a display
width of two. Other characters have a display width of one.
</p><p>

</p></dd></dl>
<a name=3D"N-02BB4421">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.12">9.44.12<=
/a> Function <tt>streamp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(streamp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BB4421">streamp</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is any type of stream.  Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0121FDEB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.13">9.44.13<=
/a> Function <tt>real-time-stream-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(real-time-stream-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>real-time-streamp-p</tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a stream marked as
"real-time".  If
<tt><i>obj</i></tt>
is not a stream, or not a stream marked as "real-time",
then it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Only certain kinds of streams accept the real-time attribute: file streams =
and
tail streams. This attribute controls the semantics of the application of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
to the stream.  For a real-time stream,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
returns a stream with "naive" semantics which returns data as soon as it is
available, at the cost of generating spurious
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
item when the stream
terminates. The application has to recognize and discard that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
item.
The ordinary lazy streams read ahead by one line and suppress this extra
item, so their representation is more accurate.
</p><p>
When <b>TXR</b> starts up, it automatically marks the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream as real-time, if it is connected to a TTY device (a device for which
the POSIX function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03709E8A">isatty</a=
></tt>
reports true). This is only supported on platforms that have this function.
The behavior is overridden by the
<tt>-n</tt>
command line option.
</p><p>

</p></dd></dl>
<a name=3D"N-02B8FBBD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.14">9.44.14<=
/a> Function <tt>open-file</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-file </tt><tt><i>path</i></tt><tt> [</tt><tt><i>mode-=
string</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function creates a stream connected to the file
which is located at the given
<tt><i>path</i></tt>,
which is a string.
</p><p>
The
<tt><i>mode-string</i></tt>
argument is a string which uses the same
conventions as the mode argument of the C language
<tt>fopen</tt>
function, with greater permissiveness, and some extensions.
</p><p>
The syntax of mode-string is described by the following
grammar. Note that it permits no whitespace characters:
</p><p>
<tt>




<br>&nbsp;&nbsp;</tt><tt><i>mode-string</i></tt><tt> :=3D [ </tt><tt><i>mod=
e</i></tt><tt> ] [ </tt><tt><i>options</i></tt><tt> ]=20




<br>&nbsp;&nbsp;</tt><tt><i>mode</i></tt><tt> :=3D { </tt><tt><i>selector</=
i></tt><tt> [ + ] | + }=20




<br>&nbsp;&nbsp;</tt><tt><i>selector</i></tt><tt> :=3D { r | w | a | m }=20




<br>&nbsp;&nbsp;</tt><tt><i>options</i></tt><tt> :=3D { b | l | u | i | n |=
 </tt><tt><i>digit</i></tt><tt> | </tt><tt><i>redirection</i></tt><tt> }=20




<br>&nbsp;&nbsp;</tt><tt><i>digit</i></tt><tt> :=3D { 0 | 1 | 2 | 3 | 4 | 5=
 | 6 | 7 | 8 | 9 }=20

</tt>

</p><p>
If the
<tt><i>mode-string</i></tt>
argument is omitted, the behavior is the same as an empty
mode string.
</p><p>
The
<tt><i>mode</i></tt>
part of the mode string generates the following possibilities:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>empty
</tt></dt><dd>



If the
<tt><i>mode</i></tt>
is missing, then a default mode is implied. The default
is specific to the particular stream-opening function. In
the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>,
the default mode is
<tt>r</tt>.
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a=
></tt></dt><dd>

A
<tt><i>mode</i></tt>
consisting of just the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
character is equivalent to
<tt>r+</tt>.
</dd><dt><tt>r</tt></dt><dd>

This
<tt><i>mode</i></tt>
means that the file is opened for reading.
</dd><dt><tt>r+</tt></dt><dd>

The file is opened for reading and writing.  It is not created
if it doesn't exist.
</dd><dt><tt>w</tt></dt><dd>

The file is opened for writing. If it exists, it is truncated
to zero length. If it doesn't exist, it is created.
</dd><dt><tt>w+</tt></dt><dd>

The file is opened for reading and writing. If it exists, it
is truncated to zero length. If it doesn't exist, it is created.
</dd><dt><tt>m</tt></dt><dd>

The file is opened for modification. This is the same as
<tt>w</tt>
except that the file is not truncated if it exists.
</dd><dt><tt>m+</tt></dt><dd>

The file is opened for reading and modification. This is the same as
<tt>w+</tt>
except that the file is not truncated if it exists.
</dd><dt><tt>a</tt></dt><dd>

The file is opened for writing. If it doesn't exist, it is
created. If it exists, the current position is advanced to
one byte past the end of the file, so that newly written data
are appended.
</dd><dt><tt>a+</tt></dt><dd>

The file is opened for reading and writing. If it doesn't exist,
it is created. The read position is at the beginning of the file,
but writes are appended to the end regardless of the position.
</dd></dl>
</dl>

The meanings of the option characters are:
<dl class=3D"indent">

<dl class=3D"items">
<dt><tt>b</tt></dt><dd>

The file is opened in binary mode: no line ending translation takes place.
In the absence of this option, files are opened in text mode, in which newl=
ine
characters in the stream are an abstract indication of the end of a line,
translate to a system-specific way of terminating lines in text files.
</dd><dt><tt>l</tt></dt><dd>

Specifies that the stream will be line buffered.  This means that an implic=
it
flush operation takes place whenever the newline character is output.
</dd><dt><tt>u</tt></dt><dd>

Specifies that the stream will be unbuffered.  It is erroneous for both
<tt>l</tt>
and
<tt>u</tt>
to be specified.
</dd><dt><tt>i</tt></dt><dd>

Specifies that the stream will have the real-time
property set. For a description of the semantics, see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0121FDEB">real-time=
-stream-p</a></tt>
function. Briefly, this property affects the semantics of lazy lists which =
draw
input from the stream.
In addition, for a stream opened for writing or reading and writing, the
<tt>i</tt>
mode letter specifies that the stream will be line buffered, unless
specified as unbuffered with
<tt>u</tt>.
</dd><dt><tt>n</tt></dt><dd>

Specifies that the operation shall not block.



</dd><dt><tt>digit
</tt></dt><dd>



A decimal digit specifies the the stream buffer size
as binary exponential buffer size order, such that
<tt>0</tt>
specifies 1024 bytes,
<tt>1</tt>
specifies 2048 and so forth up to
<tt>9</tt>
specifying 524288 bytes. If no such digit is specified, then the
stream uses a default buffer size. It is erroneous for the
size order digit to be present together with the option
<tt>u</tt>.



</dd><dt><tt>redirection
</tt></dt><dd>



This option refers to a special syntax that only has an effect
in mode strings that are passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-proc=
ess</a></tt>
function; the syntax performs I/O redirections in the child process
created by that function, and is described in that function's
documentation.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-0348F89A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.15">9.44.15<=
/a> Function <tt>open-tail</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-tail </tt><tt><i>path</i></tt><tt> [</tt><tt><i>mode-=
string</i></tt><tt> [</tt><tt><i>seek-to-end-p</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0348F89A">open-tail=
</a></tt>
function creates a tail stream connected to the file which is
located at the given
<tt><i>path</i></tt>.
The
<tt><i>mode-string</i></tt>
argument is a string which uses
the same conventions as the mode argument of the C language
<tt>fopen</tt>
function. If this argument is omitted, then
<tt>"r"</tt>

is used.
See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function for a discussion of modes.
</p><p>
The
<tt>seek-to-end-p</tt>
argument is a Boolean which determines whether the initial
read/write position is at the start of the file, or just past the end.
It defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This argument only makes a difference if the file exists
at the time
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0348F89A">open-tail=
</a></tt>
is called. If the file does not exist, and is later
created, then the tail stream will follow that file from the beginning.  In
other words,
<tt><i>seek-to-end-p</i></tt>
controls whether the tail stream reads all the
existing data in the file, if any, or whether it reads only newly added dat=
a
from approximately the time the stream is created.
</p><p>
A tail stream has special semantics with regard to reading at the end
of file. A tail stream never reports an end-of-file condition; instead
it polls the file until more data is added. Furthermore, if the file
is truncated, or replaced with a smaller file, the tail stream follows
this change: it automatically opens the smaller file and starts reading fro=
m
the beginning (the
<tt><i>seek-to-end-p</i></tt>
flag only applies to the initial open).
In this manner, a tail stream can dynamically growing rotating log files.
</p><p>
Caveat: since a tail stream can re-open a new file which has the same
name as the original file, it behave incorrectly if the program
changes the current working directory, and the path name is relative.
</p><p>

</p></dd></dl>
<a name=3D"N-0221AE09">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.16">9.44.16<=
/a> Function <tt>open-directory</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-directory </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0221AE09">open-dire=
ctory</a></tt>
function tries to create a stream which reads the
directory given by the string argument
<tt><i>path</i></tt>.
If a filesystem object exists
under the path, is accessible, and is a directory, then the function
returns a stream. Otherwise, a file error exception is thrown.
</p><p>
The resulting stream supports the get-line operation. Each call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
operation retrieves a string representing the next directory
entry. The value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned when there are no more directory entries.
The
<tt>.</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217A971">..</a></t=
t>
entries in Unix filesystems are not skipped.
</p><p>

</p></dd></dl>
<a name=3D"N-00F0B9B0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.17">9.44.17<=
/a> Function <tt>make-string-input-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-string-input-stream </tt><tt><i>string</i></tt><tt>)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F0B9B0">make-stri=
ng-input-stream</a></tt>
function produces an input stream object. Character read operations on the
stream object read successive characters from
<tt><i>string</i></tt>.
Output operations and byte operations are not supported.
</p><p>

</p></dd></dl>
<a name=3D"N-022937CD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.18">9.44.18<=
/a> Function <tt>make-string-byte-input-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-string-byte-input-stream </tt><tt><i>string</i></tt><=
tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022937CD">make-stri=
ng-byte-input-stream</a></tt>
function produces an input stream object. Byte read operations on
this stream object read successive byte values obtained by encoding
<tt><i>string</i></tt>
into UTF-8. Character read operations are not supported, and neither
are output operations.
</p><p>

</p></dd></dl>
<a name=3D"N-01737CF9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.19">9.44.19<=
/a> Function <tt>make-strlist-input-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-strlist-input-stream </tt><tt><i>list</i></tt><tt>)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01737CF9">make-strl=
ist-input-stream</a></tt>
function produces an input stream object based on a list of strings.
Through the character read operations invoked on this stream,
the list of strings appears as a list of newline-terminated lines.
Output operations and byte operations are not supported.
</p><p>

</p></dd></dl>
<a name=3D"N-0144BF51">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.20">9.44.20<=
/a> Function <tt>make-string-output-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-string-output-stream)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0144BF51">make-stri=
ng-output-stream</a></tt>
function, which takes no arguments, creates a string output stream.
Data sent to this stream is accumulated into a string object.
String output streams supports both character and byte output operations.
Bytes are assumed to represent a UTF-8 encoding, and are decoded in order
to form characters which are stored into the string.
</p><p>
If an incomplete UTF-8 code is output, and a character output operation the=
n
takes place, that code is assumed to be terminated and is decoded as invali=
d
bytes.  The UTF-8 decoding machine is reset and ready for the start of a ne=
w
code.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037412EE">get-strin=
g-from-stream</a></tt>
function is used to retrieve the accumulated string.
</p><p>
If the null character is written to a string output stream, the behavior
is unspecified. <b>TXR</b> strings cannot contain null bytes. A the pseudo-=
null
character
<tt>#\xDC00</tt>,
also notated
<tt>#\pnul</tt>,
will produce a null byte when converted to UTF-8 and thus serves as an
effective internal representation of the null character in external data.
</p><p>

</p></dd></dl>
<a name=3D"N-037412EE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.21">9.44.21<=
/a> Function <tt>get-string-from-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-string-from-stream </tt><tt><i>stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>stream</i></tt>
argument must be a string output stream. This function finalizes
the data sent to the stream and retrieves the accumulated character string.
</p><p>
If a partial UTF-8 code has been written to
<tt><i>stream</i></tt>,
and then this
function is called, the byte stream is considered complete and the partial
code is decoded as invalid bytes.
</p><p>
After this function is called, further output on the stream is not possible=
.
</p><p>

</p></dd></dl>
<a name=3D"N-00F363E0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.22">9.44.22<=
/a> Function <tt>make-strlist-output-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-strlist-output-stream)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F363E0">make-strl=
ist-output-stream</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0144BF51">make-stri=
ng-output-stream</a></tt>.
However, the stream object produced by this function does not produce a str=
ing,
but a list of strings.  The data is broken into multiple strings by newline
characters written to the stream. Newline characters do not appear in the
string list. Also, byte output operations are not supported.
</p><p>

</p></dd></dl>
<a name=3D"N-021DF087">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.23">9.44.23<=
/a> Function <tt>get-list-from-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-list-from-stream </tt><tt><i>stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021DF087">get-list-=
from-stream</a></tt>
function returns the string list which has accumulated inside
a string output stream given by
<tt><i>stream</i></tt>.
The string output stream is
finalized, so that further output is no longer possible.
</p><p>

</p></dd></dl>
<a name=3D"N-004ED7A0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.24">9.44.24<=
/a> Macro <tt>with-in-string-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-in-string-stream (</tt><tt><i>stream-var</i></tt><tt>=
 </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004ED7A0">with-in-s=
tring-stream</a></tt>
macro binds the symbol
<tt><i>stream-var</i></tt>
as a variable, initializing it with a newly created
string input stream. The string input stream is
constructed from
<tt><i>string</i></tt>
as if by the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F0B9B0">make-string-=
input-stream</a> </tt><tt><i>string</i></tt><tt>)=20

</tt>

expression.
</p><p>
Then it evaluates the
<tt><i>body-form</i></tt>-s
in the scope of the variable.
</p><p>
The value of the last
<tt><i>body-form</i></tt>
is returned, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if no forms are present.
</p><p>
The
<tt><i>stream-var</i></tt>
argument must be a bindable symbol,
as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function.
</p><p>
The
<tt><i>string</i></tt>
argument must be a form
which evaluates to a character string value.
</p><p>

</p></dd></dl>
<a name=3D"N-00FD832E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.25">9.44.25<=
/a> Macro <tt>with-in-string-byte-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-in-string-byte-stream (</tt><tt><i>stream-var</i></tt=
><tt> </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FD832E">with-in-s=
tring-byte-stream</a></tt>
macro binds the symbol
<tt><i>stream-var</i></tt>
as a variable, initializing it with a newly created
string byte input stream. The string input stream is
constructed from
<tt><i>string</i></tt>
as if by the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022937CD">make-string-=
byte-input-stream</a> </tt><tt><i>string</i></tt><tt>)=20

</tt>

expression.
</p><p>
Then it evaluates the
<tt><i>body-form</i></tt>-s
in the scope of the variable.
</p><p>
The value of the last
<tt><i>body-form</i></tt>
is returned, or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if no forms are present.
</p><p>
The
<tt><i>string</i></tt>
argument must be a form
which evaluates to a character string value.
</p><p>

</p></dd></dl>
<a name=3D"N-0001C63C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.26">9.44.26<=
/a> Macro <tt>with-out-string-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-out-string-stream (</tt><tt><i>stream-var</i></tt><tt=
>) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0001C63C">with-out-=
string-stream</a></tt>
macro binds the symbol specified
by the
<tt><i>stream-var</i></tt>
argument as a variable, initializing it
with a newly created string output stream. The output
stream is created as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0144BF51">make-stri=
ng-output-stream</a></tt>
function.
</p><p>
Then it evaluates
<tt><i>body-form</i></tt>-s
in the scope of that variable.
</p><p>
After these forms are evaluated, the string is extracted
from the string output stream, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037412EE">get-strin=
g-from-stream</a></tt>
function, and returned as the result value
of the form.
</p><p>

</p></dd></dl>
<a name=3D"N-024F86B3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.27">9.44.27<=
/a> Macro <tt>with-out-strlist-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-out-strlist-stream (</tt><tt><i>stream-var</i></tt><t=
t>) </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024F86B3">with-out-=
strlist-stream</a></tt>
macro binds the symbol specified
by the
<tt><i>stream-var</i></tt>
argument as a variable, initializing it
with a newly created string list output stream. The output
stream is created as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F363E0">make-strl=
ist-output-stream</a></tt>
function.
</p><p>
Then it evaluates
<tt><i>body-form</i></tt>-s
in the scope of that variable.
</p><p>
After these forms are evaluated, the string list is extracted
from the string output stream, as if by the
<tt>get-strlist-from-stream</tt>
function, and returned as the result value
of the form.
</p><p>

</p></dd></dl>
<a name=3D"N-03F54E14">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.28">9.44.28<=
/a> Function <tt>make-byte-input-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-byte-input-stream </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F54E14">make-byte=
-input-stream</a></tt>
creates a stream which supports the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
operation for traversing a byte-wise representation of
<tt><i>obj</i></tt>.
</p><p>
The function serves as a generic interface for calling one of
several other stream constructing functions based on the
type of the
<tt><i>obj</i></tt>
argument.
</p><p>
The
<tt><i>obj</i></tt>
argument must be either a buffer, in which case
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F54E14">make-byte=
-input-stream</a></tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F5647C">make-buf-=
stream</a></tt>,
or else a string, in which case the function behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022937CD">make-stri=
ng-byte-input-stream</a></tt>.
</p><p>
Note: the repertoire of types handled by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F54E14">make-byte=
-input-stream</a></tt>
may expand in future language versions.
</p><p>

</p></dd></dl>
<a name=3D"N-00596930">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.29">9.44.29<=
/a> Function <tt>close-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(close-stream </tt><tt><i>stream</i></tt><tt> [</tt><tt><i>=
throw-on-error-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00596930">close-str=
eam</a></tt>
function performs a close operation on
<tt><i>stream</i></tt>,
whose meaning is depends on the type of the stream. For some types of strea=
ms,
such as string streams, it does nothing. For streams which are connected
to operating system files or devices, will perform a close of the underlyin=
g
file descriptor, and dissociate that descriptor from the stream. Any buffer=
ed
data is flushed first.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00596930">close-str=
eam</a></tt>
returns a Boolean true value if the close has occurred without
errors, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
For most streams, "without errors" means that any buffered output data is
flushed successfully.
</p><p>
For command and process pipes (see open-command and open-process), success =
also
means that the process terminates normally, with a successful error code, o=
r an
unsuccessful one. An abnormal termination is considered an error, as
as is the inability to retrieve the termination status, as well as the situ=
ation
that the process continues running in spite of the close attempt.
Detecting these situations is platform specific.
</p><p>
If the
<tt><i>throw-on-error-p</i></tt>
argument is specified, and isn't
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the
function throws an exception if an error occurs during the close operation
instead of returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-013E33A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.30">9.44.30<=
/a> Macro <tt>with-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-stream (</tt><tt><i>stream-var</i></tt><tt> </tt><tt>=
<i>init-form</i></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013E33A2">with-stre=
am</a></tt>
binds the variable whose name is given by the
<tt><i>stream-var</i></tt>
argument, and macro arranges for the evaluation of
<tt><i>body-form</i></tt>-s
in the scope of that variable.
</p><p>
The variable is initialized with the value produced
by the evaluation of
<tt><i>init-form</i></tt>
which must be an expression which evaluates to a stream.
</p><p>
After each
<tt><i>body-form</i></tt>
is evaluated, the stream is closed, as if by the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00596930">close-stream=
</a> </tt><tt><i>stream-var</i></tt><tt>)=20

</tt>

expression.
</p><p>
The value of the last
<tt><i>body-form</i></tt>
then becomes the result value of the form,
or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if these forms are absent.
</p><p>
If the evaluation of the
<tt><i>body-form</i></tt>-s
is abandoned, the stream is still closed. That is to say,
the closure of the stream is a protected action, as if by
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-pr=
otect</a></tt>
operator.
</p><p>

</p></dd></dl>
<a name=3D"N-01060C4A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.31">9.44.31<=
/a> Functions <tt>get-error</tt>, <tt>get-error-str</tt> and <tt>clear-erro=
r</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-error </tt><tt><i>stream</i></tt><tt>)=20




<br>&nbsp;&nbsp;(get-error-str </tt><tt><i>stream</i></tt><tt>)=20




<br>&nbsp;&nbsp;(clear-error </tt><tt><i>stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



When a stream operation fails, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005B">get-error</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0021">get-error-str=
</a></tt>
functions may be used to inquire about a more detailed cause of the error.
</p><p>
Not all streams support these functions to the same extent. For instance,
string input streams have no persistent state. The only error which occurs
is the condition when the string has no more data.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005B">get-error</a>=
</tt>
inquires
<tt><i>stream</i></tt>
about its error condition.
</p><p>
The function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to indicate there is no error condition,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
to indicate an end-of-data condition,
or else a value which is specific to the stream type indicating the
specific error type.
</p><p>
Note: for some streams, it is possible for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
value to be returned even though no operation has failed; that is to say, t=
he
streams "know" they are at the end of the data even though no read operatio=
n
has failed. Code which depends on this will not work with streams which
do not thus indicate the end-of-data
<i>a priori</i>,

but by means of a read operation which fails.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0021">get-error-str=
</a></tt>
function returns a text representation of the error code. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
error code is represented as the string
<tt>no error</tt>;
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
error code as
<tt>eof</tt>
and other codes have a stream-specific representation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0017">clear-error</=
a></tt>
function removes the error situation from a stream. On some streams, it doe=
s
nothing. If an error has occurred on a stream, this function should be call=
ed
prior to re-trying any I/O or positioning operations.
The return value is the previous error code, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there was no error, or the operation is not supported on the stream.
</p><p>

</p></dd></dl>
<a name=3D"N-01EF7E47">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.32">9.44.32<=
/a> Functions <tt>get-line</tt>, <tt>get-char</tt> and <tt>get-byte</tt></h=
4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-line [</tt><tt><i>stream</i></tt><tt>])=20




<br>&nbsp;&nbsp;(get-char [</tt><tt><i>stream</i></tt><tt>])=20




<br>&nbsp;&nbsp;(get-byte [</tt><tt><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These fundamental stream functions perform input.  The
<tt><i>stream</i></tt>
argument
is optional. If it is specified, it should be an input stream which support=
s
the given operation. If it is not specified, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream is used.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>
function pulls a character from a stream which supports character
input.  Streams which support character input also support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
function which extracts a line of text delimited by the end of the stream o=
r a
newline character and returns it as a string. (The newline character does n=
ot
appear in the string which is returned).
</p><p>
Character input from streams based on bytes requires UTF-8 decoding, so tha=
t
get-char actually may read several bytes from the underlying low level
operating system stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
function bypasses UTF-8 decoding and reads raw bytes from
any stream which supports byte input. Bytes are represented as integer
values in the range 0 to 255.
</p><p>
Note that if a stream supports both byte input and character input, then mi=
xing
the two operations will interfere with the UTF-8 decoding.
</p><p>
These functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
when the end of data is reached.  Errors are
represented as exceptions.
</p><p>
See also:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
</p><p>

</p></dd></dl>
<a name=3D"N-00BE9AAC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.33">9.44.33<=
/a> Function <tt>get-string</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-string [</tt><tt><i>stream</i></tt><tt> [</tt><tt><i>c=
ount</i></tt><tt> [</tt><tt><i>close-after-p</i></tt><tt>]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE9AAC">get-strin=
g</a></tt>
function reads characters from a stream, and assembles them into
a string, which is returned. If the
<tt><i>stream</i></tt>
argument is omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream is used.
</p><p>
The stream is closed after extracting the data, unless
<tt><i>close-after-p</i></tt>
is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The default value of this argument is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
If the
<tt><i>count</i></tt>
argument is missing, then all of the characters from the
stream are read and assembled into a string.
</p><p>
If present, the
<tt><i>count</i></tt>
argument should be a positive integer indicating
a limit on how many characters to read. The returned string will be no
longer than
<tt><i>count</i></tt>,
but may be shorter.
</p><p>

</p></dd></dl>
<a name=3D"N-0260DBDD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.34">9.44.34<=
/a> Functions <tt>unget-char</tt> and <tt>unget-byte</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(unget-char </tt><tt><i>char</i></tt><tt> [</tt><tt><i>stre=
am</i></tt><tt>])=20




<br>&nbsp;&nbsp;(unget-byte </tt><tt><i>byte</i></tt><tt> [</tt><tt><i>stre=
am</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions put back, into a stream, a character or byte which was
previously read.  The character or byte must match the one which was most
recently read. If the
<tt><i>stream</i></tt>
argument is omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream is used.
</p><p>
If the operation succeeds, the byte or character value is returned.
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
return indicates that the operation is unsupported.
</p><p>
Some streams do not support these operations; some support
only one of them.   In general, if a stream supports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>,
it supports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>,
and likewise for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>.
</p><p>
Streams may require a pushed back byte or character to match
the character which was previously read from that stream
position, and may not allow a byte or character to be pushed
back beyond the beginning of the stream.
</p><p>
Space may be available for only one byte of pushback under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
operation.
</p><p>
The number of characters that may be pushed back by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
is not limited.
</p><p>
Pushing both a byte and a character, in either order, is also unsupported.
Pushing a byte and then reading a character, or pushing a character and
reading a byte, are unsupported mixtures of operations.
</p><p>
If the stream is binary, then pushing back a byte decrements its position,
except if the position is already zero. At that point, the position becomes
indeterminate.
</p><p>
The behavior of pushing back immediately after a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>
positioning operation is unspecified.
</p><p>

</p></dd></dl>
<a name=3D"N-012163C3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.35">9.44.35<=
/a> Functions <tt>put-string</tt>, <tt>put-line</tt>, <tt>put-char</tt> and=
 <tt>put-byte</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(put-string </tt><tt><i>string</i></tt><tt> [</tt><tt><i>st=
ream</i></tt><tt>])=20




<br>&nbsp;&nbsp;(put-line [</tt><tt><i>string</i></tt><tt> [</tt><tt><i>str=
eam</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(put-char </tt><tt><i>char</i></tt><tt> [</tt><tt><i>stream=
</i></tt><tt>])=20




<br>&nbsp;&nbsp;(put-byte </tt><tt><i>byte</i></tt><tt> [</tt><tt><i>stream=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions perform output on an output stream. The
<tt><i>stream</i></tt>
argument
must be an output stream which supports the given operation. If it is omitt=
ed,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
is used.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>
function writes a character given by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
to a stream. If the
stream is based on bytes, then the character is encoded into UTF-8 and mult=
iple
bytes are written. Streams which support
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>
also support put-line, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
function writes the characters of a string out to
the stream as if by multiple calls to put-char. The
<tt><i>string</i></tt>
argument
may be a symbol, in which case its name is used as the string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line<=
/a></tt>
function is like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>,
but also writes an additional newline
character. The string is optional in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line<=
/a></tt>,
and defaults to the empty string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
function writes a raw byte given by the
<tt><i>byte</i></tt>
argument
to
<tt><i>stream</i></tt>,
if
<tt><i>stream</i></tt>
supports a byte write operation. The byte
value is specified as an integer value in the range 0 to 255.
</p><p>
All these functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
On failure, they do not return, but throw exceptions of type
<tt>file-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0367B282">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.36">9.44.36<=
/a> Functions <tt>put-strings</tt> and <tt>put-lines</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(put-strings </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i=
>stream</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(put-lines </tt><tt><i>sequence</i></tt><tt> [</tt><tt><i>s=
tream</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions assume
<tt><i>sequence</i></tt>
to be a sequence of strings, or of
symbols, or a mixture thereof. These strings are sent to the stream.  The
<tt><i>stream</i></tt>
argument must be an output stream.  If it is omitted, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
is used.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367B282">put-strin=
gs</a></tt>
function iterates over
<tt><i>sequence</i></tt>
and writes each element
to the stream as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367B282">put-lines=
</a></tt>
function iterates over
<tt>sequence</tt>
and writes each element
to the stream as if using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line<=
/a></tt>
function.
</p><p>
Both functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-03999913">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.37">9.44.37<=
/a> Function <tt>flush-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(flush-stream [</tt><tt><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03999913">flush-str=
eam</a></tt>
function is meaningful for output streams which accumulate data
which is passed on to the operating system in larger transfer units.
Calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03999913">flush-str=
eam</a></tt>
causes all accumulated data inside
<tt><i>stream</i></tt>
to be passed
to the operating system. If called on streams for which this function is no=
t
meaningful, it does nothing, and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>stream</i></tt>
is omitted, the current value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
is used.
</p><p>

</p></dd></dl>
<a name=3D"N-031B5075">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.38">9.44.38<=
/a> Function <tt>seek-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(seek-stream </tt><tt><i>stream</i></tt><tt> </tt><tt><i>of=
fset</i></tt><tt> </tt><tt><i>whence</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>
function is meaningful for file streams. It changes the
current read/write position within
<tt><i>stream</i></tt>.
It can also be used to determine the current position: see the notes about =
the
return value below. </p><p>
The
<tt><i>offset</i></tt>
argument is a positive or negative integer which gives a
displacement that is measured from the point identified by the
<tt><i>whence</i></tt>
argument.
</p><p>
Note that for text files, there isn't necessarily a 1:1 correspondence betw=
een
characters and positions due to line-ending conversions and conversions
to and from UTF-8.
</p><p>
The
<tt><i>whence</i></tt>
argument is one of three keywords: :from-start, :from-current
and :from-end. These denote the start of the file, the current position
and the end of the file.
</p><p>
If
<tt><i>offset</i></tt>
is zero, and
<tt><i>whence</i></tt>
is
<tt>:from-current</tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>
returns the current absolute position within the
stream, if it can successfully obtain it. Otherwise, it
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it is successful.
</p><p>
If a character has been successfully put back into a text stream with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
and is still pending, then the position value is unspecified. If a
byte has been put back into a binary stream with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>,
and the previous position wasn't zero, then the position is decremented by =
one.
</p><p>
On failure, it throws an exception of type
<tt>stream-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-009F5B3F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.39">9.44.39<=
/a> Function <tt>truncate-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(truncate-stream </tt><tt><i>stream</i></tt><tt> [</tt><tt>=
<i>length</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009F5B3F">truncate-=
stream</a></tt>
causes the length of the underlying file associated with
<tt><i>stream</i></tt>
to be set to
<tt><i>length</i></tt>
bytes.
</p><p>
The stream must be a file stream, and must be open for writing.
</p><p>
If
<tt><i>length</i></tt>
is omitted, then it defaults to the current position, retrieved
as if by invoking the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>
with an
<tt><i>offset</i></tt>
argument of zero and
<tt><i>whence</i></tt>
argument of
<tt>:from-current</tt>.
Hence, after the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009F5B3F">truncate-=
stream</a></tt>
operation, that position is one byte past the end of the file.
</p><p>

</p></dd></dl>
<a name=3D"N-005268C8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.40">9.44.40<=
/a> Functions <tt>stream-get-prop</tt> and <tt>stream-set-prop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(stream-get-prop </tt><tt><i>stream</i></tt><tt> </tt><tt><=
i>indicator</i></tt><tt>)=20




<br>&nbsp;&nbsp;(stream-set-prop </tt><tt><i>stream</i></tt><tt> </tt><tt><=
i>indicator</i></tt><tt> </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions get and set properties on a stream. Only certain properties
are meaningful with certain kinds of streams, and the meaning depends on
the stream. If two or more stream types support a property of the same name=
, it
is expected that the property has the same or similar meaning for both
streams to the maximum extent that similarity is possible.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005268C8">stream-se=
t-prop</a></tt>
function sets a property on a stream. The
<tt><i>indicator</i></tt>
argument is a symbol, usually a keyword symbol, denoting the property,
and
<tt><i>value</i></tt>
is the property value. If the stream understands and accepts the
property, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005268C8">stream-ge=
t-prop</a></tt>
function inquires about the value of a property on a
stream. If the stream understands the property, then it returns its current
value.  If the stream does not understand a property, nil is returned, whic=
h is
also returned if the property exists, but its value happens to be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt>:name</tt>
property is widely supported by streams of various types. It associates
the stream with a name. This property is not always modifiable.
</p><p>
File, process and stream socket I/O streams have a
<tt>:fd</tt>
property which can be accessed, but not modified. It retrieves
the same value as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function.
</p><p>
The "real time"
property supported by these streams, connected with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0121FDEB">real-time=
-stream-p</a></tt>
function, also appears as the
<tt>:real-time</tt>
property.
</p><p>
I/O streams also have a property called
<tt>:byte-oriented</tt>
which, if set, suppresses the decoding of UTF-8 on character input. Rather,
each byte of the file corresponds directly to one character. Bytes
in the range 1 to 255 correspond to the character code points U+0001
to U+00FF. Byte value 0 is mapped to the code point U+DC00.
</p><p>
The logging priority of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02841215">*stdlog*<=
/a></tt>
syslog stream is controlled by the
<tt>:prio</tt>
property.
</p><p>
If
<tt><i>stream</i></tt>
is a catenated stream (see the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020BF082">make-cate=
nated-stream</a></tt>)
then these functions transparently operate on the current head stream of th=
e
catenation.
</p><p>

</p></dd></dl>
<a name=3D"N-020BF082">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.41">9.44.41<=
/a> Functions <tt>make-catenated-stream</tt> and <tt>cat-streams</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-catenated-stream </tt><tt><i>stream</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(cat-streams </tt><tt><i>stream-list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020BF082">make-cate=
nated-stream</a></tt>
function takes zero or more arguments which
are input streams of the same type, and combines
them into a single virtual stream called a catenated stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020BF082">cat-strea=
ms</a></tt>
function takes a single list of input streams of
the same type, and similarly combines them into a catenated stream.
</p><p>
A catenated stream does not support seeking operations or output,
regardless of the capabilities of the streams in the list.
</p><p>
If the stream list is not empty, then the leftmost element of the
list is called the head stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
functions delegate
to the corresponding operations on the head stream, if it exists.
If the stream list is empty, they return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to the caller.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
operation on the head stream yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and there are more lists in the stream, then the stream is closed, removed =
from
the list, and the next stream, if any, becomes the head list. The operation=
 is
then tried again.  If any of these operations fail on the last list, it is =
not
removed from the list, so that a stream remains in place which can take the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
operations.
</p><p>
In this manner, the catenated streams appear to be a single stream.
</p><p>
Note that the operations can fail due to being unsupported. It is
the caller's responsibility to make sure all of the streams in the list
are compatible with the intended operations.
</p><p>
If the stream list is empty then an empty catenated stream is produced.
Input operations on this stream yield
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
operations throw an exception.
</p><p>

</p></dd></dl>
<a name=3D"N-021EE493">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.42">9.44.42<=
/a> Function <tt>catenated-stream-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(catenated-stream-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021EE493">catenated=
-stream-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a catenated stream. Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0050A46A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.43">9.44.43<=
/a> Function <tt>catenated-stream-push</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(catenated-stream-push </tt><tt><i>new-stream</i></tt><tt> =
</tt><tt><i>cat-stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0050A46A">catenated=
-stream-push</a></tt>
function pushes
<tt><i>new-stream</i></tt>
to the front of the stream list inside
<tt><i>cat-stream</i></tt>.
</p><p>
If an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
operation was successfully performed on
<tt><i>cat-stream</i></tt>
previously to a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0050A46A">catenated=
-stream-push</a></tt>,
those operations were forwarded to the front stream.
If those bytes or characters are still pending,
they are pending inside that stream, and thus
are logically preceded by the contents
of
<tt><i>new-stream</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-018C5606">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.44">9.44.44<=
/a> Functions <tt>open-files</tt> and <tt>open-files*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-files </tt><tt><i>path-list</i></tt><tt> [</tt><tt><i=
>alternative-stream</i></tt><tt> [</tt><tt><i>mode-string</i></tt><tt>]])=
=20




<br>&nbsp;&nbsp;(open-files* </tt><tt><i>path-list</i></tt><tt> [</tt><tt><=
i>alternative-stream</i></tt><tt> [</tt><tt><i>mode-string</i></tt><tt>]])=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C5606">open-file=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C5606">open-file=
s*</a></tt>
functions create a list of streams by invoking
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function on each element of
<tt><i>path-list</i></tt>.
By default, the mode string
<tt>"r"</tt>

is passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>;
if the
<tt><i>mode-string</i></tt>
argument specified, it overrides this default. In that situation,
the specified mode should permit reading.
</p><p>
These streams are turned
into a catenated stream as if applied as arguments to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020BF082">make-cate=
nated-stream</a></tt>.
</p><p>
The effect is that multiple files appear to be catenated together into a si=
ngle
input stream.
</p><p>
If the optional
<tt><i>alternative-stream</i></tt>
argument is supplied, then if
<tt><i>path-list</i></tt>
is empty,
<tt><i>alternative-stream</i></tt>
is returned instead of an empty catenated stream.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C5606">open-file=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C5606">open-file=
s*</a></tt>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C5606">open-file=
s</a></tt>
creates all of the
streams up-front. So if any of the paths cannot be opened, the operation th=
rows.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C5606">open-file=
s*</a></tt>
variant is lazy: it creates a lazy list of streams out of the
path list. The streams are opened as needed: before the second stream is op=
ened,
the program has to read the first stream to the end, and so on.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Collect lines from all files that are given as arguments on the command lin=
e. If
there are no files, then read from standard input:
</p><p>
<tt>
</tt></p><pre><tt>   @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0056">next</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C560=
6">open-files</a> *args* *stdin*))
   @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>)
   @line
   @(end)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0255B4F1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.45">9.44.45<=
/a> Function <tt>abs-path-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(abs-path-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>abs-path-function</tt>
tests whether the argument
<tt><i>path</i></tt>
is an absolute path, returning a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
indication.
</p><p>
The function behaves in the same manner on all platforms, implementing
a platform-agnostic definition of
<i>absolute path</i>,

as follows.
</p><p>
An absolute path is a string which either begins with a slash or backslash
character, or which begins with an alphanumeric word, followed by a colon,
followed by a slash or backslash.
</p><p>
The empty string isn't an absolute path.
</p><p>
Examples of absolute paths:
</p><p>
<tt>
</tt></p><pre><tt>  /etc
  c:/tmp
  <a href=3D"ftp://user@server/">ftp://user@server</a>
  disk0:/home
  Z:\Users
</tt></pre><tt>

</tt>

<p>
Examples of strings which are not absolute paths:
</p><p>
<tt>




<br>&nbsp;&nbsp;(</tt><tt><i>the</i></tt><tt> </tt><tt><i>empty</i></tt><tt=
> </tt><tt><i>string</i></tt><tt>)=20

<br>&nbsp;&nbsp;.
<br>&nbsp;&nbsp;abc
<br>&nbsp;&nbsp;foo:bar/x
<br>&nbsp;&nbsp;$:\abc
</tt>

</p><p>

</p></dd></dl>
<a name=3D"N-019DEA44">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.46">9.44.46<=
/a> Function <tt>pure-rel-path-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pure-rel-path-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019DEA44">pure-rel-=
path-p</a></tt>
function tests whether the string
<tt><i>path</i></tt>
represents a
<i>pure relative path</i>,

which is defined as a path which isn't absolute according to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0255B4F1">abs-path-=
p</a></tt>,
which isn't the string
<tt>"."</tt>

(single period),
which doesn't begin with a period followed by a slash or backslash,
and which doesn't begin with alphanumeric word
terminated by a colon.
</p><p>
The empty string is a pure relative path.
</p><p>
Other examples of pure relative paths:
</p><p>
<tt>
</tt></p><pre><tt>  abc.d
  .tmp/bar
  1234
  x
  $:/xyz
</tt></pre><tt>

</tt>

<p>
Examples of strings which are not pure relative paths:
</p><p>
<tt>
</tt></p><pre><tt>  .
  /
  /etc
  ./abc
  .\
  foo:
  $:\abc
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02C01721">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.47">9.44.47<=
/a> Functions <tt>dir-name</tt> and <tt>base-name</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dir-name </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(base-name </tt><tt><i>path</i></tt><tt> [</tt><tt><i>suffi=
x</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">dir-name<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>
functions calculate, respective, the directory part and
base name part of a path name.
</p><p>
The calculation is performed in a platform-dependent way, using the
characters in the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03985DE5">path-sep-=
chars</a></tt>
as path component separators.
</p><p>
Both functions first remove from any further consideration all superfluous
trailing occurrences of the directory separator characters from
<tt>path</tt>.
Thus input such as
<tt>"a////"</tt>

is reduced to just
<tt>"a"</tt>,
and
<tt>"///"</tt>

is reduced to
<tt>"/"</tt>.
</p><p>
The resulting trimmed path is the
<i>effective path .</i>

</p><p>
If the effective path is an empty string, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">dir-name<=
/a></tt>
returns
<tt>"."</tt>

and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>
returns the empty string.
</p><p>
If the effective path is not empty, and contains no path separator
characters, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">dir-name<=
/a></tt>
returns
<tt>"."</tt>

and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>
returns the effective path.
</p><p>
Otherwise, the effective path is divided into two parts: the
<i>raw directory prefix</i>

and the remainder.
</p><p>
The raw directory prefix is the maximally long prefix of the effective
path which ends in a separator character.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">dir-name<=
/a></tt>
function returns the raw directory prefix, if that prefix consists of
nothing but a single directory separator character. Otherwise it
returns the raw directory prefix, with the trailing path separator
removed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>
function returns the remaining part of the effective path, after
the raw directory prefix.
</p><p>
If the
<tt><i>suffix</i></tt>
argument is given to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>,
then the returned base name is adjusted as follows. If the base
name ends in
<tt><i>suffix</i></tt>
then a trimmed version of the base name is returned instead, with that suff=
ix
removed. This adjustment isn't performed if it would result in an empty
string being returned.
</p><p>

</p></dd></dl>
<a name=3D"N-0033B27E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.48">9.44.48<=
/a> Function <tt>path-cat</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-cat </tt><tt><i>dir-path</i></tt><tt> </tt><tt><i>rel=
-path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat<=
/a></tt>
function joins the directory path name given by the character
string argument
<tt><i>dir-path</i></tt>
with the relative path name given by
<tt><i>rel-path</i></tt>,
returning the joined path.
</p><p>
The function is related to the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">dir-name<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>
in the following way: if
<tt><i>p</i></tt>
is some path denoting an object in the file system, then
<tt>(path-cat (dir-name p) (base-name p))</tt>
produces a path
<tt><i>p*</i></tt>
which denotes the same object. The paths
<tt><i>p</i></tt>
and
<tt><i>p*</i></tt>
might not be equivalent strings.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat<=
/a></tt>
function ensures that paths are joined without superfluous
path separator characters, regardless of whether
<tt><i>dir-path</i></tt>
ends in a separator.
</p><p>
If a separator must be added, the character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(forward slash) is always used, even on platforms where
<tt>\</tt>
(backslash) is also a pathname separator, and even if either argument inclu=
des
backslashes.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat<=
/a></tt>
function eliminates trivial occurrences of the
<tt>.</tt>
(dot) path component. It preserves trailing separators in the following
way: if
<tt><i>rel-path</i></tt>
ends in a path separator character, then the returned string shall
end in that character; and if
<tt><i>rel-path</i></tt>
vanishes entirely because it is equivalent to the dot, then the returned
string is
<tt><i>dir-name</i></tt>
itself.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
33B27E">path-cat</a> "" "")    --&gt;  ""
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "" ".")   --&gt;  ""
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "." "")   --&gt;  ""
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "." ".")  --&gt;  ""

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "abc" ".")  --&gt;  "abc"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "." "abc")  --&gt;  "abc"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "./" ".")   --&gt;  "./"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "."  "./")  --&gt;  "./"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "abc/" ".")  --&gt;  "abc/"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "./" "abc")  --&gt;  "abc"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "/" ".")    --&gt; "/"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "/" "abc")  --&gt; "/abc"

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat</=
a> "ab/cd" "ef")  --&gt; "ab/cd/ef"
</tt></pre><tt>

</tt>

<p>
</p><p>

</p></dd></dl>
<a name=3D"N-03985DE5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.49">9.44.49<=
/a> Variable <tt>path-sep-chars</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03985DE5">path-sep-=
chars</a></tt>
variable holds a string consisting of the characters which the underlying
operating system recognizes as path name separators.
</p><p>
If a particular of these characters is considered preferred on
the host platform, that character is placed in the first position of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03985DE5">path-sep-=
chars</a></tt>.
</p><p>
Altering the value of this variable has no effect on any <b>TXR Lisp</b> li=
brary
function.
</p><p>

</p></dd></dl>
<a name=3D"N-03FE5500">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.50">9.44.50<=
/a> Functions <tt>read</tt> and <tt>iread</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(read [</tt><tt><i>source</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [</tt><tt><i>err-strea=
m</i></tt><tt> [</tt><tt><i>err-retval</i></tt><tt> [</tt><tt><i>name</i></=
tt><tt> [</tt><tt><i>lineno</i></tt><tt>]]]]])=20




<br>&nbsp;&nbsp;(iread [</tt><tt><i>source</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [</tt><tt><i>err=
-stream</i></tt><tt> [</tt><tt><i>err-retval</i></tt><tt> [</tt><tt><i>name=
</i></tt><tt> [</tt><tt><i>lineno</i></tt><tt>]]]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">read</a><=
/tt>
function converts text denoting <b>TXR Lisp</b> structure, into the
corresponding data structure. The
<tt><i>source</i></tt>
argument may be either a character
string, or a stream.  If it is omitted, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
is used as the stream.
</p><p>
The source must provide the text representation of one complete <b>TXR Lisp=
</b> object.
</p><p>
Multiple calls to read on the same stream will extract successive objects
from the stream. To parse successive objects from a string, it is necessary
to convert it to a string stream.
</p><p>
The optional
<tt><i>err-stream</i></tt>
argument can be used to specify a stream to which
parse errors diagnostics are sent. If absent, the diagnostics are suppresse=
d.
</p><p>
The optional
<tt><i>name</i></tt>
argument can be used to specify the file name which is used for reporting
errors. If this argument is missing, the name is taken from the name
property of the
<tt><i>source</i></tt>
argument if it is a stream, or else the word
<tt>string</tt>
is used as the name if
<tt><i>source</i></tt>
is a string.
</p><p>
The optional
<tt>lineno</tt>
argument, defaulting to 1, specifies the starting line number. This,
like the
<tt><i>name</i></tt>
argument, is used for reporting errors.
</p><p>
If there are no parse errors, the function returns the parsed data
structure. If there are parse errors, and the
<tt><i>err-retval</i></tt>
parameter is
present, its value is returned. If the
<tt><i>err-retval</i></tt>
parameter
is not present, then an exception of type
<tt>syntax-error</tt>
is thrown.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">iread</a>=
</tt>
function ("interactive read") is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">read</a><=
/tt>
except that it parses a modified version of the syntax. The modified
syntax does not support the application of the dot and dotdot operators
on a top-level expression. For instance, if the input is
<tt>a.b</tt>
or
<tt>a .. b</tt>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">iread</a>=
</tt>
will only read the
<tt>a</tt>
token whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">read</a><=
/tt>
will read the entire expression.
</p><p>
This modified syntax allows
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">iread</a>=
</tt>
to return immediately when an expression is recognized, which is the
expected behavior if the input is being read from an interactive terminal.
By contrast,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">read</a><=
/tt>
waits for more input after seeing a complete expression, because of the
possibility that the expression will be further extended by means of the do=
t or
dotdot operators. An explicit end-of-input signal must be given from the
terminal to terminate the expression.
</p><p>
The special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014AFEA9">*rec-sour=
ce-loc*</a></tt>
controls whether these functions record source location info similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
.
Note: if these functions are used to scan data which is evaluated as Lisp c=
ode,
it may be useful to set
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014AFEA9">*rec-sour=
ce-loc*</a></tt>
true in order to obtain better diagnostics. However, source location record=
ing
incurs a performance and storage penalty.
</p><p>

</p></dd></dl>
<a name=3D"N-009C0AC4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.44.51">9.44.51<=
/a> Function <tt>record-adapter</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(record-adapter </tt><tt><i>regex</i></tt><tt> [</tt><tt><i=
>stream</i></tt><tt> [</tt><tt><i>include-match</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009C0AC4">record-ad=
apter</a></tt>
function returns a new stream object which acts as an
<i>adapter</i>

to the existing
<tt><i>stream</i></tt>.
</p><p>
If an argument is not specified for
<tt><i>stream</i></tt>,
then the
<tt>*std-input*</tt>
stream is used.
</p><p>
With the exception of
<tt><i>get-line</i></tt>,
all operations on the returned adapter transparently delegate to the origin=
al
<tt><i>stream</i></tt>
object.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
function is used on the adapter, it behaves differently. A string is
extracted from
<tt><i>stream</i></tt>,
and returned. However, the string isn't a line delimited by a newline
character, but rather a record delimited by
<tt><i>regex</i></tt>.
This record is extracted as if by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D3F81">read-unti=
l-match</a></tt>
function, invoked with the
<tt><i>regex</i></tt>,
<tt><i>stream</i></tt>
and
<tt><i>include-match</i></tt>
arguments.
</p><p>
All behavior which is built on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
function is affected by the record-delimiting semantics of a record adapter=
's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
implementation. Notably, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">lazy-stre=
am-cons</a></tt>
functions return a lazy list of delimited records rather than of lines.
</p><p>
</p></dd></dl>
<a name=3D"N-01691F81">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45">9.45</a> St=
ream Output Indentation</h3>



<p>


<b>TXR Lisp</b> streams provide support for establishing hanging indentatio=
ns
in text output. Each stream which supports output has a built-in state vari=
able
called indentation mode, and another variable indicating the current
indentation amount. When indentation mode is enabled, then prior to the
first character of every line, the stream prepends the indentation: space
characters equal in number to the current indentation value.
This logic is implemented by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
functions, and all functions based on these. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
function does not interact with indentation. The column position tracking
will be incorrect if byte and character output are mixed, affecting
the placement of indentation.
</p><p>
Indentation mode takes on four numeric values, given by the four
variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-of=
f</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-da=
ta</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-co=
de</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-fo=
ff</a></tt>.
As far as stream output is concerned, the code and data modes
represented by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-co=
de</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-da=
ta</a></tt>
behave
the same way: both represent the "indentation turned on" state.
The difference between them influences the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
function. This function isn't used by any lower-level stream output
routines. It is used by the object printing functions like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
to break up long lines.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-of=
f</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-fo=
ff</a></tt>
modes are also treated the same way by lower level stream output,
indicating "indentation turned off". The modes are distinguished
by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
in the following way:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-of=
f</a></tt>
is a "soft" disable which allows these object-printing routines
to temporarily turn on indentation while traversing aggregate objects.
Whereas the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-fo=
ff</a></tt>
("force off") value is a "hard" disable: the object-printing routines will =
not
enable indentation and will not break up long lines.
</p><p>

<a name=3D"N-00512FDD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45.1">9.45.=
1</a> Variables <tt>indent-off</tt>, <tt>indent-data</tt>, <tt>indent-code<=
/tt> and <tt>indent-foff</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integer values representing output stream
indentation modes. The value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00512FDD">indent-of=
f</a></tt>
is zero.
</p><p>

</p></dd></dl>
<a name=3D"N-03F3170C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45.2">9.45.2</a=
> Functions <tt>get-indent-mode</tt> and <tt>set-indent-mode</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-indent-mode </tt><tt><i>stream</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set-indent-mode </tt><tt><i>stream</i></tt><tt> </tt><tt><=
i>new-mode</i></tt><tt>)=20




<br>&nbsp;&nbsp;(test-set-indent-mode </tt><tt><i>stream</i></tt><tt> </tt>=
<tt><i>compare-mode</i></tt><tt> </tt><tt><i>new-mode</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions retrieve and manipulate the stream indent mode.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F3170C">get-inden=
t-mode</a></tt>
retrieves the current indent mode of
<tt><i>stream</i></tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F3170C">set-inden=
t-mode</a></tt>
function sets the indent mode of
<tt><i>stream</i></tt>
to
<tt><i>new-mode</i></tt>
and returns the previous mode.
</p><p>
Note: it is encouraged to save and restore the indentation mode,
and in a way that is exception safe.
If a block of code sets up indentation on a stream such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
and is terminated by an exception, the indentation will remain in
effect and affect subsequent output. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-reso=
urces</a></tt>
macro or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-pr=
otect</a></tt>
operator may be used.
</p><p>

</p></dd></dl>
<a name=3D"N-01A1F89C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45.3">9.45.3</a=
> Functions <tt>test-set-indent-mode</tt> and <tt>test-neq-set-indent-mode<=
/tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(test-set-indent-mode </tt><tt><i>stream</i></tt><tt> </tt>=
<tt><i>compare-mode</i></tt><tt> </tt><tt><i>new-mode</i></tt><tt>)=20




<br>&nbsp;&nbsp;(test-neq-set-indent-mode </tt><tt><i>stream</i></tt><tt> <=
/tt><tt><i>compare-mode</i></tt><tt> </tt><tt><i>new-mode</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A1F89C">test-set-=
indent-mode</a></tt>
function sets the indent mode of
<tt><i>stream</i></tt>
to
<tt><i>new-mode</i></tt>
if, and only if,
its current mode is equal to
<tt><i>compare-mode</i></tt>.
Whether or not it changes the mode, it returns the previous mode.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A1F89C">test-neq-=
set-indent-mode</a></tt>
only differs in that it sets
<tt><i>stream</i></tt>
to
<tt><i>new-mode</i></tt>
if, and only if,
the current mode is
<b>not</b>

equal to
<tt><i>compare-mode</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-024E9FD8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45.4">9.45.4</a=
> Functions <tt>get-indent</tt>, <tt>set-indent</tt> and <tt>inc-indent</tt=
></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-indent </tt><tt><i>stream</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set-indent </tt><tt><i>stream</i></tt><tt> </tt><tt><i>new=
-indent</i></tt><tt>)=20




<br>&nbsp;&nbsp;(inc-indent </tt><tt><i>stream</i></tt><tt> </tt><tt><i>ind=
ent-delta</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions manipulate the indentation value of the stream.
The indentation takes effect the next time a character is output
following a newline character.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024E9FD8">get-inden=
t</a></tt>
function retrieves the current indentation amount.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024E9FD8">set-inden=
t</a></tt>
function sets
<tt><i>stream</i></tt>'s
indentation to the value
<tt><i>new-indent</i></tt>
and returns the previous value.
Negative values are clamped to zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024E9FD8">inc-inden=
t</a></tt>
function sets
<tt><i>stream</i></tt>'s
indentation relative to the current printing column position,
and returns the old value.
The indentation is calculated by adding
<tt><i>indent-delta</i></tt>
to the current column position.
If a negative indentation results, it is clamped to zero.
</p><p>

</p></dd></dl>
<a name=3D"N-01A9EA49">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45.5">9.45.5</a=
> Function <tt>width-check</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(width-check </tt><tt><i>stream</i></tt><tt> </tt><tt><i>al=
t-char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
function examines the state of the stream, taking into consideration
the current printing column position, the indentation state,
the indentation amount and an internal "force break" flag. It makes a decis=
ion
either to introduce a line break by printing a newline character, or else t=
o
print the
<tt><i>alt-char</i></tt>
character.
</p><p>
If a decision is made not to emit a line break, but
<tt><i>alt-char</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the function has no effect at all.
</p><p>
The return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the function has issued a line break, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03B5FB1D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.45.6">9.45.6</a=
> Function <tt>force-break</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(force-break </tt><tt><i>stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B5FB1D">force-bre=
ak</a></tt>
function is called on a stream, it sets an internal "force break" flag whic=
h
affects the future behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
function examines this flag. If the flag is set,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
clears it, and issues a line break without considering any other
conditions.
</p><p>
The
<tt><i>stream</i></tt>'s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B5FB1D">force-bre=
ak</a></tt>
flag is also cleared whenever a newline character is output.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B5FB1D">force-bre=
ak</a></tt>
function returns
<tt>stream</tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B5FB1D">force-bre=
ak</a></tt>
is involved in line breaking decisions. Whenever a list or list-like syntax=
 is
being printed, whenever an element of that syntax is broken into multiple
lines, a break is forced after that element, in order to avoid output
which resembles the following diagonally-creeping pattern:
</p><p>
<tt>
</tt></p><pre><tt>  (a b c (d e f
          g h i) j (k l
                    m n) o)
</tt></pre><tt>

</tt>

<p>
but instead is rendered in a more horizontally compact pattern:
</p><p>
<tt>
</tt></p><pre><tt>  (a b c (d e f
          g h i)
   j (k l
      m n)
   o)
</tt></pre><tt>

</tt>

<p>
When the printer prints
<tt>(d e f g h i)</tt>
it uses the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
function between the elements; that function issues the
break between the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
and
<tt>g</tt>.
The printer monitors the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>;
it knows that since one of the calls returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
the object had been broken into two or more lines. It then calls
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B5FB1D">force-bre=
ak</a></tt>
after printing the last element
<tt>i</tt>
of that object.  Then, due to the force flag, the outer recursion of the
printer which is printing
<tt>(a b c ...)</tt>
will experience a break when it calls
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
before printing
<tt>j</tt>.
</p><p>
Custom
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
methods defined on structure objects can take advantage of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A9EA49">width-che=
ck</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B5FB1D">force-bre=
ak</a></tt>
in the same way so that application-defined output integrates
with the formatting algorithm.
</p><p>
</p></dd></dl>
<a name=3D"N-00B5307D">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.46">9.46</a> St=
ream Output Limiting</h3>



<p>


</p><p>
Streams have two properties which are used by the The <b>TXR Lisp</b> objec=
t printer to
optionally truncate the output generated by aggregate objects.
</p><p>
A stream can specify a maximum length for aggregate objects via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031FA9E5">set-max-l=
ength</a></tt>
function. Using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D3FB4">set-max-d=
epth</a></tt>
function, the maximum depth can also be specified.
</p><p>
This feature is
useful when diagnostic output is being produced, and the objects involved a=
re
so large that the diagnostic output overwhelms the output device or the use=
r,
so as to become uninformative. Output limiting also prevents the printer's
non-termination on infinite, lazy structures.
</p><p>
It is recommended that functions which operate on streams passed in as
parameters save and restore these parameters, if they need to manipulate th=
em,
for instance using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-reso=
urces</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> output-function (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02133AA5">arg</a> stream)
    ;; temporarily impose maximum width and depth
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012CE06E">with-res=
ources</a> ((ml (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031FA9=
E5">set-max-length</a> stream 42)
                         (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-031FA9E5">set-max-length</a> stream ml))
                     (mw (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-027D3FB4">set-max-depth</a> stream 12)
                         (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-027D3FB4">set-max-depth</a> stream mw)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl<=
/a> arg stream)
      ...))
</tt></pre><tt>

</tt>

<p>

<a name=3D"N-031FA9E5">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.46.1">9.46.=
1</a> Function <tt>set-max-length</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(set-max-length </tt><tt><i>stream</i></tt><tt> </tt><tt><i=
>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031FA9E5">set-max-l=
ength</a></tt>
function establishes the maximum length for aggregate object printing.
It affects the printing of lists, vectors, hash tables, strings
as well as quasiliterals and quasiword list literals (QLLs).
</p><p>
The default value is 0 and this value means that no limit is imposed.
Otherwise, the value must be a positive integer.
</p><p>
When the list, vector or hash table object being printed has more
elements than the maximum length, then elements are printed only up to
the maximum count, and then the remaining elements are summarized by
printing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a></tt>
(three dots) character sequence as if it were an additional element.
This sequence is an invalid token; it cannot be read as input.
</p><p>
When a character string is printed, any positive value of
the maximum length which is less than 15 is considered to be 15.
The maximum length specifies the number of characters of the
a string which are output.
</p><p>
If a string which exceeds the maximum length is being printed
with read-print consistency, as by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
function, then only a prefix of the string is printed, limited
to the maximum number of characters.  Then, the literal syntax is
closed using the character sequence
<tt>\..."</tt>
(backslash, dot, dot, dot, double quote)
whose leading invalid escape sequence
<tt>\.</tt>
(backslash, dot) ensures that the truncated object is not readable.
</p><p>
If a string which exceeds the maximum length is being printed
without read-print consistency, as by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprint</a=
></tt>
function, then only a prefix of the string is printed, limited
to the maximum number of characters. Then the
character sequence
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a></tt>
is emitted.
</p><p>
Quasiliterals are treated using a combination of behaviors.  Elements of a
quasiliteral are literal sequence of text, and embedded variables and
expressions.  The maximum length specifies both the maximum number of eleme=
nts
in the quasiliteral, and the maximum number of characters in any element wh=
ich
is a sequence of text. When either limit is exceeded, the quasiliteral
is immediately terminated with the sequence
<tt>\...`</tt>
(escaped dot, dot, dot, backtick). The maximum limit is applied to
the units of text cumulatively, rather than individually. As in the case of
string literals, smaller limit values than 15 are treated as 15,
but only for the cumulative text length limit. For limiting the number of
elements, the count is used as-is.
</p><p>
When a QLL is printed, the space-separated elements
of the literal are individually subject to the maximum length limit as if
they were independent quasiliterals. Furthermore, the sequence of these
elements is subject to the maximum length. If there are more elements in th=
e
QLL, then the sequence
<tt>\...`</tt>
(escaped dot, dot, dot, backtick) is emitted and thus the QLL ends.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031FA9E5">set-max-l=
ength</a></tt>
function returns the previous value.
</p><p>

</p></dd></dl>
<a name=3D"N-027D3FB4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.46.2">9.46.2</a=
> Function <tt>set-max-depth</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(set-max-depth </tt><tt><i>stream</i></tt><tt> </tt><tt><i>=
value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031FA9E5">set-max-l=
ength</a></tt>
function establishes the maximum depth for the printing of nested
objects. It affects the printing of lists, vectors, hash tables
and structures.  The default value is 0 and this value means that no limit =
is
imposed.  Otherwise, the value must be a positive integer.
</p><p>
The depth of an object not enclosed in any object is zero. The depth of the
element of an aggregate is one greater than the depth of the aggregate itse=
lf.
For instance, given the list
<tt>(1 (2 3))</tt>
the list itself has depth 0, the atom
<tt>1</tt>
has depth 1, as does the sublist
<tt>(2 3)</tt>,
and the
<tt>2</tt>
and
<tt>3</tt>
atoms have depth 2.
</p><p>
When an object is printed whose depth exceeds the maximum depth, then three=
 dot
character sequence
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a></tt>
is printed instead of that object. This notation is an invalid token; it ca=
nnot be
read as input.
</p><p>
Additionally, when a vector, list, hash table or structure is printed which=
 itself
doesn't exceed the maximum depth, but whose elements do exceed, then that o=
bject
is summarized, respectively, as
<tt>(...)</tt>,
<tt>#(...)</tt>,
<tt>H#(...)</tt>
and
<tt>S#(...)</tt>,
rather than repeating the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a></tt>
sequence for each of its elements.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027D3FB4">set-max-d=
epth</a></tt>
function returns the previous value.
</p><p>
</p></dd></dl>
<a name=3D"N-018F2126">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.47">9.47</a> Co=
processes</h3>



<p>



<a name=3D"N-02B03D38">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.47.1">9.47.=
1</a> Functions <tt>open-command</tt> and <tt>open-process</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-command </tt><tt><i>system-command</i></tt><tt> [</tt=
><tt><i>mode-string</i></tt><tt>])=20




<br>&nbsp;&nbsp;(open-process </tt><tt><i>program</i></tt><tt> </tt><tt><i>=
mode-string</i></tt><tt> [</tt><tt><i>argument-list</i></tt><tt>])=20




<br>&nbsp;&nbsp;(open-subprocess </tt><tt><i>program</i></tt><tt> </tt><tt>=
<i>mode-string</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; [</tt><tt><i>argument-list</i></tt><tt> [</tt>=
<tt><i>function</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions spawn external programs which execute concurrently
with the <b>TXR</b> program. Both functions return a unidirectional stream =
for
communicating with these programs: either an output stream, or an input
stream, depending on the contents of
<tt><i>mode-string</i></tt>.
</p><p>
In
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>,
the
<tt><i>mode-string</i></tt>
argument is optional, defaulting to
the value
<tt>"r"</tt>

if it is missing.  See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function for a discussion of modes.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function is implemented using POSIX
<tt>popen</tt>.
Those elements of
<tt><i>mode-string</i></tt>
which are applicable to
<tt>popen</tt>
are passed to it, and hence their semantics follows from
their processing in that function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function accepts, via the
<tt><i>system-command</i></tt>
string parameter, a
system command, which is in a system-dependent syntax. On a POSIX system, t=
his
would be in the POSIX Shell Command Language.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-proc=
ess</a></tt>
function specifies a program to invoke via the
<tt><i>command</i></tt>
argument. This is subject to the operating system's search strategy.
On POSIX systems, if it is an absolute or relative path, it is treated as
such, but if it is a simple base name, then it is subject to searching
via the components of the PATH environment variable. If open-process
is not able to find
<tt><i>program</i></tt>,
or is otherwise unable to execute
the program, the child process will exit, using the value of the C variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
as its exit status. This value can be retrieved via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00596930">close-str=
eam</a></tt>.
</p><p>
The
<tt><i>argument-list</i></tt>
argument is a list of strings which specifies additional
optional arguments to be passed passed to the program. The
<tt><i>program</i></tt>
argument
becomes the first argument, and
<tt><i>argument-string</i></tt>
become the second and
subsequent arguments. If
<tt><i>argument-strings</i></tt>
is omitted, it defaults to empty.
</p><p>
If a coprocess is open for writing
<tt>




(</tt><tt><i>mode-string</i></tt><tt>=20

</tt>

is specified as
<tt>"w"</tt>),
then
writing on the returned stream feeds input to that program's standard input
file descriptor. Indicating the end of input is performed by closing the
stream.
</p><p>
If a coprocess is open for reading
<tt>




(</tt><tt><i>mode-string</i></tt><tt>=20

</tt>

is specified as
<tt>"r"</tt>),
then
the program's output can be gathered by reading from the returned stream.
When the program finishes output, it will close the stream, which can be
detected as normal end of data.
</p><p>
The standard input and error file descriptors of an input coprocess
are obtained from the streams stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
special variables, respectively. Similarly, the standard output and error
file descriptors of an output coprocess are obtained from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
special variables.  These variables must contain streams on which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function is meaningful, otherwise the operation will fail.
What this functionality means is that re-binding the special variables
for standard streams has the effect of redirection. For example,
the following two expressions achieve the same effect of creating
a stream which reads the output of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03336E1B">cat</a></=
tt>
program, which reads and produces the contents of the file
<tt>text-file</tt>.
</p><p>
<tt>
</tt></p><pre><tt>  ;; redirect input by rebinding *stdin*
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
*stdin* (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open=
-file</a> "text-file")))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-com=
mand</a> "cat"))

  ;; redirect input using POSIX shell redirection syntax
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comma=
nd</a> "cat &lt; text-file")
</tt></pre><tt>

</tt>

<p>
The following is erroneous:
</p><p>
<tt>
</tt></p><pre><tt>  ;; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-013AF20B">let</a> ((*stdin* (<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-00F0B9B0">make-string-input-stream</a> "abc")))
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-=
command</a> "cat"))
</tt></pre><tt>

</tt>

<p>
A string input or output stream doesn't have an operating system file
descriptor; it cannot be passed to a coprocess.
</p><p>
The streams
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
are not synchronized with their underlying file descriptors prior to
the execution of a coprocess. It is up to the program to ensure that
previous output to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
is flushed, so that the output of the coprocess isn't re-ordered
with regard to output produced by the program. Similarly,
input buffered in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
is not available to the coprocess, even though it has not
yet been read by the program. The program is responsible for preventing thi=
s
situation also.
</p><p>
If a coprocess terminates abnormally or unsuccessfully, an exception is rai=
sed.
</p><p>
On platforms which have the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">fork</a><=
/tt>
function, the
<tt><i>mode-string</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-proc=
ess</a></tt>
supports a special
<tt><i>redirection</i></tt>
syntax. This syntax specifies I/O redirections which are done in the
context of the child process, before the specified program is executed.
Instances of the syntax are considered options; if
<tt><i>mode-string</i></tt>
specifies a mode such as
<tt>r</tt>
that mode must precede the redirections. Redirections may be mixed with
other options.
</p><p>
Up to four redirections may be specified using one
of two forms: a short form or the long form. If more than four
redirections are specified, the
<tt><i>mode-string</i></tt>
is considered ill-formed.
</p><p>
The short form of the syntax consists of three characters: the prefix
character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>=
,
a single decimal digit indicating the file descriptor to be redirected,
and then a third character which is either another digit, or else one of th=
e
two characters
<tt>n</tt>
or
<tt>x</tt>.
If the third character is a digit, it indicates the target file descriptor
of the redirection. For instance
<tt>&gt;21</tt>
indicates that file descriptor 2 is to be redirected to 1 (so that material
written to standard error goes to the same destination as that written
to standard output).
If the third character is
<tt>n</tt>,
it means that the file descriptor will be redirected to the file
<tt>/dev/null</tt>.
For instance,
<tt>&gt;2n</tt>
indicates that descriptor 2 (standard error) will be redirected to
the null device. If the third character is
<tt>x</tt>,
it indicates that the file descriptor shall be closed. For instance
<tt>&gt;0x</tt>
means to close descriptor 0 (standard input).
</p><p>
The long form of the syntax allows file descriptors that require more
than one decimal digit. It consists of the same prefix character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0037">&gt;</a></tt>
which is immediately followed by an open parenthesis
<tt>(</tt>.
The parenthesis is immediately followed by one or more digits which
give the to-be-redirected file descriptor. This is followed by
one or more whitespace characters, and then either another multi-digit deci=
mal file descriptor
or one of the two letters
<tt>n</tt>
or
<tt>x</tt>.
This second element must be immediately followed by the closing
parenthesis
<tt>)</tt>.
Thus
<tt>&gt;21</tt>
and
<tt>&gt;2n</tt>
may be written in the long form, respectively, as
<tt>&gt;(2 1)</tt>
and
<tt>&gt;(2 n)</tt>,
while
<tt>&gt;(32 47)</tt>
has no short form equivalent.
Multiple redirections may be specified, in any mixture of the long and
short form. For instance
<tt>r&gt;21&gt;0n&gt;(27 31)</tt>
specifies a process pipe that is open for reading, capturing the
output of the process. In that process, standard error is redirected
to standard output, standard input is connected to the null device,
and descriptor 27 is redirected to descriptor 31.
</p><p>
Note: on platforms which don't have a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">fork</a><=
/tt>
function, the implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-proc=
ess</a></tt>
is simulated via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
and therefore does not support the redirection syntax; it is parsed
and ignored.
</p><p>
The
<tt>open-subprocess</tt>
function is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-proc=
ess</a></tt>
that is available on platforms which have a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">fork</a><=
/tt>
function. This function has all the same argument conventions and semantics=
 as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-proc=
ess</a></tt>,
adding the
<tt><i>function</i></tt>
argument. If this argument isn't
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then it must specify a function which can be called with no arguments.
This function is called in the child process after any redirections are
established, just before the program specified by the
<tt><i>program</i></tt>
argument is executed. Moreover, the
<tt>open-subprocess</tt>
function allows
<tt><i>program</i></tt>
to be specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in which case
<tt><i>function</i></tt>
must be specified. When
<tt><i>function</i></tt>
returns, the child process terminates as if by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03592671">exit*</a>=
</tt>
with an argument of zero.
</p><p>
</p></dd></dl>
<a name=3D"N-0107F06A">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.48">9.48</a> I/=
O-Related Convenience Functions</h3>



<p>


</p><p>
The functions in this group create a stream, perform an I/O operation
on it, and ensure that it is closed, in one convenient operation. They
operate on files or command streams.
</p><p>
Several other functions in this category exist, which operate with buffers.
They are documented in the Buffer Functions subsection under the
FOREIGN FUNCTION INTERFACE section.
</p><p>

<a name=3D"N-02238370">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.48.1">9.48.=
1</a> Functions <tt>file-get</tt>, <tt>file-get-string</tt> and <tt>file-ge=
t-lines</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(file-get </tt><tt><i>name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-get-string </tt><tt><i>name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-get-lines </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02238370">file-get<=
/a></tt>
function opens a text stream over the file indicated by the string argument
<tt><i>name</i></tt>
for reading, reads the printed representation of a  <b>TXR Lisp</b> object =
from it,
and returns that object, ensuring that the stream is closed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02238370">file-get-=
string</a></tt>
is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02238370">file-get<=
/a></tt>
except that it reads the entire file as a text stream and returns
its contents in a single character string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02238370">file-get-=
lines</a></tt>
function opens a text stream over the file indicated by
<tt><i>name</i></tt>
and returns produces a lazy list of strings representing the lines
of text of that file as if by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
function, and returns that list. The stream remains open until the
list is consumed to the end, as indicated in the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0041C2E5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.48.2">9.48.2</a=
> Functions <tt>file-put</tt>, <tt>file-put-string</tt> and <tt>file-put-li=
nes</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(file-put </tt><tt><i>name</i></tt><tt> </tt><tt><i>obj</i>=
</tt><tt>)=20




<br>&nbsp;&nbsp;(file-put-string </tt><tt><i>name</i></tt><tt> </tt><tt><i>=
string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-put-lines </tt><tt><i>name</i></tt><tt> </tt><tt><i>l=
ist</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041C2E5">file-put<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041C2E5">file-put-=
string</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041C2E5">file-put-=
lines</a></tt>
functions open a text stream over the file indicated by the string argument
<tt><i>name</i></tt>,
write the argument object into the file in their specific manner,
and then close the file.
</p><p>
If the file doesn't exist, it is created.
If it exists, it is truncated to zero length and overwritten.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041C2E5">file-put<=
/a></tt>
function writes a printed representation of
<tt><i>obj</i></tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>
function. The return value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041C2E5">file-put-=
string</a></tt>
function writes
<tt><i>string</i></tt>
to the stream using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
function. The return value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0041C2E5">file-put-=
lines</a></tt>
function writes
<tt><i>list</i></tt>
to the stream using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367B282">put-lines=
</a></tt>
function. The return value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367B282">put-lines=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-000CCA8A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.48.3">9.48.3</a=
> Functions <tt>file-append</tt>, <tt>file-append-string</tt> and <tt>file-=
append-lines</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(file-append </tt><tt><i>name</i></tt><tt> </tt><tt><i>obj<=
/i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-append-string </tt><tt><i>name</i></tt><tt> </tt><tt>=
<i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(file-append-lines </tt><tt><i>name</i></tt><tt> </tt><tt><=
i>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CCA8A">file-appe=
nd</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CCA8A">file-appe=
nd-string</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CCA8A">file-appe=
nd-lines</a></tt>
functions open a text stream over the file indicated by the string argument
<tt><i>name</i></tt>,
write the argument object into the stream in their specific manner,
and then close the stream.
</p><p>
These functions are close counterparts of, respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02238370">file-get<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CCA8A">file-appe=
nd-string</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CCA8A">file-appe=
nd-lines</a></tt>.
</p><p>
These functions behave differently when the indicated file
already exists. Rather than being truncated and overwritten,
the file is extended by appending the new data to its end.
</p><p>

</p></dd></dl>
<a name=3D"N-0062A33B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.48.4">9.48.4</a=
> Functions <tt>command-get</tt>, <tt>command-get-string</tt> and <tt>comma=
nd-get-lines</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(command-get </tt><tt><i>cmd</i></tt><tt>)=20




<br>&nbsp;&nbsp;(command-get-string </tt><tt><i>cmd</i></tt><tt>)=20




<br>&nbsp;&nbsp;(command-get-lines </tt><tt><i>cmd</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0062A33B">command-g=
et</a></tt>
function opens text stream over an input command pipe created for
the command string
<tt><i>cmd</i></tt>,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function.  It reads the printed representation of a  <b>TXR Lisp</b> object=
 from it, and
returns that object, ensuring that the stream is closed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0062A33B">command-g=
et-string</a></tt>
is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0062A33B">command-g=
et</a></tt>
except that it reads the entire file as a text stream and returns
its contents in a single character string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0062A33B">command-g=
et-lines</a></tt>
function opens a text stream over an input command pipe created for the
command string
<tt><i>cmd</i></tt>
and returns produces a lazy list of strings representing the lines
of text of that file as if by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>
function, and returns that list. The stream remains open until the
list is consumed to the end, as indicated in the description of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B65D06">get-lines=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-024D65F3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.48.5">9.48.5</a=
> Functions <tt>command-put</tt>, <tt>command-put-string</tt> and <tt>comma=
nd-put-lines</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(command-put </tt><tt><i>cmd</i></tt><tt> </tt><tt><i>obj</=
i></tt><tt>)=20




<br>&nbsp;&nbsp;(command-put-string </tt><tt><i>cmd</i></tt><tt> </tt><tt><=
i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(command-put-lines </tt><tt><i>cmd</i></tt><tt> </tt><tt><i=
>list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024D65F3">command-p=
ut</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024D65F3">command-p=
ut-string</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024D65F3">command-p=
ut-lines</a></tt>
functions open an output text stream over an output command pipe created
for the command specified in the string argument
<tt><i>cmd</i></tt>,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function.
They write the argument object into the stream in their specific manner,
and then close the stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024D65F3">command-p=
ut</a></tt>
function writes a printed representation of
<tt><i>obj</i></tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>
function. The return value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024D65F3">command-p=
ut-string</a></tt>
function writes
<tt><i>string</i></tt>
to the stream using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
function. The return value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024D65F3">command-p=
ut-lines</a></tt>
function writes
<tt><i>list</i></tt>
to the stream using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367B282">put-lines=
</a></tt>
function. The return value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367B282">put-lines=
</a></tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-0127C724">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.49">9.49</a> Bu=
ffer streams</h3>



<p>


A stream type exists which allows
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
objects to be manipulated through the stream interface.
A buffer stream is created using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F5647C">make-buf-=
stream</a></tt>
function, which can either attach the stream to an existing buffer,
or create a new buffer that can later be retrieved from the stream
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02954B48">get-buf-f=
rom-stream</a></tt>.
</p><p>
Operations on the buffer stream treat the underlying buffer much like if it
were a memory-based file. Unless the underlying buffer is a "borrowed buffe=
r"
referencing the storage belonging to another object
(such as the buffer object produced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
FFI type's get semantics) the stream operations can change the buffer's siz=
e.
Seeking beyond the end of the buffer an then writing one or more bytes
extends the buffer's length, filling the newly allocated area with zero byt=
es.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009F5B3F">truncate-=
stream</a></tt>
function is supported also.
Buffer streams also support the
<tt>:byte-oriented</tt>
property.
</p><p>
Macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-out-=
buf-stream</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-in-b=
uf-stream</a></tt>
are provided to simplify the steps involved in using buffer streams
in some common scenarios. Note that in spite of the naming of these
macros there is only one buffer stream type, which supports bidirectional I=
/O.
</p><p>

<a name=3D"N-03F5647C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.49.1">9.49.=
1</a> Function <tt>make-buf-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-buf-stream [</tt><tt><i>buf</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F5647C">make-buf-=
stream</a></tt>
function return a new buffer stream. If the
<tt><i>buf</i></tt>
argument is supplied, it must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object. The stream is then associated with this object.
If the argument is omitted, a buffer of length zero is created and associat=
ed
with the stream.
</p><p>

</p></dd></dl>
<a name=3D"N-02954B48">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.49.2">9.49.2</a=
> Function <tt>get-buf-from-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-buf-from-stream </tt><tt><i>buf-stream</i></tt><tt>)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02954B48">get-buf-f=
rom-stream</a></tt>
returns the buffer object associated with
<tt><i>buf-stream</i></tt>
which must be a buffer stream.
</p><p>

</p></dd></dl>
<a name=3D"N-01150550">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.49.3">9.49.3</a=
> Macros <tt>with-out-buf-stream</tt> and <tt>with-in-buf-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-out-buf-stream (</tt><tt><i>var</i></tt><tt> [</tt><t=
t><i>buf-expr</i></tt><tt>])=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(with-in-buf-stream (</tt><tt><i>var</i></tt><tt> </tt><tt>=
<i>buf-expr</i></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-out-=
buf-stream</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-in-b=
uf-stream</a></tt>
macros both bind variable
<tt><i>var</i></tt>
to an implicitly created buffer stream, and evaluate zero or more
<tt><i>body-form</i></tt>-s
in the environment where the variable is visible.
</p><p>
The
<tt><i>buf-expr</i></tt>
argument, which may be omitted in the use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-out-=
buf-stream</a></tt>
macro, must be an expression which evaluates to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object.
</p><p>
The
<tt><i>var</i></tt>
argument must be a symbol suitable for naming a variable.
</p><p>
The implicitly allocated buffer stream is connected
to the buffer specified by
<tt><i>buf-expr</i></tt>
or, when
<tt><i>buf-expr</i></tt>
is omitted, to a newly allocated buffer.
</p><p>
The code generated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-out-=
buf-stream</a></tt>
macro, if it terminates normally, yields the buffer object
as its result value.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-in-b=
uf-stream</a></tt>
returns the value of the last
<tt><i>body-form</i></tt>,
or else
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if no forms are specified.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
150550">with-out-buf-stream</a> (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-006566FB">*stdout*</a> (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-011445E1">make-buf</a> 24))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</=
a> "Hello, world!"))
  -&gt; #b'48656c6c6f2c2077 6f726c6421000000 0000000000000000'

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01150550">with-out-b=
uf-stream</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB=
">*stdout*</a>) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">=
put-string</a> "Hello, world!"))
  -&gt; #b'48656c6c6f2c2077 6f726c6421'
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-03C8E357">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50">9.50</a> Fo=
reign Pointers</h3>



<p>


</p><p>

<a name=3D"N-00F7EE55">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.1">9.50.=
1</a> The <tt>cptr</tt> type</h4>



<p>
Objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
are Lisp values which contain a foreign pointer ("C pointer"). This data ty=
pe
is used by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>
function and is generally useful in conjunction with the Foreign Function
Interface (FFI).  An arbitrary pointer emanating from a foreign function
can be captured as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
value, which can be passed back into foreign code. For this purpose, there
exits also a matching FFI type called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type supports a symbolic type tag, which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The type tag plays a role in FFI. The FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type supports a tag attribute. When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object is converted to a foreign pointer under the control of the FFI
type, and that FFI type has a tag other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the object's tag must exactly match that of the FFI type, or the conversion
throws an error. In the reverse direction, when a foreign pointer is
converted to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object under control of the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type, the object inherits the type tag from the FFI type.
</p><p>

<a name=3D"N-015139D6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.2">9.50.=
2</a> Function <tt>cptr-int</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-int </tt><tt><i>integer</i></tt><tt> [</tt><tt><i>typ=
e-symbol</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015139D6">cptr-int<=
/a></tt>
function converts
<tt><i>integer</i></tt>
into a pointer in a system-specific way
which is consistent with the system's addressing structure. Then it returns
that pointer contained in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object.
</p><p>
The
<tt><i>integer</i></tt>
parameter must be an integer which is in range for a pointer value.
Note: this range is wider than the
<tt>fixnum</tt>
range; a portion of the range of
<tt>bignum</tt>
integers can denote pointers.
</p><p>
The
<tt><i>type-symbol</i></tt>
argument should be a symbol. If omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This symbol becomes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object's type tag.
</p><p>

</p></dd></dl>
<a name=3D"N-013139D1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.3">9.50.3</a=
> Function <tt>cptr-obj</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-obj </tt><tt><i>object</i></tt><tt> [</tt><tt><i>type=
-symbol</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013139D1">cptr-obj<=
/a></tt>
function converts
<tt><i>object</i></tt>
object directly to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
</p><p>
The
<tt><i>object</i></tt>
argument may be of any type.
</p><p>
The raw representation of
<tt><i>object</i></tt>
is simply stored in a new instance of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
and returned.
</p><p>
The
<tt><i>type-symbol</i></tt>
argument should be a symbol. If omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This symbol becomes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object's type tag.
</p><p>
The lifetime of the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object is independent from that of
<tt><i>object</i></tt>.
If the lifetime of
<tt><i>object</i></tt>
reaches its end before that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
,
the pointer stored inside the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
becomes invalid.
</p><p>

</p></dd></dl>
<a name=3D"N-01768FB9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.4">9.50.4</a=
> Function <tt>int-cptr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(int-cptr </tt><tt><i>cptr</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01768FB9">int-cptr<=
/a></tt>
function retrieves the pointer value of the
<tt><i>cptr</i></tt>
object as an integer.
</p><p>
If an integer
<tt><i>n</i></tt>
is in a range convertible to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type, then the expression
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01768FB9">int-cptr</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015139D6">cptr-int</a=
> </tt><tt><i>n</i></tt><tt>))=20

</tt>

reproduces
<tt><i>n</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-037139E3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.5">9.50.5</a=
> Function <tt>cptr-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-buf </tt><tt><i>buf</i></tt><tt> [</tt><tt><i>type-sy=
mbol</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037139E3">cptr-buf<=
/a></tt>
returns a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object which holds a pointer to a buffer object's storage
area. The
<tt><i>buf</i></tt>
argument must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>.
</p><p>
The
<tt><i>type-symbol</i></tt>
argument should be a symbol. If omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This symbol becomes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object's type tag.
</p><p>
The lifetime of the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object is independent from that of
<tt><i>buf</i></tt>.
If the lifetime of
<tt><i>buf</i></tt>
reaches its end before that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
,
the pointer stored inside the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
becomes invalid.
</p><p>

</p></dd></dl>
<a name=3D"N-01A212ED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.6">9.50.6</a=
> Function <tt>cptr-cast</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-cast </tt><tt><i>type-symbol</i></tt><tt> </tt><tt><i=
>cptr</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A212ED">cptr-cast=
</a></tt>
function produces a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object which has the same pointer as
<tt><i>cptr</i></tt>
but whose type is given by
<tt><i>type-symbol</i></tt>.
</p><p>
Casting
<tt><i>cptr</i></tt>
objects with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A212ED">cptr-cast=
</a></tt>
circumvents the safety mechanism which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type tagging provides.
</p><p>

</p></dd></dl>
<a name=3D"N-00913A85">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.7">9.50.7</a=
> Function <tt>cptr-zap</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-zap </tt><tt><i>cptr</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00913A85">cptr-zap<=
/a></tt>
function changes the pointer value of the
<tt><i>cptr</i></tt>
object to the null pointer.
</p><p>
The
<tt><i>cptr</i></tt>
argument must be of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type.
</p><p>
The return value is
<tt><i>cptr</i></tt>
itself.
</p><p>
Note: it is recommended to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00913A85">cptr-zap<=
/a></tt>
when the program has taken some action which invalidates the pointer value
stored in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object, where a risk exists that the value may be subsequently misused.
</p><p>

</p></dd></dl>
<a name=3D"N-02B1FBEF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.8">9.50.8</a=
> Function <tt>cptr-free</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-free </tt><tt><i>cptr</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B1FBEF">cptr-free=
</a></tt>
function passes the
<tt><i>cptr</i></tt>
object's pointer to the C library
<tt>free</tt>
function. After this action, it behaves exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00913A85">cptr-zap<=
/a></tt>.
</p><p>
The
<tt><i>cptr</i></tt>
argument must be of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type.
</p><p>
The return value is
<tt><i>cptr</i></tt>
itself.
</p><p>
Note: this function is unsafe. If the pointer didn't originate from the
<tt>malloc</tt>
family of memory allocation functions, or has already been freed, or
copies of the pointer exist which are still in use, the consequences are
likely catastrophic.
</p><p>

</p></dd></dl>
<a name=3D"N-02B9289A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.9">9.50.9</a=
> Function <tt>cptrp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptrp </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B9289A">cptrp</a>=
</tt>
function tests whether
<tt><i>value</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if this is the
case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise.
</p><p>

</p></dd></dl>
<a name=3D"N-03B1F90C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.10">9.50.10<=
/a> Function <tt>cptr-type</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-type </tt><tt><i>cptr</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B1F90C">cptr-type=
</a></tt>
function retrieves the
<tt><i>cptr</i></tt>
object's type tag.
</p><p>

</p></dd></dl>
<a name=3D"N-00513A70">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.11">9.50.11<=
/a> Function <tt>cptr-get</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-get </tt><tt><i>cptr</i></tt><tt> [</tt><tt><i>type</=
i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00513A70">cptr-get<=
/a></tt>
function extracts a Lisp value by converting a C object
at the memory location denoted by
<tt><i>cptr</i></tt>,
according to the FFI type
<tt><i>type</i></tt>.
The external representation at the specified memory location is
is scanned according to the
<tt><i>type</i></tt>
and converted to a Lisp value which is returned.
</p><p>
If the
<tt><i>type</i></tt>
argument is specified, it must be a FFI type object.
If omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object's type tag is interpreted as a FFI type symbol and resolved to
a type; the resulting type, if one is found is substituted for
<tt><i>type</i></tt>.
If the lookup fails an error exception is thrown.
</p><p>
The
<tt><i>cptr</i></tt>
object must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
and point to a memory area suitably aligned for, and large
enough to hold a foreign representation of
<tt><i>type</i></tt>,
at the byte offset indicated by the
<tt><i>offset</i></tt>
argument.
</p><p>
If
<tt><i>cptr</i></tt>
is a null pointer, an exception is thrown.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00513A70">cptr-get<=
/a></tt>
operation is similar to the "get semantics" performed by FFI
in order to extract the return value of foreign function
calls, and by the FFI callback mechanism to extract the
arguments coming into a callback.
</p><p>
The
<tt><i>type</i></tt>
argument may not be a variable length type, such as an array of
unspecified size.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00513A70">cptr-get<=
/a></tt>
and
<tt>cptr-out</tt>
is useful in simplifying the interaction with "semi-opaque" foreign objects=
:
objects which serve as a API handles that are treated as opaque pointers in=
 API
argument calls, but which expose some internal members that the application
must access directly. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
objects pass through the foreign API without undergoing conversion,
as usual. The application uses these two functions to perform conversion as
necessary. Under this technique, the description of the foreign object need=
 not
be complete. Structure members which occur after the last member that the
application is interested in need not be described in the FFI type.
</p><p>

</p></dd></dl>
<a name=3D"N-00513A38">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.12">9.50.12<=
/a> Function <tt>cptr-put</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-put </tt><tt><i>cptr</i></tt><tt> </tt><tt><i>obj</i>=
</tt><tt> [</tt><tt><i>type</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00513A38">cptr-put<=
/a></tt>
function converts a Lisp value into a C representation,
which is stored at the memory location denoted by
<tt><i>cptr</i></tt>,
according to the FFI type
<tt><i>type</i></tt>.
The function's return value is
<tt><i>obj</i></tt>.
</p><p>
If the
<tt><i>type</i></tt>
argument is specified, it must be a FFI type object.
If omitted, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object's type tag is interpreted as a FFI type symbol and resolved to
a type; the resulting type, if one is found is substituted for
<tt><i>type</i></tt>.
If the lookup fails an error exception is thrown.
</p><p>
The
<tt><i>obj</i></tt>
argument must be an object compatible with the conversions
implied by
<tt><i>type</i></tt>.
</p><p>
The
<tt><i>cptr</i></tt>
object must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
and point to a memory area suitably aligned for, and large
enough to hold a foreign representation of
<tt><i>type</i></tt>,
at the byte offset indicated by the
<tt><i>offset</i></tt>
argument.
</p><p>
If
<tt><i>cptr</i></tt>
is a null pointer, an exception is thrown.
</p><p>
It is assumed that
<tt><i>obj</i></tt>
is an object which was returned by an earlier call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00513A70">cptr-get<=
/a></tt>,
and that the
<tt><i>cptr</i></tt>
and
<tt><i>type</i></tt>
arguments are the same objects that were used in that call.
</p><p>
The
<tt>cptr-out</tt>
function performs the "out semantics" encoding action, similar
to the treatment applied to the arguments of a callback prior to
returning to foreign code.
</p><p>

</p></dd></dl>
<a name=3D"N-01CB17AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.13">9.50.13<=
/a> Variable <tt>cptr-null</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CB17AB">cptr-null=
</a></tt>
variable holds a null pointer as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
instance.
</p><p>
Two
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
objects may be compared for equality using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function, which tests whether their pointers are equal.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CB17AB">cptr-null=
</a></tt>
variable compares
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
to values which have been subject to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00913A85">cptr-zap<=
/a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B1FBEF">cptr-free=
</a></tt>.
</p><p>
A null
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
may be produced by the expression
<tt>(cptr-obj nil)</tt>;
however, this creates a freshly allocated object on each evaluation.
</p><p>
The expression
<tt>(cptr-int 0)</tt>
also produces a null pointer on all platforms where <b>TXR</b> is found.
</p><p>

</p></dd></dl>
<a name=3D"N-024CD90F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.50.14">9.50.14<=
/a> Function <tt>cptr-size-hint</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr-size-hint </tt><tt><i>cptr</i></tt><tt> </tt><tt><i>b=
ytes</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024CD90F">cptr-size=
-hint</a></tt>
function indicates to the garbage collector that the given
<tt><i>cptr</i></tt>
object is associated with
<tt><i>bytes</i></tt>
of foreign memory that are otherwise invisible to the garbage collector.
</p><p>
Note: this function should be used if the foreign memory is indirectly
managed by the
<tt><i>cptr</i></tt>
object in cooperation with the garbage collector. Specifically,
<tt><i>cptr</i></tt>
should have a finalizer registered against it which will liberate the
foreign memory.
</p><p>
</p></dd></dl>
<a name=3D"N-010D730D">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51">9.51</a> Us=
er-Defined Streams</h3>



<p>


</p><p>
In <b>TXR Lisp</b>, stream objects aren't structure types, and therefore li=
e outside of
the object-oriented programming system. However, <b>TXR Lisp</b> supports a=
 delegation
mechanism which allows a structure which provides certain methods to be use=
d as
a stream.
</p><p>
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FB1671">make-stru=
ct-delegate-stream</a></tt>
takes as an argument the instance of a structure, which is
referred to as the
<i>stream interface object</i>.

The function returns a stream object such that when
stream operations are invoked on this stream, it delegates these
operations to methods of the stream interface object.
</p><p>
A structure type called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
is provided, whose instances can serve as stream interface objects.
This structure has a slot called
<tt><i>stream</i></tt>
which holds a stream, and it provides all of the methods required for
the delegation mechanism used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FB1671">make-stru=
ct-delegate-stream</a></tt>.
This
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
operations simply invoke the ordinary stream operations on the
<tt><i>stream</i></tt>
slot. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
type can be used as a base class for a derived class which intercepts
certain operations on a stream (by defining the corresponding methods) whil=
e
allowing other operations to transparently pass to the stream (via the
base methods inherited from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>).
</p><p>

<a name=3D"N-03FB1671">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.1">9.51.=
1</a> Function <tt>make-struct-delegate-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-struct-delegate-stream </tt><tt><i>object</i></tt><tt=
>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FB1671">make-stru=
ct-delegate-stream</a></tt>
function returns a stream whose operations depend on the
<tt><i>object</i></tt>,
a stream interface object.
</p><p>
The
<tt><i>object</i></tt>
argument must be a structure which implements certain
subsets of, or all of, the following methods:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02390935">flush</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0136D6A2">seek</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0032FBF3">truncate<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00663AE2">get-prop<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03663AE4">set-prop<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005B">get-error</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0021">get-error-str=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0017">clear-error</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011D42AB">get-fd</a=
></tt>.
</p><p>
Implementing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00663AE2">get-prop<=
/a></tt>
is mandatory, and that method must support the
<tt>:name</tt>
property.
</p><p>
Failure to implement some of the other methods will impair the use of certa=
in
stream operations on the object.
</p><p>

</p></dd></dl>
<a name=3D"N-0376A37F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.2">9.51.2</a=
> Method <tt>put-string</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(put-string str)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006F">put-string</a=
></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-0146375A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.3">9.51.3</a=
> Method <tt>put-char</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(put-char chr)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0004">put-char</a><=
/tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-01963753">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.4">9.51.4</a=
> Method <tt>put-byte</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(put-byte byte)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-02963E19">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.5">9.51.5</a=
> Method <tt>get-line</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-line)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-0246375D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.6">9.51.6</a=
> Method <tt>get-char</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-char)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0040">get-char</a><=
/tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-00963754">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.7">9.51.7</a=
> Method <tt>get-byte</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-byte)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-006DC39A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.8">9.51.8</a=
> Method <tt>unget-char</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(unget-char chr)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001D">unget-char</a=
></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-027DC412">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.9">9.51.9</a=
> Method <tt>unget-byte</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(unget-byte byte)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000F">unget-byte</a=
></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-02117E37">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.10">9.51.10<=
/a> Method <tt>put-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(put-buf buf pos)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
stream I/O function.
</p><p>
Note: there is a severe restriction on the use of the
<tt><i>buf</i></tt>
argument. The buffer object denoted by the
<tt><i>buf</i></tt>
argument may be specially allocated and have a lifetime
which is scoped to the method invocation. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>
method shall not permit the
<tt><i>buf</i></tt>
object to be used beyond the duration of the method
invocation.
</p><p>

</p></dd></dl>
<a name=3D"N-013949E0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.11">9.51.11<=
/a> Method <tt>fill-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(fill-buf buf pos)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
stream I/O function.
</p><p>
Note: there is a severe restriction on the use of the
<tt><i>buf</i></tt>
argument. The buffer object denoted by the
<tt><i>buf</i></tt>
argument may be specially allocated and have a lifetime
which is scoped to the method invocation. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
method shall not permit the
<tt><i>buf</i></tt>
object to be used beyond the duration of the method
invocation.
</p><p>

</p></dd></dl>
<a name=3D"N-0308FCDD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.12">9.51.12<=
/a> Method <tt>close</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(close offs whence)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00596930">close-str=
eam</a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-02390935">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.13">9.51.13<=
/a> Method <tt>flush</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(flush offs whence)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02390935">flush</a>=
</tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03999913">flush-str=
eam</a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-0136D6A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.14">9.51.14<=
/a> Method <tt>seek</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(seek offs whence)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0136D6A2">seek</a><=
/tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031B5075">seek-stre=
am</a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-0032FBF3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.15">9.51.15<=
/a> Method <tt>truncate</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(truncate len)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0032FBF3">truncate<=
/a></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009F5B3F">truncate-=
stream</a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-00663AE2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.16">9.51.16<=
/a> Method <tt>get-prop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-prop sym)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00663AE2">get-prop<=
/a></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00663AE2">get-prop<=
/a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-03663AE4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.17">9.51.17<=
/a> Method <tt>set-prop</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(set-prop sym nval)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03663AE4">set-prop<=
/a></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03663AE4">set-prop<=
/a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-00121ED3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.18">9.51.18<=
/a> Method <tt>get-error</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-error)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005B">get-error</a>=
</tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005B">get-error</a>=
</tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-02F46C69">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.19">9.51.19<=
/a> Method <tt>get-error-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-error-str)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0021">get-error-str=
</a></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0021">get-error-str=
</a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-029208DD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.20">9.51.20<=
/a> Method <tt>clear-error</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(clear-error)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0017">clear-error</=
a></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0017">clear-error</=
a></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-011D42AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.21">9.51.21<=
/a> Method <tt>get-fd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>stream</i></tt><tt>.(get-fd)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011D42AB">get-fd</a=
></tt>
method is implemented on a stream interface object.
It should behave in a manner consistent with the
description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
stream I/O function.
</p><p>

</p></dd></dl>
<a name=3D"N-00FE2393">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.51.22">9.51.22<=
/a> Structure <tt>stream-wrap</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct stream-wrap nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;stream=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method put-string (me str)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(put-string str me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method put-char (me chr)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(put-char chr me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method put-byte (me byte)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(put-byte byte me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-line (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(get-line me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-char (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(get-char me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-byte (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(get-byte me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method unget-char (me chr)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unget-char chr me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method unget-byte (me byte)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unget-byte byte me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method put-buf (me buf pos)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(put-buf buf pos me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method fill-buf (me buf pos)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fill-buf buf pos me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method close (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(close-stream me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method flush (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(flush-stream me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method seek (me offs whence)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(seek-stream me.stream offs whence)=
)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method truncate (me len)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(truncate-stream me.stream len))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-prop (me sym)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(stream-get-prop me.stream sym))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method set-prop (me sym nval)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(stream-set-prop me.stream sym nval=
))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-error (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(get-error me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-error-str (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(get-error-str me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method clear-error (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clear-error me.stream))=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(:method get-fd (me)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fileno me.stream)))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
class provides a trivial implementation of a stream interface.
It has a single slot,
<tt>stream</tt>
which should be initialized with a stream object.
Each methods of
<tt><i>stream-wrap</i></tt>,
shown in its entirety in the above Syntax section, simply
invoke the corresponding stream I/O library functions, passing
the method arguments, and the value of the
<tt>stream</tt>
slot to that function, and consequently returning whatever that function
returns.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
function is intended to useful as an inheritance base. A user-defined
structure can inherit from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
and provide its own versions of some of the methods, thereby intercepting
those operations to customize the behavior.
</p><p>
For instance, a function equivalent to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009C0AC4">record-ad=
apter</a></tt>
function could be implemented by constructing an object derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FE2393">stream-wr=
ap</a></tt>
which overrides the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0031">get-line</a><=
/tt>
method, and then using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FB1671">make-stru=
ct-delegate-stream</a></tt>
to return a stream based on this object.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>   ;;; Implementation of my-record-adapter,
   ;;; a function resembling
   ;;; the record-adapter implementation

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a> rec-input stream-wrap
     regex
     include-match-p

     ;; get-line overridden to use regex-based
     ;; extraction using read-until-match
     (:method get-line (me)
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001D3F81">read-=
until-match</a> me.regex me.stream
                         me.include-match-p))))

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
 my-record-adapter (regex stream include-match-p)
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a>=
 ((recin (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new=
</a> rec-input
                       stream stream
                       regex regex
                       include-match-p include-match-p)))
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FB1671">make-s=
truct-delegate-stream</a> recin)))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-000CFF61">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52">9.52</a> Sy=
mbols and Packages</h3>



<p>


<b>TXR Lisp</b> has a package system inspired by the salient features of AN=
SI Common
Lisp, but substantially simpler.
</p><p>
Each symbol has a name, which is a string.
</p><p>
A package is an object which serves as a container of symbols; the package
associates the name strings with symbols.
</p><p>
A symbol which exists inside a package is said to be interned in that packa=
ge.
A symbol can be interned in more than one package.
</p><p>
A symbol may also have a home package. A symbol which has a home packageis =
always interned in that package.
</p><p>
A symbol which has a home package is called an
<i>interned symbol</i>.

</p><p>
A symbol which is interned in one or more packages, but has no home package=
,
is a
<i>quasi-interned symbol</i>.

When a quasi-interned symbol is printed, if it is not interned in
the package currently held in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable, it will appear in uninterned notation denoted by a
<tt>#:</tt>
prefix, even though it is interned in one or more packages.
This is because in any situation when a symbol is printed with a package
prefix, that prefix corresponds to the name of its home package.
The reverse isn't true: when a symbol token is read bearing a package
prefix, the token denotes any interned symbol in the indicated package,
whether or not the package is the home package of that symbol.
</p><p>
Packages are held in a global list which can be used to search for a packag=
e by
name. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250826D">find-pack=
age</a></tt>
function performs this lookup.  A package may be
deleted from the list with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E687F3">delete-pa=
ckage</a></tt>
function, but it continues
to exist until the program loses the last reference to that package.
When a package is deleted with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E687F3">delete-pa=
ckage</a></tt>,
its symbols are uninterned from all other packages.
</p><p>
An existing symbol can be brought into a package via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01747674">use-sym</=
a></tt>
function, causing it to be interned in that package. A symbol which thus ex=
ists
inside a package which is not its home package is called a
<i>foreign symbol</i>,

relative to that package.
The contrasting term with
<i>foreign symbol</i>

is
<i>local symbol</i>,

which refers to a symbol, relative to a package, which is interned in that
package and that package is also its home. Every symbol interned in
a package is either foreign or local.
</p><p>
If a foreign symbol is introduced into a package, and has the same name
as an existing local symbol, the local symbol continues to exist, but
is hidden: it is not accessible via a name lookup on that package.
While hidden, a symbol loses its home package and is thus
degraded to either quasi-interned or uninterned status, depending
on whether that symbol is interned in other packages.
</p><p>
When a foreign symbol is removed from a package via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AF42B7">unuse-sym=
</a></tt>,
then if a hidden symbol exists in that package of the same name,
that hidden symbol is re-interned in that package and re-acquires
that package as its home package, becoming an interned symbol again.
</p><p>
Finally, packages have a
<i>fallback package list</i>:

a list of associated packages, which may be empty. The fallback package
list is manipulated with the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027A535C">package-f=
allback-list</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027A535C">set-packa=
ge-fallback-list</a></tt>,
and with the
<tt>:fallback</tt>
clause of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>
macro.  The fallback package list plays a role only in three situations:
one in the <b>TXR Lisp</b> parser, one in the printer, and one in the inter=
active
listener. Besides that, two library functions refer to it:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern-fb=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EA8B50">find-symb=
ol-fb</a></tt>.
</p><p>
The parser situation involving the fallback list occurs when the
<b>TXR Lisp</b> parser resolves an unqualified symbol token: a symbol token=
 not carrying
a package prefix. Such a symbol name is resolved against the current packag=
e
(the package currently stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
special variable). If a symbol matching the token
is not found in the current package, then the packages in its fallback
package list are searched for the symbol.  The first matching symbol which =
is
found in the fallback list is returned.  If no matching symbol is found in =
the
fallback list, then the token is interned as a new symbol is interned in th=
e
current package.  The packages in the current package's fallback list may
themselves have fallback lists. Those fallback lists are not involved; no s=
uch
recursion takes place.
</p><p>
The printer situation involving the fallback list is as follows.
If a symbol is being printed in a machine-readable way (not "pretty"),
has a home package and is not a keyword symbol, then a search takes place
through the current package and its fallback list. If the symbol is found
in any of those places, and if those places are devoid of any symbols
which have the same name, thus causing ambiguity, then the symbol is printe=
d
without a package prefix.
</p><p>
The listener situation involving the fallback list is a follows.
When tab completion is used on a symbol without a package
prefix, the listener searches for completions not only in the current
package, but in the fallback list also.
</p><p>
</p><dl>
<dt>Dialect Notes:</dt><dd>
<p>


</p><p>
The <b>TXR Lisp</b> package system doesn't support the ANSI Common Lisp
concept of package use, replacing that concept with fallback packages.
</p><p>
Though the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">use-packa=
ge</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">unuse-pac=
kage</a></tt>
functions exist and are similar to the ones in ANSI CL,
they actually operate on individual foreign symbols, bringing
them in or removing them, respectively. These functions effectively
iterate over the local symbols of the used or unused package, and invoke
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01747674">use-sym</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AF42B7">unuse-sym=
</a></tt>,
respectively.
</p><p>
The <b>TXR Lisp</b> package system consequently doesn't support the concept
of shadowing symbols, and conflicts do not exist.  When a foreign symbol is
introduced into a package which already has a symbol by that name, that sym=
bol
is silently removed from that package if it is itself foreign, or else hidd=
en
if it is local.
</p><p>
The <b>TXR Lisp</b> package system also doesn't feature the concept of
internal and external symbols. The rationale is that this distinction
divides symbols into subsets in a redundant way. Packages are already
subsets of symbols. A module can use two packages to simulate private
symbols. An example of this is given in the Package Examples section below.
</p><p>
The <b>TXR Lisp</b> fallback package list mechanism resembles ANSI CL packa=
ge use,
and satisfies similar use scenarios. However, this mechanism does not cause
a symbol to be considered visible in a package. If a package
<tt>foo</tt>
contains no symbol
<tt>bar</tt>,
but one of the packages in
<tt>foo</tt>'s
fallback list does contain
<tt>bar</tt>,
that symbol is nevertheless not considered visible in
<tt>foo</tt>.
The syntax
<tt>foo:bar</tt>
will not resolve.
The fallback mechanism only comes into play when a package is installed
as the current package in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable. It then allows unqualified symbol references to refer across
the fallback list.
</p><p>
</p></dd></dl>
<a name=3D"N-02A96E4A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.1">9.52.1</a=
> Package Examples</h4>


The following example illustrates a simple scenario of a module
whose identifies are in a package, and which also has private identifiers
in a private package.
<p>
<tt>
</tt></p><pre><tt>  ;; Define three packages.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackage=
</a> mod-priv
    (:fallback usr))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackage=
</a> mod)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackage=
</a> client
    (:fallback mod usr)
    (:use-from mod-priv other-priv))

  ;; Switch to mod-priv package
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a>=
 mod-priv)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
priv-fun (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133AA5">arg=
</a>)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 arg))

  ;; Another function with a name in the mod-priv package.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
other-priv (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133AA5">a=
rg</a>)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a>=
 arg arg))

  ;; Define a function in mod; a public function.
  ;; Note that we don't have to change to the mod package,
  ;; to define functions with names in that package.
  ;; We rely on interning being allowed for the qualified
  ;; mod:public-fun syntax.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
mod:public-fun (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133AA=
5">arg</a>)
    (priv-fun arg)) ;; priv-fun here is mod-priv:priv-fun

  ;; Switch to client package
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a>=
 client)

  (priv-fun) ;; ERROR: refers to client:priv-fun, not defined
  (mod:priv-fun) ;; ERROR: mod-priv:priv-fun not used in mod
  (mod-priv:priv-fun 3) ;; OK: direct reference via qualifier
  (public-fun 3) ;; OK: mod:public-fun symbol via fallback
  (other-priv 3) ;; OK: foreign symbol mod-priv:other-priv
                 ;; present in client due to :use-from
</tt></pre><tt>

</tt>

<p>
The following example shows how to create a package called
<tt>custom</tt>
in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
symbol from the
<tt>usr</tt>
package is replaced with a local symbol. A function is
then defined using the local symbol, which allows strings
to be catenated with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
3951A2">defpackage</a> custom
    (:fallback usr)
    (:local + - * /))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> outside-macro (x) ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
007C">+</a> ,x 42))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a>=
 custom)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
binary-+ (: (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">=
left</a> 0) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020D5C1D">=
right</a> 0))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a> (<a h=
ref=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a> (<a href=3D"h=
ttp://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">numberp</a> left) (<a hre=
f=3D"http://nongnu.org/txr/txr-manpage.html#N-03E9D6E1">numberp</a> right))
      (usr:+ left right)
      `@left@right`))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
+ (. args)
    [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00FB426F">reduce-l=
eft</a> binary-+ args])

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a>) -&gt; 0
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 1) -&gt;=
 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 1 "a") -=
&gt; "1a"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 1 2) -&g=
t; 3
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> "a") -&g=
t; "a"
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> "a" "b" =
"c") -&gt; "abc"

  ;; macro expansions using usr:+ are not affected
  (outside-macro "a") -&gt; ;; error: + invalid operands "a" 42
</tt></pre><tt>

</tt>

<p>
<a name=3D"N-0162BA5A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.2">9.52.=
2</a> Packages and the Extraction Language</h4>


The <b>TXR</b> extraction language has a syntax in which certain Lisp symbo=
lic
expressions denoting directives
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
 ...)</tt>
or
<tt>@(end)</tt>
behave as if they were the tokens of a phrase structure.  As a matter of
implementation, these are processed specially in the parser and lexical
analyzer, and are not read in the same way as ordinary Lisp forms.
<p>
On the other hand, some directives are not this way. For instance the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> ..=
.)</tt>,
syntax is processed as a true Lisp expression, in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a></tt>
token is subject to the usual rules for interning a symbol, sensitive to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
in the usual way.
</p><p>
The following notes describe the treatment of "special" directives that are
involved in phrase structure syntax. It applies to all directives which hea=
d
off a block that must be terminated by
<tt>@(end)</tt>,
all "punctuation" directives like
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0049">and</a>)</t=
t>
or
<tt>@(end)</tt>
and all sub-phrase indicators like
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007A">last</a>)</=
tt>
or
<tt>@(elif)</tt>.
</p><p>
Firstly, each such directive may have a package prefix on its main symbol, =
yet
is still recognized as the same token. That is to say,
<tt>@(foo:collect)</tt>
is still treated by the tokenizer and parser as the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
token, regardless of the package prefix, and regardless of whether
<tt>foo:end</tt>
is the same symbol as the
<tt>usr:end</tt>
symbol.
</p><p>
However, this doesn't mean that any
<tt>foo:collect</tt>
is allowed to denote the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
directive.
</p><p>
A qualified symbol such as
<tt>foo:collect</tt>
must correspond to (be the same object as) precisely one of two symbols:
either the same-named symbol in the
<tt>usr</tt>
package, or else the same-named symbol in the
<tt>keyword</tt>
package. If this condition isn't satisfied, the situation is a syntax
error. Note that this check uses the original
<tt>usr</tt>
and
<tt>keyword</tt>
packages, not the packages which are currently named
<tt>"usr"</tt>

or
<tt>"keyword"</tt>

in the current
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>.
</p><p>
A check is also performed for an unqualified symbol.
An unqualified symbol like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
must also resolve, in the context of the current value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable, to the same named-symbol in either the original
<tt>usr</tt>
or
<tt>keyword</tt>
package. Thus if the current package isn't
<tt>usr</tt>,
and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
is being processed, the current package must be such that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a></=
tt>
resolves to
<tt>usr:collect</tt>.
either because that symbol is present in the current pack via
import, or else visible via the fallback list.
</p><p>
These rules are designed to approximate what the behavior would be
if these directives were actually scanned as Lisp forms in the usual
way and then recognized as phrase structure tokens according to
the identity of their leading symbol. The additional restriction is added t=
hat
that the directive symbol names are treated as reserved. If there exists a
user-defined pattern function called
<tt>mypackage:end</tt>
it may not be invoked using the syntax
<tt>@(mypackage:end)</tt>,
which is erroneous; though it is invocable indirectly via the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a=
>)</tt>
directive.
</p><p>
<a name=3D"N-0032A071">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.3">9.52.=
3</a> Package Library Conventions</h4>


Various functions in the package and symbol area of the library have a
<tt><i>package</i></tt>
parameter.  When the argument is optional, it defaults to the current
value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
special variable.
<p>
If specified, the argument may be a character string, which is taken as the
name of a package. It may also be a symbol, in which case the symbol's name=
,
which is a character string, is used. Thus the objects
<tt>:sys</tt>,
<tt>usr:sys</tt>,
<tt>abc:sys</tt>
and
<tt>"sys"</tt>

all refer to the same package, the system package which is named
<tt>"sys"</tt>.
</p><p>
A
<tt>package</tt>
parameter may also simply be a package object.
</p><p>
Some functions, like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">use-packa=
ge</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">unuse-pac=
kage</a></tt>
functions accept a list of packages as their first argument.
This may be a list of objects which follow the above conventions:
strings, symbols or package objects.
Also, instead of a list, an atom may be passed: a string, symbol
or package object. It is treated as a singleton list consisting
of that object.
</p><p>

<a name=3D"N-0383342A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.4">9.52.=
4</a> Variables <tt>user-package</tt>, <tt>keyword-package</tt> and <tt>sys=
tem-package</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold predefined packages. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0383342A">user-pack=
age</a></tt>
contains all of the public symbols in the <b>TXR Lisp</b> library.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0383342A">keyword-p=
ackage</a></tt>
holds keyword symbols, which are printed with
a leading colon. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0383342A">system-pa=
ckage</a></tt>
is for internal symbols, helping
the implementation avoid name clashes with user code in some situations.
</p><p>
These variables shouldn't be modified.  If they are modified, the consequen=
ces
are unspecified.
</p><p>
The names of these packages, respectively, are
<tt>"usr"</tt>,
<tt>"sys"</tt>,
and
<tt>"keyword"</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-000CBBA0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.5">9.52.5</a=
> Special variable <tt>*package*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This variable holds the current package. The global value of this variable
is initialized to a package called
<tt>"pub"</tt>.
The
<tt>pub</tt>
package has the
<tt>usr</tt>
package in its fallback list; thus when
<tt>pub</tt>
is current, all of the
<tt>usr</tt>
symbols, comprising the content of the <b>TXR Lisp</b> library, are visible=
.
</p><p>
All forms read and evaluated from the <b>TXR</b> command line, in the inter=
active listener,
from files via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
or from the <b>TXR</b> pattern language are processed in this default
<tt>pub</tt>
package, unless arrangement are made to change to a different package.
</p><p>
The current package is used as the default package for interning symbol tok=
ens
which do not carry the colon-delimited package prefix.
</p><p>
The current package also affects printing. When a symbol is printed whose
home package matches the current package, it is printed without a package
prefix. (Keyword symbols are always printed with the colon prefix, even if =
the
keyword package is current.)
</p><p>

</p></dd></dl>
<a name=3D"N-0084463A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.6">9.52.6</a=
> Function <tt>make-sym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-sym </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0084463A">make-sym<=
/a></tt>
function creates and returns a new symbol object. The argument
<tt><i>name</i></tt>,
which must be a string, specifies the name of the symbol.  The symbol
does not belong to any package (it is said to be "uninterned").
</p><p>
Note: an uninterned symbol can be interned into a package with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03627360">rehome-sy=
m</a></tt>
function. Also see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern</a=
></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-03AA7FBB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.7">9.52.7</a=
> Function <tt>gensym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(gensym [</tt><tt><i>prefix</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
function is similar to make-sym. It creates and returns a new
symbol object. If the
<tt><i>prefix</i></tt>
argument is omitted, it defaults to
<tt>"g"</tt>.
Otherwise it must be a string.
</p><p>
The difference between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0084463A">make-sym<=
/a></tt>
is that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
creates the name
by combining the prefix with a numeric suffix.
</p><p>
The numeric suffix is a decimal digit string, taken from the value of
the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387B1B1">*gensym-c=
ounter*</a></tt>,
after incrementing it.
</p><p>
Note: the variation in name is not the basis of the uniqueness assurance
offered by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0084463A">make-sym<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>;
the basis is that the returned symbol is a freshly instantiated object.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0084463A">make-sym<=
/a></tt>
still returns unique symbols even if repeatedly called with the same
string.
</p><p>

</p></dd></dl>
<a name=3D"N-0387B1B1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.8">9.52.8</a=
> Special variable <tt>*gensym-counter*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This variable is initialized to 0. Each time the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
function is called,
it is incremented. The incremented value forms the basis of the numeric
suffix which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
uses to form the name of the new symbol.
</p><p>

</p></dd></dl>
<a name=3D"N-02512A9A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.9">9.52.9</a=
> Function <tt>make-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-package </tt><tt><i>name</i></tt><tt> [</tt><tt><i>we=
ak</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02512A9A">make-pack=
age</a></tt>
function creates and returns a package named
<tt><i>name</i></tt>,
where
<tt><i>name</i></tt>
is a string. It is an error if a package by that name exists already.
Note: ordinary creation of packages for everyday program modularization
should be performed with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>
macro rather than by direct use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02512A9A">make-pack=
age</a></tt>.
</p><p>
If the
<tt><i>weak</i></tt>
parameter is given an argument which is a Boolean true, then the resulting
package holds symbols weakly, from a garbage collection point of view.  If =
the
only reference to a symbol is that which occurs inside the weak package, th=
en
that symbol may be removed from the package and reclaimed by the garbage
collector.
</p><p>
Note: weak packages address the following problem. The application creates =
a
package for the purpose of reading Lisp data. Symbols occurring in that dat=
a
therefore are interned into the package. Subsequently, the application reta=
ins
references to some of the symbols, discarding the others.  If the package i=
sn't
weak, then because the application is retaining some of the symbols, and th=
ose
symbols hold a reference to the package, and the package holds a reference =
to
all symbols that were interned in it, all of the symbols are retained. If a
weak package is used, then the uninterested symbols are eligible for garbag=
e
collection.
</p><p>

</p></dd></dl>
<a name=3D"N-02E687F3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.10">9.52.10<=
/a> Function <tt>delete-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(delete-package </tt><tt><i>package</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E687F3">delete-pa=
ckage</a></tt>
breaks the association between a package and its name.
After
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E687F3">delete-pa=
ckage</a></tt>,
the
<tt><i>package</i></tt>
object continues to exist, but cannot be found using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250826D">find-pack=
age</a></tt>.
</p><p>
Furthermore,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E687F3">delete-pa=
ckage</a></tt>
iterates over all remaining packages. For each remaining package
<tt><i>p</i></tt>,
it performs the semantic action of the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">unuse-packag=
e</a> </tt><tt><i>package</i></tt><tt> </tt><tt><i>p)</i></tt><tt>=20

</tt>

expression. That is to say, all of the remaining packages
are scrubbed of any foreign symbols which are the local symbols
of the deleted
<tt><i>package</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0160EA2C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.11">9.52.11<=
/a> Function <tt>merge-delete-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(merge-delete-package dst-package [</tt><tt><i>src-package<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0160EA2C">merge-del=
ete-package</a></tt>
iterates over all of the local symbols of
<tt><i>src-package</i></tt>
and rehomes each symbol into
<tt><i>dst-package</i></tt>.
Then, it deletes
<tt><i>src-package</i></tt>.
</p><p>
Note: the local symbols are identified as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C06F5">package-l=
ocal-symbols</a></tt>,
rehoming is performed as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03627360">rehome-sy=
m</a></tt>,
and deleting
<tt><i>src-package</i></tt>
is performed as if using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E687F3">delete-pa=
ckage</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007A478F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.12">9.52.12<=
/a> Function <tt>packagep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(packagep </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007A478F">packagep<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a package, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0250826D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.13">9.52.13<=
/a> Function <tt>find-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(find-package </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The argument
<tt><i>name</i></tt>
should be a string. If a package called
<tt><i>name</i></tt>
exists,
then it is returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-00E20381">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.14">9.52.14<=
/a> Special variable <tt>*package-alist*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>
variable contains the master association list
which contains an entry about each existing
package.
</p><p>
Each element of the list is a cons cell
whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field is the name of a package and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is a package object.
</p><p>
Note: the <b>TXR Lisp</b> application can overwrite or re-bind this
variable to manipulate the active package list.  This is
useful for
<i>sandboxing</i>:

safely evaluating code that is obtained as an input
from an untrusted source, or calculated from such an input.
</p><p>
The contents of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>
have security implications because textual source code
can refer to any symbol in any package by invoking
a package prefix. For instance, even if the
<tt>open</tt>
function's name is not available in the current package
(established by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable) that symbol can easily be obtained using the
syntax
<tt>usr:open</tt>.
</p><p>
However, the entire
<tt>usr</tt>
package itself can be removed from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>.
In that situation, the syntax
<tt>usr:open</tt>
is no longer valid.
</p><p>
At the same time, selected symbols from the original
<tt>usr</tt>
can be nevertheless made available via some intermediate
package, which is present in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>
and which contains a subset of the
<tt>usr</tt>
symbols that has been curated for safety. That curated package may even
be called
<tt>usr</tt>,
so that if for instance
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
is present in that package, it may be referred to as
<tt>usr:cons</tt>
in the usual way.
</p><p>

</p></dd></dl>
<a name=3D"N-017F684C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.15">9.52.15<=
/a> Function <tt>package-alist</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(package-alist)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017F684C">package-a=
list</a></tt>
function retrieves the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>.
</p><p>
Note: this function is obsolescent. There is no reason to use it
in new code instead of just accessing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E20381">*package-=
alist*</a></tt>
directly.
</p><p>

</p></dd></dl>
<a name=3D"N-038581D9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.16">9.52.16<=
/a> Function <tt>package-name</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(package-name </tt><tt><i>package</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038581D9">package-n=
ame</a></tt>
function retrieves the name of a package.
</p><p>

</p></dd></dl>
<a name=3D"N-03AF0206">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.17">9.52.17<=
/a> Function <tt>package-symbols</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(package-symbols [</tt><tt><i>package</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AF0206">package-s=
ymbols</a></tt>
function returns a list of all the symbols
which are interned in
<tt><i>package</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-030C06F5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.18">9.52.18<=
/a> Functions <tt>package-local-symbols</tt> and <tt>package-foreign-symbol=
s</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(package-local-symbols [</tt><tt><i>package</i></tt><tt>])=
=20




<br>&nbsp;&nbsp;(package-foreign-symbols [</tt><tt><i>package</i></tt><tt>]=
)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C06F5">package-l=
ocal-symbols</a></tt>
function returns a list of all the symbols
which are interned in
<tt><i>package</i></tt>,
and whose home package is that package.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030C06F5">package-f=
oreign-symbols</a></tt>
function returns a list of all the symbols which
are interned in
<tt><i>package</i></tt>,
which do not have that package as their home package,
or do not have a home package at all.
</p><p>
The union of the local and foreign symbols contains exactly
the same elements as the list returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AF0206">package-s=
ymbols</a></tt>:
the symbols interned in a package are partitioned into
local and foreign.
</p><p>

</p></dd></dl>
<a name=3D"N-027A535C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.19">9.52.19<=
/a> Functions <tt>package-fallback-list</tt> and <tt>set-package-fallback-l=
ist</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(package-fallback-list </tt><tt><i>package</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set-package-fallback-list </tt><tt><i>package</i></tt><tt>=
 </tt><tt><i>package-list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027A535C">package-f=
allback-list</a></tt>
returns the current
<i>fallback package list</i>

associated with
<tt><i>package</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027A535C">set-packa=
ge-fallback-list</a></tt>
replaces the fallback package list of
<tt><i>package</i></tt>
with
<tt><i>package-list</i></tt>.
</p><p>
The
<tt><i>package-list</i></tt>
argument must be a list which is a mixture of symbols, strings or
package objects. Strings are taken to be package names, which must
resolve to existing packages. Symbols are reduced to strings via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D3BBF">symbol-na=
me</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02722B58">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.20">9.52.20<=
/a> Functions <tt>intern</tt> and <tt>intern-fb</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(intern </tt><tt><i>name</i></tt><tt> [</tt><tt><i>package<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The argument
<tt><i>name</i></tt>
must be a string. The optional argument
<tt><i>package</i></tt>
must be a package. If
<tt><i>package</i></tt>
is not supplied, then the value
taken is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern</a=
></tt>
function searches
<tt><i>package</i></tt>
for a symbol called
<tt><i>name</i></tt>.
If that symbol is found, it is returned. If that symbol is not found,
then a new symbol called
<tt><i>name</i></tt>
is created and inserted into
<tt><i>package</i></tt>,
and that symbol is returned. In this case, the package becomes the
symbol's home package.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern-fb=
</a></tt>
function is very similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern</a=
></tt>
except that if the symbol is not found in
<tt><i>package</i></tt>
then the packages listed in the fallback list of
<tt><i>package</i></tt>
are searched, in order. Only these packages themselves are searched,
not their own fallback lists. If a symbol called
<tt><i>name</i></tt>
is found, the search terminates and that symbol is returned.
Only if nothing is found in the fallback list will
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern-fb=
</a></tt>
create a new symbol and insert it into
<tt><i>package</i></tt>,
exactly like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern</a=
></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01B6BFC2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.21">9.52.21<=
/a> Function <tt>unintern</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(unintern </tt><tt><i>symbol</i></tt><tt> [</tt><tt><i>pack=
age</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B6BFC2">unintern<=
/a></tt>
function removes
<tt><i>symbol</i></tt>
from
<tt><i>package</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
symbol may not be removed from the
<tt>usr</tt>
package; an error exception is thrown in this case.
</p><p>
If
<tt>symbol</tt>
isn't
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><i>package</i></tt>
is searched to determine whether it contains
<tt><i>symbol</i></tt>
as an interned symbol (either local or foreign), or a hidden symbol.
</p><p>
If
<tt><i>symbol</i></tt>
is a hidden symbol, then it is removed from the hidden symbol store.
Thereafter, even if a same-named foreign symbol is removed from the
package via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AF42B7">unuse-sym=
</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">unuse-pac=
kage</a></tt>,
those operations will no longer restore the hidden symbol to interned
status. In this case,
<tt><i>unintern</i></tt>
returns the hidden symbol that was removed from the hidden store.
</p><p>
If
<tt><i>symbol</i></tt>
is a foreign symbol, then it is removed from the package. If the package
has a hidden symbol of the same name, that hidden symbol is re-interned
in the package, and the package once again becomes its home package.
In this case,
<tt><i>symbol</i></tt>
is returned.
</p><p>
If
<tt><i>symbol</i></tt>
is a local symbol, the symbol is removed from the package.
In this case also,
<tt><i>symbol</i></tt>
is returned.
</p><p>
If
<tt><i>symbol</i></tt>
is not found in the package as either an interned or hidden
symbol, then the function has no effect and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01EA8B50">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.22">9.52.22<=
/a> Functions <tt>find-symbol</tt> and <tt>find-symbol-fb</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(find-symbol </tt><tt><i>name</i></tt><tt> [</tt><tt><i>pac=
kage</i></tt><tt> [</tt><tt><i>notfound-val</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(find-symbol-fb </tt><tt><i>name</i></tt><tt> [</tt><tt><i>=
package</i></tt><tt> [</tt><tt><i>notfound-val</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EA8B50">find-symb=
ol</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EA8B50">find-symb=
ol-fb</a></tt>
functions search
<tt><i>package</i></tt>
for a symbol called
<tt><i>name</i></tt>.
That argument must be a character string.
</p><p>
If the
<tt><i>package</i></tt>
argument is omitted, the parameter defaults to the
current value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>.
</p><p>
If the symbol is found in
<tt><i>package</i></tt>
then it is returned.
</p><p>
If the symbol is not found in
<tt><i>package</i></tt>,
then the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EA8B50">find-symb=
ol-fb</a></tt>
also searches the packages listed in the fallback list of
<tt><i>package</i></tt>
are searched, in order. Only these packages themselves are searched,
not their own fallback lists. If a symbol called
<tt><i>name</i></tt>
is found, the search terminates and that symbol is returned.
</p><p>
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EA8B50">find-symb=
ol</a></tt>
only searches
<tt><i>package</i></tt>,
ignoring its fallback list.
</p><p>
If a symbol called
<tt><i>name</i></tt>
isn't found, then these functions return
<tt><i>notfound-val</i></tt>
is returned, which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: an ambiguous situation exists when
<tt><i>notfound-val</i></tt>
is a symbol, such as its default value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
because if that symbol is successfully found,
it is indistinguishable from
<tt><i>notfound-val</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03627360">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.23">9.52.23<=
/a> Function <tt>rehome-sym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rehome-sym </tt><tt><i>symbol</i></tt><tt> [</tt><tt><i>pa=
ckage</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The arguments
<tt><i>symbol</i></tt>
and
<tt><i>package</i></tt>
must be a symbol and package object,
respectively, and
<tt><i>symbol</i></tt>
must not be the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03627360">rehome-sy=
m</a></tt>
function moves
<tt><i>symbol</i></tt>
into
<tt><i>package</i></tt>.
If
<tt><i>symbol</i></tt>
is already interned in a package, it is first removed from that package.
</p><p>
If a symbol of the same name exists in
<tt><i>package</i></tt>,
that symbol is first removed
from
<tt><i>package</i></tt>.
</p><p>
Also, if a symbol of the same name exists in the hidden symbol store of
<tt><i>package</i></tt>,
that hidden symbol is removed.
</p><p>
Then
<tt>symbol</tt>
is interned into
<tt><i>package</i></tt>,
and
<tt><i>package</i></tt>
becomes its home package, making it a local symbol of
<tt><i>package</i></tt>.
</p><p>
Note: if
<tt>symbol</tt>
is currently the hidden symbol of some package, it is not removed
from the hidden symbol store of that package. This is a degenerate
case. The implication is that if that hidden symbol is ever
restored in that package, it will once again have that package as
its home package, and consequently it will turn into a foreign
symbol of
<tt><i>package</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01C0BF69">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.24">9.52.24<=
/a> Function <tt>symbolp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(symbolp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C0BF69">symbolp</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a symbol, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-035D3BBF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.25">9.52.25<=
/a> Function <tt>symbol-name</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(symbol-name </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D3BBF">symbol-na=
me</a></tt>
function returns the name of
<tt><i>symbol</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02AB2428">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.26">9.52.26<=
/a> Function <tt>symbol-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(symbol-package </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AB2428">symbol-pa=
ckage</a></tt>
function returns the home package of
<tt><i>symbol</i></tt>.
If
<tt><i>symbol</i></tt>
has no home package, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01405F25">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.27">9.52.27<=
/a> Function <tt>keywordp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(keywordp </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01405F25">keywordp<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a keyword symbol, otherwise it
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0222F2E3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.28">9.52.28<=
/a> Function <tt>bindable</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bindable </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a bindable symbol, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
All symbols are bindable, except for keyword symbols, and the
special symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01747674">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.29">9.52.29<=
/a> Function <tt>use-sym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(use-sym </tt><tt><i>symbol</i></tt><tt> [</tt><tt><i>packa=
ge</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01747674">use-sym</=
a></tt>
function brings an existing
<tt>symbol</tt>
into
<tt><i>package</i></tt>.
</p><p>
In all cases, the function returns
<tt>symbol</tt>.
</p><p>
If
<tt><i>symbol</i></tt>
is already interned in
<tt><i>package</i></tt>,
then the function has no effect.
</p><p>
Otherwise
<tt><i>symbol</i></tt>
is interned in
<tt><i>package</i></tt>.
</p><p>
If a symbol having the same name as
<tt><i>symbol</i></tt>
already exists in
<tt><i>package</i></tt>,
then it is replaced.
If that replaced symbol is a local symbol of
<tt><i>package</i></tt>,
then the replaced symbol turns into a hidden symbol associated
with the package. It is placed into a special hidden symbol store
associated with
<tt><i>package</i></tt>
and is stripped of its home package, becoming quasi-interned or uninterned.
</p><p>
An odd case is possible whereby
<tt><i>symbol</i></tt>
is already a hidden symbol of
<tt><i>package</i></tt>.
In this case, the hidden symbol replaces some foreign symbol and
is interned in
<tt><i>package</i></tt>.
Thus it simultaneously exists as both an interned
foreign symbol and as a hidden symbol of
<tt><i>package</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01AF42B7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.30">9.52.30<=
/a> Function <tt>unuse-sym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(unuse-sym </tt><tt><i>symbol</i></tt><tt> [</tt><tt><i>pac=
kage</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AF42B7">unuse-sym=
</a></tt>
function removes
<tt><i>symbol</i></tt>
from
<tt><i>package</i></tt>.
</p><p>
If
<tt><i>symbol</i></tt>
is not interned in
<tt><i>package</i></tt>,
the function does nothing and returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If
<tt><i>symbol</i></tt>
is a local symbol of
<tt><i>package</i></tt>,
an error is thrown: a package cannot "unuse" its own symbol. Removing
a symbol from its own home package requires the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B6BFC2">unintern<=
/a></tt>
function.
</p><p>
Otherwise
<tt><i>symbol</i></tt>
is a foreign symbol interned in
<tt><i>package</i></tt>
and is removed.
</p><p>
If the package has a hidden symbol of the same name as
<tt><i>symbol</i></tt>,
that symbol is re-interned into
<tt><i>package</i></tt>
as a local symbol. In this case, that previously hidden symbol is
returned.
</p><p>
If the package has no hidden symbol matching the removed
<tt><i>symbol</i></tt>,
then
<tt><i>symbol</i></tt>
itself is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-024BF63F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.31">9.52.31<=
/a> Functions <tt>use-package</tt> and <tt>unuse-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(use-package </tt><tt><i>package-list</i></tt><tt> [</tt><t=
t><i>package</i></tt><tt>])=20




<br>&nbsp;&nbsp;(unuse-package </tt><tt><i>package-list</i></tt><tt> [</tt>=
<tt><i>package</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>use-package</i></tt>
and
<tt><i>unuse-package</i></tt>
are convenience functions which perform a mass import of symbols from one
package to another, or a mass removal, respectively.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">use-packa=
ge</a></tt>
function iterates over all of the local symbols of the packages in
<tt><i>package-list</i></tt>.
For each symbol
<tt><i>s</i></tt>,
it performs the semantic action implied by the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01747674">use-sym</a> =
</tt><tt><i>s</i></tt><tt> </tt><tt><i>package</i></tt><tt>)=20

</tt>

expression.
</p><p>
Similarly
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">unuse-pac=
kage</a></tt>
iterates
<tt><i>package-list</i></tt>
in the same way, performing, effectively, the semantic action
of the
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AF42B7">unuse-sym</a=
> </tt><tt><i>s</i></tt><tt> </tt><tt><i>package</i></tt><tt>)=20

</tt>

expression.
</p><p>
The
<tt><i>package-list</i></tt>
argument must be a list which is a mixture of symbols, strings or
package objects. Strings are taken to be package names, which must
resolve to existing packages. Symbols are reduced to strings via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D3BBF">symbol-na=
me</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-033951A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.32">9.52.32<=
/a> Macro <tt>defpackage</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defpackage </tt><tt><i>name</i></tt><tt> </tt><tt><i>claus=
e</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>
macro provides a convenient means to create a package and establish its
properties in a single construct. It is intended for the ordinary situation=
s
in which packages support the organization of programs into modules.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
argument, giving the package name, may be a symbol or a character string.
If it is a symbol, then the symbol's name is taken to be name for the
package.
</p><p>
If a package called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
already exists, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>
selects that package for further operations. Otherwise, a new,
empty package is created. In either case, this package is referred
to as the
<i>present package</i>

in the following descriptions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
may be optionally followed by one or more clauses, which are processed
in the order that they appear. Each clause is a compound form headed
by a keyword.
The supported clauses are as follows:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>(:fallback <tt><i>package-name</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:fallback</tt>
clause specifies the packages to comprise the fallback list of
the present package. If this clause is omitted, or if it is present
with not
<tt><i>package-name</i></tt>
arguments, then the present package has an empty fallback list.
Each
<tt><i>package-name</i></tt>
may be a string or symbol naming an existing package. It is permitted
for the present package itself to appear in its own fallback list.
This is useful for creating a package with a non-empty fallback list
which doesn't actually provide access to any other package.



</dd><dt><tt>(:use <tt><i>package-name</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:use</tt>
clause specifies packages whose local symbols are to be interned
into the present package as foreign symbols. Each
<tt><i>package-name</i></tt>
may be a string or symbol naming an existing package.
The list of package names is processed as if by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024BF63F">use-packa=
ge</a></tt>.



</dd><dt><tt>(:use-syms <tt><i>symbol</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:use-syms</tt>
clause specifies individual symbols to be interned in the present package.
The arguments are symbols.



</dd><dt><tt>(:use-from <tt><i>package-name</i></tt><tt> </tt><tt><i>symbol=
-name</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:use-from</tt>
clause specifies the names of local symbols in a package denoted by
<tt><i>package-name</i></tt>
to be used in the present package. All arguments of
<tt>:use-from</tt>
are either strings or symbols which are reduced to strings by mapping
to their names. Each
<tt><i>symbol-name</i></tt>
is interned in the package identified by
<tt><i>package-name</i></tt>,
which may have the effect of creating that symbol.
This symbol is expected to be a local symbol of that package. If
that is so, the symbol is brought into the present package via
<tt>use-symbol</tt>.
Otherwise if the symbol is foreign to package identified by
<tt><i>package-name</i></tt>,
then an error exception is thrown.



</dd><dt><tt>(:local <tt><i>symbol-name</i></tt><tt>*) </tt></tt></dt><dd>



The
<tt>:local</tt>
clause specifies the names of symbols to be interned in the new package
as local symbols. Each
<tt><i>symbol-name</i></tt>
argument must be either a character string or a symbol. If it is a symbol, =
its
name is taken, thereby reducing the argument to a character string.
The arguments are processed in the order in which they appear. Each name is
first interned in the newly created package using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02722B58">intern</a=
></tt>
function. Then, if the resulting symbol is foreign to the package, it is
removed with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AF42B7">unuse-sym=
</a></tt>
and the name is interned again.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-0179530B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.52.33">9.52.33<=
/a> Macro <tt>in-package</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(in-package </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
macro causes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
special variable to take on the package denoted by
<tt><i>name</i></tt>.
The macro checks, at expansion time, that
<tt><i>name</i></tt>
is either a string or symbol. An error is thrown if
this isn't the case.
</p><p>
The
<tt><i>name</i></tt>
argument expression isn't evaluated, and so must not be quoted.
</p><p>
The code generated by the macro performs a search for the
package. If the package is not found at the time when
the macro's expansion is evaluated, an error is thrown.
</p><p>
</p></dd></dl>
<a name=3D"N-00776B60">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53">9.53</a> Ps=
eudo-random Numbers</h3>



<p>



<a name=3D"N-033875AD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.1">9.53.=
1</a> Special variable <tt>*random-state*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>
variable holds an object which encapsulates the state
of a pseudo-random number generator. This variable is the default argument
value for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A57C86">random-fi=
xnum</a></tt>
and
<tt>random functions</tt>,
for the convenience of writing programs which are not concerned about the
management of random state.
</p><p>
On the other hand, programs can create and manage random states, making it
possible to obtain repeatable sequences of pseudo-random numbers which do n=
ot
interfere with each other. For instance objects or modules in a program can
have their own independent streams of random numbers which are repeatable,
independently of other modules making calls to the random number functions.
</p><p>
When <b>TXR</b> starts up, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>
variable is initialized with
a newly created random state object, which is produced as if by
the call
<tt>(make-random-state 42)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-010348CD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.2">9.53.2</a=
> Special variable <tt>*random-warmup*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010348CD">*random-w=
armup*</a></tt>
special variable specifies the value which is used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032BEE6C">make-rand=
om-state</a></tt>
in place of a missing
<tt><i>warmup-period</i></tt>
argument.
</p><p>
To "warm up" a pseudo-random number generator (PRNG) means to obtain some
values from it which are discarded, prior to use.  The number of values
discarded is the
<i>warm-up period</i>.

</p><p>
The WELL512a PRNG used in <b>TXR</b> produces 32-bit values, natively. Thus=
 each
warm-up iteration retrieves and discards a 32-bit value. The PRNG has
a state space consisting of a vector of sixteen 32-bit words, making
the state space 4096 bits wide.
</p><p>
Warm up is required because PRNG-s, in particular PRNG-s with large state
spaces and long periods, produce fairly predictable sequences of values in =
the
beginning, before transitioning into chaotic behavior. This problem is wors=
e
for low complexity seeds, such as small integer values.
</p><p>
The sequences are predictable in two ways. Firstly, some initial values
extracted from the PRNG may exhibit patterns ("problem 1"). Secondly, the i=
nitial values
from sequences produced from similar seeds (for instance consecutive intege=
rs)
may be similar or identical ("problem 2").
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
The default value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010348CD">*random-w=
armup*</a></tt>
is only 8.  This is insufficient to
ensure good initial PRNG behavior for seeds even as large as 64 bits or mor=
e.
That is to say, even if as many as eight bytes' worth of true random bits a=
re
used as the seed, the PRNG will exhibit predictable behaviors, and a poor
distribution of values.
</p><p>
Applications which critically depend on good PRNG behavior should choose
large warm-up periods into the hundreds or thousands of iterations.
If a small warm-up period is used, it is recommended to use larger seeds
which initialize more of the 4096 bit state space.
</p><p>
<b>TXR</b>'s PRNG implementation addresses "problem 1" first problem by pad=
ding the
unseeded portions of the state space with random values (from a static tabl=
e
that doesn't change). For instance, if the integer 1 is used to seed the sp=
ace,
then one 32 bit word of the space is set to the value 1. The remaining 15 a=
re
populated from the random table. This helps to ensure that a good PRNG sequ=
ence
is obtained immediately. However, it doesn't address "problem 2": that
similar seed values generate similar sequences, when the warm-up period is
small. For instance, if 65536 different random state objects are created, f=
rom
each of the 16-bit seeds in the range [0, 65536), and then a random 16-bit
value is extracted from each state, only 1024 unique values result.
</p><p>

</p></dd></dl>
<a name=3D"N-032BEE6C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.3">9.53.3</a=
> Function <tt>make-random-state</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-random-state [</tt><tt><i>seed</i></tt><tt> [</tt><tt=
><i>warmup-period</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032BEE6C">make-rand=
om-state</a></tt>
function creates and returns a new random state,
an object of the same kind as what is stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>
variable.
</p><p>
The seed, if specified, must be either an integer value, an
existing random state object, or a vector returned from a call
to the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005C0F98">random-st=
ate-get-vec</a></tt>.
</p><p>
Note that the sign of the seed is ignored, so that negative seed
values are equivalent to their additive inverses.
</p><p>
If seed is not specified, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032BEE6C">make-rand=
om-state</a></tt>
produces a seed based
on some information in the process environment, such as current
time of day. It is not guaranteed that two calls to
<tt>(make-random-state)</tt>
that are separated by less than some minimum increment of real time produce
different seeds.  The minimum time increment depends on the platform.
</p><p>
On a platform with a millisecond-resolution real-time clock, the minimum
time increment is a millisecond. Calls to make-random-state less than
a millisecond apart may predictably produce the same seed.
</p><p>
If an integer seed is specified, then the integer value is mapped to a
pseudo-random sequence, in a platform-independent way.</p><p>
If an existing random state is specified as a seed, then it is duplicated. =
The
returned random state object is a distinct object which is in the same
state as the input object. It will produce the same remaining pseudo-random
number sequence, as will the input object.
</p><p>
If a vector is specified as a seed, then a random state is constructed
which duplicates the random state object which was captured in that vector
representation by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005C0F98">random-st=
ate-get-vec</a></tt>
function.
</p><p>
The
<tt><i>warm-up-period</i></tt>
argument specifies the number of values which are immediately obtained and
discarded from the newly-seeded generator before it is returned.
Warm-up is not performed when
<tt><i>seed</i></tt>
is an existing random state object, and this argument is ignored in that
case. If the parameter is required, but the argument is missing, then
the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010348CD">*random-w=
armup*</a></tt>
special variable is used. This variable has a default value which may be to=
o
small for serious applications of pseudo-random numbers; see the Notes unde=
r
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010348CD">*random-w=
armup*</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00C9A749">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.4">9.53.4</a=
> Function <tt>random-state-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(random-state-p </tt><tt><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C9A749">random-st=
ate-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>obj</i></tt>
is a random state, otherwise it
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-005C0F98">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.5">9.53.5</a=
> Function <tt>random-state-get-vec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(random-state-get-vec [</tt><tt><i>random-state</i></tt><tt=
>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005C0F98">random-st=
ate-get-vec</a></tt>
function converts a random state into a vector of integer values.
If the
<tt><i>random-state</i></tt>
argument, which must be a random state object, is omitted,
then the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>
is used.
</p><p>

</p></dd></dl>
<a name=3D"N-03A57C86">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.6">9.53.6</a=
> Functions <tt>random-fixnum</tt>, <tt>random</tt> and <tt>rand</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(random-fixnum [</tt><tt><i>random-state</i></tt><tt>])=20




<br>&nbsp;&nbsp;(random </tt><tt><i>random-state</i></tt><tt> </tt><tt><i>m=
odulus</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rand </tt><tt><i>modulus</i></tt><tt> [</tt><tt><i>random-=
state</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



All three functions produce pseudo-random numbers, which are positive integ=
ers.
</p><p>
The numbers are obtained from a WELL512a PRNG, whose state is stored in the
random state object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A57C86">random-fi=
xnum</a></tt>
function produces a random fixnum integer: a reduced range
integer which fits into a value that does not have to be heap-allocated.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A57C86">random</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A57C86">rand</a><=
/tt>
functions produce a value in the range [0,
<tt><i>modulus</i></tt>).
They differ only in the order of arguments. In the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A57C86">rand</a><=
/tt>
function, the random state
object is the second argument and is optional. If it is omitted, the global
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>
object is used.
</p><p>
The
<tt><i>modulus</i></tt>
argument must be a positive integer. If
<tt><i>modulus</i></tt>
is 1, then the function returns zero without altering the state of the
pseudo-random number generator.
</p><p>

</p></dd></dl>
<a name=3D"N-01572D27">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.53.7">9.53.7</a=
> Function <tt>random-float</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(random-float [</tt><tt><i>random-state</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01572D27">random-fl=
oat</a></tt>
function produces a pseudo-random floating-point value in the range [0.0, 1=
.0).
</p><p>
The numbers are obtained from a WELL512a PRNG, whose state is stored in the
random state object given by the argument to the optional
<tt><i>random-state</i></tt>
parameter, which defaults to the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-0005B035">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54">9.54</a> Ti=
me</h3>



<p>



<a name=3D"N-03B6DB3D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.1">9.54.=
1</a> Functions <tt>time</tt>, <tt>time-usec</tt> and <tt>time-nsec</tt></h=
4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(time)=20




<br>&nbsp;&nbsp;(time-usec)=20




<br>&nbsp;&nbsp;(time-nsec)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
function returns the number of seconds that have elapsed since
midnight, January 1, 1970, in the UTC timezone: a point in
time called
<i>the epoch</i>.

</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-usec=
</a></tt>
function returns a cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field holds the seconds measured in the same way, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field extends the precision by giving
number of microseconds as an integer value between 0 and 999999.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-nsec=
</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-usec=
</a></tt>
except that the returned cons cell's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
field gives a number of nanoseconds as an integer value
between 0 and 999999999.
</p><p>
Note: on hosts where obtaining nanosecond precision is not available, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-nsec=
</a></tt>
function obtains a microseconds value instead, and multiplies
it by 1000.
</p><p>

</p></dd></dl>
<a name=3D"N-00F192AD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.2">9.54.2</a=
> Functions <tt>time-string-local</tt> and <tt>time-string-utc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(time-string-local </tt><tt><i>time</i></tt><tt> </tt><tt><=
i>format</i></tt><tt>)=20




<br>&nbsp;&nbsp;(time-string-utc </tt><tt><i>time</i></tt><tt> </tt><tt><i>=
format</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions take the numeric time returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
function, and convert it to a textual representation in a flexible way,
according to the contents of the
<tt><i>format</i></tt>
string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F192AD">time-stri=
ng-local</a></tt>
function converts the time to the local timezone of
the host system. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F192AD">time-stri=
ng-utc</a></tt>
function produces time in UTC.
</p><p>
The
<tt><i>format</i></tt>
argument is a string, and follows exactly the same conventions as
the format string of the C library function
<tt>strftime</tt>.
</p><p>
The
<tt><i>time</i></tt>
argument is an integer representing seconds obtained from the
time function or from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of the cons returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-usec=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-00789418">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.3">9.54.3</a=
> Functions <tt>time-fields-local</tt> and <tt>time-fields-utc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(time-fields-local </tt><tt><i>time</i></tt><tt>)=20




<br>&nbsp;&nbsp;(time-fields-utc </tt><tt><i>time</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions take the numeric time returned by the time function,
and convert it to a list of seven fields.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F192AD">time-stri=
ng-local</a></tt>
function converts the time to the local timezone of
the host system. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F192AD">time-stri=
ng-utc</a></tt>
function produces time in UTC.
</p><p>
The fields returned as a list consist of six integers, and a Boolean value.
The six integers represent the year, month, day, hour, minute and second.
The Boolean value indicates whether daylight savings time is in effect
(always
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00789418">time-fiel=
ds-utc</a></tt>).
</p><p>
The
<tt><i>time</i></tt>
argument is an integer representing seconds obtained from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
function or from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-usec=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-01F8F906">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.4">9.54.4</a=
> Structure <tt>time</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct time nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; year month day hour min sec dst=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; gmtoff zone)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure represents a time broken down into individual fields.
The structure almost directly corresponds to the
<tt>struct tm</tt>
type in the ISO C language.  There are differences.
Whereas the
<tt>struct tm</tt>
member
<tt>tm_year</tt>
represents a year since 1900, the
<tt>year</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure represents the absolute year, not relative to 1900.
Furthermore, the
<tt>month</tt>
slot represents a one-based numeric month, such that 1 represents
January, whereas the C member
<tt>tm_mon</tt>
uses a zero-based month.  The
<tt>dst</tt>
slot is a <b>TXR Lisp</b> Boolean value. The slots
<tt>hour</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023C3643">min</a></=
tt>,
and
<tt>sec</tt>
correspond directly to
<tt>tm_hour</tt>,
<tt>tm_min</tt>,
and
<tt>tm_sec</tt>.
</p><p>
The slot
<tt>gmtoff</tt>
represents the number of seconds east of UTC, and
<tt>zone</tt>
holds a string giving the abbreviated time zone name.
On platform where the C type
<tt>struct tm</tt>
has fields corresponding to these slots, values for
these slots are calculated and stored into them by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B758FD">time-stru=
ct-local</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B758FD">time-stru=
ct-utc</a></tt>
functions, and also the related
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-loca=
l</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-utc<=
/a></tt>
methods. On platform where the corresponding fields are not
present in the C language
<tt>struct tm</tt>,
these slots are unaffected by those functions,
retaining the default initial value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or a previously stored value, if applicable.
Lastly, the values of
<tt>gmtoff</tt>
and
<tt>zone</tt>
are not ignored by functions which accept a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure as a source of input values.
</p><p>

</p></dd></dl>
<a name=3D"N-00B758FD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.5">9.54.5</a=
> Functions <tt>time-struct-local</tt> and <tt>time-struct-utc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(time-struct-local </tt><tt><i>time</i></tt><tt>)=20




<br>&nbsp;&nbsp;(time-struct-utc </tt><tt><i>time</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions take the numeric time returned by the time function,
and convert it to an instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B758FD">time-stru=
ct-local</a></tt>
function converts the time to the local timezone of
the host system. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B758FD">time-stru=
ct-utc</a></tt>
function produces time in UTC.
</p><p>
The
<tt><i>time</i></tt>
argument is an integer representing seconds obtained from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
function or from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6DB3D">time-usec=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-00207C99">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.6">9.54.6</a=
> Functions <tt>time-parse</tt>, <tt>time-parse-local</tt> and <tt>time-par=
se-utc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(time-parse </tt><tt><i>format</i></tt><tt> </tt><tt><i>str=
ing</i></tt><tt>)=20




<br>&nbsp;&nbsp;(time-parse-local </tt><tt><i>format</i></tt><tt> </tt><tt>=
<i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(time-parse-utc </tt><tt><i>format</i></tt><tt> </tt><tt><i=
>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003C">time-parse</a=
></tt>
function scans a time description in
<tt><i>string</i></tt>
according to the specification given in the
<tt><i>format</i></tt>
string. If the scan is successful, a structure
of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>format</i></tt>
argument follows the same conventions as the POSIX
C library function
<tt>strptime</tt>.
</p><p>
Prior to obtaining the time from
<tt><i>format</i></tt>
and
<tt><i>string</i></tt>
the returned structure is created and initialized
with a time which represents time 0 ("the epoch")
if interpreted in the UTC timezone as by the
<tt><i>time-utc</i></tt>
method.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00207C99">time-pars=
e-local</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00207C99">time-pars=
e-utc</a></tt>
functions return an integer time value: the same value
that would be returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-loca=
l</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-utc<=
/a></tt>
methods, respectively, when applied to the structure
object returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003C">time-parse</a=
></tt>.
Thus, these equivalences hold:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
207C99">time-parse-local</a> f s)  &lt;--&gt;  (<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#D-003C">time-parse</a> f s).(<a href=3D"http://nongn=
u.org/txr/txr-manpage.html#N-001284ED">time-local</a>)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00207C99">time-parse=
-utc</a> f s)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#D-003C">time-parse</a> f s).(<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#N-001284ED">time-utc</a>)
</tt></pre><tt>

</tt>

<p>
Note: the availability of these three functions
depends on the availability of
<tt>strptime</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-001284ED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.7">9.54.7</a=
> Methods <tt>time-local</tt> and <tt>time-utc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>time-struct</i></tt><tt>.(time-local)=20




<br>&nbsp;&nbsp;</tt><tt><i>time-struct</i></tt><tt>.(time-utc)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure has two methods called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-loca=
l</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-utc<=
/a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-loca=
l</a></tt>
function considers the slots of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure instance
<tt><i>time-struct</i></tt>
to be local time, and returns its integer representation
as the number of seconds since the epoch.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001284ED">time-utc<=
/a></tt>
function is similar, except it considers
the slots of
<tt><i>time-struct</i></tt>
to be in the UTC time zone.
</p><p>
Note: these functions work by converting the slots into arguments
which are applied to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
-utc</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007B1819">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.8">9.54.8</a=
> Method <tt>time-string</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>time-struct</i></tt><tt>.(time-string </tt><tt>=
<i>format</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
structure has a method called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B1819">time-stri=
ng</a></tt>.
</p><p>
This method accepts a
<tt><i>format</i></tt>
string argument, which it uses to convert
the fields to a character string representation
which is returned.
</p><p>
The
<tt><i>format</i></tt>
argument is a string, and follows exactly the same conventions as
the format string of the C library function
<tt>strftime</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0012278E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.9">9.54.9</a=
> Method <tt>time-parse</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>time-struct</i></tt><tt>.(time-parse </tt><tt><=
i>format</i></tt><tt> </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003C">time-parse</a=
></tt>
method scans a time description in
<tt><i>string</i></tt>
according to the specification given in the
<tt><i>format</i></tt>
string.
</p><p>
If the scan is successful, the structure
is updated with the parsed information, and
the remaining unmatched portion of
<tt><i>string</i></tt>
is returned. If all of
<tt><i>string</i></tt>
is matched, then an empty string is returned.
Slots of
<tt><i>time-struct</i></tt>
which are originally
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
are replaced with zero, even if these
zero values are not actually parsed from
<tt><i>string</i></tt>.
</p><p>
If the scan is unsuccessful, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned and the structure is not
altered.
</p><p>
The
<tt><i>format</i></tt>
argument follows the same conventions as the POSIX
C library function
<tt>strptime</tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003C">time-parse</a=
></tt>
method may be unavailable if the host system does not
provide the
<tt>strptime</tt>
function. In this case, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003C">time-parse</a=
></tt>
static slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
struct is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-007C486E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.54.10">9.54.10<=
/a> Functions <tt>make-time</tt> and <tt>make-time-utc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-time </tt><tt><i>year</i></tt><tt> </tt><tt><i>month<=
/i></tt><tt> </tt><tt><i>day</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
; </tt><tt><i>hour</i></tt><tt> </tt><tt><i>minute</i></tt><tt> </tt><tt><i=
>second</i></tt><tt> </tt><tt><i>dst-advice</i></tt><tt>)=20




<br>&nbsp;&nbsp;(make-time-utc </tt><tt><i>year</i></tt><tt> </tt><tt><i>mo=
nth</i></tt><tt> </tt><tt><i>day</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>hour</i></tt><tt> </tt><tt><i>minute<=
/i></tt><tt> </tt><tt><i>second</i></tt><tt> </tt><tt><i>dst-advice</i></tt=
><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
</a></tt>
function returns a time value, similar to the one returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
function.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005D">time</a></tt>
value is constructed not from the system clock, but
from a date and time specified as arguments. The
<tt><i>year</i></tt>
argument is a calendar year, like 2014.
The
<tt><i>month</i></tt>
argument ranges from 1 to 12.
The
<tt><i>hour</i></tt>
argument is a 24-hour time, ranging from 0 to 23.
These arguments represent a local time, in the current time zone.
</p><p>
The
<tt><i>dst-advice</i></tt>
argument specifies whether the time is expressed in
daylight savings time (DST). It takes on three possible values:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the keyword
<tt>:auto</tt>,
or else the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Any other value has the same interpretation as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
If
<tt><i>dst-advice</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
then the time is assumed to be expressed in DST.
If the argument is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the time is assumed not to be in DST.
If
<tt><i>dst-advice</i></tt>
is
<tt>:auto</tt>,
then the function tries to determine whether
DST is in effect in the current time zone for the specified date and time.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
-utc</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
</a></tt>,
except that
it treats the time as UTC rather than in the local time zone.
The
<tt><i>dst-advice</i></tt>
argument is supported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
-utc</a></tt>
for function
call compatibility with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007C486E">make-time=
</a></tt>.
It may or may not have any effect
on the output (since the UTC zone by definition doesn't have daylight
savings time).
</p><p>
</p></dd></dl>
<a name=3D"N-00E76208">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55">9.55</a> Da=
ta Integrity</h3>



<p>


</p><p>

<a name=3D"N-0119CE1D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55.1">9.55.=
1</a> Function <tt>crc32-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(crc32-stream </tt><tt><i>stream</i></tt><tt> [</tt><tt><i>=
nbytes</i></tt><tt> [</tt><tt><i>crc-prev</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0119CE1D">crc32-str=
eam</a></tt>
calculates the CRC-32 sum over the bytes read from
<tt><i>stream</i></tt>,
starting at the stream's current position.
</p><p>
If the
<tt><i>nbytes</i></tt>
argument is specified, it should be a nonnegative
integer. It gives the number of bytes which should be read
and included in the sum. If the argument is omitted, then bytes are read
until the end of the stream.
</p><p>
The optional
<tt><i>crc-prev</i></tt>
argument defaults to zero. It is fully documented under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D92859">crc32</a>=
</tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0119CE1D">crc32-str=
eam</a></tt>
functions returns the calculated CRC-32 as a non-negative integer.
</p><p>

</p></dd></dl>
<a name=3D"N-01D92859">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55.2">9.55.2</a=
> Function <tt>crc32</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(crc32 </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>crc-prev</=
i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D92859">crc32</a>=
</tt>
function calculates the CRC-32 sum over
<tt><i>obj</i></tt>,
which may be a character string or a buffer.
</p><p>
If
<tt><i>obj</i></tt>
is a buffer, then the sum is calculated over all of the bytes contained
in that buffer, according to its current length.
</p><p>
If
<tt><i>obj</i></tt>
is a character string, then the sum is calculated over the bytes
which constitute its UTF-8 representation.
</p><p>
The optional
<tt><i>crc-prev</i></tt>
argument defaults to zero. If specified, it should be a nonnegative integer=
 in
the 32 bit range. This argument is useful when a single CRC-32 must be
calculated in multiple operations over several objects. The first call shou=
ld
specify a value of zero, or omit the argument. To continue the checksum,
each subsequent call to the function should pass as the
<tt><i>crc-prev</i></tt>
argument the CRC-32 obtained from the previous call.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D92859">crc32</a>=
</tt>
function returns the calculated CRC-32 as a non-negative integer.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>

<br>&nbsp;&nbsp;;;&nbsp;Single&nbsp;operation
<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D928=
59">crc32</a>&nbsp;"ABCD")&nbsp;--&gt;&nbsp;3675725989
</tt></p><p><tt>
<br>&nbsp;&nbsp;;;&nbsp;In&nbsp;two&nbsp;steps,&nbsp;demonstrating&nbsp;crc=
-prev&nbsp;argument:
<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D928=
59">crc32</a>&nbsp;"CD"&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.=
html#N-01D92859">crc32</a>&nbsp;"AB"))&nbsp;-&gt;&nbsp;3675725989
</tt>

</p><p>

</p></dd></dl>
<a name=3D"N-006C94B6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55.3">9.55.3</a=
> Functions <tt>sha256-stream</tt> and <tt>md5-stream</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sha256-stream </tt><tt><i>stream</i></tt><tt> [</tt><tt><i=
>nbytes</i></tt><tt> [</tt><tt><i>buf</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(md5-stream </tt><tt><i>stream</i></tt><tt> [</tt><tt><i>nb=
ytes</i></tt><tt> [</tt><tt><i>buf</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006C94B6">sha256-st=
ream</a></tt>
calculates the NIST SHA-256 digest over the bytes read from
<tt><i>stream</i></tt>,
starting at the stream's current position.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006C94B6">md5-strea=
m</a></tt>
function calculates the MD5 digest, using the
RSA Data Security, Inc. MD5 Message-Digest Algorithm.
</p><p>
If the
<tt><i>nbytes</i></tt>
argument is specified, it should be a nonnegative
integer. It gives the number of bytes which should be read
and included in the digest. If the argument is omitted, then bytes are read
until the end of the stream.
</p><p>
If the
<tt><i>buf</i></tt>
argument is omitted, the digest value is returned as a new,
buffer object. This buffer is 32 bytes long in the case of SHA-256,
holding a 256-bit digest, and 16 bytes long in the case of MD5,
holding a 128-bit digest.
If the
<tt><i>buf</i></tt>
argument is specified, it must be a buffer that is at least 16 bytes long
in the case of MD5, and at least 32 bytes long in the case of SHA-256.
The hash is placed into that buffer, which is then returned.
</p><p>

</p></dd></dl>
<a name=3D"N-019F97A2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55.4">9.55.4</a=
> Functions <tt>sha256</tt> and <tt>md5</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sha256 </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>buf</i></=
tt><tt>])=20




<br>&nbsp;&nbsp;(md5 </tt><tt><i>obj</i></tt><tt> [</tt><tt><i>buf</i></tt>=
<tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F97A2">sha256</a=
></tt>
function calculates the NIST SHA-256 digest over
<tt><i>obj</i></tt>,
which may be a character string or a buffer.
</p><p>
Similarly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019F97A2">md5</a></=
tt>
functions calculates the MD5 digest over
<tt><i>obj</i></tt>,
using the RSA Data Security, Inc. MD5 Message-Digest Algorithm.
</p><p>
If
<tt><i>obj</i></tt>
is a buffer, then the digest is calculated over all of the bytes contained
in that buffer, according to its current length.
</p><p>
If
<tt><i>obj</i></tt>
is a character string, then the digest is calculated over the bytes
which constitute its UTF-8 representation.
</p><p>
If the
<tt><i>buf</i></tt>
argument is omitted, the digest value is returned as a new,
buffer object. This buffer is 32 bytes long in the case of SHA-256,
holding a 256-bit digest, and 16 bytes long in the case of MD5,
holding a 128-bit digest.
If the
<tt><i>buf</i></tt>
argument is specified, it must be a buffer that is at least 16 bytes long
in the case of MD5, and at least 32 bytes long in the case of SHA-256.
The hash is placed into that buffer, which is then returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03B36E53">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55.5">9.55.5</a=
> Functions <tt>sha256-begin</tt>, <tt>sha256-hash</tt> and <tt>sha256-end<=
/tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sha256-begin)=20




<br>&nbsp;&nbsp;(sha256-hash </tt><tt><i>ctx</i></tt><tt> </tt><tt><i>obj</=
i></tt><tt>)=20




<br>&nbsp;&nbsp;(sha256-end </tt><tt><i>ctx</i></tt><tt> [</tt><tt><i>buf</=
i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The three functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-be=
gin</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-ha=
sh</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-en=
d</a></tt>
implement a stateful computation of SHA256 digest which allows multiple inp=
ut
sources to contribute to the result. Furthermore, the context object may be
serially re-used for calculating multiple digests.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-be=
gin</a></tt>
function, which takes no arguments, returns a new SHA256 digest-producing
context object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-ha=
sh</a></tt>
updates the state of the SHA256 digest object
<tt><i>ctx</i></tt>
by including
<tt><i>obj</i></tt>
into the digest calculation. The
<tt><i>obj</i></tt>
argument may be: a character or character string, whose UTF-8 representatio=
n is
digested; a buffer object, whose contents are digested; or an integer,
representing a byte value in the range 0 to 255 included in the digest.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-ha=
sh</a></tt>
function may be called multiple times to include any mixture of
strings and buffers into the digest calculation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-en=
d</a></tt>
function finalizes the digest calculation and returns the digest in
a buffer. If the
<tt><i>buf</i></tt>
argument is omitted, then a new 32-byte buffer is created for this
purpose. Otherwise,
<tt><i>buf</i></tt>
must specify a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object that is at least 32 bytes long. The digest is stored into this
buffer and that the buffer is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B36E53">sha256-en=
d</a></tt>
function additionally resets the
<tt><i>ctx</i></tt>
object into the initial state of a newly created context object, so
that it may be used for another digest session.
</p><p>

</p></dd></dl>
<a name=3D"N-025F32FD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.55.6">9.55.6</a=
> Functions <tt>md5-begin</tt>, <tt>md5-hash</tt> and <tt>md5-end</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(md5-begin)=20




<br>&nbsp;&nbsp;(md5-hash </tt><tt><i>ctx</i></tt><tt> </tt><tt><i>obj</i><=
/tt><tt>)=20




<br>&nbsp;&nbsp;(md5-end </tt><tt><i>ctx</i></tt><tt> [</tt><tt><i>buf</i><=
/tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The three functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-begin=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-hash<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-end</=
a></tt>
implement a stateful computation of MD5 digest which allows multiple input
sources to contribute to the result. Furthermore, the context object may be
serially re-used for calculating multiple digests.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-begin=
</a></tt>
function, which takes no arguments, returns a new MD5 digest-producing
context object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-hash<=
/a></tt>
updates the state of the MD5 digest object
<tt><i>ctx</i></tt>
by including
<tt><i>obj</i></tt>
into the digest calculation. The
<tt><i>obj</i></tt>
argument may be: a character or character string, whose UTF-8 representatio=
n is
digested; a buffer object, whose contents are digested; or an integer,
representing a byte value in the range 0 to 255 included in the digest.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-hash<=
/a></tt>
function may be called multiple times to include any mixture of
strings and buffers into the digest calculation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-end</=
a></tt>
function finalizes the digest calculation and returns the digest in
a buffer. If the
<tt><i>buf</i></tt>
argument is omitted, then a new 16-byte buffer is created for this
purpose. Otherwise,
<tt><i>buf</i></tt>
must specify a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object that is at least 16 bytes long. The digest is stored into this
buffer and that the buffer is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025F32FD">md5-end</=
a></tt>
function additionally resets the
<tt><i>ctx</i></tt>
object into the initial state of a newly created context object, so
that it may be used for another digest session.
</p><p>
</p></dd></dl>
<a name=3D"N-000264BC">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56">9.56</a> Th=
e Awk Utility</h3>



<p>


</p><p>
The <b>TXR Lisp</b> library provides a macro called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
which is inspired by the Unix utility Awk. The macro implements
a processing paradigm similar to that of the utility: it scans
one or more input streams, which are divided into records or fields,
under the control of user-settable regular-expression-based delimiters.
The records and fields are matched against a sequence of programmer-defined
conditions (called "patterns" in the original Awk), which have associated
actions. Like in Awk, the default action is to print the current record.
</p><p>
Unlike Awk, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro is a robust, self-contained language feature which can be used
anywhere where a <b>TXR Lisp</b> expression is called for, cleanly nests
with itself and can produce a return value when done. By contrast,
a function in the Awk language, or an action body, cannot instantiate
a local Awk processing machine.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro implements some of the most important Awk
conventions and semantics, in Lisp syntax, while eschewing others.
It does not implement the Awk convention that
variables become defined upon first mention; variables must be
defined to be used. It doesn't implement Awk's weak type system.
A character string which looks like a number isn't a number,
and an empty string or undefined variable doesn't serve as zero
in arithmetic expressions enclosed in the macro.
All expression evaluation within
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
is the usual <b>TXR Lisp</b> evaluation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro also does not provide a library of functions corresponding to
those in the Awk library, nor does it provide counterparts various
global variables in Awk such as the
<tt>ENVIRON</tt>
and
<tt>PROCINFO</tt>
arrays, or
<tt>RSTART</tt>
and
<tt>RLENGTH</tt>.
Such features of Awk are extraneous to its central paradigm.
</p><p>

<a name=3D"N-012F3A2C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.1">9.56.=
1</a> Macro <tt>awk</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(awk {(</tt><tt><i>condition</i></tt><tt> </tt><tt><i>actio=
n</i></tt><tt>*)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro processes one or more input sources, which may be streams or
files. Each input source is scanned into records, and each record
is broken into fields. For each record, the sequence of condition-action
clauses (except for certain special clauses) is processed. Every
<tt><i>condition</i></tt>
is evaluated, and if it yields true, the corresponding
<tt><i>action</i></tt>-s
are evaluated.
</p><p>
The
<tt><i>condition</i></tt>
and
<tt><i>action</i></tt>
forms are understood to be in a scope in which certain local
identifiers exist in the variable namespace as well as in the function
namespace. These are called
<i>awk functions</i>

and
<i>awk macros</i>.

</p><p>
If
<tt><i>condition</i></tt>
is one of the following keyword symbols, then it is a special clause,
with special semantics:
<tt>:name</tt>,
<tt>:let</tt>,
<tt>:inputs</tt>,
<tt>:output</tt>,
<tt>:begin</tt>,
<tt>:set</tt>,
<tt>:end</tt>,
<tt>:begin-file</tt>,
<tt>:set-file</tt>
and
<tt>:end-file</tt>.
These clause types are explained below.
In such a clause, the
<tt><i>action</i></tt>
expressions are not necessarily forms to be evaluated; the treatment
of these expressions depends on the clause.  Otherwise, if
<tt><i>condition</i></tt>
is not one of the above keyword symbols, the clause is an ordinary
condition-action clause, and
<tt><i>condition</i></tt>
is a <b>TXR Lisp</b> expression, evaluated to determine a Boolean value
which controls whether the
<tt><i>action</i></tt>
forms are evaluated. In every ordinary condition-action clause which
contains no
<tt><i>action</i></tt>
forms, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro substitutes the single action equivalent to the form
<tt>(prn)</tt>:
a call to the local awk function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>.
The behavior of this macro, when called with no arguments, as above,
is to print the current
record (contents of the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>)
followed by the output record terminator from the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A3D">ors</a></=
tt>.
</p><p>
While the processing loop in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
scans an input source, it also binds the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
to the open stream associated with that source. This binding is
in effect across all ordinary clauses, as well as across the
special clauses
<tt>:begin-file</tt>
and
<tt>:end-file</tt>.
</p><p>
The following is a description of the special clauses:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>(:name <tt><i>obj</i></tt><tt>) </tt></tt></dt><dd>



The
<tt>:name</tt>
clause establishes the name of the implicit block contained
within the expansion of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro to be the object
<tt><i>obj</i></tt>,
usually a symbol.
Forms enclosed in the macro can use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>
to abandon the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
form, specifying the same object as the argument.
<p>
If the
<tt>:name</tt>
form is omitted, the implicit block is named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>.
</p><p>
It is an error for two or more
<tt>:name</tt>
forms to appear.
</p><p>
Note: in <b>TXR</b> 255 and older, the
<tt>:name</tt>
clause must have an argument which is a symbol.
The symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is not permitted.
</p><p>



</p></dd><dt><tt>(:let {<tt><i>sym</i></tt><tt> | (</tt><tt><i>sym</i></tt>=
<tt> </tt><tt><i>init-form</i></tt><tt>)}*) </tt></tt></dt><dd>



Regardless of what order they appear in relation to
other clauses in the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro,
<tt>:let</tt>
clauses are evaluated first before the macro takes any other action. The
argument forms of this clause are variables or variable-init forms. They ar=
e
treated the same way as analogous forms in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let*</a><=
/tt>
special form. Note that these are not enclosed in an extra list
as they are in the that form. The bindings established by the
<tt>:let</tt>
clause have a scope which extends over all the other clauses in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro.
<p>
If multiple
<tt>:let</tt>
clauses are present, they are effectively consolidated into
a single clause, in the order they appear.
</p><p>
Note that the lexical variables, functions and macros established by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro
(called, respectively,
<i>awk macros</i>,

<i>awk functions</i>

and
<i>awk variables</i>)

are in an inner scope relative to
<tt>:let</tt>
bindings. For instance if
<tt>:let</tt>
creates a binding for a variable called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>,
that variable will be visible only to subsequent forms appearing
in the same
<tt>:let</tt>
clause or later
<tt>:let</tt>
clauses, and also visible in
<tt>:inputs</tt>
and
<tt>:output</tt>
clauses.
In
<tt>:begin</tt>,
<tt>:set</tt>,
<tt>:end</tt>,
and ordinary clauses, it will be shadowed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>,
which holds the field separator regular expression or string.



</p></dd><dt><tt>(:inputs <tt><i>source-form</i></tt><tt>*) </tt></tt></dt>=
<dd>



The
<tt>:inputs</tt>
clause is evaluated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro after processing the
<tt>:let</tt>
clauses. Each
<tt><i>source-form</i></tt>
is evaluated and the values of these forms are gathered into a list.
This list then comprises the list of input sources for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
processing task.
<p>
Each input source must be one of three kinds of objects.
It may be a stream object, which must be capable of character
input. It may be a list of strings, which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
will convert to an input stream as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01737CF9">make-strl=
ist-input-stream</a></tt>
function.
Or else it must be a character
string, which denotes a filesystem path name which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
will open for reading.
</p><p>
If the
<tt>:inputs</tt>
clause is omitted, then a defaulting behavior occurs for obtaining
the list of input sources. If the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
isn't the empty list, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
is taken as the input sources. Otherwise, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream is taken as the one and only input source.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
via the above defaulting behavior, it copies
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
and sets that variable to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This is done in order that if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
is used from the <b>TXR</b> command line, for example using the
<tt>-e</tt>
command line option, after
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
terminates, <b>TXR</b> will not try to open the next argument
as a script file or treat it as an option.
Note: programs which want
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
not to modify
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
can explicitly specify
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
as the argument to the
<tt>:inputs</tt>
keyword, rather than allow
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
to be used through the defaulting behavior. Only the
defaulting behavior consumes the arguments by overwriting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
It is an error to specify more than one
<tt>:inputs</tt>
clause.



</p></dd><dt><tt>(:output <tt><i>output-form</i></tt><tt>) </tt></tt></dt><=
dd>



The
<tt>:output</tt>
clause is processed just after the
<tt>:inputs</tt>
clause. It must have exactly one argument, which is an expression
that evaluates to a string, or else to an output stream.
If it evaluates to a string, then that string is used as the name
of a file to open for writing, and the resulting stream
is taken in place of that string.
<p>
The
<tt>:output</tt>
clause, if present, has the effect of creating a local binding for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
special variable.
This new value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
is visible to all forms within the macro.
If a
<tt>:let</tt>
clause is present, it establishes bindings
in a scope which is nested within the scope established
by
<tt>:output</tt>.
Therefore,
<tt><i>init-form</i></tt>-s
in the
<tt>:let</tt>
may refer to the new value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
established by
<tt>:output</tt>.
Furthermore,
<tt>:let</tt>
can rebind
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>,
causing the definition provided by
<tt>:output</tt>
to be shadowed.
</p><p>
In the case when the
<tt>:output</tt>
argument is a string such that a new stream is opened
on the file, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro will close that stream when it finishes executing.
Moreover, that stream is treated uniformly as a member of
the set of streams that are implicitly managed by the
redirection macros in the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro invocation. In brief, the implication is that if
<tt>:output</tt>
creates a stream for the file path name
<tt>"out.txt"</tt>

and somewhere in the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro, there is a redirection of the form, or equivalent to
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a>&gt; "out.t=
xt")
</tt>

then this redirection shall refer to the same stream
that was established by
<tt>:output</tt>.
Note also that in this example situation, the expression
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a>&gt; "out.t=
xt" :close)
</tt>

has the effect of closing the
<tt>:output</tt>
stream.
</p><p>



</p></dd><dt><tt>(:begin <tt><i>form</i></tt><tt>*) </tt></tt></dt><dd>



All
<tt>:begin</tt>
clauses are processed in the order in which they appear, before
input processing begins.
Each
<tt>form</tt>
is evaluated. These forms have in their scope the awk local variables
and macros.



</dd><dt><tt>(:set {<tt><i>place</i></tt><tt> </tt><tt><i>new-value</i></tt=
><tt>}*) </tt></tt></dt><dd>



The
<tt>:set</tt>
clause provides a shorthand which allows the frequently occurring pattern
<tt>(:begin (set ...))</tt>
to be condensed to
<tt>(:set ...)</tt>.



</dd><dt><tt>(:end <tt><i>form</i></tt><tt>*) </tt></tt></dt><dd>



All
<tt>:end</tt>
clauses are processed, in the order in which they appear,
when the input processing loop terminates.
This termination occurs when all records
from all input sources are either processed or skipped, or else
by an explicit termination such
as a dynamic non-local transfer, such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E500DF">return-fr=
om</a></tt>,
or the throwing of an exception.
<p>
Upon termination, the end clauses are processed in the order they appear. E=
ach
<tt>form</tt>
is evaluated, left to right.
</p><p>
In the normal termination case, the value of the last
<tt><i>form</i></tt>
of the last end clause appears as the return value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro.
</p><p>
Note that only termination of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro initiated from condition-action clauses,
<tt>:begin-file</tt>
clauses, or
<tt>:end-file</tt>
clauses triggers
<tt>:end</tt>
clause processing.
If termination of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro is initiated from within a
<tt>:let</tt>,
<tt>:inputs</tt>,
<tt>:output</tt>
or
<tt>:begin</tt>
clause, then end
clauses are not processed.
If an
<tt>:end</tt>
clause performs a non-local transfer, the remaining
<tt>:end</tt>
forms in that clause and
<tt>:end</tt>
clauses which follow are not evaluated.



</p></dd><dt><tt>(:begin-file <tt><i>form</i></tt><tt>*) </tt></tt></dt><dd=
>



All
<tt>:begin-file</tt>
clauses are processed in the order in which they appear, before
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
switches to each new input.
<p>
If both
<tt>:begin</tt>
and
<tt>:begin-file</tt>
forms are specified, then before the first input is processed,
<tt>:begin</tt>
clauses are processed first, then the
<tt>:begin-file</tt>
clauses.



</p></dd><dt><tt>(:set-file {<tt><i>place</i></tt><tt> </tt><tt><i>new-valu=
e</i></tt><tt>}*) </tt></tt></dt><dd>



The
<tt>:set-file</tt>
clause is a shorthand which translates
<tt>(:set-file ...)</tt>
to
<tt>(:begin-file (set ...))</tt>.



</dd><dt><tt>(:end-file <tt><i>form</i></tt><tt>*) </tt></tt></dt><dd>



All
<tt>:end-file</tt>
clauses are processed after the processing of an input
source finishes.
<p>
If both
<tt>:end</tt>
and
<tt>:end-file</tt>
forms are specified, then before after the last input is processed,
<tt>:end-file</tt>
clauses are processed first, then the
<tt>:end</tt>
clauses.
</p><p>
The
:end-file
clauses are processed unconditionally, no matter how
the processing of an input source terminates, whether terminated
naturally by running out of records, prematurely by invocation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00839D2F">next-file=
</a></tt>
macro, or via a dynamic non-local control transfer such as a block
return or exception throw.
</p><p>
If a
<tt>:begin-file</tt>
clause performs a non-local transfer,
<tt>:end-file</tt>
processing is not triggered, because the processing of the input
source is deemed not to have taken place.



</p></dd><dt><tt>(<tt><i>condition</i></tt><tt> </tt><tt><i>action</i></tt>=
<tt>*) </tt></tt></dt><dd>



Clauses which do not have one of the specially recognized keywords
in the first position are ordinary condition-action clauses. After
processing the
<tt>:begin</tt>
clauses, the awk enters a loop in which it extracts successive records
from the input sources according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
(record separator) variable. Each record is divided into fields according
to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
(field separator)
variable, and various
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
variables are updated. Then, the condition-action clauses are processed, in=
 the order
in which they appear. Each
<tt><i>condition</i></tt>
is evaluated. If the resulting value is a regular expression
or a function, then this regular expression or function is invoked on the v=
alue
stored in the record variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>,
and the result is taken to be the truth value of
<tt><i>condition</i></tt>.
Otherwise, if the resulting value of
<tt><i>condition</i></tt>
is other than a function or regular expression, it is taken directly
to be the truth value.
If the condition is true, then its associated
<tt><i>action</i></tt>
forms are evaluated. Either way, processing passes to the next condition
clause (unless an explicit step is taken in one of the
<tt><i>action</i></tt>-s
to prevent this, for instance by invoking the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00839D2F">next-file=
</a></tt>
macros).
When an input source runs out of records,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
switches to the next input source. When there are no more input sources,
the macro terminates.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-0003ED2C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.2">9.56.2</a=
> Variables <tt>rec</tt> and <tt>orec</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
holds the current record. It is automatically updated prior to the
processing of the condition-pattern clauses. Prior to the extraction
of the first record, its value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
It is possible to assign to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>.
The value assigned to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
must be a character string. Immediately upon the assignment, the character
string is delimited into fields according to the field separator
awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>,
and these fields are assigned to the field list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>.
At the same time, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
variable is updated to reflect the new number of fields.
Likewise, modification of these variables causes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
to be reconstructed by a catenation of the textual representation
of the fields in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
separated by copies of the output field separator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">orec</a><=
/tt>
variable ("original record") also holds the current record. It is automatic=
ally
updated prior to the processing of the condition-clauses at the same time a=
s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
with the same contents. Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>,
it is initially
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
before the first record is read. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">orec</a><=
/tt>
variable is unaffected by modification of
the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>.
It may be assigned. Doing so has no effect on any other
variable.
</p><p>

</p></dd></dl>
<a name=3D"N-003BDFA9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.3">9.56.3</a=
> Variable <tt>f</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
holds the list of fields. Prior to the first record being read,
its value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Whenever a new record is read, it is divided into fields according
to the field separator variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>,
and these fields are stored in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
as a list of character strings.
</p><p>
If the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
is assigned, the new value must be a sequence. The variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is automatically updated to reflect the length of this sequence.
Furthermore, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
variable is updated by catenating a string representation of the
elements of this sequence, separated by the contents of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>
(output field separator)
awk variable.
</p><p>
Note that assigning to a DWIM bracket form which indexes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>,
such as for instance
<tt>[f 0]</tt>
constitutes an implicit modification of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>,
and triggers the recalculation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>.
Modifications of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
list which do not involve an implicit or explicit assignment to the variabl=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
itself do not have this recalculating effect.
</p><p>
Unlike in Awk, assigning to the nonexistent field
<tt>




[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> </tt><=
tt><i>m</i></tt><tt>]=20

</tt>

where
<tt><i>m</i></tt>
&gt;=3D
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is erroneous.
</p><p>

</p></dd></dl>
<a name=3D"N-0267AE6D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.4">9.56.4</a=
> Variable <tt>nf</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
holds the current number of fields in the sequence
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>.
Prior to the first record being read, it is initially zero.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is assigned, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
is modified to reflect the new number of fields. Fields are deleted from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
if the new value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is smaller. If the new value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is larger, then fields are added. The added fields are empty strings,
which means that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
must be a sequence of a type capable of holding elements which are
strings.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is assigned, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
is also recalculated, in the same way as described in the documentation for=
 the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
variable.
</p><p>

</p></dd></dl>
<a name=3D"N-03A7AE6D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.5">9.56.5</a=
> Variable <tt>nr</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE6D">nr</a></t=
t>
holds the current absolute record number. Record numbers start at 1.
Absolute means that this value does not reset to 1 when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
switches to a new input source; it keeps incrementing for each record.
See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E33A82">fnr</a></=
tt>
variable.
</p><p>
Prior to the first record being read, the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE6D">nr</a></t=
t>
is zero.
</p><p>

</p></dd></dl>
<a name=3D"N-02E33A82">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.6">9.56.6</a=
> Variable <tt>fnr</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E33A82">fnr</a></=
tt>
holds the current record number within the file. The first record is 1.
</p><p>
Prior to the first record being read from the first input source,
the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E33A82">fnr</a></=
tt>
is zero. Thereafter, it resets to 1 for the first record of each input
source and increments for the remaining records of the same input
source.
</p><p>

</p></dd></dl>
<a name=3D"N-02133AA5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.7">9.56.7</a=
> Variable <tt>arg</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02133AA5">arg</a></=
tt>
is an integer which indicates what input source is being processed.
Prior to input processing, it holds the value zero. When the first
record is extracted from the first input source, it is set to 1.
Thereafter, it is incremented whenever
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
switches to a new input source.
</p><p>

</p></dd></dl>
<a name=3D"N-039E5F67">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.8">9.56.8</a=
> Variable <tt>fname</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039E5F67">fname</a>=
</tt>
provides access to a character string which, if the current input is
a file stream, is the name of the underlying file. Assigning to this
variable changes its value, but has no effect on the input stream.
Whenever a new input source is used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
it sets this variable either from the file name on which it is opening
a stream.. When using an existing stream rather than opening a file,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
sets this variable from the
<tt>:name</tt>
property of the stream.
</p><p>
Note that the redirection macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">&lt;-</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">&lt;!</a>=
</tt>
have no effect on this variable. Within their scope,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039E5F67">fname</a>=
</tt>
retains its value.
</p><p>

</p></dd></dl>
<a name=3D"N-0397AE68">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.9">9.56.9</a=
> Variable <tt>rs</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
specifies a string or regular expression which is used for
delimiting characters read from the inputs into pieces called records.
</p><p>
Note: the record extraction is internally implemented using record streams
instantiated by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009C0AC4">record-ad=
apter</a></tt>
function.
</p><p>
The regular expression pattern stored in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
is used to matches substrings in the input which separate or terminate reco=
rds.
Unless the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A4D">krs</a></=
tt>
variable is set true, the substrings which match
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
are discarded and the records consist of the non-matching extents between
them.
</p><p>
The initial value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
is
<tt>"\n"</tt>:
the newline character. This means that, by default, records are lines.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
is changed to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then record separation operates in
<i>paragraph mode</i>,

which is described below.
</p><p>
If a match for the record separator occurs at the end of the stream,
it is not considered to delimit an empty record, but acts as the
terminator for the previous record.
</p><p>
When a new value is assigned to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>,
it has no effect on the most recently scanned and delimited record which is
still current, or previous records. The new value applies to the next, not =
yet
read record.
</p><p>
In paragraph mode, records are separated by a newline character followed by=
 one
or more blank lines (empty lines or lines containing only a mixture of
tabs and spaces). This means that, effectively, the record-separating
sequences match the regular expression
<tt>/\n[ \n\t]*\n/</tt>.
</p><p>
There are two differences between paragraph mode and simply using the above
regular expression as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>.
The first difference is that if the first record which is read upon enterin=
g
paragraph mode is empty (because the input begins with a match for the
separator regex), then that record is thrown away, and the next record is r=
ead.
The second difference is that, if field separation based on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
variable is in effect, then regardless of the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>,
newline characters separate fields. Therefore, the programmer-defined
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
doesn't have to include a match for newline. Moreover, if it is a simple
fixed string, it need not be converted to a regular expression which also
matches a newline.
</p><p>

</p></dd></dl>
<a name=3D"N-02D33A4D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.10">9.56.10<=
/a> Variable <tt>krs</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A4D">krs</a></=
tt>
stands for "keep record separator". It is a Boolean variable, initialized t=
o
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If it is set to a true value, then the separating text matched
by the pattern in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
variable is retained as part of the preceding record rather than removed.
</p><p>
When a new value is assigned to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A4D">krs</a></=
tt>,
it has no effect on the most recently scanned and delimited record which is
still current, or previous records. The new value applies to the next, not =
yet
read record.
</p><p>

</p></dd></dl>
<a name=3D"N-03B6902C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.11">9.56.11<=
/a> Variables <tt>fs</tt> and <tt>ft</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
each specify a string or regular expression which is used for each
record that is stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
variable into fields.
</p><p>
Both variables are initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
in which case a default behavior is in effect, described below.
</p><p>
Use of these variable is mutually exclusive; it is an error for both of the=
se
variables to simultaneously have a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The value stored in either variable must be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
a character string or a regular expression. If it contains a string or
regex, it is said to contain a pattern. A string value effectively behaves
as a fixed regular expression which matches the sequence of characters
in the string verbatim, without treating any of them as regex operators.
</p><p>
The splitting of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
into fields is influenced by the Boolean
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>
("keep field separators")
variable, whose effect is discussed in its description.
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>
is false, the splitting is carried out as follows.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
contains a pattern, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
is treated specially when it is the empty string: in that case,
the pattern in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
is ignored, and no fields are produced: the field list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
is the empty list, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>
is zero.  A non-empty record is split by searching it for matches for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
pattern. If a match does not occur, then the entire record is a field.
If one match occurs, then the record is split into two fields, either of wh=
ich,
or both, might be empty. If two matches occur, the record is split into
three fields, and so on. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
finds only an empty string match in the record, then it is considered
to match each of the empty strings between two consecutive characters of th=
e
record. Consequently, the record is split into its individual characters, e=
ach
one becoming a field. Note: all of these behaviors, except for the special
treatment of the empty record, are accomplished by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>
function.
</p><p>
If the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
("field tokenize") contains a pattern, that pattern is used to positively
recognize tokens within the input record, rather than to match separating
material between them. Those matching tokens then constitute the fields.
The tokenizing is performed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
function.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
are both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
as is initially the case, then the splitting into fields is performed
as if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
variable held the regular expression
<tt>/[^\n\t ]+/</tt>.
This means that, by default, fields are sequences of consecutive characters
which are not spaces, tabs or newlines.
Newlines are excluded from fields (and thus separate them) because they can
occur in a record when the value of the record separator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0397AE68">rs</a></t=
t>
is customized.
</p><p>

</p></dd></dl>
<a name=3D"N-02D33A30">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.12">9.56.12<=
/a> Variable <tt>kfs</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>
is a Boolean flag which is initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If it is set to any other value, it indicates a request to retain
the pieces of the record which separate the fields (even when they are
empty strings).  The retained pieces appear as fields, interspersed
among the regular fields so that all of the fields appear in the order
in which they were extracted from the record.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>
is set, and tokenization-style delimiting is in effect due to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
being set, there is always at least one field, even if the record is empty.
If the record doesn't match the tokenizing regular expression in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
then a single field is generated, then the entire record is
taken as one field, denoting the non-matching space, even
if the record is the empty string.
</p><p>
If the record matches one or more tokens, then the first and
last field will always contain the non-matching material before
the first and last token, respectively. This is true even if
the material is empty. Thus
<tt>[f 0]</tt>
always has the material before the first token, whether or not
the first token is matched immediately at the first character
position in the record. This behavior follows from the semantics
of the
<tt>keep-sep</tt>
parameter of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
function.
</p><p>
Similarly, when splitting based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
is in effect and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>
is set, there is always at least one field, even if the record
is empty. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
finds no match in the record, then the entire record,
even if empty, is taken as one field. In that case, there
are no separator to retain. When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
finds one or more
matches, then these are included as fields. Separators are
always between the fields. If a separator finds a nonempty
match at the beginning of a record, that causes an empty field
to be split off: the separator is understood as intervening
between an empty string before the first character of the
record, and subsequent material which follows the text
matched by the separator. Thus the first field is an empty
field, and the second is the matched text which isincluded due to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>
being set.  An analogous situation occurs at the end of the record: if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
matches a nonempty string at the tail of the record, it splits off an empty
last field, preceded by a field holding the matched separator portion.
Empty matches are only permitted to occur between the characters
of the record, not before the first character of after the last.
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
matches the entire record, then there will be three fields:
the first and last of these three will be empty strings,
and the middle field, the separator, will be a copy of the record.
Under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>,
empty matches cause empty string to be included among the
fields. All of this follows from the semantics of the
<tt>keep-sep</tt>
parameter of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0357AE6F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.13">9.56.13<=
/a> Variable <tt>fw</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0357AE6F">fw</a></t=
t>
controls the fixed-width-based delimiting of records into fields.
</p><p>
The variable is initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
In that state, it has no effect.
When this variable holds a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value, it is expected to be a list of integers.
The use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
variables is suppressed, and fields are extracted according
to the widths indicated by the list. The fields are consecutive,
such that if the list is
<tt>(5 3)</tt>
then the first five characters of the record are identified
as field
<tt>[f 0]</tt>
and the next three characters after that as
<tt>[f 1]</tt>.
</p><p>
Only complete fields are extracted from the record. If, after
the extraction of the maximum possible complete fields, more characters
remain, those characters are assigned to an extra field.
</p><p>
An empty record produces an empty list of fields regardless
of the integers stored in fw.
</p><p>
A zero width extracts a zero length field, except when
no more characters remain in the record.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is stored into
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0357AE6F">fw</a></t=
t>
then control over field separation is relinquished to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
variables, according to their current values.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0357AE6F">fw</a></t=
t>
holds a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or else a list of non-negative integers, the behavior is unspecified.
</p><p>
</p></dd><dt>Examples</dt><dd>
<p>


</p><p>
The following table shows how various combinations of the
value the input record
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
and field widths in the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0357AE6F">fw</a></t=
t>
give rise to field values
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>:
</p><p>
<tt>
</tt></p><pre><tt>  rec    fw      f
  ---------------------------------
  "abc"  (0)     ("" "abc")
  "abc"  (2)     ("ab" "c")
  "abc"  (1 2)   ("a" "bc")
  "abc"  (1 3)   ("a" "bc")
  "abc"  (1 1)   ("a" "b" "c")
  "abc"  (3)     ("abc")
  "abc"  (4)     ("abc")
  ""     (4)     nil
  ""     (0)     nil
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02D33AA0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.14">9.56.14<=
/a> Variable <tt>ofs</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>
hold the output field separator. Its initial value is a string
consisting of a single space character.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>
function prints two or more arguments, or fields,
the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>
is used to separate them.
</p><p>
Whenever
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
is implicitly updated due to a change in the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267AE6D">nf</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>
is used to separate the fields, as they appear in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02D33A3D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.15">9.56.15<=
/a> Variable <tt>ors</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A3D">ors</a></=
tt>,
though it stands for "output record separator" holds what
is in fact the output record terminator. It is named after the
<tt>ORS</tt>
variable in Awk.
</p><p>
Each call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>
function terminates its output by emitting the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A3D">ors</a></=
tt>.
</p><p>
The initial value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A3D">ors</a></=
tt>
is a character string consisting of a single newline,
and so the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>
function prints lines.
</p><p>

</p></dd></dl>
<a name=3D"N-01E7F5F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.16">9.56.16<=
/a> Function <tt>prn</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(prn </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>
performs output into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
stream. The
<tt>:output</tt>
clause affects the destination by rebinding
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>.
</p><p>
If called with no arguments,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>
prints
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
followed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A3D">ors</a></=
tt>.
</p><p>
Otherwise, it prints the values of the arguments, separated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>,
followed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A3D">ors</a></=
tt>.
</p><p>
When a condition-action clause specifies no action forms,
then a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a></=
tt>
with no arguments is the default action.
</p><p>
Each argument
<tt><i>form</i></tt>
is printed by conversion to a string, as if by the expression
<tt>`@val`</tt>
where
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DB04DD">val</a></=
tt>
is some variable which holds the value produced by the
evaluation of
<tt><i>form</i></tt>.
Thus if the value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the output for that argument is an empty string, rather than the text
<tt>"nil"</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03820F9E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.17">9.56.17<=
/a> Macro <tt>next</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(next)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>
may be invoked in a condition-pattern clause. It terminates
the processing of that clause, and all subsequent clauses,
causing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
to process the next record, if there is one. If there is no next
record,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
terminates.
</p><p>

</p></dd></dl>
<a name=3D"N-000CD1AE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.18">9.56.18<=
/a> Macro <tt>again</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(again)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CD1AE">again</a>=
</tt>
may be invoked in a condition-pattern clause. It terminates the
processing of that clause, and all subsequent clauses.
Then, the current value of the record, namely the datum stored
in the Awk variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>,
is delimited into fields, and all of the condition-pattern clauses
are processed again.
</p><p>
No other state is modified. In particular, the record number
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE6D">nr</a></t=
t>
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">orec</a><=
/tt>
variable holding the original record both retain their current values.
</p><p>
Note: this is an original feature in the <b>TXR Lisp</b><tt><a href=3D"http=
://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro, which has no counterpart in POSIX or GNU Awk.
</p><p>

</p></dd></dl>
<a name=3D"N-00839D2F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.19">9.56.19<=
/a> Macro <tt>next-file</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(next-file)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00839D2F">next-file=
</a></tt>
may be invoked in a condition-pattern clause. It terminates
the processing of that clause, and all subsequent clauses.
Awk then abandons the current input source, and moves to the
next one.  If there is no next input source,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
terminates.
</p><p>

</p></dd></dl>
<a name=3D"N-00BEA6DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.20">9.56.20<=
/a> Macros <tt>rng</tt>, <tt>-rng</tt>, <tt>rng-</tt> <tt>-rng-</tt>, <tt>-=
-rng</tt>, <tt>--rng-</tt>, <tt>rng+</tt>, <tt>-rng+</tt> and <tt>--rng+</t=
t></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rng </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>to=
-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(-rng </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>t=
o-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rng- </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>t=
o-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(-rng- </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>=
to-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(--rng </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>=
to-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(--rng- </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i=
>to-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rng+ </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>t=
o-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(-rng+ </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i>=
to-condition</i></tt><tt>)=20




<br>&nbsp;&nbsp;(--rng+ </tt><tt><i>from-condition</i></tt><tt> </tt><tt><i=
>to-condition</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The nine awk macros in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
family may be used anywhere within an ordinary condition-pattern
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
clause.
</p><p>
Each provides a Boolean test which is true if the current record lands with=
in
a range of records delimited by conditions.  Each provides its own
distinct, useful nuance, which is identified by the mnemonic characters
prefixed or suffixed to the name.
</p><p>
The basic
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
macro inclusively matches ranges of records. Each such range begins with a =
record
for which
<tt><i>from-condition</i></tt>
yields true, and ends on the record for which
<tt><i>to-condition</i></tt>
is true. What it means to match is that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
expression yields a Boolean true value when it is evaluated in the context
of processing any of the records which are included in the range.
</p><p>
The table below summarizes the semantic variations of these nine
range macro operators. The leftmost column represents the file of records
being processed. The remaining columns indicate, using the character
<tt>X</tt>
those rows for each of the nine range operators yield true. Each operator
is assumed to be invoked with the arguments
<tt>#/H/</tt>
and
<tt>#/T/</tt>
as its
<tt><i>from-condition</i></tt>
and
<tt><i>to-condition</i></tt>,
respectively: for example,
<tt>(rng #/H/ #/T/)</tt>
in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>:
</p><p>
<tt>
</tt></p><pre><tt>  DATA    rng -rng rng- -rng- --rng --rng- rng+ -rng+ --r=
ng+
  ----------------------------------------------------------
  PROLOG
  H1      X        X                       X
  H2      X    X   X     X                 X     X
  H3      X    X   X     X                 X     X
  B1      X    X   X     X      X     X    X     X      X
  B2      X    X   X            X     X    X     X      X
  T1      X    X                X          X     X      X
  T2                                       X     X      X
  T3                                       X     X      X
  EPILOG
</tt></pre><tt>

</tt>

<p>
The prefix or suffix characters are mnemonic. A single
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
(dash) indicates the exclusion of one record. A double
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
(dash dash)
indicates the exclusion of all leading records which match
<tt><i>from-condition</i></tt>;
this appears on the left side only.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
character, appearing on the right only, indicates that
all consecutive records which match
<tt><i>to-condition</i></tt>
are included in the range, not only the first one.
</p><p>
Ranges are oblivious to the division between successive sources of input; a
range can start in one file of records and terminate in another.
To prevent a range from spanning input transitions, additional complexity
is required in the expression.
</p><p>
Ranges expressed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
family macros may combine with other expressions, including
other ranges, and allow arbitrary nesting: the
<tt><i>from-condition</i></tt>
or
<tt><i>to-condition</i></tt>
can be a range, or an expression containing ranges.
</p><p>
The expressions
<tt><i>from-condition</i></tt>
and
<tt><i>to-condition</i></tt>
are ordinary expressions which are evaluated. However, their
evaluation is unusual in two ways.
</p><p>
Firstly, if either expression
produces, as its result, a function or regular expression object,
then that function or regular expression object is applied to
the current record (value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
variable), and the result of that application is then taken
as the result of the condition. This allows for expressions like
<tt>(rng (f^ #/start/) #/end/)</tt>
which denotes a range which begins with a record which
begins with the prefix
<tt>"start"</tt>

and ends with a record which contains
<tt>"end"</tt>

as a substring.
</p><p>
Secondly, the conditions are evaluated
out of order with respect to the surrounding expression
in which they occur.  Ranges and their constituent
<tt><i>from-condition</i></tt>
and
<tt><i>to-condition</i></tt>
are evaluated just prior to the processing of the condition-action clauses.
Each
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
expression is reduced to a Boolean value.
Then, when the condition-action clauses are processed and their
<tt><i>condition</i></tt>
and
<tt><i>action</i></tt>
forms are evaluated, each occurrence of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
expression simply denotes its previously evaluated Boolean value.
</p><p>
Therefore, it is not possible for expressions to short circuit
the evaluation of ranges. Ranges cannot "miss" their starting or
terminating conditions; every range occurring anywhere in the condition-act=
ion
clauses is tested against every record that is processed.
</p><p>
Because of this perturbed evaluation order, code which happens to place sid=
e
effects into ranges may produce surprising results.
</p><p>
For instance, the expression
<tt>(if nil (rng (prinl 'hello) (prinl 'world)))</tt>
will produce output even though the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
condition is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and, moreover, this output will happen before the clauses are processed in
which this
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
expression appears. At the time when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
itself is evaluated, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
expression merely fetches a previously computed Boolean value which indicat=
es
whether the range is active for this record.
</p><p>
Also, the behavior is unspecified if range expressions attempt to modify
the awk-special variables.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">fs</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6902C">ft</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33A30">kfs</a></=
tt>.
It is not recommended to place any side effects into range expressions.
</p><p>
A more detailed description of the range operators follows.
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng<=
/a> <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) </tt></tt></dt><d=
d>



This type of range becomes active when a record is encountered for which th=
e
<tt><i>from</i></tt>
expression yields true. While the range is active, the expression evaluates
true. If, when the range is active, a record is encountered for which the
<tt><i>to</i></tt>
expression yields true, the range remains active for that record and is
deactivated after the completion of processing for that record. If
the range is inactive and a record is encountered or which both
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
are true, then the range is activated for that record and then deactivated
when that record is processed.
Records for which
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
are not true do not affect the range's activation state.



</dd><dt><tt>(-rng <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) </=
tt></tt></dt><dd>



This type of range is active under the same conditions as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
type. However, the expression yields a Boolean false value for the
first record which begins a range. That is to say, when the range is
inactive, and a record is scanned for which
<tt><i>from</i></tt>
is true, the range activates, but the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This is true regardless of whether the
<tt><i>to</i></tt>
expression yields true for that record. If there are additional records
in the range, the expression yields a true value for those records.



</dd><dt><tt>(rng- <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) </=
tt></tt></dt><dd>



This type of range is active under the same conditions as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
type. However, the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the record for which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
yields true which terminates the range. This occurs even if that is
the same record which activated the range by triggering the
<tt><i>from</i></tt>
condition.  Note that if a range terminates abruptly due to no more records
being available, the range expression still yields true for the last record=
.



</dd><dt><tt>(-rng- <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) <=
/tt></tt></dt><dd>



This type of range is active under the same conditions as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
type. However, the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the first record which activates the range, and for the last
record which deactivates the range by activating the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">to</a></t=
t>
condition. If the range is active over fewer than three records, then
the expression never yields true for that range. If the range terminates
abruptly due to no more records being available, and if the last record
processed isn't the one which activated the range due to triggering the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AED1A7">from</a><=
/tt>
condition, the expression yields true for that record.



</dd><dt><tt>(--rng <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) <=
/tt></tt></dt><dd>



This type of range is active under the same conditions as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>.
However, the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the entire leading sequence of consecutive records for which
<tt><i>from</i></tt>
is true. If
<tt><i>from</i></tt>
is true of the
<tt><i>to</i></tt>
record which terminates the range,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned for that record also.



</dd><dt><tt>(--rng- <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) =
</tt></tt></dt><dd>



This type of range is active under the same conditions as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>.
However, the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the entire leading sequence of consecutive records for which
<tt><i>from</i></tt>
is true, and also yields nil for the last record which triggers the
<tt><i>to</i></tt>
condition.



</dd><dt><tt>(rng+ <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) </=
tt></tt></dt><dd>



This range is active under different conditions compared to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>.
Though it becomes active in the same way, when the
<tt><i>from</i></tt>
expression yields true, the deactivation logic is different.
The range is deactivated when a record for which
<tt><i>to</i></tt>
is true is followed by a record for which
<tt><i>to</i></tt>
is not true. That record is excluded from the range; if the
<tt><i>from</i></tt>
expression happens to be true for that record, a new range begins
at that record. Thus, effectively, the range is terminated not
by single record which triggers
<tt><i>to</i></tt>
but by a sequence of one or more such consecutive records.



</dd><dt><tt>(-rng+ <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) <=
/tt></tt></dt><dd>



This range is active under the same conditions as <tt><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-00BEA6DF">rng+</a></tt>.
However, the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the first record in the range. If the range contains only one record, t=
hen
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for that record.



</dd><dt><tt>(--rng+ <tt><i>from</i></tt><tt> </tt><tt><i>to</i></tt><tt>) =
</tt></tt></dt><dd>



This range is active under the same conditions as <tt><a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-00BEA6DF">rng+</a></tt>.
However, the range expression yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the entire leading sequence of consecutive records for which
<tt><i>from</i></tt>
is true. This is the case even for those for which the
<tt><i>to</i></tt>
expression is true.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-006B6E54">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.21">9.56.21<=
/a> Macro <tt>ff</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ff </tt><tt><i>opip-arg</i></tt><tt> *)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006B6E54">ff</a></t=
t>
(filter fields)
provides a shorthand for filtering the field list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
trough a pipeline of chained functions expressed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>
argument syntax.
</p><p>
The following equivalence holds, except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
refers to the awk variable even if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B6E55">mf</a></t=
t>
invocation occurs in code which establishes
a binding which shadows
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
6B6E54">ff</a> a b c ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#D-002F">set</a> f [(opip a b c ...) f])
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; convert all fields from string to floating-point
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006B6E54">ff</a> (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar</a> flo-=
str))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-036B6E55">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.22">9.56.22<=
/a> Macro <tt>mf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mf </tt><tt><i>opip-arg</i></tt><tt> *)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B6E55">mf</a></t=
t>
(map fields)
provides a shorthand for mapping each field
individually trough a pipeline of chained functions expressed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01937C5A">opip</a><=
/tt>
argument syntax.
</p><p>
The following equivalence holds, except that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
refers to the awk variable even if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B6E55">mf</a></t=
t>
invocation occurs in code which establishes
a binding which shadows
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
6B6E55">mf</a> a b c ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#D-002F">set</a> f (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-0202F92F">mapcar</a> (<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#N-01937C5A">opip</a> a b c ...) f))
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; convert all fields from string to floating-point
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B6E55">mf</a> flo=
-str)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-018CCE37">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.23">9.56.23<=
/a> Macro <tt>fconv</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fconv {</tt><tt><i>clause</i></tt><tt> | : | - }*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The awk macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a>=
</tt>
provides a succinct way to request conversions of the textual fields.
Conversions are expressed by clauses which correspond with fields.
</p><p>
Each
<tt><i>clause</i></tt>
is an expression which must evaluate to a function. The clause is evaluated
in the same manner as the argument a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
operator, using Lisp-1-style name lookup. Thus, functions may be
specified simply by using their name as a
<tt><i>clause</i></tt>.
</p><p>
Furthermore, several local functions exist in the scope of each
<tt><i>clause</i></tt>,
providing a short-hand notation. These are described below.
</p><p>
Conversion proceeds by applying the function produced by
a clause to the field to which that clause corresponds, positionally.
The return value of the function applied to the field replaces
the field.
</p><p>
When a clause is specified as the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
(minus)
it has a special meaning: this minus clause occupies a field
position and corresponds to a field, but performs no conversion
on its field.
</p><p>
The
<tt>:</tt>
(colon)
symbol isn't a clause and does not correspond to a field position.
Rather, it acts as a separator among clauses. It need not appear at
all. If it appears, it may appear at most twice. Thus, the
clauses may be separated into up to three sequences.
</p><p>
If the colon does not appear, then all the clauses are
<i>prefix clauses</i>.

Prefix clauses line up with fields from left to right.  If there are fewer
fields than prefix clauses, the values of the excess clauses are evaluated,=
 but
ignored.
<i>Vice versa</i>,

if there are fewer prefix clauses than fields, then the excess
fields are not subject to conversions.
</p><p>
If the colon appears once, then the clauses before the colon, if any, are
prefix clauses, as described in the previous paragraph.  Clauses after the
colon, if any, are
<i>interior clauses</i>.

Interior clauses apply to any fields which are left unconverted by the pref=
ix
clauses. All interior clauses are evaluated.  If there are fewer fields tha=
n
interior clauses, then the values of the excess interior clauses are ignore=
d.
If there are more fields than clauses, then the clause values are cycled:
re-used from the beginning against the excess fields, enough times to conve=
rt
all the fields.
</p><p>
If the colon appears twice, then the clauses before the first colon, if any=
,are prefix clauses, the clauses between the two clause are interior clause=
s,
and those after the second colon are
<i>suffix clauses</i>.

The presence of suffix clauses change the behavior relative to the one-colo=
n
case as follows. After the conversions are performed according to the prefi=
x
clauses, the remaining fields are counted.  If there are are only as many
fields as there are suffix clauses, or fewer, then the interior clauses are
evaluated, but ignored.  The remaining fields are processed against the suf=
fix
clauses.  If after processing the prefix clauses there are more fields
remaining than suffix clauses, then a number of rightmost fields equal to t=
he
number of suffix clauses is reserved for those clauses.  The interior field=
s
are applied only to the unreserved middle fields which precede these reserv=
ed
rightmost fields, using the same repeating behavior as in the one-colon cas=
e.
Finally, the previously reserved rightmost fields are processed using
the suffix clauses.
</p><p>
The following special convenience functions are in scope of the clauses,
effectively providing a short-hand for commonly-needed conversions:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt><tt>i</tt></dt><dd>

Provides conversion to integer. It is identical to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>
function.
</dd><dt><tt>o</tt></dt><dd>

Converts a string value holding an octal representation
to the integer which it denotes. The expression
<tt>(o str)</tt>
is equivalent to
<tt>(toint str 8)</tt>.
</dd><dt><tt>x</tt></dt><dd>

Converts a string value holding a hexadecimal representation
to the integer which it denotes. The expression
<tt>(x str)</tt>
is equivalent to
<tt>(toint str 16)</tt>.
</dd><dt><tt>b</tt></dt><dd>

Converts a string value holding a binary (base two) representation
to the integer which it denotes. The expression
<tt>(b str)</tt>
is equivalent to
<tt>(toint str 2)</tt>.
</dd><dt><tt>c</tt></dt><dd>

Converts a string value holding a C-language-style representation
to the integer which it denotes, meaning that the
<tt>0x</tt>
prefix denotes a hexadecimal value, a leading zero octal, otherwise
decimal. These prefixes follow the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
sign, if present.
The expression
<tt>(c str)</tt>
is equivalent to
<tt>(toint str #\c)</tt>.
</dd><dt><tt>r</tt></dt><dd>

Converts a string holding a floating-point representation to
the floating-point value which it denotes. The expression
<tt>(r str)</tt>
is equivalent to
<tt>(tofloat str)</tt>.

</dd><dt><tt>iz</tt>, <tt>oz</tt>, <tt>xz</tt>, <tt>bz</tt>, <tt>cz</tt> an=
d <tt>rz</tt> </dt><dd>

Conversion similar to
<tt>i</tt>,
<tt>o</tt>,
<tt>x</tt>,
<tt>b</tt>,
<tt>c</tt>
and
<tt>r</tt>,
but using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E2D4B8">tointz</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E2D4B8">tofloatz<=
/a></tt>.
Thus fields which are non-numeric strings or the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
get converted to 0, or 0.0 in the case of
<tt>rz</tt>.
</dd><dt><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a=
></tt></dt><dd>

Performs no conversion: the corresponding field is taken as-is.
</dd></dl>
</dl>

Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a>=
</tt>
macro destructively operates on the elements of the field list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>,
it has the same effect as an assignment to the fields:
the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003ED2C">rec</a></=
tt>
is updated.
<p>
The return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a>=
</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>.
</p><p>
Note: because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
when no fields have been extracted, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a>=
</tt>
expression can be used as the condition in an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
clause which triggers the action if one or more fields have been
extracted, and performs conversions on them.
</p><p>
</p><p>
Note: although
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a>=
</tt>
is intended for converting textual fields, and the semantic descriptions be=
low
consequently make references to string inputs, the behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a>=
</tt>
with respect to non-string fields can be inferred. For instance if a field
actually holds the floating-point value 3.14, and the
<tt>i</tt>
conversion is applied to it, it will produce 3, because it works by
means of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DBC9D7">toint</a>=
</tt>
function which.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; convert up to first three fields to integer:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> ((fcon=
v i i i)))

  ;; convert all fields to floating-point
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> ((fcon=
v : r :)))

  ;; convert first and second fields to integer
  ;; from hexadecimal;
  ;; convert last field to integer from octal;
  ;; process pairs of fields in between
  ;; these by leaving the first element of
  ;; each pair unconverted and converting second
  ;; to floating-point;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> ((fcon=
v x x : - r : o)))

  ;; convert all fields, except the first,
  ;; from integer, turning empty strings
  ;; and non-integer junk as zero;
  ;; leave first field unconverted:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> ((fcon=
v - : iz)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02B10DF9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.24">9.56.24<=
/a> Macros <tt>-&gt;</tt>, <tt>-&gt;&gt;</tt>, <tt>&lt;-</tt>, <tt>!&gt;</t=
t> and <tt>&lt;!</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(-&gt; </tt><tt><i>path</i></tt><tt> </tt><tt><i>form</i></=
tt><tt>*)=20




<br>&nbsp;&nbsp;(-&gt;&gt; </tt><tt><i>path</i></tt><tt> </tt><tt><i>form</=
i></tt><tt>*)=20




<br>&nbsp;&nbsp;(&lt;- </tt><tt><i>path</i></tt><tt> </tt><tt><i>form</i></=
tt><tt>*)=20




<br>&nbsp;&nbsp;(!&gt; </tt><tt><i>command</i></tt><tt> </tt><tt><i>form</i=
></tt><tt>*)=20




<br>&nbsp;&nbsp;(&lt;! </tt><tt><i>command</i></tt><tt> </tt><tt><i>form</i=
></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These awk macros provide convenient redirection of output and input to and =
from
files and commands.
</p><p>
When at least one
<tt><i>form</i></tt>
argument is present, the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">-&gt;</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">-&gt;&gt;=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">!&gt;</a>=
</tt>
evaluate each
<tt><i>form</i></tt>
in a dynamic environment in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
variable is bound to a file output stream, for the first two
functions, or output command pipe in the case of the last one.
</p><p>
Similarly, when at least
<tt><i>form</i></tt>
argument is present, the remaining functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">&lt;-</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">&lt;!</a>=
</tt>
evaluate each
<tt><i>form</i></tt>
in a dynamic environment in which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
is bound to to a file input stream or input command pipe, respectively.
</p><p>
The
<tt><i>path</i></tt>
and
<tt><i>command</i></tt>
arguments are treated as forms, and evaluated.
They should evaluate to strings.
</p><p>
The first evaluation of one of these macros for a given
<tt><i>path</i></tt>
or
<tt><i>command</i></tt>
being used in a particular direction (input or output) and type (file or
command) creates a stream.  That stream is then associated with the given
<tt><i>path</i></tt>
or
<tt><i>command</i></tt>
string, together with the direction and type. Upon a subsequent evaluation
of one of these macros for the same
<tt><i>path</i></tt>
or
<tt><i>command</i></tt>
string, direction and type, a new stream is not opened; rather, the
previously associated stream is used.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">-&gt;</a>=
</tt>
macro indicates that the file named
<tt><i>path</i></tt>
is to be opened for writing and overwritten, or created if it doesn't exist=
.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">-&gt;&gt;=
</a></tt>
macro indicates that the file named by
<tt><i>path</i></tt>
is to be opened in append mode, created if necessary.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">&lt;-</a>=
</tt>
macro indicates that the file given by
<tt><i>path</i></tt>
is to be opened for reading.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">!&gt;</a>=
</tt>
macro indicates that
<tt><i>command</i></tt>
is to be opened as an output command pipe. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B10DF9">&lt;!</a>=
</tt>
macro indicates that
<tt><i>command</i></tt>
is to be opened as an input command pipe.
</p><p>
If any of these macros is invoked without any
<tt><i>form</i></tt>
arguments, then it yields the stream object associated with
<tt><i>path</i></tt>
or
<tt><i>command</i></tt>
argument, direction and type. If the association doesn't exist,
the stream is first created.
</p><p>
If
<tt><i>form</i></tt>
arguments are present, then the value of the last one is yielded
as a value, except in the case when the last form yields the
<tt>:close</tt>
keyword symbol.
</p><p>
If the last
<tt><i>form</i></tt>
yields the
<tt>:close</tt>
keyword symbol, the the association between the
<tt><i>path</i></tt>
or
<tt><i>command</i></tt>,
direction and type and the stream is removed, and the stream
is closed. In this case, the result value of the macro isn't the
<tt>:close</tt>
symbol, but rather the return value of the
<tt><i>close-stream</i></tt>
call that is implicitly applied to the stream.
</p><p>
Even if there is only one
<tt><i>form</i></tt>
which yields
<tt>:close</tt>,
the stream is created, if it doesn't exist prior to the macro
invocation.
</p><p>
In each invocation of these macros, after every
<tt><i>form</i></tt>
is evaluated, the stream is implicitly flushed, if it is an output stream.
</p><p>
The association between the
<tt><i>pipe</i></tt>
or
<tt><i>command</i></tt>
strings, direction and type is scoped to the innermost enclosing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro. An inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro cannot refer to the associations established in an outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro. An outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro can obtain an association's stream object and communicate
that stream to the nested macro where it can be used.
</p><p>
When the
<tt><i>awk</i></tt>
surrounding macro terminates, all of the streams opened by these
redirection macros are closed, without breaking those associations.
If lexical closures are captured inside the macro, and then invoked after t=
he
macro has terminated, and inside those closures the redirection macros are
used, those macro instances will with closed stream objects, and so
attempts to perform I/O will fail.
</p><p>

</p></dd></dl>
<a name=3D"N-03D16283">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.56.25">9.56.25<=
/a> Examples of <tt>awk</tt> Macro Usage</h4>



The following examples are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
macro equivalents of the examples of the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
utility given in IEEE Std 1003.1, 2013 Edition.
<p>
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
Print lines for which field 3 is greater than 5:
<p>
<tt>
</tt></p><pre><tt>  ;; print lines with fields separated by ofs,
  ;; and [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</=
a> 2] converted to integer:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> ((and =
[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 2] (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a> - - i=
z) (&gt; [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</=
a> 2] 5))))

  ;; print strictly original lines from orec
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> ((and =
[<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 2] (<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37">fconv</a> - - i=
z) (&gt; [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</=
a> 2] 5))
        (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn<=
/a> orec)))

</tt></pre><tt>

</tt>

</dd><dt>2.</dt><dd>
Print every tenth line:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> ((zerop (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
76">mod</a> nr 10))))
</tt></pre><tt>

</tt>

</dd><dt>3.</dt><dd>
Print any line with a substring matching a regex:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (#/(G|D)(2\d[\w]*)/))
</tt></pre><tt>

</tt>

Note the subtle flaw here: the
<tt>[\w]*</tt>
portion of the regular expression contributes nothing
to what lines are matched. The following example
has a similar flaw.
</dd><dt>4.</dt><dd>
Print any line with a substring beginning with a
<tt>G</tt>
or
<tt>D</tt>
followed by a sequence of digits and characters:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (#/(G|D)([\d\w]*)/))
</tt></pre><tt>

</tt>

</dd><dt>5.</dt><dd>
Print lines where the second field matches a regex,
while the fourth one doesn't:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:let (r #/xyz/))
       ((and [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9"=
>f</a> 3] [r [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9"=
>f</a> 1]] (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0050">not</=
a> [r [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> =
3]]))))
</tt></pre><tt>

</tt>

</dd><dt>6.</dt><dd>
Print lines containing a backslash in the second field:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> ((find #\\ [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-003BDFA9">f</a> 1])))
</tt></pre><tt>

</tt>

</dd><dt>7.</dt><dd>
Print lines containing a backslash using a regex constructed
from a string. Note that backslash escapes are interpreted
twice: once in the string literal, and once in the parsing
of the regex, requiring four backslashes to encode one:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:let (r (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
168C611">regex-compile</a> "\\\\")))
       ((and [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9"=
>f</a> 1] [r [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9"=
>f</a> 1]])))
</tt></pre><tt>

</tt>

</dd><dt>8.</dt><dd>
Print penultimate and ultimate field in each record,
separating then by a colon:
<p>
<tt>
</tt></p><pre><tt>  ;; original: {OFS=3D":";print $(NF-1), $NF}
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> (<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a> (<a href=3D"=
http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> ofs ":") (<a href=3D=
"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a> [<a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> -2] [<a href=3D"http:=
//nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> -1])))
</tt></pre><tt>

</tt>


Note that the above behaves
more correctly than the original Awk example because in the
when there is only one field,
<tt>$(NF-1)</tt>
reduces to
<tt>$0</tt>
which refers to the entire record, not to the field.
This sort of bug is why the <b>TXR Lisp</b><tt><a href=3D"http://nongnu.org=
/txr/txr-manpage.html#D-0025">awk</a></tt>
does not imitate the design decision to make the record
the first numbered field.
</dd><dt>9.</dt><dd>
Output the line number and number of fields separated by colon,
by producing a single string first:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a=
> `@nr:@nf`)))
</tt></pre><tt>

</tt>

</dd><dt>10.</dt><dd>
Print lines longer than 72 characters:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> ((&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A=
D172A">len</a> rec) 72)))
</tt></pre><tt>

</tt>

</dd><dt>11.</dt><dd>
Print first two fields in reverse order, separated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D33AA0">ofs</a></=
tt>:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a=
> [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 1] [=
<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 0])))
</tt></pre><tt>

</tt>

</dd><dt>12.</dt><dd>
Same as 11, but with field separation consisting of a
comma, or spaces and tabs, or both in sequence:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:set fs #/,[ \t]*|[ \t]+/)
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7">prn</a> [<a=
 href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 1] [<a hr=
ef=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a> 0])))
</tt></pre><tt>

</tt>

</dd><dt>13.</dt><dd>
Add the values in the first column, then print sum and
average:
<p>
<tt>
</tt></p><pre><tt>  ;; original:
  ;; {s +=3D $1}
  ;; END {print "sum is ", s, " average is", s/NR}
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> (:let =
(s 0) (n 0))
       ([f 0] (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018CCE37=
">fconv</a> r) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AAB=
D">inc</a> s [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9"=
>f</a> 0]) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A0AABD">i=
nc</a> n))
       (:end (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7F5F7"=
>prn</a> `sum is @s average is @(<a href=3D"http://nongnu.org/txr/txr-manpa=
ge.html#D-0007">/</a> s n)`)))
</tt></pre><tt>

</tt>

<p>
Note that the original is not robust against blank lines
in the input. Blank lines are treated as if they had a
first column field of zero, and are counted toward the
denominator in the calculation of the average.
</p></dd><dt>14.</dt><dd>
Print fields in reverse order, one per line:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">=
t</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D8471B">reverse=
</a> f))))
</tt></pre><tt>

</tt>

</dd><dt>15.</dt><dd>
Print all lines between occurrences of
<tt>start</tt>
and
<tt>stop</tt>:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> ((rng #/start/ #/stop/)))
</tt></pre><tt>

</tt>

</dd><dt>16.</dt><dd>
Print lines whose first field is different from
the corresponding field in the previous line:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:let prev)
       ((nequal [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDF=
A9">f</a> 0] prev) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E=
7F5F7">prn</a>) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">=
set</a> prev [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9"=
>f</a> 0])))
</tt></pre><tt>

</tt>

</dd><dt>17.</dt><dd>
Simulate the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">echo</a><=
/tt>
utility:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:begin (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
E7F5F7">prn</a> `@{*args* " "}`)))
</tt></pre><tt>

</tt>

<p>
Note: if this is evaluated in the command line, for instance with the
<tt>-e</tt>
option, an explicit exit is required to prevent the arguments from being
processed by
<b>TXR</b> after
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a></tt>
completes:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:begin (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
E7F5F7">prn</a> `@{*args* " "}`) (<a href=3D"http://nongnu.org/txr/txr-manp=
age.html#N-0006C92F">exit</a> 0)))
</tt></pre><tt>

</tt>

</dd><dt>18.</dt><dd>
Print the components of the
<tt>PATH</tt>
environment variable, one per line:
<p>
<tt>
</tt></p><pre><tt>  ;; Process variable as if it were a file:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> (:inpu=
ts (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F0B9B0">make-stri=
ng-input-stream</a>
                  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E=
0364">getenv</a> "PATH")))
       (:set fs ":")
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a> =
f)))

  ;; Just get, split and print; awk macro is irrelevant
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0025">awk</a> (:begi=
n (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217DE45">tprint</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str</=
a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">getenv</a=
> "PATH") ":"))))
</tt></pre><tt>

</tt>

</dd><dt>19.</dt><dd>
Given a file called
<tt>input</tt>
which contains page headers of the format
<tt>"Page #"</tt>

and a <b>TXR Lisp</b> file called
<tt>prog.tl</tt>
which contains:
<p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
25">awk</a> (:let (n (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
1DBC9D7">toint</a> n)))
       (#/Page/ (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">=
set</a> [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a=
> 1] (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E4BC37">pinc</a=
> n)))
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a>=
))
</tt></pre><tt>

</tt>

<p>
the command line:
</p><p>
<tt>
</tt></p><pre><tt>  txr -Dn=3D5 prog.tl input
</tt></pre><tt>

</tt>

<p>
prints the file, filling in page numbers starting at 5.
</p></dd></dl>
</dl>
<p>
<a name=3D"N-01AAFC45">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.57">9.57</a=
> Environment Variables and Command Line</h3>



<p>


</p><p>
Note that environment variable names, their values, and command line
arguments are all regarded as being externally encoded in UTF-8. <b>TXR</b>=
 performs
the encoding and decoding automatically.
</p><p>

<a name=3D"N-03DEE18A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.57.1">9.57.=
1</a> Special variables <tt>*args-full*</tt>, <tt>*args-eff*</tt> and <tt>*=
args*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args-ful=
l*</a></tt>
variable holds the original, complete list of arguments passed
from the operating system, including the program executable
name.
</p><p>
During command line option processing, <b>TXR</b> may transform the
argument list. The hash bang mechanism, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--args</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FCDE42">--eargs</=
a></tt>
options can inject new command line arguments, as can code
which is executed during argument processing via the
<tt>-e</tt>
options and others.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args-eff=
*</a></tt>
variable holds the list of
<i>effective arguments ,</i>

which is the argument list after these transformations are applied.
This variable is established and set to the same value as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args-ful=
l*</a></tt>
prior to command line processing, but is not updated with its final
value until after command line processing.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
variable holds a list of strings representing the remaining
arguments which follow any options processed by the <b>TXR</b> executable,
and the script name. This list is a suffix of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args-eff=
*</a></tt>.
Thus, the arguments before
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
can be calculated using the expression
<tt>(ldiff *args-eff* *args*)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
variable is available to to <b>TXR Lisp</b> expressions invoked from the
command line via the
<tt>-p</tt>,
<tt>-e</tt>
and other such options. During these evaluations,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
holds all the remaining options, after the invoking option and its
argument expression. In other words, code executed from the command line
has access to the remaining arguments which follow it.
Furthermore, this code may modify the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>.
Such a modification is visible to the option processing code.
That is to say code executed from the command line can rewrite the remainin=
g
list of arguments, and that list takes effect.
</p><p>

</p></dd></dl>
<a name=3D"N-0267F548">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.57.2">9.57.2</a=
> Function <tt>env</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(env)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
function retrieves the list of environment variables. Each
variable is represented by a single entry in the list: a string which
contains an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
(equal) character somewhere, separating the variable name
from its value.
</p><p>
Multiple calls to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
may return the same list, or lists which share structure.
</p><p>
If a list returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
is modified, the behavior is unspecified.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011814B5">env-hash<=
/a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-011814B5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.57.3">9.57.3</a=
> Function <tt>env-hash</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(env-hash)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011814B5">env-hash<=
/a></tt>
function returns an
<tt>:equal-based</tt>
hash whose keys and values are strings. The hash table is populated
with the environment variables, represented as key-value character string
pairs.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011814B5">env-hash<=
/a></tt>
function allocates the hash table when it is first invoked; thereafter,
it returns the same hash table.
</p><p>
The hash table is updated by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">getenv</a=
></tt>.
</p><p>
Note: calls to the underlying C library functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">getenv</a=
></tt>,
and other direct manipulations of the environment, will not update the hash=
 table.
</p><p>

</p></dd></dl>
<a name=3D"N-002E0364">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.57.4">9.57.4</a=
> Functions <tt>getenv</tt>, <tt>setenv</tt> and <tt>unsetenv</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getenv </tt><tt><i>name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(setenv </tt><tt><i>name</i></tt><tt> </tt><tt><i>value</i>=
</tt><tt> [</tt><tt><i>overwrite-p</i></tt><tt>])=20




<br>&nbsp;&nbsp;(unsetenv </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions provide access to, as well as manipulation of, environment
variables. Of these three,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>
might not be available on some platforms, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>
might be be present in a simulated form which sets the variable
<tt><i>name</i></tt>
to the empty string rather than deleting it.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">getenv</a=
></tt>
function searches the environment for the environment variable whose name
is
<tt><i>name</i></tt>.
If the variable is found, its value is returned. Otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
function creates or modifies the environment variable indicated by
<tt><i>name</i></tt>.
The
<tt><i>value</i></tt>
string argument specifies the new value for the variable.
If
<tt><i>value</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>,
except that it observes the
<tt><i>overwrite-p</i></tt>
argument. That is to say, the meaning of a null
<tt><i>value</i></tt>
is that the variable is to be removed.
</p><p>
If the
<tt><i>overwrite-p</i></tt>
argument is specified, and is true,
then the variable is overwritten if it already exists.
If the argument is false, then the variable is not modified if it
already exists.  If the argument is not specified, it defaults
to the value
<tt><i>t</i></tt>,
effectively giving rise to a two-argument form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
which creates or overwrites environment variables.
</p><p>
A variable removal is deemed to be an overwrite.
Thus if both
<tt><i>value</i></tt>
and
<tt><i>overwrite-p</i></tt>
are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
does nothing.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
function unconditionally returns
<tt><i>value</i></tt>
regardless of whether or not it overwrites or removes an existing variable.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>
function removes the environment variable
specified by
<tt><i>name</i></tt>,
if it exists. On some platforms, it instead sets the environment variable
to the empty string.
</p><p>
Note: supporting removal semantics in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
allows for the following simple save/modify/restore pattern:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let*</a> ((old-val (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-002E0364">getenv</a> "SOME-VAR")))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-p=
rotect</a>
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn<=
/a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</=
a> "SOME-VAR" new-val)
             ...)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv=
</a> "SOME-VAR" old-val)))
</tt></pre><tt>

</tt>

<p>
This works in the case when
<tt>SOME-VAR</tt>
exists, as well as in the case that it doesn't exist.
In both cases, its previous value or, respectively, non-existence,
is restored by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03162B0C">unwind-pr=
otect</a></tt>
cleanup form.
</p><p>
These functions interact with the list returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
function and with the hash table returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011814B5">env-hash<=
/a></tt>
function as follows.
</p><p>
A previously returned list returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
is not modified. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>
functions may cause a subsequent call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0267F548">env</a></=
tt>
to return a different list. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">getenv</a=
></tt>
function has no effect on the list.
</p><p>
The hash table previously returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011814B5">env-hash<=
/a></tt>
is modified by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
in the manner consistent with its semantics. A new entry is created in the =
table,
if required, and an existing entry is overwritten only if the
<tt>overwrite-p</tt>
flag is specified. Likewise, if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">setenv</a=
></tt>
is invoked in a way that causes the environment variable to be deleted, it
is removed from the hash also.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">unsetenv<=
/a></tt>
function causes the variable to be removed from the hash table also.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002E0364">getenv</a=
></tt>
function accesses the underlying environment, and updates the hash
table with the name-value pair which is retrieved.
</p><p>
</p></dd></dl>
<a name=3D"N-02C70C38">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58">9.58</a> Co=
mmand Line Option Processing</h3>



<p>


</p><p>
<b>TXR Lisp</b> provides a support for recognizing, extracting and validati=
ng
the POSIX-style options from a list of command-line arguments.
</p><p>
The supported options can be defined as a list of option descriptor
objects each of which is constructed by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">opt</a></=
tt>
function. Each option can have a long name, a short name,
a type, and a description.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
function takes a list of option descriptors, and a list of arguments,
producing a parse, or else throwing an exception of type
<tt>opt-error</tt>
if an error is detected. The returned object, an instance of struct type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>,
can then be queried for specific option values, or for the remaining non-op=
tion
arguments.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthelp</=
a></tt>
function takes a list of option descriptors and an output stream,
and generates help text on that stream. A program supporting a
<tt>--help</tt>
option can use this to generate that portion of its help text which
describes the available options, as well as the conventions that they use.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0126C738">define-op=
tion-struct</a></tt>
macro provides a more streamlined, declarative mechanism built on the
same facility. The options are declared in a more condensed way, and
using symbols instead of strings. Furthermore, the parsed option values
become slot values of an object, named by the same symbols.
</p><p>
<a name=3D"N-02968E5D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.1">9.58.=
1</a> Command Line Option Conventions</h4>


<p>
A command line option can have a short or long name. A short name is always
one-character long, and treated specially in the command line syntax.  Long
options have names two or more characters long.  An option can have both a =
long
and short name. Options may not begin with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
(ASCII dash) character. A long option may not contain the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
character.
</p><p>
Short options are invoked by specifying an argument with a single leading
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
followed by the option character.  Multiple short options which take
no argument can be "clumped": combined into a single argument consisting of
a single
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
followed by multiple short option characters.
</p><p>
An option can take an argument, in which case the argument is required.
An option which takes no argument is Boolean, and a Boolean option
never takes an argument: "takes no argument" and "Boolean" effectively
mean the same thing.
</p><p>
Long options are invoked as an argument which begins with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
(double dash)
immediately followed by the name. When a long option takes an argument,
it is mandatory. It must be specified in the same argument, separated
from the name by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
character. If that is omitted, then the next command line argument
is taken as the argument. That argument is removed, and not recognized as
an option, even if it looks like one.
</p><p>
A Boolean long option can be explicitly specified as false using the
<tt>--no-</tt>
prefix rather than the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
prefix.
</p><p>
Short options may be invoked using long name syntax; if
<tt>a</tt>
is a short option, then it may be referenced on the command line as
<tt>--a</tt>
and treated as a long option in all other ways, including the use
of
<tt>--no-</tt>
to explicitly specify false for a Boolean option.
</p><p>
If a short option takes an argument, it may not clump with other
short option. The following command line argument is taken as the
options argument. That argument is removed and is not recognized as
an option even if it looks like one.
</p><p>
If the command line argument
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0234C408">--</a></t=
t>
occurs in the command line where an option would otherwise be recognized,
it signifies the end of the options. The subsequent arguments are the
non-option arguments, even if they resemble options.
</p><p>
<a name=3D"N-0361E497">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.2">9.58.=
2</a> Command Line Processing Examples</h4>


<p>
The following example illustrates a complete <b>TXR Lisp</b> program which
parses command line options:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F36A75">defvarl</a> options
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a>=
 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">opt</a> "v"=
 "verbose" :dec
               "Verbosity level. Higher values produce more chatter.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> nil "help" :bool
               "List this help text.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> "x" nil :hex
               "The X factor: a number with a mysterious\ \
                interpretation, affecting the program\ \
                behavior in strange ways.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> "z" nil) ;; undocumented option
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> nil "cee" :cint
               "C style integer.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> "g" "gravity" :float
               "Gravitational constant. This gives\ \
                the gravitational field\ \
                strength at the Earth's surface.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> "l" "lit" :str
               "A character string given in TXR Lisp notation.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> "c" nil 'upcase-str
               "Custom treatment: ARG is converted to upper case.")
          (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">op=
t</a> "b" "bool" :bool
               "A flag you can flip true.")))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> prog-name *load-path*)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
o (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</a=
> options *args*)))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</a>=
 [o "help"]
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-li=
ne</a> "Usage:\n")
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-li=
ne</a> `  @{prog-name} [options] arg*`)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthel=
p</a> options)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C92F">exit</=
a> 0))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line=
</a> `args after opts are: @{o.out-args ", "}`))
</tt></pre><tt>

</tt>

<p>
The next example is equivalent to the previous, but using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0126C738">define-op=
tion-struct</a></tt>
macro:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
26C738">define-option-struct</a> prog-opts nil
    (v   verbose :dec
                 "Verbosity level. Higher values produce more chatter.")
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a> =
help    :bool
                 "List this help text.")
    (x   nil     :hex
                 "The X factor: a number with a mysterious\ \
                  interpretation, affecting the program\ \
                  behavior in strange ways.")
    ;; undocumented Boolean:
    (z   nil)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a> =
cee     :cint
                 "C style integer.")
    (g   gravity :float
                 "Gravitational constant. This gives\ \
                  the gravitational field\ \
                  strength at the Earth's surface.")
    (l   lit     :str
                 "A character string given in TXR Lisp notation.")
    (c   nil     upcase-str
                 "Custom treatment: ARG is converted to upper case.")
    (b   bool    :bool
         "A flag you can flip true."))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> prog-name *load-path*)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AF20B">let</a> ((=
o (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> pr=
og-opts)))
    o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopt=
s</a> *args*)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EFAB6">when</a>=
 o.help
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-li=
ne</a> "Usage:\n")
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-li=
ne</a> `  @{prog-name} [options] arg*`)
      o.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opth=
elp</a>)
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C92F">exit</=
a> -1))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line=
</a> `args after opts are: @{o.out-args ", "}`))
</tt></pre><tt>

</tt>

<p>

<a name=3D"N-03FC5092">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.3">9.58.=
3</a> Structure <tt>opt-desc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct opt-desc=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; short long helptext type=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; ... </tt><tt><i>unspecified</i></tt><tt> </tt>=
<tt><i>slots</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>
structure describes a single command line option.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">short</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">long</a><=
/tt>
slots are either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or else hold strings.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">short</a>=
</tt>
slot gives the option's short name: a one-character-long
string which may not be the ASCII dash character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">long</a><=
/tt>
slot gives the option's long name: a string two or more
characters long which doesn't begin with a dash.
An option must have at least one of these names.
</p><p>
The
<tt>helptext</tt>
slot provides a descriptive string. This string may be long. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthelp</=
a></tt>
function displays this text, formatting into multiple lines as necessary.
If
<tt>helptext</tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the option is considered undocumented.
</p><p>
The
<tt>type</tt>
slot may be a symbol naming a global function which takes one argument,
or it may be such a function object. Otherwise it must be one of the
following keyword symbols:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt><tt>:bool</tt></dt><dd>

This indicates that the type of the option is Boolean. Such
an option doesn't take any argument. Its value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</dd><dt><tt>:dec</tt></dt><dd>

This indicates that the option requires an argument, which is a
decimal integer with an optional positive or negative sign.
This argument is converted to an integer object.
</dd><dt><tt>:hex</tt></dt><dd>

This type indicates that the option requires an argument consisting
of a hexadecimal integer with an optional positive or negative sign.
This is converted to an integer object.
</dd><dt><tt>:oct</tt></dt><dd>

This type indicates that the option requires an argument consisting
of a octal integer with an optional positive or negative sign.
This is converted to an integer object.
</dd><dt><tt>:cint</tt></dt><dd>

This type indicates that the option requires an integer argument
whose format conforms to one of three C language conventions in most respec=
ts,
other than that this integer may have an arbitrary range.
All forms may carry an optional positive or negative leading sign
at the very beginning.
The first convention consists of decimal digits, which must not have
a superfluous leading zero. The second convention consists of octal
digits which are introduced by an extra leading zero.The third convention c=
onsists of hexadecimal digits introduced by the
<tt>0x</tt>
prefix.
</dd><dt><tt>:float</tt></dt><dd>

This type indicates a decimal floating-point argument, which is converted t=
o
a floating-point number. Its basic form is: an optional leading plus or
minus sign, followed by a sequence of one or more digits which may contain
a single decimal point anywhere, including the very beginning of the
sequence or at the end, optionally followed by the letter
<tt>e</tt>
or
<tt>E</tt>
followed by a decimal integer which may have a leading positive or negative
sign, and include leading zeros.
</dd><dt><tt>:text</tt></dt><dd>

This type indicates a simple textual argument. The argument is taken as
verbatim UTF-8 text, converted to a string without interpreting
the characters in any special way.
</dd><dt><tt>:str</tt></dt><dd>

This type indicates that the argument consists of the interior notation of
a TXR Lisp character string. It is processed by adding a double quote
at the beginning or end, and parsed as a string literal. This parsing must
successfully yield a string object, otherwise the argument is ill-formed.



</dd><dt><tt>(list <tt><i>type</i></tt><tt>) </tt></tt></dt><dd>



If the type is specified as a compound form headed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
symbol, it indicates that the command line option's argument is a list
of elements.  The argument appears on the command line as a single string
contained within one argument.  It may contain commas, and is split into pi=
eces
using the comma character as a separator. The pieces are then individually
treated as of type
<tt><i>type</i></tt>
and converted accordingly. The option's argument is then a list object
whose elements are the converted pieces. For instance
<tt>(list :dec)</tt>
will convert a list of comma-separated decimal integer tokens into
a list of integer objects. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
option type does not nest.



</dd><dt><tt>(cumul <tt><i>type</i></tt><tt>) </tt></tt></dt><dd>



If the type is specified as a compound form headed by the
<tt>cumul</tt>
symbol, it indicates that if the option is specified multiple times,
the values coming from the multiple occurrences are accumulated into a list=
.
The
<tt><i>type</i></tt>
argument may be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
type, exemplified by
<tt>(cumul (list :dec))</tt>
or a basic type, such as
<tt>(cumul :str)</tt>.
However, this type specifier does not nest. Combinations such as
<tt>(cumul (cumul ...)</tt>
and
<tt>(list (cumul ...))</tt>
are invalid.
The option values are accumulated in reverse order, so that the rightmost
repetition becomes the first item in the list. For instance, if the
<tt>-x</tt>
option has type
<tt>(cumul :dec)</tt>,
and the arguments presented for parsing are
<tt>("-x" "1" "-x" "2")</tt>,
then the option's value will be
<tt>(2 1)</tt>.
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>-typed
option is cumulative, then the option value will be a list of lists.
Each repetition of the option produces a list, and the lists are accumulate=
d.
<p>
</p></dd></dl>
</dl>
<p>

If
<tt>type</tt>
is a function, then the option requires an argument. The argument string
is passed to the function, and the value is whatever the function returns.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>
structure may have additional slots which are not specified.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">opt</a></=
tt>
convenience function is provided for constructing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>
objects.
</p><p>

</p></dd></dl>
<a name=3D"N-0047F5AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.4">9.58.4</a=
> Function <tt>opt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(opt </tt><tt><i>short</i></tt><tt> </tt><tt><i>long</i></t=
t><tt> [</tt><tt><i>type</i></tt><tt> [</tt><tt><i>helptext</i></tt><tt>]])=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">opt</a></=
tt>
function provides a slightly condensed syntax for constructing
an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>.
</p><p>
The required arguments
<tt><i>short</i></tt>
and
<tt><i>long</i></tt>
are strings, corresponding to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>
slots of the same name.
</p><p>
The optional parameter
<tt><i>type</i></tt>
corresponds to the same-named slot and defaults to
<tt>:bool</tt>.
</p><p>
The optional parameter
<tt><i>helptext</i></tt>
corresponds to the same-named slot, and defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
(no help text provided for the option).
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5AB">opt</a></=
tt>
function follows this equivalence:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
47F5AB">opt</a> a b c d)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr=
-manpage.html#N-0230059D">new</a> opt-desc short a long b
                                     type c helptext d)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01D911E8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.5">9.58.5</a=
> Structure <tt>opts</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct opts nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; in-args out-args=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; ... </tt><tt><i>unspecified</i></tt><tt> </tt>=
<tt><i>slots</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
structure represents a parsed command line, containing decoded
information obtained from the options, and an indication where
the non-option arguments start.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
structure supports direct indexing for option retrieval.
That is the only documented interface for accessing the parsed
options; the implementation of the information set describing
the parsed options is unspecified.
</p><p>
The
<tt>in-args</tt>
slot holds the original argument list.
</p><p>
The
<tt>out-args</tt>
slot holds the tail of the argument list consisting of the non-option
arguments.
</p><p>
The mechanism by means of which
<tt>out-args</tt>
is calculated, and by means of which the information about the
options is populated, is unspecified. The only interface to that
mechanism is the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
object supports indexing, including indexed assignment.
</p><p>
If
<tt>o</tt>
is an instance of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>,
then the expression
<tt>[o "v"]</tt>
tests whether the option
<tt>"v"</tt>

is available in
<tt>o</tt>;
that is, whether it has been specified in the command line.
If so, then its associated value is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. This
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is ambiguous: for a Boolean option it indicates that either
the option was not specified, or that it was explicitly
specified as false. For a Boolean option that was specified
(positively), the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.
</p><p>
The expression
<tt>[o "v" dfl]</tt>
yields the value of option
<tt>"v"</tt>

if that option has been specified. If the option hasn't
been specified, then the expression yields the value
<tt>dfl</tt>.
</p><p>
Assigning to
<tt>[o "v"]</tt>
is possible. This replaces the value associated with option
<tt>"v"</tt>.
The assignment is erroneous if no such option was parsed
from the command line, even if it is a valid option.
</p><p>
If an option is defined with both a long form and a short form,
and either form of that option occurs in the command line being
processed, then the option appears under both names in the index.
</p><p>
For instance if option
<tt>"--verbose"</tt>

has the short form
<tt>"-v"</tt>,
and either option occurs, then both the keys
<tt>"v"</tt>

and
<tt>"verbose"</tt>

will exist in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
structure returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>.
Note that this behavior is different from that of the structure produced
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0126C738">define-op=
tion-struct</a></tt>
macro. Under that approach, if an option is defined with a long and short n=
ame,
the structure will have only a single slot for that option, named after the
long name.
</p><p>

</p></dd></dl>
<a name=3D"N-01A5A2FF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.6">9.58.6</a=
> Function <tt>getopts</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getopts </tt><tt><i>option-desc-list</i></tt><tt> </tt><tt=
><i>arg-list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
function takes a list of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>
structures and a list of strings
<tt><i>arg-list</i></tt>
representing command line arguments.
</p><p>
The
<tt><i>arg-list</i></tt>
is parsed. If the parse is unsuccessful, an exception of type
<tt>opt-error</tt>
is thrown, derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>.
</p><p>
If there are problems in
<tt>option-desc-list</tt>
itself, then an exception of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
is thrown.
</p><p>
If the parse is successful,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
returns an instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
structure describing the parsed opts, and listing the non-option
arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-016C6171">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.7">9.58.7</a=
> Function <tt>opthelp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(opthelp </tt><tt><i>opt-desc-list</i></tt><tt> [</tt><tt><=
i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthelp</=
a></tt>
function processes the list of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FC5092">opt-desc<=
/a></tt>
structures
<tt><i>opt-desc-list</i></tt>
and compiles a customized body of help text describing all of the
options, as well as general description of the command line option
conventions to guide the user in in the correct use of command
line options.
</p><p>
The text is formatted to fit within 79 columns, and begins and ends with a
blank line. Its format consists of headings which begin in the first column=
,
and paragraphs and tables which feature a two space left margin.
A blank line follows each section heading. The heading begins with a capita=
l
letter. Its remaining words are uncapitalized, and it ends with a colon.
</p><p>
The text is sent to
<tt><i>stream</i></tt>,
if specified. This argument defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>.
</p><p>
If there are problems in
<tt>option-desc-list</tt>
itself, then an exception of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
is thrown.
</p><p>

</p></dd></dl>
<a name=3D"N-0126C738">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.58.8">9.58.8</a=
> Macro <tt>define-option-struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(define-option-struct </tt><tt><i>name</i></tt><tt> </tt><t=
t><i>super</i></tt><tt> </tt><tt><i>opt-specifier</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0126C738">define-op=
tion-struct</a></tt>
macro defines a struct type, instances of which provide command line option
parsing.
</p><p>
The
<tt><i>name</i></tt>
and
<tt><i>super</i></tt>
parameters are subject to the same requirements and have the same
semantics as the same-named parameters of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>.
</p><p>
The
<tt><i>opt-specifier</i></tt>
arguments are lists of between two and four elements:
<tt>




(</tt><tt><i>short-symbol</i></tt><tt> </tt><tt><i>long-symbol</i></tt><tt>=
 [</tt><tt><i>type</i></tt><tt> [</tt><tt><i>help-text</i></tt><tt>]]).=20

</tt>

The
<tt><i>short-symbol</i></tt>
and
<tt><i>long-symbol</i></tt>
must be symbols suitable for use as slot names. One of them may be
specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
indicating that the option has no long form, or no short form.
</p><p>
If a
<tt><i>opt-specifier</i></tt>
specifies both a
<tt><i>short-symbol</i></tt>
and a
<tt><i>long-symbol</i></tt>
then only a slot named by
<tt><i>long-symbol</i></tt>
shall exist in the structure.
</p><p>
The struct type defined by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0126C738">define-op=
tion-struct</a></tt>
has two methods:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthelp</=
a></tt>.
It also has two slots:
<tt>in-args</tt>
and
<tt>out-args</tt>,
which function in a manner identical to their same-named
counterparts in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D911E8">opts</a><=
/tt>
class.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
method takes a single argument: the argument list to be processed.
When the argument list is successfully processed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthelp</=
a></tt>
method takes an optional stream argument.
</p><p>
Note: to encode the option names
<tt>"t"</tt>

or
<tt>"nil"</tt>,
or option names which clash with the slot names
<tt>in-args</tt>
and
<tt>out-args</tt>
or the methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A5A2FF">getopts</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016C6171">opthelp</=
a></tt>,
symbols with these names from a package other than
<tt>usr</tt>
must be used.
</p><p>
</p></dd></dl>
<a name=3D"N-00136952">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59">9.59</a> Sy=
stem Programming</h3>



<p>



<a name=3D"N-03A7137C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.1">9.59.=
1</a> Accessor <tt>errno</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(errno [</tt><tt><i>new-errno</i></tt><tt>])=20




<br>&nbsp;&nbsp;(set (errno) </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
function retrieves the current value of the C library error variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>.
If the argument
<tt><i>new-errno</i></tt>
is present and is not
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then it
specifies a value which is stored into
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>.
The value returned is the prior value.
</p><p>
The place form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
does not take an argument.
</p><p>

</p></dd></dl>
<a name=3D"N-02A1DB65">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.2">9.59.2</a=
> Function <tt>strerror</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(strerror </tt><tt><i>errno-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A1DB65">strerror<=
/a></tt>
returns a character string which provides the host platform's description
of the integer
<tt><i>errno-value</i></tt>
obtained from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
function.
</p><p>
If the host platform fails to provide a description, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0006C92F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.3">9.59.3</a=
> Function <tt>exit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exit [</tt><tt><i>status</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C92F">exit</a><=
/tt>
function terminates the entire process (running <b>TXR</b> image), specifyi=
ng
the termination status to the operating system. Values of the optional
<tt><i>status</i></tt>
parameter may be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
or an integer value.  The value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
indicates an unsuccessful termination status, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
indicates a successful termination status.
An absence of the
<tt><i>status</i></tt>
argument also specifies a successful termination status.
If
<tt><i>status</i></tt>
is an integer value, it specifies a successful termination if it is
<tt>0</tt>
otherwise the interpretation of the value is platform specific.
</p><p>

</p></dd></dl>
<a name=3D"N-036B1BDB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.4">9.59.4</a=
> Variables <tt>e2big</tt>, <tt>eacces</tt>, <tt>eaddrinuse</tt>, <tt>eaddr=
notavail</tt>, <tt>eafnosupport</tt>, <tt>eagain</tt>, <tt>ealready</tt>, <=
tt>ebadf</tt>, <tt>ebadmsg</tt>, <tt>ebusy</tt>, <tt>ecanceled</tt>, <tt>ec=
hild</tt>, <tt>econnaborted</tt>, <tt>econnrefused</tt>, <tt>econnreset</tt=
>, <tt>edeadlk</tt>, <tt>edestaddrreq</tt>, <tt>edom</tt>, <tt>edquot</tt>,=
 <tt>eexist</tt>, <tt>efault</tt>, <tt>efbig</tt>, <tt>ehostunreach</tt>, <=
tt>eidrm</tt>, <tt>eilseq</tt>, <tt>einprogress</tt>, <tt>eintr</tt>, <tt>e=
inval</tt>, <tt>eio</tt>, <tt>eisconn</tt>, <tt>eisdir</tt>, <tt>eloop</tt>=
, <tt>emfile</tt>, <tt>emlink</tt>, <tt>emsgsize</tt>, <tt>emultihop</tt>, =
<tt>enametoolong</tt>, <tt>enetdown</tt>, <tt>enetreset</tt>, <tt>enetunrea=
ch</tt>, <tt>enfile</tt>, <tt>enobufs</tt>, <tt>enodata</tt>, <tt>enodev</t=
t>, <tt>enoent</tt>, <tt>enoexec</tt>, <tt>enolck</tt>, <tt>enolink</tt>, <=
tt>enomem</tt>, <tt>enomsg</tt>, <tt>enoprotoopt</tt>, <tt>enospc</tt>, <tt=
>enosr</tt>, <tt>enostr</tt>, <tt>enosys</tt>, <tt>enotconn</tt>, <tt>enotd=
ir</tt>, <tt>enotempty</tt>, <tt>enotrecoverable</tt>, <tt>enotsock</tt>, <=
tt>enotsup</tt>, <tt>enotty</tt>, <tt>enxio</tt>, <tt>eopnotsupp</tt>, <tt>=
eoverflow</tt>, <tt>eownerdead</tt>, <tt>eperm</tt>, <tt>epipe</tt>, <tt>ep=
roto</tt>, <tt>eprotonosupport</tt>, <tt>eprototype</tt>, <tt>erange</tt>, =
<tt>erofs</tt>, <tt>espipe</tt>, <tt>esrch</tt>, <tt>estale</tt>, <tt>etime=
</tt>, <tt>etimedout</tt>, <tt>etxtbsy</tt>, <tt>ewouldblock</tt> and <tt>e=
xdev</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the POSIX
"<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a=
></tt>
constants", namely
<tt>E2BIG</tt>,
<tt>EACCES</tt>,
<tt>EADDRINUSE</tt>
and so forth.
Variables corresponding to all of the
<tt>&lt;errno.h&gt;</tt>
constants from the Issue 6 2004 edition of POSIX are included.
The variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B1BDB">eownerdea=
d</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B1BDB">enotrecov=
erable</a></tt>
from Issue 7 2018 are subject to the availability of the corresponding cons=
tants
in the host platform.
</p><p>

</p></dd></dl>
<a name=3D"N-02F934F6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.5">9.59.5</a=
> Function <tt>abort</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(abort)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F934F6">abort</a>=
</tt>
function terminates the entire process (running <b>TXR</b> image), specifyi=
ng
an abnormal termination status to the process.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F934F6">abort</a>=
</tt>
calls the C library function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F934F6">abort</a>=
</tt>
which works by raising the
<tt>SIG_ABRT</tt>
signal, known in <b>TXR</b> as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-abrt<=
/a></tt>
variable. Abnormal termination of the process is this signal's
default action.
</p><p>

</p></dd></dl>
<a name=3D"N-003EEEF5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.6">9.59.6</a=
> Functions <tt>at-exit-call</tt> and <tt>at-exit-do-not-call</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(at-exit-call </tt><tt><i>function</i></tt><tt>)=20




<br>&nbsp;&nbsp;(at-exit-do-not-call </tt><tt><i>function</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003EEEF5">at-exit-c=
all</a></tt>
function registers
<tt><i>function</i></tt>
to be called when the process terminates normally.
Multiple functions can be registered, and the same function
can be registered more than once. The registered
functions are called in reverse order of their
registrations.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003EEEF5">at-exit-d=
o-not-call</a></tt>
function removes all previous
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003EEEF5">at-exit-c=
all</a></tt>
registrations of
<tt><i>function</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003EEEF5">at-exit-c=
all</a></tt>
function returns
<tt><i>function</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003EEEF5">at-exit-d=
o-not-call</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it removed anything,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if no registrations of
<tt><i>function</i></tt>
were found.
</p><p>

</p></dd></dl>
<a name=3D"N-00D79773">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.7">9.59.7</a=
> Function <tt>usleep</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(usleep </tt><tt><i>usec</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D79773">usleep</a=
></tt>
function suspends the execution of the program for at least
<tt><i>usec</i></tt>
microseconds.
</p><p>
The return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the sleep was successfully executed. A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
value indicates premature wakeup or complete failure.
</p><p>
Note: the actual sleep resolution is not guaranteed, and depends on granula=
rity
of the system timer.  Actual sleep times may be rounded up to the nearest 1=
0
millisecond multiple on a system where timed suspensions are triggered by a=
 100
Hz tick.
</p><p>

</p></dd></dl>
<a name=3D"N-00C543B8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.8">9.59.8</a=
> Functions <tt>mkdir</tt> and <tt>ensure-dir</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mkdir </tt><tt><i>path</i></tt><tt> [</tt><tt><i>mode</i><=
/tt><tt>])=20




<br>&nbsp;&nbsp;(ensure-dir </tt><tt><i>path</i></tt><tt> [</tt><tt><i>mode=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C543B8">mkdir</a>=
</tt>
tries to create the directory named
<tt><i>path</i></tt>
using the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C543B8">mkdir</a>=
</tt>
function.
An exception of type
<tt>file-error</tt>
is thrown if the function fails. Returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
on success.
</p><p>
The
<tt><i>mode</i></tt>
argument specifies the request numeric permissions
for the newly created directory. If omitted, the requested permissions are
<tt>#o777</tt>
(511): readable and writable to everyone. The requested permissions
are subject to the system
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>.
</p><p>
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C543B8">ensure-di=
r</a></tt>
also creates a directory named
<tt><i>path</i></tt>.
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C543B8">mkdir</a>=
</tt>,
it also attempt to create all the necessary parent directories,
and does not throw an error if
<tt><i>path</i></tt>
refers to an existing object, if that object is a directory or a symbolic
link to a directory. Rather, in that case it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
instead of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-03D941C3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.9">9.59.9</a=
> Function <tt>chdir</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chdir </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D941C3">chdir</a>=
</tt>
changes the current working directory to
<tt><i>path</i></tt>,
and returns
<tt><i>t</i></tt>,
or else throws an exception of type
<tt>file-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0047F5F6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.10">9.59.10<=
/a> Function <tt>pwd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pwd)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047F5F6">pwd</a></=
tt>
function retrieves the current working directory.
If the underlying
<tt>getcwd</tt>
C library function fails with an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
other than
<tt>ERANGE</tt>,
an exception will be thrown.
</p><p>

</p></dd></dl>
<a name=3D"N-03D90503">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.11">9.59.11<=
/a> Function <tt>rmdir</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rmdir </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D90503">rmdir</a>=
</tt>
function removes the directory named by
<tt>path</tt>.
If successful, it returns
<tt><i>t</i></tt>,
otherwise it throws an exception of type
<tt>file-error</tt>.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D90503">rmdir</a>=
</tt>
calls the same-named POSIX function, which requires
<tt>path</tt>
to be the name of an empty directory.
</p><p>

</p></dd></dl>
<a name=3D"N-014AF3F7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.12">9.59.12<=
/a> Function <tt>remove-path</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(remove-path </tt><tt><i>path</i></tt><tt> [</tt><tt><i>thr=
ow-on-error-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014AF3F7">remove-pa=
th</a></tt>
function tries to remove the filesystem object named
by
<tt><i>path</i></tt>,
which may be a file, directory or something else.
</p><p>
If successful, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The optional Boolean parameter
<tt><i>throw-on-error-p</i></tt>,
which defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
A failure to remove the object results in an exception of type
<tt>file-error</tt>
being thrown, unless the failure reason is that the object indicated by
<tt><i>path</i></tt>
doesn't exist. In this non-existence case, the behavior is controlled by th=
e
<tt><i>throw-on-error</i></tt>
argument. If that argument is true, the exception is thrown. Otherwise,
the function returns normally, producing the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to indicate that it didn't perform a removal.
</p><p>

</p></dd></dl>
<a name=3D"N-016EF40C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.13">9.59.13<=
/a> Function <tt>rename-path</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rename-path </tt><tt><i>from-path</i></tt><tt> </tt><tt><i=
>to-path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016EF40C">rename-pa=
th</a></tt>
function tries to rename filesystem path
<tt><i>from-path</i></tt>,
which may refer to a file, directory or something else, to the path
<tt><i>to-path</i></tt>.
</p><p>
If successful, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
A failure results in an exception of type
<tt>file-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0158244A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.59.14">9.59.14<=
/a> Functions <tt>sh</tt> and <tt>run</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sh </tt><tt><i>system-command</i></tt><tt>)=20




<br>&nbsp;&nbsp;(run </tt><tt><i>program</i></tt><tt> [</tt><tt><i>argument=
-list</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">sh</a></t=
t>
function executes
<tt><i>system-command</i></tt>
using the system command interpreter.
The run function spawns a
<tt><i>program</i></tt>,
searching for it using the
system PATH.  Using either method, the executed process receives environmen=
t
variables from the parent.
</p><p>
<b>TXR</b> blocks until the process finishes executing. If the program term=
inates
normally, then its integer exit status is returned. The value zero indicate=
s
successful termination.
</p><p>
The return value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
indicates an abnormal termination, or the inability
to run the process at all.
</p><p>
In the case of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">run</a></=
tt>
function, if the child process is created successfully
but the program cannot be executed, then the exit status will be an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
value from the failed
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6C913">exec</a><=
/tt>
attempt.
</p><p>
The standard input, output and error file descriptors of an executed
command are obtained from the streams stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
special variables, respectively. For a detailed description of the
behavior and restrictions, see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B03D38">open-comm=
and</a></tt>
function, whose description of this mechanism applies to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">run</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">sh</a></t=
t>
function also.
</p><p>
Note: as of <b>TXR</b> 120, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">sh</a></t=
t>
function is implemented using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">run</a></=
tt>
and not by means of the
<tt>system</tt>
C library function, as previously. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0158244A">run</a></=
tt>
function is used to invoke the system interpreter by name. On Unix-like
systems, the string
<tt>/bin/sh</tt>
is assumed to denote the system interpreter, which is expected to
support a pair of arguments
<tt>




-c </tt><tt><i>command</i></tt><tt>=20

</tt>

to specify the command to be executed. On MS Windows, the interpreter
is assumed to be the relative path name
<tt>cmd.exe</tt>
and expected to support
<tt>




/C </tt><tt><i>command</i></tt><tt>=20

</tt>

as a way of specifying a command to execute.
</p><p>
</p></dd></dl>
<a name=3D"N-0274414F">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60">9.60</a> Un=
ix Filesystem Manipulation</h3>



<p>


</p><p>

<a name=3D"N-0308FEDD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.1">9.60.=
1</a> Structure <tt>stat</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct stat nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; dev ino mod nlink uid gid=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; rdev size blksize blocks=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; atime atime-nsec mtime mtime-nsec=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; ctime ctime-nsec path)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure defines the type of object which is returned
by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
functions.  Except for
<tt>path</tt>,
<tt>atime-nsec</tt>,
<tt>ctime-nsec</tt>
and
<tt>mtime-nsec</tt>,
the slots are the direct counterparts of the
members of POSIX C structure
<tt>struct stat</tt>.
For instance the slot
<tt>dev</tt>
corresponds to
<tt>st_dev</tt>.
</p><p>
The
<tt>path</tt>
slot is set by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>.
Its value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
when the path is not available.
</p><p>
The
<tt>atime-nsec</tt>,
<tt>ctime-nsec</tt>
and
<tt>mtime-nsec</tt>
fields give the fractional parts of
<tt>atime</tt>,
<tt>ctime</tt>
and
<tt>mtime</tt>,
respectively. They are derived from the newer style information
in which the POSIX function provides the timestamps in
<tt>struct timespec</tt>
format. If that is not available from the platform, these
fields take on values of zero.
</p><p>

</p></dd></dl>
<a name=3D"N-006DE1CC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.2">9.60.2</a=
> Functions <tt>stat</tt>, <tt>lstat</tt> and <tt>fstat</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(stat {</tt><tt><i>path</i></tt><tt> | </tt><tt><i>stream</=
i></tt><tt> | </tt><tt><i>fd</i></tt><tt>} [</tt><tt><i>struct</i></tt><tt>=
])=20




<br>&nbsp;&nbsp;(lstat </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(fstat {</tt><tt><i>path</i></tt><tt> | stream | </tt><tt><=
i>fd</i></tt><tt>} [</tt><tt><i>struct</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
function retrieves information about a filesystem object whose pathname
is given by the string argument
<tt><i>path</i></tt>,
or else about a system object associated with the open stream
<tt><i>stream</i></tt>,
or one associated with the integer file descriptor
<tt><i>fd</i></tt>.
</p><p>
If a
<tt><i>stream</i></tt>
is specified, that stream must be of a kind from which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function can retrieve a file descriptor, otherwise an exception of type
<tt>file-error</tt>
is thrown.
</p><p>
If the object is not found or cannot be
accessed, an exception is thrown.
</p><p>
Otherwise, if the
<tt><i>struct</i></tt>
argument is missing, information is retrieved and returned, in the form of =
a
new structure of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>=
.
If the
<tt><i>struct</i></tt>
argument is present, it must be either: an instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
structure type, or of a type derived from that type by inheritance, or
else structure type which has all the same slots as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type. The retrieved information is stored into
<tt><i>struct</i></tt>
and that object is returned rather than a new object.
</p><p>
If
<tt><i>path</i></tt>
refers to a symbolic link, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
function retrieves information about the target of the link, if it exists,
or else throws an exception of type
<tt>file-error</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
function behaves the same as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
on objects which are not symbolic links. For a symbolic link, it retrieves
information about the link itself, rather than its target.
</p><p>
The
<tt>path</tt>
slot of the returned structure
holds a copy of their
<tt><i>path</i></tt>
argument value.
When information is retrieved using a
<tt><i>stream</i></tt>
or
<tt><i>fd</i></tt>
argument, this slot is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">fstat</a>=
</tt>
function is an alias for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>=
.
</p><p>
Note: until <b>TXR</b> 231,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">fstat</a>=
</tt>
were distinct functions:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
accepted only
<tt><i>path</i></tt>
arguments, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">fstat</a>=
</tt>
function accepted only
<tt><i>stream</i></tt>
or
<tt><i>fd</i></tt>
arguments.
</p><p>

</p></dd></dl>
<a name=3D"N-03F32D57">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.3">9.60.3</a=
> Variables <tt>s-ifmt</tt>, <tt>s-iflnk</tt>, <tt>s-ifreg</tt>, <tt>s-ifbl=
k</tt>, ... , <tt>s-ixoth</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The following variables exist, having integer values. These are bitmasks
which can be applied against the value given by the
<tt>mode</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure returned by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>=
:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifmt</a=
></tt>,
<tt>s-ifsock</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-iflnk</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifreg</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifblk</=
a></tt>,
<tt>s-ifdir</tt>,
<tt>s-ifchr</tt>,
<tt>s-ififo</tt>,
<tt>s-isuid</tt>,
<tt>s-isgid</tt>,
<tt>s-isvtx</tt>,
<tt>s-irwxu</tt>,
<tt>s-irusr</tt>,
<tt>s-iwusr</tt>,
<tt>s-ixusr</tt>,
<tt>s-irwxg</tt>,
<tt>s-irgrp</tt>,
<tt>s-iwgrp</tt>,
<tt>s-ixgrp</tt>,
<tt>s-irwxo</tt>,
<tt>s-iroth</tt>,
<tt>s-iwoth</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ixoth</=
a></tt>.
</p><p>
These variables correspond to the C language constants from POSIX:
<tt>S_IFMT</tt>,
<tt>S_IFLNK</tt>,
<tt>S_IFREG</tt>
and so forth.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1548A">logtest</=
a></tt>
function can be used to test these against values of mode.
For example
<tt>(logtest mode s-irgrp)</tt>
tests for the group read permission.
</p><p>

</p></dd></dl>
<a name=3D"N-0068D92E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.4">9.60.4</a=
> Function <tt>umask</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(umask [</tt><tt><i>mask</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>
function provides access to the Unix C library function of the same name,
which controls which permissions are denied
when files are newly created.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>
is called with no argument, it returns the current value of the mask.
</p><p>
If the
<tt><i>mask</i></tt>
argument is present, it must be an integer specifying the new mask to be
installed.  The previous mask is returned.
</p><p>
If
<tt><i>mask</i></tt>
is absent, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>
returns the previous mask.
</p><p>
Note: the value of the
<tt><i>mask</i></tt>
argument may be calculated as a bitwise or of the following constants:
<tt>s-irwxu</tt>,
<tt>s-irusr</tt>,
<tt>s-iwusr</tt>,
<tt>s-ixusr</tt>,
<tt>s-irwxg</tt>,
<tt>s-irgrp</tt>,
<tt>s-iwgrp</tt>,
<tt>s-ixgrp</tt>,
<tt>s-irwxo</tt>,
<tt>s-iroth</tt>,
<tt>s-iwoth</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ixoth</=
a></tt>,
which correspond to the POSIX C constants
<tt>S_IRWXU</tt>,
<tt>S_IRUSR</tt>,
<tt>S_IWUSR</tt>,
<tt>S_IXUSR</tt>,
<tt>S_IRWXG</tt>,
<tt>S_IRGRP</tt>,
<tt>S_IWGRP</tt>,
<tt>S_IXGRP</tt>,
<tt>S_IRWXO</tt>,
<tt>S_IROTH</tt>,
<tt>S_IWOTH</tt>
and
<tt>S_IXOTH</tt>.
</p><p>
Implementation note: since the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>
C library function provides no way to retrieve the current mask without
overwriting with a new one, the <b>TXR</b><tt><a href=3D"http://nongnu.org/=
txr/txr-manpage.html#N-0068D92E">umask</a></tt>
function, when given no argument, simulates the pure retrieval of the mask
by calling the C function with an argument of
<tt>#o777</tt>
to temporarily install the maximally safe mask. The value returned is then
reinstated as the mask by another call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>,
and that value is also returned.
</p><p>

</p></dd></dl>
<a name=3D"N-02F0F482">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.5">9.60.5</a=
> Functions <tt>makedev</tt>, <tt>minor</tt> and <tt>major</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(makedev </tt><tt><i>minor</i></tt><tt> </tt><tt><i>major</=
i></tt><tt>)=20




<br>&nbsp;&nbsp;(minor </tt><tt><i>dev</i></tt><tt>)=20




<br>&nbsp;&nbsp;(major </tt><tt><i>dev</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The parameters
<tt><i>minor</i></tt>,
<tt><i>major</i></tt>
and
<tt><i>dev</i></tt>
are all integers.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0F482">makedev</=
a></tt>
function constructs a combined device number from a minor and major pair (b=
y
calling the Unix
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0F482">makedev</=
a></tt>
function).  This device number is suitable as an
argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F93A39">mknod</a>=
</tt>
function (see below). Device numbers also appear as values of the
<tt>dev</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0F482">minor</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0F482">major</a>=
</tt>
functions extract the minor and major device number
from a combined device number.
</p><p>

</p></dd></dl>
<a name=3D"N-00F941E5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.6">9.60.6</a=
> Function <tt>chmod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chmod </tt><tt><i>target</i></tt><tt> </tt><tt><i>mode</i>=
</tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
function changes the permissions of the filesystem object
specified by
<tt><i>target</i></tt>.
It is implemented in terms of the POSIX functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
and
<tt>fchmod</tt>.
If
<tt><i>mode</i></tt>
is a character string representing a symbolic mode, then the function
also makes use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">fstat</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>.
</p><p>
</p><p>
The permissions are specified by
<tt><i>mode</i></tt>,
which must be an integer or a string.
</p><p>
An integer
<tt><i>mode</i></tt>
is a bitwise combination of permission mode bits. The value is passed
directly to the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
or
<tt>fchmod</tt>
function.
Note: to construct a mode value, applications may use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
to combine the values
of the variables like
<tt>s-irusr</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ixoth</=
a></tt>
or take advantage of the well-known numeric structure of POSIX
permissions to express them octal in octal notation.  For instance the mode
<tt>#o750</tt>
denotes that the owner has read, write and execute permissions,
the group owner has read and execute, others have no permission.
This value may also be calculated using
<tt>(logior s-irwxu s-irgrp s-ixgrp)</tt>.
</p><p>
If the argument to
<tt><i>mode</i></tt>
is a string, it is interpreted according to the symbolic syntax
of the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
utility. For instance, a
<tt><i>mode</i></tt>
value of
<tt>"a+w,-s"</tt>

means to give all users (owner, group and others) write permission,
and remove the setuid and setgid bits.
</p><p>
The full syntax and semantics of symbolic
<tt><i>mode</i></tt>
strings is given in the POSIX standard IEEE 1003.1.
</p><p>
The function throws a
<tt>file-error</tt>
exception if an error occurs, otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The
<tt><i>target</i></tt>
argument may be a character string, in which case it specifies a pathname i=
n
the filesystem. In this case, the POSIX function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
is invoked.
</p><p>
The
<tt><i>target</i></tt>
argument may also be an integer file descriptor, or a stream. In these two
cases, the POSIX
<tt>fchmod</tt>
function is invoked. For a stream
<tt><i>target</i></tt>,
the integer file descriptor is retrieved from the stream using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


<tt>
</tt></p><pre><tt>  ;; Set permissions of foo.txt to "rw-r--r--"
  ;; (owner can read and write; group owner
  ;; and other users can only read).

  ;; numerically:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a> =
"foo.txt" #o644)

  ;; symbolically:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a> =
"foo.txt" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior=
</a> s-irusr s-iwusr
                           s-irgrp
                           s-iroth))
</tt></pre><tt>

</tt>

<p>
Implementation note: The implementation of the symbolic
<tt><i>mode</i></tt>
processing is based on the descriptions given in IEEE 1003.1-2018,
Issue 7 and also on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
program from from GNU Coreutils 8.28: and experiments with its behavior,
and its documentation.
</p><p>

</p></dd></dl>
<a name=3D"N-003B491C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.7">9.60.7</a=
> Functions <tt>chown</tt> and <tt>lchown</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chown </tt><tt><i>target</i></tt><tt> </tt><tt><i>id</i></=
tt><tt> </tt><tt><i>gid</i></tt><tt>)=20




<br>&nbsp;&nbsp;(lchown </tt><tt><i>target</i></tt><tt> </tt><tt><i>id</i><=
/tt><tt> </tt><tt><i>gid</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">chown</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">lchown</a=
></tt>
functions change the user and group ownership of the filesystem object
specified by
<tt><i>target</i></tt>.
</p><p>
They implemented in terms of the POSIX functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">chown</a>=
</tt>,
<tt>fchown</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">lchown</a=
></tt>.
</p><p>
The ownership attributes are specified by
<tt><i>uid</i></tt>
and
<tt><i>gid</i></tt>,
both integer arguments.
</p><p>
The existing ownership attributes may be obtained using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
function.
</p><p>
These functions throw a
<tt>file-error</tt>
exception if an error occurs, otherwise they returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The
<tt><i>target</i></tt>
argument may be a character string, in which case it specifies a pathname i=
n
the filesystem. In this case, the same-named POSIX function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">chown</a>=
</tt>
is invoked by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">chown</a>=
</tt>,
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">lchown</a=
></tt>
likewise invokes its respective same-named POSIX counterpart.
The difference is that if
<tt><i>target</i></tt>
is a pathname denoting a symbolic link, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">lchown</a=
></tt>
operates on the symbolic link, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">chown</a>=
</tt>
dereferences the symbolic link.
</p><p>
The
<tt><i>target</i></tt>
argument may also be an integer file descriptor, or a stream. In these two
cases, the POSIX
<tt>fchown</tt>
function is invoked by either function. For a stream
<tt><i>target</i></tt>,
the integer file descriptor is retrieved from the stream using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function.
</p><p>
Note: in most POSIX systems, unprivileged processes may not change the user
ownership denoted by
<tt><i>uid</i></tt>.
They may change the group ownership indicated in
<tt><i>gid</i></tt>,
if that value corresponds to the effective group ID of the calling
process or one of its ancillary group IDs.
</p><p>
To avoid trying to change the user ownership (and therefore failing),
the caller should specify a
<tt><i>uid</i></tt>
value which matches the object's existing owner.
</p><p>

</p></dd></dl>
<a name=3D"N-00E96FCF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.8">9.60.8</a=
> Functions <tt>utimes</tt> and <tt>lutimes</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(utimes </tt><tt><i>target</i></tt><tt> </tt><tt><i>atime-s=
</i></tt><tt> </tt><tt><i>atime-ns</i></tt><tt> </tt><tt><i>mtime-s</i></tt=
><tt> </tt><tt><i>mtime-ns</i></tt><tt>)=20




<br>&nbsp;&nbsp;(lutimes </tt><tt><i>target</i></tt><tt> </tt><tt><i>atime-=
s</i></tt><tt> </tt><tt><i>atime-ns</i></tt><tt> </tt><tt><i>mtime-s</i></t=
t><tt> </tt><tt><i>mtime-ns</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">utimes</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">lutimes</=
a></tt>
change the access and modification timestamps of a file indicated by the
<tt><i>target</i></tt>
argument.
</p><p>
The difference between the two functions is that if
<tt><i>target</i></tt>
is the path name of a symbolic link, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">lutimes</=
a></tt>
operates on the symbolic link itself, whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">utimes</a=
></tt>
resolves the symbolic link.
</p><p>
Note: the full, complete functionality of these functions requires the
platform to provide the POSIX functions
<tt>futimens</tt>
and
<tt>utimensat</tt>
functions.  If these functions are not available, then other functions are
relied on, with some reductions in functionality, that are documented below=
.
</p><p>
The
<tt><i>target</i></tt>
argument specifies the file to operate on. It may be an integer file descri=
ptor,
an open stream, or a character string representing a path name.
</p><p>
The
<tt><i>atime-s</i></tt>
and
<tt><i>mtime-s</i></tt>
parameters specify the whole seconds part of the new access and modificatio=
n
times, expressed as seconds since the epoch.
</p><p>
The
<tt><i>atime-ns</i></tt>
and
<tt><i>mtime-ns</i></tt>
parameters specify the fractional part of the access and modification
times, expressed in nanoseconds. If an integer argument is given to these
parameters, it must lie in the range 0 to 999999999, or else the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
may be passed as arguments.
</p><p>
If the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is passed as the nanoseconds part of the access or modification time,
then the access or modification time, respectively, shall not be modified
by the operation. The corresponding seconds argument is ignored.
</p><p>
If the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is passed as the nanoseconds part of the access or modification time,
then the access or modification time, respectively, shall be obtained
from the current system time. The corresponding seconds argument is ignored=
.
</p><p>
If the
<tt>utimensat</tt>
and
<tt>futimens</tt>
functions are not available from the host system, then the above
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
convention in the nanoseconds arguments is not supported; the function
will fail by throwing an exception if an attempt is made to pass these
arguments.
</p><p>
If the
<tt>utimensat</tt>
and
<tt>futimens</tt>
functions are not available from the host system, then operating on
a symbolic link with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">lutimes</=
a></tt>
is only possible if the system provides the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">lutimes</=
a></tt>
C library function, otherwise the operation fails by throwing an exception
(if given a path argument for
<tt><i>target</i></tt>,
even if that path isn't a symbolic link).
</p><p>
If the implementation falls back on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">utimes</a=
></tt>,
<tt>futimes</tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E96FCF">lutimes</=
a></tt>
functions, then the nanoseconds arguments are truncated to microsecond
precision.
</p><p>
If the implementation falls back on
<tt>utime</tt>,
then the nanoseconds arguments are ignored; the times are effectively
truncated to whole seconds.
</p><p>

</p></dd></dl>
<a name=3D"N-00F93A39">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.9">9.60.9</a=
> Function <tt>mknod</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mknod </tt><tt><i>path</i></tt><tt> </tt><tt><i>mode</i></=
tt><tt> [</tt><tt><i>dev</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F93A39">mknod</a>=
</tt>
function tries to create an entry in the filesystem: a file,
FIFO, or a device special file, under the name
<tt><i>path</i></tt>.
If it is successful,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
otherwise it throws an exception of type
<tt>file-error</tt>.
</p><p>
The
<tt><i>mode</i></tt>
argument is a bitwise or combination of the requested permissions,
and the type of object to create: one of the constants
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifreg</=
a></tt>,
<tt>s-ififo</tt>,
<tt>s-ifchr</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifblk</=
a></tt>
or
<tt>s-ifsock</tt>.
The permissions are subject to the system
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>.
</p><p>
If a block or character special device
(<tt>s-ifchr</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F32D57">s-ifblk</=
a></tt>)
is being
created, then the
<tt><i>dev</i></tt>
argument specifies the major and minor numbers
of the device. A suitable value can be constructed from a major and minor
pair using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F0F482">makedev</=
a></tt>
function.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>   ;; make a character device (8, 3) called /dev/foo
   ;; requesting rwx------ permissions

   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F93A39">mknod</a>=
 "dev/foo" (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logio=
r</a> #o700 s-ifchr) (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
2F0F482">makedev</a> 8 3))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0091FD43">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.10">9.60.10<=
/a> Function <tt>mkfifo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(mkfifo </tt><tt><i>path</i></tt><tt> </tt><tt><i>mode</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0091FD43">mkfifo</a=
></tt>
function creates a POSIX FIFO object.
If it is successful,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
otherwise it throws an exception of type
<tt>file-error</tt>.
</p><p>
The
<tt><i>mode</i></tt>
argument is a bitwise or combination of the requested permissions,
and is subject to the system
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F93A39">mknod</a>=
</tt>
function can also create FIFOs, specified via the bitwise combination
of the
<tt>s-ififo</tt>
type and the permission mode bits.
</p><p>

</p></dd></dl>
<a name=3D"N-009EF0C8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.11">9.60.11<=
/a> Functions <tt>symlink</tt> and <tt>link</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(symlink </tt><tt><i>target</i></tt><tt> </tt><tt><i>path</=
i></tt><tt>)=20




<br>&nbsp;&nbsp;(link </tt><tt><i>target</i></tt><tt> </tt><tt><i>path</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009EF0C8">symlink</=
a></tt>
function creates a symbolic link called
<tt><i>path</i></tt>
whose contents
are the absolute or relative path
<tt><i>target</i></tt>.
<tt><i>target</i></tt>
does not actually have to exist.
</p><p>
The link function creates a hard link. The object at
<tt><i>target</i></tt>
is installed
into the filesystem at
<tt><i>path</i></tt>
also.
</p><p>
If these functions succeed, they return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise they throw an exception
of type
<tt>file-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0338B219">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.12">9.60.12<=
/a> Function <tt>readlink</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(readlink </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>path</i></tt>
names a filesystem object which is a symbolic link, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0338B219">readlink<=
/a></tt>
function reads the contents of that symbolic link and returns it
as a string.  Otherwise, it fails by throwing an exception of type
<tt>file-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0168BEB4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.60.13">9.60.13<=
/a> Function <tt>realpath</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(realpath </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168BEB4">realpath<=
/a></tt>
function provides access to the same-named POSIX function.
It processes the input string
<tt><i>path</i></tt>
by expanding all symbolic links, removes all superfluous
<tt>".."</tt>

and
<tt>"."</tt>

path components, and extra path-separating slash characters,
to produce a canonical absolute path name.
</p><p>
If the underlying POSIX function indicates failure, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. In that situation the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
value is available using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
function.
</p><p>
</p></dd></dl>
<a name=3D"N-023BAF92">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.61">9.61</a> Un=
ix Filesystem Complex Operations</h3>



<p>


</p><p>
Functions in this category are complex functionality implemented using
a combination of multiple calls into the host system's POSIX API.
</p><p>

<a name=3D"N-019D6582">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.61.1">9.61.=
1</a> Functions <tt>copy-file</tt> and <tt>copy-files</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-file </tt><tt><i>from-path</i></tt><tt> </tt><tt><i>t=
o-path</i></tt><tt> [</tt><tt><i>perms-p</i></tt><tt> [</tt><tt><i>times-p<=
/i></tt><tt>]])=20




<br>&nbsp;&nbsp;(copy-file </tt><tt><i>from-list</i></tt><tt> </tt><tt><i>t=
o-dir</i></tt><tt> [</tt><tt><i>perms-p</i></tt><tt> [</tt><tt><i>times-p</=
i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
</a></tt>
function creates a replica of the file
<tt>from-path</tt>
at the destination path
<tt><i>to-path</i></tt>.
</p><p>
Both paths are opened using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
in binary mode, as if using
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file</a=
> </tt><tt><i>from-path</i></tt><tt> b)=20

</tt>

and
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file</a=
> </tt><tt><i>to-path</i></tt><tt> wb)=20

</tt>

respectively. Then bytes are read from one stream and written to the other,
in blocks which whose size is a power of two at least as large as 16834.
</p><p>
If the optional Boolean parameter
<tt><i>perms-p</i></tt>
is specified, and is true, then the permissions of
<tt><i>from-path</i></tt>
are propagated to
<tt><i>to-path</i></tt>.
</p><p>
If the optional Boolean parameter
<tt><i>times-p</i></tt>
is specified, and is true, then the access and modification timestamps of
<tt><i>from-path</i></tt>
are propagated to
<tt><i>to-path</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if it is successful, and throws an exception derived from
<tt>file-error</tt>
on failure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
function copies multiple files, whose pathnames are given by the list argum=
ent
<tt><i>from-list</i></tt>
into the target directory whose path is given by
<tt><i>to-dir</i></tt>.
</p><p>
The target directory must exist.
</p><p>
For source each path in
<tt><i>from-list</i></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
function forms a target path by combining the base name of the
source path with
<tt><i>target-dir</i></tt>.
(See the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">base-name=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat<=
/a></tt>
functions).
Then, the source path is copied to the resulting target path, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
</a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if it is successful, and throws an exception derived from
<tt>file-error</tt>
on failure.
</p><p>
Additionally,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
provides an internal catch for the
<tt>retry</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
restart exceptions. If the caller, using a handler frame established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>,
catches an error emanating from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
function, it can retry the failed operation by throwing the
<tt>retry</tt>
exception, or continue copying with the next file by throwing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
exception.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Copy all "/mnt/cdrom/*.jpg" files into "images" dire=
ctory,
  ;; preserving their time stamps,
  ;; continuing the operation in the face of
  ;; file-error exceptions.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-fil=
es</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob<=
/a> "/mnt/cdrom/*.jpg") "images" nil t)
    (file-error (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">=
throw</a> 'skip)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-034734A3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.61.2">9.61.2</a=
> Function <tt>copy-path-rec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-path-rec </tt><tt><i>from-path</i></tt><tt> </tt><tt>=
<i>to-path</i></tt><tt> </tt><tt><i>option</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>
function replicates a file system object identified by the path name
<tt><i>from-path</i></tt>,
creating a similar object named
<tt><i>to-path</i></tt>.
</p><p>
If
<tt>from-path</tt>
is a directory, it is recursively traversed and its structure and content
is replicated under
<tt>to-path</tt>.
</p><p>
The
<tt><i>option</i></tt>
arguments are keywords, which may be the following:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>:perms</dt><dd>
Propagate the permissions of all objects under
<tt><i>from-path</i></tt>
onto their
<tt><i>to-path</i></tt>
counterparts. In the absence of this option, the copied objects
receive permissions with are calculated by applying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>
of the calling process to the maximally liberal.
</dd><dt>:times</dt><dd>
Propagate the modification and access time stamps of all objects under
<tt><i>from-path</i></tt>
onto their
<tt><i>to-path</i></tt>
counterparts.
</dd><dt>:symlinks</dt><dd>
Copy symbolic links literally rather than dereferencing them.
Symbolic links are not altered in any way; their exact content
is preserved. Thus, relative symlinks which point outside of the
<tt><i>from-path</i></tt>
tree may turn into dangling symlinks in the
<tt><i>to-path</i></tt>
tree.
</dd><dt>:owner</dt><dd>
Propagate the ownership of all objects under
<tt><i>from-path</i></tt>
to their
<tt><i>to-path</i></tt>
counterparts. Ownership refers to the owner user ID and group ID.
Without this option, the ownership of the copied objects is derived
from the effective user ID and group ID of the calling process.
Note that it is assumed that the host system may requires superuser
privileges to set both ownerships IDs of an object, and to set them to an
arbitrary value. An unprivileged process may not change the user ID of a fi=
le,
and may only change the group ID of a file which they own, to one of the gr=
oups
of which that process is a member, either via the effective GID, or the
ancillary list. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>
function tests whether the application is running under superuser privilege=
s;
if not, then it only honors the
<tt>:owner</tt>
option for those objects under
<tt><i>from-path</i></tt>
which are owned by the caller, and owned by a group to
which the caller belongs.
Other objects are copied as if the
<tt>:owner</tt>
option were not in effect, avoiding an attempt to set their ownership
that is likely to fail.
</dd><dt>:all</dt><dd>
The
<tt>:all</tt>
keyword is a shorthand representing all of the options being applied:
permissions, times, symlinks and ownership are replicated.
</dd></dl>
</dl>
<p>

The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>
function creates all necessary path name components required for
<tt><i>to-path</i></tt>
to come into existence, as if by using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C543B8">ensure-di=
r</a></tt>
function.
</p><p>
Whenever an object under
<tt><i>from-path</i></tt>
has a counterpart in
<tt><i>to-path</i></tt>
which already exists, the situation is handled as follows:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
If a directory object is copied to an existing directory object,
then that existing directory object is accepted as the copy, and
the operation continues recursively within that directory. If any options a=
re
specified, then the requested attributes are propagated to that existing
directory.
</dd><dt>2.</dt><dd>
If a non-directory object is copied to a directory object, the
situation throws an exception: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>
function refuses to delete an entire directory or subdirectory in order
to make way for a file, symbolic link, special device or any other kind
of non-directory object.
</dd><dt>3.</dt><dd>
If any object is copied to an existing non-directory object,
that target object is removed first, then the copy operation proceeds.
</dd></dl>
</dl>
Copying of files takes place similarly as what is described for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
</a></tt>
function.
<p>
Special objects such as FIFOs, character devices, block devices and sockets
are copied by creating a new, similar objects at the destination path.
In the case of devices, the major and minor numbers of the copy are
derived from the original, so that the copy refers to the same device.
However, the copy of a socket or a FIFO is effectively a new, different
endpoint because these objects are identified by their path name.
Processes using the copy of a socket or a FIFO will not connect to
processes which are working with the original.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if it is successful. It throws an exception derived from
<tt>file-error</tt>
when encountering failures.
</p><p>
Additionally
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>
provides an internal catch for the
<tt>retry</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
restart exceptions. If the caller, using a handler frame established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>,
catches an error emanating from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
function, it can retry the failed operation by throwing the
<tt>retry</tt>
exception, or continue copying with the next object by throwing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
exception.
</p><p>

</p></dd></dl>
<a name=3D"N-03E81B3A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.61.3">9.61.3</a=
> Function <tt>remove-path-rec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(remove-path-rec </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E81B3A">remove-pa=
th-rec</a></tt>
function attempts to remove the filesystem object named by
<tt><i>path</i></tt>.
If
<tt><i>path</i></tt>
refers to a directory, that directory is recursively traversed
to remove all of its contents, and is then removed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E81B3A">remove-pa=
th-rec</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if it is successful. It throws an exception derived from
<tt>file-error</tt>
when encountering failures.
</p><p>
Additionally
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E81B3A">remove-pa=
th-rec</a></tt>
provides an internal catch for the
<tt>retry</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
restart exceptions. If the caller, using a handler frame established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>,
catches an error emanating from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019D6582">copy-file=
s</a></tt>
function, it can retry the failed operation by throwing the
<tt>retry</tt>
exception, or continue removing other objects by throwing the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>
exception. Skipping a failed remove operation may cause subsequent
operations to fail. Notably, the failure to remove an item inside
a directory means that removal of that directory itself will fail,
and ultimately,
<tt><i>path</i></tt>
will still exist when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E81B3A">remove-pa=
th-rec</a></tt>
completes and returns.
</p><p>

</p></dd></dl>
<a name=3D"N-02D8298E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.61.4">9.61.4</a=
> Functions <tt>chmod-rec</tt> and <tt>chown-rec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(chmod-rec </tt><tt><i>path</i></tt><tt> </tt><tt><i>mode</=
i></tt><tt>)=20




<br>&nbsp;&nbsp;(chown-rec </tt><tt><i>path</i></tt><tt> </tt><tt><i>uid</i=
></tt><tt> </tt><tt><i>gid</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8298E">chmod-rec=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8298E">chown-rec=
</a></tt>
functions are recursive counterparts of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">lchown</a=
></tt>.
</p><p>
The filesystem object given by
<tt><i>path</i></tt>
is recursively traversed, and each of its constituent objects
is subject to a permission change in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8298E">chown-rec=
</a></tt>,
or an ownership change in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8298E">chown-rec=
</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8298E">chmod-rec=
</a></tt>
function alters the permission of each object that is not a symbolic link
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
function, and
<tt><i>mode</i></tt>
is interpreted accordingly: it may be an integer or string.
Each object which is a symbolic link is ignored.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8298E">chown-rec=
</a></tt>
function alters the permission of each object encountered, including
symbolic links, using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003B491C">lchown</a=
></tt>
function.
</p><p>
These functions establish restart catches, similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E81B3A">remove-pa=
th-rec</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034734A3">copy-path=
-rec</a></tt>,
allowing the caller to retry individual failed operations or skip the objec=
ts
on which operations have failed.
</p><p>

</p></dd></dl>
<a name=3D"N-0038DD42">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.61.5">9.61.5</a=
> Function <tt>touch</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(touch </tt><tt><i>path</i></tt><tt> [</tt><tt><i>ref-path<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0038DD42">touch</a>=
</tt>
function updates the modification timestamp of the filesystem object
named by
<tt><i>path</i></tt>.
If the object doesn't exist, it is created as a regular file.
</p><p>
If
<tt><i>ref-path</i></tt>
is specified, then the modification timestamp of the object denoted by
<tt><i>path</i></tt>
is updated to be equivalent to the modification timestamp of
the object denoted by
<tt><i>ref-path</i></tt>.
Otherwise
<tt><i>ref-path</i></tt>
being absent, the modification timestamp of
<tt><i>path</i></tt>
is set to the current time.
</p><p>
If
<tt><i>path</i></tt>
is a symbolic link, it is dereferenced;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0038DD42">touch</a>=
</tt>
operates on the target of the link.
</p><p>
</p></dd></dl>
<a name=3D"N-0266E956">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62">9.62</a> Un=
ix Filesystem Object Existence, Type and Access Tests</h3>



<p>


</p><p>
Functions in this category perform various tests on the attributes of
filesystem objects.
</p><p>
The functions all have a
<tt><i>path</i></tt>
parameter, which accepts three types of arguments. If a character
string is specified, it denotes a filesystem path to
be probed for properties such as ownership and permissions.
The object is probed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
function except in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-syml=
ink-p</a></tt>
which uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>.
If instead a stream is specified as
<tt><i>path</i></tt>,
then the associated filesystem descriptor is probed for these properties.
If an integer value is specified, it is treated as a POSIX
open file descriptor that is to be probed.
Otherwise, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure, for example one returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
function may be specified, in which case no system object
is probed. The properties to be tested are those given in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
object.
</p><p>
Note: in a situation when it is necessary to use any of these functions to
probe the properties of a symbolic link itself (other than the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-syml=
ink-p</a></tt>
which does so implicitly) it is necessary to first invoke
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
on the symlink's path, and then pass the resulting
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure to that function instead of the path.
</p><p>
Some of the accessibility tests (functions which determine whether the
calling process has certain access rights) may not be perfectly accurate, s=
ince
they are based strictly on portable information available via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>=
,
together with the basic, portable POSIX APIs for inquiring about
security credentials, such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00125C22">geteuid</=
a></tt>.
They ignoring any special permissions which may exist such as operating sys=
tem
and file system specific extended attributes (for example, file immutabilit=
y
connected to a "secure level" and such) and special process capabilities
not reflected in the basic credentials.
</p><p>

<a name=3D"N-03C41AE2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.1">9.62.=
1</a> Function <tt>path-exists-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-exists-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C41AE2">path-exis=
ts-p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>path</i></tt>
is a string which resolves to a filesystem object.
Otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If the
<tt><i>path</i></tt>
names a dangling symbolic link, it is considered nonexistent.
</p><p>
If
<tt><i>path</i></tt>
is an object returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C41AE2">path-exis=
ts-p</a></tt>
unconditionally returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>

</p></dd></dl>
<a name=3D"N-00198FC7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.2">9.62.2</a=
> Functions <tt>path-file-p</tt>, <tt>path-dir-p</tt>, <tt>path-symlink-p</=
tt>, <tt>path-blkdev-p</tt>, <tt>path-chrdev-p</tt>, <tt>path-sock-p</tt> a=
nd <tt>path-pipe-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-file-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-dir-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-symlink-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-blkdev-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-chrdev-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-sock-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-pipe-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-file=
-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists and is a regular file.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-dir-=
p</a></tt>
tests whether
<tt><i>path</i></tt>
exists and is a directory.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-syml=
ink-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists and is a symbolic link.
</p><p>
Similarly,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-blkd=
ev-p</a></tt>
tests for a block device,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-chrd=
ev-p</a></tt>
for a character device,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-sock=
-p</a></tt>
for a socket and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-pipe=
-p</a></tt>
for a named pipe.
</p><p>

</p></dd></dl>
<a name=3D"N-01EFC15D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.3">9.62.3</a=
> Function <tt>path-dir-empty</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-dir-empty </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EFC15D">path-dir-=
empty</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>path</i></tt>
is an empty directory.
</p><p>
Implementation note: this function performs a test similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00198FC7">path-dir-=
p</a></tt>;
then, if it is confirmed that
<tt><i>path</i></tt>
is a directory, a directory stream is opened and entries are read.
If an entry is seen which has a name other than
<tt>"."</tt>

or
<tt>".."</tt>

then it is concluded that the directory is not empty and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. If no such entry is seen, then the directory is deemed empty a=
nd
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-02FBA677">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.4">9.62.4</a=
> Functions <tt>path-setgid-p</tt>, <tt>path-setuid-p</tt> and <tt>path-sti=
cky-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-setgid-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-setuid-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-sticky-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBA677">path-setg=
id-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists and has the set-group-ID permission set.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBA677">path-setu=
id-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists and has the set-user-ID permission set.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBA677">path-stic=
ky-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists and has the "sticky" permission bit set.
</p><p>

</p></dd></dl>
<a name=3D"N-020F44B5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.5">9.62.5</a=
> Functions <tt>path-mine-p</tt> and <tt>path-my-group-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-mine-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-my-group-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020F44B5">path-mine=
-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists, and is effectively owned by the calling process; that is,
it has a user ID equal to the effective user ID of the process.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020F44B5">path-my-g=
roup-p</a></tt>
tests whether
<tt><i>path</i></tt>
exists, and is effectively owned by a group to which the calling process
belongs. This means that the group owner is either the same as the
effective group ID of the calling process, or else is among the
supplementary group IDs of the calling process.
</p><p>

</p></dd></dl>
<a name=3D"N-02933008">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.6">9.62.6</a=
> Function <tt>path-readable-to-me-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-readable-to-me-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02933008">path-read=
able-to-me-p</a></tt>
tests whether the calling process can read the
object named by
<tt><i>path</i></tt>.
If necessary, this test examines the effective user ID of the
calling process, the effective group ID, and the list of supplementary grou=
ps.
</p><p>

</p></dd></dl>
<a name=3D"N-02033190">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.7">9.62.7</a=
> Function <tt>path-writable-to-me-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-writable-to-me-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02033190">path-writ=
able-to-me-p</a></tt>
tests whether the calling process can write the
object named by
<tt><i>path</i></tt>.
If necessary, this test examines the effective user ID of the
calling process, the effective group ID, and the list of supplementary grou=
ps.
</p><p>

</p></dd></dl>
<a name=3D"N-028A5109">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.8">9.62.8</a=
> Function <tt>path-read-writable-to-me-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-read-writable-to-me-p </tt><tt><i>path</i></tt><tt>)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02933008">path-read=
able-to-me-p</a></tt>
tests whether the calling process can both read and write the
object named by
<tt><i>path</i></tt>.
If necessary, this test examines the effective user ID of the
calling process, the effective group ID, and the list of supplementary grou=
ps.
</p><p>

</p></dd></dl>
<a name=3D"N-014A4B85">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.9">9.62.9</a=
> Function <tt>path-executable-to-me-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-executable-to-me-p </tt><tt><i>path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014A4B85">path-exec=
utable-to-me-p</a></tt>
tests whether the calling process can execute the
object named by
<tt><i>path</i></tt>,
or perform a search (name lookup, not implying sequential readability) on i=
t,
if it is a directory.
If necessary, this test examines the effective user ID of the
calling process, the effective group ID, and the list of supplementary grou=
ps.
</p><p>

</p></dd></dl>
<a name=3D"N-03B3F844">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.10">9.62.10<=
/a> Functions <tt>path-private-to-me-p</tt> and <tt>path-strictly-private-t=
o-me-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-private-to-me-p </tt><tt><i>path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-strictly-private-to-me-p </tt><tt><i>path</i></tt><tt=
>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B3F844">path-priv=
ate-to-me-p</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B3F844">path-stri=
ctly-private-to-me-p</a></tt>
functions report whether the calling process can rely on the
object indicated by
<tt>path</tt>
to be, respectively, private or strictly private to the security context
implied by its effective user ID.
</p><p>
"Private" means that beside the effective user ID of the calling process an=
d
the superuser, no other user ID has write access to the object, and thus it=
s
contents may be trusted to be be free from tampering by any other user.
</p><p>
"Strictly private" means that not only is the object private, as above,
but users other than the effective user ID of the calling process
and superuser also not not have read access.
</p><p>
The rules which the function applies are as follows:
</p><p>
A file to be examined is initially assumed to be strictly private.
</p><p>
If the file is not owned by the effective user ID of the caller, or
else by the superuser, then it is not private.
</p><p>
If the file grants write permission to "others", then it is not private.
</p><p>
If the file grants read permission to "others", then it is not strictly
private.
</p><p>
If the file grants write permission to the group owner, then it is not
private if the group contains names other than that of the file owner or th=
e
superuser.
</p><p>
If the file grants read permission to the group owner, then it is not
strictly private if the group contains names other than that of the file ow=
ner
or the superuser.
</p><p>
Note that this interpretation of "private" and "strictly private" is vulner=
able
to the following time-of-check to time-of-use race condition with regard to=
 the
group check.  At the time of the check, the group might be empty or contain
only the caller as a member. But by the time the file is subsequently acces=
sed,
the group might have been innocently extended by the system administrator t=
o
include additional users, who can maliciously modify the file.
</p><p>
Also note that the function is vulnerable to a time-of-check to time-of-use
race if
<tt><i>path</i></tt>
is a string rather than a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure. If any components of the
<tt><i>path</i></tt>
are symbolic links or directories that can be manipulated by other
users, then the object named by
<tt><i>path</i></tt>
file can pass the check, but can later
<tt><i>path</i></tt>
can be subverted to refer to a different object.
</p><p>
One way to guard against this race is to open the file, then use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">fstat</a>=
</tt>
on the stream to obtain a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure which is then used as an argument to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B3F844">path-priv=
ate-to-me-p</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B3F844">path-stri=
ctly-private-to-me-p</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0155004F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.11">9.62.11<=
/a> Functions <tt>path-newer</tt> and <tt>path-older</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-newer </tt><tt><i>left-path</i></tt><tt> </tt><tt><i>=
right-path</i></tt><tt>)=20




<br>&nbsp;&nbsp;(path-older </tt><tt><i>left-path</i></tt><tt> </tt><tt><i>=
right-path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0155004F">path-newe=
r</a></tt>
function compares two paths or stat results by modification time.
It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>left-path</i></tt>
exists, and either
<tt><i>right-path</i></tt>
does not exist, or has a modification time stamp in the past
relative to
<tt><i>left-path</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0155004F">path-olde=
r</a></tt>
function is equivalent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0155004F">path-newe=
r</a></tt>
with the arguments reversed.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0155004F">path-newe=
r</a></tt>
takes advantage of sub-second timestamp resolution information,
if available. The implementation is based on using the
<tt>mtime-nsec</tt>
field of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure, if it isn't
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0103E27B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.62.12">9.62.12<=
/a> Function <tt>path-same-object</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(path-same-object </tt><tt><i>left-path</i></tt><tt> </tt><=
tt><i>right-path</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0103E27B">path-same=
-object</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>left-path</i></tt>
and
<tt><i>right-path</i></tt>
resolve to the same filesystem object: the same inode number on the same
device.
</p><p>
</p></dd></dl>
<a name=3D"N-01ED65C8">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63">9.63</a> Un=
ix Credentials</h3>



<p>


</p><p>

<a name=3D"N-00125C22">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63.1">9.63.=
1</a> Functions <tt>getuid</tt>, <tt>geteuid</tt>, <tt>getgid</tt> and <tt>=
getegid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getuid)=20




<br>&nbsp;&nbsp;(geteuid)=20




<br>&nbsp;&nbsp;(getgid)=20




<br>&nbsp;&nbsp;(getegid)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions directly correspond to the POSIX C library functions
of the same name. They retrieve the real user ID, effective user ID,
real group ID and effective group ID, respectively, of the calling
process.
</p><p>

</p></dd></dl>
<a name=3D"N-03897D65">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63.2">9.63.2</a=
> Functions <tt>setuid</tt>, <tt>seteuid</tt>, <tt>setgid</tt> and <tt>sete=
gid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(setuid </tt><tt><i>uid</i></tt><tt>)=20




<br>&nbsp;&nbsp;(seteuid </tt><tt><i>uid</i></tt><tt>)=20




<br>&nbsp;&nbsp;(setgid </tt><tt><i>gid</i></tt><tt>)=20




<br>&nbsp;&nbsp;(setegid </tt><tt><i>gid</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions directly correspond to the POSIX C library functions
of the same name. They set the real user ID, effective user ID,
real group ID and effective group ID, respectively, of the calling
process.
On success, they return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
On failure, they throw an exception of type
<tt>system-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-030FEE9B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63.3">9.63.3</a=
> Function <tt>getgroups</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getgroups)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030FEE9B">getgroups=
</a></tt>
function retrieves the list of supplementary group IDs of the calling
process by calling the same-named POSIX C library function.
</p><p>
Whether or not the effective group ID retrieved by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00125C22">getegid</=
a></tt>
is included in this list is system-dependent. Programs should not
depend on its presence or absence.
</p><p>

</p></dd></dl>
<a name=3D"N-030FEE97">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63.4">9.63.4</a=
> Function <tt>setgroups</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(setgroups </tt><tt><i>gid-list</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030FEE97">setgroups=
</a></tt>
function corresponds to a C library function found in some Unix
operating systems, complementary to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030FEE9B">getgroups=
</a></tt>
function. The argument to
<tt><i>gid-list</i></tt>
must be a list of numeric group IDs.
If the function is successful, this list is installed as the list of
supplementary group IDs of the calling process, and the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.
On failure, it throws an exception of type
<tt>system-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03D37234">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63.5">9.63.5</a=
> Functions <tt>getresuid</tt> and <tt>getresgid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getresuid)=20




<br>&nbsp;&nbsp;(getresgid)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions directly correspond to the POSIX C library functions
of the same names available in some Unix operating systems.
Each function retrieves a three element list of numeric IDs.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D37234">getresuid=
</a></tt>
function retrieves the real, effective and saved user ID of
the calling process.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D37234">getresgid=
</a></tt>
function retrieves the real, effective and saved group ID of
the calling process.
</p><p>

</p></dd></dl>
<a name=3D"N-027671E8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.63.6">9.63.6</a=
> Functions <tt>setresuid</tt> and <tt>setresgid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(setresuid </tt><tt><i>real-uid</i></tt><tt> </tt><tt><i>ef=
fective-uid</i></tt><tt> </tt><tt><i>saved-uid</i></tt><tt>)=20




<br>&nbsp;&nbsp;(setresgid </tt><tt><i>real-gid</i></tt><tt> </tt><tt><i>ef=
fective-gid</i></tt><tt> </tt><tt><i>saved-gid</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions directly correspond to the POSIX C library functions of the
same names available in some Unix operating systems.  They change the real,
effective and saved user ID or group ID, respectively, of the calling proce=
ss.
</p><p>
A value of -1 for any of the IDs specifies that the ID is not to be changed=
.
</p><p>
Only privileged processes may arbitrarily change IDs to different values.
</p><p>
Unprivileged processes are restricted in the following way:
each of the new IDs that is replaced must have a new value which is equal t=
o
one of the existing three IDs.
</p><p>
</p></dd></dl>
<a name=3D"N-031CBEFD">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.64">9.64</a> Un=
ix Password Database</h3>



<p>


</p><p>

<a name=3D"N-036B0636">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.64.1">9.64.=
1</a> Structure <tt>passwd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct passwd nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; name passwd uid gid=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; gecos dir shell)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B0636">passwd</a=
></tt>
structure corresponds to the C type
<tt>struct passwd</tt>.
Objects of this struct are produced by the password database
query functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0377C43A">getpwent<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E528C6">getpwuid<=
/a></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03552854">getpwnam<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0377C43A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.64.2">9.64.2</a=
> Functions <tt>getpwent</tt>, <tt>setpwent</tt> and <tt>endpwent</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getpwent)=20




<br>&nbsp;&nbsp;(setpwent)=20




<br>&nbsp;&nbsp;(endpwent)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The first time
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0377C43A">getpwent<=
/a></tt>
function is called, it returns the first password database entry.
On subsequent calls it returns successive entries.
Entries are returned as instances of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B0636">passwd</a=
></tt>
structure.  If the function cannot retrieve an entry for any reason,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0377C43A">setpwent<=
/a></tt>
function rewinds the database scan.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0377C43A">endpwent<=
/a></tt>
function releases the resources associated with the scan.
</p><p>

</p></dd></dl>
<a name=3D"N-03E528C6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.64.3">9.64.3</a=
> Function <tt>getpwuid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getpwuid </tt><tt><i>uid</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E528C6">getpwuid<=
/a></tt>
searches the password database for an entry whose user ID field
is equal to the numeric
<tt><i>uid</i></tt>.
If the search is successful, then a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B0636">passwd</a=
></tt>
structure representing the database entry is returned.
If the search fails,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03552854">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.64.4">9.64.4</a=
> Function <tt>getpwnam</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getpwnam </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03552854">getpwnam<=
/a></tt>
searches the password database for an entry whose user name
is equal to
<tt><i>name</i></tt>.
If the search is successful, then a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B0636">passwd</a=
></tt>
structure representing the database entry is returned.
If the search fails,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
</p></dd></dl>
<a name=3D"N-01BD99A2">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.65">9.65</a> Un=
ix Group Database</h3>



<p>


</p><p>

<a name=3D"N-03DE71BA">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.65.1">9.65.=
1</a> Structure <tt>group</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct group nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; name passwd gid mem)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DE71BA">group</a>=
</tt>
structure corresponds to the C type
<tt>struct group</tt>.
Objects of this struct are produced by the password database
query functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAC7FB">getgrent<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E5634E">getgrgid<=
/a></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03556394">getgrnam<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02CAC7FB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.65.2">9.65.2</a=
> Functions <tt>getgrent</tt>, <tt>setgrent</tt> and <tt>endgrent</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getgrent)=20




<br>&nbsp;&nbsp;(setgrent)=20




<br>&nbsp;&nbsp;(endgrent)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The first time
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAC7FB">getgrent<=
/a></tt>
function is called, it returns the first group database entry.
On subsequent calls it returns successive entries.
Entries are returned as instances of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036B0636">passwd</a=
></tt>
structure.  If the function cannot retrieve an entry for any reason,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAC7FB">setgrent<=
/a></tt>
function rewinds the database scan.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAC7FB">endgrent<=
/a></tt>
function releases the resources associated with the scan.
</p><p>

</p></dd></dl>
<a name=3D"N-03E5634E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.65.3">9.65.3</a=
> Function <tt>getgrgid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getgrgid </tt><tt><i>gid</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E5634E">getgrgid<=
/a></tt>
searches the group database for an entry whose group ID field
is equal to the numeric
<tt><i>gid</i></tt>.
If the search is successful, then a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DE71BA">group</a>=
</tt>
structure representing the database entry is returned.
If the search fails,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-03556394">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.65.4">9.65.4</a=
> Function <tt>getgrnam</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getgrnam </tt><tt><i>name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03556394">getgrnam<=
/a></tt>
searches the group database for an entry whose group name
is equal to
<tt><i>name</i></tt>.
If the search is successful, then a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DE71BA">group</a>=
</tt>
structure representing the database entry is returned.
If the search fails,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
</p></dd></dl>
<a name=3D"N-023364EA">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.66">9.66</a> Un=
ix Password Hashing</h3>



<p>



<a name=3D"N-00F928CE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.66.1">9.66.=
1</a> Function <tt>crypt</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(crypt </tt><tt><i>key</i></tt><tt> </tt><tt><i>salt</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F928CE">crypt</a>=
</tt>
function is a wrapper for the Unix C library function of the same name.
It calculates a hash over the
<tt><i>key</i></tt>
and
<tt><i>salt</i></tt>
arguments, which are strings. The hash is returned as a string.
</p><p>
The
<tt><i>key</i></tt>
and
<tt><i>salt</i></tt>
arguments are converted into UTF-8 prior to being passed into the underlyin=
g
platform function. The hash value is assumed to be UTF-8 and converted to
Unicode characters, though it is not expected to contain anything but 7
bit ASCII characters.
</p><p>
Note: the underlying C library function uses a static buffer for its return
value. The return value of the <b>TXR Lisp</b> function is a copy of that b=
uffer.
</p><p>
</p></dd></dl>
<a name=3D"N-010CFD89">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67">9.67</a> Un=
ix Signal Handling</h3>



<p>


</p><p>
On platforms where certain advanced features of POSIX signal handling are
available at the C API level, <b>TXR</b> exposes signal-handling functional=
ity.
</p><p>
A <b>TXR</b> program can install a <b>TXR Lisp</b> function (such as an ano=
nymous.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
or the function object associated with a named function) as the handler for
a signal.
</p><p>
When that signal is delivered, <b>TXR</b> will intercept it with its own sa=
fe,
internal handler, mark the signal as deferred (in a <b>TXR</b> sense) and t=
hen
dispatch the registered function at a convenient time.
</p><p>
Handlers currently are not permitted to interrupt the execution of most
<b>TXR</b> internal code.  Immediate, asynchronous execution of handlers is
currently enabled only while <b>TXR</b> is blocked on I/O operations or sle=
eping.
Additionally, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0360A99A">sig-check=
</a></tt>
function can be used to dispatch and clear deferred
signals. These handlers are then safely called if they were subroutines of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0360A99A">sig-check=
</a></tt>,
and not asynchronous interrupts.
</p><p>

<a name=3D"N-0176430F">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67.1">9.67.=
1</a> Variables <tt>sig-hup</tt>, <tt>sig-int</tt>, <tt>sig-quit</tt>, <tt>=
sig-ill</tt>, <tt>sig-trap</tt>, <tt>sig-abrt</tt>, <tt>sig-bus</tt>, <tt>s=
ig-fpe</tt>, <tt>sig-kill</tt>, <tt>sig-usr1</tt>, <tt>sig-segv</tt>, <tt>s=
ig-usr2</tt>, <tt>sig-pipe</tt>, <tt>sig-alrm</tt>, <tt>sig-term</tt>, <tt>=
sig-chld</tt>, <tt>sig-cont</tt>, <tt>sig-stop</tt>, <tt>sig-tstp</tt>, <tt=
>sig-ttin</tt>, <tt>sig-ttou</tt>, <tt>sig-urg</tt>, <tt>sig-xcpu</tt>, <tt=
>sig-xfsz</tt>, <tt>sig-vtalrm</tt>, <tt>sig-prof</tt>, <tt>sig-poll</tt>, =
<tt>sig-sys</tt>, <tt>sig-winch</tt>, <tt>sig-iot</tt>, <tt>sig-stkflt</tt>=
, <tt>sig-io</tt>, <tt>sig-lost</tt> and <tt>sig-pwr</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the C signal constants
<tt>SIGHUP</tt>,
<tt>SIGINT</tt>
and so forth.
The variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-winch=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-iot</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-stkfl=
t</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-io</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-lost<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-pwr</=
a></tt>
may not be available since a system may lack the corresponding signal
constants. See notes for the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-authp=
riv</a></tt>.
</p><p>
The highest signal number is 31.
</p><p>

</p></dd></dl>
<a name=3D"N-02E1B6FA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67.2">9.67.2</a=
> Functions <tt>set-sig-handler</tt> and <tt>get-sig-handler</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(set-sig-handler </tt><tt><i>signal-number</i></tt><tt> </t=
t><tt><i>handling-spec</i></tt><tt>)=20




<br>&nbsp;&nbsp;(get-sig-handler </tt><tt><i>signal-number</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E1B6FA">set-sig-h=
andler</a></tt>
function is used to specify the handling for a signal, such
as the installation of a handler function. It updates the signal handling f=
or
a signal whose number is
<tt><i>signal-number</i></tt>
(usually one of the constants like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-hup</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-int</=
a></tt>
and so forth), and returns the previous value.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E1B6FA">get-sig-h=
andler</a></tt>
function returns the current value.
</p><p>
The
<tt><i>signal-number</i></tt>
must be an integer the range 1 to 31.
</p><p>
Initially, all 31 signal handling specifications are set to the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The
<tt><i>handling-spec</i></tt>
parameter may be a function. If a function is specified,
then the signal is enabled and connected to that function until another
call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E1B6FA">set-sig-h=
andler</a></tt>
changes the handling for that signal.
</p><p>
If
<tt><i>handling-spec</i></tt>
is the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the function previously associated
with the signal, if any, is removed, and the signal is disabled. For a sign=
al
to be disabled means that the signal is set to the
<tt>SIG_IGN</tt>
disposition (refer to the C API).
</p><p>
If
<tt><i>handling-spec</i></tt>
is the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
then the function previously associated
with the signal, if any, is removed, and the signal is set to its default
disposition. This means that it is set to
<tt>SIG_DFL</tt>
(refer to the C API).
Some signals terminate the process if they are generated while the
handling is configured to the default disposition.
</p><p>
Note that the certain signals like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-quit<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-kill<=
/a></tt>
cannot be ignored or handled.
Please observe the signal documentation in the IEEE POSIX standard, and you=
r
platform.
</p><p>
A signal handling function must take two arguments. It is of the form:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">=
lambda</a> (</tt><tt><i>signal</i></tt><tt> </tt><tt><i>async-p</i></tt><tt=
>) ...)=20

</tt>

</p><p>
The
<tt><i>signal</i></tt>
argument is an integer indicating the signal number for which the
handler is being invoked. The
<tt><i>asyncp-p</i></tt>
argument is a Boolean value.
If it is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
it indicates that the handler is being invoked
asynchronously=E2=80=94directly in a signal handling context.  If it is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then it
is a deferred call.  Handlers may do more things in a deferred call, such
as terminate by throwing exceptions, and perform I/O.
</p><p>
The return value of a handler is normally ignored. However if it invoked
asynchronously (the
<tt><i>async-p</i></tt>
argument is true), then if the handler returns
a
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
value, it is understood that the handler
requesting that it be deferred. This means that the signal will be marked
as deferred, and the handler will be called again at some later
time in a deferred context, whereby
<tt><i>async-p</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
This is not guaranteed, however;
it's possible that another signal will arrive before that happens,
possibly resulting in another async call, so the handler must
be prepared to deal with an async call at any time.
</p><p>
If a handler is invoked synchronously, then its return value is ignored.
</p><p>
In the current implementation, signals do not queue. If a signal is deliver=
ed
to the process again, while it is marked as deferred, it simply stays defer=
red;
there is no counter associated with a signal, only a Boolean flag.
</p><p>

</p></dd></dl>
<a name=3D"N-0360A99A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67.3">9.67.3</a=
> Function <tt>sig-check</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sig-check)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0360A99A">sig-check=
</a></tt>
function tests whether any signals are deferred, and for each
deferred signal in turn, it executes the corresponding handler.  For a sign=
al to
be deferred means that the signal was caught by an internal handler in
<b>TXR</b> and the event was recorded by a flag.  If a handler function is =
removed
while a signal is deferred, the deferred flag is cleared for that signal.
</p><p>
Calls to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0360A99A">sig-check=
</a></tt>
function may be inserted into CPU-intensive code that
has no opportunity to be interrupted by signals, because it doesn't invoke =
any
I/O functions.
</p><p>

</p></dd></dl>
<a name=3D"N-0108FFCE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67.4">9.67.4</a=
> Function <tt>raise</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(raise </tt><tt><i>signal</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0108FFCE">raise</a>=
</tt>
function sends
<tt><i>signal</i></tt>
to the process.
It is a wrapper for the C function of the same name.
</p><p>
The return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the function succeeds, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0386CCD5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67.5">9.67.5</a=
> Function <tt>kill</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(kill </tt><tt><i>process-id</i></tt><tt> [</tt><tt><i>sign=
al</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386CCD5">kill</a><=
/tt>
function is used for sending a signal to a process group or process.
It is a wrapper for the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386CCD5">kill</a><=
/tt>
function.
</p><p>
If the
<tt><i>signal</i></tt>
argument is omitted, it defaults to the same value as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0176430F">sig-term<=
/a></tt>.
</p><p>
The return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the function succeeds, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00234BED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.67.6">9.67.6</a=
> Function <tt>strsignal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(strsignal </tt><tt><i>signal</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00234BED">strsignal=
</a></tt>
function returns a character string describing the specified signal number.
It is based on the same-named POSIX C library function.
</p><p>
</p></dd></dl>
<a name=3D"N-00DF1BD2">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68">9.68</a> Un=
ix Processes</h3>



<p>


</p><p>

<a name=3D"N-0365C3E1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68.1">9.68.=
1</a> Functions <tt>fork</tt> and <tt>wait</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fork)=20




<br>&nbsp;&nbsp;(wait [</tt><tt><i>pid</i></tt><tt> [</tt><tt><i>flags</i><=
/tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">fork</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">wait</a><=
/tt>
functions are interfaces to the Unix functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">fork</a><=
/tt>
and
<tt>waitpid</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">fork</a><=
/tt>
function creates a child process which is a replica of the parent. Both
processes return from the function. In the child process, the return value =
is
zero. In the parent, it is an integer representing the process ID of the ch=
ild.
If the function fails to create a child, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
rather than an integer. In this case, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
function can be used to inquire about the cause.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">wait</a><=
/tt>
function, if successful, returns a cons cell consisting of a pair of intege=
rs.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
of the cons is the process ID of the process or group which was successfull=
y
waited on, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is the status. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">wait</a><=
/tt>
fails, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
function can be used to inquire about the cause.
</p><p>
The
<tt><i>process-id</i></tt>
argument, if not supplied, defaults to -1, which means that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">wait</a><=
/tt>
waits for any process, rather than a specific process. Certain other
values have special meaning, as documented in the POSIX standard
for the
<tt>waitpid</tt>
function.
</p><p>
The
<tt><i>flags</i></tt>
argument defaults to zero. If it is specified as nonzero, it should be
a bitwise combination (via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function) of the variables
<tt>w-nohang</tt>,
<tt>w-untraced</tt>
and
<tt>w-continued</tt>.
If
<tt>w-nohang</tt>
is used, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">wait</a><=
/tt>
returns a cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
specifies a process ID value of zero in the situation that at least
one of the processes designated by
<tt>process-id</tt>
exist and are children of the calling process, but have not changed state.
In this case, the status value in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is unspecified.
</p><p>
Status values may be inspected with the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-ifexite=
d</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-exitsta=
tus</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-ifsigna=
led</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-termsig=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-coredum=
p</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-ifstopp=
ed</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-stopsig=
</a></tt>
and
<tt>w-ifcontinued</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0243C575">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68.2">9.68.2</a=
> Functions <tt>w-ifexited</tt>, <tt>w-exitstatus</tt>, <tt>w-ifsignaled</t=
t>, <tt>w-termsig</tt>, <tt>w-coredump</tt>, <tt>w-ifstopped</tt> and <tt>w=
-stopsig</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(w-ifexited </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-exitstatus </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-ifsignaled </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-termsig </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-coredump </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-ifstopped </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-stopsig </tt><tt><i>status</i></tt><tt>)=20




<br>&nbsp;&nbsp;(w-ifcontinued </tt><tt><i>status</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions analyze process exit values produced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0365C3E1">wait</a><=
/tt>
function.
</p><p>
They are closely based on the
POSIX macros
<tt>WIFEXITED</tt>,
<tt>WEXITSTATUS</tt>,
and so on.
</p><p>
The
<tt><i>status</i></tt>
value is either an integer, or a cons cell. In this case, the cons
cell is expected to have an integer in its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
which is used as the status.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-ifexite=
d</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-ifsigna=
led</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-coredum=
p</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0243C575">w-ifstopp=
ed</a></tt>
and
<tt>w-ifcontinued</tt>
functions have Lisp Boolean return semantics, unlike their C language
counterparts: they return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
rather than zero or nonzero. The others return integer values.
</p><p>

</p></dd></dl>
<a name=3D"N-02D6C913">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68.3">9.68.3</a=
> Function <tt>exec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exec </tt><tt><i>file</i></tt><tt> [</tt><tt><i>args</i></=
tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The exec function replaces the process image with the executable specified
by string argument
<tt><i>file</i></tt>.
The executable is found by searching the system path.
</p><p>
The
<tt><i>file</i></tt>
argument becomes the first argument of the executable, argument zero.
</p><p>
If
<tt><i>args</i></tt>
is specified, it is a list of strings. These are passed as the additional
arguments of the executable.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6C913">exec</a><=
/tt>
fails, an exception of type
<tt>file-error</tt>
is thrown.
</p><p>

</p></dd></dl>
<a name=3D"N-03592671">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68.4">9.68.4</a=
> Function <tt>exit*</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(exit* </tt><tt><i>status</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03592671">exit*</a>=
</tt>
function terminates the entire process (running <b>TXR</b> image), specifyi=
ng
the termination status to the operating system. The
<tt><i>status</i></tt>
argument is treated exactly like that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C92F">exit</a><=
/tt>
function. Unlike that function, this one exits the process immediately,
cleaning up only low-level operating system resources such as closing file
descriptors and releasing memory mappings, without performing user-space
cleanup.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03592671">exit*</a>=
</tt>
is implemented using a call to the POSIX function
<tt>_exit</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02D7B5A3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68.5">9.68.5</a=
> Functions <tt>getpid</tt> and <tt>getppid</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getpid)=20




<br>&nbsp;&nbsp;(getppid)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions retrieve the current process ID and the parent process ID
respectively. They are wrappers for the POSIX functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D7B5A3">getpid</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D7B5A3">getppid</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-017C3515">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.68.6">9.68.6</a=
> Function <tt>daemon</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(daemon </tt><tt><i>nochdir-p</i></tt><tt> </tt><tt><i>nocl=
ose-p</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



This is a wrapper for the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017C3515">daemon</a=
></tt>
which originated in BSD Unix.
</p><p>
It returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if successful,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
otherwise, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
variable is set in that case.
</p><p>
</p></dd></dl>
<a name=3D"N-00C41E8E">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69">9.69</a> Un=
ix File Descriptors</h3>



<p>


</p><p>

<a name=3D"N-02BEAF24">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.1">9.69.=
1</a> Function <tt>open-fileno</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-fileno </tt><tt><i>file-descriptor</i></tt><tt> [</tt=
><tt><i>mode-string</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BEAF24">open-file=
no</a></tt>
function creates a <b>TXR</b> stream over a file descriptor. The
<tt><i>file-descriptor</i></tt>
argument must be an integer denoting a valid file descriptor.
</p><p>
For a description of
<tt><i>mode-string</i></tt>,
see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-008ACF75">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.2">9.69.2</a=
> Function <tt>fileno</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fileno </tt><tt><i>stream</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function returns the underlying file descriptor of
<tt><i>stream</i></tt>,
if it has one. Otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
This is equivalent to querying the stream using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005268C8">stream-ge=
t-prop</a></tt>
for the
<tt>:fd</tt>
property.
</p><p>

</p></dd></dl>
<a name=3D"N-01F91AEF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.3">9.69.3</a=
> Function <tt>dupfd</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dupfd </tt><tt><i>old-fileno</i></tt><tt> [</tt><tt><i>new=
-fileno</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F91AEF">dupfd</a>=
</tt>
function provides an interface to the POSIX functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0387F549">dup</a></=
tt>
or
<tt>dup2</tt>,
when called with one or two arguments, respectively.
</p><p>

</p></dd></dl>
<a name=3D"N-03F6D390">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.4">9.69.4</a=
> Function <tt>pipe</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pipe)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F6D390">pipe</a><=
/tt>
function, if successful, returns a pair of integer file descriptors
as a cons cell pair. The descriptor in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field of the pair is the read end of the pipe.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
holds the write end.
</p><p>
If the function fails, it throws an exception of type
<tt>file-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01094176">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.5">9.69.5</a=
> Function <tt>close</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(close </tt><tt><i>fileno</i></tt><tt> [
 throw-on-error-p ])</tt><tt><i></i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>
function passes the integer descriptor
<tt><i>fileno</i></tt>
to the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>
function.  If the operation is successful, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned. Otherwise an exception of type
<tt>file-error</tt>
is thrown, unless the
<tt><i>throw-on-error-p</i></tt>
argument is present, with a true value. In that case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>
indicates failure by returning
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0386D39D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.6">9.69.6</a=
> Function <tt>poll</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(poll </tt><tt><i>poll-list</i></tt><tt> [</tt><tt><i>timeo=
ut</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386D39D">poll</a><=
/tt>
function suspends execution while monitoring one or more file descriptors
for specified events. It is a wrapper for the same-named POSIX function.
</p><p>
The
<tt><i>poll-list</i></tt>
argument is a sequence of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a><=
/tt>
pairs. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
of each pair is either an integer file descriptor, or else a stream
object which has a file descriptor (the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008ACF75">fileno</a=
></tt>
function can be applied to that stream to retrieve a descriptor).
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of each pair is an integer bit mask specifying the events, whose
occurrence the file descriptor is to be monitored for. The variables
<tt>poll-in</tt>,
<tt>poll-out</tt>,
<tt>poll-err</tt>
and several others are available which hold bitmask values corresponding
to the constants
<tt>POLLIN</tt>,
<tt>POLLOUT</tt>,
<tt>POLLERR</tt>
used with the C language
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386D39D">poll</a><=
/tt>
function.
</p><p>
The
<tt><i>timeout</i></tt>
argument, if absent, defaults to the value -1, which specifies an indefinit=
e
wait. A nonnegative value specifies a wait with a timeout, measured in
milliseconds.
</p><p>
The function returns a list of pairs representing the descriptors or stream=
s
which were successfully polled. If the function times out, it returns an
empty list. If an error occurs, an exception is thrown.
</p><p>
The returned list is similar in structure to the input list. However, it ho=
lds
only entries which polled positive. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of every pair now holds a bitmask of the events which were to have occurred=
.
</p><p>

</p></dd></dl>
<a name=3D"N-03709E8A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.69.7">9.69.7</a=
> Function <tt>isatty</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(isatty </tt><tt><i>stream</i></tt><tt>)=20




<br>&nbsp;&nbsp;(isatty </tt><tt><i>fileno</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03709E8A">isatty</a=
></tt>
function provides access to the underlying POSIX function of the same name.
</p><p>
If the argument is a
<tt><i>stream</i></tt>
object which has a
<tt>:fd</tt>
property, then the file descriptor number is retrieved. The behavior is
then as if that descriptor number were passed as the
<tt><i>fileno</i></tt>
argument.
</p><p>
If the argument is not a
<tt><i>stream</i></tt>,
it must be a
<tt><i>fileno</i></tt>:
an integer in the representation range of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
</p><p>
The POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03709E8A">isatty</a=
></tt>
is invoked on this integer. If it that returns 1, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned, otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-012E8480">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70">9.70</a> Un=
ix File Control</h3>



<p>


</p><p>

<a name=3D"N-034BF6C9">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.1">9.70.=
1</a> Variables <tt>o-accmode</tt>, <tt>o-rdonly</tt>, <tt>o-wronly</tt>, <=
tt>o-rdwr</tt>, <tt>o-creat</tt>, <tt>o-noctty</tt>, <tt>o-trunc</tt>, <tt>=
o-append</tt>, <tt>o-nonblock</tt>, <tt>o-sync</tt>, <tt>o-async</tt>, <tt>=
o-directory</tt>, <tt>o-nofollow</tt>, <tt>o-cloexec</tt>, <tt>o-direct</tt=
>, <tt>o-noatime</tt> and <tt>o-path</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the POSIX file mode constants
<tt>O_ACCMODE</tt>,
<tt>O_RDONLY</tt>,
<tt>O_WRONLY</tt>,
<tt>O_RDWR</tt>,
<tt>O_CREAT</tt>,
<tt>O_NOCTTY</tt>,
and so forth.
</p><p>
The availability of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-async</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-directo=
ry</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-nofollo=
w</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-cloexec=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-direct<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-noatime=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034BF6C9">o-path</a=
></tt>
depends on the host platform.
</p><p>
Some of these flags may be set or cleared on an existing file descriptor
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-setfl</=
a></tt>
command of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
function, in accordance with POSIX and the host platform documentation.
</p><p>

</p></dd></dl>
<a name=3D"N-01D6E4D8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.2">9.70.2</a=
> Variables <tt>seek-set</tt>, <tt>seek-cur</tt> and <tt>seek-end</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the ISO C constants
<tt>SEEK_SET</tt>,
<tt>SEEK_CUR</tt>
and
<tt>SEEK_END</tt>.
These values, usually associated with the ISO C
<tt>fseek</tt>
function, are also used in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
file locking interface as values of the
<tt>whence</tt>
member of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004E5B3E">flock</a>=
</tt>
structure.
</p><p>

</p></dd></dl>
<a name=3D"N-025E55E7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.3">9.70.3</a=
> Variables <tt>f-dupfd</tt>, <tt>f-dupfd-cloexec</tt>, <tt>f-getfd</tt>, <=
tt>f-setfd</tt>, <tt>f-getfl</tt>, <tt>f-setfl</tt>, <tt>f-getlk</tt>, <tt>=
f-setlk</tt> and <tt>f-setlkw</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
command constants
<tt>F_DUPFD</tt>,
<tt>F_GETFD</tt>,
<tt>F_SETFD</tt>,
and so forth. Availability of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-dupfd-c=
loexec</a></tt>
depends on the host platform.
</p><p>

</p></dd></dl>
<a name=3D"N-021805C2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.4">9.70.4</a=
> Variable <tt>fd-cloexec</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021805C2">fd-cloexe=
c</a></tt>
variable corresponds to the POSIX
<tt>FD_CLOEXEC</tt>
constant. It denotes the flag which may  be set by the
<tt>fd-setfd</tt>
command of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0137046C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.5">9.70.5</a=
> Variables <tt>f-rdlck</tt>, <tt>f-wrlck</tt> and <tt>f-unlck</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the POSIX lock type constants
<tt>F_RDLCK</tt>,
<tt>F_WRLCK</tt>
and
<tt>F_UNLCK</tt>.
They specify the possible values of the
<tt>type</tt>
field of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004E5B3E">flock</a>=
</tt>
structure.
</p><p>

</p></dd></dl>
<a name=3D"N-004E5B3E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.6">9.70.6</a=
> Structure <tt>flock</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct flock nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; type whence=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; start len=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; pid)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004E5B3E">flock</a>=
</tt>
structure corresponds to the POSIX structure of the same name.
An instance of this structure must be specified as the third
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
function when the
<tt><i>command</i></tt>
argument is one of the values
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-getlk</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-setlk</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-setlkw<=
/a></tt>.
</p><p>
All slots must be initialized with appropriate values before
calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
with the exception that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-getlk</=
a></tt>
command does not access the existing value of the
<tt>pid</tt>
slot.
</p><p>

</p></dd></dl>
<a name=3D"N-03793032">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.70.7">9.70.7</a=
> Function <tt>fcntl</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fcntl </tt><tt><i>fileno</i></tt><tt> </tt><tt><i>command<=
/i></tt><tt> [</tt><tt><i>arg</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
function corresponds to the same-named POSIX function.
The
<tt><i>fileno</i></tt>
and
<tt><i>command</i></tt>
arguments must be integers.
The <b>TXR Lisp</b><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
008ACF75">fileno</a></tt>
restricts the
<tt><i>command</i></tt>
argument to the supported values for which symbolic variable names are prov=
ided.
Other integer
<tt><i>command</i></tt>
values are rejected by returning -1 and setting the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
variable to
<tt>EINVAL</tt>.
Whether the third argument is required, and what type it must be, depends o=
n the
<tt><i>command</i></tt>
value. Commands not requiring the third argument ignore it if it is passed.
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
commands for which POSIX requires an argument of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">long</a><=
/tt>
require
<tt><i>arg</i></tt>
to be an integer.
</p><p>
The file locking commands
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-getlk</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-setlk</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025E55E7">f-setlkw<=
/a></tt>
require
<tt><i>arg</i></tt>
to be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004E5B3E">flock</a>=
</tt>
structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03793032">fcntl</a>=
</tt>
function doesn't throw an error if the underlying POSIX function indicates
failure; the underlying function's return value is converted to a Lisp inte=
ger
and returned.
</p><p>
</p></dd></dl>
<a name=3D"N-039EFF20">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.71">9.71</a> Un=
ix Itimers</h3>



<p>


Itimers ("interval timers") can be used in combination with signal handling=
 to
execute asynchronous actions. Itimers deliver delayed, one-time signals,
and also periodically recurring signals. For more information, consult the
POSIX specification.
</p><p>

<a name=3D"N-02B7882A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.71.1">9.71.=
1</a> Variables <tt>itimer-real</tt>, <tt>itimer-virtual</tt> and <tt>itime=
r-prof</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables correspond to the POSIX constants
<tt>ITIMER_REAL</tt>,
<tt>ITIMER_VIRTUAL</tt>
and
<tt>ITIMER_PROF</tt>.
Their values are suitable as the
<tt><i>timer</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DE107D">getitimer=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DE107D">setitimer=
</a></tt>
functions.
</p><p>

</p></dd></dl>
<a name=3D"N-02DE107D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.71.2">9.71.2</a=
> Functions <tt>getitimer</tt> and <tt>setitimer</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getitimer </tt><tt><i>timer</i></tt><tt>)=20




<br>&nbsp;&nbsp;(setitimer </tt><tt><i>timer</i></tt><tt> </tt><tt><i>inter=
val</i></tt><tt> </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DE107D">getitimer=
</a></tt>
function returns the current value of the specified timer,
which must be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B7882A">itimer-re=
al</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B7882A">itimer-vi=
rtual</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B7882A">itimer-pr=
of</a></tt>.
</p><p>
The current value consists of a list of two integer values, which
represents microseconds. The first value is the timer interval,
and the second value is the timer's current value.
</p><p>
Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DE107D">getitimer=
</a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DE107D">setitimer=
</a></tt>
function also retrieves the specified timer.
In addition, it stores a new value in the timer,
which is given by the two arguments, expressed in microseconds.
</p><p>
</p></dd></dl>
<a name=3D"N-01A58F3E">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72">9.72</a> Un=
ix Syslog</h3>



<p>


</p><p>
On platforms where a Unix-like syslog API is available, <b>TXR</b> exports =
this
interface. <b>TXR</b> programs can configure logging via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AA654">openlog</=
a></tt>
function,
control the logging mask via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085DB47">setlogmas=
k</a></tt>
and generate logs via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02075291">syslog</a=
></tt>,
or using special syslog streams.
</p><p>

<a name=3D"N-02371913">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.1">9.72.=
1</a> Variables <tt>log-pid</tt>, <tt>log-cons</tt>, <tt>log-ndelay</tt>, <=
tt>log-odelay</tt>, <tt>log-nowait</tt> and <tt>log-perror</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables take on the values of the corresponding C preprocessor
constants from the
<tt>&lt;syslog.h&gt;</tt>
header:
<tt>LOG_PID</tt>,
<tt>LOG_CONS</tt>,
etc.
These integer values represent logging options used in the
<tt><i>options</i></tt>
argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AA654">openlog</=
a></tt>
function.
</p><p>
Note:
<tt>LOG_PERROR</tt>
is not in POSIX, and so
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02371913">log-perro=
r</a></tt>
might not be available.
See notes about
<tt>LOG_AUTHPRIV</tt>
in the documentation for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-authp=
riv</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0116F48F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.2">9.72.2</a=
> Special variables <tt>log-user</tt>, <tt>log-daemon</tt>, <tt>log-auth</t=
t> and <tt>log-authpriv</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables take on the values of the corresponding C preprocessor
constants from the
<tt>&lt;syslog.h&gt;</tt>
header:
<tt>LOG_USER</tt>,
<tt>LOG_DAEMON</tt>,
<tt>LOG_AUTH</tt>
and
<tt>LOG_AUTHPRIV</tt>.
These are the integer facility codes specified in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AA654">openlog</=
a></tt>
function.
</p><p>
Note:
<tt>LOG_AUTHPRIV</tt>
is not in POSIX, and so
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-authp=
riv</a></tt>
might not be available.
For portability use code like
<tt>(or (symbol-value 'log-authpriv) 0)</tt>
to evaluate to 0 if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-authp=
riv</a></tt>
doesn't exist, or else check for its existence
using
<tt>(boundp 'log-authpriv)</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-035D75EC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.3">9.72.3</a=
> Variables <tt>log-emerg</tt>, <tt>log-alert</tt>, <tt>log-crit</tt>, <tt>=
log-err</tt>, <tt>log-warning</tt>, <tt>log-notice</tt>, <tt>log-info</tt> =
and <tt>log-debug</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables take on the values of the corresponding C preprocessor
constants from the
<tt>&lt;syslog.h&gt;</tt>
header:
<tt>LOG_EMERG</tt>,
<tt>LOG_ALERT</tt>,
etc.
These are the integer priority codes specified in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02075291">syslog</a=
></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-02841215">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.4">9.72.4</a=
> The <tt>*stdlog*</tt> special variable</h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02841215">*stdlog*<=
/a></tt>
variable holds a special kind of stream: a syslog stream.  Each
newline-terminated line of text sent to this stream becomes a log message.
</p><p>
The stream internally maintains a priority value that is applied
when it generates messages. By default, this value is that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D75EC">log-info<=
/a></tt>.
The stream holds the priority as the value of the
<tt>:prio</tt>
stream property, which may be changed with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005268C8">stream-se=
t-prop</a></tt>
function.
</p><p>
The latest priority value which has been configured on the stream is used
at the time the newline character is processed and the log message
is generated, not necessarily the value which was in effect at the time the
accumulation of a line began to take place.
</p><p>
Messages sent to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02841215">*stdlog*<=
/a></tt>
are delimited by newline characters. That is to say, each line of
text written to the stream is a new log.
</p><p>

</p></dd></dl>
<a name=3D"N-037AA654">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.5">9.72.5</a=
> Function <tt>openlog</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(openlog </tt><tt><i>id-string</i></tt><tt> [</tt><tt><i>op=
tions</i></tt><tt> [</tt><tt><i>facility</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AA654">openlog</=
a></tt>
function is a wrapper for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AA654">openlog</=
a></tt>
C function, and the
arguments have the same semantics. It is not necessary to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AA654">openlog</=
a></tt>
in order
to call the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02075291">syslog</a=
></tt>
function or to write data to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02841215">*stdlog*<=
/a></tt>.
The call is necessary in order to override the default identifying string, =
to
set options, such as having the PID (process ID) recorded in log messages, =
and
to specify the facility.
</p><p>
The
<tt><i>id-string</i></tt>
argument is mandatory.
</p><p>
The
<tt><i>options</i></tt>
argument is a bitwise mask (see the logior function) of option
values such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02371913">log-pid</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02371913">log-cons<=
/a></tt>.
If it is missing, then a value of 0 is
used, specifying the absence of any options.
</p><p>
The
<tt><i>facility</i></tt>
argument is one of the values
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-user<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-daemo=
n</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-auth<=
/a></tt>.
If it is missing, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0116F48F">log-user<=
/a></tt>
is assumed.
</p><p>

</p></dd></dl>
<a name=3D"N-02CEE7EA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.6">9.72.6</a=
> Function <tt>closelog</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(closelog)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CEE7EA">closelog<=
/a></tt>
function is a wrapper for the C function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CEE7EA">closelog<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0085DB47">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.7">9.72.7</a=
> Function <tt>setlogmask</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(setlogmask </tt><tt><i>bitmask-integer</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085DB47">setlogmas=
k</a></tt>
function interfaces to the corresponding C function, and has the
same argument and return value semantics. The
<tt><i>bitmask-integer</i></tt>
argument is a mask of priority
values to enable. The return value is the prior value. Note that if the
argument is zero, then the function doesn't set the mask to zero; it only
returns the current value of the mask.
</p><p>
Note that the priority values like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D75EC">log-emerg=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D75EC">log-debug=
</a></tt>
are integer
enumerations, not bitmasks. These values cannot be combined directly to cre=
ate
a bitmask. Rather, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a><=
/tt>
function should be used on these values.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Enable LOG_EMERG and LOG_ALERT messages,
  ;; suppressing all others
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0085DB47">setlogmask=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0056CEF1">mask</a=
> log-emerg log-alert))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02075291">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.72.8">9.72.8</a=
> Function <tt>syslog</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(syslog </tt><tt><i>priority</i></tt><tt> </tt><tt><i>forma=
t</i></tt><tt> </tt><tt><i>format-arg</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02075291">syslog</a=
></tt>
function is the interface to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02075291">syslog</a=
></tt>
C function. The
<tt>printf</tt>
formatting capabilities of the function are not used;
the
<tt><i>format</i></tt>
argument follows the conventions of the <b>TXR Lisp</b> <tt><a href=3D"http=
://nongnu.org/txr/txr-manpage.html#N-011ACA52">format</a></tt>
function instead. Note in particular that
the
<tt>%m</tt>
convention for interpolating the value of strerror(errno) which is
available in some versions of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02075291">syslog</a=
></tt>
C function is currently not supported.
</p><p>
Note that syslog messages are not newline-terminated.
</p><p>
</p></dd></dl>
<a name=3D"N-036B3694">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.73">9.73</a> Un=
ix Path Globbing</h3>



<p>


</p><p>
On platforms where the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
function is available <b>TXR</b> provides this functionality in
the form of a like-named function, and some numeric constants.
<b>TXR</b> also provides access the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F8FF75">fnmatch</=
a></tt>
function, where available.
</p><p>

<a name=3D"N-0188409B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.73.1">9.73.=
1</a> Variables <tt>glob-err</tt>, <tt>glob-mark</tt>, <tt>glob-nosort</tt>=
, <tt>glob-nocheck</tt>, <tt>glob-noescape</tt>, <tt>glob-period</tt>, <tt>=
glob-altdirfunc</tt>, <tt>glob-brace</tt>, <tt>glob-nomagic</tt>, <tt>glob-=
tilde</tt>, <tt>glob-tilde-check</tt> and <tt>glob-onlydir</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables take on the values of the corresponding C preprocessor
constants from the
<tt>&lt;glob.h&gt;</tt>
header:
<tt>GLOB_ERR</tt>,
<tt>GLOB_MARK</tt>,
<tt>GLOB_NOSORT</tt>,
etc.
</p><p>
These values are passed as the optional second argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
function. They are bitmasks and so multiple values can be combined
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function.
</p><p>
Note that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-peri=
od</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-altd=
irfunc</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-brac=
e</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-noma=
gic</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-tild=
e</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-tild=
e-check</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-only=
dir</a></tt>
variables may not be available. They are extensions in the GNU C library
implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00E6C7DE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.73.2">9.73.2</a=
> Function <tt>glob</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(glob </tt><tt><i>pattern</i></tt><tt> [</tt><tt><i>flags</=
i></tt><tt> [</tt><tt><i>errfun</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
function is a interface to the Unix function of the same name.
The
<tt><i>pattern</i></tt>
argument must be a string, which holds a glob pattern: a pattern which
matches zero or more path names, similar to a regular expression.
The function tries to expand the pattern and return a list of strings
representing the matching path names in the file system.
</p><p>
If there are no matches, then an empty list is returned.
</p><p>
The optional
<tt><i>flags</i></tt>
argument defaults to zero. If given, it may be a bitwise combination of the
values of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-err<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-mark=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0188409B">glob-noso=
rt</a></tt>
and others.
</p><p>
If the
<tt><i>errfun</i></tt>
argument is specified, it gives a callback function which is invoked
when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
encounters errors accessing paths. The function takes two arguments:
the pathname and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
value which occurred for that pathname. The function's return value is
Boolean. If the function returns true, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
will terminate.
</p><p>
The
<tt><i>errfun</i></tt>
may terminate the traversal by a nonlocal exit, such as by throwing
an exception or performing a block return.
</p><p>
The
<tt><i>errfun</i></tt>
may not re-enter the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
function. This situation is detected and diagnosed by an exception.
</p><p>
The
<tt><i>errfun</i></tt>
may not capture a continuation across the error boundary. That is to say,
code invoked from the error may not capture a continuation up to a prompt
which surrounds the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
call. Such an attempt is detected and diagnosed by an exception.
</p><p>
Details of the semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6C7DE">glob</a><=
/tt>
function, and the meaning of all the
<tt><i>flags</i></tt>
arguments are given in the documentation for the C function.
</p><p>

</p></dd></dl>
<a name=3D"N-0330E15A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.73.3">9.73.3</a=
> Variables <tt>fnm-pathname</tt>, <tt>fnm-noescape</tt>, <tt>fnm-period</t=
t>, <tt>fnm-leading-dir</tt>, <tt>fnm-casefold</tt> and <tt>fnm-extmatch</t=
t></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables take on the values of the corresponding C preprocessor
constants from the
<tt>&lt;fnmatch.h&gt;</tt>
header:
<tt>FNM_PATHNAME</tt>,
<tt>FNM_NOESCAPE</tt>,
<tt>FNM_PERIOD</tt>,
etc.
</p><p>
These values are bit masks which may be combined with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function to form the optional third
<tt><i>flags</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F8FF75">fnmatch</=
a></tt>
function.
</p><p>
Note that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0330E15A">fnm-leadi=
ng-dir</a></tt>,
<tt>fnm-case-fold</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0330E15A">fnm-extma=
tch</a></tt>
may not be available. They are GNU extensions, found in the GNU C library.
</p><p>

</p></dd></dl>
<a name=3D"N-03F8FF75">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.73.4">9.73.4</a=
> Function <tt>fnmatch</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fnmatch </tt><tt><i>pattern</i></tt><tt> </tt><tt><i>strin=
g</i></tt><tt> [</tt><tt><i>flags</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F8FF75">fnmatch</=
a></tt>
function, if available, provides access
to the like-named POSIX C library function.
The
<tt><i>pattern</i></tt>
argument specifies a POSIX-shell-style file pattern matching expression.
Its exact features and dialect are controlled by
<tt><i>flags</i></tt>.
If
<tt><i>string</i></tt>
matches
<tt><i>pattern</i></tt>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned. If there is no match, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned. If the C function indicates that an error has occurred,
an exception is thrown.
</p><p>
</p></dd></dl>
<a name=3D"N-011FF2B6">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74">9.74</a> Un=
ix Filesystem Traversal</h3>



<p>


</p><p>
On platforms where the POSIX
<tt>nftw</tt>
function is available <b>TXR</b> provides this functionality in
the form of the analogous Lisp function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>,
accompanied by some numeric constants.
</p><p>
Likewise, on platforms where the POSIX functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024AA6F4">opendir</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
are available, <b>TXR</b> provides the functionality in the form of same-na=
med
Lisp functions, a structure type named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
and some accompanying numeric constants.
</p><p>

<a name=3D"N-01A802F2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.1">9.74.=
1</a> Variables <tt>ftw-phys</tt>, <tt>ftw-mount</tt>, <tt>ftw-chdir</tt>, =
<tt>ftw-depth</tt> and <tt>ftw-actionretval</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold numeric values that may be combined into a single
bitmask bitmask value using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function. This value is suitable as the
<tt><i>flags</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
function.
</p><p>
These variables corresponds to the C constants
<tt>FTW_PHYS</tt>,
<tt>FTW_MOUNT</tt>,
<i>et cetera</i>.

</p><p>
Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A802F2">ftw-actio=
nretval</a></tt>
is a GNU extension that is not available on all platforms. If the platform'=
s
<tt>nftw</tt>
function doesn't have this feature, then this variable is not defined.
</p><p>

</p></dd></dl>
<a name=3D"N-02ED8B51">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.2">9.74.2</a=
> Variables <tt>ftw-f</tt>, <tt>ftw-d</tt>, <tt>ftw-dnr</tt>, <tt>ftw-ns</t=
t>, <tt>ftw-sl</tt>, <tt>ftw-dp</tt> and <tt>ftw-sln</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables provide symbolic names for the integer values that are
passed as the
<tt>type</tt>
argument of the callback function called by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>.
This argument classifies the kind of file system node visited, or
error condition encountered.
</p><p>
These variables correspond to the C constants
<tt>FTW_F</tt>,
<tt>FTW_D</tt>,
<i>et cetera</i>.

</p><p>
Not all of them are present. If the underlying platform doesn't have
a given constant, then the corresponding variable doesn't exist in <b>TXR</=
b>.
</p><p>

</p></dd></dl>
<a name=3D"N-03853999">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.3">9.74.3</a=
> Variables <tt>ftw-continue</tt>, <tt>ftw-stop</tt>, <tt>ftw-skip-subtree<=
/tt> and <tt>ftw-skip-siblings</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables are defined if the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A802F2">ftw-actio=
nretval</a></tt>
is defined.
</p><p>
If the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A802F2">ftw-actio=
nretval</a></tt>
is included in the
<tt><i>flags</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>,
then the callback function can use the values of these variables
as return codes. Ordinarily, the callback returns zero to continue
the search and nonzero to stop.
</p><p>
These variables correspond to the C constants
<tt>FTW_CONTINUE</tt>,
<tt>FTW_STOP</tt>,
<i>et cetera</i>.

</p><p>

</p></dd></dl>
<a name=3D"N-0057F54E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.4">9.74.4</a=
> Function <tt>ftw</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ftw </tt><tt><i>path-or-list</i></tt><tt> </tt><tt><i>call=
backfun</i></tt><tt> [</tt><tt><i>flags</i></tt><tt> [</tt><tt><i>nopenfd</=
i></tt><tt>]])=20




<br>&nbsp;&nbsp;[</tt><tt><i>callbackfun</i></tt><tt> </tt><tt><i>path</i><=
/tt><tt> </tt><tt><i>type</i></tt><tt> </tt><tt><i>stat-struct</i></tt><tt>=
 </tt><tt><i>level</i></tt><tt> </tt><tt><i>base</i></tt><tt>]=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
function provides access to the
<tt>nftw</tt>
POSIX C library function.
</p><p>
Note that the
<tt><i>flags</i></tt>
and
<tt><i>nopenfd</i></tt>
arguments are reversed with respect to the C language interface.
They are both optional;
<tt><i>flags</i></tt>
defaults to zero, and
<tt><i>nopenfd</i></tt>
defaults to 20.
</p><p>
The
<tt><i>path-or-list</i></tt>
argument may be a string specifying the top-level path name that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
shall visit. Or else,
<tt><i>path-or-list</i></tt>
may be a list. If it is a list, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
recursively invokes itself over each of the elements, taking
that element as the
<tt><i>path-or-name</i></tt>
argument of the recursive call, passing down all other argument
values as-is.
The traversal stops when any recursive invocation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
returns a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and that value is returned. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned, the traversal continues with the
application of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
to the next list element, if any.
If the list is completely traversed, and some recursive
invocations of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
then the return value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
If all recursive invocations return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
If the list is empty,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
function walks the filesystem, as directed by the
<tt><i>path-or-list</i></tt>
argument and
<tt><i>flags</i></tt>
bitmask arguments.
</p><p>
For each visited entry, it calls the supplied
<tt><i>callbackfun</i></tt>
function, which receives five arguments. If this function returns
normally, it must return either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
or an integer value in the range of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
function can continue the traversal by returning any non-integer value,
or the integer value zero.
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A802F2">ftw-actio=
nretval</a></tt>
is included in the
<tt><i>flags</i></tt>
bitmask, then the only integer code which continues the traversal without
any special semantics is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03853999">ftw-conti=
nue</a></tt>
and only
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03853999">ftw-stop<=
/a></tt>
stops the traversal.  (Non-integer return values behave like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03853999">ftw-conti=
nue</a></tt>).
</p><p>
The
<tt><i>path</i></tt>
argument of
<tt><i>callbackfun</i></tt>
gives the path of the
visited filesystem object.
</p><p>
The
<tt><i>type</i></tt>
argument is an integer code which indicates the kind of
object that is visited, or an error situation in visiting
that filesystem entry.  See the documentation for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED8B51">ftw-f</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED8B51">ftw-d</a>=
</tt>
for possible values.
</p><p>
The
<tt><i>stat-struct</i></tt>
argument provides information about the filesystem object
as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
structure, the same kind of object as what is returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>
function.
</p><p>
The
<tt><i>level</i></tt>
argument is an integer value representing the directory level
depth. This value is obtained from the C structure
<tt>FTW</tt>
in the
<tt>nftw</tt>
C API.
</p><p>
The
<tt><i>base</i></tt>
argument indicates the length of the directory part of the
<tt>path</tt>
argument. Characters in excess of this length are thus the base name of the
visited object, and the expression
<tt>




[</tt><tt><i>path</i></tt><tt> </tt><tt><i>base</i></tt><tt>..:]=20

</tt>

calculates the base name.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
function returns either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
upon successful completion, or an integer value returned by
<tt><i>callbackfun</i></tt>,
as described below.
On failure it throws an exception derived from
<tt>file-error</tt>,
whose specific type is based on analyzing the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
value.
</p><p>
The
<tt><i>callbackfun</i></tt>
may return a value of any type. If it returns a value that is not of intege=
r
type, then zero is returned to the
<tt>nftw</tt>
function and traversal continues. Similarly, traversal continues
if the function returns an integer zero.
</p><p>
If
<tt><i>callbackfun</i></tt>
returns an integer value, that value must be in the range of the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
That
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
value is returned to
<tt>nftw</tt>.
If the value is not zero, and is not -1, then
<tt>nftw</tt>
will terminate, and return that value, which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
then returns. If the value is -1, then
<tt>nftw</tt>
is deemed to have failed, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
will thrown an exception of type
<tt>file-error</tt>,
whose specific type is based on analyzing the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7137C">errno</a>=
</tt>
value. If the value is zero, then the traversal continues.
</p><p>
The
<tt><i>callbackfun</i></tt>
may also terminate the traversal by a nonlocal exit, such as by throwing
an exception or performing a block return.
</p><p>
The
<tt><i>callbackfun</i></tt>
may not re-enter the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
function. This situation is detected and diagnosed by an exception.
</p><p>
The
<tt><i>callbackfun</i></tt>
may not capture a continuation across the callback boundary. That is to say=
,
code invoked from the callback may not capture a continuation up to a promp=
t
which surrounds the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057F54E">ftw</a></=
tt>
call. Such an attempt is detected and diagnosed by an exception.
</p><p>

</p></dd></dl>
<a name=3D"N-036FE5B4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.5">9.74.5</a=
> Structure <tt>dirent</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct dirent nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; name ino type)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



Objects of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure type are returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
slot is a character string giving the name of the directory entry.
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024AA6F4">opendir</=
a></tt>
function's
<tt><i>prefix-p</i></tt>
argument is specified as true,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
operations produce
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structures whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
slot is a path formed by combining the directory path with the directory
entry name.
</p><p>
The
<tt>ino</tt>
slot is an integer giving the inode number of the object named by the
directory entry.
</p><p>
The
<tt>type</tt>
slot indicates the type of the object, which is an integer code. Support fo=
r
this member is platform-dependent. If the directory traversal doesn't provi=
de
the information, then this slot takes on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
value. In this situation, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02507FF2">dirstat</=
a></tt>
function may be used to back-fill the missing information.
</p><p>

</p></dd></dl>
<a name=3D"N-02D8CAF4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.6">9.74.6</a=
> Variables <tt>dt-blk</tt>, <tt>dt-chr</tt>, <tt>dt-dir</tt>, <tt>dt-fifo<=
/tt>, <tt>dt-lnk</tt>, <tt>dt-reg</tt>, <tt>dt-sock</tt> and <tt>dt-unknown=
</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables give the possible type code values exhibited by the
<tt>type</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure.
</p><p>
If the underlying host platform does not feature a
<tt>d_type</tt>
field in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
C structure, then almost all these variables are defined anyway using the v=
alues that they
have on GNU/Linux.
These definitions are useful in conjunction with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02507FF2">dirstat</=
a></tt>
function below.
</p><p>
If the host platform does does not feature a
<tt>d_type</tt>
field in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure, then the variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D8CAF4">dt-unknow=
n</a></tt>
is not defined. Note: the application can take advantage of this this to de=
tect
the situation, in order to conditionally define code in such a way that som=
e
run-time checking is avoided.
</p><p>

</p></dd></dl>
<a name=3D"N-024AA6F4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.7">9.74.7</a=
> Function <tt>opendir</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(opendir </tt><tt><i>dir-path</i></tt><tt> [</tt><tt><i>pre=
fix-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024AA6F4">opendir</=
a></tt>
function initiates a traversal of the directory object named by the
string argument
<tt><i>dir-path</i></tt>,
which must be the name of a directory. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024AA6F4">opendir</=
a></tt>
is not able to open the directory traversal, it throws an exception of type
<tt>system-error</tt>.
Otherwise an object of type
<tt>dir</tt>
is returned, which is a directory traversal handle suitable as an argument
for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
function.
</p><p>
If the
<tt><i>prefix-p</i></tt>
argument is specified and has a true value, then it indicates that
the subsequent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
operations should produce the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure by combining
<tt><i>dir-path</i></tt>
with the directory entry name using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat<=
/a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0289D074">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.8">9.74.8</a=
> Function <tt>readdir</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(readdir </tt><tt><i>dir-handle</i></tt><tt> [</tt><tt><i>d=
irent-struct</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
function returns the next available directory entry from the directory
traversal controlled by
<tt><i>dir-handle</i></tt>,
which must be a
<tt>dir</tt>
object returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024AA6F4">opendir</=
a></tt>.
</p><p>
If no more directory entries remain, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
In this situation, the
<tt><i>dir-handle</i></tt>
is also closed, as if by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FEE88A">closedir<=
/a></tt>.
</p><p>
Otherwise, the next available directory entry is returned as a
structure object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
function internally skips and does not report the
<tt>"."</tt>

(dot)
and
<tt>".."</tt>

(dotdot) directory entries.
</p><p>
If the
<tt><i>dirent-struct</i></tt>
argument is specified, then it must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure, or one which has all of the required slots.
In this case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
stores values in that structure and returns it. If
<tt><i>dirent-struct</i></tt>
is absent, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
allocates a fresh
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure.
</p><p>

</p></dd></dl>
<a name=3D"N-01FEE88A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.9">9.74.9</a=
> Function <tt>closedir</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(opendir </tt><tt><i>dir-handle</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FEE88A">closedir<=
/a></tt>
function terminates the directory traversal managed by
<tt><i>dir-handle</i></tt>,
releasing its resources.
</p><p>
If this has already been done before,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FEE88A">closedir<=
/a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
Further
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
calls on the same
<tt><i>dir-handle</i></tt>
return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289D074">readdir</=
a></tt>
function implicitly closes
<tt><i>dir-handle</i></tt>
when the handle indicates that no more directory entries remain to be trave=
rsed.
</p><p>

</p></dd></dl>
<a name=3D"N-02507FF2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.74.10">9.74.10<=
/a> Function <tt>dirstat</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dirstat </tt><tt><i>dirent-struct</i></tt><tt> [</tt><tt><=
i>dir-path</i></tt><tt> [</tt><tt><i>struct</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02507FF2">dirstat</=
a></tt>
function invokes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
on the object represented by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036FE5B4">dirent</a=
></tt>
structure
<tt><i>dirent-struct</i></tt>,
sets the
<tt>type</tt>
slot of the
<tt><i>dirent-struct</i></tt>
accordingly, and then returns the value that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
returned.
</p><p>
If the
<tt><i>struct</i></tt>
argument is specified, it is passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>.
</p><p>
The
<tt><i>dir-path</i></tt>
parameter must be specified, if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
slot of
<tt><i>dirent-struct</i></tt>
is a simple directory entry name, rather than the full path to the object.
In that case, the slot's value gives the effective path.
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
slot is already a path (due to, for instance, a true value of
<tt><i>prefix-p</i></tt>
having been passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024AA6F4">opendir</=
a></tt>)
then
<tt><i>dir-path</i></tt>
must not be specified.
If
<tt><i>dir-path</i></tt>
is specified, then its value is combined with the
<tt><i>name</i></tt>
slot of
<tt><i>dirent-struct</i></tt>
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path-cat<=
/a></tt>
to form the effective path.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
function is invoked on the effective path, and if it succeeds,
then type information is obtained from the resulting
structure to set the value of the
<tt>type</tt>
slot of
<tt><i>dirent-struct</i></tt>.
The same structure that was returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>
is then returned.
</p><p>
</p></dd></dl>
<a name=3D"N-00E95F45">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75">9.75</a> Un=
ix Sockets</h3>



<p>


</p><p>
On platforms where the underlying system interface is available, <b>TXR</b>=
 provides
a sockets library for communicating over Internet networks, or over Unix
sockets.
</p><p>
Stream as well as datagram sockets are supported.
</p><p>
The classic Version 4 of the Internet protocol is supported, as well
as IP Version 6.
</p><p>
Sockets are mapped to <b>TXR</b> streams. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>
function creates a socket of a specified type, in a particular address fami=
ly.
This socket is actually a stream (always, even if it isn't used for
data transfer, but only as a passive contact point).
</p><p>
The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E5DFD4">sock-conn=
ect</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B052CF">sock-bind=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F624A8">sock-list=
en</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222BA70">sock-shut=
down</a></tt>
are used for enacting socket communication scenarios.
</p><p>
Stream sockets use ordinary streams, re-using the same underlying framework
that is used for file I/O and process types.
</p><p>
Datagram socket streams are implemented using special datagram socket strea=
ms.
Datagram socket streams eliminate the need for operations analogous to the
<tt>sendto</tt>
and
<tt>recvfrom</tt>
socket API functions, even in server programs which handle multiple
clients. An overview of datagrams is treated in the following section,
Datagram Socket Streams.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
function is provided for resolving host names and services to IPv4 and IPv6
addresses.
</p><p>
Several structure types are provided for representing socket addresses,
and options for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>.
</p><p>
Various numeric constants are also provided:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-unix</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet6<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-stre=
am</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-dgra=
m</a></tt>
and others.
</p><p>
<a name=3D"N-01F91F35">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.1">9.75.=
1</a> Datagram Socket Streams</h4>


<p>
Datagram socket streams are a new paradigm unique to <b>TXR</b> which
attempts to unify the programming model of stream and datagram
sockets.
</p><p>
A datagram socket stream is created by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>
function, when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-dgra=
m</a></tt>
socket type is specified. Another way in which a datagram socket
is created is when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
is invoked on a datagram socket, and returns a new socket.
</p><p>
I/O is performed on datagram sockets using the regular I/O functions.
None of the functions take or return peer addresses. There are no I/O
functions which are analogous to the C library
<tt>recvfrom</tt>
and
<tt>sendto</tt>
functions which are usually used for datagram programming.
Datagram I/O assumes that the datagram datagram socket is connected to a
specific remote peer, and that peer is implicitly used for all I/O.
</p><p>
Datagram streams solve the message framing problem by
considering a single datagram to be an entire stream.  On input, a datagram
stream holds an entire datagram in a buffer. The stream ends
(experiences the EOF condition) after the last byte of this buffer
is removed by an input operation. Another datagram will be received and
buffered if the EOF condition is first explicitly cleared with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0017">clear-error</=
a></tt>
function, and then another input operation is attempted.
On output, a datagram stream gathers data into an ever-growing output buffe=
r
which isn't subject to any automatic flushing. An explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03999913">flush-str=
eam</a></tt>
operation sends the buffer contents to the connected peer as a new
datagram, and empties the buffer. Subsequent output operations prepare
data for a new datagram. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00596930">close-str=
eam</a></tt>
function implicitly flushes the stream in the same way, and thus also
potentially generates a datagram.
</p><p>
A client-style datagram stream can be explicitly connected to a peer with t=
he
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E5DFD4">sock-conn=
ect</a></tt>
function. This is equivalent to connecting a
datagram socket using the C library
<tt>connect</tt>
function. Writes on the stream will be transmitted using the C library func=
tion
<tt>send</tt>.
A client-style datagram stream can also be "soft-connected" to a
peer using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE18ED">sock-set-=
peer</a></tt>
function. Writes on the stream will transmit data using the C library funct=
ion
<tt>sendto</tt>
to the peer address.
</p><p>
A datagram server program which needs
to communicate using multiple peers is implemented by means of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
function which, unlike the C library
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>
function, works with datagram sockets as well as stream sockets.
The server creates a datagram socket, and uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B052CF">sock-bind=
</a></tt>
to bind it to a local address. Optionally, it may also call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F624A8">sock-list=
en</a></tt>
which is a no-op on datagram sockets. Supporting this function on datagram
sockets allows program code to be more easily changed between datagram and
stream operation.
The server then uses
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
to accept new clients. Note that this is not possible with the C
library function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007B">accept</a></t=
t>,
which only works with stream sockets.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
function receives a datagram from a client, and creates a new datagram
socket stream which is connected to that client, and whose input buffer
contains the received datagram. Input operations on this stream consume
the datagram. Note that clearing the EOF condition and trying to receive
another datagram is not recommended on datagram streams returned
by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>,
since they share the same underlying operating system socket, which is
not actually connected to a specific peer. The receive operation could
receive a datagram from any peer, without any indication which peer that is=
.
Datagram servers should issue a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
call should be issued for each client datagram, treating it as a new
stream.
</p><p>
Datagram sockets ignore almost all aspects of the
<tt><i>mode-string</i></tt>
passed in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>.
The only attribute not ignored is the buffer size specified
with a decimal digit character; however, it cannot be the
only item in the mode string. The string must be syntactically
valid, as described under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function. The buffer size attribute controls the size used by
the datagram socket for receiving a datagram: the capture size.
A datagram socket has obtains a default capture size if one isn't
specified by the
<tt><i>mode-string</i></tt>.
The default capture size is 65536 bytes for a datagram socket created by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>.
If a size is not passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
via its
<tt><i>mode-string</i></tt>
argument when it is invoked on a datagram socket,
that socket's size is used as the capture size of the
newly created datagram socket which is returned.
</p><p>

<a name=3D"N-02C48759">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.2">9.75.=
2</a> Structure <tt>sockaddr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct sockaddr nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (:static family nil))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C48759">sockaddr<=
/a></tt>
structure represents the abstract base class for socket addresses, from whi=
ch
several other types are derived:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DD169">sockaddr-=
in6</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D2">sockaddr-=
un</a></tt>.
</p><p>
It has a single slot called
<tt>family</tt>
which is static, and initialized to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01DD05D9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.3">9.75.3</a=
> Structure <tt>sockaddr-in</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct sockaddr-in sockaddr=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (addr 0) (port 0) (prefix 32)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (:static family af-inet))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>
address represents a socket address used in the context of networking over
IP Version 4. It may be used with sockets in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>
address family.
</p><p>
The
<tt>addr</tt>
slot holds an integer denoting an abstract IPv4 address. For instance the h=
exadecimal
integer literal constant
<tt>#x7F000001</tt>
or its decimal equivalent
<tt>2130706433</tt>
represents the loopback address, whose familiar "dot notation" is
<tt>127.0.0.1</tt>.
Conversion of the abstract IP address to four bytes in network order, as
required, is handled internally.
</p><p>
The
<tt>port</tt>
slot holds the TCP or UDP port number, whose value ranges from 0 to 65535.
Zero isn't a valid port; the value is used for requesting an ephemeral port=
 number
in active connections. Zero also appears in situations when the port number=
 isn't required:
for instance, when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
function is used with the aim of looking up the address of a host, without
caring about the port number.
</p><p>
The
<tt>prefix</tt>
field is set by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">inaddr-st=
r</a></tt>,
when it recognizes and parses a prefix field in the textual representation.
</p><p>
The
<tt>family</tt>
static slot holds the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-013DD169">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.4">9.75.4</a=
> Structure <tt>sockaddr-in6</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct sockaddr-in6 sockaddr=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (addr 0) (port 0) (flow-info 0) (scope-id 0)=
=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (prefix 128)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (:static family af-inet6))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DD169">sockaddr-=
in6</a></tt>
address represents a socket address used in the context of networking over
IP Version 6. It may be used with sockets in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet6<=
/a></tt>
address family.
</p><p>
The
<tt>addr</tt>
slot holds an integer denoting an abstract IPv6 address. IPv6 addresses are
pure binary integers up to 128 bits wide.
</p><p>
The
<tt>port</tt>
slot holds the TCP or UDP port number, whose value ranges from 0 to 65535.
In IPv6, the port number functions similarly to IPv6; see
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>.
</p><p>
The
<tt>flow-info</tt>
and
<tt>scope-id</tt>
are special IPv6 parameters corresponding to the
<tt>sin6_flowinfo</tt>
and
<tt>sin6_scope_id</tt>
slots of the
<tt>sockaddr_in6</tt>
C language structure. Their meaning and use are beyond the scope of this do=
cument.
</p><p>
The
<tt>prefix</tt>
field is set by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">in6addr-s=
tr</a></tt>,
when it recognizes and parses a prefix field in the textual representation.
</p><p>
The
<tt>family</tt>
static slot holds the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet6<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01DD05D2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.5">9.75.5</a=
> Structure <tt>sockaddr-un</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct sockaddr-un sockaddr=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; path=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; (:static family af-unix))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D2">sockaddr-=
un</a></tt>
address represents a socket address used for inter-process communication
within a single operating system node, using the "Unix domain" sockets
of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-unix</=
a></tt>
address family.
</p><p>
This structure has only one slot,
<tt>path</tt>
which holds the rendezvous name for connecting pairs of socket endpoints.
This name appears in the filesystem.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D2">sockaddr-=
un</a></tt>
structure is converted to the C structure
<tt>struct sockaddr_un</tt>,
the
<tt>path</tt>
slot undergoes conversion to UTF-8. The resulting bytes are stored in the
<tt>sun_path</tt>
member of the C structure. If the resulting UTF-8 byte string
is larger than the
<tt>sun_path</tt>
array, it is silently truncated.
</p><p>
Note: Linux systems have support for "abstract" names which do not appear i=
n
the filesystem. These abstract names are distinguished by starting with a n=
ull
byte. For more information, consult Linux documentation.
This convention is supported in the
<tt>path</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D2">sockaddr-=
un</a></tt>
structure. If
<tt>path</tt>
contains occurrences of the pseudo-null character U+DC00, these translate
to null bytes in the
<tt>sun_path</tt>
member of the corresponding C structure
<tt>struct sockaddr_un</tt>.
For example, the path
<tt>"\xDC00;foo"</tt>

is valid and represents an abstract address consisting of the three bytes
<tt>"foo"</tt>

followed by null padding bytes.
</p><p>
The
<tt>family</tt>
static slot holds the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-unix</=
a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0110E961">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.6">9.75.6</a=
> Structure <tt>addrinfo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct addrinfo nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;(flags 0) (family 0) (socktype 0))=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0110E961">addrinfo<=
/a></tt>
structure is used in conjunction with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
function. If that function's
<tt><i>hints</i></tt>
argument is specified, it is of this type.
The purpose of the argument is to narrow down
or possibly alter the selection of addresses which
are returned.
</p><p>
The
<tt>flags</tt>
slot holds a bitwise or combination (see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function) of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
flags: values given by the variables.
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020DFFDE">ai-passiv=
e</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020DFFDE">ai-numeri=
chost</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020DFFDE">ai-v4mapp=
ed</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020DFFDE">ai-all</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020DFFDE">ai-addrco=
nfig</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020DFFDE">ai-numeri=
cserv</a></tt>.
These correspond to the C constants
<tt>AI_PASSIVE</tt>,
<tt>AI_NUMERICHOST</tt>
and so forth.
</p><p>
The
<tt>family</tt>
slot holds an address family, which may be the value of
<tt>af-unspec</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-unix</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet6<=
/a></tt>.
</p><p>
The
<tt>socktype</tt>
slot holds, a socket type. Socket types are given
by the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-dgra=
m</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-stre=
am</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0363FE99">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.7">9.75.7</a=
> Function <tt>getaddrinfo</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(getaddrinfo [</tt><tt><i>node</i></tt><tt> [</tt><tt><i>se=
rvice</i></tt><tt> [</tt><tt><i>hints</i></tt><tt>]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
returns a list of socket addresses based on search criteria expressed
in its arguments.
That is to say, the returned list, unless empty, contains objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DD169">sockaddr-=
in6</a></tt>.
</p><p>
The function is implemented directly in terms of the like-named C library
function. All parameters are optional.  Omitting any argument causes a null
pointer to be passed for the corresponding parameter of the C library funct=
ion.
</p><p>
The
<tt><i>node</i></tt>
and
<tt><i>service</i></tt>
parameters may be character strings which specify a host name, and service.
The contents of these strings may be symbolic, like
<tt>"<a href=3D"http://www.example.com/">www.example.com</a>"</tt>

and
<tt>"ssh"</tt>

or numeric, like
<tt>"10.13.1.5"</tt>

and
<tt>"80"</tt>.
</p><p>
If an argument is given for the
<tt>hints</tt>
parameter, it must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0110E961">addrinfo<=
/a></tt>.
</p><p>
The
<tt><i>node</i></tt>
and
<tt><i>service</i></tt>
parameters may also be given integer arguments.
An integer argument value in either of these parameters is converted to a n=
ull
pointer when calling the C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
function. The integer values are then simply installed into every returned
address as the IP address or port number, respectively.  However, if both
arguments are numeric, then no addresses are returned, since the C library
function is then called with a null node and service.
</p><p>

</p></dd></dl>
<a name=3D"N-0228EAE0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.8">9.75.8</a=
> Variables <tt>af-unix</tt>, <tt>af-inet</tt> and <tt>af-inet6</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integers which give the values of address
families. They correspond to the C constants
<tt>AF_UNIX</tt>,
<tt>AF_INET</tt>
and
<tt>AF_INET6</tt>.
Address family values are used in the
<tt><i>hints</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
function, and in the
<tt>socket-open</tt>
function.
Note that unlike the C language socket addressing structures,
the <b>TXR</b> socket addresses do not contain an address family slot.
That is because they indicate their family via their type.
That is to say, an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>
is an address which is implicitly associated with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>
family via its type.
</p><p>

</p></dd></dl>
<a name=3D"N-01D17D22">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.9">9.75.9</a=
> Variables <tt>sock-stream</tt> and <tt>sock-dgram</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integers which give the values of address
families. They correspond to the C constants
<tt>SOCK_STREAM</tt>
and
<tt>SOCK_DGRAM</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-020DFFDE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.10">9.75.10<=
/a> Variables <tt>ai-passive</tt>, <tt>ai-numerichost</tt>, <tt>ai-v4mapped=
</tt>, <tt>ai-all</tt>, <tt>ai-addrconfig</tt> and <tt>ai-numericserv</tt><=
/h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integers which are bitmasks that combine
together via bitwise or, to express the
<tt>flags</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0110E961">addrinfo<=
/a></tt>
structure. They correspond to the C constants
<tt>AI_PASSIVE</tt>,
<tt>AI_NUMERICHOST</tt>,
<tt>AI_V4MAPPED</tt>
and so forth. They influence the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0363FE99">getaddrin=
fo</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-026A2C3B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.11">9.75.11<=
/a> Variables <tt>inaddr-any</tt>, <tt>inaddr-loopback</tt>, <tt>in6addr-an=
y</tt> and <tt>in6addr-loopback</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These integer-valued variables provide constants for commonly used IPv4
and IPv6 address values.
</p><p>
The value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026A2C3B">inaddr-an=
y</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026A2C3B">in6addr-a=
ny</a></tt>
is zero. This address is used in binding a passive socket to all of the
external interfaces of a host, so that it can accept connections or datagra=
ms
from all attached networks.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026A2C3B">inaddr-lo=
opback</a></tt>
variable is IPv4 loopback address, the same integer as the hexadecimal
constant
<tt>#x7F000001.</tt>
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026A2C3B">in6addr-l=
oopback</a></tt>
is the IPv6 loopback address. Its value is 1.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Construct an IPv6 socket address suitable for bindin=
g
  ;; a socket to the loopback network, port 1234:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> so=
ckaddr-in6 addr in6addr-loopback port 1234)

  ;; Mistake: IPv4 address used with IPv6 sockaddr.
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> so=
ckaddr-in6 addr inaddr-loopback)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-026B766B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.12">9.75.12<=
/a> Function <tt>open-socket</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-socket </tt><tt><i>family</i></tt><tt> </tt><tt><i>ty=
pe</i></tt><tt> [</tt><tt><i>mode-string</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>
function creates a socket, which is a kind of stream.
</p><p>
The
<tt><i>family</i></tt>
parameter specifies the address family of the socket. One of the
values
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet6<=
/a></tt>
should be used to create a Unix domain, Internet IPv4 or Internet IPv6
socket, respectively.
</p><p>
The
<tt><i>type</i></tt>
parameter specifies the socket type, either
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-stre=
am</a></tt>
(stream socket) or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D17D22">sock-dgra=
m</a></tt>
(datagram socket).
</p><p>
The
<tt><i>mode-string</i></tt>
specifies several properties of the stream; for a description of
<tt><i>mode-string</i></tt>
parameters, refer to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function. Note that the defaulting behavior for an omitted
<tt><i>mode-string</i></tt>
argument is different under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>
from other functions. Because sockets are almost always used for bidirectio=
nal
data flow, the default mode string is
<tt>"r+b"</tt>

rather than the usual
<tt>"r"</tt>.
</p><p>
Rationale for including the
<tt>"b"</tt>

flag in the default mode string is that network protocols are usually defin=
ed
in a way that is independent of machine and operating system, down to the b=
yte
level, even when they are textual. It doesn't make sense for the same <b>TX=
R</b>program to see a network stream differently based on what platform it =
is
running on. Line ending conversion has to do with how a platform locally st=
ores
text files, whereas network streams are almost always external formats.
</p><p>
Like other stream types, stream sockets are buffered and marked as no
non-real-time streams. Specifying the
<tt>"i"</tt>

mode in
<tt><i>mode-string</i></tt>
marks a socket as a real-time-stream, and, if it is opened for writing
or reading and writing, changes it to use line buffering.
</p><p>

</p></dd></dl>
<a name=3D"N-01A7ECBB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.13">9.75.13<=
/a> Function <tt>open-socket-pair</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(open-socket-pair </tt><tt><i>family</i></tt><tt> </tt><tt>=
<i>type</i></tt><tt> [</tt><tt><i>mode-string</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A7ECBB">open-sock=
et-pair</a></tt>
function provides an interface to the functionality of the
<tt>socketpair</tt>
C library function.
</p><p>
If successful, it creates and returns a list of two stream objects,
which are sockets that are connected together.
</p><p>
Note: the Internet address families
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0228EAE0">af-inet6<=
/a></tt>
are not supported.
</p><p>
The
<tt>mode-string</tt>
is applied to each stream. For a description, see
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026B766B">open-sock=
et</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0323EB36">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.14">9.75.14<=
/a> Functions <tt>sock-family</tt> and <tt>sock-type</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-family </tt><tt><i>socket</i></tt><tt>)=20




<br>&nbsp;&nbsp;(sock-type </tt><tt><i>socket</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions retrieve the integer values representing the address family
and type of a socket. The argument to the
<tt><i>socket</i></tt>
parameter must be a socket stream or a file or process stream. For a file s=
tream,
both functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
An exception of type
<tt>type-error</tt>
is thrown for other stream types.
</p><p>

</p></dd></dl>
<a name=3D"N-015ABEC7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.15">9.75.15<=
/a> Accessor <tt>sock-peer</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-peer </tt><tt><i>socket</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (sock-peer </tt><tt><i>socket</i></tt><tt>) </tt><tt><=
i>address</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>
function retrieves the peer address
has most recently been assigned to
<tt><i>socket</i></tt>.
</p><p>
Sockets which are not connected initially
have a peer address value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
A socket which is connected to a remote peer
receives that peer's address as its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>.
</p><p>
If a socket is connected to a remote peer via
a successful use of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E5DFD4">sock-conn=
ect</a></tt>
function, then its
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>
address is set to match that of the peer.
</p><p>
Sockets returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
function are connected, and have the remote endpoint address as their
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>
address.
</p><p>
Assigning an address to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>
form is equivalent to using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE18ED">sock-set-=
peer</a></tt>
to set the address.
</p><p>
Implementation note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>
function does not use the
<tt>getpeername</tt>
C library function; the association between a stream and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C48759">sockaddr<=
/a></tt>
struct is maintained by <b>TXR</b>.
</p><p>

</p></dd></dl>
<a name=3D"N-01FE18ED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.16">9.75.16<=
/a> Function <tt>sock-set-peer</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-set-peer </tt><tt><i>socket</i></tt><tt> </tt><tt><i>=
address</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE18ED">sock-set-=
peer</a></tt>
function stores
<tt><i>address</i></tt>
into
<tt><i>socket</i></tt>
as that socket's peer.
</p><p>
Subsequently, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>
function will retrieve that address.
</p><p>
If
<tt><i>address</i></tt>
is not an appropriate address object in the address family of
<tt><i>socket</i></tt>,
the behavior is unspecified.
</p><p>

</p></dd></dl>
<a name=3D"N-00E5DFD4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.17">9.75.17<=
/a> Function <tt>sock-connect</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-connect </tt><tt><i>socket</i></tt><tt> </tt><tt><i>a=
ddress</i></tt><tt> [</tt><tt><i>timeout-usec</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E5DFD4">sock-conn=
ect</a></tt>
function connects a socket stream to a peer address.
</p><p>
The
<tt><i>address</i></tt>
argument must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C48759">sockaddr<=
/a></tt>
object of type matching the address family of the socket.
</p><p>
If the operation fails, an exception of type
<tt>socket-error</tt>
is thrown. Otherwise, the function returns
<tt><i>socket</i></tt>.
</p><p>
If the
<tt><i>timeout-usec</i></tt>
argument is specified, it must be a fixnum integer.
It denotes a connection timeout period in microseconds.
If the connection doesn't succeed within the specified timeout,
an exception of type
<tt>timeout-error</tt>
is thrown.
</p><p>

</p></dd></dl>
<a name=3D"N-02B052CF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.18">9.75.18<=
/a> Function <tt>sock-bind</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-bind </tt><tt><i>socket</i></tt><tt> </tt><tt><i>addr=
ess</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B052CF">sock-bind=
</a></tt>
function binds a socket stream to a local address.
</p><p>
The
<tt><i>address</i></tt>
argument must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C48759">sockaddr<=
/a></tt>
object of type matching the address family of the socket.
</p><p>
If the operation fails, an exception of type
<tt>socket-error</tt>
is thrown. Otherwise, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
Returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if successful.
</p><p>

</p></dd></dl>
<a name=3D"N-02F624A8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.19">9.75.19<=
/a> Function <tt>sock-listen</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-listen </tt><tt><i>socket</i></tt><tt> [</tt><tt><i>b=
acklog</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F624A8">sock-list=
en</a></tt>
function prepares
<tt><i>socket</i></tt>
for listening for connections. The
<tt><i>backlog</i></tt>
parameter, if specified, requires an integer
argument. The default value is 16.
</p><p>

</p></dd></dl>
<a name=3D"N-00AF0FE8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.20">9.75.20<=
/a> Function <tt>sock-accept</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-accept </tt><tt><i>socket</i></tt><tt> [</tt><tt><i>m=
ode-string</i></tt><tt> [</tt><tt><i>timeout-usec</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
function waits for a client connection on
<tt><i>socket</i></tt>,
which must have been prepared for listening for
connections using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B052CF">sock-bind=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F624A8">sock-list=
en</a></tt>.
</p><p>
If the operation fails, an exception of type
<tt>socket-error</tt>
is thrown. Otherwise, the function returns a new socket
which is connected to the remote peer.
</p><p>
The peer's address may be retrieved from this socket using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015ABEC7">sock-peer=
</a></tt>.
</p><p>
The
<tt>mode-string</tt>
parameter is applied to the new socket just like the
similar argument in
<tt>socket-open</tt>.
It defaults to
<tt>"r+"</tt>.
</p><p>
If the
<tt><i>timeout-usec</i></tt>
argument is specified, it must be a fixnum integer.
It denotes a timeout period in microseconds.
If no peer connects for the specified timeout,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00AF0FE8">sock-acce=
pt</a></tt>
throws an exception of type
<tt>timeout-error</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-028953A4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.21">9.75.21<=
/a> Variables <tt>shut-rd</tt>, <tt>shut-wr</tt> and <tt>shut-rdwr</tt></h4=
>



<dl>
<dt>Description:</dt><dd>
<p>



The values of these variables are useful as the second argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222BA70">sock-shut=
down</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0222BA70">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.22">9.75.22<=
/a> Function <tt>sock-shutdown</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-shutdown </tt><tt><i>sock</i></tt><tt> [</tt><tt><i>d=
irection</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222BA70">sock-shut=
down</a></tt>
function indicates that no further communication is to take place on
<tt><i>socket</i></tt>
in the specified direction(s).
</p><p>
If the operation fails, an exception of type
<tt>socket-error</tt>
is thrown. Otherwise, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The
<tt>direction</tt>
parameter is one of the values given by the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028953A4">shut-rd</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028953A4">shut-wr</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028953A4">shut-rdwr=
</a></tt>.
These values shut down communication in the read direction, write direction=
,
or both directions, respectively.
</p><p>
If the argument is omitted,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222BA70">sock-shut=
down</a></tt>
defaults to closing the write direction.
</p><p>
Notes: shutting down is most commonly requested in the write direction, to =
perform
a "half close". The communicating process thereby indicates that it has wri=
tten
all the data which it intends to write.  When the shutdown action is proces=
sed on the
remote end, that end is unblocked from waiting on any further data, and
effectively experiences an "end of stream" condition on its own socket or
socket-like endpoint, while continuing to be able to transmit data.
Shutting down in the reading direction is potentially abrupt. If it is exec=
uted
before an "end of stream" indication is received from a peer, it results in=
 an
abortive close.
</p><p>

</p></dd></dl>
<a name=3D"N-03DF15F2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.23">9.75.23<=
/a> Functions <tt>sock-recv-timeout</tt> and <tt>sock-send-timeout</tt></h4=
>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sock-recv-timeout </tt><tt><i>sock</i></tt><tt> </tt><tt><=
i>usec</i></tt><tt>)=20




<br>&nbsp;&nbsp;(sock-send-timeout </tt><tt><i>sock</i></tt><tt> </tt><tt><=
i>usec</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF15F2">sock-recv=
-timeout</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF15F2">sock-send=
-timeout</a></tt>
functions configure, respectively, receive and send timeouts on socket
<tt><i>sock</i></tt>.
</p><p>
The
<tt><i>usec</i></tt>
parameter specifies the value, in microseconds. It must be a
<tt>fixnum</tt>
integer.
</p><p>
When a receive timeout is configured on a socket, then an
exception of type
<tt>timeout-error</tt>
is thrown when an input operation waits for at least
<tt>usec</tt>
microseconds without receiving input.
</p><p>
Similarly, when a send timeout is configured, then an
exception of type
<tt>timeout-error</tt>
is thrown when an output operation waits for at least
<tt>usec</tt>
microseconds for the availability of buffer space in the socket.
</p><p>

</p></dd></dl>
<a name=3D"N-01FF658D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.24">9.75.24<=
/a> Functions <tt>str-inaddr</tt> and <tt>str-in6addr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(str-inaddr address [</tt><tt><i>port</i></tt><tt>])=20




<br>&nbsp;&nbsp;(str-in6addr address [</tt><tt><i>port</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF658D">str-inadd=
r</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF658D">str-in6ad=
dr</a></tt>
functions convert an IPv4 and IPv6 address, respectively, to textual
notation which is returned as a character string.
The conversion is done in conformance with RFC 5952, section 4.
</p><p>
IPv6 addresses representing IPv6-mapped IPv4 addresses are printed
in the hybrid notation exemplified by
<tt>::ffff:192.168.1.1</tt>.
</p><p>
The
<tt><i>address</i></tt>
parameter must be a non-negative integer in the appropriate range
for the address type.
</p><p>
If the
<tt><i>port</i></tt>
number argument is supplied, it is included in the returned character strin=
g,
according to the requirements in section 6 of RFC 5952 pertaining to IPv6
addresses (including IPv6-mapped IPv6 addresses) and section 3.2.3 of RFC 3=
986
for IPv4 addresses. In brief, IPv6 addresses with ports are expressed as
<tt>[address]:port</tt>
and IPv6 addresses follow the traditional
<tt>address:port</tt>
pattern.
</p><p>

</p></dd></dl>
<a name=3D"N-00918411">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.25">9.75.25<=
/a> Functions <tt>str-inaddr-net</tt> and <tt>str-in6addr-net</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(str-inaddr-net </tt><tt><i>address</i></tt><tt> [</tt><tt>=
<i>width</i></tt><tt>])=20




<br>&nbsp;&nbsp;(str-in6addr-net </tt><tt><i>address</i></tt><tt> [</tt><tt=
><i>width</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00918411">str-inadd=
r-net</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00918411">str-in6ad=
dr-net</a></tt>
convert, respectively, IPv4 and IPv6 network prefix addresses to
the "slash notation". For IPv6 addresses, the requirements of section
2.3 of RFC 4291 are implemented. For IPv4, section 3.1 of RFC 4632 is follo=
wed.
</p><p>
The condensed portion of the IP address is always determined by measuring
the contiguous extent of all-zero bits in the least significant position
of the address. For instance an IPv4 address which has at least 24 zero bit=
s
in the least significant position, so that the only nonzero bits are in the
highest octet, is always condensed to a single decimal number: the value of
the first octet.
</p><p>
If the
<tt><i>width</i></tt>
parameter is specified, then its value is incorporated into the returned
textual notation as the width. No check is made whether this width
large enough to span all of the nonzero bits in the address.
</p><p>
If
<tt><i>width</i></tt>
is omitted, then it is calculated as the number of bits in the address,
excluding the contiguous all-zero bits in the least significant position:
how many times the address can be shifted to the right before a 1 appears
in the least significant bit.
</p><p>

</p></dd></dl>
<a name=3D"N-02456270">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.75.26">9.75.26<=
/a> Functions <tt>inaddr-str</tt> and <tt>in6addr-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(inaddr-str </tt><tt><i>string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(in6addr-str </tt><tt><i>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">inaddr-st=
r</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">in6addr-s=
tr</a></tt>
functions recover an IPv4 or IPv6 address from a textual representation.
If the parse is successful, the address is returned as, respectively, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DD169">sockaddr-=
in6</a></tt>
structure.
</p><p>
If
<tt><i>string</i></tt>
is a malformed address, due to any issue such as invalid syntax or
a numeric value being out of range, an exception is thrown.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">inaddr-st=
r</a></tt>
function recognizes the dot notation consisting of four decimal numbers
separated by period characters. The numbers must be in the range 0 to 255.
Note: superfluous leading zeros are permitted, though this is a nonstandard
extension; not all implementations of this notations support this.
</p><p>
A prefix may be specified in the notation as a slash followed by a decimal
number, in the range 0 to 32. In this case, the integer value of the
prefix appears as the
<tt>prefix</tt>
member of the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01DD05D9">sockaddr-=
in</a></tt>
structure. Furthermore, the address is masked, so that any bits not
included in the prefix are zero. For instance, the address
<tt>"255.255.255.255/1"</tt>

is equivalent to
<tt>"128.0.0.0"</tt>,
except that the
<tt>prefix</tt>
if the returned structure is 1 rather than 32.
When a prefix is not specified, the
<tt>prefix</tt>
member of the structure retains its default value of 32.
When the prefix is specified, the address part need not contain all four
octets; it may contain between one and four octets. Thus,
<tt>"192.168/16"</tt>

is a valid address, equivalent to
<tt>"192.168.0.0/16"</tt>.
</p><p>
A port number may be specified in the notation as a colon, followed by a
decimal number in the range 0 to 65535. The integer value of this port
number appears as the
<tt>port</tt>
member of the returned structure. An example of this notation is
<tt>"127.0.0.1:23"</tt>.
</p><p>
A prefix and port number may both be specified; in this case the prefix mus=
t
appear first, followed by the port number. For example,
<tt>"127/8:23"</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">in6addr-s=
tr</a></tt>
function recognizes the IPv6 notation consisting of 16-bit hexadecimal piec=
es
separated by colons. If the operation is successful, it returns a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DD169">sockaddr-=
in6</a></tt>
structure.  Each piece must be a value in the range 0 to FFFF.
The hexadecimal digits may be any mixture of upper and lower case. Leading
zeros are permitted.
Up to eight such pieces must be specified. If fewer pieces are specified,
then the token
<tt>::</tt>
(double colon)
must appear in the address exactly once. That token denotes the condensatio=
n of
a sufficient number of zero-valued pieces to make eight pieces.
The token must be in one of three positions: it may be the leftmost element=
 of
the address, immediately followed by a hexadecimal piece; it may be the rig=
htmost element
of the address, preceded by a hexadecimal piece; or else, it may be in the
middle of the address, flanked on both sides by hexadecimal pieces.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">in6addr-s=
tr</a></tt>
also recognizes the special notation for IPv6-mapped IPv4 addresses. This
notation consists of the address string
<tt>"::FFFF"</tt>

which may appear in any upper/lower case mixture, possibly with leading
zeros, followed by an IPv4 address given in the four-octet dot notation.
For example,
<tt>"::FFFF:127.0.0.1"</tt>.
</p><p>
A prefix may be specified using a slash, followed by a decimal number in th=
e
range 0 to 128. The handling of the prefix is similar to that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02456270">inaddr-st=
r</a></tt>
except that pieces of the address may not be omitted. Condensing the
pieces of the IPv6 address is always done by means of the
<tt>::</tt>
token, whether or not a prefix is present. Furthermore, the octets specifie=
d in
the IPv6-mapped IPv4 notation must all be present, regardless of the prefix=
.
</p><p>
A port number may be specified in the notation as follows: the entire addre=
ss,
including any slash-separated prefix, must appear surrounded in square
brackets. The closing square bracket must be followed by a colon and one or
more digits denoting a decimal number in the range 0 to 65535. For instance
<tt>"[1:2:3::4/64]:1234."</tt>
</p><p>
</p></dd></dl>
<a name=3D"N-0260AE30">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76">9.76</a> Un=
ix Terminal Control</h3>



<p>


</p><p>
<b>TXR</b> provides access to the terminal control "termios" interfaces def=
ined by
POSIX, and some of the extensions to it in Linux. By using termios, program=
s
can control serial devices, consoles and virtual terminals. Terminal contro=
l
in POSIX revolves around a C language structure called
<tt>struct termios</tt>.
This is mirrored in a <b>TXR Lisp</b> structure also called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>.
</p><p>
Like-named <b>TXR Lisp</b> functions are provided which correspond to the C=
 functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcgetattr=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033C365C">tcsendbre=
ak</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AC4760">tcdrain</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034C4A4D">tcflush</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03081D51">tcflow</a=
></tt>.
</p><p>
These have somewhat different argument conventions. The TTY device is speci=
fied last,
so that it can conveniently default to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream. A TTY device can be specified as either a stream object or a numeri=
c
file descriptor.
</p><p>
The functions
<tt>cfgetispeed</tt>,
<tt>cfgetospeed</tt>,
<tt>cfsetispeed</tt>
and
<tt>cfsetospeed</tt>
are not provided, because they are unnecessary. Device speed (informally, "=
baud rate")
is specified directly as a integer value in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure. The <b>TXR Lisp</b> termios functions automatically convert betw=
een integer
values and the speed constants (like
<tt>B38400</tt>)
used by the C API.
</p><p>
All of the various termios-related constants are provided, including some n=
on-standard
ones. They appear in lower case. For instance
<tt>IGNBRK</tt>
and
<tt>PARENB</tt>
are simply known as the predefined <b>TXR Lisp</b> variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02391683">ignbrk</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1B5DF">parenb</a=
></tt>.
</p><p>

<a name=3D"N-039CD619">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.1">9.76.=
1</a> Structure <tt>termios</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct termios nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;iflag oflag cflag lflag=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;cc ispeed ospeed)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure represents the kernel level terminal device configuration.
It holds hardware related setting such as serial line speed, parity
and handshaking. It also holds software settings like translations,
and settings affecting input behaviors. The structure closely corresponds
to the C language
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure which exists in the POSIX API.
</p><p>
The
<tt>iflag</tt>,
<tt>oflag</tt>,
<tt>cflag</tt>
and
<tt>lflag</tt>
slots correspond to the
<tt>c_iflag</tt>,
<tt>c_oflag</tt>,
<tt>c_cflag</tt>
and
<tt>c_lflag</tt>
members of the C structure. They hold integer values representing
bit fields.
</p><p>
The
<tt>cc</tt>
slot corresponds to the
<tt>c_cc</tt>
member of the C structure. Whereas the
C structure's
<tt>c_cc</tt>
member is an array of the C type
<tt>cc_t</tt>,
the
<tt>cc</tt>
slot is a vector of integers, whose values must have the same range as the
<tt>cc_t</tt>
type.
</p><p>

</p></dd></dl>
<a name=3D"N-02391683">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.2">9.76.2</a=
> Variables <tt>ignbrk</tt>, <tt>brkint</tt>, <tt>ignpar</tt>, <tt>parmrk</=
tt>, <tt>inpck</tt>, <tt>istrip</tt>, <tt>inlcr</tt>, <tt>igncr</tt>, <tt>i=
crnl</tt>, <tt>iuclc</tt>, <tt>ixon</tt>, <tt>ixany</tt>, <tt>ixoff</tt>, <=
tt>imaxbel</tt> and <tt>iutf8</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables specify bitmask values for the
<tt>iflag</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure. They correspond to the C language preprocessor symbols
<tt>IGNBRK</tt>,
<tt>BRKINT</tt>,
<tt>IGNPAR</tt>
and so forth.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02391683">imaxbel</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02391683">iutf8</a>=
</tt>
variables are specific to Linux and may not be present.
Portable code should test for their presence with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02391683">iuclc</a>=
</tt>
variable is a legacy feature not found on all systems.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-iflag=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-ifl=
ags</a></tt>
provide a convenient means for setting and clearing combinations of
these flags.
</p><p>

</p></dd></dl>
<a name=3D"N-03BD477F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.3">9.76.3</a=
> Variables <tt>opost</tt>, <tt>olcuc</tt>, <tt>onlcr</tt>, <tt>ocrnl</tt>,=
 <tt>onocr</tt>, <tt>onlret</tt>, <tt>ofill</tt>, <tt>ofdel</tt>, <tt>vtdly=
</tt>, <tt>vt0</tt>, <tt>vt1</tt>, <tt>nldly</tt>, <tt>nl0</tt>, <tt>nl1</t=
t>, <tt>crdly</tt>, <tt>cr0</tt>, <tt>cr1</tt>, <tt>cr2</tt>, <tt>cr3</tt>,=
 <tt>tabdly</tt>, <tt>tab0</tt>, <tt>tab1</tt>, <tt>tab2</tt>, <tt>tab3</tt=
>, <tt>bsdly</tt>, <tt>bs0</tt>, <tt>bs1</tt>, <tt>ffdly</tt>, <tt>ff0</tt>=
 and <tt>ff1</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables specify bitmask values for the
<tt>oflag</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure. They correspond to the C language preprocessor symbols
<tt>OPOST</tt>,
<tt>OLCUC</tt>,
<tt>ONLCR</tt>
and so forth.
</p><p>
The variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">ofdel</a>=
</tt>
is Linux-specific. Portable programs should test for its presence using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">olcuc</a>=
</tt>
variable is a legacy feature not found on all systems.
</p><p>
Likewise, whether the following groups of symbols are present is
platform-specific:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">nldly</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">nl0</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">nl1</a></=
tt>;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">crdly</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">cr0</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">cr1</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">cr2</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">cr3</a></=
tt>;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">tabdly</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">tab0</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">tab1</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">tab2</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">tab3</a><=
/tt>;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">bsdly</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">bs0</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">bs1</a></=
tt>;
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">ffdly</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">ff0</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BD477F">ff1</a></=
tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-oflag=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-ofl=
ags</a></tt>
provide a convenient means for setting and clearing combinations of
these flags.
</p><p>

</p></dd></dl>
<a name=3D"N-01B1B5DF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.4">9.76.4</a=
> Variables <tt>csize</tt>, <tt>cs5</tt>, <tt>cs6</tt>, <tt>cs7</tt>, <tt>c=
s8</tt>, <tt>cstopb</tt>, <tt>cread</tt>, <tt>parenb</tt>, <tt>parodd</tt>,=
 <tt>hupcl</tt>, <tt>clocal</tt>, <tt>cbaud</tt>, <tt>cbaudex</tt>, <tt>cms=
par</tt> and <tt>crtscts</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables specify bitmask values for the
<tt>cflag</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure. They correspond to the C language preprocessor symbols
<tt>CSIZE</tt>,
<tt>CS5</tt>,
<tt>CS6</tt>
and so forth.
</p><p>
The following are present on Linux, and may not be available
on other platforms. Portable code should test for them using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1B5DF">cbaud</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1B5DF">cbaudex</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1B5DF">cmspar</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1B5DF">crtscts</=
a></tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-cflag=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-cfl=
ags</a></tt>
provide a convenient means for setting and clearing combinations of
these flags.
</p><p>

</p></dd></dl>
<a name=3D"N-0072FF5E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.5">9.76.5</a=
> Variables <tt>isig</tt>, <tt>icanon</tt>, <tt>echo</tt>, <tt>echoe</tt>, =
<tt>echok</tt>, <tt>echonl</tt>, <tt>noflsh</tt>, <tt>tostop</tt>, <tt>iext=
en</tt>, <tt>xcase</tt>, <tt>echoctl</tt>, <tt>echoprt</tt>, <tt>echoke</tt=
>, <tt>flusho</tt>, <tt>pendin</tt> and <tt>extproc</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables specify bitmask values for the
<tt>lflag</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure. They correspond to the C language preprocessor symbols
<tt>ISIG</tt>,
<tt>ICANON</tt>,
<tt>ECHO</tt>
and so forth.
</p><p>
The following are present on Linux, and may not be available
on other platforms. Portable code should test for them using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">iexten</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">xcase</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">echoctl</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">echoprt</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">echoke</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">flusho</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">pendin</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0072FF5E">extproc</=
a></tt>.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-lflag=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-lfl=
ags</a></tt>
provide a convenient means for setting and clearing combinations of
these flags.
</p><p>

</p></dd></dl>
<a name=3D"N-01812D70">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.6">9.76.6</a=
> Variables <tt>vintr</tt>, <tt>vquit</tt>, <tt>verase</tt>, <tt>vkill</tt>=
, <tt>veof</tt>, <tt>vtime</tt>, <tt>vmin</tt>, <tt>vswtc</tt>, <tt>vstart<=
/tt>, <tt>vstop</tt>, <tt>vsusp</tt>, <tt>veol</tt>, <tt>vreprint</tt>, <tt=
>vdiscard</tt>, <tt>vwerase</tt>, <tt>vlnext</tt> and <tt>veol2</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables specify integer offsets into the vector stored in the
<tt>cc</tt>
slot of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure. They correspond to the C language preprocessor symbols
<tt>VINTR</tt>,
<tt>VQUIT</tt>,
<tt>VERASE</tt>
and so forth.
</p><p>
The following are present on Linux, and may not be available
on other platforms. Portable code should test for them using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01812D70">vswtc</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01812D70">vreprint<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01812D70">vdiscard<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01812D70">vlnext</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01812D70">veol2</a>=
</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02173FF9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.7">9.76.7</a=
> Variables <tt>tcooff</tt>, <tt>tcoon</tt>, <tt>tcioff</tt> and <tt>tcion<=
/tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integer values suitable as the
<tt><i>action</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03081D51">tcflow</a=
></tt>
function. They correspond to the C language preprocessor symbols
<tt>TCOOFF</tt>,
<tt>TCOON</tt>,
<tt>TCIOFF</tt>
and
<tt>TCION</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0279ED46">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.8">9.76.8</a=
> Variables <tt>tciflush</tt>, <tt>tcoflush</tt> and <tt>tcioflush</tt></h4=
>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integer values suitable as the
<tt><i>queue</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034C4A4D">tcflush</=
a></tt>
function. They correspond to the C language preprocessor symbols
<tt>TCIFLUSH</tt>,
<tt>TCOFLUSH</tt>
and
<tt>TCIOFLUSH</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02C6ECF5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.9">9.76.9</a=
> Variables <tt>tcsanow</tt>, <tt>tcsadrain</tt> and <tt>tcsaflush</tt></h4=
>



<dl>
<dt>Description:</dt><dd>
<p>



These variables hold integer values suitable as the
<tt><i>actions</i></tt>
argument of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function. They correspond to the C language preprocessor symbols
<tt>TCSANOW</tt>,
<tt>TCSADRAIN</tt>
and
<tt>TCSAFLUSH</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-013D13CA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.10">9.76.10<=
/a> Functions <tt>tcgetattr</tt> and <tt>tcsetattr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tcgetattr [</tt><tt><i>device</i></tt><tt>])=20




<br>&nbsp;&nbsp;(tcsetattr </tt><tt><i>termios</i></tt><tt> [</tt><tt><i>ac=
tions</i></tt><tt> [</tt><tt><i>device</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcgetattr=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
functions, respectively, retrieve and install the configuration
of the terminal driver associated with the specified device.
</p><p>
These functions are wrappers for the like-named POSIX C library functions,
but with different argument conventions, and operating using
a <b>TXR Lisp</b> structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcgetattr=
</a></tt>
function, if successful, returns a new instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function requires an instance of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure as an argument to its
<tt><i>termios</i></tt>
parameter.
</p><p>
A program may alter the settings of a terminal device by
retrieving them using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcgetattr=
</a></tt>,
manipulating the structure returned by this function, and
then using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
to install the modified structure into the device.
</p><p>
The
<tt><i>actions</i></tt>
argument of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
may be given as the value of one of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C6ECF5">tcsanow</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C6ECF5">tcsadrain=
</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C6ECF5">tcsaflush=
</a></tt>.
If it is omitted, the default is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C6ECF5">tcsadrain=
</a></tt>.
</p><p>
If an argument is given for
<tt><i>device</i></tt>
it must be either a stream, or an integer file descriptor.
In either case, it is expected to be associated with a
terminal (TTY) device.
</p><p>
If the argument is omitted, it defaults to the stream currently
stored in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream special variable, expected to be associated with
a terminal device.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
The C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure usually does not have members for representing the input
and output speed. <b>TXR Lisp</b> does not use such members, in any case, e=
ven
if they are present. The speeds are encoded in the
<tt>cc_iflag</tt>
and
<tt>cc_lflag</tt>
bitmasks. When retrieving the settings, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcgetattr=
</a></tt>
function uses the POSIX functions
<tt>cfgetispeed</tt>
and
<tt>cfgetospeed</tt>
to retrieve the speed values from the C structure. These values
are installed as the
<tt>ispeed</tt>
and
<tt>ospeed</tt>
slots of the Lisp structure.   A reverse conversion takes place
when setting are installed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>:
the speed values are taken from the slots, and installed into
the C structure using
<tt>cfsetispeed</tt>
and
<tt>cfsetospeed</tt>
before the structure is passed to the C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function.
</p><p>
On Linux, TTY devices do not have a separate input and output speed.
The C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure stores only one speed which is taken as both the input
and output speed, with a special exception. The input speed may be
programmed as zero. In that case, it is independently represented.
speed may be programmed as zero.
</p><p>

</p></dd></dl>
<a name=3D"N-033C365C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.11">9.76.11<=
/a> Function <tt>tcsendbreak</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tcsendbreak [</tt><tt><i>duration</i></tt><tt> [</tt><tt><=
i>device</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033C365C">tcsendbre=
ak</a></tt>
function generates a break signal on serial devices. The
<tt><i>duration</i></tt>
parameter specifies the length of the break signal in milliseconds.
If the argument is omitted, the value 500 is used.
</p><p>
The
<tt><i>device</i></tt>
parameter is exactly the same as that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-01AC4760">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.12">9.76.12<=
/a> Function <tt>tcdrain</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tcdrain [</tt><tt><i>device</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AC4760">tcdrain</=
a></tt>
function waits until all queued output on a terminal
device has been transmitted. It is a direct wrapper
for the like-named POSIX C function.
</p><p>
The
<tt><i>device</i></tt>
parameter is exactly the same as that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-034C4A4D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.13">9.76.13<=
/a> Function <tt>tcflush</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tcflush </tt><tt><i>queue</i></tt><tt> [</tt><tt><i>device=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034C4A4D">tcflush</=
a></tt>
function discards either untransmitted output data,
or received and yet unread input data, depending on the
value of the
<tt><i>queue</i></tt>
argument. It is a direct wrapper for the like-named
POSIX C function.
</p><p>
The
<tt><i>queue</i></tt>
argument should be the value of one of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0279ED46">tciflush<=
/a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0279ED46">tcoflush<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0279ED46">tcioflush=
</a></tt>,
which specify the flushing of input data, output
data or both.
</p><p>
The
<tt><i>device</i></tt>
parameter is exactly the same as that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-03081D51">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.14">9.76.14<=
/a> Function <tt>tcflow</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(tcflow </tt><tt><i>action</i></tt><tt> [</tt><tt><i>device=
</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03081D51">tcflow</a=
></tt>
function provides bi-directional flow control on the
specified terminal device. It is a direct wrapper
for the like-named POSIX C function.
</p><p>
The
<tt><i>action</i></tt>
argument should be the value of one of the
variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02173FF9">tcooff</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02173FF9">tcoon</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02173FF9">tcioff</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02173FF9">tcion</a>=
</tt>.
</p><p>
The
<tt><i>device</i></tt>
parameter is exactly the same as that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-02061924">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.15">9.76.15<=
/a> Methods <tt>set-iflags</tt>, <tt>set-oflags</tt>, <tt>set-cflags</tt>, =
<tt>set-lflags</tt>, <tt>clear-iflags</tt>, <tt>clear-oflags</tt>, <tt>clea=
r-cflags</tt> and <tt>clear-lflags</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(set-iflags </tt><tt><i>fl=
ags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(set-oflags </tt><tt><i>fl=
ags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(set-cflags </tt><tt><i>fl=
ags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(set-lflags </tt><tt><i>fl=
ags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(clear-iflags </tt><tt><i>=
flags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(clear-oflags </tt><tt><i>=
flags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(clear-cflags </tt><tt><i>=
flags</i></tt><tt>*)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(clear-lflags </tt><tt><i>=
flags</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These methods of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure set or clear multiple flags of the four bitmask flag fields.
</p><p>
The
<tt><i>flags</i></tt>
arguments specify zero or more integer values. These values
are combined together bitwise, as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
function to form a single effective mask.
If there are no
<tt><i>flags</i></tt>
arguments, then the effective mask is zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-iflag=
s</a></tt>
method sets, in the
<tt>iflag</tt>
slot of the
<tt><i>termios</i></tt>
structure, all of the bits which
are set in the effective mask. That is to say,
the effective mask is combined with the value in
<tt>iflag</tt>
by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000A">logior</a></t=
t>
operation, and the result is stored back into
<tt>iflag</tt>.
Similarly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-oflag=
s</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-cflag=
s</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-lflag=
s</a></tt>
methods operate on the
<tt>oflag</tt>,
<tt>cflag</tt>
and
<tt>lflag</tt>
slots of the structure.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-ifl=
ags</a></tt>
method clears, in the
<tt>iflag</tt>
slot of the
<tt><i>termios</i></tt>
structure, all of the bits which are
set in the effective mask. That is to say,
the effective mask is bitwise inverted as if
by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0024">lognot</a></t=
t>
function, and then combined with the
existing value of the
<tt>iflag</tt>
slot using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-001C">logand</a></t=
t>.
The resulting value is stored back into the
<tt>iflag</tt>
slot.
Similarly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-ofl=
ags</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-cfl=
ags</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-lfl=
ags</a></tt>
methods operate on the
<tt>oflag</tt>,
<tt>cflag</tt>
and
<tt>lflag</tt>
slots of the structure.
</p><p>
Note: the methods
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DCB007">go-raw</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DCB007">go-cbreak=
</a></tt>
and
<tt>go-canon</tt>
are provided for changing the settings to raw, "cbreak" and canonical mode.
These methods should be preferred to directly manipulating the flag and
<tt>cc</tt>
slots.
</p><p>
</p></dd><dt>Example</dt><dd>
<p>


</p><p>
In this example,
<tt>tio</tt>
is assumed to be a variable holding an instance of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
struct:
</p><p>
<tt>
</tt></p><pre><tt>  ;; clear the ignbrk, brkint, and various other flags:
  tio.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">clear-=
iflags</a> ignbrk brkint parmrk istrip
                    inlcr igncr icrnl ixon)

  ;; set the csize and parenb flags:
  tio.(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02061924">set-cf=
lags</a> csize parenb)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03DCB007">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.16">9.76.16<=
/a> Methods <tt>go-raw</tt> and <tt>go-cbreak</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(go-raw)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(go-cbreak)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DCB007">go-raw</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DCB007">go-cbreak=
</a></tt>
methods of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure manipulate the flag slots, as well as certain elements
of the
<tt>cc</tt>
slot, in order to prepare the terminal settings for, respectively,
"raw" and "cbreak" mode, described below.
</p><p>
Note that manipulating the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure doesn't actually put these settings into effect in
the terminal device; the settings represented by the structure must
be installed into the device using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013D13CA">tcsetattr=
</a></tt>.
There is no way to reverse the effect of these methods.
To precisely restore the previous terminal settings, the program
should retain a copy of the original
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure.
</p><p>
"Raw" mode refers to a configuration of the terminal device driver in which=
 input
and output is passed transparently and without accumulation, conversion or
interpretation. Input isn't buffered into lines; as soon as a single byte i=
s
received, it is available to the program. No special input characters such =
as
commands for generating an interrupt or process suspend request are process=
ed
by the terminal driver; all characters are treated as input data.  Input is=
n't
echoed; the only output which takes place is that generated by program
output requests to the device.
</p><p>
"Cbreak" mode is named after a concept and function in the "curses" termina=
l
control library. It refers to a configuration of the terminal device driver
which is less transparent than "raw" mode. Input isn't buffered into lines,
and line editing commands are ordinary input characters, allowing
character-at-a-time input. However, most input translations are preserved,
except that the conversion of CR characters to NL is disabled.  The
signal-generating characters are processed in this mode. This latter featur=
e of
the configuration is the likely inspiration for the word "cbreak". Unless
otherwise configured, the interrupt character corresponds to the Ctrl-C key=
,
and "break" is another term for an interactive interruption.
</p><p>

</p></dd></dl>
<a name=3D"N-033502F8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.76.17">9.76.17<=
/a> Methods <tt>string-encode</tt> and <tt>string-decode</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(string-encode)=20




<br>&nbsp;&nbsp;</tt><tt><i>termios</i></tt><tt>.(string-decode </tt><tt><i=
>string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-en=
code</a></tt>
method converts the terminal state stored in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039CD619">termios</=
a></tt>
structure into a textual format, returning that representation
as a character string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-de=
code</a></tt>
method parses the character representation produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-en=
code</a></tt>
and populates the
<tt><i>termios</i></tt>
structure with the settings are encoded in that string.
</p><p>
If a string is passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-de=
code</a></tt>
which wasn't produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-en=
code</a></tt>,
the behavior is unspecified. An exception may or may not be
thrown, and the contents of
<tt><i>termios</i></tt>
may or may not be affected.
</p><p>
Note: the textual representation produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-en=
code</a></tt>
is intended to be identical to that produced by the
<tt>-g</tt>
option of the GNU Coreutils version of the
<tt>stty</tt>
utility, on the same platform. That is to say, the output of
<tt>stty -g</tt>
may be used as input into
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-de=
code</a></tt>,
and the output of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033502F8">string-en=
code</a></tt>
may be used as an argument to
<tt>stty</tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-0191BDC8">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.77">9.77</a> Un=
ix System Identification</h3>



<p>


</p><p>

<a name=3D"N-003D12F6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.77.1">9.77.=
1</a> Structure <tt>utsname</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defstruct utsname nil=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;sysname nodename release=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;version machine domainname)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003D12F6">utsname</=
a></tt>
structure corresponds to the POSIX structure of the same name.
An instance of this structure is returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308D954">uname</a>=
</tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-0308D954">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.77.2">9.77.2</a=
> Function <tt>uname</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(uname)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308D954">uname</a>=
</tt>
function corresponds to the POSIX
function of the same name. It returns an instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003D12F6">utsname</=
a></tt>
structure.  Each slot of the returned structure is
initialized with a character string that identifies the corresponding attri=
bute
of the host system.
</p><p>
The host system might not support the reporting of the
NIS domain name. In this case, the
<tt>domainname</tt>
slot of the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003D12F6">utsname</=
a></tt>
structure will have the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-00708D78">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78">9.78</a> We=
b Programming Support</h3>



<p>


</p><p>

<a name=3D"N-0388DB26">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78.1">9.78.=
1</a> Functions <tt>url-encode</tt> and <tt>url-decode</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(url-encode </tt><tt><i>string</i></tt><tt> [</tt><tt><i>sp=
ace-plus-p</i></tt><tt>])=20




<br>&nbsp;&nbsp;(url-decode </tt><tt><i>string</i></tt><tt> [</tt><tt><i>sp=
ace-plus-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions convert character strings to and from a form which is suita=
ble for embedding into the request portions of URL syntax.
</p><p>
Encoding a string for URL use means identifying in it certain characters th=
at
might have a special meaning in the URL syntax and representing it using
"percent encoding": the percent character, followed by the ASCII value of t=
he
character.  Spaces and control characters are also encoded, as are all byte
values greater than or equal to 127 (7F hex).  The printable ASCII characte=
rs
which are percent-encoded consist of this set:
</p><p>
<tt>
</tt></p><pre><tt>  :/?#[]@!$&amp;'()*+,;=3D%
</tt></pre><tt>

</tt>

<p>
More generally, strings can consists of Unicode characters, but the URL
encoding consists only of printable ASCII characters. Unicode characters in=
 the
original string are encoded by expanding into UTF-8, and applying
percent-encoding the UTF-8 bytes, which are all in the range
<tt>\xx80-\xxFF</tt>.
</p><p>
Decoding is the reverse process: reconstituting the UTF-8 byte sequence
specified by the URL-encoding, and then decoding the UTF-8 sequence into th=
e
string of Unicode characters.
</p><p>
There is an additional complication: whether or not to encode spaces as plu=
s,
and to decode plus characters to spaces. In encoding, if spaces are not enc=
oded
to the plus character, then they are encoded as
<tt>%20</tt>,
since spaces are reserved
characters that must be encoded. In decoding, if plus characters are not
decoded to spaces, then they are left alone: they become plus characters in=
 the
decoded string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0388DB26">url-encod=
e</a></tt>
function performs the encoding process. If the
<tt>space-plus-p</tt>
argument is omitted or specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then spaces are encoded as
<tt>%20</tt>.
If the argument is a value other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then spaces are encoded as the
character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
<tt>(plus)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0388DB26">url-decod=
e</a></tt>
function performs the decoding process. If the
<tt>space-plus-p</tt>
argument is omitted or specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
<tt>(plus)</tt>
characters in the
encoded data are retained as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
characters in the decoded strings. Otherwise,
plus characters are converted to spaces.
</p><p>

</p></dd></dl>
<a name=3D"N-01263EAE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78.2">9.78.2</a=
> Functions <tt>html-encode</tt>, <tt>html-encode*</tt> and <tt>html-decode=
</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(html-encode </tt><tt><i>text-string</i></tt><tt>)=20




<br>&nbsp;&nbsp;(html-decode </tt><tt><i>html-string</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-deco=
de</a></tt>
functions convert between an HTML and raw
representation of text.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de</a></tt>
function returns a string which is based on the content of
<tt><i>text-string</i></tt>,
but in which all characters which have special meaning in HTML
have been replaced by HTML codes for representing those characters literall=
y.
The returned string is the HTML-encoded verbatim representation of
<tt><i>text-string</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-deco=
de</a></tt>
function converts
<tt><i>html-string</i></tt>,
which may contain HTML
character encodings, into a string which contains the actual characters
represented by those encodings.
</p><p>
The function composition
<tt>(html-decode (html-encode text))</tt>
returns a string which is equal to
<tt>text</tt>.
</p><p>
The reverse composition
<tt>(html-encode (html-decode html))</tt>
does not necessarily return a string equal to
<tt>html</tt>.
</p><p>
For instance if html is the string
<tt>"&lt;p&gt;Hello, world&amp;#33;&lt;/p&gt;"</tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-deco=
de</a></tt>
produces
<tt>"&lt;p&gt;Hello, world!&lt;/p&gt;"</tt>.
From this,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de</a></tt>
produces
<tt>"&amp;lt;p&amp;gt;Hello, world!&amp;lt;/p&amp;gt;"</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de*</a></tt>
function is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de</a></tt>
except that it does not encode the single and double quote characters
(ASCII 39 and 34, respectively). Text prepared by this function may not
be suitable for insertion into a HTML template, depending on the
context of its insertion. It is suitable as text placed between
tags but not necessarily as tag attribute material.
</p><p>

</p></dd></dl>
<a name=3D"N-01B05083">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78.3">9.78.3</a=
> Functions <tt>base64-encode</tt>, <tt>base64-decode</tt> and <tt>base64-d=
ecode-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(base64-encode [</tt><tt><i>string</i></tt><tt> | </tt><tt>=
<i>buf</i></tt><tt>] [</tt><tt><i>column-width</i></tt><tt>])=20




<br>&nbsp;&nbsp;(base64-decode </tt><tt><i>string)</i></tt><tt>=20




<br>&nbsp;&nbsp;(base64-decode-buf </tt><tt><i>string)</i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-en=
code</a></tt>
function converts the UTF-8 representation of
<tt><i>string</i></tt>,
or the contents of
<tt><i>buf</i></tt>,
to Base64 and returns that representation as a string.
The Base64 encoding is described in RFC 4648, section 5.
</p><p>
The second argument must either be a character string, or
a buffer object.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-de=
code</a></tt>
functions performs the opposite conversion; it extracts the
bytes encoded in a Base64 string, and decodes them as UTF-8
to return a character string.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-de=
code-buf</a></tt>
extracts the bytes encoded in a Base64 string, and returns
a new buffer object containing these bytes.
</p><p>
The Base64 encoding divides the UTF-8 representation of
<tt><i>string</i></tt>
or the bytes contained in
<tt><i>buf</i></tt>
into groups of six bits, each representing the values 0 to 63. Each value i=
s
then mapped to the characters
<tt>A</tt>
to
<tt>Z</tt>,
<tt>a</tt>
to
<tt>z</tt>,
the digits
<tt>0</tt>
to
<tt>9</tt>
and the characters
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>.
One or two consecutive occurrences of the character
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>
are added as padding so that the number of
non-whitespace characters is divisible by four. These characters map to
the code 0, but are understood not to contribute to the length of the
encoded message. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-en=
code</a></tt>
function enforces this convention, but
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-de=
code</a></tt>
doesn't require these padding characters.
</p><p>
Base64-encoding an empty string or zero-length buffer results in an empty
string.
</p><p>
If the
<tt><i>column-width</i></tt>
argument is passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-en=
code</a></tt>,
then the Base64 encoded string, unless empty, contains newline
characters, which divide it into lines which are
<tt><i>column-width</i></tt>
long, except possibly for the last line.
</p><p>

</p></dd></dl>
<a name=3D"N-03BEDB34">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78.4">9.78.4</a=
> Functions <tt>base64-stream-enc</tt> and <tt>base64-stream-dec</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(base64-stream-enc </tt><tt><i>out</i></tt><tt> </tt><tt><i=
>in</i></tt><tt> [</tt><tt><i>nbytes</i></tt><tt> [</tt><tt><i>column-width=
</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(base64-stream-dec </tt><tt><i>out</i></tt><tt> </tt><tt><i=
>in</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-enc</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-dec</a></tt>
perform, respectively, bulk Base64 encoding and decoding between streams.
This format is described in RFC 4648, section 5.
</p><p>
The
<tt><i>in</i></tt>
and
<tt><i>out</i></tt>
arguments must be stream objects.
The
<tt><i>out</i></tt>
stream must support output. In the decode operation, it must support
byte output.
The
<tt><i>in</i></tt>
stream must support input. In in the encode operation it must support
byte input.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-enc</a></tt>
function reads a sequence of bytes from the
<tt><i>in</i></tt>
stream and writes characters to the
<tt><i>out</i></tt>
stream comprising the Base64 encoding of that sequence. If the
<tt><i>nbytes</i></tt>
argument is specified, it must be a non-negative integer. At most
<tt><i>nbytes</i></tt>
bytes will be read from the
<tt><i>in</i></tt>
stream. If
<tt><i>nbytes</i></tt>
is omitted, then the operation will read from the
<tt><i>in</i></tt>
stream without limit, until that stream indicates that no more bytes
are available.
</p><p>
The optional
<tt><i>column-with</i></tt>
argument influences the formatting of Base64 output, in the same manner
as documented for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-en=
code</a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-dec</a></tt>
function reads the characters of a Base64 encoding from the
<tt><i>in</i></tt>
stream and writes the corresponding byte sequence to the
<tt><i>out</i></tt>
stream. It keeps reading and decoding until it encounters the end of the
stream, or a character not used in Base64: a character that is not whitespa=
ce
according to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B4C59">chr-isspa=
ce</a></tt>,
isn't any of the Base64 coding characters (not an alphanumeric character,
and not one of the characters
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006A">=3D</a></tt>.
If the function stops due to a non-Base64 character, that character is
pushed back into the
<tt><i>in</i></tt>
stream.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-enc</a></tt>
function returns the number of bytes encoded;
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-dec</a></tt>
function returns the number of bytes decoded.
</p><p>

</p></dd></dl>
<a name=3D"N-02D46C3D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78.5">9.78.5</a=
> Functions <tt>base64url-encode</tt>, <tt>base64url-decode</tt> and <tt>ba=
se64url-decode-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(base64url-encode [</tt><tt><i>string</i></tt><tt> | </tt><=
tt><i>buf</i></tt><tt>] [</tt><tt><i>column-width</i></tt><tt>])=20




<br>&nbsp;&nbsp;(base64url-decode </tt><tt><i>string)</i></tt><tt>=20




<br>&nbsp;&nbsp;(base64url-decode-buf </tt><tt><i>string)</i></tt><tt>=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D46C3D">base64url=
-encode</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D46C3D">base64url=
-decode</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D46C3D">base64url=
-decode-buf</a></tt>
functions conform, in nearly every respect, to the descriptions of,
respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-en=
code</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-de=
code</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B05083">base64-de=
code-buf</a></tt>.
The difference is that these functions use the encoding described in
section 6 of RFC 4648, rather than section 5. This means that, in the
encoding alphabet, instead of the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
(plus)
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(slash)
the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
(minus)
and
<tt>_</tt>
(underline) are used.
</p><p>

</p></dd></dl>
<a name=3D"N-016A14B3">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.78.6">9.78.6</a=
> Functions <tt>base64url-stream-enc</tt> and <tt>base64url-stream-dec</tt>=
</h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(base64url-stream-enc </tt><tt><i>out</i></tt><tt> </tt><tt=
><i>in</i></tt><tt> [</tt><tt><i>nbytes</i></tt><tt> [</tt><tt><i>column-wi=
dth</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(base64url-stream-dec </tt><tt><i>out</i></tt><tt> </tt><tt=
><i>in</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016A14B3">base64url=
-stream-enc</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016A14B3">base64url=
-stream-dec</a></tt>
functions conform, in nearly every respect, to the descriptions of,
respectively,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-enc</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03BEDB34">base64-st=
ream-dec</a></tt>.
The difference is that these functions use the encoding described in
section 6 of RFC 4648, rather than section 5. This means that, in the
encoding alphabet, instead of the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a></tt>
(plus)
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>
(slash)
the symbols
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
(minus)
and
<tt>_</tt>
(underline) are used.
</p><p>
</p></dd></dl>
<a name=3D"N-00062533">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79">9.79</a> Fi=
lter Module</h3>



<p>


The filter module provides a trie (pronounced "try") data structure,
which is suitable for representing dictionaries for efficient filtering.
Dictionaries are unordered collections of keys, which are strings, which
have associated values, which are also strings.  A trie can be used to filt=
er
text, such that keys appearing in the text are replaced by the correspondin=
g
values. A trie supports this filtering operation by providing an efficient
prefix-based lookup method which only looks at each input character once, a=
nd
which does not require knowledge of the length of the key in advance.
</p><p>

<a name=3D"N-03C1B843">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.1">9.79.=
1</a> Function <tt>make-trie</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-trie)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C1B843">make-trie=
</a></tt>
function creates an empty trie. There is no special data type for
a trie; a trie is some existing type such as a hash table.
</p><p>

</p></dd></dl>
<a name=3D"N-0006C677">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.2">9.79.2</a=
> Function <tt>trie-add</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trie-add </tt><tt><i>trie</i></tt><tt> </tt><tt><i>key</i>=
</tt><tt> </tt><tt><i>value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C677">trie-add<=
/a></tt>
function adds the string
<tt><i>key</i></tt>
to the trie, associating
it with
<tt><i>value</i></tt>.
If
<tt><i>key</i></tt>
already exists in
<tt><i>trie</i></tt>,
then the value is updated with
<tt><i>value</i></tt>.
</p><p>
The
<tt><i>trie</i></tt>
must not have been compressed with
<tt><i>trie-compress</i></tt>.
</p><p>
A trie can contain keys which are prefixes of other keys. For instance
it can contain
<tt>"dog"</tt>

and
<tt>"dogma"</tt>.
When a trie is used for matching
and substitution, the longest match is used. If the input presents
the text
<tt>"doggy"</tt>,
then the match is
<tt>"dog"</tt>.
If the input is
<tt>"dogmatic"</tt>,
then
<tt>"dogma"</tt>

matches.
</p><p>

</p></dd></dl>
<a name=3D"N-00026B83">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.3">9.79.3</a=
> Function <tt>trie-compress</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trie-compress </tt><tt><i>trie</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00026B83">trie-comp=
ress</a></tt>
function changes the representation of
<tt><i>trie</i></tt>
to a representation which occupies less space and supports faster lookups.
The new representation is returned.
</p><p>
The compressed representation of a trie does not support the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C677">trie-add<=
/a></tt>
function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00026B83">trie-comp=
ress</a></tt>
function destructively manipulates
<tt><i>trie</i></tt>,
and may return an object
that is the same object as
<tt>trie</tt>,
or it may return a different object,
while at the same time still modifying the internals of
<tt><i>trie</i></tt>.
Consequently, the program should not retain the input object
<tt>trie</tt>,
but use the returned object in its place.
</p><p>

</p></dd></dl>
<a name=3D"N-02D16290">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.4">9.79.4</a=
> Function <tt>trie-lookup-begin</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trie-lookup-begin </tt><tt><i>trie</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D16290">trie-look=
up-begin</a></tt>
function returns a context object for performing
an open-coded lookup traversal of a trie. The
<tt><i>tri</i></tt>
argument
is expected to be a trie that was created by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C1B843">make-trie=
</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-014E6D7B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.5">9.79.5</a=
> Function <tt>trie-lookup-feed-char</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trie-lookup-feed-char </tt><tt><i>trie-context</i></tt><tt=
> </tt><tt><i>char</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014E6D7B">trie-look=
up-feed-char</a></tt>
function performs a one character step in a trie
lookup. The
<tt><i>trie-context</i></tt>
argument must be a trie context returned
by
<tt><i>trie-lookup-begin</i></tt>,
or by some previous call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014E6D7B">trie-look=
up-feed-char</a></tt>.
The
<tt><i>char</i></tt>
argument is the next character to match.
</p><p>
If the lookup is successful (the match through the trie can continue
with the given character) then a new trie context object is returned.
The old trie context remains valid.
</p><p>
If the lookup is unsuccessful,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>
Note: determining whether a given string is stored in a trie can be
performed looking up every character of the string successively
with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014E6D7B">trie-look=
up-feed-char</a></tt>,
using the newly returned context
for each successive operation. If every character is found, it means
that either that exact string is found in the trie, or a prefix.
The ambiguity can be resolved by testing whether the trie has a value
at the last node using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012A5FAD">tree-valu=
e-at</a></tt>.
For instance, if
<tt>"catalog"</tt>

is inserted into an empty trie with value
<tt>"foo"</tt>,
then
<tt>"cat"</tt>

will look up successfully, being a prefix of
<tt>"catalog"</tt>;
however, the value at
<tt>"cat"</tt>

is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
indicating that
<tt>"cat"</tt>

is only a prefix of one or more entries in the trie.
</p><p>

</p></dd></dl>
<a name=3D"N-012A5FAD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.6">9.79.6</a=
> Function <tt>tree-value-at</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trie-value-at </tt><tt><i>trie-context</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>trie-value-at</tt>
function returns the value stored at the node in
in the trie given by
<tt><i>trie-context</i></tt>.
Nodes which have not been given
a value hold the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00C9EEB0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.7">9.79.7</a=
> Function <tt>filter-string-tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(filter-string-tree </tt><tt><i>filter</i></tt><tt> </tt><t=
t><i>obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C9EEB0">filter-st=
ring-tree</a></tt>
a tree structure similar to
<tt><i>obj</i></tt>,
in which all of the
string atoms have been filtered through
<tt><i>filter</i></tt>.
</p><p>
The
<tt><i>obj</i></tt>
argument is a string tree structure: either the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
denoting an empty structure; a string; or a list of tree structures. If
<tt><i>obj</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C9EEB0">filter-st=
ring-tree</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>filter</i></tt>
argument is a filter: it is either a trie, a function, or nil.
If
<tt><i>filter</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt>filter-string-trie</tt>
just returns
<tt><i>obj</i></tt>.
</p><p>
If
<tt><i>filter</i></tt>
is a function, it must be a function that can be called
with one argument. The strings of the string tree are filtered by passing
each one into the function and substituting the return value into the
corresponding place in the returned structure.
</p><p>
Otherwise if
<tt><i>filter</i></tt>
is a trie, then this trie is used for filtering,
the string elements similarly to a function. For each string, a new
string is returned in which occurrences of the keys in the trie are
replaced by the values in the trie.
</p><p>

</p></dd></dl>
<a name=3D"N-03136087">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.8">9.79.8</a=
> Function <tt>filter-equal</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(filter-equal </tt><tt><i>filter-1</i></tt><tt> </tt><tt><i=
>filter-2</i></tt><tt> </tt><tt><i>obj-1</i></tt><tt> </tt><tt><i>obj-2</i>=
</tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03136087">filter-eq=
ual</a></tt>
function tests whether two string trees are equal
under the given filters.
</p><p>
The precise semantics can be given by this expression:
</p><p>
<tt>




<br>&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">=
equal</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C9EEB0">fi=
lter-string-tree</a> </tt><tt><i>filter-1</i></tt><tt> </tt><tt><i>obj-1</i=
></tt><tt>)=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (<a href=3D"http://non=
gnu.org/txr/txr-manpage.html#N-00C9EEB0">filter-string-tree</a> </tt><tt><i=
>filter-2</i></tt><tt> </tt><tt><i>obj-2</i></tt><tt>))=20

</tt>

</p><p>
The string tree
<tt><i>obj-1</i></tt>
is filtered through
<tt><i>filter-1</i></tt>,
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C9EEB0">filter-st=
ring-tree</a></tt>
function, and similarly,
<tt><i>obj-2</i></tt>
is
filtered through
<tt><i>filter-2</i></tt>.
The resulting structures are compared
using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>,
and the result of that is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-00E48912">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.9">9.79.9</a=
> Function <tt>regex-from-trie</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(regex-from-trie </tt><tt><i>trie</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E48912">regex-fro=
m-trie</a></tt>
function returns a representation of
<tt><i>trie</i></tt>
as regular expression abstract syntax, suitable for
processing by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0168C611">regex-com=
pile</a></tt>
function.
</p><p>
The values stored in the trie nodes are not represented in
the regular expression.
</p><p>
The
<tt><i>trie</i></tt>
may be one that has been compressed via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00026B83">trie-comp=
ress</a></tt>;
in fact, a compressed
<tt><i>trie</i></tt>
results in more compact syntax.
</p><p>
Note: this function is useful for creating a compact, prefix-compressed
regular expression which matches a list of strings.
</p><p>

</p></dd></dl>
<a name=3D"N-00E6A902">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.79.10">9.79.10<=
/a> Special variable <tt>*filters*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6A902">*filters*=
</a></tt>
special variable holds a hash table which associates symbols with
filters. This hash table defines the named filters used in the
<b>TXR</b> pattern language. The names are the hash table keys, and filter
objects are the values. Filter objects are one of three representations.
The value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
represents a null filter, which performs no filtering, passing the input
string through. A filter object may be a raw or compressed trie.
It may also be a Lisp function, which must be callable with one argument
of string type, and must return a string.
</p><p>
The application may define new filters by associating symbolic keys in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6A902">*filters*=
</a></tt>
with values which conform to the above representation of filters.
</p><p>
The behavior is unspecified if any of the predefined filters
are removed or redefined, and are subsequently used, or if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6A902">*filters*=
</a></tt>
variable is replaced or rebound with a hash table value which omits
those keys, or associates them with different values.
</p><p>
Note that functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-enco=
de*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01263EAE">html-deco=
de</a></tt>
use, respectively, the HTML-related
<tt>:tohtml</tt>,
<tt>:tohtml*</tt>
and
<tt>:fromhtml</tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-016B867F">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.80">9.80</a> Ac=
cess To TXR Pattern Language From Lisp</h3>



<p>


</p><p>
It is useful to be able to invoke the abilities of the <b>TXR</b> pattern L=
anguage
from <b>TXR Lisp</b>. An interface for doing this provided in the form of t=
he
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F766A">match-fun=
</a></tt>
function, which is used for invoking a <b>TXR</b> pattern function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F766A">match-fun=
</a></tt>
function has a cumbersome interface which requires the <b>TXR Lisp</b> prog=
ram to
explicitly deal with the variable bindings emerging from the pattern match
in the form of an association list.
</p><p>
To make it the interface easier to use, <b>TXR</b> provides
the macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-if</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02311DCA">txr-when<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>.
</p><p>

<a name=3D"N-033F766A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.80.1">9.80.=
1</a> Function <tt>match-fun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(match-fun </tt><tt><i>name</i></tt><tt> </tt><tt><i>args</=
i></tt><tt> [</tt><tt><i>input</i></tt><tt> [</tt><tt><i>files</i></tt><tt>=
]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F766A">match-fun=
</a></tt>
function invokes a <b>TXR</b> pattern function whose name is
given by
<tt><i>name</i></tt>,
which must be a symbol.
</p><p>
The
<tt><i>args</i></tt>
argument is a list of expressions. The expressions may be symbols
which will be interpreted as pattern variables, and may be bound or unbound=
.
If they are not symbols, then they are treated as expressions (of the
pattern language, not <b>TXR Lisp</b>) and evaluated accordingly.
</p><p>
The
<tt><i>input</i></tt>
argument is a list of strings, which may be lazy. It represents the
lines of the text stream to be processed. If omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>files</i></tt>
argument is a list of filename specifications, which follow
the same conventions as files given on the <b>TXR</b> command line. If the =
pattern
function uses the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive, it can process these additional files. If this argument is
omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F766A">match-fun=
</a></tt>
function's return value falls into three cases. If there is a
match failure, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
Otherwise it returns a cons cell. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
field
of the cons cell holds the list of captured bindings. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
of the cons cell is one of two values. If the entire input was processed, t=
he
cdr field holds the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise it holds another cons cell whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
is the remainder of the list of lines which were not matched, and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
is the line number.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  @(define foo (x y))
  @x:@y
  @line
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a>
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011ACA52">format<=
/a> t "~s\n"
               (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F766=
A">match-fun</a> 'foo '(a b)
                          '("alpha:beta" "gamma" "omega") nil)))

  Output:
  (((a . "alpha") (b . "beta")) ("omega") . 3)
</tt></pre><tt>

</tt>

<p>
In the above example, the pattern function
<tt>foo</tt>
is called with arguments
<tt>(a b)</tt>.
These are unbound variables, so they correspond to parameters
<tt>x</tt>
and
<tt>y</tt>
of the function. If
<tt>x</tt>
and
<tt>y</tt>
get bound, those values propagate to
<tt>a</tt>
and
<tt>b</tt>.
The data being matched consists of the lines
<tt>"alpha:beta"</tt>,
<tt>"gamma"</tt>

and
<tt>"omega"</tt>.
Inside
<tt>foo</tt>,
<tt>x</tt>
and
<tt>y</tt>
bind to
<tt>"alpha"</tt>

and
<tt>"beta"</tt>,
and then the line variable binds to
<tt>"gamma"</tt>.
The input stream is left with
<tt>"omega"</tt>.
</p><p>
Hence, the return value consists of the bindings of
<tt>x</tt>
and
<tt>y</tt>
transferred to
<tt>a</tt>
and
<tt>b</tt>,
and the second cons cell which gives information about the rest of the
stream: it is the part starting at
<tt>"omega"</tt>,
which is line 3. Note that the binding for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5D09D">line</a><=
/tt>
variable does not propagate
out of the pattern function
<tt>foo</tt>;
it is local inside it.
</p><p>

</p></dd></dl>
<a name=3D"N-00355D4E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.80.2">9.80.2</a=
> Macro <tt>txr-if</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(txr-if </tt><tt><i>name</i></tt><tt> (</tt><tt><i>argument=
</i></tt><tt>*) </tt><tt><i>input</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </tt><tt><i>then=
-expr</i></tt><tt> [</tt><tt><i>else-expr</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-if</a=
></tt>
macro invokes the <b>TXR</b> pattern matching function
<tt><i>name</i></tt>
on some input given by the
<tt><i>input</i></tt>
parameter, which is a list of strings, or a single string.
</p><p>
If
<tt><i>name</i></tt>
succeeds, then
<tt><i>then-expr</i></tt>
is evaluated, and if it fails,
<tt><i>else-expr</i></tt>
is evaluated instead.
</p><p>
In the successful case,
<tt><i>then-expr</i></tt>
is evaluated in a scope in which the bindings emerging from the
<tt><i>name</i></tt>
function are turned into <b>TXR Lisp</b> variables.
The result of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-if</a=
></tt>
is that of
<tt><i>then-expr</i></tt>.
</p><p>
In the failed case,
<tt><i>else-expr</i></tt>
is evaluated in a scope which does not have any new bindings.
The result of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-if</a=
></tt>
is that of
<tt><i>else-expr</i></tt>.
If
<tt><i>else-expr</i></tt>
is missing, the result is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>argument</i></tt>
forms supply arguments to the pattern function
<tt><i>name</i></tt>.
There must be as many of these arguments as the function
has parameters.
</p><p>
Any argument which is a symbol is treated, for the purposes
of calling the pattern function, as an unbound pattern variable.
The function may or may not produce a binding for that variable.
Also, every argument which is a symbol also denotes a local variable
that is established around
<tt><i>then-expr</i></tt>
if the function succeeds. For any such pattern variable for which the funct=
ion
produces a binding, the corresponding local variable will be initialized
with the value of that pattern variable. For any such pattern variable
which is left unbound by the function, the corresponding local variable
will be set to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Any
<tt><i>argument</i></tt>
can be a form other than a symbol. In this situation, the argument is
evaluated, and will be passed to the pattern function as the value of
the binding for the corresponding argument.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  @(define date (year month day))
  @{year /\d\d\d\d/}-@{month /\d\d/}-@{day /\d\d/}
  @(end)
  @(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a>
     (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0105F01D">each</a=
> ((date '("09-10-20" "2009-10-20"
                    "July-15-2014" "foo")))
       (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-i=
f</a> date (y m d) date
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put=
-line</a> `match: year @y, month @m, day @d`)
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put=
-line</a> `no match for @date`))))

  Output:

  no match for 09-10-20
  match: year 2009, month 10, day 20
  no match for July-15-2014
  no match for foo
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02311DCA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.80.3">9.80.3</a=
> Macro <tt>txr-when</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(txr-when </tt><tt><i>name</i></tt><tt> (</tt><tt><i>argume=
nt</i></tt><tt>*) </tt><tt><i>input</i></tt><tt> </tt><tt><i>form</i></tt><=
tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02311DCA">txr-when<=
/a></tt>
macro is based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-if</a=
></tt>.
It is equivalent to
</p><p>
<tt>




&nbsp;&nbsp;(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">=
txr-if</a> </tt><tt><i>name</i></tt><tt> (</tt><tt><i>argument</i></tt><tt>=
*) </tt><tt><i>input</i></tt><tt> (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03F7A8B8">progn</a> </tt><tt><i>form</i></tt><tt>*))=20

</tt>

</p><p>
If the pattern function
<tt><i>name</i></tt>
produces a match, then each
<tt><i>form</i></tt>
is evaluated in the scope of the variables established by the
<tt><i>argument</i></tt>
expressions. The result of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02311DCA">txr-when<=
/a></tt>
form is that of the last
<tt><i>form</i></tt>.
</p><p>
If the pattern function fails then the forms are not evaluated,
and the result value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03813122">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.80.4">9.80.4</a=
> Macro <tt>txr-case</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(txr-case </tt><tt><i>input-form</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; {(</tt><tt><i>name</i></tt><tt> (</tt><tt><i>a=
rgument</i></tt><tt>*) </tt><tt><i>form</i></tt><tt>*)}*=20




<br>&nbsp;&nbsp;&nbsp;&nbsp; [(</tt><tt><i>t</i></tt><tt> </tt><tt><i>form<=
/i></tt><tt>*)])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>
macro evaluates
<tt><i>input-form</i></tt>
and then uses the value as an input to zero or more test clauses.
Each test clause invokes the pattern function named by that clause's
<tt><i>name</i></tt>
argument.
</p><p>
If the function succeeds, then each
<tt><i>form</i></tt>
is evaluated, and the value of the last
<tt><i>form</i></tt>
is taken to be the result value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>,
which terminates. If there are no forms, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>
terminates with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
result.
</p><p>
The forms are evaluated in an environment in which variables are bound
based on the
<tt><i>argument</i></tt>
forms, with values depending on the result of the
invocation of the
<tt><i>name</i></tt>
pattern function, in the same manner as documented in detail for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00355D4E">txr-if</a=
></tt>
macro.
</p><p>
If the function fails, then the forms are not evaluated, and control passes=
 to
the next clause.
</p><p>
A clause which begins with the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
executes unconditionally and causes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>
to terminate. If it has no forms, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>
yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
otherwise the forms are evaluated in order and the value of the last
one specifies the result of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03813122">txr-case<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02AC7FB4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.80.5">9.80.5</a=
> Function <tt>txr-parse</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(txr-parse [</tt><tt><i>source</i></tt><tt> [</tt><tt><i>er=
ror-stream</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp; [</tt><tt><i>error-retval</i></tt><tt> [</tt><tt><i>name</i></tt><t=
t>]]]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AC7FB4">txr-parse=
</a></tt>
function converts textual <b>TXR</b> query syntax into a Lisp data
structure representation.
</p><p>
The
<tt><i>source</i></tt>
argument may be either a character
string, or a stream.  If it is omitted, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
is used as the stream.
</p><p>
The
<tt><i>source</i></tt>
must provide the text representation of one complete <b>TXR</b> query.
</p><p>
The optional
<tt><i>error-stream</i></tt>
argument can be used to specify a stream to which
parse errors diagnostics are sent. If absent, the diagnostics are suppresse=
d.
</p><p>
The optional
<tt><i>name</i></tt>
argument can be used to specify the file name which is used for reporting
errors. If this argument is missing, the name is taken from the name
property of the
<tt><i>source</i></tt>
argument if it is a stream, or else the word
<tt>string</tt>
is used as the name if
<tt><i>source</i></tt>
is a string.
</p><p>
If there are no parse errors, the function returns the parsed data
structure. If there are parse errors, and the
<tt><i>error-retval</i></tt>
parameter is
present, its value is returned. If the
<tt><i>error-retval</i></tt>
parameter
is not present, then an exception of type
<tt>syntax-error</tt>
is thrown.
</p><p>
</p></dd></dl>
<a name=3D"N-00D4DA37">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.81">9.81</a> De=
bugging Functions</h3>



<p>



<a name=3D"N-0370CD69">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.81.1">9.81.=
1</a> Functions <tt>source-loc</tt> and <tt>source-loc-str</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(source-loc </tt><tt><i>form</i></tt><tt>)=20




<br>&nbsp;&nbsp;(source-loc-str </tt><tt><i>form</i></tt><tt> [</tt><tt><i>=
alternative</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These functions map an expression in a <b>TXR</b> program to the file name =
and
line number of the source code where that form came from.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0370CD69">source-lo=
c</a></tt>
function returns the raw information as a cons cell
whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>/=
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
consist of the line number, and file name.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0370CD69">source-lo=
c-str</a></tt>
function formats the information as a string.
</p><p>
Forms which were parsed from a file have source location info
tracking to their origin in that file. Forms which are the result
of macro-expansion are traced to the form whose evaluation produced
them. That is to say, they inherit that form's source location info.
</p><p>
More precisely, when a form is produced by macro-expansion,
it usually consists of material which was passed to the macro as arguments,
plus some original material allocated by the macro, and possibly
literal structure material which is part of the macro code.
After the expansion is produced, any of its constituent material
which already has source location info keeps that info. Those nodes
which are newly allocated by the macro-expansion process inherit
their source location info from the form which yields the expansion.
</p><p>
If
<tt><i>form</i></tt>
is not a piece of the program source code that was constructed by the
<b>TXR</b> parser or by a macro, and thus it was neither attributed with
source location info, nor has it inherited such info, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0370CD69">source-lo=
c</a></tt>
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
In the same situation, and if its
<tt><i>alternative</i></tt>
argument is missing, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0370CD69">source-lo=
c-str</a></tt>
returns a string whose text conveys that the source location is not
available. If the
<tt><i>alternative</i></tt>
argument is present, it is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-024EB211">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.81.2">9.81.2</a=
> Functions <tt>rlcp</tt> and <tt>rlcp-tree</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(rlcp </tt><tt><i>dest-form</i></tt><tt> </tt><tt><i>source=
-form</i></tt><tt>)=20




<br>&nbsp;&nbsp;(rlcp </tt><tt><i>dest-tree</i></tt><tt> </tt><tt><i>source=
-form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024EB211">rlcp</a><=
/tt>
function copies the source code location info ("rl" means "read location")
from the
<tt><i>source-form</i></tt>
object to the
<tt><i>dest-form</i></tt>
object. These objects
are pieces of list-based syntax.
If
<tt><i>dest-form</i></tt>
already has source code location info, then no copying
takes place.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024EB211">rlcp-tree=
</a></tt>
function copies the source code location info from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024EB211">rlcp</a><=
/tt>
into every cons cell in the
<tt><i>dest-tree</i></tt>
tree structure which doesn't already have location info.
It may be regarded as a recursive application of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024EB211">rlcp</a><=
/tt>
via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>/=
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
recursion on the tree structure. However, the traversal performed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024EB211">rlcp-tree=
</a></tt>
gracefully handles circular structures.
</p><p>
Note: these functions are intended to be used in certain kinds of macros. I=
f a
macro transforms
<tt><i>source-form</i></tt>
to
<tt><i>dest-form</i></tt>,
this function can be used to propagate the
source code location info also, so that when the <b>TXR Lisp</b> evaluator
encounters errors in transformed code, it can give diagnostics which refer
to the original untransformed source code.
</p><p>
The macro expander already performs this transfer. If a macro call form
has location info, the expander propagates that info to that form's
expansion. In some situations, it is useful for a macro or other code
transformer to perform this action explicitly.
</p><p>

</p></dd></dl>
<a name=3D"N-014AFEA9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.81.3">9.81.3</a=
> Special variable <tt>*rec-source-loc*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The Boolean special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014AFEA9">*rec-sour=
ce-loc*</a></tt>
controls whether the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">read</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03FE5500">iread</a>=
</tt>
functions record source location info. The variable is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
by default, so that these functions do not record source location info.
If it is true, then these functions record source location info.
</p><p>
Regardless of the value of this variable, source location info is
recorded for Lisp forms which are read from files or streams under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function or specified on the <b>TXR</b> command line. Source location
info is also always recorded when reading the <b>TXR</b> pattern language s=
yntax.
</p><p>
Note: recording and propagating location info incurs a memory and performan=
ce
penalty.  The individual cons cells and certain other literal objects in th=
e
structure which emerges from the parser are associated with source location
info via a global weak hash table.
</p><p>
</p><p>

</p></dd></dl>
<a name=3D"N-00519E96">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.81.4">9.81.4</a=
> Function <tt>macro-ancestor</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(macro-ancestor </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00519E96">macro-anc=
estor</a></tt>
function returns information about the macro-expansion ancestor of
<tt><i>form</i></tt>.
The ancestor is the original form whose expansion produced
<tt><i>form</i></tt>.
</p><p>
If
<tt><i>form</i></tt>
is not the result of macro-expansion, or the ancestor information
is unavailable, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-01D04262">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.82">9.82</a> Pr=
ofiling</h3>



<p>



<a name=3D"N-004C9B10">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.82.1">9.82.=
1</a> Operator <tt>prof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(prof </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004C9B10">prof</a><=
/tt>
operator evaluates the enclosed forms from left to right similarly
to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>,
while determining the memory allocation requests and time
consumed by the evaluation of the forms.
</p><p>
If there are no forms, the prof operator measures the smallest measurable
operation of evaluating nothing and producing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If the evaluation terminates normally (not abruptly by a non-local
control transfer), then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004C9B10">prof</a><=
/tt>
yields a list consisting of:
</p><p>
<tt>




<br>&nbsp;&nbsp;(</tt><tt><i>value</i></tt><tt> </tt><tt><i>malloc-bytes</i=
></tt><tt> </tt><tt><i>gc-bytes</i></tt><tt> </tt><tt><i>milliseconds</i></=
tt><tt>)=20

</tt>

</p><p>
where
<tt><i>value</i></tt>
is the value returned by the rightmost
<tt><i>form</i></tt>,
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no forms,
<tt><i>malloc-bytes</i></tt>
is the total number of bytes of all memory allocation
requests (or at least those known to the <b>TXR</b> runtime, such as those =
of all
internal objects),
<tt><i>gc-bytes</i></tt>
is the total number of bytes drawn from the
garbage-collected heaps, and
<tt><i>milliseconds</i></tt>
is the total processor time
consumed over the execution of those forms.
</p><p>
Notes:
</p><p>
The bytes allocated by the garbage collector from the C function
<tt>malloc</tt>
to create
heap areas are not counted as
<tt><i>malloc-bytes</i></tt>.
<tt><i>malloc-bytes</i></tt>
includes storage
such as the space used for dynamic strings, vectors and bignums (in additio=
n to
their gc-heap-allocated nodes), and the various structures used by the
<tt>cobj</tt>
type objects such as streams and hashes. Objects in external libraries that=
 use
uninstrumented allocators are not counted: for instance the C
<tt>FILE *</tt>
streams.
</p><p>

</p></dd></dl>
<a name=3D"N-018C92AB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.82.2">9.82.2</a=
> Macro <tt>pprof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(pprof </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C92AB">pprof</a>=
</tt>
(pretty-printing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004C9B10">prof</a><=
/tt>)
macro is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>.
It evaluates
<tt><i>form</i></tt>-s,
and returns the rightmost one, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if there are no forms.
</p><p>
Over the evaluation of
<tt><i>form</i></tt>-s,
it counts memory allocations, and measures
CPU time. If
<tt><i>form</i></tt>-s
terminate normally, then just prior to returning,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C92AB">pprof</a>=
</tt>
prints these statistics in a concise report on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C92AB">pprof</a>=
</tt>
macro relies on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-004C9B10">prof</a><=
/tt>
operator.
</p><p>
</p></dd></dl>
<a name=3D"N-01D94F50">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.83">9.83</a> Ga=
rbage Collection</h3>



<p>



<a name=3D"N-01C75157">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.83.1">9.83.=
1</a> Function <tt>sys:gc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sys:gc [</tt><tt><i>full</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>gc</tt>
function triggers garbage collection.  Garbage collection means
that unreachable objects are identified and reclaimed, so that their
storage can be re-used.
</p><p>
The function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if garbage collection is disabled (and consequently nothing is done), other=
wise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
</p><p>
The Boolean
<tt><i>full</i></tt>
argument, defaulting to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
indicates whether a full garbage collection should be requested.
</p><p>
Even if this argument is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
a full garbage collection may occur due to having been scheduled.
</p><p>

</p></dd></dl>
<a name=3D"N-02C0C748">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.83.2">9.83.2</a=
> Function <tt>sys:gc-set-delta</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sys:gc-set-delta </tt><tt><i>bytes</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>gc-set-delta</tt>
function sets the GC delta parameter.
</p><p>
Note: This function may disappear in a future release of <b>TXR</b> or suff=
er
a backward-incompatible change in its syntax or behavior.
</p><p>
When the amount of new dynamic memory allocated since the last garbage
collection equals or exceeds the GC delta, a garbage collection pass is
triggered. From that point, a new delta begins to be accumulated.
</p><p>
Dynamic memory is used for allocating heaps of small garbage-collected obje=
cts
such as cons cells, as well as the satellite data attached to some objects:
like the storage arrays of vectors, strings or bignum integers. Most garbag=
e
collector behaviors are based on counting objects in the heaps.
</p><p>
Sometimes a program works with a small number of objects which are very lar=
ge,
frequently allocating new, large objects and turning old ones into garbage.
For instance a single large integer could be many megabytes long.  In such =
a
situation, a small number of heap objects therefore control a large amount =
of
memory.  This requires garbage collection to be triggered much more often t=
han
when working with small objects, such as conses, to prevent runaway allocat=
ion
of memory. It is for this reason that the garbage collector uses the GC del=
ta.
</p><p>
There is a default GC delta of 64 megabytes. This may be overridden in
special builds of <b>TXR</b> for small systems.
</p><p>

</p></dd></dl>
<a name=3D"N-01230613">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.83.3">9.83.3</a=
> Function <tt>finalize</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(finalize </tt><tt><i>object</i></tt><tt> </tt><tt><i>funct=
ion</i></tt><tt> [</tt><tt><i>reverse-order-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize<=
/a></tt>
function registers
<tt><i>function</i></tt>
to be invoked in the situation when
<tt><i>object</i></tt>
is identified by the garbage collector as unreachable.
A function registered in this way is called a finalizer.
</p><p>
If and when this situation occurs, the finalizer
<tt><i>function</i></tt>
will be called with
<tt><i>object</i></tt>
as its only argument.
</p><p>
Multiple finalizer functions can be registered for the same object,
up to an internal limit which is not required to be greater than 255.
If the limit is exceeded,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize<=
/a></tt>
throws an error exception.
</p><p>
All registered finalizers are called when the object becomes unreachable.
Finalizers registered against an object may also be invoked
and removed using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
function.
</p><p>
If the
<tt><i>reverse-order-p</i></tt>
argument isn't specified, or is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then finalizer is registered at the end of the list.
</p><p>
If
<tt><i>reverse-order-p</i></tt>
is true, then the finalizer is registered at the front of
the list.
</p><p>
Finalizers which are activated in the same finalization processing phase
are called in the order in which they appear in the
registration list.
</p><p>
After a finalization call takes place, its registration is removed.  Howeve=
r,
neither
<tt><i>object</i></tt>
nor
<tt><i>function</i></tt>
are reclaimed immediately; they are treated as if they were reachable objec=
ts
until at least the next garbage collection pass.
It is therefore safe for
<tt><i>function</i></tt>
to store somewhere a persistent reference to
<tt><i>object</i></tt>
or to itself, thereby reinstating these objects as reachable.
</p><p>
A finalizer is itself permitted to call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize<=
/a></tt>
to register the original
<tt>object</tt>
or any other object for finalization. Finalization processing can be
understood as taking place in one or more rounds.  At the start of each rou=
nd,
finalizers are identified that are to be called, arranged in order, and rem=
oved
from the registration list. If this identification stage produces no
finalizers, then finalization ends. Otherwise, those finalizers are process=
ed,
and then another round is initiated, to look for eligible finalizers that m=
ay have been
registered during the previous round.
</p><p>
Note: it is possible for the application to create an infinite finalization
loop, if one or more objects have finalizers that register new finalizers,
which register new finalizers and so on.
</p><p>
Note: if a finalizer is invoked by the garbage collector rather than explic=
it
finalization via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>,
and that finalizer calls
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize<=
/a></tt>
to make a registration, that registration will not be eligible for processi=
ng in
the same phase, because the criteria for finalization is unreachability.
</p><p>

</p></dd></dl>
<a name=3D"N-02AF83A0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.83.4">9.83.4</a=
> Function <tt>call-finalizers</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(call-finalizers </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
function invokes and removes the finalizers, if any, registered against
<tt><i>object</i></tt>.
If any finalizers are called, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
otherwise
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Finalization performed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
works in the manner described under the specification of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01230613">finalize<=
/a></tt>
function.
</p><p>
It is permissible for a finalizer function itself to call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>.
Such a call can happen in two possible contexts: finalization
initiated by by garbage collection, or under the scope of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
invocation from application code. Doing so is safe, since the finalization
logic may be re-entered recursively.  When finalizers are being called duri=
ng a
round of processing, those finalizers have already been removed from the
registration list, and will not be redundantly invoked by a recursive
invocation of finalization.
</p><p>
Under the scope of garbage-collection-driven reclamation, the
order of finalizer calls may not be what the application logic
expects. For instance even though a finalizer registered for some object
<tt>A</tt>
itself invokes
<tt>(call-finalizers B)</tt>,
it may be the case during GC reclamation that both
<tt>A</tt>
and
<tt>B</tt>
are identified as unreachable objects at the same time, and some or all
finalizers registered against
<tt>B</tt>
have already been called before the given
<tt>A</tt>
finalizer performs the explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
invocation against
<tt>B</tt>.
Thus the the call either has no effect at all, or only calls some remaining
<tt>B</tt>
finalizers that have not yet been processed, rather than all of them,
as the application expects.
</p><p>
The application must avoid creating a dependency on the order of
finalization calls, to prevent the situation that the finalization actions =
are
only correct under an explicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02AF83A0">call-fina=
lizers</a></tt>
but incorrect under spontaneous reclamation driven by garbage collection.
</p><p>
</p></dd></dl>
<a name=3D"N-01A6690F">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84">9.84</a> Mo=
dularization</h3>



<p>



<a name=3D"N-03561A65">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84.1">9.84.=
1</a> Variable <tt>self-path</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This variable holds the invocation path name of the <b>TXR</b> program.
The value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03561A65">self-path=
</a></tt>
when <b>TXR Lisp</b> expressions are being evaluated in command line argume=
nts
is the string
<tt>"cmdline-expr"</tt>.
The value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03561A65">self-path=
</a></tt>
when a <b>TXR</b> query is supplied on the command line via the
<tt>-c</tt>
command line option is the string
<tt>"cmdline"</tt>.
</p><p>
Note that for programs read from a file,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03561A65">self-path=
</a></tt>
holds the resolved name, and not the invocation name. For instance if
<tt>foo.tl</tt>
is invoked using the name
<tt>foo</tt>,
whereby <b>TXR</b> infers the suffix, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03561A65">self-path=
</a></tt>
holds the suffixed name.
</p><p>

</p></dd></dl>
<a name=3D"N-008E4BC2">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84.2">9.84.2</a=
> Variable <tt>stdlib</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008E4BC2">stdlib</a=
></tt>
variable expands to the directory where the <b>TXR</b> standard library
is installed. It includes the trailing slash.
</p><p>
Note: there is no need to use the value of this variable to load library
modules. Library modules are keyed to specific symbols, and lazily loaded. =
When
a <b>TXR Lisp</b> library function, macro or variable is referenced for the=
 first time,
the library module which defines it is loaded.  This includes references
which occur during the code expansion phase, at "macro time", so it works f=
or
macros. In the middle of processing a syntax tree, the expander may encount=
er a
symbol that is registered for auto-loading, and trigger the load. When the =
load
completes, the symbol might now be defined as a macro, which the expander
can immediately use to expand the given form that is being traversed.
</p><p>

</p></dd></dl>
<a name=3D"N-0306CE9C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84.3">9.84.3</a=
> Function <tt>load</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(load </tt><tt><i>target</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function causes a file containing <b>TXR Lisp</b> or <b>TXR</b> code to be =
read and processed.
The
<tt><i>target</i></tt>
argument is a string. The function can load <b>TXR Lisp</b> source files as=
 well
as compiled files.
</p><p>
Firstly, the value in
<tt><i>target</i></tt>
is converted to a
<i>tentative pathname</i>

as follows.
</p><p>
If
<tt><i>target</i></tt>
specifies a pure relative pathname, as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019DEA44">pure-rel-=
path-p</a></tt>
function, then a special behavior applies.
If an existing load operation is in progress, then the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
has a binding. In this case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
will assume that the relative pathname is a reference relative to the
directory portion of that path name.
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
has the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then a pure relative
<tt><i>target</i></tt>
pathname is used as-is, and thus resolved relative to the current working
directory.
</p><p>
Once the tentative path name is determined,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
determines whether the name is suffixed. The name is suffixed if it
ends in any of these four suffixes:
<tt>.tlo</tt>,
<tt>.tl</tt>,
<tt>.txr</tt>
or
<tt>.txr_profile</tt>.
</p><p>
Depending on whether the tentative path name is suffixed,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
tries to make one or more attempts to open several variations of that name.
These variations are called
<i>actual paths .</i>

If any attempt fails due to an error other than non-existence,
such as a permission error, then no further attempts are made; the
error exception propagates to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
's
caller.
</p><p>
If the tentative path name is suffixed, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
tries to open a file by that actual path name. If that attempt
fails, no other names are tried.
</p><p>
If the tentative path name is unsuffixed, then first the suffix
<tt>.tlo</tt>
is appended to the name, and an attempt is made to open a file
with this actual path. If that file is not found, then the suffix
<tt>.tl</tt>
is similarly tried. If that file is not found, then the unsuffixed
name is tried.
</p><p>
If an unsuffixed file is opened, its contents are treated as interpreted Li=
sp.
Files ending in
<tt>.txr_profile</tt>
are also treated as interpreted Lisp. Files ending in
<tt>.tlo</tt>
are treated as compiled Lisp, and those ending in
<tt>.txr</tt>
are treated as the <b>TXR</b> Pattern Language.
</p><p>
If the file is treated as <b>TXR Lisp</b>, then Lisp forms are read from it=
 in
succession. Each form is evaluated as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
function, before the next form is read.
If a syntax error is encountered, an exception of type
<tt>eval-error</tt>
is thrown.
</p><p>
If a file is treated as a compiled <b>TXR Lisp</b> object file, then the co=
mpiled images
of top-level forms are read from it, converted into compiled objects, and
executed.
</p><p>
If the file treated as <b>TXR</b> Pattern Language code,
then its contents are parsed in their entirety.
If the parse is successful, the query is executed.
Previous <b>TXR</b> pattern variable and function bindings are in
effect. If the query binds new variables and functions,
these emerge from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
and take effect. If the parse is unsuccessful, an exception of type
<tt>query-error</tt>
is thrown.
</p><p>
Parser error messages are directed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stderr*<=
/a></tt>
stream.
</p><p>
Over the evaluation of either a <b>TXR Lisp</b>, compiled file, or <b>TXR</=
b> file,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
establishes a new dynamic binding for several special
variables. The variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
is given a new binding containing the actual path name.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable is also given a new dynamic binding, whose value is the
same as the existing binding. Thus if the processing of the
loaded file has the effect of altering the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>,
that effect will be undone when the binding is removed
after the load completes.
</p><p>
When the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function terminates normally after processing a file,
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If the file contains a <b>TXR</b> pattern query which is
processed to completion, the matching success or failure
of that query has no bearing on the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
.
Note that this behavior is different from the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a>)</=
tt>
directive which itself fails if the loaded query
fails, causing subsequent directives not to be processed.
</p><p>
A <b>TXR</b> pattern language file loaded with the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function does not have the usual implicit access to the
command line arguments, unlike a top-level <b>TXR</b> query.
If the directives in the file try to match input, they
work against the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>
stream.  The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive behaves as it does when no more arguments
are available.
</p><p>
If the source or compiled file begins with the characters
<tt>#!</tt>,
usually indicating "hash bang" script,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
reads reads the first line of the file and discards it.
Processing of the file then begins with the first byte
following that line.
</p><p>

</p></dd></dl>
<a name=3D"N-01D1DB58">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84.4">9.84.4</a=
> Special variable <tt>*load-path*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
special variable has a top-level value which is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
When a file is being loaded, it is dynamically bound to the
path name of that file. This value is visible to the forms
are evaluated in that file during the loading process.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
variable is is bound when a file is loaded from the command
line.
</p><p>
If the
<tt>-i</tt>
command line option is used to enter the interactive listener,
and a file to be loaded is also specified, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
variable remains bound to the name of that file inside the
listener.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function establishes a binding for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
prior to processing and evaluating all the top-level forms
in the target file. When the forms are evaluated, the binding
is discarded and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
returns.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
function also establishes a binding for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>.
</p><p>
The
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a>)</=
tt>
directive, also similarly establishes a binding around the
parsing and processing of a loaded <b>TXR</b> source file.
</p><p>
Also, during the processing of the profile file (see Interactive Profile Fi=
le),
the variable is bound to the name of that file.
</p><p>

</p></dd></dl>
<a name=3D"N-0020A085">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84.5">9.84.5</a=
> Macro <tt>load-for</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(load-for {(</tt><tt><i>kind</i></tt><tt> </tt><tt><i>sym</=
i></tt><tt> </tt><tt><i>target</i></tt><tt>)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0020A085">load-for<=
/a></tt>
macro takes multiple arguments, each of which is a three-element
clause. Each clause specifies that a given
<tt><i>target</i></tt>
file is to be conditionally loaded based on whether a symbol
<tt><i>sym</i></tt>
has a certain kind of binding.
</p><p>
Each argument clause has the syntax
<tt>




(</tt><tt><i>kind</i></tt><tt> </tt><tt><i>sym</i></tt><tt> </tt><tt><i>tar=
get</i></tt><tt>)=20

</tt>

where
<tt><i>kind</i></tt>
is one of the five symbols
<tt>var</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>,
<tt>macro</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
or
<tt>pkg</tt>.
The
<tt><i>sym</i></tt>
element is a symbol suitable for use as a variable, function
or structure name, and
<tt><i>target</i></tt>
is an expression which is evaluated to produce a value that is suitable
as an argument to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function.
</p><p>
First, all
<tt>target</tt>
expressions in all clauses are unconditionally evaluated in left to right
order. Then the clauses are processed in that order. If the
<tt><i>kind</i></tt>
symbol of a clause is
<tt>var</tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0020A085">load-for<=
/a></tt>
tests whether
<tt><i>sym</i></tt>
has a binding in the variable namespace using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">boundp</a=
></tt>
function. If a binding does not exist, then the value of the
<tt><i>target</i></tt>
expression is passed to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function. Otherwise,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
is not called.
Similarly, if
<tt><i>kind</i></tt>
is the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a></=
tt>,
then
<tt><i>sym</i></tt>
is instead tested using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">fboundp</=
a></tt>,
if
<tt><i>kind</i></tt>
is
<tt>macro</tt>,
then
<tt><i>sym</i></tt>
is tested using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">mboundp</=
a></tt>,
if
<tt><i>kind</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>,
then
<tt><i>sym</i></tt>
is tested using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E5EEA7">find-stru=
ct-type</a></tt>,
and if
<tt><i>kind</i></tt>
is
<tt>pkg</tt>,
then
<tt><i>sym</i></tt>
is tested using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0250826D">find-pack=
age</a></tt>.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0020A085">load-for<=
/a></tt>
invokes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function, it confirms whether loading file has had the expected effect of
providing a definition of
<tt><i>sym</i></tt>
of the right
<tt><i>kind</i></tt>.
If this isn't the case, an error is thrown.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0020A085">load-for<=
/a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-014C116E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.84.6">9.84.6</a=
> Variable <tt>txr-exe-path</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This variable holds the absolute path name of the executable file
of the running <b>TXR</b> instance.
</p><p>
</p></dd></dl>
<a name=3D"N-01F1599C">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.85">9.85</a> Fu=
nction Tracing</h3>



<p>


</p><p>

<a name=3D"N-0067A6AC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.85.1">9.85.=
1</a> Special variable <tt>*trace-output*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0067A6AC">*trace-ou=
tput*</a></tt>
special variable holds a stream to which all trace output
is sent. Trace output consists of diagnostics enabled by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
macro.
</p><p>

</p></dd></dl>
<a name=3D"N-02833733">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.85.2">9.85.2</a=
> Macros <tt>trace</tt> and <tt>untrace</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(trace </tt><tt><i>function-name</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(untrace </tt><tt><i>function-name</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">untrace</=
a></tt>
macros control function tracing.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
is called with one or more arguments, it considers each
argument to be the name of a global function. For each
function, it turns on tracing, if it is not already turned on.
If an argument denotes a nonexistent function, or is invalid
function name syntax,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
terminates by throwing an exception, without processing the
subsequent arguments, or undoing the effects already applied
due to processing the previous arguments.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
is called with no arguments, it lists the names of functions
for which tracing is currently enabled. In other cases it
returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">untrace</=
a></tt>
is called with one or more arguments, it considers each
argument to be the name of a global function. For each
function, it turns off tracing, if tracing is enabled.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">untrace</=
a></tt>
is called with no arguments, it disables tracing for all
functions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">untrace</=
a></tt>
macro always returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
and silently tolerates arguments which are not names of functions
currently being traced.
</p><p>
Tracing a function consists of printing a message prior to entry into the
function indicating its name and arguments, and another message upon leavin=
g
the function indicating its return value, which is syntactically correlated
with the entry message, using a combination of matching and indentation.
These messages are posted to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0067A6AC">*trace-ou=
tput*</a></tt>
stream.
</p><p>
When traced functions call each other or recurse, these trace messages
nest. The nesting is detected and translated into indentation levels.
</p><p>
Tracing works by replacing a function definition with a trace hook function=
, and
retaining the previous definition. The trace hook calls the previous defini=
tion
and produces the diagnostics around it. When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">untrace</=
a></tt>
is used to disable tracing, the previous definition is restored.
</p><p>
Methods can be traced; their names are given using
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>struct</i></tt><tt> </tt><tt><i>slot</i></tt><tt>)=20

</tt>

syntax: see the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F222DA">func-get-=
name</a></tt>
function.
</p><p>
Macros can be traced; their names are given using
<tt>




(macro </tt><tt><i>name</i></tt><tt>)=20

</tt>

syntax. Note that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
will not show the destructured internal macro arguments, but only the
two arguments passed to the expander function: the whole form, and the
environment.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">trace</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02833733">untrace</=
a></tt>
functions return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-00E098FA">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.86">9.86</a> Dy=
namic Library Access</h3>



<p>


</p><p>

<a name=3D"N-037C4BFE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.86.1">9.86.=
1</a> Function <tt>dlopen</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dlopen [{</tt><tt><i>lib-name</i></tt><tt> | nil} [</tt><t=
t><i>flags</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>
function provides access to the POSIX C library function of the
same name.
</p><p>
The argument to the optional
<tt><i>lib-name</i></tt>
parameter may be a character string, or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
If it is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the POSIX function is called with a null pointer for
its name argument, returning the handle for the main program,
if possible.
</p><p>
The
<tt><i>flags</i></tt>
argument should be expressed as some bitwise combination of the values
of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0083A22A">rtld-lazy=
</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0083A22A">rtld-now<=
/a></tt>,
or other
<tt>rtld-</tt>
variables which give names to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>-related
flags.  If the
<tt><i>flags</i></tt>
argument is omitted, the default value used is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0083A22A">rtld-lazy=
</a></tt>.
</p><p>
If the function succeeds, it returns an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
which represents the open library handle ("dlhandle").
</p><p>
Otherwise it throws an exception, whose message incorporates, if possible,
error text retrieved from the
<tt>dlerror</tt>
POSIX function.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
handle returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>
will automatically be subject to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7DE5">dlclose</=
a></tt>
when reclaimed by the garbage collector.
</p><p>

</p></dd></dl>
<a name=3D"N-033F7DE5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.86.2">9.86.2</a=
> Function <tt>dlclose</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dlclose </tt><tt><i>dlhandle</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7DE5">dlclose</=
a></tt>
closes the library indicated by
<tt><i>dlhandle</i></tt>,
which must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object previously returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>.
</p><p>
The handle is closed by passing the stored pointer to the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7DE5">dlclose</=
a></tt>
function. The internal pointer contained in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object is then reset to null.
</p><p>
It is permissible to invoke
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7DE5">dlclose</=
a></tt>
more than once on a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object which was created by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>.
The first invocation resets the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object's pointer to null; the subsequent invocations
do nothing.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7DE5">dlclose</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if the POSIX function reports a successful result (zero), otherwise
it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
It also returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
if invoked on a previously closed, and hence nulled-out
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
handle.
</p><p>

</p></dd></dl>
<a name=3D"N-01B1E865">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.86.3">9.86.3</a=
> Functions <tt>dlsym</tt> and <tt>dlvsym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dlsym </tt><tt><i>dlhandle</i></tt><tt> </tt><tt><i>sym-na=
me</i></tt><tt>)=20




<br>&nbsp;&nbsp;(dlvsym </tt><tt><i>dlhandle</i></tt><tt> </tt><tt><i>sym-n=
ame</i></tt><tt> </tt><tt><i>ver-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1E865">dlsym</a>=
</tt>
function provides access to the same-named POSIX function. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1E865">dlvsym</a=
></tt>
function provides access to the same-named GNU C Library function,
if available.
</p><p>
The
<tt><i>dlhandle</i></tt>
argument must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
handle previously returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dlopen</a=
></tt>
and not subsequently closed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F7DE5">dlclose</=
a></tt>
or altered in any way.
</p><p>
The
<tt><i>sym-name</i></tt>
and
<tt><i>ver-name</i></tt>
arguments are character strings.
</p><p>
If these functions succeed, they return a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
value which holds the address of the symbol which was found
in the library.
</p><p>
If they fail, they return a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object containing a null pointer.
</p><p>

</p></dd></dl>
<a name=3D"N-029063A0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.86.4">9.86.4</a=
> Functions <tt>dlsym-checked</tt> and <tt>dlvsym-checked</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dlsym-checked </tt><tt><i>dlhandle</i></tt><tt> </tt><tt><=
i>sym-name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(dlvsym-checked </tt><tt><i>dlhandle</i></tt><tt> </tt><tt>=
<i>sym-name</i></tt><tt> </tt><tt><i>ver-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-029063A0">dlsym-che=
cked</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-029063A0">dlvsym-ch=
ecked</a></tt>
functions are alternatives to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1E865">dlsym</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B1E865">dlvsym</a=
></tt>,
respectively. Instead of returning a null
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
on failure, these functions throw an exception.
</p><p>

</p></dd></dl>
<a name=3D"N-0083A22A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-9.86.5">9.86.5</a=
> Variables <tt>rtld-lazy</tt>, <tt>rtld-now</tt>, <tt>rtld-global</tt>, <t=
t>rtld-local</tt>, <tt>rtld-nodelete</tt>, <tt>rtld-noload</tt> and <tt>rtl=
d-deepbind</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



These variables provide the same values as constants in the POSIX C library
header
<tt>&lt;dlfcn.h&gt;</tt>
named
<tt>RTLD_LAZY</tt>,
<tt>RTLD_NOW</tt>,
<tt>RTLD_LOCAL</tt>,
<i>et cetera</i>.

</p><p>
</p></dd></dl>
<a name=3D"N-0275762A">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10">10</a> FOREIG=
N FUNCTION INTERFACE</h2>




<p>


</p><p>
On platforms where it is supported, <b>TXR</b> provides a feature called th=
e
<i>foreign function interface</i>,

or FFI. This refers to the ability to interoperate with programming
interfaces which are defined by the binary data type representations
and calling conventions of the platform's principal C language compiler.
</p><p>
<b>TXR</b>'s FFI module provides a succinct Lisp-based type notation for ex=
pressing C
data types, together with memory-management semantics pertinent to the tran=
sfer
of data between software components. The notation is used to describe the
arguments and return values of functions in external libraries, and of Lisp
callback functions that can be called from those libraries.  Driven by the
compiled representation of the type notation, the FFI module performs
transparent conversions between Lisp data types and C data types, and
automatically manages memory around foreign calls and incoming callbacks,
for many common interfacing conventions.
</p><p>
The FFI module consists of a library of functions which provide all of its
semantics.  On top of these functions, the FFI module provides a number of
macros which comprise an expressive, convenient language for defining
foreign interfaces.
</p><p>
The FFI module supports passing and returning both structures and arrays
by value. Passing arrays by value isn't a feature of the C language syntax;
from the C point of view, these by-value array objects in the <b>TXR</b> FF=
I
type system are equivalent to C arrays encapsulated in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>-s.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type is provided for situations when foreign code generates arrays of
undeclared, dynamic length, other than strings, and returns these arrays
by the usual convention of pointer to the first element.  The handling of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
requires more responsibility from the application.
</p><p>
<a name=3D"N-02163660">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.1">10.1</a=
> Cautionary Notes</h3>



<p>


</p><p>
The FFI feature is inherently unsafe. If the FFI type language is used to w=
rite
incorrect type definitions which do not match the actual binary interface o=
f a
foreign function, undefined behavior results. Incorrect use of FFI can corr=
upt
memory, creating instability and security problems. Also, incorrect use of =
FFI
can cause memory leaks and/or use-after-free errors due to inappropriate
deallocation of memory.
</p><p>
The implicit memory management behaviors encoded in the FFI type system
are convenient, but risky. A minor declarative detail such as writing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
instead of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
in the middle of some nested type can make the difference between correct c=
ode
and code which causes a memory leak, or instability by freeing memory which=
 is
in use.
</p><p>
FFI developers are encouraged to unit-test their FFI definitions carefully
and use tools such as Valgrind to detect memory misuses and leaks.
</p><p>
<a name=3D"N-010AF4DA">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.2">10.2</a=
> Key Concepts</h3>



<p>


</p><p>
<a name=3D"N-02FC6677">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.2.1">10.2.=
1</a> The <i>put</i> operation</h4>


<p>
When a function call takes place from the <b>TXR Lisp</b> arena into a fore=
ign
library function, argument values must be prepared in the foreign
representation. This takes place by converting Lisp objects into
stack-allocated temporary buffers representing C objects. For aggregate obj=
ects
containing pointers, additional buffers are allocated dynamically. For
instance, suppose a structure contains a string and is passed by value. The
structure will be converted to a stack-allocated equivalent C structure, in
which the string will appear as a pointer.  That pointer may use dynamicall=
y
allocated (via
<tt>malloc</tt>)
string data.  The operation which prepares argument material before a forei=
gn
function call is the
<i>put</i>

operation. In FFI callback dispatch, the operation which propagates the
callback return value to the foreign caller is also the put operation.
</p><p>
<a name=3D"N-03DFB320">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.2.2">10.2.=
2</a> The <i>in</i> operation</h4>


<p>
After a foreign function call returns from a foreign library back to the <b=
>TXR Lisp</b>arena, the arguments have to be examined one more time, becaus=
e two-way
communication is possible, and because some of the material has temporary
dynamically-allocated buffers associated with it which must be released. Fo=
r
instance a structure passed by pointer may be updated by the foreign functi=
on.
FFI needs to propagate the changes which the foreign function performed to =
the
C version of the structure, back to the original Lisp structure. Furthermor=
e,
a structure passed by pointer uses a dynamically allocated buffer. This buf=
fer
must be freed.  The operation which handles the responsibility for propagat=
ing
argument data back into <b>TXR Lisp</b> objects, and frees any temporary me=
mory that had
been arranged by the
<i>put</i>

operation is the
<i>in</i>

operation.
</p><p>
The in operation has two nuances: the by-value nuance and the
by-pointer nuance.
Data passed into a function by value such as function arguments or via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
are subject to the by-value nuance. Updates to the foreign representation
of these objects does not propagate back to the Lisp representation to the
external representation; however, those objects may contain pointers requir=
ing
the by-pointer nuance of the in operation of those pointers to be invoked.
</p><p>
<a name=3D"N-032B6677">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.2.3">10.2.=
3</a> The <i>get</i> operation</h4>


<p>
After a foreign call completes, it is also necessary to retrieve the call's
return value, convert it to a Lisp object, and free any dynamic memory.
This is preformed by the
<i>get</i>

operation.
</p><p>
The
<i>get</i>

operation is also used by a Lisp callback function, called from a foreign
library, to convert the arguments to Lisp objects.
</p><p>
<a name=3D"N-032BF677">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.2.4">10.2.=
4</a> The <i>out</i> operation</h4>


<p>
When a Lisp callback invoked by a foreign library completes, it must
provide a return value, and also update any argument objects with new
values. The return value is propagated using the put operation. Updates
to arguments are performed by the
<tt>out</tt>
operation. This operation is like the reverse of the in operation. Like
that operation, it has a by-value and by-pointer nuance.
</p><p>
For instance, if a callback receives a structure by value, upon return, the=
re
is no use in reconstructing a new version of the structure from the updated
Lisp structure; the caller will not receive the change. However, if the
structure contains pointers to data that
was updated, by the callback, those changes must materialize. This is achie=
ved
by triggering the by-value nuance of the structure type's out operation, wh=
ich
will recursively invoke the out operation of embedded pointers, which will
in turn invoke the by-pointer nuance.
</p><p>
<a name=3D"N-0233907C">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.3">10.3</a=
> The FFI Type System</h3>



<p>


</p><p>
The FFI type system consists of a notation built using Lisp syntax. Basic,
unparametrized types are denoted by symbolic atoms. Similarly to a concept
in the C language,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
names can be globally defined, using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0094D6D7">ffi-typed=
ef</a></tt>
function, or the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
macro.
</p><p>
Like in the C language,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
names are aliases for an existing type, and not distinct types. However,
this is of no consequence, since the FFI doesn't perform any type checking
between two foreign types, and thus never takes into consideration whether =
two
such types are equal. The main concern in FFI is correspondence between Lis=
p
values and foreign types. For instance, a Lisp string argument will not con=
vert
to a foreign function parameter of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
</p><p>
Compound expressions denote the construction of derived types, or types whi=
ch
are instantiated with parameters. Each such expression has a type construct=
or
symbol in the operator position, from a limited, fixed vocabulary, which ca=
nnot
be extended.
</p><p>
Some constituents of compound type syntax are expressions which evaluate to
integer values: the dimension value for array types, the size for buffers,
the width for bitfields and the value expressions for enumeration constants=
 are
such expressions. These expressions allow full use of <b>TXR Lisp</b>. They=
 are
evaluated without visibility into any apparent surrounding lexical scope.
</p><p>
Some predefined types which are provided are in fact typedef names.
For instance, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03258244">size-t</a=
></tt>
type is a typedef name for some other integral type, defined in a
platform-specific way. Which type that is may be determined by passing
the syntax to the type compiler function using the expression
<tt>(ffi-type-compile 'size-t)</tt>.
The type compiler converts the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03258244">size-t</a=
></tt>
syntax to the compiled type object, resolving the typedef name to
the type which it denotes. The printed representation of that object
reveals the identity of the type. For instance, it might be
<tt>#&lt;ffi-type uint&gt;</tt>,
indicating that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03258244">size-t</a=
></tt>
is an alias for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>
basic type, which corresponds to the C type
<tt>unsigned int</tt>.
</p><p>
<a name=3D"N-0324B36D">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4">10.4</a=
> Simple FFI Types</h3>



<p>


</p><p>

<a name=3D"N-0008D7DC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.1">10.4.=
1</a> FFI types <tt>char</tt>, <tt>zchar</tt>, <tt>uchar</tt> and <tt>bchar=
</tt></h4>



These first two of these types,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>
correspond to the C character type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">uchar</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
types correspond to
<tt>unsigned char</tt>.
Both Lisp integers and character values
convert to these representation, if they are in their numeric range.
Out-of-range values produce an exception.
A foreign
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
value converts to a Lisp character, whereas a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">uchar</a>=
</tt>
value converts to an integer.
<p>
If these types are used for representing individual scalar values,
there is no difference among
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>.
</p><p>
What is different among these three types is that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type constructors treat them specially. Arrays of these types are
subject to conversion to and from Lisp strings. The variation among
these types expresses different conversion semantics. That is to say,
an array of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
converts between the foreign and native Lisp representation differently
from an array of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>,
which in turn converts differently from an array of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>.
</p><p>
Note: it is recommended to avoid using the types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>
other than for expressing the element type of an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>.
</p><p>

<a name=3D"N-018C7C8C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.2">10.4.=
2</a> FFI types <tt>short</tt>, <tt>ushort</tt>, <tt>int</tt>, <tt>uint</tt=
>, <tt>long</tt>, <tt>and</tt> <tt>ulong</tt></h4>



These types correspond to the C integer types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">short</a>=
</tt>,
<tt>unsigned short</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>,
<tt>unsigned int</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">long</a><=
/tt>
and
<tt>unsigned long</tt>.
Lisp characters and integers convert to these foreign representations, if t=
hey
are in their numeric range.  Foreign values of these types convert
to Lisp integers.
<p>

<a name=3D"N-02299408">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.3">10.4.=
3</a> FFI types <tt>longlong</tt> and <tt>ulonglong</tt></h4>



These types are
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
names for integer types whose representation corresponds to the C types
<tt>long long</tt>
and
<tt>unsigned long long</tt>.
<p>

<a name=3D"N-0131FBF2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.4">10.4.=
4</a> FFI types <tt>int8</tt> and <tt>uint8</tt></h4>



These types correspond to 8 bit signed and unsigned integers.
They convert like integer types: both Lisp integers and characters
convert to these types, if in a suitable range; and under
the reverse conversion, the foreign values become Lisp integers.
<p>

<a name=3D"N-03D0AA7B">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.5">10.4.=
5</a> FFI types <tt>int16</tt>, <tt>uint16</tt>, <tt>int32</tt>, <tt>uint32=
</tt>, <tt>int64</tt> and <tt>uint64</tt></h4>



These types correspond denote precisely sized C integer types.
They convert like integer types: both Lisp integers and characters
convert to these types, if in a suitable range; and under
the reverse conversion, the foreign values become Lisp integers.
<p>

<a name=3D"N-03237030">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.6">10.4.=
6</a> FFI types <tt>float</tt> and <tt>double</tt></h4>



These types correspond to the same-named C types. They convert
Lisp integers, characters and floating-point numbers to these C types.
Because the <b>TXR Lisp</b><tt><a href=3D"http://nongnu.org/txr/txr-manpage=
.html#N-03237030">float</a></tt>
is represented as a C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>
it converts directly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>
without the possibility of range error or loss of precision.
A conversion to type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
is subject to a range check; an exception is thrown if the Lisp
floating-point value is out of range of this type. Even when the
conversion is possible, it alters the value, results in a loss of precision=
.
In the reverse direction, values of both types convert to the one and
only <b>TXR Lisp</b><tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-03237030">float</a></tt>
type.
<p>

<a name=3D"N-03BDE6A5">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.7">10.4.=
7</a> FFI type <tt>bool</tt></h4>



The type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
is a typedef name for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">uchar</a>=
</tt>
instance of the parametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
type, which is to say,
<tt>(bool uchar)</tt>.
<p>

<a name=3D"N-00DB04DD">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.8">10.4.=
8</a> FFI type <tt>val</tt></h4>



The FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DB04DD">val</a></=
tt>
type denotes the machine representation of a Lisp value cell, which is
corresponds to a C pointer. Not all cell values are actually pointers, but
values that are heap objects, such as vectors and conses, are.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DB04DD">val</a></=
tt>
type transparently converts any Lisp object to a foreign pointer value
with no representation change at all; and performs the reverse conversion
from pointer to Lisp value.
<p>
Note: this is utterly dangerous. Lisp values that aren't pointers must not
be dereferenced by foreign code. Foreign code must not generate Lisp pointe=
r
values that aren't objects which came from a Lisp heap.
Interpreting a Lisp value in foreign code requires a correct decoding of
its type tag, and, if necessary, stripping the tag bits to recover a heap
pointer and interpreting the type code stored in the heap object.
</p><p>
The conversion from foreign bit pattern to Lisp value is subject to a
validity checks; an exception will be thrown if the bit pattern isn't a val=
id
Lisp object. Nevertheless, the checks has cases which report as false
positives: admit some invalid objects may be admitted into the Lisp realm,
possibly with catastrophic results.
</p><p>

<a name=3D"N-019DE724">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.9">10.4.=
9</a> FFI type <tt>cptr</tt></h4>



This type corresponds to a foreign pointer of any type, including a pointer=
 to a function.
<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type converts between a foreign pointer and a Lisp object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
</p><p>
Lisp objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
are tagged with a symbolic tag, which may be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The unparametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
converts foreign pointers to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
objects which are tagged with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
In the reverse direction, it converts
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
Lisp objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
to foreign pointer, without regard for their type tag.
</p><p>
There is a parametrized version of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
FFI type, which provides a measure of type safety.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type, in the context of FFI, is particularly useful for representing
C pointers that are used in C library interfaces as "opaque" handles.
For instance a FFI binding for the C functions
<tt>fopen</tt>
and
<tt>fclose</tt>
may use the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
to represent the
<tt>FILE *</tt>
type. That is to say,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
can be specified as the return type for
<tt>fopen</tt>,
thereby capturing the stream handle in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object when that function is invoked through FFI. Then, the captured
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object can be passed as the argument of
<tt>fclose</tt>
to close the stream.
</p><p>

<a name=3D"N-00C6B7C4">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.10">10.4=
.10</a> FFI types <tt>str</tt>, <tt>bstr</tt>, <tt>str-d</tt> and <tt>bstr-=
d</tt></h4>



These FFI types correspond to the C pointer type
<tt>char *</tt>,
providing automatic conversion between Lisp strings and null-terminated
C strings. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
types use UTF-8 encoding. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">bstr</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">bstr-d</a=
></tt>
types do not use UTF-8: only Lisp strings which contain strictly
code points in the range U+0000 to U+00FF may convert to these types;
out-of-range characters trigger an error exception.
The
<tt>-d</tt>
suffixed types differ from the unsuffixed variants
in that they denote the transfer of ownership of dynamically allocated memo=
ry,
and thus the responsibility for freeing that memory.
<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
type behaves as follows. The put operation allocates, using
<tt>malloc</tt>,
a buffer large enough to hold the UTF-8 encoded version of the Lisp
string, encodes the string into that buffer, and then stores the
<tt>char *</tt>
pointer into the argument space. The in operation deallocates the
buffer. If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
is passed by pointer, the in operation also takes the current value of the
<tt>char *</tt>
pointer, which may have been replaced by a different pointer, and creates a=
 new
Lisp string by decoding UTF-8 from that buffer. The get operation retrieves=
 the
C pointer and duplicates a new string by decoding the UTF-8 contents. The t=
ype
has no out operation: a string is not expected to be modified in-place.
</p><p>
The type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
type differs in behavior from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
as follows. Firstly, it has no in operation. Consequently,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
doesn't deallocate the buffer that had been allocated by put.
Under the get operation, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
type assumes that ownership over the C pointer has been granted, and
after duplicating a new string from the decoded UTF-8 data in the C string,
it deallocates that C string by invoking the C library function
<tt>free</tt>
on it.
</p><p>
The type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">bstr-d</a=
></tt>
behaves like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
with regard to memory management; it differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
in the same way that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">bstr</a><=
/tt>:
it doesn't perform UTF-8 encoding or decoding.
</p><p>
Like other types, the string types combine with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
type family. Because the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
family has memory management semantics, as does the string family,
it is important to understand the memory management implications
of the combination of the two.
</p><p>
The types
<tt>(ptr str-d)</tt>
and
<tt>(ptr str)</tt>
are effectively equivalent. They denote a string passed by pointer,
with in-out semantics. The effect is that the string is dynamic in both
directions. What that means is that the foreign function either must not
free the pointer it was given, or else it must replace it with one which th=
e
caller can also free (or with a null pointer). The two are equivalent
because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
has no in operation, so its get operation is used instead; but that operati=
on
is similar to the in operation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
type:
both decode the string currently referenced by the
<tt>char *</tt>
pointer, and then pass that pointer to the C
<tt>free</tt>
function.
</p><p>
To receive a string pointer by pointer from a foreign
function, one of the types
<tt>(ptr-out str)</tt>
or
<tt>(ptr-out str-d)</tt>
should be used, which have different semantics. In either situation, FFI wi=
ll
prepare a pointer-sized uninitialized buffer, which the called function fil=
ls
with a
<tt>char *</tt>
pointer. In the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
case, FFI will duplicate that string to a Lisp string. In the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
case, FFI will also free the string received from the foreign function.
</p><p>
The type combination
<tt>(ptr-in str-d)</tt>
refers to a string pointer passed to a foreign function by pointer,
whereby the foreign function will retain and free the pointer. The type
combination
<tt>(ptr-in str)</tt>
passes the string pointer in the same way, but the foreign module mustn't
use the pointer after returning. FFI will free the pointer that had been
passed.
</p><p>

<a name=3D"N-032DB6DC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.11">10.4=
.11</a> FFI types <tt>wstr</tt> and <tt>wstr-d</tt></h4>



The FFI type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032DB6DC">wstr</a><=
/tt>
corresponds to the C type
<tt>wchar_t *</tt>
pointing to the first character of a null terminated wide string.
It converts between Lisp strings and symbols, and C strings.
The memory management is similar to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str-d</a>=
</tt>
types, except that no UTF-8 conversion takes place.
<p>

<a name=3D"N-0384A6E7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.12">10.4=
.12</a> FFI types <tt>buf</tt> and <tt>buf-d</tt></h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
type creates a correspondence between the <b>TXR Lisp</b><tt><a href=3D"htt=
p://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
type and a C pointer to a block of arbitrary data. Note that there also
exists a parametrized version of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
type syntax which specifies a size.
<p>
Under the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
type's put operation, no memory allocation takes place. The pointer to the
buffer object's data is is written into the argument space, so the foreign
function can manipulate the buffer directly. If the object isn't a buffer
but rather the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then a null pointer is written.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
in operation has semantics
as follows. In the pass-by-pointer nuance, the buffer pointer currently in =
the
argument space is compared to the original one which had been written there
from the buffer object.  If they are identical, then the in operation
yields the original buffer object. Otherwise, if the altered
pointer is non-null,
it allocates a new buffer equal in size to the original one and copies in t=
he
new data from the new pointer that was placed into the argument space by th=
e
foreign function.  If the altered pointer is null, then instead of allocati=
ng a
new buffer, the object
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
The by-value nuance of the in operation does nothing.
</p><p>
The get operation is not meaningful for an unsized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>:
it yields a zero length
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object. For this reason, parametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
type should be used for retrieving a buffer with a specific fixed size.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
type has different memory management from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>.
The put operation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
allocates a copy of the buffer and writes into the argument space
a pointer to the copy. It is assumed that the foreign function takes
ownership of the copy.
</p><p>
The in operation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
is also different. The by-value nuance of the in operation
is a no-op, like that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>.
The by-pointer nuance doesn't attempt to compare the previously written
pointer to the current value. Rather, it assumes that if there is any non-n=
ull
pointer value in the argument space, then it should take ownership of
that object and return it as a new buffer. Thus if two-way dynamic buffer
passing is requested using
<tt>(buf buf-d)</tt>
it means that the foreign function must replace the pointer with a null
to indicate that it has consumed the buffer. Any non-null value in the
argument space indicates that the foreign function has either rejected
the pointer (not taken ownership), or has replaced it with a new object,
whose ownership is being passed.
</p><p>
Unidirectional by-pointer passing of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
can be performed using the types
<tt>(ptr-out buf-d)</tt>
or
<tt>(ptr-int buf-d)</tt>.
The former type will not invoke
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>'s
put operation. It will only allocate a pointer-sized space, without
initializing it. After the foreign call, the by-pointer semantics of the
in operation will be triggered If the foreign function places a non-null
pointer into the space, its ownership will be seized by a newly instantiate=
d
buffer object. Otherwise the function must place a null pointer, which
results in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
value emerging from the in operation as documented above. The latter type w=
ill
achieve a transfer of ownership in the other direction, by invoking the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
put operation, which places a copy of the buffer into the pointer-sized
location prepared in the argument space. After
the call, it will invoke the by-value in semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>,
which is a no-op: thus no attempt is made to extract a buffer, even if
the foreign function alters the pointer.
</p><p>

<a name=3D"N-0216EF16">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.13">10.4=
.13</a> FFI type <tt>closure</tt></h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216EF16">closure</=
a></tt>
type converts two kinds of Lisp objects to a C pointer: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type, and the special
<tt>ffi-closure</tt>
type, whose instances are produced by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095DF58">ffi-make-=
closure</a></tt>
function, or by calls to functions defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
macro. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216EF16">closure</=
a></tt>
type is useful for passing callbacks to foreign functions: Lisp functions
which appear to be C functions to foreign code.
<p>

<a name=3D"N-013DE1A3">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.4.14">10.4=
.14</a> FFI type <tt>void</tt></h4>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DE1A3">void</a><=
/tt>
type is useful for indicating the return type of foreign functions and
callbacks which return no value. It corresponds to a zero-sized object.
It will convert any lisp value into zero bytes, and convert
zero bytes into
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
<p>
<a name=3D"N-03C7DF28">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5">10.5</a=
> Parametrized FFI Type Operators</h3>



<p>


</p><p>
The following following parametrized type operators are available.
</p><p>

<a name=3D"N-01CDE57C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.1">10.5.=
1</a> FFI type <tt>enum</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(enum </tt><tt><i>name</i></tt><tt> {(</tt><tt><i>sym</i></=
tt><tt> </tt><tt><i>value</i></tt><tt>) | </tt><tt><i>sym</i></tt><tt>}*)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CDE57C">enum</a><=
/tt>
specifies an enumerated type, which establishes a correspondence between
a set of Lisp symbols and foreign integer values of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
</p><p>
The
<tt><i>name</i></tt>
argument must either be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or a symbol for which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function returns true. It gives the tag name of the enumerated
type. The remaining arguments specify the enumeration constants.
</p><p>
In the enumeration constant syntax, each occurrence of
<tt><i>sym</i></tt>
They must be a bindable symbol according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0222F2E3">bindable<=
/a></tt>
function. The symbols may not repeat within the same enumerated type.
Unlike in the C language, different enumerations may use the same symbols;
they are in separate spaces.
</p><p>
If a
<tt><i>sym</i></tt>
is given, it is associated with an integer value which is one greater
than the integer value associated with the previous symbol.
If there is no previous symbol, then the value is zero. If the previous
symbol has been assigned the highest possible value of the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
type, then an error exception is thrown.
</p><p>
If
<tt>




(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>value</i></tt><tt>)=20

</tt>

is given, then
<tt><i>sym</i></tt>
is given the specified value. The
<tt><i>value</i></tt>
is an expression which must evaluate to an integer value in range of the FF=
I
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
type. It is evaluated in an environment in which the previous
symbols from the same enumeration appear as variables whose binding are the
their enumeration values, making it possible to use earlier enumerations in=
 the
definition of later enumerations.
</p><p>
The FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CDE57C">enum</a><=
/tt>
type converts two kinds of Lisp values to the foreign type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>:
symbols which are in the set defined by the type, and integer values
which are in the range which that foreign type can represent.
Out-of-range integer values, symbols not defined in the enumeration, and
objects not of symbol or integer type all trigger an exception.
</p><p>
In the reverse direction, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CDE57C">enum</a><=
/tt>
type extracts from the foreign representation values of FFI type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>,
and converts them, if possible, to symbols. If an integer value occurs
which is not assigned to any enumeration symbol, then the conversion produc=
es
that integer value itself rather than a symbol. If an integer value occurs
which is assigned to multiple enumeration symbols, it is not specified whic=
h
of those symbols is produced.
</p><p>

</p></dd></dl>
<a name=3D"N-01096D60">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.2">10.5.2</a=
> FFI type <tt>enumed</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(enumed </tt><tt><i>type</i></tt><tt> </tt><tt><i>name</i><=
/tt><tt> {(</tt><tt><i>sym</i></tt><tt> </tt><tt><i>value</i></tt><tt>) | <=
/tt><tt><i>sym</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01096D60">enumed</a=
></tt>
type operator is a generalization of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CDE57C">enum</a><=
/tt>
which allows the base integer type of the enumeration to be specified.
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
CDE57C">enum</a> n a b c ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/tx=
r/txr-manpage.html#N-01096D60">enumed</a> int n a b c ...)
</tt></pre><tt>

</tt>

<p>
Any integer type or
<tt><i>typedef</i></tt>
name may be specified for
<tt><i>type</i></tt>,
including any one of the endian types. The enumeration inherits its
size, alignment and other foreign representation details from
<tt><i>type</i></tt>.
</p><p>
The values associated with the enumeration symbols must be in
the representation range of
<tt><i>type</i></tt>,
which is not checked until the conversion of a symbol
through the enumeration is is attempted at run time.
</p><p>

</p></dd></dl>
<a name=3D"N-0005D5C1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.3">10.5.3</a=
> FFI type <tt>struct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(struct </tt><tt><i>name</i></tt><tt> {(</tt><tt><i>slot</i=
></tt><tt> </tt><tt><i>type</i></tt><tt> [</tt><tt><i>init-form</i></tt><tt=
>])}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type maps between a Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
and a C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>.
The
<tt><i>name</i></tt>
argument of the syntax gives the structure type name, known as the tag.
If this argument is the symbol
<tt><i>nil</i></tt>
then the structure type is named by a newly generated uninterned
symbol (gensym).
</p><p>
The
<tt><i>name</i></tt>
is entered into a global namespace of tags which is shared by structures
and unions.
</p><p>
The
<tt><i>name</i></tt>
also specifies the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
name associated with the FFI type.
</p><p>
The
<tt><i>slot</i></tt>
and
<tt>type</tt>
pairs specify the structure members. The
<tt><i>slot</i></tt>
elements must be symbols, and the
<tt><i>type</i></tt>
elements must be FFI type expressions.
</p><p>
A
<tt><i>struct</i></tt>
definition with no member refers to a previously defined
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type which has the same
<tt><i>name</i></tt>
in the global
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union<=
/a></tt>
tag space.
</p><p>
If no prior
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
exists, then a definition with no slots specifies a new,
structure type that is incomplete.
A
<tt><i>struct</i></tt>
definition with no members never causes a Lisp structure type to be created=
.
</p><p>
A
<tt><i>struct</i></tt>
definition that specifies one or more members either defines a new structur=
e
type, or completes an existing one. If an incomplete structure or union
type which has the same
<tt><i>name</i></tt>
exists, then the newly appearing definition is understood to provide
a completion of that type. If the incomplete type is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>,
it thereby converted to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type.
</p><p>
If a complete structure type which has the
same
<tt><i>name</i></tt>
already exists, then the newly appearing definition replaces that type
in the tag namespace.
</p><p>
A struct
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
definition with members is entered into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union<=
/a></tt>
tag space immediately as an incomplete type (if it isn't already), before t=
he
members are processed. Therefore, the member definitions can refer to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type. The type becomes complete when the last member is processed,
except in the special situation when that member causes the type to become
a flexible structure, described several paragraphs below.
</p><p>
A
<tt><i>struct</i></tt>
definition that specifies members causes a Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
having the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
to exist, if such a type doesn't already exist. If such a type is
created, instance slots are defined for it which correspond to the
member definitions in the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
definition.
</p><p>
For any
<tt><i>slot</i></tt>
which specifies an
<tt><i>init-form</i></tt>
expression, that expression is evaluated during the processing of the type =
syntax,
in the global environment. The resulting value then becomes the initial val=
ue for
the slot. The semantics of this value is similar to that of a quoted object
appearing as an
<tt><i>init-form</i></tt>
in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro's
<tt><i>slot-specifier</i></tt>
syntax. For example, if the type expression
<tt>(struct s (a int expr))</tt>,
which specifies a slot
<tt>a</tt>
initialized by
<tt>expr</tt>,
generates a Lisp struct type, the manner in which that type is generated
will resemble that of
<tt>(defstruct s nil (a (quote [value-of-expr])))</tt>
where
<tt>[value-of-expr]</tt>
denotes the substitution of the value of
<tt>expr</tt>
which had been obtained by evaluation in the global environment.
Note: if more flexible initialization semantics is required, the applicatio=
n must
define the Lisp struct type first with the desired characteristics, before
processing the FFI struct type. The FFI struct type will then related to th=
e
existing Lisp struct type.
</p><p>
Those members whose
<tt><i>slot</i></tt>
name is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is ignored; no instance slots are created in the Lisp type.
If a
<tt><i>init-form</i></tt>
is specified for such a slot, there exists is no situation in which that
form will be evaluated.
</p><p>
When a Lisp object is converted to a struct, it must, firstly, be of the st=
ruct
type specified by
<tt><i>name</i></tt>.
Secondly, that type must have all of the slots defined in the FFI type.
The slots are pulled from the Lisp structure in the order that they appear
in the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
definition. They are placed into the target memory area in that order,
with all required padding between the members, and possibly after
the last member, for alignment.
</p><p>
Whenever a member is defined using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
as the
<tt><i>slot</i></tt>
name, that member represents anonymous padding. The corresponding
<tt><i>type</i></tt>
expression is used only to determine the size of the padding only. Its data
transfer semantics is completely suppressed. When converting from Lisp, the
anonymous padding member simply generates a skip of the number of byte
corresponding to the size of its type, plus any necessary additional paddin=
g
for the alignment of the subsequent member.
</p><p>
Structure members may be bitfields, which are described using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
compound type operators.
</p><p>
A structure member must not be an incomplete or zero sized array,
unless it is the last member. If the last member of FFI structure is
an incomplete array, then it is a flexible structure.
</p><p>
A structure member must not be a flexible structure, unless it is the
last member; the containing structure is then itself a flexible structure.
</p><p>
Flexible structures correspond to the C concept of a "flexible array member=
":
the idea that the last member of a structure may be an array of unknown siz=
e,
which allows for variable-length data at the end of a structure, provided
that the memory is suitably allocated.
</p><p>
Flexible structures are subject to special restrictions and requirements.  =
See
the section Flexible Structures below. In particular, flexible structures
may not be passed or returned by value.
</p><p>
See also: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>
function and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1FC38">znew</a><=
/tt>
macro.
</p><p>

</p></dd></dl>
<a name=3D"N-01C78B86">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.4">10.5.4</a=
> FFI type <tt>union</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(union </tt><tt><i>name</i></tt><tt> {(</tt><tt><i>slot</i>=
</tt><tt> </tt><tt><i>type</i></tt><tt>)}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type resembles the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type syntactically. It provides handling for foreign objects of C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type.
</p><p>
The
<tt><i>name</i></tt>
argument specifies the name for the union type, known as a tag.
If this argument is the symbol
<tt><i>nil</i></tt>
then the union type is named by a newly generated uninterned
symbol (gensym).
</p><p>
The
<tt><i>name</i></tt>
is entered into a global namespace of tags which is shared by structures
and unions.
</p><p>
The
<tt><i>slot</i></tt>
and
<tt>type</tt>
pairs specify the union members. The
<tt><i>slot</i></tt>
elements must be symbols, and the
<tt><i>type</i></tt>
elements must be FFI type expressions.
</p><p>
A
<tt><i>union</i></tt>
definition with no member refers to a previously defined
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type which has the same
<tt><i>name</i></tt>
in the global
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union<=
/a></tt>
tag space.
</p><p>
If no prior
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
exists, then a definition with no slots specifies a new,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type that is incomplete.
</p><p>
A
<tt><i>union</i></tt>
definition that specifies one or more members either defines a new structur=
e
type, or completes an existing one. If an incomplete structure type which h=
as
the same
<tt><i>name</i></tt>
exists, then the newly appearing definition is understood to provide
a completion of that type. If the prior incomplete type is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>,
it is converted to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type.  If a complete structure or union type which has the
same
<tt><i>name</i></tt>
already exists, then the newly appearing definition replaces that type
in the tag namespace.
</p><p>
A struct
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
definition with members is entered into the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union<=
/a></tt>
tag space immediately as an incomplete type (if it isn't already), before t=
he
members are processed. Therefore, the member definitions can refer to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type. The type becomes complete when the last member is processed.
</p><p>
Unlike the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type doesn't provide automatic conversion between C and Lisp data.
This is because the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
is inherently unsafe, due to its placement of multiple types into the
same storage, and lack of any information to discriminate which type
is currently stored. Instead, the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
creates a correspondence between a C union that is regarded as just
a region of memory, and a <b>TXR Lisp</b> data type called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>.
</p><p>
An instance of the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type holds a copy of the C union memory, and also contains type information
about the unions members. Functions are provided to store and retrieve the
members; it is these functions which provide the conversion between the
Lisp types and the foreign representations stored in the C union.
This is done under control of the application, because due to the inherent
lack of safety of the C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>,
only the application program knows which member of the union may be accesse=
d.
</p><p>
Conversion between the C
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
and the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
consists of just a memory copying operation.
</p><p>
The following functions are provided for manipulating unions:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010A23C0">make-unio=
n</a></tt>
instantiates a new union object;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008912E4">union-mem=
bers</a></tt>
retrieves a list of the symbols serving as the union's member names;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4F0C">union-get=
</a></tt>
retrieves a specified member from the union's storage, converting it
to a Lisp object;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4EBC">union-put=
</a></tt>
places a Lisp object into a union, using the specified member's type
to convert it to a foreign representation;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-in<=
/a></tt>
performs the "in semantics" on the specified member of a union,
propagating modifications in that member back to a Lisp object; and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-out=
</a></tt>
performs "out semantics" on the specified member of a union,
propagating modifications done on a previously retrieved Lisp object
back into the union.
</p><p>

</p></dd></dl>
<a name=3D"N-0117BE95">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.5">10.5.5</a=
> FFI type <tt>array</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(array </tt><tt><i>dim</i></tt><tt> </tt><tt><i>type</i></t=
t><tt>)=20




<br>&nbsp;&nbsp;(array </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
type creates a correspondence between Lisp sequences and
"by value" fixed size arrays in C. It converts Lisp sequences to C arrays, =
and
C arrays to Lisp vectors.
</p><p>
Arrays passed by values do not exist
in the C language syntax. Rather, the C type which corresponds to the
FFI array is a C array that is encapsulated in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>.
For instance the type
<tt>(array 3 char)</tt>
can be visualized as corresponding to the C type
<tt>struct { char anonymous[3]; }</tt>.
</p><p>
Thus, in the FFI syntax, we can specify arrays as function parameters
passed by value and as return values.
</p><p>
On conversion from Lisp to the foreign type, the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
simply iterates over the Lisp sequence, and performs an element for
element conversion to
<tt><i>type</i></tt>.
</p><p>
If the sequence is shorter than the array, then the remaining elements
are filled with zero bits. If the sequence is longer than the array, then t=
he
excess elements in the sequence are ignored.
</p><p>
Since Lisp arrays and C arrays do not share the same representation,
temporary buffers are automatically created and destroyed by FFI
to manage the conversion.
</p><p>
The
<tt><i>dim</i></tt>
argument is an ordinary Lisp expression expanded and evaluated in the
top-level environment. It must produce a non-negative integer value.
</p><p>
In addition, several types are treated specially: when
<tt><i>type</i></tt>
is one of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
or
<tt>wchar</tt>,
the array type establishes a special correspondence with Lisp strings.
When the C array is decoded, a Lisp string is created or updated in place
to reflect the new contents. This is described in detail below.
</p><p>
The second form, whose syntax omits the
<tt><i>dim</i></tt>
element, it denotes a variable length
array. It corresponds to the concept of an incomplete array
in the C language, except that no implicit array-to-pointer conversion
concept is implemented in the FFI type system. This type may not
be used as an array element or structure member. It also may not
be passed or returned by value, only by pointer.
</p><p>
Since the type has unknown length, it has a trivial get operation which ret=
urns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
It is useful for passing a variable amount of data into a foreign
function by pointer.
</p><p>
An array of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
represents non-null-terminated UTF-8 character data, which converts to
and from a Lisp string. Any null bytes in the data correspond to
the pseudo-null character
<tt>#\xDC00</tt>
also notated as
<tt>#\pnul</tt>.
</p><p>
An array of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>
represents a field of optionally null-terminated UTF-8 character data.
If a null byte occurs in the data then the text terminates before that
null byte, otherwise the data comprises the entire foreign array.
Thus, null bytes do not occur in the data. A null byte in the array will
not generate a pseudo-null character in the Lisp string.
</p><p>
An array of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
values represents 8-bit character data that isn't UTF-8 encoded,
and is not null terminated. Each byte holds a character whose code is
in the range 0 to 255. If a null byte occurs in the data, is interpreted
as a string terminator.
</p><p>

</p></dd></dl>
<a name=3D"N-017039ED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.6">10.5.6</a=
> FFI type <tt>zarray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(zarray </tt><tt><i>dim</i></tt><tt> </tt><tt><i>type</i></=
tt><tt>)=20




<br>&nbsp;&nbsp;(zarray </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>.
When converting from Lisp to C, it ensures that the array is null-terminate=
d.
This means that if the
<tt><i>zarray</i></tt>
is dimensioned, then the
<tt>




[</tt><tt><i>dim</i></tt><tt> - 1]=20

</tt>

element of the C array is written out as all zero bytes,
ignoring the corresponding Lisp value in the Lisp array.
If the
<tt><i>zarray</i></tt>
is undimensioned, then the size of the C array is deemed to be one greater
than the actual length of the Lisp array.  The elements in the Lisp array a=
re
converted to the corresponding elements of the C array, and then the
last element of the C array is filled with null bytes.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type is useful for handling null terminated character arrays representing
strings, and for null terminated vectors.
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
allows the Lisp object to be one element short. For instance,
when a
<tt>(zarray 5 int)</tt>
passed by pointer a foreign function is converted back to Lisp,
the Lisp object is required to have only four elements. If the Lisp object
has five elements, then the fifth one will be decoded from the C array
in earnest; it is not expected to be null. However, when that Lisp
representation is converted back to C, that extra element will be ignored a=
nd
output as a zero bytes.
</p><p>
Lastly, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
further extends the special treatment which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
type applies to the types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt>wchar</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type assumes, and depends on the incoming data being null-terminated, and
converts it to a Lisp string accordingly. The regular
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
type doesn't assume null termination. In particular, this means that wherea=
s
<tt>(array 42 char)</tt>
will decode 42 bytes of UTF-8, even if some of them are null, converting
those null bytes the U+DC00 pseudo-null, in contrast, a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
will treat the 42 bytes as a null-terminated string, and decode UTF-8 only
up to the first null.
In the other direction, when converting from Lisp string to the foreign arr=
ay,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
ensures null termination.
</p><p>
Note that the type combination
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">zchar</a>=
</tt>
behaves in a manner indistinguishable from a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>.
</p><p>
The one-argument variant of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
syntax which omits the
<tt><i>dim</i></tt>
argument specifies a null-terminated variant of the variable-length array.
Like that type, it corresponds to the concept of an incomplete
array in the C language. It may not be used as an array element
or structure member, and cannot be passed as an argument or returned
as a value.
</p><p>
Unlike the ordinary variable-length
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type supports the get operation, which extracts elements, accumulating them
into a resulting vector, until it encounters an element consisting of all z=
ero
bytes. That element terminates the decoding, and isn't included in the
resulting array.
</p><p>
The variable-length
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
also has a special in operation. Like the get operation, the in operation
extracts all elements until a terminating null, decoding them to a vector.
Then, the entire original vector is replaced with the new vector,
even if the original vector is longer.
</p><p>

</p></dd></dl>
<a name=3D"N-027B04D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.7">10.5.7</a=
> FFI type <tt>ptr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ptr </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><i>ptr</i></tt>
denotes the passage of a value by pointer. The
<tt><i>type</i></tt>
argument gives the pointer's target type. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
type converts a single Lisp value, to and from the target type,
using a C pointer as the external representation.
</p><p>
When used for passing a value to a foreign function, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
type has in-out semantics: it supports the interfacing concept that
the called function can update datum which has been passed to it "by pointe=
r",
thereby altering the caller's object. Since a Lisp value requires a convers=
ion
to the FFI external representation, it cannot be directly passed by pointer=
.
Instead, this semantics is simulated. The put semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
allocates a temporary buffer, large enough to hold the representation of
<tt><i>type</i></tt>.
The Lisp value is then encoded into this buffer, recursively relying on
the type's put semantics. After the foreign call,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
triggers the in semantics of
<tt><i>type</i></tt>
to update the Lisp object from the temporary buffer, and releases the
buffer.
</p><p>
The get semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
is used in retrieving a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
return value, or, in a FFI callback, for retrieving the values of
incoming arguments that are of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
type. The get semantics assumes that the memory referenced by the C
pointer is owned by foreign code. The Lisp object is merely decoded from th=
e
data area, which is then not touched.
</p><p>
The
<tt>out</tt>
semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>,
used by callbacks for updating the values of arguments
passed by pointer, assumes that the argument space already contains a
valid pointer. The pointer is retrieved from the argument space, and the
Lisp value is encoded into the memory referenced by that pointer.
</p><p>
Note that only Lisp objects with mutable slots can be meaningfully passed b=
y
pointer with in-out semantics. If a Lisp objects without immutable slots, s=
uch
as an integer, is passed using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
the incoming updated value of the external representation will be ignored.
Concretely, if a C function has the argument signature
<tt>(int *)</tt>
with in-out semantics such that it updates the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
object which is passed in, this function can be called as a foreign functio=
n
using a
<tt>(ptr int)</tt>
FFI type for the argument. However, the argument of the foreign call on the
<b>TXR Lisp</b> side is just an integer value, and that cannot be updated.
</p><p>
On the other hand, if a FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
member is declared as of type
<tt>(ptr int)</tt>
then the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
is expected to have an integer-valued slot corresponding to that member.
The slot is then subject to a bi-directional transfer. FFI will create an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>-sized
temporary data area, encode the slot into that area and place that area's
pointer into the encoded structure.  After the call, the new value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
will be extracted from the temporary buffer, which will then be released.
The Lisp structure's slot will be updated with the new integer.
This will happen even if the Lisp structure is being passed as a by-value
argument.
</p><p>

</p></dd></dl>
<a name=3D"N-00A494BF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.8">10.5.8</a=
> FFI type <tt>ptr-in</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ptr-in </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
type is a variation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
which denotes the passing of a value by pointer into a function, but
not out. The put semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
is the same as that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>,
but after the completion of the foreign function call, the in semantics
differs. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
type only frees the temporary buffer, without decoding from it.
</p><p>
The out semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
differs also. It effectively treats the object as if it were "by value",
since the reverse data transfer is ruled out. In other words,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
simply triggers the by-value nuance of
<tt><i>type</i></tt>'s
out semantics.
</p><p>
The get semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
is the same as that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03D4DF7E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.9">10.5.9</a=
> FFI type <tt>ptr-out</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ptr-out </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DF7E">ptr-out</=
a></tt>
type is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>
which denotes a by pointer data transfer out of a function only, not into.
The put semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DF7E">ptr-out</=
a></tt>
prepares a data area large enough to hold
<tt><i>type</i></tt>
and stores a pointer to that area into the argument space.
The Lisp value isn't encoded into the data area.
</p><p>
The in semantics is the same as that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>:
the by-pointer nuance of
<tt><i>type</i></tt>'s
in semantics is invoked to decode the external representation to
Lisp data.
</p><p>

</p></dd></dl>
<a name=3D"N-01D7AC98">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.10">10.5.10<=
/a> FFI type <tt>ptr-in-d</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ptr-in-d </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>
type is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>
which transfers ownership of the allocated buffer to the invoked
function. That is to say, the in semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>
doesn't involve the freeing of memory that was allocated by put
semantics.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>
type is useful when a function expects a pointer to an object that
was allocated by
<tt>malloc</tt>
and expects to take responsibility for freeing that object.
</p><p>
Since the function may free the object even before returning,
the pointer must not be used once the function is called. This is
ensured by the in semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>
which is the same as that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>
type also has get semantics which assumes that ownership of the
C object is to be seized. FFI will automatically free the C object
when get semantics is invoked to retrieve a value through a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02036BEC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.11">10.5.11<=
/a> FFI type <tt>ptr-out-d</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ptr-out-d </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02036BEC">ptr-out-d=
</a></tt>
type is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DF7E">ptr-out</=
a></tt>
which is useful for capturing return values or, in a callback
producing return values.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02036BEC">ptr-out-d=
</a></tt>
type has empty put semantics. If it put semantics is invoked, it does
nothing: no area is allocated for
<tt><i>type</i></tt>
and no pointer is stored into the argument space.
</p><p>
The in semantics is the same as that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>:
a pointer is retrieved from the argument space, the object is subject to
<tt><i>type</i></tt>'s
in semantics to recover the updated Lisp value, and then the object
is freed.
</p><p>
The get semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02036BEC">ptr-out-d=
</a></tt>
is identical to that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D7AC98">ptr-in-d<=
/a></tt>.
</p><p>
The out semantics is identical to that of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02D36BEC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.12">10.5.12<=
/a> FFI type <tt>ptr-out-s</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ptr-out-s </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02036BEC">ptr-out-d=
</a></tt>
type is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DF7E">ptr-out</=
a></tt>
similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02036BEC">ptr-out-d=
</a></tt>,
which assumes that the C object being received has an indefinite
lifetime, and doesn't need to be freed. The suffix stands for "static".
</p><p>
Like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02036BEC">ptr-out-d=
</a></tt>,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D36BEC">ptr-out-s=
</a></tt>
has no put semantics.
</p><p>
Its in semantics recovers a Lisp value from the external object whose point=
er
has been stored by the foreign function, but doesn't free the external
object.
</p><p>
The get semantics retrieves a Lisp value without freeing.
</p><p>

</p></dd></dl>
<a name=3D"N-01E6A76D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.13">10.5.13<=
/a> FFI type <tt>bool</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bool </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The parametrized type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
can be derived from any integer or floating-point type. There is also an
unparametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
which is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
for the type
<tt>(bool uchar)</tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
type family represents Boolean values, converting between a Lisp Boolean
and foreign Boolean. A given instance of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
type inherits all of its characteristics from
<tt><i>type</i></tt>,
such as its size, alignment and foreign representation. It alters the
get and put semantics, however. The get semantics converts a foreign zero
value of
<tt><i>type</i></tt>
to the Lisp symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and all other values to the symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
The put semantics converts the Lisp symbol
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to a foreign value of zero. Any other Lisp object converts to the foreign
value one.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
types are not integers, and cannot be used as the basis of bitfields:
syntax like
<tt>(bit 3 (bool uint))</tt>
is not permitted. However, Boolean bitfields are possible when this
syntax is turned inside out: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004E">bool</a></tt>
type can be derived from a bitfield type, as exemplified by
<tt>(bool (bit 3 uint))</tt>.
This simply applies the above described Boolean conversion semantics to a
three-bit field.  A zero/nonzero value of the field converts to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a>=
</tt>
and a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
or
non-<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</=
a></tt>
Lisp value converts to a 0 or 1 field value.
</p><p>

</p></dd></dl>
<a name=3D"N-011F2878">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.14">10.5.14<=
/a> FFI types <tt>ubit</tt> and <tt>sbit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;({ubit | sbit} </tt><tt><i>width</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
types denote C language style bitfields. These types can only appear
as members of structures. A bitfield type cannot be the argument or return
value of a foreign function or closure, and cannot be a foreign variable.
Arrays of bitfields and pointers, of any kind, to bitfields are a forbidden
type combination that is rejected by the type system.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
type denotes a bitfield of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>,
corresponding to an
<tt>unsigned</tt>
bitfield in the C language.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
type denotes a bitfield of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
Unlike in the C language, it is not implementation-defined whether such
a bitfield represents signed values; it converts between Lisp integers
that may be positive or negative, and a foreign representation which is
two's complement.
</p><p>
Bitfields based on some other types are supported using the more general
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
operator, which is described below.
</p><p>
The
<tt><i>width</i></tt>
parameter of is an expression evaluated in the top-level environment,
indicates the number of bits. It may range from
zero to the number of bits in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>
type.
</p><p>
In a structure, bitfields produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
are allocated out in storage units which have the
same width and alignment requirements as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>.
These storage units themselves can be regarded as anonymous members of the
structure.  When a new unit needs to be allocated in a structure to hold
bitfields, it is allocated in the same manner as a named member of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>
would be at the same position.
</p><p>
A zero-length bitfield is permitted. It may be given a name, but the field
will not perform any conversions to and from the corresponding slot in the
Lisp structure.  Note that in situations when the FFI struct definition cau=
ses the corresponding Lisp structure type to come into existence, the
Lisp structure type will have slots for all the zero width named bitfields,
even though those slots don't participate in any conversions in conjunction=
with the FFI type.
</p><p>
The presence of a zero-length bitfield ensures that a subsequent
structure member, whether bitfield or not, is placed in a new storage
unit of the size of the bitfield's base type.
</p><p>
Details about the algorithm by which bitfields are allocated within a struc=
ture
are given in the paragraph below entitled
<b>Bitfield Allocation Rules</b>.

</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
field stores values which follow a pure binary enumeration. For instance,
a bit field of width 4 stores values from 0 to 15. On conversion from
the Lisp structure to the foreign structure, the corresponding member
must be a integer value in this range, or an error exception is thrown.
</p><p>
On conversion from the foreign representation to Lisp, the integer
corresponding to the bit pattern is recovered. Bitfields follow the
bit order of the underlying storage word. That is to say, the most
significant binary digit of the bitfield is the one which is closest
to the the most significant bit of the underlying storage unit.
If a four-bit field is placed into an empty storage unit and the value
8 its stored, then on a big-endian machine, this has the effect of
setting to 1 the most significant bit of the underlying storage word.
On a little-endian machine, it has the effect of setting bit 3 of
the word (where bit 0 is the least significant bit).
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
field creates a correspondence between a range of Lisp integers,
and a foreign representation based on the two's complement system.
The most significant bit of the bit field functions as a sign bit.
Values whose most significant bit is clear are positive, and use
a pure binary representation just like their
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
counterparts. The representation of negative values is defined
by the "two's complement" operation, which maps each value to
its additive inverse. The operation consists of temporarily treating the
entire bitfield as unsigned, and inverting the logical value of all the
bits, and then adding 1 with "wrap-around" to zero if 1 is added to a field
consisting of all 1 bits. (Thus zero maps to zero, as expected).
An anomaly in the two's complement system is that the most negative
value has no positive counterpart. The two's complement operation
on the most negative value produces that same value itself.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
field of width 1
can only store two values: -1 and 0, represented by the bit patterns
1 and 0. An attempt to convert any other integer value to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
field of width 1 results in an error.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
field of width 2 can represent the values -2, -1, 0 and 1, which are
stored as the bit patterns 10, 11, 00 and 01, respectively.
</p><p>

</p></dd></dl>
<a name=3D"N-015B052B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.15">10.5.15<=
/a> FFI type <tt>bit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(bit </tt><tt><i>width</i></tt><tt> </tt><tt><i>type</i></t=
t><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
operator is more general than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>.
It allows for bitfields based on integer units smaller than or equal to <tt=
><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a></tt=
>.
</p><p>
The
<tt><i>type</i></tt>
argument may be any of the types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">short</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">uchar</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">ushort</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0131FBF2">int8</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">int16</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">int32</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0131FBF2">uint8</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">uint16</a=
></tt>
and <tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">uint3=
2</a></tt>.
</p><p>
When the character types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">uchar</a>=
</tt>
are used as the basis of bitfields, they convert integer values, not
characters.
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
the bitfield is signed. </p><p>
All remarks about
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">ubit</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011F2878">sbit</a><=
/tt>
apply to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000C">bit</a></tt>
also.
</p><p>
Details about the algorithm by which bitfields are allocated within a struc=
ture
are given in the paragraph below entitled
<b>Bitfield Allocation Rules</b>.

</p><p>

</p></dd></dl>
<a name=3D"N-00A6E963">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.16">10.5.16<=
/a> FFI types <tt>buf</tt> and <tt>buf-d</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;({buf | buf-d} </tt><tt><i>size</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The parametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
types are variants of the unparametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>,
respectively. The
<tt><i>size</i></tt>
argument is an expression which is evaluated in the top-level
environment, and must produce a non-negative integer.
</p><p>
Because they have a size, these types have useful get
semantics.
</p><p>
The get semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002D">buf-d</a></tt=
>
is that a Lisp object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
is created which takes direct ownership of the memory.
</p><p>
The get semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
is that a Lisp object is created using a dynamically allocated copy
of the memory.
</p><p>

</p></dd></dl>
<a name=3D"N-0139F9ED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.17">10.5.17<=
/a> FFI type <tt>carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type corresponds to a C pointer, in connection with the concept
of representing a variable length array that is passed and returned
as a pointer to the base element. On the Lisp side, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
FFI type corresponds to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
Lisp type. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
Lisp type is similar to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
,
but supports array indexing operations, and some other features.
It can be regarded as a semantic cross between
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>.
</p><p>
The get semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is simply that a pointer is retrieved from memory and converted to
a freshly allocated
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which holds that pointer, and is marked as having an unknown
size. No copy is made of the underlying array.  When the application
determines the size of the array, it can inform that object by means
of calling the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00705BC4">carray-se=
t-length</a></tt>
function.
</p><p>
The put semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
FFI type is simply to write, into the argument space, the pointer which the
object holds.  The object must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
whose element type matches that of the FFI type.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type lacks in or out semantics, since FFI doesn't manage any foreign
memory for the passage of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
and any two-directional communication of data through the array
handled by performing direct operations on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
Lisp object in application code.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type is particularly useful in situations when
foreign code generates such an array, and the size of that array
isn't known from the object itself.
</p><p>
It is also useful, instead of a variable-length
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
for passing a dynamic array to foreign code in situations when the applicat=
ion benefits
from managing the memory for the array. The variable-length
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
FFI type's disadvantage relative to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
converts an entire Lisp sequence to a temporarily allocated
array, which is used only for one call. By contrast, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object holds the C representation which Lisp code can manipulate;
and that representation is passed directly, just like in the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>.
</p><p>
Unlike
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>,
there is no dynamic variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
The transfer of ownership of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
requires the use of explicit operations like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0010030E">carray-fr=
ee</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-ow=
n</a></tt>.
</p><p>
It is possible to create a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
view over a buffer, using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D75AD6">carray-bu=
f</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01E726E5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.18">10.5.18<=
/a> FFI type <tt>cptr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(cptr </tt><tt><i>type-sym</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The parametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type is similar to the unparametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
It also converts between Lisp objects of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
and foreign pointers. However, it provides a measure of type safety.
</p><p>
When a foreign pointer is converted to a Lisp object under control of the
parametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
,
the resulting Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object is tagged with the
<tt><i>type-sym</i></tt>
symbol.
</p><p>
In the reverse direction, when a Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object is converted to the parametrized type, its type tag must match
<tt><i>type-sym</i></tt>,
or else the conversion fails with an error exception.
This rule contains a slight relaxation: a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
tag can be converted to a foreign representation using any parametrized typ=
e,
if its value is null. In other situations, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A212ED">cptr-cast=
</a></tt>
function must be used to coerce the pointer object to the matching type.
</p><p>
Note that if
<tt><i>type-sym</i></tt>
is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then this is precisely equivalent to the unparametrized
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
which doesn't provides the above safety measure.
</p><p>
Pointer type safety is useful, because FFI can be used to create bindings
to large application programming interfaces (APIs) in which objects of
many different kinds are referenced using pointer handles. The erroneous
situation can occur that a FFI call passes a handle of one kind to a functi=
on
expecting a different kind of handle. If all pointer handles are represente=
d
by a single
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type, then such a situation proceeds without diagnosis.
If handles of different types are all mapped to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
types with different tags, the situation is intercepted and diagnosed
with an error exception.
</p><p>

</p></dd></dl>
<a name=3D"N-01C7BC08">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.5.19">10.5.19<=
/a> FFI type <tt>align</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(align </tt><tt><i>width</i></tt><tt> </tt><tt><i>type</i><=
/tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The FFI type operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C7BC08">align</a>=
</tt>
defines a type which is a copy of
<tt><i>type</i></tt>,
but with the alignment requirement replaced by the
<tt><i>width</i></tt>.
</p><p>
The
<tt><i>width</i></tt>
argument is an expression which is evaluated in the top-level
environment. It must produce a positive integer which is a power of two.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C7BC08">align</a>=
</tt>
operator can be used to create a version of
<tt><i>type</i></tt>
with stricter or weaker alignment. Alignment affects the placement of
the type as a structure member, and as an array element.
</p><p>
A type with alignment 1 can be placed at any byte offset. A type with
alignment 2 can be placed only at even addresses and offsets.
</p><p>
Alignment can be applied to all types, including arrays and structs.
It may also be applied to bitfields, but special considerations have
to be observed to obtain the intended effect, described below.
However,
out of the elementary types, only the integer and floating point types are
required to support a weakening of alignment. Whether a type which correspo=
nds
to a pointer, such as a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>,
can be written at an offset which doesn't meet that type's default alignmen=
t
is machine-dependent.
</p><p>
If a FFI struct type is declared with a weakened alignment, whether or not =
such
a structure can be read or written at the misaligned offsets depends on whe=
ther
the individual members support it. If they are integer or floating-point ty=
pes,
or aggregates thereof, the usage is supported in a machine-independent mann=
er.
</p><p>
A struct type declared to have a weaker alignment, such as 1, does not
lose any of the padding at its end. That is to say, alignment has no effect
on structure size. It affects the offset at which a structure is placed as
a member of an array or another structure, with its padding intact. To
eliminate the padding at the end of a structure, it is necessary to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C7BC08">align</a>=
</tt>
to manipulate the alignment of individual members.
</p><p>
When
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C7BC08">align</a>=
</tt>
is applied to the type of a bitfield member of a structure, it has no effec=
t on
placement. The alignment of a non-zero bitfield which begins a new
storage unit is taken into consideration for the purpose of determining
the most strictly alignment member of the structure.  The alignment of all
other bitfields is ignored.
</p><p>
</p></dd></dl>
<a name=3D"N-0286B807">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.6">10.6</a> Ad=
ditional Types</h3>



<p>



<a name=3D"N-03258244">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.6.1">10.6.=
1</a> FFI types <tt>size-t</tt>, <tt>ptrdiff-t</tt>, <tt>int-ptr-t</tt>, <t=
t>uint-ptr-t</tt>, <tt>wint-t</tt>, <tt>sig-atomic-t</tt>, <tt>time-t</tt> =
and <tt>clock-t</tt> .</h4>



These additional FFI types for common C language types are provided as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
aliases.
<p>

<a name=3D"N-015DE290">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.6.2">10.6.=
2</a> FFI type <tt>qref</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(qref </tt><tt><i>struct-type</i></tt><tt> </tt><tt><i>memb=
er1</i></tt><tt> [</tt><tt><i>member2</i></tt><tt> ...])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The FFI type operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
provides a way to reference the type of a member of a struct or union.
The
<tt><i>struct-type</i></tt>
argument must be a type expression denoting a struct or union.
The
<tt><i>member1</i></tt>
argument and any additional arguments must be symbols.
</p><p>
If
<tt>S</tt>
is a struct or union type, and
<tt>M</tt>
is a member, then
<tt>(qref S M)</tt>
is a type expression denoting the type of
<tt>M</tt>.
Moreover, if
<tt>M</tt>
itself is a struct or union, which has a member named
<tt>N</tt>
then the type of
<tt>N</tt>
can be denoted by the expression
<tt>(qref S M N)</tt>.
Similarly, additional symbols reference through additional struct/union
nestings.
</p><p>
Note: the referencing dot syntax can be used to write
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0058">qref</a></tt>
expressions.
For instance,
<tt>(qref S M N)</tt>
can be written as
<tt>S.M.N</tt>
instead.
</p><p>

</p></dd></dl>
<a name=3D"N-008CEE1E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.6.3">10.6.3</a=
> FFI type <tt>elemtype</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(elemtype </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The FFI type operator
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000D">elemtype</a><=
/tt>
denotes the element type of
<tt><i>type</i></tt>,
which must be a pointer, array or enum.
</p><p>
Note: there is also a macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000D">elemtype</a><=
/tt>.
The macro expression
<tt>(elemtype X)</tt>
is equivalent to the expression
<tt>(ffi (elemtype X))</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01D716FE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.6.4">10.6.4</a=
> FFI types <tt>blkcnt-t</tt>, <tt>blksize-t</tt>, <tt>clockid-t</tt>, <tt>=
dev-t</tt>, <tt>fsblkcnt-t</tt>, <tt>fsfilcnt-t</tt>, <tt>gid-t</tt>, <tt>i=
d-t</tt>, <tt>ino-t</tt>, <tt>key-t</tt>, <tt>loff-t</tt>, <tt>mode-t</tt>,=
 <tt>nlink-t</tt>, <tt>off-t</tt>, <tt>pid-t</tt>, <tt>ssize-t</tt> and <tt=
>uid-t</tt></h4>



The additional names of various common POSIX types may also be available,
depending on platform. They are provided as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
aliases.
<p>
<a name=3D"N-018D3223">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.7">10.7</a=
> Endian Types</h3>



<p>


In addition to the type system described in the previous section.
the FFI type system supports
<i>endian types</i>,

which are useful for dealing with
data formats defined by networking protocols and other kinds of standards,
or data structure definitions from other machines. </p><p>
There are two kinds of
<i>endianness</i>:

<i>Little endian</i>

refers to the least-significant byte of a data type being
stored at the lowest address in memory, lowest offset in a buffer, lowest
offset in a file, or earlier byte in a communication stream.
<i>Big endian</i>

is the opposite: it refers to the most significant byte occurring
at the lowest address, offset or stream position.
For each of the signed integral types
</p><p>
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">int16</a>=
</tt>
through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">int64</a>=
</tt>,
the corresponding unsigned types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">uint16</a=
></tt>
through
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">uint64</a=
></tt>,
and the two floating-point types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>,
the FFI type system provides a big-endian and little endian version,
whose names are derived by prefixing the
<tt>be-</tt>
or
<tt>le-</tt>
prefix to its related type.
</p><p>
Thus, the exhaustive list of the endian types is:
<tt>be-int16</tt>,
<tt>be-uint16</tt>,
<tt>be-int32</tt>,
<tt>be-uint32</tt>,
<tt>be-int64</tt>,
<tt>be-uint64</tt>,
<tt>be-float</tt>,
<tt>be-double</tt>,
<tt>le-int16</tt>,
<tt>le-uint16</tt>,
<tt>le-int32</tt>,
<tt>le-uint32</tt>,
<tt>le-int64</tt>,
<tt>le-uint64</tt>,
<tt>le-float</tt>
and
<tt>le-double</tt>.
</p><p>
These types have the same size and alignment as their plain, unprefixed
counterparts. Alignment can be overridden with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C7BC08">align</a>=
</tt>
type construction operator to create versions of these types with alternati=
ve
alignment.
</p><p>
Endian types are supported as arguments to functions, return values,
members of structs and elements of arrays.
</p><p>
<b>TXR Lisp</b>'s FFI performs the automatic conversion from the abstract L=
isp integer
representation to the foreign representations exhibiting the specified
endianness.
</p><p>
<a name=3D"N-02ECE110">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.8">10.8</a=
> Incomplete Types</h3>



<p>


</p><p>
In the <b>TXR Lisp</b> FFI type system, the following types are
<i>incomplete</i>:

the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DE1A3">void</a><=
/tt>,
arrays of unspecified size, and any
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
whose last element is of incomplete type.
</p><p>
An incomplete type cannot used as a function parameter type, or a return
value type. It may not be used as an array element or union member type.
A struct member type may be incomplete only if it is the last member.
</p><p>
An incomplete structure whose last member is an array is a
<i>flexible structure</i>.

</p><p>
<a name=3D"N-02DBE9F3">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.9">10.9</a=
> Flexible Structures</h3>



<p>


</p><p>
If a FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type is defined with an incomplete array (an array of unspecified size) as =
its
last member, then it specifies an incomplete type known as a
<i>flexible structure</i>.

That array is the
<i>terminating array</i>.

The terminating array corresponds to a slot in the Lisp structure; that
slot is the
<i>last slot</i>.

</p><p>
A structure which has a flexible structure as its last member is also,
effectively, a flexible structure.
</p><p>
When a Lisp structure is being converted to the foreign representation
under the control of a flexible structure FFI type, the number of elements
in the terminating array is determined from the length of the object
stored in the last slot of the Lisp structure. The length includes the
terminating null element for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
types. The conversion is consistent with the semantics of an incomplete
arrays that is not a structure member.
</p><p>
In the reverse direction, when a foreign representation is being converted
to a Lisp structure under the control of a flexible structure FFI type,
the size of the array that is accessed and extracted is determined from
the length of the object stored in the last slot, or, if the array type
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
from detecting null-termination of the foreign array. The conversion of
the array itself is consistent with the semantics of an incomplete
arrays that is not a structure member.
Before the conversion takes place, all of the members of the
structure prior to the the terminating array, are extracted and converted t=
o
Lisp representations.  The corresponding slots of the Lisp structure are
updated. Then if the Lisp structure type has a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>
method, that method is invoked. The return value of the method is used
to perform an adjustment on the object in the last slot.
If the existing object in the last slot is a vector, its length is adjusted=
 to
the value returned by the method. If the existing
object isn't a vector, then it is replaced by a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>-filled
vector, whose length is given by the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0006">length</a></t=
t>.
The conversion of the terminating array to Lisp representation the proceeds
after this adjustment, using the adjusted last slot object.
</p><p>
<a name=3D"N-027D075C">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.10">10.10<=
/a> Bitfield Allocation Rules</h3>



<p>


The <b>TXR Lisp</b> FFI type system follows rules for bitfield allocation w=
hich were
experimentally derived from the behavior of the GNU C compiler on several
mainstream architectures.
</p><p>
The allocation algorithm can be imagined to walk through the structure
from the first member to the last, maintaining a byte offset
<i>O</i>

which indicates how many whole bytes have been allocated to members so far,
and a bit offset
<i>B</i>

which indicates, additionally, how many bits have been allocated in the
byte which follows these
<i>O</i>

bytes, between 0 and 7.
</p><p>
When a non-bitfield member is placed, then there are two cases: either
<i>B</i>

is zero (only
<i>O</i>

bytes have been allocated, with no fractional byte) or else
<i>B</i>

is nonzero. In this latter case,
<i>B</i>

is reset to zero and
<i>O</i>

is incremented by one. In either case,
<i>O</i>

is adjusted up to the required alignment boundary for the new member.
The member is placed, and
<i>O</i>

is incremented again by the size of that member.
</p><p>
When a bitfield member is placed, the algorithm considers the structure
to be allocated in units of the base type of that bitfield member.
For instance if the bitfield is derived from type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">uint16</a=
></tt>
then the structure's layout is considered to have been allocated in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D0AA7B">uint16</a=
></tt>
units. The algorithm examines the value of
<i>O</i>

and
<i>B</i>

to determine the first available unit in which at least
one bit of unallocated space remains.
Then, if the unit at that offset has enough space to hold the new
bitfield, according to the bitfield's width, then the bitfield is
placed into that unit. Otherwise, the bitfield is placed into the
next available unit.
</p><p>
After a bitfield is placed, the values of
<i>O</i>

and
<i>B</i>

are adjusted so that
<i>O</i>

reflects the whole number of bytes which have been allocated to the
structure so far, and
<i>B</i>

indicates the 0 to 7 additional bits of any bitfield material protruding
past those whole bytes.
</p><p>
A zero-width bitfield is also considered with regard to the storage
unit size indicated by its type. As in the case of the nonzero-width
bitfield, the offset of the first available unit is found which
has at least one bit of unallocated space. Then, if that unit is
entirely empty, the zero-width bitfield has no effect. If that unit is
partially filled, then
<i>O</i>

is adjusted to point to the next unit after that, and
<i>B</i>

is reset to zero. Note that according to this semantics, a zero-width bitfi=
eld
can have an effect even if placed between non-bitfield members, or appears
as the last member of a structure.  Also, a structure containing only a
zero-width bitfield has size zero.
</p><p>
If, after the placement of all structure members,
<i>B</i>

has a nonzero value, then the offset
<i>O</i>

is incremented by one to cover that byte.
</p><p>
As the last allocation step, the size of the structure is then padded up to=
 a
size which is a multiple of the alignment of the most strictly aligned memb=
er.
</p><p>
A named bitfield contributes to the alignment of the structure, according t=
o
its type, the same way as a non-bitfield member of the same type.
An unnamed bitfield doesn't contribute alignment, or else may be regarded a=
s
having the weakest possible alignment, which is byte alignment.
If all of the members of a structure are unnamed bitfield members of any ty=
pe,
it exhibits byte alignment.
</p><p>
The description isn't complete without a treatment of byte and bit order.
Bitfield allocation follows an imaginary "bit endianness" whose direction
follows the machine's byte order: most significant bits are allocated first=
 on
big endian, least significant bits first on little-endian.
</p><p>
If a one-bit-wide bitfield is allocated into a hitherto empty structure, it
will be placed into the first byte of that structure, regardless of the
machine's endianness, and regardless of the underlying storage unit size fo=
r
that bitfield. Within that first byte, it will be placed into the most
significant bit position on a big-endian machine (bit 7); and on a
little-endian machine, it will be placed into the least significant bit
position (bit 0). If another one-bit-wide is allocated, it is placed into
bit 6 on big-endian, and bit 1 on little-endian.
</p><p>
More generally, whenever a bitfield is allocated for a big-endian machine, =
and
the storage unit is determined into which that bitfield shall be placed, th=
e
most significant bits of that storage unit are filled first on a big-endian
machine, whereas the least significant bits are filled first on a little-en=
dian
machine.  From this it follows that on either type of machine, that field s=
hall
be placed at the lowest-addressed byte or bytes in which unallocated bits
remain.
</p><p>
<a name=3D"N-03231BE6">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.11">10.11<=
/a> FFI Call Descriptors</h3>



<p>


</p><p>
The FFI mechanism makes use of a type-like representation called the "call
descriptor". A call descriptor is an object which uses FFI types to describ=
e
function arguments and return values. A FFI descriptor is required to call
a foreign function, and to create a FFI closure to use as a callback
function from a foreign function back into <b>TXR Lisp</b>.
</p><p>
A FFI descriptor object can be constructed from a return value type, and a =
list
of argument types, and several other pieces of information using the
function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A96E1C">ffi-make-=
call-desc</a></tt>.
</p><p>
This object can then be passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023DCFF9">ffi-call<=
/a></tt>
to specify the C type signature of a foreign function, or to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095DF58">ffi-make-=
closure</a></tt>
to specify the C type signature of a FFI closure to bind to a Lisp function=
.
</p><p>
The FFI macros
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
provide a simplified syntax for expressing FFI call descriptors,
which includes a notation for expressing variadic calls.
</p><p>
A note about variadic foreign functions: although there is support
in the call descriptor mechanism for expressing a variadic function,
it expresses a particular
<b>instance</b>

of a variadic function, rather than the variadic function's type
<i>per se</i>.

To call the same variadic function using different variadic arguments,
different call descriptors are required. For instance to perform
the equivalent of the C function call
<tt>

printf("hello\n")
</tt>

requires a certain descriptor. To perform the equivalent of
<tt>

printf("hello, %s\n", name)
</tt>

requires a different descriptor.
</p><p>
<a name=3D"N-01D49526">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12">10.12<=
/a> Foreign Function Type API</h3>



<p>


</p><p>
This group of functions comprises the basic interface to the <b>TXR Lisp</b=
>'s FFI
type system module.
</p><p>

<a name=3D"N-02940F9A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.1">10.1=
2.1</a> Function <tt>ffi-type-compile</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-type-compile </tt><tt><i>syntax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-=
compile</a></tt>
function produces and returns a compiled type object from a
<tt><i>syntax</i></tt>
argument which specifies valid FFI syntax.
If the type syntax is invalid, or specifies a nonexistent
type specifier or operator, an exception is thrown.
</p><p>
Note: whenever a function argument is required to be of FFI type,
what it means is that it must be a compiled object, and not
a Lisp expression denoting FFI syntax.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
940F9A">ffi-type-compile</a> 'int) -&gt; #&lt;ffi-type int&gt;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-c=
ompile</a>
    '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</=
a> 3 double)) -&gt; #&lt;ffi-type (<a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0117BE95">array</a> 3 double)&gt;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-c=
ompile</a> 'blarg) -&gt; ;; error
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-01A96E1C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.2">10.12.2<=
/a> Function <tt>ffi-make-call-desc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-make-call-desc </tt><tt><i>ntotal</i></tt><tt> </tt><t=
t><i>nfixed</i></tt><tt> </tt><tt><i>rettype</i></tt><tt> </tt><tt><i>argty=
pes</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A96E1C">ffi-make-=
call-desc</a></tt>
function constructs a FFI call descriptor.
</p><p>
The
<tt><i>ntotal</i></tt>
argument must be a non-negative integer; it indicates the number
of arguments in the call.
</p><p>
If the call denotes a variadic function, the
<tt><i>nfixed</i></tt>
argument must be an integer between 1 and
<tt><i>ntotal</i></tt>,
denoting the number of fixed arguments.
If the call denotes an ordinary, non-variadic function, then
<tt><i>nfixed</i></tt>
must be specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><i>rettype</i></tt>
parameter must be an FFI type. It specifies the function
return type. Functions which don't return a value are specified
by the (compiled version of) the return type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DE1A3">void</a><=
/tt>.
</p><p>
The
<tt><i>argtypes</i></tt>
argument must be a list of types, containing at least
<tt><i>ntotal</i></tt>
elements. If the function takes no arguments, this list is empty.
If the function is variadic, then the first
<tt><i>nfixed</i></tt>
elements of this list specify the types of the fixed arguments;
the remaining elements specify the variadic arguments.
</p><p>
Note: variadic functions must not be called using a non-variadic
descriptor, and
<i>vice versa</i>,

even if the return types and
argument types match.
</p><p>
Note: unlike the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
macros,
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A96E1C">ffi-make-=
call-desc</a></tt>
function doesn't perform any special treatment of variadic parameter types.
When any of the types
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>,
<tt>be-float</tt>
or
<tt>le-float</tt>
occur in the variadic portion of
<tt><i>argtypes</i></tt>,
it is unspecified whether a descriptor is successfully produced and returne=
d
or whether an exception is thrown. If a descriptor is successfully produced=
,
and then subsequently used for making or accepting calls, the behavior is
undefined.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;;
  ;; describe a call to the variadic function
  ;;
  ;;   type void (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02239=
6F7">*</a>)(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">c=
har</a> *, ...)
  ;;
  ;; with these actual arguments
  ;;
  ;;   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char<=
/a> *, int)
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A96E1C">ffi-make-c=
all-desc</a>
    2 ;; two arguments
    1 ;; one fixed
   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-=
compile</a> 'void)        ;; returns nothing
   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> =
(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-com=
pile</a> 'str)   ;; str -&gt; char *
         (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi=
-type-compile</a> 'int))) ;; int
  --&gt;
  #&lt;ffi-call-desc #&lt;ffi-type void&gt;
    (#&lt;ffi-type str&gt; #&lt;ffi-type int&gt;)&gt;
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00E31038">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.3">10.12.3<=
/a> Function <tt>ffi-type-operator-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-type-operator-p </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E31038">ffi-type-=
operator-p</a></tt>
function return
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>symbol</i></tt>
is a type operator symbol: a symbol used in the first position of
a recognized compound type form in the FFI type system.
</p><p>
Otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01EE962E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.4">10.12.4<=
/a> Function <tt>ffi-type-p</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-type-p </tt><tt><i>symbol</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EE962E">ffi-type-=
p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>symbol</i></tt>
denotes a type in the FFI type system: either a built-in type or
an alias type name established by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>.
</p><p>
Otherwise, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0095DF58">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.5">10.12.5<=
/a> Function <tt>ffi-make-closure</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-make-closure </tt><tt><i>lisp-fun</i></tt><tt> </tt><t=
t><i>call-desc</i></tt><tt>=20




<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [</tt><tt><i>safe-p</i></tt><tt=
> [</tt><tt><i>abort-val</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095DF58">ffi-make-=
closure</a></tt>
function binds a Lisp function
<tt><i>lisp-fun</i></tt>,
which may be a lexical closure, or any callable object, with a FFI call
descriptor
<tt><i>call-desc</i></tt>
to produce a FFI closure.
</p><p>
A FFI closure is an object of type
<tt>ffi-closure</tt>
which is suitable as an argument for the type denoted by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0216EF16">closure</=
a></tt>
type specifier keyword in the FFI type language.
</p><p>
This type appears a C function pointer in the foreign code,
and may be called as such. When it is called by foreign
code, it triggers a call to
<tt><i>lisp-fun</i></tt>.
</p><p>
The optional
<tt><i>safe-p</i></tt>
parameter controls whether the closure dispatch is "safe", the meaning of
which is described shortly. The default value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
so that unsafe closure dispatch must be explicitly requested with a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
argument for this parameter.
</p><p>
A callback closure which is safely dispatched, firstly, does not permit
the capture of delimited continuations across foreign code. Delimited
continuations can be captured inside a closure dispatched that way, but the
delimiting prompt must be within the callback's local stack frame, without
traversing across the foreign stack frames.  Secondly, a callback closure w=
hich
is safely dispatched doesn't permit direct non-local control transfers acro=
ss
foreign code, such as exception handling. Such transfers, however, appear t=
o
work anyway (with caveats): this is because they are specially handled. The
closure dispatch mechanism intercepts all dynamic control transfers, conver=
ts
them to an ordinary return from the callback to the foreign code, and resum=
es
the control transfer when the foreign code itself finishes and returns.
If the callback returns a value (its return type is other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DE1A3">void</a><=
/tt>)
then in this situation, the callback returns an all-zero-bits return
value to the foreign caller. If the
<tt><i>abort-val</i></tt>
parameter is specified and its value is other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then that value will be used as the return value instead of an all-zero
bit pattern.
</p><p>
An unsafely dispatched closure permits the capture of continuations from
the callback across the foreign code and direct dynamic control transfers w=
hich
abandon the foreign stack frames.
</p><p>
Unsafe closure dispatch is only compatible with foreign code which is
designed with that usage in mind. For instance foreign code which holds
dynamic resources in stack variables will leak those resources if abandoned
this way. There are also issues with capturing continuations across foreign
code.
</p><p>
Note: the C function pointer is called a "closure" because it carries
environment information. For instance, if
<tt>lisp-fun</tt>
is a lexical closure, invocations of it through the FFI closure
occur in its proper lexical environment, even though its external
representation is a simple C function pointer. This requires a special
trampoline trick: a piece of dynamically constructed machine code with the
closure binding embedded inside it, with the C function pointer pointing
to the machine code.
</p><p>
Note: the same call descriptor can be reused multiple times to create
different closures. The same Lisp function can be involved in multiple
FFI closures.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; Package the TXR cmp-str function as a string
  ;; comparison callback compatible with:
  ;;
  ;;   int (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*=
</a>)(const char *, const char *)
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095DF58">ffi-make-c=
losure</a>
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006E109C">fun</a> =
cmp-str)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A96E1C">ffi-make=
-call-desc</a> 2 nil ;; two args, non-variadic
      (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-ty=
pe-compile</a> 'int) ;; int return
      [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0202F92F">mapcar=
</a> ffi-type-compile '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-00C6B7C4">str</a> str)])) ;; args
</tt></pre><tt>

</tt>

<p>
</p><p>

</p></dd></dl>
<a name=3D"N-023DCFF9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.6">10.12.6<=
/a> Function <tt>ffi-call</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-call </tt><tt><i>fun-cptr</i></tt><tt> </tt><tt><i>cal=
l-desc</i></tt><tt> {</tt><tt><i>arg</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023DCFF9">ffi-call<=
/a></tt>
function invokes a foreign function.
</p><p>
The
<tt><i>fun-cptr</i></tt>
argument which must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object. It is assumed to point to a foreign function.
</p><p>
The
<tt><i>call-desc</i></tt>
argument must be a FFI call descriptor, produced by
<tt>ffi-call-desc</tt>.
</p><p>
The
<tt><i>call-desc</i></tt>
must correctly describe the foreign function.
</p><p>
The zero or more
<tt><i>arg</i></tt>
arguments are values which are converted into foreign
argument values. There must be exactly as many of these arguments
as are required by
<tt><i>call-desc</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023DCFF9">ffi-call<=
/a></tt>
function converts every
<tt><i>arg</i></tt>
to a corresponding foreign object. If these conversions are
successful, the converted foreign arguments are passed by value
to the foreign function indicated by
<tt><i>fun-cptr</i></tt>.
An unsuccessful conversion throws an error.
</p><p>
When the call returns, the foreign function's return value is
converted to a Lisp object and returned, in accordance with the
return type that is declared inside
<tt><i>call-desc</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0094D6D7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.7">10.12.7<=
/a> Function <tt>ffi-typedef</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-typedef </tt><tt><i>name</i></tt><tt> </tt><tt><i>type=
</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0094D6D7">ffi-typed=
ef</a></tt>
function installs the compiled FFI type given by
<tt><i>type</i></tt>
as a typedef name under the symbol given by
<tt><i>name</i></tt>.
</p><p>
After this registration, whenever the type compiler encounters that
symbol being used as a type specifier, it will replace it by the
type object it represents.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0094D6D7">ffi-typed=
ef</a></tt>
function returns type.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; define refcount-t as an alias for uint32
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0094D6D7">ffi-typede=
f</a> 'refcount-t (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0294=
0F9A">ffi-type-compile</a> 'uint32))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00CDBB53">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.8">10.12.8<=
/a> Function <tt>ffi-size</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-size </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CDBB53">ffi-size<=
/a></tt>
function returns an integer which gives the storage size of
the given FFI type: the amount of storage required for the
external representation of that type.
</p><p>
Bitfield types do not have a size; it is an error to apply
this function to a bitfield.
</p><p>
The size is machine:specific.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
CDBB53">ffi-size</a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
02940F9A">ffi-type-compile</a> 'double)) -&gt; 8
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CDBB53">ffi-size</=
a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type=
-compile</a> 'char)) -&gt; 1
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CDBB53">ffi-size</=
a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type=
-compile</a>
               '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE=
95">array</a> 42 char))) -&gt; 42
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00061B61">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.9">10.12.9<=
/a> Function <tt>ffi-alignof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-alignof </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00061B61">ffi-align=
of</a></tt>
function returns an integer which gives the alignment
the given FFI type. When an instance of
<tt><i>type</i></tt>
is placed into a structure as a member, it is placed after the previous mem=
ber
at the smallest available offset which is divisible by the alignment.
The bytes skipped from the smallest available offset to the smallest
available aligned offset are referred to as
<i>padding</i>.

</p><p>
Bitfield types do not have an alignment; it is an error to apply
this function to a bitfield. Bitfields are allocated in
storage cells, and those cells have alignment which is the
same as that of the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>.
</p><p>
The alignment is machine-specific. It may be more strict than what the
hardware architecture requires, yet at the same time be smaller than the si=
ze
of the type. For instance, the size of the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>
is commonly 8, yet the alignment is often 4, and this is so
even on processors like Intel x86 which can load and store
a double at a misaligned address.
</p><p>
The alignment of an array is the same as that of its element type.
</p><p>
The alignment of a structure is that of its member which has the
most strict (largest-valued) alignment.
</p><p>
It is a property of arrays, derived from requirements governing the C
language, that if the first element of an array is at a correctly aligned
address, then all elements are. To ensure that this property holds for
for arrays of structures, structures sometimes must include
padding at the end. This is because the size of a structure without any
padding might not be multiple of its alignment, which is derived from the m=
ost
strictly aligned member. For instance, if we assume an architecture on whic=
h
the size and alignment of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">int</a></=
tt>
is 4, the size of the structure type
<tt>(struct ab (a int) (b char))</tt>
would be 5 if no padding were included.  However,
in an array of these structures, the second element's
<tt>a</tt>
member would be placed at offset 5, rendering it misaligned.
To ensure that every
<tt>a</tt>
is placed at an offset which is multiple of 4, the struct type is extended
with anonymous padding so that its size is 8.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
061B61">ffi-alignof</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-020F3A1C">ffi</a> double)) -&gt; 4
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0318DA0C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.10">10.12.1=
0</a> Function <tt>ffi-offsetof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-offsetof </tt><tt><i>type</i></tt><tt> </tt><tt><i>mem=
ber</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00061B61">ffi-align=
of</a></tt>
function calculates the byte offset of
<tt><i>member</i></tt>
within the FFI type
<tt><i>type</i></tt>.
</p><p>
If
<tt><i>type</i></tt>
isn't a FFI struct type, or if
<tt><i>member</i></tt>
isn't a symbol naming a member of that type,
the function throws an exception.
</p><p>
An exception is also thrown if
<tt><i>member</i></tt>
is a bitfield.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
18DA0C">ffi-offsetof</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-020F3A1C">ffi</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0=
035">struct</a> ab (a int) (b char))) 'b) -&gt; 4
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03DC1AED">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.11">10.12.1=
1</a> Function <tt>ffi-arraysize</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-arraysize </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DC1AED">ffi-array=
size</a></tt>
function reports the number of elements in
<tt><i>type</i></tt>,
which must be an array type: an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
DC1AED">ffi-arraysize</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-020F3A1C">ffi</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0117BE95">array</a> 5 int))) -&gt; 5
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00DF8E15">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.12">10.12.1=
2</a> Function <tt>ffi-elemsize</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-elemsize </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DF8E15">ffi-elems=
ize</a></tt>
function reports the size of the element type of an array,
of the target type of a pointer, or of the base integer type of an enumerat=
ion.
The
<tt><i>type</i></tt>
argument must be an array, pointer or enumeration type: a type constructed
by one of the operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DF7E">ptr-out</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CDE57C">enum</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01096D60">enumed</a=
></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
DF8E15">ffi-elemsize</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-020F3A1C">ffi</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
117BE95">array</a> 5 int))) -&gt; 4 ;; (<a href=3D"http://nongnu.org/txr/tx=
r-manpage.html#N-0235DCAE">sizeof</a> int)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02DF8E12">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.12.13">10.12.1=
3</a> Function <tt>ffi-elemtype</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-elemtype </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DF8E12">ffi-elemt=
ype</a></tt>
function retrieves the element type of an array type,
target type of a pointer type, or base integer type of an enumeration.
The
<tt><i>type</i></tt>
argument must be an array, pointer or enumeration type: a type constructed
by one of the operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027B04D0">ptr</a></=
tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A494BF">ptr-in</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DF7E">ptr-out</=
a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01CDE57C">enum</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01096D60">enumed</a=
></tt>.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
DF8E12">ffi-elemtype</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-020F3A1C">ffi</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
27B04D0">ptr</a> int))) -&gt; #&lt;ffi-type int&gt;
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-03311048">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13">10.13</a> =
Foreign Function Macro Language</h3>



<p>


</p><p>
This group of macros provides a higher-level language for working with
FFI types and defining foreign function bindings. The macros are implemente=
d
using the Foreign Function Type API described in the previous section.
</p><p>

<a name=3D"N-023E0D2C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.1">10.1=
3.1</a> Macro <tt>with-dyn-lib</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-dyn-lib </tt><tt><i>lib-expr</i></tt><tt> </tt><tt><i=
>body-form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro works in conjunction with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B237BB">deffi-sym=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C237C9">deffi-var=
</a></tt>
macros.
</p><p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form appears as one of the
<tt><i>body-form</i></tt>-s
of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro, that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form is permitted to use the simplified forms of the
<tt><i>fun-expr</i></tt>
argument, to refer to library functions succinctly, without having
to specify the library. The same remark applies to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B237BB">deffi-sym=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C237C9">deffi-var=
</a></tt>,
regarding their
<tt><i>var-expr</i></tt>
parameter.
</p><p>
A form invoking the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro should be a top-level form.  The macro creates a global variable name=
d
by a symbol generated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>
whose initializing expression binds it to a dynamic library handle.
The macro then creates an environment in which the enclosed
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C237C9">deffi-var=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B237BB">deffi-sym=
</a></tt>
forms can implicitly refer to that library via the global variable.
</p><p>
The
<tt><i>lib-expr</i></tt>
argument can take on three different forms:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt>nil
</tt></dt><dd>



If
<tt><i>lib-expr</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
arranges for the library to refer to the <b>TXR</b> executable itself.



</dd><dt><tt><tt><i>string</i></tt><tt> </tt></tt></dt><dd>



If
<tt><i>lib-expr</i></tt>
is a literal string, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
will arrange for the hidden variable to be initialized with
an expression which opens a handle to the specified library.
<p>



</p></dd><dt><tt><tt><i>form</i></tt><tt> </tt></tt></dt><dd>



If
<tt><i>lib-expr</i></tt>
is any other form, then it is assumed to denote syntax for
opening the handle to a library. That syntax is used verbatim
as the initializing expression for the generated global variable
which holds the library handle.
</dd></dl>
</dl>
<p>

The result value of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
form is the symbol which names the generated variable which
holds the library handle.
</p><p>
</p></dd><dt>Examples:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; refer to malloc and free functions
  ;; in the executable

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-l=
ib</a> nil
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a=
> malloc "malloc" cptr (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-03258244">size-t</a>))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a=
> free "free" void (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002=
7">cptr</a>)))

  ;; refer to "draw" function in fictitious
  ;; "libgraphics" library:

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-l=
ib</a> "libgraphics.so.5"
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a=
> draw "draw" int (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027=
">cptr</a> cptr)))

  ;; refer to "init_foo" function via specific
  ;; library handle.

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defvarl</a=
> foo-lib (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037C4BFE">dl=
open</a> "libfoo.so.1"))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-l=
ib</a> foo-lib
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a=
> init-foo "init_foo" void (<a href=3D"http://nongnu.org/txr/txr-manpage.ht=
ml#N-013DE1A3">void</a>)))
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-00DCE51D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.2">10.13.2<=
/a> Macro <tt>deffi</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(defmacro deffi </tt><tt><i>name</i></tt><tt> </tt><tt><i>f=
un-expr</i></tt><tt> </tt><tt><i>rettype</i></tt><tt> </tt><tt><i>argtypes<=
/i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
macro arranges for a Lisp function to be defined, via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>,
which calls a foreign function.
</p><p>
The
<tt><i>name</i></tt>
argument must be a symbol suitable as a function name in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
form. This specifies the function's Lisp name.
</p><p>
The
<tt><i>fun-expr</i></tt>
parameter specifies the foreign function which is to be called.
The syntactic variants permitted for its argument are
described below.
</p><p>
The
<tt><i>rettype</i></tt>
argument must specify the return type, using the FFI type syntax,
as an unquoted literal.  The macro arranges for the compilation of this
syntax via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-=
compile</a></tt>.
</p><p>
The
<tt><i>argtypes</i></tt>
argument must specify a list of the argument types, as an unquoted
literal list, using FFI type syntax. The macro arranges for these types
to be compiled. Furthermore, a special convention may be used for
specifying a variadic function: if the
<tt>:</tt>
(colon keyword)
symbol appears as one of the elements of
<tt><i>argtypes</i></tt>,
then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form specifies a fixed call to a foreign function which is variadic. The
argument types before the colon keyword are the types of the fixed argument=
s.
The types after the colon, if any, are of the variadic arguments. Special
considerations apply to some variadic argument types, described below.
</p><p>
The following syntactic variants are permitted of the
<tt><i>fun-expr</i></tt>
argument:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt><tt><i>name-string</i></tt><tt> </tt></tt></dt><dd>



If
<tt><i>fun-expr</i></tt>
is a literal string, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form must be enclosed in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro, appearing as one of that macro's
<tt><i>body-form</i></tt>-s.
In this situation the literal character string
<tt><i>name-string</i></tt>
specifies a symbol to be found within the library established by the
<tt><i>with-dyn-lib</i></tt>
macro.



</dd><dt><tt>(<tt><i>name-string</i></tt><tt> </tt><tt><i>ver-string</i></t=
t><tt>) </tt></tt></dt><dd>



This manner of specifying the
<tt><i>fun-expr</i></tt>
also requires the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form to be enclosed in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>.
It selects a particular version of a symbol from the library.



</dd><dt><tt><tt><i>form</i></tt><tt> </tt></tt></dt><dd>



If
<tt><i>fun-expr</i></tt>
is any other form, then it must specify an expression which evaluates to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object giving the address of a foreign library symbol. If this form
is used, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form need not be surrounded by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro.
</dd></dl>
</dl>
<p>

When the FFI type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
is used as the type of a variadic parameter,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
replaces it by the FFI type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>.
This treatment is necessary because the C variadic argument mechanism promo=
tes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
values to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>.
Note: due to this substitution, it is possible to pass floating-point value=
s
which are out of range of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
type, without any diagnosis. The behavior of is undefined in the
Lisp-to-C direction, if the C function extracts an out-of-range
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">double</a=
></tt>
argument as if it were of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>.
</p><p>
The FFI types
<tt>be-float</tt>
and
<tt>le-float</tt>
cannot be used for specifying the types of a variadic argument. If any of
these occur in that position,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
throws an error.
Rationale: these types are related to the C type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03237030">float</a>=
</tt>
type, which requires promotion in variadic passing. Promotion cannot
be performed on floating-point values whose byte order has been rearranged,
because promotion is a value-preserving conversion.
</p><p>

The result value of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form is
<tt><i>name</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00C54FC8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.3">10.13.3<=
/a> Macros <tt>deffi-cb</tt> and <tt>deffi-cb-unsafe</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(deffi-cb </tt><tt><i>name</i></tt><tt> </tt><tt><i>rettype=
</i></tt><tt> </tt><tt><i>argtypes</i></tt><tt> [</tt><tt><i>abort-val</i><=
/tt><tt>])=20




<br>&nbsp;&nbsp;(deffi-cb-unsafe </tt><tt><i>name</i></tt><tt> </tt><tt><i>=
rettype</i></tt><tt> </tt><tt><i>argtypes</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
macro defines, using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
a Lisp function called
<tt><i>name</i></tt>.
</p><p>
Thus the
<tt><i>name</i></tt>
argument must be a symbol suitable as a function name in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a>=
</tt>
form.
</p><p>
The
<tt><i>rettype</i></tt>
and
<tt><i>argtypes</i></tt>
arguments are processed exactly as in the corresponding arguments in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
macro.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
macro arranges for
<tt><i>rettype</i></tt>
and
<tt><i>argtypes</i></tt>
to be compiled into a FFI call descriptor.
The generated function called
<tt><i>name</i></tt>
then serves as a combinator which takes a Lisp function as its argument,
and binds it to the FFI call descriptor to produce a FFI closure.
That closure may then be passed to foreign functions as a callback.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
macro generates a callback which uses safe dispatch, which is explained
in the description of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095DF58">ffi-make-=
closure</a></tt>
function. The optional
<tt><i>abort-val</i></tt>
parameter specifies an expression which evaluates to the value
to be returned by the callback in the event that a dynamic control
transfer is intercepted. The purpose of this value is to indicate
to the foreign code that the callback wishes to abort operation;
it is useful in situations when a suitable return value will induce
the foreign code to co-operate and itself return to the Lisp code
which will then continue the dynamic control transfer.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb-=
unsafe</a></tt>
macro is a variant of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb<=
/a></tt>
with the same argument conventions. The difference is that it arranges for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0095DF58">ffi-make-=
closure</a></tt>
to be invoked with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
for the
<tt><i>safe-p</i></tt>
parameter. This macro has no
<tt><i>abort-val</i></tt>
parameter, since unsafe callbacks do not use it.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; create a closure combinator which binds
  ;; Lisp functions to a call descriptor has the C type
  ;; signature void (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
2396F7">*</a>)(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C=
">int</a>).

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C54FC8">deffi-cb</=
a> void-int-closure void (<a href=3D"http://nongnu.org/txr/txr-manpage.html=
#N-018C7C8C">int</a>))

  ;; use the combinator
  ;; some-foreign-function's second arg is
  ;; of type closure, specifying a callback:

  (some-foreign-function
    42
    (void-int-closure (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
004F">lambda</a> (x)
                        (puts `callback! @x`))))

</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03C237C9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.4">10.13.4<=
/a> Macro <tt>deffi-var</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(deffi-var </tt><tt><i>name</i></tt><tt> </tt><tt><i>var-ex=
pr</i></tt><tt> </tt><tt><i>type</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C237C9">deffi-var=
</a></tt>
macro defines a global symbol macro which expands to an expression
accessing a foreign variable, creating the illusion that the
variable is available as a Lisp variable holding a Lisp data type.
</p><p>
The
<tt><i>name</i></tt>
argument gives the name of the symbol macro to be defined.
</p><p>
The
<tt><i>var-expr</i></tt>
argument is one of several permitted syntactic forms
which specify the address of the foreign variable.
They are described below.
</p><p>
The
<tt><i>type</i></tt>
argument expresses the variable type in FFI type syntax.
</p><p>
Once the variable is defined, accessing the macro symbol
<tt><i>name</i></tt>
performs a get operation on the foreign variable, yielding
the conversion of that variable to a Lisp value.
An assignment to the symbol performs a put operation,
converting a Lisp object to a value which overwrites
the object.
</p><p>
Note: FFI memory management is not helpful in the use of
variables. Suppose a string value is
stored in a variable of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6B7C4">str</a></=
tt>.
This means that FFI dynamically allocates a buffer which
stores the UTF-8 encoded version of the string, and this
buffer is placed into the foreign variable.
Then suppose another such assignment takes place.
The previous value is simply overwritten without being
freed.
</p><p>
The following syntactic variants are permitted of the
<tt><i>var-expr</i></tt>
argument:
</p><dl class=3D"indent">




<dl class=3D"items">
<dt><tt><tt><i>name-string</i></tt><tt> </tt></tt></dt><dd>



If
<tt><i>var-expr</i></tt>
is a literal string, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C237C9">deffi-var=
</a></tt>
form must be enclosed in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro, appearing as one of that macro's
<tt><i>body-form</i></tt>-s.
In this situation the literal character string
<tt><i>name-string</i></tt>
specifies a symbol to be found within the library established by the
<tt><i>with-dyn-lib</i></tt>
macro.



</dd><dt><tt>(<tt><i>name-string</i></tt><tt> </tt><tt><i>ver-string</i></t=
t><tt>) </tt></tt></dt><dd>



This manner of specifying the
<tt><i>fun-expr</i></tt>
also requires the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form to be enclosed in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>.
It selects a particular version of a symbol from the library.



</dd><dt><tt><tt><i>form</i></tt><tt> </tt></tt></dt><dd>



If
<tt><i>var-expr</i></tt>
is any other form, then it must specify an expression which evaluates to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object giving the address of a foreign library symbol. If this form
is used, then the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DCE51D">deffi</a>=
</tt>
form need not be surrounded by a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-02B237BB">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.5">10.13.5<=
/a> Macro <tt>deffi-sym</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(deffi-sym </tt><tt><i>name</i></tt><tt> </tt><tt><i>var-ex=
pr</i></tt><tt> [</tt><tt><i>type-sym</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B237BB">deffi-sym=
</a></tt>
macro defines a global lexical variable called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01557906">name</a><=
/tt>
whose value is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object that refers to a symbol in a foreign library.
</p><p>
The
<tt><i>name</i></tt>
argument gives the name for the variable to be defined.
This definition takes place place as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">defparml<=
/a></tt>
macro.
</p><p>
The
<tt><i>var-expr</i></tt>
is syntax which specifies the foreign pointer, using exactly the same
conventions as described for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C237C9">deffi-var=
</a></tt>
macro, allowing for a short-hand notation if this form is
enclosed in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023E0D2C">with-dyn-=
lib</a></tt>
macro invocation.
</p><p>
The optional
<tt><i>type-sym</i></tt>
argument must be a symbol. If it is absent, it defaults to nil.
This argument specifies the type label for the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object which holds the pointer to the foreign symbol.
</p><p>
The result value of
<tt><i>deffi-sym</i></tt>
is the symbol
<tt><i>name</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01BE95E8">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.6">10.13.6<=
/a> Macro <tt>typedef</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(typedef </tt><tt><i>name</i></tt><tt> </tt><tt><i>type-syn=
tax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
macro provides a convenient way to define type aliases.
</p><p>
The
<tt><i>type-syntax</i></tt>
expression is compiled as FFI syntax, and the
<tt><i>name</i></tt>
symbol is installed as an alias denoting that type.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01BE95E8">typedef</=
a></tt>
macro yields the compiled version of
<tt><i>type-syntax</i></tt>
as its value.
</p><p>

</p></dd></dl>
<a name=3D"N-0235DCAE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.7">10.13.7<=
/a> Macro <tt>sizeof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(sizeof </tt><tt><i>type-syntax</i></tt><tt> [</tt><tt><i>o=
bject-expr</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0235DCAE">sizeof</a=
></tt>
calculates the size of the FFI type denoted by
<tt>type-syntax</tt>.
</p><p>
The
<tt><i>type-syntax</i></tt>
expression is compiled to a type using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02940F9A">ffi-type-=
compile</a></tt>.
The
<tt><i>object-expr</i></tt>
expression is evaluated to an object value.
</p><p>
If
<tt>type-syntax</tt>
denotes an incomplete array or structure type, and the
<tt><i>object-expr</i></tt>
argument is present, then a
<i>dynamic size is computed: the actual number of bytes required to store</=
i>

that object value as a foreign representation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0235DCAE">sizeof</a=
></tt>
macro arranges for the size calculation to be carried out at macro-expansio=
n
time, if possible, so that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0235DCAE">sizeof</a=
></tt>
form is replaced by an integer constant. This is possible when the
<tt><i>object-expr</i></tt>
is omitted, or if it is a constant expression according to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0172F00A">constantp=
</a></tt>
function.
</p><p>
For the type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013DE1A3">void</a><=
/tt>,
incomplete array types, and bitfield types, the one-argument form of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0235DCAE">sizeof</a=
></tt>
reports zero.
</p><p>
For incomplete structure types, the one-argument
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0235DCAE">sizeof</a=
></tt>
reports a size which is equivalent to the offset of the last member.
The size of an incomplete structure does not include padding
for the most strictly aligned member.
</p><p>

</p></dd></dl>
<a name=3D"N-000F730E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.8">10.13.8<=
/a> Macro <tt>alignof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(alignof </tt><tt><i>type-syntax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000F730E">alignof</=
a></tt>
calculates the alignment of the FFI type denoted by
<tt>type-syntax</tt>
at macro-expansion time, and produces that
integer value as its expansion, such that there is no
run-time computation. It uses the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00061B61">ffi-align=
of</a></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-013D0A5C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.9">10.13.9<=
/a> Macro <tt>offsetof</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(offsetof </tt><tt><i>type-syntax</i></tt><tt> </tt><tt><i>=
member-name</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0235DCAE">sizeof</a=
></tt>
calculates the offset of the structure member indicated by
<tt><i>member-name</i></tt>,
a symbol, inside the FFI struct type indicated by
<tt><i>type-syntax</i></tt>.
This calculation is performed by a macro-expansion-time call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0318DA0C">ffi-offse=
tof</a></tt>
function, and produces that
integer value as its expansion, such that there is no
run-time computation.
</p><p>

</p></dd></dl>
<a name=3D"N-002129D6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.10">10.13.1=
0</a> Macro <tt>arraysize</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(arraysize </tt><tt><i>type-syntax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002129D6">arraysize=
</a></tt>
calculates the number of elements of the array type indicated by
<tt><i>type-syntax</i></tt>.
This calculation is performed by a macro-expansion-time call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DC1AED">ffi-array=
size</a></tt>
function, and produces that
integer value as its expansion, such that there is no
run-time computation.
</p><p>

</p></dd></dl>
<a name=3D"N-01D55CC4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.11">10.13.1=
1</a> Macro <tt>elemsize</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(elemsize </tt><tt><i>type-syntax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D55CC4">elemsize<=
/a></tt>
calculates the size of the element type of an array type, or
the size of target type of a pointer type indicated by
<tt><i>type-syntax</i></tt>.
This calculation is performed by a macro-expansion-time call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DF8E15">ffi-elems=
ize</a></tt>
function, and produces that
integer value as its expansion, such that there is no
run-time computation.
</p><p>

</p></dd></dl>
<a name=3D"N-03D55EC5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.12">10.13.1=
2</a> Macro <tt>elemtype</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(elemtype </tt><tt><i>type-syntax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000D">elemtype</a><=
/tt>
produce the element type of an array type, or
the target type of a pointer type indicated by
<tt><i>type-syntax</i></tt>.
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000D">elemtype</a><=
/tt>
macro may be understood in terms of several possible implementations.
The form
<tt>(elemtype X)</tt>
is equivalent to
<tt>(ffi-elemtype (ffi-type-compile X))</tt>.
Since there exists an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-000D">elemtype</a><=
/tt>
type operator, the expression is also equivalent to
<tt>(ffi-type-compile '(elemtype X))</tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-020F3A1C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.13.13">10.13.1=
3</a> Macro <tt>ffi</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi </tt><tt><i>type-syntax</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020F3A1C">ffi</a></=
tt>
macro provides a shorthand notation for compiling a literal
FFI type expression to the corresponding type object. The
following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
0F3A1C">ffi</a> expr)  &lt;--&gt;  (<a href=3D"http://nongnu.org/txr/txr-ma=
npage.html#N-02940F9A">ffi-type-compile</a> 'expr)
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-00AE2961">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.14">10.14</a> =
Zero-filled Object Support</h3>



<p>


</p><p>
Communicating with foreign interfaces sometimes requires representations
to be initialized consisting of all zero bits, or mostly zero bits.
</p><p>
<b>TXR</b> provides convenient ways to prepare Lisp objects such that when =
those
objects are converted to a foreign representation, they generate zero-fille=
d
representations.
</p><p>

<a name=3D"N-03855D2D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.14.1">10.1=
4.1</a> Function <tt>make-zstruct</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-zstruct </tt><tt><i>type</i></tt><tt> {</tt><tt><i>sl=
ot-sym</i></tt><tt> </tt><tt><i>init-value</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>
function provides a convenient means of instantiating a structure
for use in foreign function calls, imitating a pattern of initialization
often seen in the C language. It instantiates a Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
by conversion of zero-filled memory through FFI, thus creating a Lisp
structure which appears zero-filled when converted to the foreign represent=
ation.
</p><p>
This simplifies application code, which is spared from providing individual
slot initializations which have this effect.
</p><p>
The
<tt><i>type</i></tt>
argument must be a compiled FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type. The remaining arguments must occur pairwise. Each
<tt><i>slot-sym</i></tt>
argument must be a symbol naming a slot in the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type. The
<tt><i>init-value</i></tt>
argument which follows it specifies the value for that
slot.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>
function operates as follows. Firstly, the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type is retrieved which corresponds to the FFI type given by
<tt><i>type</i></tt>.
A new instance of the Lisp type is instantiated, as if by
a one-argument call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B3F64">make-stru=
ct</a></tt>.
Next, each slot indicated by a
<tt><i>slot-sym</i></tt>
argument is set to the corresponding
<tt><i>init-value</i></tt>.
Finally, each slot of the struct which is not initialized via
<tt><i>slot-sym</i></tt>
and
<tt><i>init-value</i></tt>
pair, and which is known to the FFI type, is re-initialized by a conversion
from a foreign object of all-zero bits to a Lisp value.
argument. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
object is then returned.
</p><p>
Note: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1FC38">znew</a><=
/tt>
macro provides a less verbose notation based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>.
</p><p>
Note: slots which are not known to the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type may be initialized by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>.
Each
<tt><i>slot-sym</i></tt>
must be a slot of the Lisp
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type; but need not be declared as a member in the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0035">struct</a></t=
t>
type.
</p><p>

</p></dd></dl>
<a name=3D"N-00B1FC38">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.14.2">10.14.2<=
/a> Macro <tt>znew</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(znew </tt><tt><i>type-syntax</i></tt><tt> {</tt><tt><i>slo=
t-sym</i></tt><tt> </tt><tt><i>init-value</i></tt><tt>}*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1FC38">znew</a><=
/tt>
macro provides a convenient way of using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>,
using syntax which resembles that of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a></=
tt>
macro.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1FC38">znew</a><=
/tt>
macro generates a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03855D2D">make-zstr=
uct</a></tt>
call, arranging for the
<tt><i>type-syntax</i></tt>
argument to be compiled to a FFI type object, and
applies quoting to every
<tt><i>slot-sym</i></tt>
argument.
</p><p>
</p><p>
The following equivalence holds:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B1FC38">znew</a> s a i b j ...)  &lt;--&gt;  (<a href=3D"http://nongnu.org/=
txr/txr-manpage.html#N-03855D2D">make-zstruct</a> (<a href=3D"http://nongnu=
.org/txr/txr-manpage.html#N-020F3A1C">ffi</a> s)
                                            'a i 'b j ...)
</tt></pre><tt>

</tt>

<p>
</p></dd><dt>Example</dt><dd>
<p>


</p><p>
Given the following FFI type definition
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
BE95E8">typedef</a> foo (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
D-0035">struct</a> foo (a (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-0027">cptr</a> bar)) (b uint) (c bool)))
</tt></pre><tt>

</tt>

<p>
the following results are observed:
</p><p>
<tt>
</tt></p><pre><tt>  ;; ordinary instantiation
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0230059D">new</a> fo=
o) -&gt; #S(foo a nil b nil c nil)

  ;; Under znew, a is null cptr of correct type:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1FC38">znew</a> f=
oo) -&gt; #S(foo a #&lt;cptr bar: 0&gt; b 0 c nil)

  ;; value of b is specified; others come from zeros:
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B1FC38">znew</a> f=
oo b 42) -&gt; #S(foo a #&lt;cptr bar: 0&gt; b 42 c nil)
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-016D3BB5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.14.3">10.14.3<=
/a> Function <tt>zero-fill</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(zero-fill </tt><tt><i>type</i></tt><tt> </tt><tt><i>obj</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016D3BB5">zero-fill=
</a></tt>
function invokes the by-reference in semantics of FFI type
<tt><i>type</i></tt>
against a zero-filled buffer, and a Lisp object
<tt><i>obj</i></tt>.
</p><p>
This means that if
<tt><i>obj</i></tt>
is an aggregate such as a vector, list or structure,
it is updated as if from an all-zero-bit foreign representation.
In that situation,
<tt><i>obj</i></tt>
is also returned.
</p><p>
An object which has by-value semantics, such as an integer,
is not updated. In this case, nevertheless, the return value
is a Lisp object produced by converting an all-zero-bit buffer to
<tt><i>type</i></tt>.
</p><p>
</p></dd></dl>
<a name=3D"N-0362C74D">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.15">10.15</a> =
Foreign Unions</h3>



<p>


</p><p>
The following group of functions provides the means for working
with foreign unions, in conjunction with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
FFI type.
</p><p>

<a name=3D"N-010A23C0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.15.1">10.1=
5.1</a> Function <tt>make-union</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(make-union </tt><tt><i>type</i></tt><tt> [</tt><tt><i>init=
val</i></tt><tt> [</tt><tt><i>member</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-010A23C0">make-unio=
n</a></tt>
function instantiates a new object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>,
based on the FFI type specified by the
<tt><i>type</i></tt>
parameter, which must be compiled FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
type.
</p><p>
The object provides storage for the foreign representation of
<tt>type</tt>,
and that storage is initialized to all zero bytes.
</p><p>
Additionally, if
<tt><i>initval</i></tt>
is specified, but
<tt><i>member</i></tt>
is not, then
<tt><i>initval</i></tt>
is stored into the union's via the first member, as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4EBC">union-put=
</a></tt>.
If the union type has no members, an error exception is thrown.
</p><p>
If both
<tt><i>initval</i></tt>
and
<tt><i>member</i></tt>
are specified, then
<tt><i>initval</i></tt>
is stored into the union using the specified member, as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4EBC">union-put=
</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-008912E4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.15.2">10.15.2<=
/a> Function <tt>union-members</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(union-members </tt><tt><i>union</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008912E4">union-mem=
bers</a></tt>
function retrieves the list of symbols which name the members of
<tt><i>union</i></tt>.
These are derived from the object's FFI type.
It is unspecified whether the list is freshly allocated on each call,
or whether the same list is returned; applications shouldn't
destructively manipulate this list.
</p><p>

</p></dd></dl>
<a name=3D"N-02FA4F0C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.15.3">10.15.3<=
/a> Function <tt>union-get</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(union-get </tt><tt><i>union</i></tt><tt> </tt><tt><i>membe=
r</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4F0C">union-get=
</a></tt>
function performs the get semantics (conversion from a foreign
representation to Lisp) on the member of
<tt><i>union</i></tt>
which is specified by the
<tt><i>member</i></tt>
argument. That argument must be a symbol corresponding to one of the member
names.
</p><p>
The
<tt><i>union</i></tt>
object's storage buffer is treated as an object of the foreign
type indicated by that member's type information, and converted
accordingly to a Lisp object that is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-02FA4EBC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.15.4">10.15.4<=
/a> Function <tt>union-put</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(union-put </tt><tt><i>union</i></tt><tt> </tt><tt><i>membe=
r</i></tt><tt> </tt><tt><i>new-value</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4EBC">union-put=
</a></tt>
function performs the put semantics (conversion from a Lisp object
to foreign representation) on the member of
<tt><i>union</i></tt>
which is specified by the
<tt><i>member</i></tt>
argument. That argument must be a symbol corresponding to one of the member
names.
</p><p>
The object given as
<tt><i>new-value</i></tt>
is converted to the foreign representation according to the type
information of the indicated member, and that representation is
placed into the
<tt><i>union</i></tt>
object's storage buffer.
</p><p>
The return value is
<tt><i>new-value</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-02258991">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.15.5">10.15.5<=
/a> Functions <tt>union-in</tt> and <tt>union-out</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(union-in </tt><tt><i>union</i></tt><tt> </tt><tt><i>memb</=
i></tt><tt> </tt><tt><i>memb-obj</i></tt><tt>)=20




<br>&nbsp;&nbsp;(union-out </tt><tt><i>union</i></tt><tt> </tt><tt><i>memb<=
/i></tt><tt> </tt><tt><i>memb-obj</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-in<=
/a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-out=
</a></tt>
functions perform the FFI in semantics and out semantics, respectively.
These semantics are involved in two-way data transfers between foreign
representations and Lisp objects.
</p><p>
The
<tt><i>union</i></tt>
argument must be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C78B86">union</a>=
</tt>
object and the
<tt><i>memb</i></tt>
argument a symbol which matches one of that object's member names.
</p><p>
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-in<=
/a></tt>,
<tt><i>memb-obj</i></tt>
is a Lisp object that was previously stored into
<tt><i>union</i></tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4EBC">union-put=
</a></tt>
operation, into the same member that is currently indicated by
<tt><i>member</i></tt>.
</p><p>
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-out=
</a></tt>,
<tt><i>memb-obj</i></tt>
is a Lisp object that was previously retrieved from
<tt><i>union</i></tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FA4F0C">union-get=
</a></tt>
operation, from the same member that is currently indicated by
<tt><i>member</i></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-in<=
/a></tt>
performs the by-value nuance of the in semantics on the indicated
member: if the member contains pointers to any objects, those
objects are updated from their counterparts in
<tt><i>memb-obj</i></tt>
using their respective by-reference in semantics, recursively.
</p><p>
Similarly
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-out=
</a></tt>
performs the by-value nuance of the out semantics on the indicated
member: if the member contains pointers to any objects, those
objects are updated with their Lisp counterparts in
<tt><i>memb-obj</i></tt>
using their respective by-reference out semantics, recursively.
</p><p>
Note:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-in<=
/a></tt>
is intended to be used after a FFI call, on a union-typed by-value
argument, or a union-typed object contained in an argument,
in situations when the function is expected to have updated
the contents of the union. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02258991">union-out=
</a></tt>
function is intended to be used in a FFI callback, on a union-typed
callback argument or union-typed object contained in such
an argument, in cases when the callback has updated the Lisp
object corresponding to a union member, and that change needs
to be propagated to the foreign caller.
</p><p>
</p></dd></dl>
<a name=3D"N-030C8E8A">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.16">10.16</a> =
FFI-type-driven I/O Functions</h3>



<p>


</p><p>
These functions provide a way to perform I/O on stream using the foreign
representation of Lisp objects, performing conversion between the Lisp
representations in memory and the foreign representations in a stream.
</p><p>
The
<tt><i>stream</i></tt>
argument used with these functions must be a stream object which,
in the case of input functions, supports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003B">get-byte</a><=
/tt>
and, in the case of output, supports
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0053">put-byte</a><=
/tt>.
</p><p>

<a name=3D"N-025DB229">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.16.1">10.1=
6.1</a> Function <tt>put-obj</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(put-obj </tt><tt><i>object</i></tt><tt> </tt><tt><i>type</=
i></tt><tt> [</tt><tt><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025DB229">put-obj</=
a></tt>
function encodes
<tt><i>object</i></tt>
into a foreign representation, according to the FFI type
<tt><i>type</i></tt>.
The bytes of the foreign representation are then written to
<tt><i>stream</i></tt>.
</p><p>
If
<tt><i>stream</i></tt>
is omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdout*<=
/a></tt>.
</p><p>
If the operation successfully writes all bytes of the representation to
<tt><i>stream</i></tt>,
the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
is returned. A partial write causes the return value to be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
All other stream error situations throw exceptions.
</p><p>

</p></dd></dl>
<a name=3D"N-0315B229">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.16.2">10.16.2<=
/a> Function <tt>get-obj</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(get-obj </tt><tt><i>type</i></tt><tt> [</tt><tt><i>stream<=
/i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315B229">get-obj</=
a></tt>
function reads from
<tt><i>stream</i></tt>
the bytes corresponding to a foreign representation according to the FFI ty=
pe
<tt><i>type</i></tt>.
</p><p>
If
<tt><i>stream</i></tt>
is omitted, it defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006566FB">*stdin*</=
a></tt>.
</p><p>
If the read is successful, these bytes are decoded, producing a Lisp
object, which is returned.
</p><p>
If the read is incomplete, the value returned is
<tt><i>nil</i></tt>.
</p><p>
All other stream error situations throw exceptions.
</p><p>

</p></dd></dl>
<a name=3D"N-0039A1D1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.16.3">10.16.3<=
/a> Function <tt>fill-obj</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fill-obj </tt><tt><i>object</i></tt><tt> </tt><tt><i>type<=
/i></tt><tt> [</tt><tt><i>stream</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0315B229">get-obj</=
a></tt>
function reads from
<tt><i>stream</i></tt>
the bytes corresponding to a foreign representation according to the FFI ty=
pe
<tt><i>type</i></tt>.
</p><p>
If the read is successful, then
<tt><i>object</i></tt>
is updated, if possible, from that representation, using the by-value in
semantics of the FFI type and returned. If a by-value update of
<tt><i>object</i></tt>
isn't possible, then a new object is decoded from the data and returned.
</p><p>
If the read is incomplete, the value returned is
<tt><i>nil</i></tt>.
</p><p>
All other stream error situations throw exceptions.
</p><p>
</p></dd></dl>
<a name=3D"N-037C2C57">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.17">10.17</a> =
Buffer Functions</h3>



<p>


</p><p>
Functions in this area provide a way to perform conversion between
Lisp objects and foreign representation to and from objects of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
type.
</p><p>

<a name=3D"N-0000F6A9">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.17.1">10.1=
7.1</a> Functions <tt>ffi-put</tt> and <tt>ffi-put-into</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-put </tt><tt><i>obj</i></tt><tt> </tt><tt><i>type</i><=
/tt><tt>)=20




<br>&nbsp;&nbsp;(ffi-put-into </tt><tt><i>dst-buf</i></tt><tt> </tt><tt><i>=
obj</i></tt><tt> </tt><tt><i>type</i></tt><tt> [</tt><tt><i>offset</i></tt>=
<tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000F6A9">ffi-put</=
a></tt>
function encodes the Lisp object
<tt><i>obj</i></tt>
according to the FFI type
<tt><i>type</i></tt>
and returns a new buffer object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
which holds the foreign representation.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000F6A9">ffi-put-i=
nto</a></tt>
function is similar, except that it uses an existing buffer
<tt><i>dst-buf</i></tt>
which must be large enough to hold the foreign representation.
</p><p>
The
<tt><i>type</i></tt>
argument must be a compiled FFI type.
</p><p>
If
<tt><i>type</i></tt>
is has a variable length, then the actual size of the foreign representatio=
n is
calculated from
<tt><i>obj</i></tt>.
</p><p>
The
<tt><i>obj</i></tt>
argument must be an object compatible with the conversions
implied by
<tt><i>type</i></tt>.
</p><p>
The optional
<tt><i>offset</i></tt>
argument specifies a byte offset from the beginning of the data area of
<tt><i>dst-buf</i></tt>
where the foreign-representation of
<tt><i>obj</i></tt>
is stored. The default value is zero.
</p><p>
These functions perform the "put semantics" encoding action similar to
what happens to the arguments of an outgoing foreign function call.
</p><p>
Caution: incorrect use of this function, or its use in isolation
without a matching
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AAB17">ffi-in</a=
></tt>
call, can cause memory leaks, because, depending on
<tt><i>type</i></tt>,
temporary resources may be allocated, and pointers to those resources
will be stored in the buffer.
</p><p>

</p></dd></dl>
<a name=3D"N-02330623">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.17.2">10.17.2<=
/a> Function <tt>ffi-out</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-out </tt><tt><i>dst-buf</i></tt><tt> </tt><tt><i>obj</=
i></tt><tt> </tt><tt><i>type</i></tt><tt> </tt><tt><i>copy-p</i></tt><tt> [=
</tt><tt><i>offset</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02330623">ffi-out</=
a></tt>
function performs the "out semantics" encoding action, similar
to the treatment applied to the arguments of a callback prior to
returning to foreign code.
</p><p>
It is assumed that
<tt>obj</tt>
is an object that was returned by an earlier call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023305C7">ffi-get</=
a></tt>,
and that the
<tt><i>dst-buf</i></tt>
and
<tt><i>type</i></tt>
arguments are the same objects that were used in that call.
</p><p>
The
<tt><i>copy-p</i></tt>
argument is a Boolean flag which is true if the buffer represents a datum
that is being passed by pointer. If
<tt><i>copy-p</i></tt>
is true, then
<tt><i>obj</i></tt>
is converted to a foreign representation which is stored into
<tt><i>dst-buf</i></tt>.
If it is false, it indicates that the buffer itself is a pass-by-value obje=
ct.
This means that the object itself will not be copied, but if it is an aggre=
gate
which contains pointers, the operation will recurse on those objects, invok=
ing
their "out semantics" action with pass-by-pointer semantics. The required
pointers to these indirect objects are obtained from
<tt><i>dst-buf</i></tt>.
</p><p>
The optional
<tt><i>offset</i></tt>
argument specifies a byte offset from the beginning of the data area of
<tt><i>dst-buf</i></tt>
where the foreign-representation of
<tt><i>obj</i></tt>
is understood to be stored, and where it is updated if requested by
<tt><i>copy-p</i></tt>.
The default value is zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02330623">ffi-out</=
a></tt>
function returns
<tt><i>dst-buf</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-037AAB17">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.17.3">10.17.3<=
/a> Function <tt>ffi-in</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-in </tt><tt><i>src-buf</i></tt><tt> </tt><tt><i>obj</i=
></tt><tt> </tt><tt><i>type</i></tt><tt> </tt><tt><i>copy-p</i></tt><tt> [<=
/tt><tt><i>offset</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AAB17">ffi-in</a=
></tt>
function performs the "in semantics" decoding action, similar to the
treatment applied to the arguments of a foreign function call after
it returns, in order to free temporary resources and recover the new
values of objects that have been modified by the foreign function.
</p><p>
It is assumed that
<tt><i>src-buf</i></tt>
is a buffer that was prepared by a call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000F6A9">ffi-put</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000F6A9">ffi-put-i=
nto</a></tt>,
and that
<tt><i>type</i></tt>
and
<tt><i>obj</i></tt>
are the same values that were passed as the
corresponding arguments of those functions.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AAB17">ffi-in</a=
></tt>
function releases the temporary memory resources that were allocated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000F6A9">ffi-put</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0000F6A9">ffi-put-i=
nto</a></tt>,
which are obtained from the buffer itself, where they appear as pointers.
The function recursively performs the in semantics across the entire type,
and the entire object graph rooted at the buffer.
</p><p>
The
<tt><i>copy-p</i></tt>
argument is a Boolean flag which is true if the buffer represents a datum
that is being passed by pointer. If it is false, it indicates that the
buffer itself is a pass-by-value object. Under pass-by-pointer semantics,
either a whole new object is extracted from the buffer and returned,
or else the slots of
<tt><i>obj</i></tt>
are updated with new values from the buffer.
Under pass-by-value semantics, no such extraction takes place, and
<tt><i>obj</i></tt>
is returned.
However, regardless of the value of
<tt>copy-p</tt>,
if the object is an aggregate which contains pointers, the recursive
treatment through those pointers involves pass-by-pointer semantics.
</p><p>
This is consistent with the idea that we can pass a structure by value,
but that structure can have pointers to objects which are updated by
the called function. Those indirect objects are passed by pointer.
They get updated, but the parent structure cannot.
</p><p>
If
<tt><i>type</i></tt>
is has a variable length, then the actual size of the foreign representatio=
n is
calculated from
<tt><i>obj</i></tt>.
</p><p>
The optional
<tt><i>offset</i></tt>
argument specifies a byte offset from the beginning of the data area of
<tt><i>src-buf</i></tt>
from which the foreign-representation of
<tt><i>obj</i></tt>
is taken.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037AAB17">ffi-in</a=
></tt>
function returns either
<tt><i>obj</i></tt>
or a new object which is understood to have been produced as its
replacement.
</p><p>

</p></dd></dl>
<a name=3D"N-023305C7">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.17.4">10.17.4<=
/a> Function <tt>ffi-get</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(ffi-get </tt><tt><i>src-buf</i></tt><tt> </tt><tt><i>type<=
/i></tt><tt> [</tt><tt><i>offset</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023305C7">ffi-get</=
a></tt>
function extracts a Lisp value from buffer
<tt><i>src-buf</i></tt>
according to the FFI type
<tt><i>type</i></tt>.
The
<tt><i>src-buf</i></tt>
argument is an object of type
<tt><i>buf</i></tt>
large enough to hold a foreign representation of
<tt><i>type</i></tt>,
at the byte offset indicated by the
<tt><i>offset</i></tt>
argument.
The
<tt><i>type</i></tt>
argument is compiled FFI type.
The optional
<tt><i>offset</i></tt>
argument defaults to zero.
</p><p>
The external representation in
<tt><i>src-buf</i></tt>
at the specified offset is scanned according to
<tt><i>type</i></tt>
and converted to a Lisp value which is returned.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-023305C7">ffi-get</=
a></tt>
operation is similar to the "get semantics" performed by FFI
in order to extract the return value of foreign function
calls, and by the FFI callback mechanism to extract the
arguments coming into a callback.
</p><p>
The
<tt><i>type</i></tt>
argument may not be a variable length type, such as an array of
unspecified size.
</p><p>
</p></dd></dl>
<a name=3D"N-0228461D">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18">10.18</a> =
Foreign Arrays</h3>



<p>


</p><p>
Functions in this area provide a means for working with
foreign arrays, in connection with the FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type.
</p><p>

<a name=3D"N-00E825E0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.1">10.1=
8.1</a> Functions <tt>carray-vec</tt> and <tt>carray-list</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-vec </tt><tt><i>vec</i></tt><tt> </tt><tt><i>type</=
i></tt><tt> [</tt><tt><i>null-term-p</i></tt><tt>])=20




<br>&nbsp;&nbsp;(carray-list </tt><tt><i>list</i></tt><tt> </tt><tt><i>type=
</i></tt><tt> [</tt><tt><i>null-term-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E825E0">carray-ve=
c</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E825E0">carray-li=
st</a></tt>
functions allocate storage for the representation of a foreign array, and
return a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which holds a pointer to that storage.
</p><p>
The argument
<tt><i>type</i></tt>,
which must be a compiled FFI type,
is retained as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object's element type.
</p><p>
Prior to returning, the functions
initializes the foreign array by converting the elements of
<tt><i>vec</i></tt>
or, respectively,
<tt><i>list</i></tt>
into elements of the foreign array.
The conversion is performed using the put semantics of
<tt><i>type</i></tt>,
which is a compiled FFI type.
</p><p>
The length of the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is determined from the length of
<tt><i>vec</i></tt>
or
<tt><i>list</i></tt>
and from the value of the Boolean argument
<tt><i>null-term-p</i></tt>.
</p><p>
If
<tt><i>null-term-p</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then the length of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is the same as that of the input
<tt><i>vec</i></tt>
or
<tt><i>list</i></tt>.
</p><p>
A true value of
<tt><i>null-term-p</i></tt>
indicates null termination.
This causes the length of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
to be one greater than that of
<tt><i>vec</i></tt>
or
<tt><i>list</i></tt>,
and the extra element allocated to the foreign array is filled with zero by=
tes.
</p><p>

</p></dd></dl>
<a name=3D"N-027E7FFC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.2">10.18.2<=
/a> Function <tt>carrayp</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carrayp </tt><tt><i>object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027E7FFC">carrayp</=
a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if
<tt><i>object</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>,
otherwise it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00DD8DF1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.3">10.18.3<=
/a> Function <tt>carray-blank</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-blank </tt><tt><i>length</i></tt><tt> </tt><tt><i>t=
ype</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DD8DF1">carray-bl=
ank</a></tt>
function allocates storage for the representation of a foreign array,
filling that storage with zero bytes, and returns a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which holds a pointer to that storage.
</p><p>
The argument
<tt><i>type</i></tt>,
which must be a compiled FFI type,
is retained as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object's element type.
</p><p>
The
<tt><i>length</i></tt>
argument must be a nonnegative integer; it specifies the number
of elements in the foreign array and is retained as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object's length.
</p><p>
The size of the foreign array is the product of the size of
<tt><i>type</i></tt>
as reported by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CDBB53">ffi-size<=
/a></tt>
function, and of
<tt><i>length</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-00D75AD6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.4">10.18.4<=
/a> Function <tt>carray-buf</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-buf </tt><tt><i>buf</i></tt><tt> </tt><tt><i>type</=
i></tt><tt> [</tt><tt><i>offset</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D75AD6">carray-bu=
f</a></tt>
function creates a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which refers to the storage provided and managed by the buffer objec=
t
<tt><i>buf</i></tt>,
providing a view of that storage, and manipulation thereof, as an array.
</p><p>
The optional
<tt><i>offset</i></tt>
parameter specifies an offset from the start of the buffer to the
location which is interpreted as the start of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>,
which extends from that offset to the end of the buffer.
</p><p>
The default value is zero: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
covers the entire buffer.
</p><p>
If a value is specified, it must be in the range zero to the length of
<tt><i>buf</i></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument must be a compiled FFI type whose size is nonzero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
is overlaid onto the storage of
<tt><i>buf</i></tt>
as follows:
</p><p>
First,
<tt><i>offs</i></tt>
is subtracted from the bytewise length of
<tt><i>buf</i></tt>,
as reported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026D89A">length-bu=
f</a></tt>
function to produce the effective length of the storage to be used for the =
array.
</p><p>
The effective length is divided by the size of
<tt><i>type</i></tt>,
as reported by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00CDBB53">ffi-size<=
/a></tt>.
The resulting quotient represents the length (number of elements) of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object.
</p><p>
Note: the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object holds a reference to
<tt><i>buf</i></tt>,
preventing
<tt><i>buf</i></tt>
from being reclaimed by garbage collection, thereby protecting the
underlying storage from becoming invalid. A subsequent invocation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-ow=
n</a></tt>
operation releases this reference.
</p><p>
Note: the relationship between the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object and
<tt><i>buf</i></tt>
is inherently unsafe: if
<tt><i>buf</i></tt>
is subsequently subject to operations which reallocate the storage,
such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01208847">buf-set-l=
ength</a></tt>
the pointer stored inside the referencing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object becomes invalid, and operations involving that pointer
have undefined behavior.
</p><p>
Note: if the length of the buffer is not evenly divisible by the size of th=
e
type, the calculated number of elements is rounded down. The trailing porti=
on
of the buffer corresponding to the division remainder, being insufficient
to constitute a whole array element, is excluded from the array view.
</p><p>

</p></dd></dl>
<a name=3D"N-02F23E0F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.5">10.18.5<=
/a> Function <tt>carray-buf-sync</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-buf-sync </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F23E0F">carray-bu=
f-sync</a></tt>
function requires
<tt><i>carray</i></tt>
to be a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which refers to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
object for its storage. Such objects are created by the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D75AD6">carray-bu=
f</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F23E0F">carray-bu=
f-sync</a></tt>
function retrieves and returns the buffer object associated with
<tt><i>carray</i></tt>
and at the same time also updates the internal properties of
<tt><i>carray</i></tt>
using the current information: the pointer to the data, and the
length of
<tt><i>carray</i></tt>
are altered to reflect the current state of the buffer.
</p><p>

</p></dd></dl>
<a name=3D"N-0022F54E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.6">10.18.6<=
/a> Function <tt>buf-carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(buf-carray </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0022F54E">buf-carra=
y</a></tt>
function duplicates the underlying storage of
<tt><i>carray</i></tt>
and returns that storage represented as an object of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002C">buf</a></tt>
type.
</p><p>
The storage size is calculated by multiplying the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object's element size by the number of elements.
Only that extent of the storage is duplicated.
</p><p>

</p></dd></dl>
<a name=3D"N-03E001C5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.7">10.18.7<=
/a> Function <tt>carray-cptr</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-cptr </tt><tt><i>cptr</i></tt><tt> </tt><tt><i>type=
</i></tt><tt> [</tt><tt><i>length</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E001C5">carray-cp=
tr</a></tt>
function creates a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object based on a pointer derived from a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
object.
</p><p>
The
<tt><i>cptr</i></tt>
argument must be of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>=
.
The object's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0027">cptr</a></tt>
type tag is ignored.
</p><p>
The
<tt><i>type</i></tt>
argument must specify a compiled FFI type, which will become
the element type of the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
</p><p>
If
<tt><i>length</i></tt>
is specified as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
or not specified,
then the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object will be of unknown length. Otherwise,
<tt><i>length</i></tt>
must be a non-negative integer which will be taken as the
length of the array.
</p><p>
Note: this conversion is inherently unsafe.
</p><p>

</p></dd></dl>
<a name=3D"N-03FF97BD">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.8">10.18.8<=
/a> Function <tt>length-carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(length-carray </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>length-carry</tt>
function returns the length of the
<tt><i>carray</i></tt>
argument, which must be an object of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
</p><p>
If
<tt><i>carray</i></tt>
has an unknown length, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-006593D0">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.9">10.18.9<=
/a> Function <tt>copy-carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(copy-carray </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006593D0">copy-carr=
ay</a></tt>
function returns a duplicate of
<tt><i>carray</i></tt>.
</p><p>
The duplicate has the same element type and length, but has its own
copy of the underlying storage. This is true whether or not
<tt><i>carray</i></tt>
owns its storage or not. In either case, the duplicate owns
<i>its</i>

copy of the storage.
</p><p>

</p></dd></dl>
<a name=3D"N-00705BC4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.10">10.18.1=
0</a> Function <tt>carray-set-length</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-set-length </tt><tt><i>carray</i></tt><tt> </tt><tt=
><i>length</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>carry-set-length</tt>
attempts to change the length of
<tt><i>carray</i></tt>,
which must be an object of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type.
</p><p>
The
<tt><i>length</i></tt>
argument indicates the new length, which must be
a non-negative integer.
</p><p>
The operation throws an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
exception if
<tt><i>length</i></tt>
is negative.
</p><p>
An
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
exception is also thrown if
<tt><i>carray</i></tt>
is an object which owns the underlying storage. There is no provision in th=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
type to change the storage size.
</p><p>
It is permissible to change the length of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which acts as a view into a buffer (as constructed via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D75AD6">carray-bu=
f</a></tt>
operation).
</p><p>
This creates a potentially unsafe situation in which the length requires
a larger amount of backing storage than is provided by the buffer.
</p><p>

</p></dd></dl>
<a name=3D"N-001F5BCA">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.11">10.18.1=
1</a> Accessor <tt>carray-ref</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-ref </tt><tt><i>carray</i></tt><tt> </tt><tt><i>idx=
</i></tt><tt>)=20




<br>&nbsp;&nbsp;(set (carray-ref </tt><tt><i>carray</i></tt><tt> </tt><tt><=
i>idx</i></tt><tt>) </tt><tt><i>new-val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-001F5BCA">carray-re=
f</a></tt>
function accesses an element of the foreign array
<tt><i>carray</i></tt>,
converting that element to a Lisp value, which is returned.
</p><p>
The
<tt><i>idx</i></tt>
argument must be a non-negative integer. If
<tt><i>carray</i></tt>
has a known length,
<tt><i>idx</i></tt>
must be less than the length.
</p><p>
If
<tt><i>carray</i></tt>
has an unknown length, then the the access is permitted regardless of how
positive is the value of
<tt><i>idx</i></tt>.
Whether the access has well-defined behavior depends on the actual extent o=
f
the underlying array storage.
</p><p>
The validity of any access to the underlying storage depends on the
validity of the pointer to that storage.
</p><p>
The access to the array storage proceeds as follows. Every
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object has an element type, which is a compiled FFI type.
A byte offset
address is calculated by multiplying the size of the element type of
<tt><i>carray</i></tt>
by
<tt><i>idx</i></tt>.
Then, the get semantics of the element type is invoked to convert, to
a Lisp object, a region of data starting at calculated byte offset in the a=
rray
storage. The resulting object is returned.
</p><p>
Assigning an a value to a
<tt>caddr-ref</tt>
form is equivalent to using
<tt>caddr-refset</tt>
to store the value.
</p><p>

</p></dd></dl>
<a name=3D"N-000127F9">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.12">10.18.1=
2</a> Function <tt>carray-refset</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-refset </tt><tt><i>carray</i></tt><tt> </tt><tt><i>=
idx</i></tt><tt> </tt><tt><i>new-val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000127F9">carray-re=
fset</a></tt>
function accesses an element of the foreign array
<tt><i>carray</i></tt>,
overwriting that element with a new value obtained
from a conversion of the Lisp value
<tt><i>new-val</i></tt>.
</p><p>
The return value is
<tt><i>new-val</i></tt>.
</p><p>
The
<tt><i>idx</i></tt>
argument must be a non-negative integer. If
<tt><i>carray</i></tt>
has a known length,
<tt><i>idx</i></tt>
must be less than the length.
</p><p>
If
<tt><i>carray</i></tt>
has an unknown length, then the the access is permitted regardless of how
positive is the value of
<tt><i>idx</i></tt>.
Whether the access has well-defined behavior depends on the actual extent o=
f
the underlying array storage.
</p><p>
The validity of any access to the underlying storage depends on the
validity of the pointer to that storage.
</p><p>
The access to the array storage proceeds as follows. Every
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object has an element type, which is a compiled FFI type.
A byte offset
address is calculated by multiplying the size of the element type of
<tt><i>carray</i></tt>
by
<tt><i>idx</i></tt>.
Then, the put semantics of the element type is invoked to convert
<tt><i>new-val</i></tt>
to a foreign representation, which is written into the array storage
started at the calculated byte offset.
</p><p>
If
<tt><i>new-val</i></tt>
has a type which is not compatible with the element type, or a value which
is out of range or otherwise unsuitable, an exception is thrown.
</p><p>

</p></dd></dl>
<a name=3D"N-00058922">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.13">10.18.1=
3</a> Functions <tt>carray-dup</tt> and <tt>carray-own</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-dup </tt><tt><i>carray</i></tt><tt>)=20




<br>&nbsp;&nbsp;(carray-own </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>
function acts upon a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which doesn't own its underlying array storage.
It allocates a duplicate copy of the array storage referenced by
<tt><i>carray</i></tt>,
and assigns to
<tt><i>carray</i></tt>
the new copy. Then it marks
<tt><i>carray</i></tt>
as owning that storage. Lastly, if
<tt><i>carray</i></tt>
references another object, that reference is removed;
<tt><i>carray</i></tt>
no longer prevents the other object from being reclaimed by
the garbage collector.
</p><p>
If
<tt><i>carray</i></tt>
already owns its storage, then this function has no effect.
</p><p>
If
<tt><i>carray</i></tt>
has an unknown size, then an error exception is thrown.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
produced by the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E825E0">carray-ve=
c</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DD8DF1">carray-bl=
ank</a></tt>
already owns its storage.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object does not own its storage if it is produced by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D75AD6">carray-bu=
f</a></tt>
or by the conversion of a foreign pointer under the control of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
FFI type.
</p><p>
Because
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
objects derived from foreign pointers via FFI have an unknown size,
before using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>,
the application must determine the length of the array, and call
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00705BC4">carray-se=
t-length</a></tt>
to establish that length.
</p><p>
After
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>,
the length may not be altered.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it has performed the duplication operation. If it has done
nothing, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-ow=
n</a></tt>
function resembles
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>,
differing from that function only in in two ways.
Instead of allocating a duplicate copy of the underlying array storage,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-ow=
n</a></tt>
causes
<tt><i>carray</i></tt>
to
<b>assume</b>

ownership of the existing storage. Secondly, it is an error to use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-ow=
n</a></tt>
on a
<tt><i>carray</i></tt>
which references a buffer object.
</p><p>
The
<tt><i>carray-own</i></tt>
function always returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
In all other regards, the descriptions of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>
apply to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-ow=
n</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-0010030E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.14">10.18.1=
4</a> Function <tt>carray-free</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-free </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



If
<tt><i>carray</i></tt>
is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which owns the storage to which it refers, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0010030E">carray-fr=
ee</a></tt>
function liberates that storage by passing the pointer to the C
library function
<tt>free</tt>.
It then replaces that pointer with a null pointer, and
changes the size to zero.
</p><p>
If
<tt><i>carray</i></tt>
doesn't own the storage, an exception is thrown.
</p><p>

</p></dd></dl>
<a name=3D"N-030FEDE6">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.15">10.18.1=
5</a> Function <tt>carray-type</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-type </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030FEDE6">carray-ty=
pe</a></tt>
function returns the element type of
<tt><i>carray</i></tt>,
a compiled FFI type.
</p><p>

</p></dd></dl>
<a name=3D"N-03EB1E3D">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.16">10.18.1=
6</a> Functions <tt>vec-carray</tt> and <tt>list-carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(vec-carray </tt><tt><i>carray</i></tt><tt> [</tt><tt><i>nu=
ll-term-p</i></tt><tt>])=20




<br>&nbsp;&nbsp;(list-carray </tt><tt><i>carray</i></tt><tt> [</tt><tt><i>n=
ull-term-p</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EB1E3D">vec-carra=
y</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EB1E3D">list-carr=
ay</a></tt>
functions convert the array storage of
<tt><i>carray</i></tt>
to a freshly constructed object representation: vector, and list, respectiv=
ely.
The new vector or list is returned.
</p><p>
The
<tt><i>carray</i></tt>
object must have a known size; an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
exception is thrown if these functions are invoked on a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object of unknown size.
</p><p>
The effective length of the new vector or list is derived
from the length of
<tt><i>carray</i></tt>,
taking into account the value of
<tt><i>null-term-p</i></tt>.
</p><p>
The
<tt><i>null-term-p</i></tt>
Boolean parameter defaults to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If specified as true, then it has the effect that the
effective length of the returned vector or list is
one less than that of
<tt><i>carray</i></tt>:
in other words, a true value of
<tt><i>null-term-p</i></tt>
indicates that
<tt><i>carray</i></tt>
holds storage which represents a null-terminated array, and the
terminating null element is to be excluded from the conversion.
</p><p>
If
<tt><i>null-term-p</i></tt>
is true, but the length of
<tt><i>carray</i></tt>
is already zero, then it has no effect; the effective length remains zero,
and a zero-length vector or list is returned.
</p><p>
Conversion of the foreign array to the vector or list is performed
by iterating over all of its elements, starting from element zero, up to th=
e
element before the effective length.
</p><p>

</p></dd></dl>
<a name=3D"N-028920F5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.17">10.18.1=
7</a> Functions <tt>carray-get</tt> and <tt>carray-getz</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-get </tt><tt><i>carray</i></tt><tt>)=20




<br>&nbsp;&nbsp;(carray-getz </tt><tt><i>carray</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028920F5">carray-ge=
t</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-028920F5">carray-ge=
tz</a></tt>
functions treat the contents of
<tt><i>carray</i></tt>
as a FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type, respectively.
</p><p>
They invoke the get semantics to convert the FFI array to a Lisp
object, and return that object.
</p><p>
If the element type is one of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
or
<tt>wchar</tt>,
then the expected string conversion semantics applies.
</p><p>

</p></dd></dl>
<a name=3D"N-02890B44">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.18">10.18.1=
8</a> Functions <tt>carray-put</tt> and <tt>carray-putz</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-put </tt><tt><i>carray</i></tt><tt> </tt><tt><i>new=
-val</i></tt><tt>)=20




<br>&nbsp;&nbsp;(carray-putz </tt><tt><i>carray</i></tt><tt> </tt><tt><i>ne=
w-val</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02890B44">carray-pu=
t</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02890B44">carray-pu=
tz</a></tt>
functions treat the contents of
<tt><i>carray</i></tt>
as a FFI
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0117BE95">array</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017039ED">zarray</a=
></tt>
type, respectively.
</p><p>
They invoke the put semantics to convert the Lisp object
<tt><i>new-val</i></tt>
array to the foreign array representation, which is placed into
the array storage referenced by
<tt><i>carray</i></tt>.
</p><p>
If the element type is one of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">char</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0008D7DC">bchar</a>=
</tt>
or
<tt>wchar</tt>,
then the expected string conversion semantics applies.
</p><p>
Both of these functions return
<tt><i>carray</i></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-03DF5BC5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.19">10.18.1=
9</a> Accessor <tt>carray-sub</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-sub </tt><tt><i>carray</i></tt><tt> [</tt><tt><i>fr=
om</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(set (carray-sub </tt><tt><i>carray</i></tt><tt> [</tt><tt>=
<i>from</i></tt><tt> [</tt><tt><i>to</i></tt><tt>]]) </tt><tt><i>new-val</i=
></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF5BC5">carray-su=
b</a></tt>
function extracts a subrange of a
<tt><i>carray</i></tt>
object, returning a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object denoting that subrange.
</p><p>
The semantics of
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
work exactly like the corresponding arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D9F42F">sub</a></=
tt>
accessor, following the same conventions.
</p><p>
The returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
shares the array has the same element type as the original and
shares the same array storage. If, subsequently, elements of the
original array are modified which lie in the range, then the
modifications will affect the previously returned subrange
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
The returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
references the original object, to ensure that as long as the returned obje=
ct
is reachable by the garbage collector, so is the original.  This relationsh=
ip
can be severed by invoking
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>
on the returned object, after which the two no longer share storage,
and modifications in the original are not reflected in the subrange.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF5BC5">carray-su=
b</a></tt>
is used as a syntactic place, the argument expressions
<tt><i>carray</i></tt>,
<tt><i>from</i></tt>,
<tt><i>to</i></tt>
and
<tt><i>new-val</i></tt>
are evaluated just once. The prior value, if required, is accessed by calli=
ng
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DF5BC5">carray-su=
b</a></tt>
and
<tt><i>new-val</i></tt>
is then stored via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AAF602">carray-re=
place</a></tt>.
</p><p>

</p></dd></dl>
<a name=3D"N-01AAF602">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.20">10.18.2=
0</a> Function <tt>carray-replace</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-replace </tt><tt><i>carray</i></tt><tt> </tt><tt><i=
>item-sequence</i></tt><tt> [</tt><tt><i>from</i></tt><tt> [</tt><tt><i>to<=
/i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AAF602">carray-re=
place</a></tt>
function is a specialized version of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
which works on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
objects. It replaces a sub-range of
<tt><i>carray</i></tt>
with elements from
<tt><i>item-sequence</i></tt>.
The replacement sequence need not have the same length
as the range which it replaces.
</p><p>
The semantics of
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
work exactly like the corresponding arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
function, following the same conventions.
</p><p>
The semantics of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AAF602">carray-re=
place</a></tt>
operation itself differs from the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035991E1">replace</=
a></tt>
semantics on sequences in one important regard: the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object's length always remains the same.
</p><p>
The range indicated by
<tt><i>from</i></tt>
and
<tt><i>to</i></tt>
is deleted from
<tt><i>carray</i></tt>
and replaced by elements of
<tt><i>item-sequence</i></tt>,
which undergo conversion to the foreign type that defines the
elements of
<tt><i>carray</i></tt>.
</p><p>
If this operation would make the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
longer, any elements in excess of the object's length are discarded,
whether they are the original elements, or whether they come from
<tt><i>item-sequence</i></tt>.
Under no circumstances does
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AAF602">carray-re=
place</a></tt>
write an element beyond the length of the underlying storage.
</p><p>
If this operation would make the
<tt><i>carray</i></tt>
shorter (the range being replaced is longer than
<tt><i>item-sequence</i></tt>)
then the downward relocation of items above the replacement range
creates a gap at the end of
<tt><i>carray</i></tt>
which is filled with zero bytes.
</p><p>
The return value is
<tt><i>carray</i></tt>
itself.
</p><p>

</p></dd></dl>
<a name=3D"N-0057639E">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.21">10.18.2=
1</a> Function <tt>carray-pun</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-pun </tt><tt><i>carray</i></tt><tt> </tt><tt><i>typ=
e</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057639E">carray-pu=
n</a></tt>
creates a new
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object which provides an aliased view of the same data that is referenced b=
y
the original
<tt><i>carray</i></tt>
object.
</p><p>
The
<tt><i>type</i></tt>
argument specifies the element type used by the returned aliasing array.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0057639E">carray-pu=
n</a></tt>
function considers the byte size of the array, which is a product of
the original length and element size. It then calculates how many elements =
of
<tt><i>type</i></tt>
fit into this size. This value becomes the length of the aliasing array
which is returned.
</p><p>
Since the returned aliasing array and the original refer to the same
storage, modifications performed in one view are reflected in the other.
</p><p>
The aliasing array holds a reference to the original, so that as long as
it is reachable by the garbage collector, so is the original.
That relationship is severed if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00058922">carray-du=
p</a></tt>
is invoked on the aliasing array.
</p><p>
The meaning of the aliasing depends entirely on the bitwise representations=
 of
the types involved.
</p><p>

</p></dd></dl>
<a name=3D"N-02403ED4">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.22">10.18.2=
2</a> Functions <tt>carray-uint</tt> and <tt>carray-int</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(carray-uint </tt><tt><i>number</i></tt><tt> [</tt><tt><i>t=
ype</i></tt><tt>])=20




<br>&nbsp;&nbsp;(carray-int </tt><tt><i>number</i></tt><tt> [</tt><tt><i>ty=
pe</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02403ED4">carray-ui=
nt</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02403ED4">carray-in=
t</a></tt>
functions convert
<tt><i>number</i></tt>,
an integer, to a binary image, which is then used as
the underlying storage for a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
</p><p>
The
<tt><i>type</i></tt>
argument, a compiled FFI type, determines the element type for the returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>.
If it is omitted, it defaults to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">uint</a><=
/tt>
type, so that the array is effectively of bytes.
</p><p>
Regardless of
<tt><i>type</i></tt>,
these functions first determine the number of bytes required to represent
<tt><i>number</i></tt>
in a big endian format. Then the number of elements is determined for the
array, so that it provides at least as that many bytes of storage. The
representation of
<tt><i>number</i></tt>
is then placed into this storage, such that its least significant byte
coincides with the last byte of that storage. If the number is smaller
than the storage provided by the array, it extended with padding bytes on t=
he
left, near the beginning of the array.
</p><p>
In the case of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02403ED4">carray-ui=
nt</a></tt>,
<tt><i>number</i></tt>
must be a non-negative integer. An unsigned representation is produced
which carries no sign bit. The representation is as many bytes wide as
are required to cover the number up to its most significant bit whose
value is 1. If any padding bytes are required due to the array being larger=
,
they are always zero.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02403ED4">carray-in=
t</a></tt>
function encodes negative integers also, using a variable-length two's
complement representation. The number of bits required to hold the number
is calculated as the smallest width which can represent the value in two's
complement, including a sign bit.  Any unused bits in the most significant
byte are filled with copies of the sign bit: in other words, sign extension
takes place up to the byte size.  The sign extension continues through the
padding bytes if the array is larger than the number of bytes required to r=
epresent
<tt><i>number</i></tt>;
the padding bytes are filled with the value
<tt>#b11111111</tt>
(255) if the number is negative, or else 0 if it is non-negative.
</p><p>

</p></dd></dl>
<a name=3D"N-00797A01">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.23">10.18.2=
3</a> Functions <tt>uint-carray</tt> and <tt>int-carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(uint-carray </tt><tt><i>carray</i></tt><tt>)=20




<br>&nbsp;&nbsp;(int-carray </tt><tt><i>number</i></tt><tt> [</tt><tt><i>ty=
pe</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00797A01">uint-carr=
ay</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00797A01">int-carra=
y</a></tt>
functions treat the storage bytes
<tt><i>carray</i></tt>
object as the representation of an integer.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00797A01">uint-carr=
ay</a></tt>
function simply treats all of the bytes as a big-endian unsigned integer in
a pure binary representation, and returns that integer, which is necessaril=
y
always non-negative.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00797A01">int-carra=
y</a></tt>
function treats the bytes as a two's complement representation. The returne=
d
number is negative if the first storage byte of
<tt><i>carray</i></tt>
has a 1 in the most significant bit position: in other words, is in the
range
<tt>#x80</tt>
to
<tt>#xFF</tt>.
In this case, the two's complement of the entire representation is calculat=
ed:
all of the bits are inverted, the resulting positive integer is extracted.
Then 1 is added to that integer, and it is negated. Thus, for example, if a=
ll
of the bytes are
<tt>#xFF</tt>,
the value -1 is returned.
</p><p>

</p></dd></dl>
<a name=3D"N-00737951">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-10.18.24">10.18.2=
4</a> Functions <tt>fill-carray</tt> and <tt>put-carray</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(fill-array </tt><tt><i>carray</i></tt><tt> [</tt><tt><i>po=
s</i></tt><tt> [</tt><tt><i>stream</i></tt><tt>]])=20




<br>&nbsp;&nbsp;(put-array </tt><tt><i>carray</i></tt><tt> [</tt><tt><i>pos=
</i></tt><tt> [</tt><tt><i>stream</i></tt><tt>]])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt>fill-array</tt>
and
<tt>put-array</tt>
functions perform stream output using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0139F9ED">carray</a=
></tt>
object as a buffer.
</p><p>
The semantics of these functions is as follows.
A temporary buffer is created which aliases the storage of
<tt><i>carray</i></tt>
and this buffer is used as an argument in an invocation of, respectively,
the buffer I/O function
<tt><i>fill-buf</i></tt>
or
<tt><i>put-buf</i></tt>.
</p><p>
The value returned by buffer I/O function is returned.
</p><p>
The
<tt><i>pos</i></tt>
and
<tt><i>stream</i></tt>
arguments are defaulted exactly in the same manner as by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0047">fill-buf</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0079">put-buf</a></=
tt>,
and have the same meaning. In particular,
<tt><i>pos</i></tt>
indicates a byte offset into the
<tt><i>carray</i></tt>
object's storage, not an array index.
</p><p>
</p></dd></dl>
<a name=3D"N-0195CD45">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11">11</a> LISP C=
OMPILATION</h2>




<p>


</p><p>
<a name=3D"N-01CE7F17">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.1">11.1</a=
> Overview</h3>



<p>


</p><p>
<b>TXR</b> supports two modes of processing of Lisp programs: evaluation an=
d compilation.
</p><p>
Expressions entered into the listener, loaded from source files via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
,
processed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
function, or embedded into the <b>TXR</b> pattern language, are processed b=
y the
<i>evaluator</i>.

The evaluator expands all macros, and then interprets the program
by traversing its raw syntax tree structure. It uses an inefficient
representation of lexical variables consisting of heap-allocated environmen=
t
objects which store variable bindings as Lisp association lists. Every time=
 a
variable is accessed, the chain of environments is searched for the binding=
.
</p><p>
<b>TXR</b> also provides a compiler and virtual machine for more efficient =
execution
of Lisp programs. In this mode of processing, top-level expressions are
translated into the instructions of Lisp-oriented virtual machine. The virt=
ual
machine language is traversed more efficiently compared to the traversal of=
 the
cons cells of the original Lisp syntax tree. Moreover, compiled code uses a
much more efficient representation for lexical variables which doesn't invo=
lve
searching through an environment chain. Lexical variables are always alloca=
ted
on the stack (the native one established by the operating system). They are
transparently relocated to dynamic storage only when captured by lexical
closures, and without sacrificing access speed.
</p><p>
<b>TXR</b> provides the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
for compiling individual functions, both anonymous and named. File compilat=
ion
is supported via the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>.
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
is provided for compiling expressions in the global environment. This
function is the basis for both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289A0F1">disassemb=
le</a></tt>
function is provided to list the compiled code in a more understandable way=
;
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289A0F1">disassemb=
le</a></tt>
takes a compiled code object and decodes it into an assembly language
presentation of its virtual machine code, accompanied by a dump of the vari=
ous
information tables.
</p><p>
File compilation via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
refers to a processing step whereby a source file containing <b>TXR Lisp</b=
> forms
(typically named with a
<tt>.tl</tt>
file name suffix) is translated into an object file (named with a
<tt>.tlo</tt>
suffix) containing a compiled version of those forms.
</p><p>
The compiled object file can then be loaded via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function instead of the source file. Usually, loading the compiled file
produces the same effect as if the source file were loaded. However, note t=
hat
the behavior of compiled code can differ from interpreted code in a number =
of
ways. Differences in behavior can be deliberately induced.  Certain erroneo=
us
or dubious situations can also cause compiled code to behave differently fr=
om
interpreted code.
</p><p>
Compilation not only provides faster execution; compiled files also load mu=
ch
faster than source files. Moreover, they can be distributed unaccompanied b=
y
the source files, and resist reverse engineering.
</p><p>
<a name=3D"N-0314D5DA">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.2">11.2</a=
> Top-Level Forms</h3>



<p>


</p><p>
An important concept in file compilation via
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
is that of the
<i>top-level form</i>,

and how that term is defined.  The file compiler individually processes
top-level forms; for each such form, it emits a translated image.
</p><p>
In the context of file compilation, a top-level form isn't simply any Lisp =
form
which is not enclosed by another one.  Rather, in this specific context, it=
 has
this specific definition, which allows some enclosed forms to still be
considered top-level forms:
</p><p>
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
If a form appearing in a <b>TXR Lisp</b> source file isn't enclosed in anot=
her
form, it is a top-level form.
</dd><dt>2.</dt><dd>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
form is top-level form, then each of its constituent forms is also a top-le=
vel
form.
</dd><dt>3.</dt><dd>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
form is top-level form, then each of its constituent forms is also a top-le=
vel
form.
</dd><dt>4.</dt><dd>
If an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
form is top-level form, then each of its constituent forms is also a top-le=
vel
form.
</dd><dt>5.</dt><dd>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form is top-level form, then its argument is a top-level form.
</dd><dt>6.</dt><dd>
When a macro form is identified as a top-level form, it is macro-expanded
as if by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>
before consideration whether it contains top-level forms under rules 2-5.
</dd><dt>7.</dt><dd>
Rules 2-6 are applied recursively.
</dd><dt>8.</dt><dd>
No other forms are top-level forms.
</dd></dl>
</dl>
<p>
A top-level form is a
<i>primary</i>

top-level form if it doesn't contain any other top-level forms.
This means that it is not a form based on any of the operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>.
</p><p>
<a name=3D"N-01D9D5AE">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.3">11.3</a=
> File Compilation Model</h3>



<p>


</p><p>
The file compiler reads each successive forms from a file, performs a parti=
al
expansion on that form, then traverses it to identify all of the
top-level forms which it contains. Each top-level form is subject to
three actions, either of the latter two of which may be omitted: compilatio=
n,
execution and emission. Compilation refers to the translation to compiled f=
orm.
Execution is the invocation of the compiled form. Emission refers to append=
ing
an externalized representation of the compiled form (its image) to the outp=
ut
which is written into the compiled file.
</p><p>
By default, all three actions take place for every top-level form. Using th=
e
operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>,
execution or emission, or both, may be suppressed. If both are suppressed,
then compilation isn't performed; the forms processed in this mode are
effectively ignored.
</p><p>
When a compiled file is loaded, the images of compiled forms are read from
it and converted back to compiled objects, which are executed in sequence.
</p><p>
Partial expansion means that file compilation doesn't fully expand each
form that is encountered. Rather, an incremental expansion is performed,
similar to the algorithm used by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
function:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
First, if
<tt><i>form</i></tt>
is a macro, it is macro-expanded as if by an application of the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02ED5471">macroexpa=
nd</a></tt>.
</dd><dt>2.</dt><dd>
If the resulting expanded form is a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>,
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
form, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
iterates over that form's argument expressions, compiling each expression
recursively as if it were a separate expression.
</dd><dt>3.</dt><dd>
Otherwise, if the expanded form isn't one of the above three kinds of
expressions, it is subject to a full expansion and compilation.
</dd></dl>
</dl>
<a name=3D"N-027938EC">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.4">11.4</a> Tr=
eatment of Literals</h3>



<p>


</p><p>
Programs specify not only code, but also data. Data embedded in a program i=
s
called
<i>literal data</i>.

There are restrictions on what kinds of object may be used as literal data
in programs subject to file compilation. Programs which stray outside of th=
ese
restrictions will produce compiled files which load incorrectly or fail to
load.
</p><p>
Literal objects arise not only from the use of literal such as numbers,
characters and strings, and not only from quoted symbols or lists.
For instance, compiled forms which define or reference free variables or gl=
obal
functions require the names of these variables or functions to be represent=
ed
as literals.
</p><p>
An object used as a literal in file-compiled code must be
<i>externalizable</i>

which means that it has a printed representation which can be scanned to
produce a similar object. An object which does not have a readable printed
representation will give rise to a compiled file which triggers an exceptio=
n.
Literals which are themselves read from program source code naturally meet =
this
restriction; however, with the use of macros, it is possible to embed arbit=
rary
objects into program code.
</p><p>
If the same object appears in two or more places in the code specified in a
single file, the file compilation and loading mechanism ensures that the
multiple occurrences of that object in the compiled file become a single ob=
ject
when the compiled file is loaded. For example, if macros are used in such a=
 way
that the compiled file defines a function which has a name generated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym</a=
></tt>,
and there are calls to that function throughout that file, this will work
properly: the multiple occurrences of the gensym will appear as the same sy=
mbol.
However: that symbol in the loaded file will not be identical to any other
symbol in the <b>TXR</b> image; it will be newly allocated each time the co=
mpiled
file is loaded.
</p><p>
Interned symbols are recorded in a compiled file by means of their textual
names and package prefixes. When a compiled file is loaded, the interned
symbols which occur as literals in it are entered into the specified packag=
es
under the specified names. The value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
special variable has no influence on this.
</p><p>
Circular structures in compiled literals are preserved; on loading, similar
circular structures are reproduced.
</p><p>
<a name=3D"N-030700A6">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.5">11.5</a=
> Treatment of The Hash Bang Line</h3>



<p>


</p><p>
<b>TXR</b> supports the hash bang mechanism in compiled
<tt>.tlo</tt>
files, thereby allowing compiled scripts to be executable.
</p><p>
When a source file begins with the
<tt>#!</tt>
("hash-bang") character sequence, the file compiler propagates that
line (all characters up to and including the terminating newline) to the
compiled file, subject to the following transformation: occurrences of
<tt>"--lisp"</tt>

which are not followed by a dash are replaced with
<tt>"--compiled"</tt>.
</p><p>
Furthermore, certain permissions are propagated from a hash bang source
file to the target file. If the source file is executable to its owner,
then the target file is made executable as if by using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F941E5">chmod</a>=
</tt>
with the
<tt>+x</tt>
mode: all the executable permissions that are allowed by the current
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068D92E">umask</a>=
</tt>
are are enabled on the target file. If the target file is thus being marked
executable, then additional permissions are also treated as follows.  If th=
e
target file has the same owner as the source file, and the source file's se=
tuid
permission bit is set, then this is propagated to the target file. Similarl=
y,
if the target file has the same group owner as the source file, and the sou=
rce
file's group execute bit and setgid permission bit are set, then the setgid
bit is set on the target file.
</p><p>
<a name=3D"N-03FBFCAE">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.6">11.6</a=
> Compiled File Compatibility</h3>



<p>


</p><p>
<b>TXR</b>'s virtual machine architecture for executing compiled code
is evolving, and that evolution has implications for the compatibility betw=
een
compiled files the <b>TXR</b> executable image.
</p><p>
The basic requirement is that a given version of <b>TXR</b> can load and ex=
ecute
the compiled files which that same version has produced.
</p><p>
Furthermore, these files are architecture-independent, except that their
encoding is in the local byte order ("endianness") of the host machine.
The byte order is explicitly indicated in the files, and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function resolves it. Thus a file produced by <b>TXR</b> running on a 64 bi=
t big
endian Power PC can be loaded by <b>TXR</b> running on 32 bit x86, which is
little endian.
</p><p>
A given <b>TXR</b> version may also be capable of loading files produced by
an older version, or even ones produced by a newer version. Whether this
is possible depends on the versions involved.
</p><p>
Compiled files contain a minor and major version number (which is independe=
nt
of the <b>TXR</b> version). The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function examines these numbers and decides whether the file is loadable,
or whether it must be rejected.
</p><p>
The first version of <b>TXR</b> which featured the compiler and virtual mac=
hine was
191. Older versions therefore cannot load compiled files.
</p><p>
Versions 191 and 192 produce version 1 compiled files, and load only that
version.
</p><p>
Versions 193 through 198 produce version 2 compiled files and load only
that version.
</p><p>
Version 199 produces version 3 files and loads version 2 or 3.
</p><p>
Versions 200 through 215 produce version 4 files and load version 2, 3 or 4=
.
</p><p>
Versions 216 through 243 produce version 5.0 files and load
version 2, 3, 4 or 5, regardless of minor version.
</p><p>
Versions 244 through 251 produce version 5.1 files and load
version 2, 3, 4 or 5, regardless of minor version.
</p><p>
Versions 252 and 256 produce version 6.0 files and loads only version 6,
regardless of minor version.
</p><p>
<a name=3D"N-0190C819">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7">11.7</a=
> Semantic Differences between Compilation and Interpretation</h3>



<p>


</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
operators can be used to deliberately produce code which behaves differentl=
y
when compiled and interpreted. In addition, unwanted differences in behavio=
r
can also occur. The situations are summarized below.
</p><p>

<a name=3D"N-019FEC08">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.1">11.7.=
1</a> Differences due to <tt>load-time</tt></h4>



<p>
Forms evaluated by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
are treated differently by the compiler. When a top-level form is compiled,
its embedded
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms are factored out such that the compiled image of the top-level form
will evaluate these forms before other evaluations take place.
The interpreter doesn't perform this factoring; it evaluates a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form when it encounters it for the first time.
</p><p>

<a name=3D"N-02793C6C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.2">11.7.=
2</a> Treatment of literals</h4>



<p>
The compiler identifies multiple occurrences of equivalent strings and bign=
um
integers that occur as literals, and condenses each one to a single instanc=
e,
within the scope of the compilation. The scope is possibly as wide as a fil=
e.
</p><p>
If the literal
<tt>"abc"</tt>

appears in multiple places in the same file that is processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>,
in the resulting compiled file, there may be just a single
<tt>"abc"</tt>

object. For instance, if the file contains two functions:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> f1 () "abc")
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
f2 () "abc")
</tt></pre><tt>

</tt>

<p>
when compiled, these will return the same object such that
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
550B35">eq</a> (f1) (f2)) -&gt; t
</tt></pre><tt>

</tt>

<p>
No such de-duplication is performed for interpreted code.
</p><p>
Consequently, code which depends on multiple occurrences of these objects t=
o be
distinct objects may behave correctly when interpreted, but misbehave when
compiled. Or
<i>vice versa</i>.

One example is code which modifies a string literal.
Under compilation, the change will affect all occurrences of that literal
that have been merged into one object.  Another example is an
expression like
<tt>(eq "abc" "abc")</tt>,
which yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
under interpretation because the two strings are distinct object in spite
of appearing side by side in the syntax, but
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
when compiled, since they denote the same string object.
</p><p>
In the future, objects other than strings and bignums may be similarly
consolidated, such as lists and vectors, which means that interpreted
code which works today when compiled may misbehave in the future.
</p><p>
Note that objects which are literally notated in source code are not the on=
ly
kinds of objects considered to be literals.  Objects which are constructed =
by
macros and inserted into macro-expansions are also literals.  Literals are
self-evaluating objects that appear as expressions in the syntax which rema=
ins
after macro-expansion, as well as arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0163F998">quote</a>=
</tt>
operator. If a macro calculates a new string each time it is expanded,
and inserts it into the expansion as a literal, the compiler will identify
and consolidate groups of such strings that are identical.
</p><p>

<a name=3D"N-01368FC6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.3">11.7.=
3</a> Treatment of unbound variables</h4>



<p>
Unbound variables are treated differently by the compiler. A reference
to an unbound variable is treated as a global lexical access. This means th=
at
if a variable access is compiled first and then a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
is processed which introduces the variable as a dynamically scoped ("specia=
l")
variable, the compiled code will not treat the variable as special; it
will refer to the global binding of the variable, even when a dynamic bindi=
ng
for that variable exists.  The interpreter treats all variable references
that do not have lexical bindings as referring to dynamic variables.
The compiler treats a variable as dynamic if a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
has been processed which marked that variable as special.
</p><p>

<a name=3D"N-003616B1">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.4">11.7.=
4</a> Unbound symbols in <tt>dwim</tt></h4>



<p>
Arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form (or the equivalent bracket notation) which are unbound
symbols are treated differently by the
compiler. The code is compiled under the assumption that all such symbols
refer to global functions. For instance, if neither
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
nor
<tt>x</tt>
are defined, then
<tt>[f x]</tt>
will be compiled under the assumption that they are functions.  If they are
later defined as variables, the compiled code will fail because no function
named
<tt>x</tt>
exists. The interpreter resolves each symbol in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form at the time the form is being executed. If a symbol is defined
as a variable at that time, it is accessed as a variable. If it defined as =
a
function, it is accessed as a function.
</p><p>

<a name=3D"N-027616B2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.5">11.7.=
5</a> Bound symbols in <tt>dwim</tt></h4>



<p>
The symbolic arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form that refer to global bindings are also treated differently by the comp=
iler.
For each such symbol, the compiler determines whether it refers to a
function or variable and, further, whether the variable is global lexical o=
r
special. This treatment of the symbol is then cemented in the compiled code=
;
the compiled code will treat that symbol that way regardless of the
run-time situation. By contrast, the interpreter performs this classificati=
on
each time the arguments of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-003E">dwim</a></tt>
form are evaluated. The rules are otherwise the same: if the symbol is boun=
d as
a variable, it is treated as a variable. If it is bound as a function, it i=
s
treated as a function. If it has both bindings, it is treated as a variable=
.
The difference is that this is resolved at compile time for compiled code,
and at evaluation time for interpreted code.
</p><p>

<a name=3D"N-03C89989">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.6">11.7.=
6</a> File-wide insertion of gensyms</h4>



<p>
The following degenerate situation occurs, illustrated by example. Suppose =
the
following definitions are given:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F36A75">defvarl</a> %gensym%)

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> define-secret-fun ((. args) . body)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-002F">set</a> %gen=
sym% (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA7FBB">gensym<=
/a>))
    ^(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</=
a> ,%gensym% (,*args) ,*body))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro</=
a> call-secret-fun (. args)
    ^(,%gensym% ,*args))
</tt></pre><tt>

</tt>

<p>
The idea is to be able to define a function whose name is an uninterned
symbol and then call it. An example module might use these definitions as
follows:
</p><p>
<tt>
</tt></p><pre><tt>  (define-secret-fun (a) (<a href=3D"http://nongnu.org/tx=
r/txr-manpage.html#N-012163C3">put-line</a> `a is @a`))

  (call-secret-fun 42)
</tt></pre><tt>

</tt>

<p>
The effect is that the second top-level form calls the function, which
prints 42 to standard out. This works both interpreted and compiled with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>.
Each of these two macro calls generates a top-level form into which
the same gensym is inserted. This works under file compilation due to a
deliberate strategy in the layout of compiled files, which allows such
uses. Namely, the file compiler combines multiple top-level forms
into a single object, which is read at once, and which uses the circle
notation to unify gensym references.
</p><p>
However, suppose the following change is introduced:
</p><p>
<tt>
</tt></p><pre><tt>  (define-secret-fun (a) (<a href=3D"http://nongnu.org/tx=
r/txr-manpage.html#N-012163C3">put-line</a> `a is @a`))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackage=
</a> foo) ;; newly inserted form

  (call-secret-fun 42)
</tt></pre><tt>

</tt>

<p>
This still works when interpreted, and compiles successfully. However, when=
 the
compiled file is loaded, the compiled version of the
<tt>call-secret-fun</tt>
form fails with an error complaining that the
<tt>#:g0039</tt>
(or other gensym name) function is not defined.
</p><p>
This is because for this modified source file, the file compiler is not
able to combine the compiled forms into a single object. It would not
be correct to do so in the presence of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>
form, because the evaluation of that form affects the subsequent interpreta=
tion
of symbols. After the package definition is executed, it is possible for
a subsequent top-level form to refer to a symbol in the
<tt>foo</tt>
package such as
<tt>foo:bar</tt>
to occur, which would be erroneous if the package didn't exist.
</p><p>
The file compiler therefore arranges for the compiled forms after the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>
to be emitted into a separate object. But that division in the output file
consequently prevents the occurrences of the gensym to resolve to the same
symbol object.
</p><p>
In other words, the strategy for allowing global gensym use is in conflict
with support for forms which have a necessary read-time effect such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033951A2">defpackag=
e</a></tt>.
</p><p>
The solution is to rearrange the file to unravel the interference, or
to use interned symbols instead of gensyms.
</p><p>

<a name=3D"N-00E6B6D3">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.7.7">11.7.=
7</a> Delimited Continuations</h4>



<p>
There are differences in behavior between compiled and interpreted code
with regard to delimited continuations. This is covered in the
Delimited Continuations section of the manual.
</p><p>
<a name=3D"N-00C757AB">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8">11.8</a=
> Compilation Library</h3>



<p>


</p><p>

<a name=3D"N-00DE8B13">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.1">11.8.=
1</a> Function <tt>compile-toplevel</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compile-toplevel </tt><tt><i>form</i></tt><tt> </tt><tt><i=
>expanded-p</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
function takes the Lisp form
<tt><i>form</i></tt>
and compiles it. The return value is a
<i>virtual machine description</i>

object representing the compiled form. This object isn't of function type, =
but may be
invoked as if it were a function with no arguments.
</p><p>
Invoking the compiled object is expected to produce the same effect as
evaluating the original
<tt><i>form</i></tt>
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
function.
</p><p>
The
<tt><i>expanded-p</i></tt>
argument indicates that
<tt><i>form</i></tt>
has already been expanded and is to be compiled without further expansion.
</p><p>
If
<tt><i>expanded-p</i></tt>
is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then it is subject to a full expansion.
</p><p>
Note: in spite of the name,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
makes no consideration whether or not
<tt><i>form</i></tt>
is a "top-level form" according to the definition of that term
as it applies to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
processing.
</p><p>
Note: a form like
<tt>(progn (defmacro foo ()) (foo))</tt>
will not be processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
in a manner similar to the processing by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0286C8B8">eval</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>.
In this example,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02CAEF0B">defmacro<=
/a></tt>
form will not be evaluated prior to the expansion of
<tt>(foo)</tt>
(and in fact not evaluated at all)
and so the latter expression isn't correctly referring to that macro.
The form
<tt>(progn (macro-time (defmacro foo ())) (foo))</tt>
can be processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>;
however, the macro definition now takes place during expansion, and isn't
compiled.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
function has no such issue when it encounters such a form at the top-level,
because that function will consider a top-level
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>
form to consist of multiple top-level forms that are compiled
individually, and also executed immediately after being compiled.
</p><p>
</p></dd><dt>Example</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  ;; compile (<a href=3D"http://nongnu.org/txr/txr-manpag=
e.html#D-007C">+</a> 2 2) form and execute to calculate 4
  ;;
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</a=
> comp (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compi=
le-toplevel</a> '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C"=
>+</a> 2 2)))

  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a> c=
omp) -&gt; 4

  [comp] -&gt; 4
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-009542C1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.2">11.8.2</a=
> Function <tt>compile</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compile </tt><tt><i>function-name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(compile </tt><tt><i>lambda-expression</i></tt><tt>)=20




<br>&nbsp;&nbsp;(compile </tt><tt><i>function-object</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
function compiles functions.
</p><p>
It can compile named functions when
the argument is a
<tt><i>function-name</i></tt>.
A function name is a symbol denoting an existing interpreted function,
or compound syntax such as
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C216C3">meth</a> </t=
t><tt><i>type</i></tt><tt> </tt><tt><i>name</i></tt><tt>)=20

</tt>

to refer to methods. The code of the interpreted function is retrieved,
compiled in a manner which produces an anonymous compiled function,
and then that function replaces the original function under the same name.
</p><p>
If the argument is a lambda expression, then that function is
compiled.
</p><p>
If the argument is a function object, and that object is an interpreted
function, then its code and lexical environment are retrieved and compiled.
</p><p>
In all cases, the return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
is the compiled function.
</p><p>
Note: when an interpreted function object is compiled, the compiled environ=
ment
does not share bindings with the original interpreted environment.
Modifications to the bindings of either environment have no effect on the
other. However, the objects referenced by the bindings are shared.  Shared
bindings may be arranged using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01348099">hlet</a><=
/tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01348099">hlet*</a>=
</tt>
macros.
</p><p>

</p></dd></dl>
<a name=3D"N-0211BE68">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.3">11.8.3</a=
> Functions <tt>compile-file</tt> and <tt>compile-update-file</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compile-file </tt><tt><i>input-path</i></tt><tt> [</tt><tt=
><i>output-path</i></tt><tt>])=20




<br>&nbsp;&nbsp;(compile-update-file </tt><tt><i>input-path</i></tt><tt> [<=
/tt><tt><i>output-path</i></tt><tt>])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
function reads forms from an input file, and produces a compiled output fil=
e.
</p><p>
First,
<tt><i>input-path</i></tt>
is converted to a
<i>tentative path name</i>

as follows.
</p><p>
If
<tt><i>input-path</i></tt>
specifies a pure relative pathname, as defined by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019DEA44">pure-rel-=
path-p</a></tt>
function, then a special behavior applies.
If an existing load operation is in progress, then the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
has a binding. In this case,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
will assume that the relative pathname is a reference relative to the
directory portion of that path name.
</p><p>
If
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
has the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
then a pure relative
<tt><i>input-path</i></tt>
pathname is used as-is, and thus resolved relative to the current working
directory.
</p><p>
The tentative path name is converted to an
<i>actual input path name</i>

as follows. Firstly, if the tentative path name ends with one of the suffix=
es
<tt>.tl</tt>
or
<tt>.txr</tt>
then it is considered suffixed, otherwise it is considered unsuffixed.
If it is suffixed, then the actual path name is the same as the tentative p=
ath name.
In the unsuffixed case, two possible actual input path names are formed. Fi=
rst,
the suffix
<tt>.tl</tt>
is added to the tentative path name. If that path exists, it is taken
taken as the actual path. Otherwise, the unmodified tentative path
is taken as the actual input path.
</p><p>
If the actual path ends in the suffix
<tt>.txr</tt>
then the behavior is unspecified.
</p><p>
If the
<tt><i>output-path</i></tt>
parameter is given an argument, then that argument specifies the
output path.
Otherwise the output path is derived from the tentative input path
as follows. If the tentative input path is unsuffixed, then
<tt>.tlo</tt>
is added to it to produce the output path.
Otherwise, the suffix is removed from the tentative input path
and replaced with the
<tt>.tlo</tt>
suffix.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
function binds the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
similarly to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function.
</p><p>
Over the compilation of the input file,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
establishes a new dynamic binding for several special
variables. The variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
is given a new binding containing the actual input path name.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable is also given a new dynamic binding, whose value is the
same as the existing binding. Thus if the compilation of the
file has side the effect of altering the value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>,
that effect will be undone when the binding is removed
after the compilation completes.
</p><p>
Compilation proceeds according to the File Compilation Model.
</p><p>
If the compilation process fails to produce a successful translation
for each form in the input file, the output file is removed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-u=
pdate-file</a></tt>
function differs from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
in the following regard: compilation is performed only if the input
file is newer than the output file, or else if the output file doesn't
exist.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
always returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it terminates normally, which occurs if it successfully translates
every form in the input file, depositing the translation into the output
file. If compilation fails,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
terminates by throwing an exception.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-u=
pdate-file</a></tt>
function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
if it successfully compiles, similarly to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>.
If compilation is skipped, the function returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Note: the following idiom may be used to load a file, compiling it if
necessary:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
34">or</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">c=
ompile-update-file</a> "file")
      (load-file "file"))
</tt></pre><tt>

</tt>

<p>
However, note that it relies on the effect of compiling a source file being=
 the
same as the effect of loading the compiled file.
This can only be true if the source file contains no
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
top-level forms.
</p><p>

</p></dd></dl>
<a name=3D"N-03F68BBC">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.4">11.8.4</a=
> Special Variable <tt>*opt-level*</tt></h4>



<p>
</p><dl>
<dt>Description:</dt><dd>
<p>



The special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F68BBC">*opt-leve=
l*</a></tt>
provides control over compiler optimizations.
</p><p>
The variable takes on integer
values. If the value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
it is interpreted as zero.  The meaningful range is from 0 to 6.
The initial value of the variable is 6.
</p><p>
The meanings of the values are as follows:
</p><p>
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>0</dt><dd>
Almost all optimizations are disabled, except for some strength
reductions of instances of he
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
function, to take advantage of certain conditional instructions.
</dd><dt>1</dt><dd>
Constant folding is applied, as well as algebraic reductions to list proces=
sing
and arithmetic code. Two-argument calls to several common arithmetic operat=
ors
are translated into calls to more efficient two-argument internal functions=
.
</dd><dt>2</dt><dd>
Blocks which can be easily confirmed not to be used as exit points are remo=
ved.
Variable frames in which no lexically captured variables are bound, and no
dynamic variables are bound, are eliminated.
</dd><dt>3</dt><dd>
Lambda expressions and calls to combinator functions such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C53CF7">chain</a>=
</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E7D2AD">andf</a><=
/tt>
are lifted to load time, if possible.
</dd><dt>4</dt><dd>
Control flow optimizations are applied: jump threading and elimination of
unreachable code. Some peephole optimizations are applied to improve
certain instruction patterns.
</dd><dt>5</dt><dd>
Data flow optimizations are applied, such as elimination of dead register
moves, or useless propagations of values from one register to another.
More peephole optimizations are applied.
</dd><dt>6</dt><dd>
Certain more rarely applicable optimizations are applied which reduce code =
size
by merging some identical code blocks, or improving some more rarely
occurring instruction patterns.
</dd></dl>
</dl>
<p>

</p></dd></dl>
<a name=3D"N-013AAB51">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.5">11.8.5</a=
> Macro <tt>with-compilation-unit</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(with-compilation-unit </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



When a file is processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>,
certain actions, such as the issuance of diagnostics about undefined functi=
ons
and variables, are delayed until the file is completely processed.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AAB51">with-comp=
ilation-unit</a></tt>
macro allows these actions to be collectively deferred until multiple files
are completely processed.
</p><p>
The macro evaluates each enclosed
<tt><i>form</i></tt>
in a single compilation environment. After the last
<tt><i>form</i></tt>
is evaluated, deferred actions of any enclosed
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
forms are performed, and then the value of the last
<tt><i>form</i></tt>
is returned.
</p><p>
It is permissible to nest
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AAB51">with-comp=
ilation-unit</a></tt>
forms, lexically or dynamically. The outermost invocation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AAB51">with-comp=
ilation-unit</a></tt>
dominates; all deferred
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
actions are held until the outermost enclosing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013AAB51">with-comp=
ilation-unit</a></tt>
terminates.
</p><p>

</p></dd></dl>
<a name=3D"N-030BF4F5">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.6">11.8.6</a=
> Operators <tt>compile-only</tt> and <tt>eval-only</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(compile-only </tt><tt><i>form</i></tt><tt>*)=20




<br>&nbsp;&nbsp;(eval-only </tt><tt><i>form</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



These operators take on a special behavior only when they appear as top-lev=
el forms
in the context of file compilation.
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
form is processed by the evaluator rather than compiler, or when it is
processed outside of file compilation, or when it is appears as other than =
a
top-level form even under file compilation, then these operators behave
in a manner identical to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>.
</p><p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
form appears as a top-level form under file compilation, it indicates to th=
e
file compiler that the
<tt><i>form</i></tt>-s
enclosed in it are not to be evaluated. By default, the file compiler execu=
tes
each top-level form after compiling it.  The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
operator suppresses this evaluation.
</p><p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
form appears as a top-level form under file compilation, it indicates to th=
e
file compiler that the
<tt><i>form</i></tt>-s
enclosed in it are not to be emitted into the output file. By default, the =
file
compiler includes the compiled image in the output written to the output fi=
le.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
operator suppresses this inclusion.
</p><p>
Forms which are surrounded by both an
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
form and a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
form are neither executed nor emitted into the output file. In this situati=
on,
the forms are skipped entirely; no compilation takes place.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
function not only compiles, but also executes every form for the following
reason: the correct compilation of forms can depend on the execution of ear=
lier
forms. For instance, code may depend on macros. Macros may in turn depend o=
n
functions and variables. All those definitions are required in order to com=
pile
the dependent code. Those dependencies may be in a separate file which is
loaded by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
form; that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
form must be executed.
</p><p>
Note that execution of a form implies that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms that it contains are evaluated (prior to other evaluations). Suppress=
ion
of the execution of a form also suppresses the evaluation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms.
</p><p>
Situations in which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
is useful are those in which it is desirable to stage the execution of some
top-level form into the compiled file, and not have it happen during
compilation. For instance:
</p><p>
<tt>
</tt></p><pre><tt>   ;; in a main module
   (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a> (start-application))
</tt></pre><tt>

</tt>

<p>
It is not desirable to have the file compiler try to start the application
as a side effect of compiling the main module. The right behavior is to
compile the
<tt>(start-application)</tt>
top-level form so that this will happen when that module is loaded.
</p><p>
Situation in which
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
is useful is for specifying forms which have a compile-time effect only,
but are not propagated into the compiled file.
</p><p>
For example, since the correct treatment of literal symbols occurring in a
compiled file does not depend on the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable, in many cases, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
invocation in the file can be wrapped with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
0BF4F5">eval-only</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0062">in-package</a> app))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
form must be evaluated during compilation so that the remaining forms are r=
ead
in the correct package. However the loading of the compiled versions of tho=
se
forms doesn't require that package to be in effect; thus a compiled image
of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0062">in-package</a=
></tt>
form need not appear in the compiled file.
</p><p>
Macros definitions may be treated with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">eval-only=
</a></tt>
if the intent is only to make the expanded code available in the compiled f=
ile,
and not to propagate compiled versions of the macros which produced it.
</p><p>

</p></dd></dl>
<a name=3D"N-03A3999F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.7">11.8.7</a=
> Macro <tt>load-time</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(load-time </tt><tt><i>form</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
macro makes it possible for a program to evaluate a form, such that,
subsequently, the value of that form is then treated as if it were
a literal object.
</p><p>
Literals are pieces of the program syntax which are not evaluated at all.
On the other hand, the values of expressions are not literals.
</p><p>
From time to time, certain situations benefit from the program being
able to perform an evaluation, and then have the result of that evaluation
treated as a literal.
</p><p>
There is already an operator named
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
which makes this possible in its particular manner: that operator
allows one or more expressions to be evaluated during macro expansion.
The result of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>
is then quoted and substituted in place of the expression. That result
then appears as a true quoted literal to the executing code.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
macro similarly arranges for the single form
<tt><i>form</i></tt>
to be evaluated. However, this evaluation doesn't take place at
expansion time. It is delayed until the program executes.
</p><p>
What exactly "delayed until the program executes" means depends on whether
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is used in compiled or interpreted code, and in what situation is
it compiled.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form appears in interpreted code, then the exact time when
<tt><i>form</i></tt>
is evaluated is unspecified. The evaluator may identify all
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms which occur anywhere in a top-level expression, and perform
their evaluations immediately, before evaluating the form itself.
Then, when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms are encountered again during the evaluation of the form,
they simply retrieve the previously evaluated values as if
they were literal.  Or else, the evaluation may be performed late: when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form itself is encountered during normal evaluation. In that case,
<tt><i>form</i></tt>
will still be evaluated only once and then its value will be be
inserted as a literal in subsequent re-evaluations of that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form, if any.
</p><p>
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form appears in a non-top-level expression which is compiled, the
compiler arranges for the compiled version of
<tt><i>form</i></tt>
to be executed when compiled version of the entire expression is
executed. This execution occurs early, before the execution of
forms that are not wrapped in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>.
The value produced by
<tt>form</tt>
is entered into the static data vector associated with the
compiled top-level expression, which also holds ordinary literals.
Whenever the value of that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form is required, the compiled code references it from the data
vector as if it were a true literal.
</p><p>
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
top-level form is processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>,
it has no unusual semantics; the effect is that it is replaced by
its argument
<tt><i>form</i></tt>,
which is in that case also considered a top-level form.
</p><p>
The implications of the translation scheme may be understood
separately from the perspective of code processed with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form appearing in a form passed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
is translated such that its embedded
<tt><i>form</i></tt>
will be executed each time the virtual machine description returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
is executed, and the execution of all such forms is placed ahead
of other code.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form appearing in an interpreted function which is processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
is evaluated immediately, and its value becomes a literal
in the compiled version of the function.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form appearing as a non-top-level form inside a file that is processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
is compiled along with that form and deposited into the object file.
When the object file is loaded, each compiled top-level form is executed.
Each compiled top-level form's
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
calculations are executed first, and the corresponding
<tt><i>form</i></tt>
values become literals at that point. This execution order is individually
ensured for each top-level form.
Thus, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms in a given top-level form may rely on the side-effects of
prior top-level forms having taken place.
Note that, by default,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
also immediately executes each top-level form which it compiles and deposit=
s
into the output file. This execution is equivalent to a load; it causes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms to be evaluated. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-030BF4F5">compile-o=
nly</a></tt>
operator must be used around
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms which must be evaluated only when the compiled file is loaded,
and not at compile time.
</p><p>
In all situations, the evaluation of
<tt><i>form</i></tt>
takes place in the global environment. Even if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form is surrounded by constructs which establish lexical bindings,
those lexical bindings aren't visible to
<tt><i>form</i></tt>.
Which dynamic bindings are visible to
<tt><i>form</i></tt>
depends on the exact situation. If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form occurs in code that had been processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
and is now being loaded by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
,
then the dynamic environment in effect is the one in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
occurred, with any modifications to that environment that were performed
by previously executed forms. If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form occurs in code that had been processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>,
then
<tt><i>form</i></tt>
is evaluated in the dynamic environment of the caller which invokes
the execution of the resulting compiled object.
When a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form occurs in the code of an function being processed by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>,
then
<tt><i>form</i></tt>
is evaluated in the dynamic environment of the caller which invokes
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>.
If a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form occurs in a form processed processed by the evaluator, it is unspecifi=
ed
whether it takes place in the original dynamic environment in which the
evaluator was invoked, or whether it is in the dynamic environment of
the immediately enclosing form which surrounds the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form may be nested inside another
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form. In this situation, two cases occur.
</p><p>
If the two forms are not embedded in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
or else are embedded in the same
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
then the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form is superfluous due to the presence of the outer
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>.
That is to say, the inner
<tt>




(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a> </=
tt><tt><i>form</i></tt><tt>)=20

</tt>

expression is equivalent to
<tt><i>form</i></tt>,
because the outer form already establishes its evaluation to be in a load-t=
ime
context.
</p><p>
If the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form occurs in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
but the outer form occurs outside of that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>,
then the semantics of the inner
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form is relevant and necessary. This is because expressions occurring in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
are evaluated when the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
is called, which may take place from a non-load-time context, even if the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
itself was produced in a load-time context.
</p><p>
An expression being embedded in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
means that it appears either in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
body, or else in the parameter list as the initializing
expression for an optional parameter.
</p><p>
</p></dd><dt>Notes:</dt><dd>
<p>


</p><p>
When interpreted code containing
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is evaluated, a mutating side effect may take place
on the tree structure of that code itself as a result of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
evaluation.
If that previously evaluated code is subsequently compiled, the compiled
translation may be different from compiling the original unevaluated code.
Specifically, the compiler may take advantage of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
evaluation which had already taken place in the interpreter, and simply tak=
e
that value, and avoid compiling
<tt><i>form</i></tt>
entirely. This also has implications on the dynamic environment
that is in effect when
<tt><i>form</i></tt>
is evaluated. If
<tt><i>form</i></tt>
is evaluated by the interpreter, then it interacts with the dynamic environ=
ment
which as in effect in that situation; then when the compiler later just tak=
es
the result of that evaluation, the compiler's dynamic environment is irrele=
vant
since
<tt><i>form</i></tt>
isn't being evaluated any more.
</p><p>
If
<tt><i>form</i></tt>,
when evaluated multiple times, potentially produces a different value on ea=
ch
evaluation, this has implications for the situation when an object produced=
 by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
is invoked multiple times. Each time such an object is invoked, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
forms are evaluated. If they produce different values, then it appears that
the values of literals are changing. All lexical closures derived from the
same compiled object share the same literal data.
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function never evaluates a compiled expression more than once. If the same
compiled file is loaded more than once, a new compiled object instance is
produced from each compiled expression, carrying its own storage area for
literals. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-009542C1">compile</=
a></tt>
function also never evaluates a compiled expression more than once; it prod=
uces
a compiled object, and then executes it once in order to obtain a lexical
closure which is returned. Invoking the closure doesn't cause the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
expressions to be evaluated.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form is subject to compiler optimizations. A top-level expression is assume=
d to
be evaluated in load time, so
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
does nothing in a top-level expression. It becomes active inside forms
embedded in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-004F">lambda</a></t=
t>
expressions. Since
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
may be used to hoist calculations outside of loops,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is also active in those parts of loops which are repeatedly evaluated.
</p><p>
The use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is similar to defining a variable and then referring to the variable.
For instance, a file containing this:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F36A75">defvarl</a> a (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-=
0206CE91">list</a> 1 2))
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a> =
f () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D6CEDA">cons</a=
> 0 a))
</tt></pre><tt>

</tt>

<p>
is similar to
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00=
B44934">defun</a> f () (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-02D6CEDA">cons</a> 0 (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-=
0003">load-time</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
06CE91">list</a> 1 2))))
</tt></pre><tt>

</tt>

<p>
When either file is loaded, in source or compiled form,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
expression is evaluated at load time, and then when
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BDFA9">f</a></tt=
>
is invoked, it retrieves the list.
</p><p>
Both approaches have advantages. The variable-based approach gives the valu=
e a
name. The semantics of the variable is straightforward. The variable
<tt>a</tt>
can easily be assigned a new value. Using its name, the variable can be
inspected from the interactive listener. The variable can be referenced
from multiple top-level forms directly; it is not a static datum tied to
a table of literal values that is tied to a single top-level form.
Furthermore, the use of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">de=
fvarl</a></tt>
versus
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defparm</=
a></tt>/<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F36A75">d=
efparml</a></tt>
controls whether the variable gets replaced with a new value when the
file is re-loaded.
</p><p>
The advantage of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is that it doesn't require a separate top-level form to achieve its load-ti=
me
effect: the expression is simply nested at the point where it is needed. Th=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
form can therefore be generated by macros, whose expansions cannot inject
extra top-level forms into the site where they are invoked.
If a macro writer would like some form to be evaluated at load time and
its value accessible in a macro expansion that appears arbitrarily nested
in code, then
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
may provide the path to a straightforward implementation strategy.
Access to a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
value is fast because it doesn't involve referencing through a variable
binding; compiled code accesses the value directly via its fixed position
in the static data table associated with that code. This advantage is
insignificant, however, because access to lexical variables in compiled cod=
e is
similarly fast, and a value can easily be propagated from a global variable
to a lexical for the sake of speed. That said,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
eliminates that copying step too.
</p><p>
A
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is also useful when the value is not required, and instead the form produce=
s
a useful effect, which should be hoisted to load time. For instance, consid=
er
a macro which produces the following expansion:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03=
F7A8B8">progn</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003=
">load-time</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0=
E7">defvar</a> #:g0025)) (other-logic ... #:g0025))
</tt></pre><tt>

</tt>

<p>
no matter where this expansion is inserted,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
will ensure that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
is executed once, when the compiled file is loaded, as if that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
appeared on its own as a top-level form. Then the
<tt>other-logic</tt>
form can refer to the variable, without the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
being evaluated on each execution of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7A8B8">progn</a>=
</tt>.
</p><p>
The author of a macro can use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
to stage the evaluation of global effects that the macro expansion depends =
on
simply by bundling these effects into the expansion, wrapped in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>.
</p><p>
</p></dd><dt>Dialect Note:</dt><dd>
<p>


The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
macro is similar to the ANSI Common Lisp
<tt>load-time-value</tt>
special operator. It doesn't support the
<tt><i>read-only-p</i></tt>
argument featured in the ANSI CL operator.
The semantics of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is somewhat more precisely specified in terms of concrete
implementation concepts. The ANSI CL
<tt>load-time-value</tt>
may evaluate
<tt><i>form</i></tt>
more than once in interpreted code; effectively, the ANSI CL
implementation may treat
<tt>(load-time-value x)</tt>
as
<tt>(progn x)</tt>.
This is not true of <b>TXR Lisp</b>'s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
which requires once-only evaluation even in interpreted code.
The name
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is used instead of
<tt>load-time-value</tt>
for several reasons.
Firstly,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is useful for staging effects, like definitions, to load time, even when th=
e
resulting value is not used.
Secondly, unlike <b>TXR Lisp</b>, ANSI CL features multiple values: a form
can yield zero or more values. The ANSI CL
<tt>load-time-value</tt>
operator, however, is restricted to yielding a single value, and its
name may have been chosen to emphasize this aspect/restriction.
That doesn't apply in the context of <b>TXR Lisp</b> in which all expressio=
ns
which terminate normally yield exactly one value, making
<tt>"-value"</tt>

a suffix that adds no value. Lastly,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0003">load-time</a>=
</tt>
is shorter, and harmonizes with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0264A0BD">macro-tim=
e</a></tt>,
which preceded it by four years.
</p><p>

</p></dd></dl>
<a name=3D"N-0289A0F1">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.8">11.8.8</a=
> Function <tt>disassemble</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(disassemble </tt><tt><i>function-name</i></tt><tt>)=20




<br>&nbsp;&nbsp;(disassemble </tt><tt><i>function</i></tt><tt>)=20




<br>&nbsp;&nbsp;(disassemble </tt><tt><i>compiled-expression</i></tt><tt>)=
=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289A0F1">disassemb=
le</a></tt>
function presents a disassembly listing of the virtual machine
code of a compiled function or form. It also presents the literal data
contained in that compiled object in a tabular form which is readily
cross-referenced with the disassembly listing.
</p><p>
If the argument is a
<tt><i>function-name</i></tt>
then the function object is retrieved from the binding indicated
by the name, in the global namespace. That object is then treated
as if it were the
<tt><i>function</i></tt>
argument.
</p><p>
A
<tt><i>function</i></tt>
argument is one that is a function object. Only compiled virtual machine
functions can be disassembled; other kinds of functions are rejected by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289A0F1">disassemb=
le</a></tt>.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289A0F1">disassemb=
le</a></tt>
function will also process the
<tt><i>complied-expression</i></tt>
object that is returned by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
function.
</p><p>
In the case of
<tt><i>function</i></tt>,
the entire compiled form containing
<tt><i>function</i></tt>
is disassembled. That form usually contains code which is external
to the function, even possibly other functions.
The disassembly listing indicates the entry point in the code
block where the execution of
<tt><i>function</i></tt>
begins.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0289A0F1">disassemb=
le</a></tt>
function returns its argument.
</p><p>

</p></dd></dl>
<a name=3D"N-02FE7607">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-11.8.9">11.8.9</a=
> Function <tt>dump-compiled-objects</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(dump-compiled-objects </tt><tt><i>stream</i></tt><tt> </tt=
><tt><i>object</i></tt><tt>*)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FE7607">dump-comp=
iled-objects</a></tt>
function writes compiled objects into
<tt><i>stream</i></tt>
in the same format as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>
function.
</p><p>
Unlike under
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211BE68">compile-f=
ile</a></tt>,
the output is written into an arbitrary stream rather than a named file.
The objects aren't specified by the to-be-compiled syntax processed from a
source file, but rather as zero or more arguments which specify objects tha=
t
are already compiled.
</p><p>
Each
<tt><i>object</i></tt>
must be be one of three kinds of values:
</p><dl class=3D"indent">

<dl class=3D"items">
<dt>1.</dt><dd>
a virtual machine description object returned by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00DE8B13">compile-t=
oplevel</a></tt>
function; or
</dd><dt>2.</dt><dd>
a compiled function object, satisfying the function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B99FC5">vm-fun-p<=
/a></tt>;
or else
</dd><dt>3.</dt><dd>
the name of a compiled function object, which may take any of the
forms suitable as arguments to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>
function.
</dd></dl>
</dl>

First,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FE7607">dump-comp=
iled-objects</a></tt>
writes some preamble information into
<tt><i>stream</i></tt>.
Then, for each
<tt><i>object</i></tt>
that is not already a virtual machine description, its corresponding
virtual machine description is retrieved. The virtual machine description
is converted into the externalized format required for the object format
and that externalized format is written into
<tt><i>stream</i></tt>.
The
<tt>object</tt>
argument are thus processed in left-to-right order.
<p>
If exactly one call to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FE7607">dump-comp=
iled-objects</a></tt>
is used to populate an initially empty file, and no other data are
written into the file, then that file is a valid compiled file.
If that file is processed by
<tt>load-file</tt>
then each of the externalized forms is converted to a virtual machine
description and executed.
</p><p>
Note that virtual machine descriptions are not functions. A function's
virtual machine description is the compiled version of the top-level form
whose evaluation produced that function.
</p><p>
For example, if the following top-level form is compiled and executed,
two functions are defined:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
3AF20B">let</a> ()
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a=
> a ())
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a=
> b ()))
</tt></pre><tt>

</tt>

<p>
Then, the following two expressions all have the same effect on
stream
<tt>s</tt>:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
FE7607">dump-compiled-objects</a> s 'a)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FE7607">dump-compi=
led-objects</a> s 'b)
</tt></pre><tt>

</tt>

<p>
Whether the
<tt>a</tt>
or
<tt>b</tt>
symbol is used to specify the object to be dumped, the same virtual machine
description is externalized and deposited into the stream. That machine
description, when loaded and executed, defines two functions.
</p><p>
</p></dd></dl>
<a name=3D"N-025AAA27">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12">12</a> INTERA=
CTIVE LISTENER</h2>




<p>


</p><p>
<a name=3D"N-01CE7F14">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.1">12.1</a=
> Overview</h3>



<p>


</p><p>
On some target platforms, <b>TXR</b> provides an interactive listener, whic=
h is
invoked using the
<tt>-i</tt>
command line option, or by executing
<tt>txr</tt>
with no arguments.  The interactive listener provides features like visual
editing of the command line, tab completion on <b>TXR Lisp</b> symbols, and=
 history
recall.
</p><p>
<a name=3D"N-02C3773D">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.2">12.2</a=
> Basic Operation</h3>



<p>


</p><p>
The interactive listener prints a numbered prompt.  The number in the promp=
t increments with every
command.  The first command line is numbered 1, the second one 2 and so for=
th.
</p><p>
The listener accepts input characters from the terminal. Characters are eit=
her
interpreted as editing commands or other special characters, or else are
inserted into the editing buffer. However, control characters which don't
correspond to commands are silently rejected.
</p><p>
The carriage return character generated by the Enter key indicates that a
complete line has been entered, and it is to be interpreted. The listener
parses the line as a <b>TXR Lisp</b> expression, evaluates it, and prints t=
he resulting
value. If the evaluation of the line throws an exception, the listener
intercepts the exception and prints information about it preceded by
two asterisks and a space. These asterisks distinguish an exception from a
result value.
</p><p>
If an empty line is entered, or a line containing only spaces, tabs
or embedded carriage returns or linefeeds, the prompt is repeated without
incrementing the number. Such a line is not entered into the history.
</p><p>
A line which only contains a <b>TXR Lisp</b> comment (optional spaces, tabs=
 or embedded
carriage returns or linefeeds, followed by a semicolon), also causes
the prompt to be repeated without incrementing the number. However,
such a line
<b>is</b>

entered into the history.
</p><p>
The listener does not allow lines containing certain bad syntax to be submi=
tted
with Enter.  If the buffer contains an expression with unbalanced parenthes=
es
or brackets, or unterminated literals, then Enter generates a newline chara=
cter
which is inserted into the buffer. In that situation, if that newline chara=
cter
is being added at the very end of the buffer, the listener flashes the
exclamation mark character (!) two times to warn the user that line has not
been submitted: no computation is taking place, and the listener is waiting=
 for
more input.  It is possible to force the submission of an unbalanced line u=
sing
the sequence Ctrl-X, Ctrl-F.
</p><p>
<a name=3D"N-0276C551">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.3">12.3</a=
> Limitations</h3>



<p>


</p><p>
The interactive listener can only accept up to 4095 abstract characters of
input in a single command line.
</p><p>
Though the edit buffer is referred as the "command line", it may contain
multi-line input. The carriage return characters which separate multiple li=
nes
count as one abstract character each, and are understood to occupy two disp=
lay
positions.
</p><p>
The command line must contain exactly one complete <b>TXR Lisp</b> expressi=
on, or a
comment. Multiple expressions will not be evaluated.
</p><p>
In multi-line mode, if the number of lines exceeds the number of lines
of the terminal display, the editing experience is adversely affected
in unspecified ways.
</p><p>
The screen updating logic in the listener is based on the assumption that
the display terminal uses ANSI emulation. No other terminal emulation
is supported. The
<tt>TERM</tt>
environment variable is ignored.
</p><p>
<a name=3D"N-03ABCB3A">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.4">12.4</a=
> Ways to Quit</h3>



<p>


</p><p>
Pressing Ctrl-D in a completely empty command line terminates the listener.
Another way to quit is to enter the
<tt>:quit</tt>
keyword symbol. When the form input into the listener consists of this symb=
ol,
the listener will terminate:
</p><p>
<tt>
</tt></p><pre><tt>  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-007C">+</a> 2 2)
  4
  2&gt; :quit
  os-shell $
</tt></pre><tt>

</tt>

<p>
Another way to terminate is to evaluate a call to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0006C92F">exit</a><=
/tt>
function. This method allows a termination status to be specified:
</p><p>
<tt>
</tt></p><pre><tt>  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-0006C92F">exit</a> 1)
  os-shell $
</tt></pre><tt>

</tt>

<p>
However, if a <b>TXR</b> interactive session is terminated this way, it wil=
l not
save the listener history.
</p><p>
Raising a fatal signal with the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0108FFCE">raise</a>=
</tt>
function is another way to quit:
</p><p>
<tt>
</tt></p><pre><tt>  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#N-0108FFCE">raise</a> sig-abrt)
  Aborted (core dumped)
  os-shell $
</tt></pre><tt>

</tt>

<p>
The previous remark about not saving the listener history applies here also=
.
</p><p>
<a name=3D"N-004659B6">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.5">12.5</a=
> Interrupting Evaluation</h3>



<p>


</p><p>
Ctrl-C typed while editing a command line is interpreted as an editing comm=
and
which causes that command line to be canceled. The listener prints the stri=
ng
<tt>"** intr"</tt>

and repeats the same prompt.
</p><p>
If a command line is submitted for evaluation, the evaluation might take
a long time or block for input. In these situations, typing Ctrl-C will iss=
ue
an interrupt signal. The listener has installed a handler for this signal w=
hich
generates an exception of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
which is caught by the listener. The exception's message is the string
<tt>"intr"</tt>

so that the listener ends up printing
<tt>"intr **"</tt>

like in the case of the Ctrl-C editing command. In this situation, though n=
ew
command line prompt is issued with an incremented number, and the exception
is recorded as a value.
</p><p>
<a name=3D"N-025B7305">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.6">12.6</a=
> Listener Variables</h3>



<p>


</p><p>

<a name=3D"N-03F9BE17">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.6.1">12.6.=
1</a> Variables <tt>*0</tt>, <tt>*1</tt>, <tt>*2</tt>, <tt>...</tt>, <tt>*9=
9</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The listener provides useful variables which allow commands to reference
the results of previous commands. As noted previously, the commands
are enumerated with an incrementing number. Each command's number, modulo 1=
00,
corresponds to one of the variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">*0</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">*1</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">*2</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">*99</a></=
tt>.
Thus, up to the previous hundred results can be referenced:
</p><p>
<tt>
</tt></p><pre><tt>  ...
  99&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2=
 2)  ;; stored in *99
  4
  100&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*<=
/a> 3 2) ;; stored in *0
  6
  101&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> =
*99 *0) ;; i.e. (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">=
+</a> 4 6)
  10
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-02B67C9B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.6.2">12.6.2</a=
> Symbol Macros <tt>*-1</tt>, <tt>*-2</tt>, <tt>...</tt>, <tt>*-20</tt></h4=
>



The listener provides small number of symbol macros for referencing the res=
ults of previous commands in a relative. The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B67C9B">*-1</a></=
tt>
refers to the value of the immediately previous command. The macro
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B67C9B">*-2</a></=
tt>
refers to the value of the command before that one and so on.
<p>
Note: each of these macros expands to a reference to the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE5A">*r</a></t=
t>
vector, according to the following pattern:
</p><p>
<tt>

<br>&nbsp;&nbsp;&nbsp;*-1&nbsp;&nbsp;--&gt;&nbsp;&nbsp;[<a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03A7AE5A">*r</a>&nbsp;(<a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#D-0076">mod</a>&nbsp;(<a href=3D"http://nong=
nu.org/txr/txr-manpage.html#D-0009">-</a>&nbsp;*v&nbsp;1)&nbsp;100)]
<br>&nbsp;&nbsp;&nbsp;*-2&nbsp;&nbsp;--&gt;&nbsp;&nbsp;[<a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#N-03A7AE5A">*r</a>&nbsp;(<a href=3D"http://n=
ongnu.org/txr/txr-manpage.html#D-0076">mod</a>&nbsp;(<a href=3D"http://nong=
nu.org/txr/txr-manpage.html#D-0009">-</a>&nbsp;*v&nbsp;2)&nbsp;100)]
<br>&nbsp;&nbsp;&nbsp;...
<br>&nbsp;&nbsp;&nbsp;*-20&nbsp;--&gt;&nbsp;&nbsp;[<a href=3D"http://nongnu=
.org/txr/txr-manpage.html#N-03A7AE5A">*r</a>&nbsp;(<a href=3D"http://nongnu=
.org/txr/txr-manpage.html#D-0076">mod</a>&nbsp;(<a href=3D"http://nongnu.or=
g/txr/txr-manpage.html#D-0009">-</a>&nbsp;*v&nbsp;20)&nbsp;100)]
</tt>

</p><p>

<a name=3D"N-02E7AE5A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.6.3">12.6.=
3</a> Variable <tt>*n</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The listener variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7AE5A">*n</a></t=
t>
evaluates to the current command line number: the number of the command in
which the variable occurs:
</p><p>
<tt>
</tt></p><pre><tt>  5&gt; *n
  5
  6&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a=
> 2 *n)
  12
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-0367AE5A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.6.4">12.6.4</a=
> Variable <tt>*v</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The listener variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0367AE5A">*v</a></t=
t>
evaluates to the current variable number: the command number modulo 100:
</p><p>
<tt>
</tt></p><pre><tt>  103&gt; *v
  3
  104&gt; *v
  4
</tt></pre><tt>

</tt>

<p>

</p></dd></dl>
<a name=3D"N-03A7AE5A">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.6.5">12.6.5</a=
> Variable <tt>*r</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The listener variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE5A">*r</a></t=
t>
evaluates to a hash table which associates variable numbers with command
results:
</p><p>
<tt>
</tt></p><pre><tt>  213&gt; 42
  42
  214&gt; [<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE5A">*r=
</a> 13]
  42
</tt></pre><tt>

</tt>

<p>
The result hash allows relative addressing. For instance the expression
<tt>[*r (mod (pred *v) 100)]</tt>
refers to the result of the previous command.
</p><p>
</p></dd></dl>
<a name=3D"N-0012B6FD">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.7">12.7</a> Ex=
ceptions</h3>



<p>


</p><p>
The interactive listener catches all exceptions. Each caught exception is
associated with the command's variable number, and stored as a value
in the appropriate listener variable as well as the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A7AE5A">*r</a></t=
t>
result hash. Exceptions are turned into values by creating a cons cell
whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0043">car</a></tt>
is the exception symbol and whose
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0069">cdr</a></tt>
holds the exception's arguments.
</p><p>
For each caught exception, a message
is printed beginning with the sequence
<tt>"** "</tt>.
Exactly how the message appears depends on the type and content of
the exception.
</p><p>
<a name=3D"N-03B0B055">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8">12.8</a=
> Editing</h3>



<p>


</p><p>
The following sections describe the interactive editing commands
available in the listener.
</p><p>
Terminals can often be configured with different choices of cursor
shape: such as a block-shaped cursor, an underline cursor or a
vertical line or "I-beam" cursor.  In the following sections, the
phrase "character under the cursor" refers to the character that is
currently covered by a block cursor, underlined by an underline cursor,
or that is immediately to the right of an I-beam cursor.
</p><p>
<a name=3D"N-00155DB7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.1">12.8.=
1</a> Move Left and Right</h4>


<p>
Moving within the line is achieved using the left and right arrow keys.  In
addition, Ctrl-B ("back") and Ctrl-F ("forward") perform this movement.
</p><p>
<a name=3D"N-0134A700">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.2">12.8.=
2</a> Jump to Beginning and End of Line</h4>


<p>
The Ctrl-A command moves to the beginning of the line. ("A" is the beginnin=
g
of the alphabet). The Ctrl-E ("end") command jumps to the end of the line,
such that the last character of the line is to the left of the cursor
position. On terminals which have the Home and End keys, these may also
be used instead of Ctrl-A and Ctrl-E.
</p><p>
In line mode, these commands move the cursor to the beginning or end of the
edit buffer.
</p><p>
In multi-line mode, if the cursor is not already at the beginning of a phys=
ical
line, then Ctrl-A moves it to the first character of the physical line.
Otherwise, Ctrl-A moves the cursor to the beginning of the edit buffer.
</p><p>
Similarly, in multi-line mode, if the cursor not already at the end of a
physical line, Ctrl-E moves it there. Otherwise, the cursor moves to the
end of the edit buffer.
</p><p>
<a name=3D"N-0108023E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.3">12.8.=
3</a> Jump to Matching Parenthesis</h4>


<p>
If the cursor is on an opening or closing parenthesis, brace or bracket,
the Ctrl-] command tries to jump to the matching character. The logic for
finding the matching character is identical to that of the Parenthesis Matc=
hing
feature. If no matching character is found, then no movement takes place.
</p><p>
If the cursor is not on an opening or closing parenthesis, brace or bracket=
,
then the closest such character is found. The cursor is moved to that chara=
cter
and then an attempt is made to jump to the matching one from that new
position.
</p><p>
If the cursor is equidistant to two such characters, then one of them
is chosen as follows. If the two characters are oriented in the same way (b=
oth
are opening and closing), then that one is chosen whose convex side faces t=
he
cursor position.  Thus, effectively, an inner enclosure is favored over an
outer one.  Otherwise, if the two characters have opposite orientation (one=
 is
opening and the other closing), then the one which is to the right of the
cursor position is chosen.
</p><p>
Note: the Ctrl-] character can be produced on some terminals using Ctrl-5
(using the keyboard home row 5, not the numeric keypad 5). This the same
key which produces the % character when Shift is used. The % character is
used in the Vi editor for parenthesis matching.
</p><p>
<a name=3D"N-01A79FD2">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.4">12.8.=
4</a> Character Swap</h4>


<p>
The Ctrl-T (twiddle) command exchanges the character under the cursor with =
the
previous character.
</p><p>
<a name=3D"N-0209E06D">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.5">12.8.=
5</a> Delete Character Left</h4>


<p>
The Backspace key erases the character to the left of the cursor, and moves=
 the
cursor to the position which that character occupied.
</p><p>
It doesn't matter whether this key generates ASCII
characters 8 (BS) or 127 (DEL): either one is acceptable. The Ctrl-H comman=
d
also performs the same action, since it corresponds to ASCII BS.
</p><p>
<a name=3D"N-00AFC48C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.6">12.8.=
6</a> Delete Character Right</h4>


<p>
The Ctrl-D command deletes the character under the cursor, if the cursor
is block-shaped, or to the right of the cursor if the cursor is an I-beam.
the cursor maintains its current character position relative to the
start of the line. In multi-line mode, if Ctrl-D is at the end of a line th=
at
is not the last line, it deletes the newline character, causing the
following line to be joined to the end of the current line.
If the cursor is at the end of the buffer, then Ctrl-D does nothing,
except if the buffer is completely empty, in which case it is a quit
indication.  The Delete key, if available on the terminal, is a near synony=
m of
Ctrl-D. It performs all the same functions, except that it does not
act as a quit indication; Delete has no effect  when the buffer is empty.
</p><p>
When a visual selection is in effect, then Ctrl-D and Del delete
that selection, and copy it to the clipboard.
</p><p>
<a name=3D"N-038DCC2F">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.7">12.8.=
7</a> Delete Word Left</h4>


<p>
The Ctrl-W ("word") command deletes the word to the left of the cursor
position. More precisely, this command first deletes any consecutive whites=
pace
characters (spaces or tabs) to the left of the cursor. Then, it deletes
consecutive non-whitespace characters. Material under the cursor or to the
right remains. The deleted material is copied into the clipboard.
</p><p>
<a name=3D"N-0282D0CB">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.8">12.8.=
8</a> Delete to Beginning of Line</h4>


<p>
The Ctrl-U ("undo typing") command is a "super backspace" operation: it del=
etes
all characters to the left of the cursor position. The cursor is moved to
the leftmost position. In multi-line mode, Ctrl-U deletes only to the begin=
ning of the current
physical line, not all the way to the first position of the buffer.
Ctrl-U copies the deleted material into the clipboard.
</p><p>
<a name=3D"N-0144183A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.9">12.8.=
9</a> Delete to End of Line</h4>


<p>
The Ctrl-K ("kill") command deletes the character under the cursor position
and all subsequent characters. The cursor position doesn't change.
In multi-line mode, Ctrl-K deletes only until the end of the current
physical line, not the entire buffer.
The material deleted by Ctrl-K is copied into the clipboard.
</p><p>
<a name=3D"N-03580D9E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.10">12.8=
.10</a> Verbatim Character Insert</h4>


<p>
The Ctrl-V ("verbatim") command places the listener's input editor into
a mode in which the next character is interpreted literally and inserted
into the line, even if that character is a special character such as Enter,
or a command character.
</p><p>
<a name=3D"N-0180B94A">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.11">12.8=
.11</a> Verbatim Insert Mode</h4>


The two-character sequence Ctrl-X, Ctrl-V ("extended verbatim", "super past=
e")
enters into an verbatim insert mode useful for entry of free-form text. It =
is
particularly useful in multi-line mode. In this mode, almost every characte=
r
is inserted verbatim, including Enter.  The only commands recognized are:
Ctrl-X, which terminates this mode, Backspace (both ASCII BS and DEL
variants) and arrow key navigation. Enter inserts a line break, which
appears as such in multi-line mode, or as
<tt>^M</tt>
in line mode.
<p>
<a name=3D"N-0323EE8E">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.12">12.8=
.12</a> Delete Current Line</h4>


<p>
The Ctrl-X, Ctrl-K command sequence may be used in multi-line mode
to delete the entire physical line under the cursor. Any lines below that
line move up to close the gap. In line mode, the command has no effect,
other than canceling select mode.  The deleted line, including the
terminating newline character, if it has one, is copied into the
clipboard.
</p><p>
<a name=3D"N-017651D8">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.13">12.8=
.13</a> History Recall</h4>


<p>
By default, the most recent 500 lines submitted to the interactive listener=
 are
remembered in a history.  This history is available for recall, making it
convenient to repair mistakes, or compose new lines which are based on prev=
ious
lines.  Note that the the history suppresses consecutive duplicate lines.
The number of lines retained may be customized using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B676F">*listener=
-hist-len*</a></tt>
variable.
</p><p>
If the up arrow is used while editing a line, the contents of the line are
placed into a temporary save area.  The line display is then updated to
show the most recent line of history.  Using the up arrow key additional ti=
mes
will recall successively less recent lines.
</p><p>
The down arrow key navigates in the opposite direction: from older lines to
newer lines. When the down arrow key is invoked on the most recent history =
line,
then the current line is restored from the temporary save area.
</p><p>
Instead of the up and down arrow keys, the commands Ctrl-P ("previous")
and Ctrl-N ("next") may be used.
</p><p>
If the Enter key is pressed while a recalled history line is showing, then =
that
line will be submitted as if it were a newly composed line.  The originally
edited line which had been placed in the save area is discarded.
</p><p>
When a recalled line is showing, it may be edited. There are two important
behaviors to note here. If a recalled history line is edited, and then the
up/down arrow keys or a navigation command is used to show a different
history line, or to restore the original current line, then the edit is mad=
e
permanent: the edited line replaces its original version in the same
position in the history.  This feature allows corrections to be made to the
history.
</p><p>
The edit is recorded in the line's undo history as a single change; if the
edited line is visited again, then a single Ctrl-O command will revert all =
the
edits that were made.
</p><p>
However, if a recalled line is edited and submitted without navigating to
another line, then it is submitted as a newly composed line, without replac=
ing
the original in the history.
</p><p>
Each submitted line is entered into the history, if it is different
from the most recent line already in history. This is true whether it
is a freshly composed line, a recalled history line, or an edited
history line.
</p><p>
<a name=3D"N-01863EEC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.14">12.8=
.14</a> History Search</h4>


It is possible to search backwards through the history interactively
for a line containing a substring. The Ctrl-R command is used to initiate
search.  The command prompt is replaced with the prefix
<tt>search:</tt>
next to which a pair of empty square brackets appears, indicating
that the listener is in search mode. The square brackets are the
search box, enclosing the search text, which is initially empty.
<p>
In search mode, characters may be typed. They accumulate inside the search
box, and constitute the string to search for. The listener instantly
navigates to the most recent line which contains a substring match for the
search string, and places the cursor on the first character of the
match. Control characters entered directly are ignored. The Ctrl-V command =
be
used to add a character verbatim, as in edit mode.
</p><p>
To remove characters from the search box, Backspace can be used. The
search is not repeated with the shortened search text: the same line
continues to show until a character is added, at which point
a new search is issued.
</p><p>
Search mode has a "home position": a starting point for searches.
The initial home position is whatever line of history is selected
when search mode is initiated. Searches work backward in history from
that line. If search text is edited by deleting characters and then
adding new ones, the new search proceeds from the home position.
</p><p>
The Ctrl-R command can be used in search mode. It registers the currently
showing line as the new home position, and then repeats the search using th=
e
existing search text backwards from the new position. If the search text
is empty, Ctrl-R has no effect.
</p><p>
The Ctrl-C command leaves search mode at any time and causes the
listener to resume editing the original input at the original character
position. The Enter key accepts the result of a search and submits it
as if it were a newly composed line.
</p><p>
Navigation and editing keys may be used in search mode. A navigation or edi=
ting
key immediately cancels search mode, and is processed in edit mode, using
whatever line was located by the search, at the matching character position=
.
</p><p>
The Ctrl-L (Clear Screen and Refresh), as well as Ctrl-Z
(Suspend to Background) commands are available in search mode. Their effect=
s
takes place without leaving search mode.
</p><p>
Navigating to a history line manually using the up and down arrow keys (or
Ctrl-P/Ctrl-N) has the same net effect same as locating that line using
Ctrl-R search.
</p><p>
<a name=3D"N-02204D0C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.15">12.8=
.15</a> Submit and Stay in History</h4>


<p>
Normally when the Enter key is used on a recalled history line,
the next time the listener is re-entered, it jumps back to the
newest history position where a new line is about to be composed.
</p><p>
The alternative command sequence Ctrl-X, Enter provides a useful alternativ=
e
behavior. After the submitted line is processed, the listener doesn't jump =
to
the newest history position. Instead, it stays in the history, advancing
forward by one position to the successor of the submitted line.
</p><p>
Ctrl-X, Enter can be used to conveniently submit a range of lines
from the history, one by one, in their original order.
</p><p>
<a name=3D"N-023F7AE6">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.16">12.8=
.16</a> Insert Previous Word</h4>


<p>
The equivalent command sequences Ctrl-X, w and Ctrl-X, Ctrl-W insert
a word from the previous line at the cursor position. A word is defined
as a sequence of non-whitespace characters, separated from other words
by whitespace. By default, the last word of the previous line is inserted.
Between the Ctrl-X and Ctrl-W or w, a decimal number can be entered.
The number 1 specifies that the last word is to be inserted, 2 specifies
the second last word, 3 the third word from the right and so on.
Only the most recent three decimal digits are retained, so the number can r=
ange
from 0 to 999. A value of 0, or a value which exceeds the number of words
causes the Ctrl-W or w to do nothing. Note that "previous line" means
relative to the current location in the history. If the 42nd most recent
history line is currently recalled, this command takes material from the 43=
rd
history line.
</p><p>
<a name=3D"N-023EEEBF">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.17">12.8=
.17</a> Insert Previous Atom</h4>


<p>
The equivalent command sequences Ctrl-X, a and Ctrl-X, Ctrl-A insert
an atom from the previous line at the cursor position. A line only
makes atoms available if it expresses a valid <b>TXR</b> form, free of synt=
ax
errors. A line containing only whitespace or a comment makes no atoms
available. For the purposes of this editing feature, an atom is defined
as the printed representation of a Lisp atom taken from the Lisp form
specified in the previous line. The line is flattened into atoms
as if by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FF2F12">flatcar</=
a></tt>
function. By default, the last atom is extracted. A numeric argument
typed between the Ctrl-X and Ctrl-A or a can be used to select a
atoms by position from the end. The number 1 specifies the last atom,
2 the second last and so on.
Only the most recent three decimal digits are retained, so the number can r=
ange
from 0 to 999. A value of 0, or a value which exceeds the number of words
causes the Ctrl-A or a to do nothing.  Note that "previous line"
has the same meaning as for the Ctrl-X, Ctrl-W (insert previous word) comma=
nd.
</p><p>
<a name=3D"N-023F0BA7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.18">12.8=
.18</a> Insert Previous Line</h4>


<p>
The command sequences Ctrl-X, Ctrl-R ("repeat") and Ctrl-X, r, which are
equivalent, insert an entire line of history into the current buffer. By
default, the previous line is inserted. A less recent line can be selected =
by
typing a numeric argument between the Ctrl-X and the Ctrl-R/r. The immediat=
ely
previous history line is numbered 1, the one before it 2 and so on.
If this command is used during history navigation, it references previous
lines relative to the currently recalled history line.
</p><p>
<a name=3D"N-03A78033">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.19">12.8=
.19</a> Symbolic Completion</h4>


<p>
If the Tab key is pressed while editing a line, it is interpreted as a
request for completion. There is a second completion command: the
sequence Ctrl-X Tab.
</p><p>
When completion is invoked with Tab or Ctrl-X Tab, the listener looks at a =
few
of the trailing characters to the left of the cursor position to determine =
the
applicable list of completions. Completions are determined from among the <=
b>TXR Lisp</b> symbols which have
global variable, function, macro and symbolic macro bindings, as well
as the static and instance slots of structures.  Symbols which
have operator bindings are also taken into consideration.  If a
package-qualified symbol is completed, then completion is restricted to tha=
t
package. Keyword symbol completion is restricted to the contents of the key=
word
package. The namespaces which are searched for symbols are restricted accor=
ding
to preceding character syntax. For instance if the characters
<tt>.(</tt>
or
<tt>.[</tt>
immediately precede the prefix, then only those symbols are considered
which are methods: that is, each is the static slot of at least one structu=
re,
in which that static slots holds a function.
</p><p>
The difference between Tab and Ctrl-X Tab is that Tab completion looks only=
 for
prefix matches among the eligible identifiers. Thus it is a pure completion=
 in
the sense that it suggests additional material that may follow what has bee=
n
typed. If the buffer contains
<tt>(list</tt>
it will only suggest completions which can be endings for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
such as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03593DE9">list*</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">listp</a>=
</tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0236023D">list-str<=
/a></tt>.
It will not suggest identifiers which rewrite the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>
prefix.  By contrast, the Ctrl-X Tab completion suggests not only pure
completions but also alternatives to the partial identifier, by looking for
substring matches. For instance
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006ED237">copy-list=
</a></tt>
is a possible completion for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a><=
/tt>,
as is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F70343">proper-li=
st-p</a></tt>.
</p><p>
If no completions are found, then the BEL character is sent to the terminal
to generate a beep or a visual alert indication. The listener returns to
editing mode.
</p><p>
If completions are found, listener enters into completion selection mode.
The first available completion is placed into the line as if it had been ty=
ped
in.  The other completions may be viewed one by one using the Tab key.
(Note that the Ctrl-X is not used, only Tab, even if completion mode had be=
en
entered via Ctrl-X Tab).
When the completions are exhausted, the original uncompleted line is shown
again, and Tab can continue to be used to cycle through the completions aga=
in.
In completion mode, the Ctrl-C character acts as a command to cancel comple=
tion mode
and return to editing the original uncompleted line. Any other input charac=
ter causes
the listener to keep the currently shown completion, and return to edit mod=
e,
where that character is immediately processed as if it had been typed in
edit mode.
</p><p>
<a name=3D"N-01FD5995">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.20">12.8=
.20</a> Edit with External Editor</h4>


<p>
The two character command Ctrl-X, Ctrl-E launches an external editor to
edit the current command line. The command line is stored in a temporary
file first, and the editor is invoked on this file. When the editor
terminates, the file is read into the editing buffer.
</p><p>
The editor is determined from the
<tt>EDITOR</tt>
environment variable. If this variable doesn't exist,
the command does nothing.
</p><p>
The temporary file is created in the home directory, if that can
be determined. Otherwise it is created in the current working directory. If=
 the
creation of the file fails, then the command silently returns to edit mode.
The home directory is determined from the
<tt>HOME</tt>
environment variable in POSIX environments. On MS Windows, the
<tt>USERPROFILE</tt>
variable is probed for the user's directory.
</p><p>
If the command line contains embedded carriage returns (which denote
line breaks in multi-line mode) these are replaced with newline characters
when written out to the file. Conversely, when the edited file is read
back, its newlines are converted to carriage returns, so that multi-line
content is handled properly. (See the following section, Multi-Line Mode).
</p><p>
<a name=3D"N-029FCC15">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.8.21">12.8=
.21</a> Undo Editing</h4>


<p>
The listener provides an undo feature.  The Ctrl-O command ("old", "oops")
restores the edit buffer contents and cursor position to a previous state.
</p><p>
There is a single undo history which records up the 200 most recent edit
states. However, the states are associated with history lines, so that it
appears that each line has its own, independent undo history.
Undoing the edits in one line has no effect on the undo history of another
line.
</p><p>
Undo also records edits for lines that have been canceled with Ctrl-C, and =
are
not entered into the history, making it possible to recall canceled lines.
</p><p>
The undo history is lost when <b>TXR</b> terminates.
</p><p>
Undo doesn't save and restore previous contents of the clipboard buffer.
</p><p>
There is no redo. When undo removes an edit to restore to a prior edit stat=
e,
the removed edit is permanently discarded.
</p><p>
Note that if undo is invoked on a historic line, each undo step updates tha=
t
history entry instantly to the restored state, not only the visible edit
buffer. This is in contrast to the way new edits work. New edits are not
committed to history until navigation takes place to a different history li=
ne.
</p><p>
Also note that when new edits are performed on a historic line and it is
submitted with Enter without navigating to another line, the undo informati=
on
for those edits is retained, and belongs to the newly submitted line.  The
historic line hasn't actually been modified, and so it has no new undo
information.  However, if a historic line is edited, and then navigation ta=
kes
place to a different historic line, then the undo information is committed =
to
that line, because the modifications to the line have been placed back
in the history entry.
</p><p>
<a name=3D"N-02B77626">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9">12.9</a=
> Visual Selection Mode</h3>



<p>


</p><p>
The interactive listener supports visual copy and paste operation.
Text may be visually selected for copying into a clipboard or
or for deletion. In visual selection mode, the actions of some editing
commands are modified so that they act upon the selection instead
of their usual target, or upon both the target and the selection.
</p><p>
<a name=3D"N-00E677F3">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.1">12.9.=
1</a> Making a Selection</h4>


<p>
The Ctrl-S command enters into visual selection mode and marks the
starting point of the selection, which is considered the position
immediately to the left of the current character.
</p><p>
While in visual selection mode, it is possible to move around using
the usual movement commands. The ending point of the selection
tracks the movement.
</p><p>
The selected text is displayed in reverse video.
</p><p>
Typing Ctrl-S again while in visual selection mode cancels
the mode.
</p><p>
Tab completion, history navigation, history search and editing in an extern=
al
editor all cancel visual selection mode.
</p><p>
By default, the the selection excludes the character which lies to the righ=
t of
the rightmost end-point.  Thus, the selection simply consists of the text
between these two positions, whether or not they are reversed. This style o=
f
selection pairs excellently with an I-beam style cursor, and has clear
semantics. The end-points are referenced to the positions between the
characters, and everything between them is selected.
</p><p>
The selection behavior may be altered using the Boolean configuration varia=
ble
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E4924F">*listener=
-sel-inclusive-p*</a></tt>.
This variable is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
by default. If it is changed to true, then the selection includes the
character to the right of the rightmost endpoint, if there is such a
character within the current line.  This style of selection
pair well with a block-shaped cursor. It creates the apparent semantics tha=
t
the end-points of the election are characters, rather than points
between characters, and that these characters are included in the selection=
.
</p><p>
<a name=3D"N-00E05BF0">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.2">12.9.=
2</a> Selection Endpoint Toggle</h4>


<p>
In visual selection, the starting point of the selection remains fixed, whi=
le
the ending point tracks the movement of the cursor. The Ctrl-^ command will
exchange the two points. The effect is that the cursor jumps to the opposit=
e
end of the selection. That end is now the ending point which tracks the cur=
sor
movement.
</p><p>
<a name=3D"N-03FBE514">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.3">12.9.=
3</a> Visual Copy</h4>


<p>
The Ctrl-Y command ("yank") copies the selected text into a clipboard buffe=
r.
The previous contents of the clipboard buffer, if any, are discarded.
</p><p>
Unlike the history, the clipboard buffer is not persisted.
If <b>TXR</b> terminates, it is lost.
</p><p>
<a name=3D"N-037FBEEE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.4">12.9.=
4</a> Visual Cut</h4>


<p>
If the Ctrl-D command is invoked while a selection is in effect, then
instead of deleting the character under the cursor, it deletes the
selection, and copies it to the clipboard. The Delete key has the same
effect.
</p><p>
Ctrl-D and Del have no effect on the clipboard when visual selection is not=
 in
effect, and they operate on just one character.
</p><p>
<a name=3D"N-0270B8E7">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.5">12.9.=
5</a> Clipboard Paste</h4>


<p>
The Ctrl-Q command ("quote the clipboard") inserts text from the clipboard
at the current cursor position. The cursor position is updated to
be immediately after the inserted text.  The clipboard text remains availab=
le
for further pasting.
</p><p>
If nothing has been yet been copied to the clipboard in the current
session, then this command has no effect.
</p><p>
<a name=3D"N-028048CE">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.6">12.9.=
6</a> Clipboard Swap Paste</h4>


<p>
The Ctrl-X, Ctrl-Q command sequence ("exchange quote") exchanges the
selected text with the contents of the clipboard. The selection is
copied into the clipboard as if by Ctrl-Y and replaced by the
previous contents of the clipboard.
</p><p>
If the clipboard has not yet been used in the current session,
</p><p>
If nothing has been yet been copied to the clipboard in the current
session, then this command behaves like Ctrl-Y:
text is yanked into the clipboard, but not deleted.
</p><p>
<a name=3D"N-00F08526">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.7">12.9.=
7</a> Visual Replace</h4>


<p>
In visual selection mode, an editing commands may be used which insert new
text, or a character may be typed in order to insert it. When this happens,=
 the
selection is first deleted and visual mode is canceled. Then the insertion
takes place and visual mode is canceled. The effect is that the newly inser=
ted
text replaces the selected text.
</p><p>
This applies to the Clipboard Paste (Ctrl-Q) command also. If a
selection is effect when Ctrl-Q is invoked, the selected text
is replaced with the clipboard buffer contents.
</p><p>
When a selection is replaced in this manner, the contents
of the clipboard are unaffected.
</p><p>
<a name=3D"N-01780CEC">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.9.8">12.9.=
8</a> Delete in Selection Mode</h4>


<p>
In visual mode, it is possible to issue commands which delete text.
</p><p>
One such command is Ctrl-D. Its special behavior in selection mode,
Visual Cut, is described above.
</p><p>
The Backspace key and Ctrl-H also have a special behavior in select mode. I=
f
the cursor is at the rightmost endpoint of the selection, then these comman=
ds
delete the selection and nothing else.  If the cursor is at the leftmost
endpoint of the selection, then these commands delete the selection, and ta=
ke
their usual effect of deleting a character also.  In both cases, selection =
mode
is canceled. The clipboard is not affected.
</p><p>
The Ctrl-W command for deleting the previous word, when used in visual
selection mode, deletes the selection and cancels selection mode,
and then deletes the word before the selection. Only the deleted
selection is copied into the clipboard, not the deleted word.
</p><p>
All other deletion commands such as Ctrl-K simply cancel visual
selection mode and take their usual effect.
</p><p>
<a name=3D"N-00E041A0">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.10">12.10<=
/a> Multi-Line Mode</h3>



<p>


</p><p>
The listener operates in one of two modes: line mode and multi-line mode.
This is determined by the special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C5CACF">*listener=
-multi-line-p*</a></tt>
whose default value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>
(multi-line mode).  It is possible to toggle between
line mode and multi-line mode using the Ctrl-J command.
</p><p>
In line mode, all input given to a single prompt appears to be on a single
line. When the line becomes longer than the screen width, it scrolls
horizontally.   In line mode, carriage return characters embedded in a line
are displayed as
<tt>^M</tt>.
</p><p>
In multi-line mode, when the input exceeds the screen width, it simply wrap=
s to
take up additional lines rather than scrolling horizontally. Furthermore,
multi-line mode not only wraps long lines of input onto multiple lines of
the display, but also supports true multi-line input. In multi-line
mode, carriage return characters embedded in input are treated as line
breaks rather than being rendered as
<tt>^M</tt>.
</p><p>
Because carriage returns are not line terminators in text files,
lines which contain embedded carriage returns are correctly saved
into and retrieved from the persistent history file.
</p><p>
When Enter is typed in multi-line mode, the listener tries to determine whe=
ther
the current input, taken as a whole, is an incomplete expression which requ=
ires
closing punctuation for elements like compound expressions and string liter=
als.
</p><p>
If the input appears incomplete, then the Enter is inserted verbatim at
the current cursor position, rather than signaling that the line is
being submitted for evaluation. The Ctrl-X, Enter command sequence also has
this behavior.
</p><p>
<a name=3D"N-0077CFA3">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.11">12.11<=
/a> Reading Forms Directly from the Terminal</h3>



<p>


</p><p>
In addition to multi-line mode, the listener provides support
for directly parsing input from the terminal, suitable for processing
large amounts of pasted material.
</p><p>
If the
<tt>:read</tt>
keyword is entered into the listener, it will temporarily suspend
interactive editing and allow the <b>TXR Lisp</b> parser to read
directly from standard input. The reading stops when an error occurs,
or EOF is indicated by entering Ctrl-D.
</p><p>
In direct parsing mode, each expression which is read is evaluated, but its
value is not printed. However, the value of the last form evaluated is retu=
rned
to the interactive listener, which prints the value and accepts it as if
it as the result value of the
<tt>:read</tt>
command.
</p><p>
Note that none of the material read from the terminal is entered into the
interactive history. Only the
<tt>:read</tt>
command which triggers this parsing mode appears in the history.
</p><p>
<a name=3D"N-013F32E9">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.12">12.12<=
/a> Clear Screen and Refresh</h3>



<p>


</p><p>
The Ctrl-L command clears the screen and re-draws the line being edited.
This is useful when the display is disturbed by the output of some
background process, or serial line noise.
</p><p>
<a name=3D"N-02C789B1">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.13">12.13<=
/a> Suspend to Background</h3>



<p>


</p><p>
The Ctrl-Z ("Zzzz... (sleep)") command causes <b>TXR</b> to be placed into =
the
background in a suspended, and control returned to the system shell.
</p><p>
Bringing the suspended <b>TXR</b> back into the foreground is achieved with=
 a shell
job-control command such as the
<tt>fg</tt>
command in GNU Bash.
</p><p>
When <b>TXR</b> is resumed, the interactive listener will re-display the ed=
ited
line and restore the previous cursor position.
</p><p>
Making full use of this feature requires a POSIX job control shell,
in the sense that without job control support in the shell, there may not b=
e a
way to restore <b>TXR</b> into the terminal session's foreground, causing t=
he
user to lose interactive control over that <b>TXR</b> instance.
</p><p>
<a name=3D"N-0182AD71">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.14">12.14<=
/a> Editing Help</h3>



<p>


</p><p>
The Ctrl-X ? command shows a summary of commands, in a four-line
display which temporarily replaces the editing area. The help text
is divided into several pages. Ctrl-C dismisses the display, and
returns to editing. The Ctrl-P, left arrow and up arrow keys return
to the previous screen. The Ctrl-Z and Ctrl-L commands are available,
having their usual meaning of suspending and refreshing the display.
Any other key advances to the next screen.
Advancing from the last screen, dismisses the display, and returns
to editing. Navigating to the previous screen when the first screen
is being shown also dismisses the display and returns to editing.
</p><p>
<a name=3D"N-02CF4979">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.15">12.15<=
/a> Print the Prompt</h3>



<p>


</p><p>
The
<tt>:prompt</tt>
command prints the current prompt, followed by a newline, without
incrementing the prompt number. The
<tt>:p</tt>
command prints just the current prompt number, followed by a newline,
without incrementing the number.
</p><p>
These comments are useful in plain mode, in which no prompts are
printed. See Plain Mode below.
</p><p>
<a name=3D"N-0005EA45">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.16">12.16<=
/a> Plain Mode</h3>



<p>


</p><p>
When the input device isn't an interactive terminal, or if the
<tt>-n</tt>
or
<tt>--noninteractive</tt>
command line operations are used when invoking <b>TXR</b>,
the listener operates in
<i>plain mode</i>.

It reads input without providing any editing features: no completion,
history recall, selection, or copy and paste.  Only the line editing
features provided by the operating system are available.
No prompts appear; however, there is still an incrementing counter,
and the numbered variables
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">*1</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">*2</a></t=
t>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-005F">...</a></tt>
for accessing evaluation results are established.
Lines are still entered into the history, and the interactive profile
is still processed, as usual.
</p><p>
<a name=3D"N-03C0E452">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.17">12.17<=
/a> Interactive Profile File</h3>



<p>


</p><p>
When the listener starts up, it looks for file called
<tt>.txr_profile</tt>
in the user's home directory, as determined by the
<tt>HOME</tt>
environment variable in POSIX environments or the
<tt>USERPROFILE</tt>
environment variable on MS Windows. If that variable doesn't exist, no furt=
her
attempt is made to locate this file.
</p><p>
If the file exists, it is subject to a security check.
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B3F844">path-priv=
ate-to-me-p</a></tt>
is applied to the file. If it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
then an error message is displayed and the file is not loaded.
</p><p>
If the file passes the security check, it is expected to be readable and
to contain
<b>TXR Lisp</b> forms, which are read and evaluated.
Syntax errors encountered while reading the profile file are displayed
on standard output, and any exceptions thrown that are derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
are caught and displayed.  The interactive listener starts in spite of thes=
e
situations.  Exceptions not derived from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
will terminate the process.
</p><p>
The profile file is not read by non-interactive invocations of <b>TXR</b>:
that is, when the
<tt>-i</tt>
option isn't present.
</p><p>
<a name=3D"N-01E869EB">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.18">12.18<=
/a> History Persistence</h3>



<p>


</p><p>
The history is maintained in a text file called
<tt>.txr_history</tt>
in the user's home directory. Whenever the interactive listener terminates,
this file is updated with the history contents stored in the listener's
memory.  The next time the listener starts, it first re-loads the history f=
rom
this file, making the most recent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B676F">*listener=
-hist-len*</a></tt>
expressions of a previous session available for recall.
</p><p>
The history file is maintained in a way that is somewhat
robust against the loss of history arising from the situation that a user
manages multiple simultaneous <b>TXR</b> sessions.  When a session terminat=
es, it
doesn't blindly overwrite the history file, which may have already been upd=
ated
with new history produced by another session.  Rather, it appends new entri=
es
to the history file. New entries are those that had not been previously rea=
d
from the history file, but have been newly entered into the listener.
</p><p>
An effort is made to keep the history file trimmed to no more than
twice the number of entries specified in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B676F">*listener=
-hist-len*</a></tt>.
The terminating session first makes a temporary copy of the existing
history, which is trimmed to the most recent
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-007B676F">*listener=
-hist-len*</a></tt>
entries. New entries are then appended to this temporary file.
Finally, the actual history file is replaced with this temporary file by a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-016EF40C">rename-pa=
th</a></tt>
a rename operation. This algorithm doesn't use locking, and is therefore no=
t
robust against the situation when a two or more multiple interactive <b>TXR=
</b>sessions belonging to the same user terminate at around the same time.
</p><p>
The home directory is determined from the
contents of the
<tt>HOME</tt>
environment variable in POSIX environments or
<tt>USERPROFILE</tt>
on MS Windows. If this variable doesn't exist, or the user doesn't
have permissions to write to this directory or to an existing history file
in that directory, then the history isn't saved.
</p><p>
It is possible to save the history without terminating the interactive
session, using the
<tt>:save</tt>
command. This saves the history in the manner described above.
Each invocation of
<tt>:save</tt>
only adds to the history file new input since the most recent
<tt>:save</tt>
command.
</p><p>
<a name=3D"N-004A414D">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.19">12.19<=
/a> Parenthesis Matching</h3>



<p>


</p><p>
A feature of the listener is visual parenthesis matching in the form of a
brief forward or backward jump of the cursor.  This provides a hint to the =
programmer,
helping to prevent avoid parenthesis balancing errors.
</p><p>
When any of the three closing characters
<tt>)</tt>,
<tt>]</tt>
or
<tt>}</tt>
is inserted, the listener scans backward for the matching opening
character. Likewise, if any of the three opening characters
<tt>(</tt>,
<tt>[</tt>
or
<tt>{</tt>
is inserted in the middle of text, the listener scans forward for the match=
ing
closing character.
</p><p>
If the matching character is found, the cursor jumps to that
character and then returns to the original position a brief moment later. I=
f a
new character is typed during the brief time delay, the delay is immediatel=
y
canceled, so as not to hinder rapid typing.
</p><p>
This back-and-forth jump behavior also occurs when a character is erased us=
ing
Backspace, and the the cursor ends up immediately to the right of a
parenthesis.
</p><p>
Note that the matching is unsophisticated; it doesn't observe the
lexical conventions and syntax of the <b>TXR Lisp</b> programming language.=
  For
instance, a closing parenthesis outside a string literal may match
match an opening one inside a string literal.
</p><p>
<a name=3D"N-02B1BA73">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20">12.20<=
/a> Listener Configuration Variables</h3>



<p>


</p><p>
The listener's behavior can be influenced through values of certain
global variables. The settings can be made persistent by means
of setting these variables in the interactive profile file.
</p><p>

<a name=3D"N-007B676F">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20.1">12.2=
0.1</a> Special variable <tt>*listener-hist-len*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This special variable determines how many lines of history are
retained by the listener. Changing this variable from within the listener
has an instant effect. If the number is reduced from its current value,
history lines are immediately discarded. The default value is 500.
</p><p>

</p></dd></dl>
<a name=3D"N-02C5CACF">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20.2">12.20.2<=
/a> Special variable <tt>*listener-multi-line-p*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This is a Boolean variable which indicates whether the listener is
in multi-line mode. The default value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
</p><p>
Changing this variable from within the listener takes effect
immediately for the next line of input.
</p><p>
If multi-line mode is toggled interactively from within the listener,
the variable is updated to reflect the latest state. This happens
when the command is submitted for evaluation.
</p><p>

</p></dd></dl>
<a name=3D"N-02E4924F">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20.3">12.20.3<=
/a> Special variable <tt>*listener-sel-inclusive-p*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This Boolean variable controls the behavior of visual selection.
It is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
by default.
</p><p>
A visual selection is determined by end-points, which are abstract position=
s
understood as being between characters. When a visual selection begins,
it marks an end-point immediately to the left of a block-shaped cursor,
or precisely at the in-between position of an I-beam cursor.
The end of the visual selection is similarly determined from the ending
cursor position. The selection consists of those characters which lie
between these positions. This style of selection pairs well with an I-beam
style cursor shape.
</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E4924F">*listener=
-sel-inclusive-p*</a></tt>
variable is set true, then the selection also includes one more
character to the right of the rightmost endpoint, if there is
such a character within the current line, giving rise to the appearance
that the selection is determined by the starting and ending character,
and includes them. This type of selection pairs well with a block-shaped
cursor.
</p><p>

</p></dd></dl>
<a name=3D"N-01E7ACFE">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20.4">12.20.4<=
/a> Special variable <tt>*listener-pprint-p*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



This Boolean variable controls how the listener prints the results
of evaluations.
It is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
by default.
</p><p>
When the variable is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
the evaluation result of each line entered into the listener is printed
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">prinl</a>=
</tt>
function. Thus values are rendered in a machine-readable syntax, ensuing
read/print consistency.
</p><p>
If the variable is set true, the evaluation result of each line is printed
using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">pprinl</a=
></tt>
function.
</p><p>

</p></dd></dl>
<a name=3D"N-002B819C">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20.5">12.20.5<=
/a> Special variable <tt>*listener-greedy-eval-p*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002B819C">*listener=
-greedy-eval-p*</a></tt>
controls whether or not a "greedy evaluation" feature is enabled
in the listener. The default value is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
disabling the feature.
</p><p>
Greedy evaluation means that after the listener evaluates an expression
successfully and prints its value, it then checks whether that value is
an expression that may be further subject to non-trivial evaluation.
If so, it evaluates that expression, and prints the resulting value.
The process is then repeated with the resulting value. It keeps repeating u=
ntil
evaluation throws an error, or produces a self-evaluating object.
</p><p>
These additional evaluations are performed in such a way that all warnings =
are
suppressed and all other exceptions are intercepted.
</p><p>
Greedy evaluation doesn't affect the state of the listener.
Only the original expression is entered into the
history. Only the value of the original expression is saved in the result h=
ash
or a numbered variable.  The command line number
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E7AE5A">*n</a></t=
t>
is incremented by one. The additional evaluations are only performed for
the purpose of producing useful output. The evaluations may
have side effects.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
<tt>
</tt></p><pre><tt>  1&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.htm=
l#D-002F">set</a> *listener-greedy-eval-p* t)
  t
  2&gt; 'a
  a
  3&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defv=
ar</a> b 2)
  b
  2
  4&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defv=
ar</a> c '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> =
2 2))
  c
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2)
  4
  5&gt; (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defv=
ar</a> d '(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">li=
st</a> '+ 2 2))
  d
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> '=
+ 2 2)
  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007C">+</a> 2 2)
  4
</tt></pre><tt>

</tt>

<p>
The
<tt>(defvar d ...)</tt>
form produces
<tt>d</tt>
symbol as its result value. That symbol has a variable binding as a result
of that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039DD0E7">defvar</a=
></tt>
and so evaluates; that evaluation produces
<tt>(list '+ 2 2)</tt>,
the contents of
<tt>d</tt>.
That object is a Lisp expression and is evaluated, producing
<tt>(+ 2 2)</tt>
and that is also an expression, which reduces to
<tt>4</tt>.
The object
<tt>4</tt>
is self-evaluating, and so the greedy evaluation process stops.
</p><p>

</p></dd></dl>
<a name=3D"N-0003D10B">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.20.6">12.20.6<=
/a> Special variable <tt>*doc-url*</tt></h4>



<dl>
<dt>Description:</dt><dd>
<p>



The special variable
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003D10B">*doc-url*=
</a></tt>
holds a character string representing a web URL intended to point to the HT=
ML
version of this document.  The initial value points to the publicly hosted
document on the Internet.  The user may change this to point to another
location, such as a locally hosted copy of the document.
</p><p>
This variable is used by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0097F54C">doc</a></=
tt>
function.
</p><p>
</p></dd></dl>
<a name=3D"N-02247FD0">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.21">12.21</a> =
Listener-Related Functions</h3>



<p>


</p><p>

<a name=3D"N-0097F54C">&nbsp;</a>
</p><h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.21.1">12.2=
1.1</a> Function <tt>doc</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(doc </tt><tt><i>[</i></tt><tt>symbol ])=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0097F54C">doc</a></=
tt>
function provides help for the library symbol
<tt><i>symbol</i></tt>.
If information about
<tt><i>symbol</i></tt>
is available in the HTML version of this document, and is indexed, then thi=
s
function causes that document to be opened using the system's default web
browser, such that the browser navigates to the appropriate section of
the manual.
</p><p>
If the
<tt><i>symbol</i></tt>
argument is omitted, then the document is opened without navigating to a
particular section.
</p><p>
The base URL for the document is configured by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0003D10B">*doc-url*=
</a></tt>
variable.
</p><p>
If
<tt><i>symbol</i></tt>
is successfully found, or else not specified, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0097F54C">doc</a></=
tt>
successfully invokes the URL-opening mechanism, it returns
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
Otherwise, it throws an error exception.
</p><p>

</p></dd></dl>
<a name=3D"N-03C6D422">&nbsp;</a>
<h4><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-12.21.2">12.21.2<=
/a> Function <tt>quip</tt></h4>



<dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(quip)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6D422">quip</a><=
/tt>
function returns a randomly selected string containing a humorous quip,
quote or witticism. The following code may be added to
<tt>.txr_profile</tt>
to produce the random quip on startup:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01=
2163C3">put-line</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0=
3C6D422">quip</a>))
</tt></pre><tt>

</tt>

<p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6D422">quip</a><=
/tt>
function was introduced in <b>TXR</b> 244. If the
<tt>.txr_profile</tt>
is used with installations of older <b>TXR</b> versions, it is recommended =
to use
the following, to avoid calling the undefined function, as well as to
prevent a warning:
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-00=
39">if</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">f=
boundp</a> 'quip)
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-012163C3">put-line=
</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6D422">quip</a=
>))
    (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B44934">defun</a=
> quip ()))
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-01B21F66">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-13">13</a> SETUID=
/SETGID OPERATION</h2>




<p>


</p><p>
On platforms with the Unix filesystem and process security model, <b>TXR</b=
> has
support for executing setuid/setgid scripts, even on platforms whose operat=
ing system
kernel does not honor the setuid/setgid bit on hash bang scripts. On these
systems, taking advantage of the feature requires <b>TXR</b> to be installe=
d as a
setuid/setgid executable. For this reason, <b>TXR</b> is aware when it is e=
xecuted
setuid and takes care to manage privileges.  The following description abou=
t
the handling of setuid applies to the parallel handling of setgid also.
</p><p>
When <b>TXR</b> starts, early in its execution it determines whether or not=
 is
is executing setuid. If so, it temporarily drops privileges, as a precautio=
n.
This is done before processing the command line arguments.
When <b>TXR</b> determines that it is executing a setuid script (a file mar=
ked
executable to its owner and attributed with the set-user-ID bit), it then
attempts to impersonate the owner of the script file by changing to
effective user ID to that owner just before executing the file. It retains
the real and saved user ID.  If the attempt to assume that user ID is
unsuccessful, then <b>TXR</b> permanently drops setuid privileges before ex=
ecuting
the script.  Likewise, before executing any code other than a setuid
script, <b>TXR</b> also drops privileges.
</p><p>
<b>TXR</b> tries to honor and implement the setuid permissions on a script
whether or not it is running setuid. When not running setuid, it neverthele=
ss
tries to change its effective user ID to that of the owner of the setuid
script. This will succeed if it has sufficient permissions to do so.
</p><p>
To rephrase: in order for <b>TXR</b> to execute a file which is setuid root=
,
it has to be running with a root effective user ID somehow. In order
to execute a file which is setuid to a non-root user, <b>TXR</b> has to be
running effectively as root or else as that user.   It doesn't matter wheth=
er
these privileges are achieved effectively using the setuid mechanism, or
whether <b>TXR</b> is running with the required user ID as its real ID.
However, if <b>TXR</b> is running setuid, it takes special care to temporar=
ily
drop the privileges as early as possible, and eventually to drop the
privileges permanently before executing any code, other that the setuid
script. If the setuid script cannot be executed with the privileges it
calls for, <b>TXR</b> also drops privileges and executes it anyway, strictl=
y as the
real user who invoked the <b>TXR</b> executable.
</p><p>
What it means to drop privileges is to change the effective user ID
and the saved user ID to be equal to the real user ID. On platforms
where the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027671E8">setresuid=
</a></tt>
function is available, <b>TXR</b> uses that function to drop privileges.
On platforms where
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027671E8">setresuid=
</a></tt>
is not available, <b>TXR</b> tries to drop privileges using the
C language function call
<tt>setuid(r)</tt>,
where
<tt>r</tt>
is the previously noted real user ID obtained from
<tt>getuid()</tt>.
On some platforms, this only works for dropping root privileges: it
overwrites the real and saved ID only if the caller is effectively root.
On those platforms, this approach does not drop non-root privileges.
<b>TXR</b> tries to detect whether this approach worked by evaluating
the C language expression
<tt>seteuid(e)</tt>,
where
<tt>e</tt>
is the previously noted effective user ID.  In other words, it
attempts to re-gain the dropped privilege by recovering the previous
effective ID. If this attempt succeeds, <b>TXR</b> immediately aborts.
Dropping setgid privileges is similar. Where
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027671E8">setresgid=
</a></tt>
is available it is used, otherwise an attempt is made with
<tt>setegid(r)</tt>
where
<tt>r</tt>
is the previously noted real group ID. Then a test using
<tt>setegid(e)</tt>
is performed using the original effective group ID as
<tt>e</tt>.
This is done after dropping any setuid root user ID privilege
which would allow such a test to succeed.
</p><p>
If <b>TXR</b> is running both setuid and setgid, and execute a script
which is setuid only, it will still drop group privileges, and vice
versa: if it executed a setgid script, it will drop user privileges.
For instance, if a root-owned <b>TXR</b> runs a setgid script which is owne=
d by
user
<tt>10</tt>
and group-owned by group
<tt>20</tt>,
that script will run with an effective group ID of 20. The effective user I=
D
will be that of the user who invoked the script: <b>TXR</b> will drop the r=
oot
privilege to the original real ID of the user, and while for the setgid
operation, it will change to the group ID of the script.
</p><p>
The setuid/setgid privilege machinery in <b>TXR</b> does not manipulate
the list of supplementary ("ancillary", in the language of POSIX) group IDs=
.
It is unnecessary for security because the list does not change while
running with setuid privilege. No group IDs are added to the list which
need to be retracted when privileges are dropped. The supplementary
groups also persist across the execution of a setuid/setgid script.
</p><p>
<a name=3D"N-037ACEFC">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-14">14</a> ST=
AND-ALONE APPLICATION SUPPORT</h2>




<p>


</p><p>
The <b>TXR</b> executable image supports a general mechanism by means of wh=
ich
a custom program can be packaged as an apparent stand-alone executable.
</p><p>
<a name=3D"N-0389D15E">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-14.1">14.1</a=
> The Internal Argument String</h3>



<p>


</p><p>
The <b>TXR</b> executable contains a 128 byte data area preceded by the
seven-byte ASCII character sequence
<tt>"@(txr):"</tt>.
The 128 byte data area which follows this identifying prefix
represents a null-terminated UTF-8 string. In the stock executable,
this area is filled with null bytes.
</p><p>
If the <b>TXR</b> executable is edited such that this area is replaced
with a non-empty, null-terminated UTF-8 string, the program will,
for the purposes of command line argument processing, treat this string as =
if
it were the one and only command line argument. (The original command
line arguments are still retained in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args-ful=
l*</a></tt>
variables).
</p><p>
The function
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02850687">save-exe<=
/a></tt>
creates a copy of the <b>TXR</b> executable with a custom internal argument=
.
</p><p>
</p><dl>
<dt>Example:</dt><dd>
<p>


</p><p>
Suppose that <b>TXR</b> is copied to an executable in the same directory ca=
lled
<tt>myapp</tt>
(or
<tt>myapp.exe</tt>
on an operating system which requires the
<tt>.exe</tt>
suffix). Also suppose that in the same directory, there exists a file
called
<tt>myscript.tl</tt>.
</p><p>
This
<tt>myapp</tt>
executable can then be edited so that the data area which follows the
<tt>@(txr):</tt>
bytes contains the following string:
</p><p>
<tt>
</tt></p><pre><tt>  --args|-e|(<a href=3D"http://nongnu.org/txr/txr-manpage=
.html#D-0080">load</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N=
-0033B27E">path-cat</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#=
N-02C01721">dir-name</a> txr-exe-path) "main.tl"))
</tt></pre><tt>

</tt>

<p>
When the
<tt>myapp</tt>
executable is invoked, it will process the above string as a single
command line argument, causing the
<tt>main.tl</tt>
<b>TXR Lisp</b> source file to be loaded.
Any arguments passed to
<tt>myapp</tt>
are ignored and available to
<tt>main.tl</tt>
via the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DEE18A">*args*</a=
></tt>
variable.
</p><p>
</p></dd></dl>
<a name=3D"N-00891FF9">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-14.2">14.2</a> De=
ployment Directory Structure</h3>



<p>


</p><p>
The <b>TXR</b> executable may require library files, depending on the
functionality invoked by the program code. Library files are located
relative to the installation directory, called the
<i>sysroot</i>.

The executable tries to dynamically determine the sysroot from
its own location, according to this directory structure:
</p><p>
<tt>
</tt></p><pre><tt>  /path/to/sysroot/bin/txr
               .../share/txr/stdlib/cadr.tl
                         .../stdlib/except.tl
                                    ...
</tt></pre><tt>

</tt>

<p>
The above structure is assumed if the executable finds itself
in a directory named
<tt>"bin"</tt>.
</p><p>
Otherwise, if the executable finds itself in a directory not
named
<tt>"bin"</tt>,
the following structure is expected:
</p><p>
<tt>
</tt></p><pre><tt>  /path/to/installation/txr
                    .../share/txr/stdlib/cadr.tl
                    .../share/txr/stdlib/except.tl
                                         ...
</tt></pre><tt>

</tt>

<p>
When a custom application is deployed using a possibly renamed
<tt>txr</tt>
executable, one of the above structures should be observed:
either the sysroot with a
<tt>bin</tt>
subdirectory where the executable is located, on the
same level with the
<tt>share</tt>
directory, or else the second structure in which the
<tt>share</tt>
directory is a subdirectory of the executable directory.
If one of these structures is not observed, the application
may fail due to the failure of a library file to load.
</p><p>

<a name=3D"N-02850687">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-14.3">14.3</a=
> Function <tt>save-exe</tt></h3>



<p>



</p><dl>
<dt>Syntax:</dt><dd>
<p>


<tt>





<br>&nbsp;&nbsp;(save-exe </tt><tt><i>path</i></tt><tt> </tt><tt><i>arg-str=
ing</i></tt><tt>)=20

</tt>


</p></dd><dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02850687">save-exe<=
/a></tt>
function produces an edited copy of the <b>TXR</b> executable at the specif=
ied
<tt><i>path</i></tt>,
inserting
<tt><i>arg-string</i></tt>
as the internal argument string.
</p><p>
In order for the copied executable to be useful, the required installation
directory structure must be provided around it, as described in the
previous section, Deployment Directory Structure.
</p><p>
The return value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02850687">save-exe<=
/a></tt>
is unspecified.
</p><p>
The
<tt>arg-string</tt>
should encode to 127 bytes of UTF-8 or less, or else it will be abruptly
truncated, possibly in the middle of a UTF-8 sequence.
</p><p>
</p></dd><dt>Example:</dt><dd>
<p>


</p><p>
Create a copy of <b>TXR</b> called
<tt>myapp</tt>
which will load a file called
<tt>main.tl</tt>
that is located in the same directory.
</p><p>
<tt>
</tt></p><pre><tt>  (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02=
850687">save-exe</a>
    "myapp"
    "--args|-e|(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">l=
oad</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0033B27E">path=
-cat</a> (<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C01721">dir=
-name</a> txr-exe-path) \
    \ \"main.tl\"))")
</tt></pre><tt>

</tt>

<p>
</p></dd></dl>
<a name=3D"N-0179BAC0">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-15">15</a> DEBUGG=
ER</h2>




<p>


</p><p>
<b>TXR</b> had a simple, crude, built-in debugger, which was removed.
</p><p>
<a name=3D"N-037D9E3E">&nbsp;</a>
</p><h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-16">16</a> CO=
MPATIBILITY</h2>




<p>


</p><p>
<a name=3D"N-01CE7F15">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-16.1">16.1</a=
> Overview</h3>



<p>


</p><p>
New <b>TXR</b> versions are usually intended to be backward-compatible with=
 prior
releases in the sense that documented features will continue to work in
the same way. Due to new features, new versions of <b>TXR</b> will supply n=
ew
behaviors where old versions of <b>TXR</b> would have produced an error, su=
ch as a
syntax error. Though, strictly speaking, this means that something is worki=
ng
differently in a new version, replacing an error situation with functionali=
ty
is usually not considered a deviation from backward-compatibility.
</p><p>
There is one notable deviation from this general requirement for backwards
compatibility: the handling of compiled files. For pragmatic reasons,
from time to time <b>TXR</b> may break backward compatibility, such that a =
newer
version of <b>TXR</b> will not load compiled files produced by an older ver=
sion.
The files will have to be recompiled with the new <b>TXR</b>. More details
are given in the section
<b>Compiled File Compatibility</b>

under the major section
<b>LISP COMPILATION</b>.

The rationale for not requiring backward compatibility support for older
compiled files is that older files require the older implementation of the
virtual machine which they target. In some cases the differences between
the older virtual machine and new is so great that <b>TXR</b> would have to=
 carry a
whole separate virtual machine implementation for the sake of the older fil=
es,
which is a significant burden.
</p><p>

<a name=3D"N-036F1A29">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-16.2">16.2</a=
> The <tt>-C</tt> compatibility option</h3>



<p>



</p><p>
When a change is introduced which is not backward compatible, <b>TXR</b>'s =
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
option can be used to request emulation of old behavior.
</p><p>
The option was introduced in <b>TXR</b> 98, and so the oldest <b>TXR</b> ve=
rsion which
can be emulated is <b>TXR</b> 97.
</p><p>
Side effects occur in the processing of the option.  If the option is speci=
fied
multiple times, the behavior is unspecified.
</p><p>

<a name=3D"N-03F5D03D">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-16.3">16.3</a=
> Environment variable <tt>TXR_COMPAT</tt></h3>



<p>



</p><p>
If the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F5D03D">TXR_COMPA=
T</a></tt>
environment variable exists, and its value is not en empty string,
it must contain a decimal integer. Its value is taken by <b>TXR</b>  as a r=
equest
to emulate old behaviors, just like the value of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
option.
</p><p>
If the variable has incorrect contents or an out-of-range value,
<b>TXR</b> will print an error diagnostic and exit.
</p><p>
If both
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
and the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F5D03D">TXR_COMPA=
T</a></tt>
environment variable are supplied, the behavior is unspecified.
</p><p>
<a name=3D"N-0194D768">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-16.4">16.4</a=
> Compatibility Version Values</h3>



<p>


</p><p>
The following version values which have a special meaning as arguments to t=
he
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
option, along with a description of what behaviors are affected. For each
of these version values, the described behaviors are provided if
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-036F1A29">-C</a></t=
t>
is given an argument which is equal or lower. For instance
<tt>-C 103</tt>
selects the behaviors described below for version 105, but not those for 10=
2.
</p><dl class=3D"items">
<dt>251</dt><dd>
Until <b>TXR</b> 251, the syntax
<tt>obj.[fun arg]</tt>
was equivalent to
<tt>[obj.fun arg]</tt>,
providing little utility.
A compatibility value of 251 or lower restores that behavior. The new
behavior is that
<tt>obj.[fun arg]</tt>
is equivalent to
<tt>obj.[fun obj arg]</tt>,
with
<tt>obj</tt>
evaluated only once, performing method dispatch.
</dd><dt>248</dt><dd>
Until <b>TXR</b> 248, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBE776">hash-revg=
et</a></tt>
function defaulted to using
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
equality for searching the hash table for matching values rather than the
current
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>.
Also, until 248, the
<tt>@</tt>
token for denoting meta-expressions was treated with a low precedence
relative to the range dot
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217A971">..</a></t=
t>
token. This led to strange results, such as
<tt>@(a)..@(b)</tt>
parsing in a way equivalent to
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E9003D">rcons</=
a> a @(b))</tt>
rather than
<tt>(rcons @(a) @(b))</tt>.
Not is that undesirable due to the lack of symmetry, it's also
inconsistent with
<tt>@a..@b</tt>
denoting
<tt>(rcons @a @b)</tt>.
The latter is because in that case the
<tt>@</tt>
is handled as part of the symbol token as a token, and not as a separate op=
erator.
A compatibility value of 248 or lower restores the above old behaviors of
<tt>@</tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FBE776">hash-revg=
et</a></tt>.
</dd><dt>244</dt><dd>
Until <b>TXR</b> 244, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011814B5">env-hash<=
/a></tt>
function returned a new hash table each time it was called. The behavior is
restored if 244 or older compatibility is selected.
</dd><dt>243</dt><dd>
Two mistakes in the pseudo-random-number generator (PRNG) were discovered,
affecting <b>TXR</b> 243 and older. Using this compatibility value, or lowe=
r, will
restore the buggy behavior, allowing pseudo-random number sequences produce=
d
by those older versions can be reproduced. The PRNG is intended to be an
implementation of the WELL512a PRNG described by Panneton and L'Ecuyer.
The coding mistakes, however, resulted in the PRNG being an implementation =
of
something other than WELL512a.
</dd><dt>242</dt><dd>
In <b>TXR</b> 242 and older, the instantiation of an object whose type inhe=
rits
from the same supertype more than once resulted in duplicate execution
of the supertype's initialization. This was a documented behavior.
After 242, duplicate initialization is suppressed. For more information, se=
e
the section
<b>Duplicate Supertypes</b>.<b>A</b>compatibility<b>value</b>of<b>242</b>or=
<b>lower</b>restores

the duplicate initialization behavior.
</dd><dt>237</dt><dd>
Compatibility values of 237 or lower restore the destructive behavior of th=
e
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FE5176">sort</a><=
/tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F12561">shuffle</=
a></tt>
functions.
</dd><dt>234</dt><dd>
In <b>TXR</b> 234 and older versions, the exception throwing functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
did not return, regardless of the exception type. All unhandled exceptions
triggered internal handling leading to unwinding and termination.
The current behavior is that only
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">error</a>=
</tt>
exceptions lead to termination. When a non-error exception isn't intercepte=
d
by a catch or handler, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0016">throw</a></tt=
>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">throwf</a=
></tt>
returns normally, yielding the value
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>.
If a compatibility value equal to or lower than 234 is requested,
the old behavior occurs: all unhandled exceptions terminate.
</dd><dt>227</dt><dd>
In <b>TXR</b> 227 and older versions, the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02403ED4">carray-ui=
nt</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02403ED4">carray-in=
t</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00797A01">uint-carr=
ay</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00797A01">int-carra=
y</a></tt>
had different names, namely
<tt>carray-unum</tt>,
<tt>carray-num</tt>,
<tt>unum-carray</tt>
and
<tt>num-carray</tt>,
respectively.
If 227 or lower compatibility is selected, these functions become
available under their old names in addition to their new names.
</dd><dt>231</dt><dd>
Versions of <b>TXR</b> until 231 contained an undocumented feature: some
library functions which are documented as having parameters that must be of
string type were allowing the arguments to be symbols.  For such symbolic
arguments, the name of the symbol obtained from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035D3BBF">symbol-na=
me</a></tt>
was implicitly taken as the required string value. This behavior was remove=
d:
passing symbolic arguments to library function parameters documented as
strings will cause an exception to the thrown. If a compatibility value
of 231 or lower is specified, however, the tolerant behavior is restored.
</dd><dt>225</dt><dd>
After <b>TXR</b> 225, the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
operator was adjusted. Previously, a form like
<tt>(do set x)</tt>
which contains no variable references like
<tt>@1</tt>,
<tt>@2</tt>
or
<tt>@rest</tt>,
generated a function similar to
<tt>(lambda (. rest) (set x))</tt>.
This was contrary to documentation, which states that
<tt>(do set x)</tt>
should produce a variadic function which has one required argument,
and which assigns that argument to the variable
<tt>x</tt>
when invoked. The current implementation is that
<tt>(do set x)</tt>
is equivalent to
<tt>(do set x @1)</tt>
which produces the documented behavior. If 225 or lower compatibility is
selected, then the old behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
takes effect.
</dd><dt>224</dt><dd>
After <b>TXR</b> 224, the treatment of certain special structure functions
has changed. Selecting 224 compatibility or lower restores that behavior.
The specification given in the
<b>Special Structure Functions</b>

paragraph has always stated that special functions must be static slots,
and that the behavior is unspecified if they are instance slots.
The behavior of <b>TXR</b> 224 and earlier was that these functions worked =
anyway
if they were instance slots; after <b>TXR</b> 224, they some special functi=
ons
will no longer be recognized if bound to instance slots.
</dd><dt>222</dt><dd>
After <b>TXR</b> 222, the behavior of
<tt>:vars</tt>
in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0055">collect</a>=
)</tt>
was subject to an adjustment. Previously, if the collect body
didn't bind any variables, and both required and optional variables
were specified in
<tt>:vars</tt>,
it would still bind all of the optional ones to their default values.
This was a poor behavior which violated the idea that
<tt>:vars</tt>
enforces an all-or-nothing binding discipline to keep the collected
lists consistent. Selecting 222 compatibility or lower restores this
behavior.
</dd><dt>215</dt><dd>
After <b>TXR</b> 215, the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
function changed with respect to its treatment of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
variable. In cases where
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
resolved the path by adding a suffix,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D1DB58">*load-pat=
h*</a></tt>
was bound to the unsuffixed name, which was a documented behavior.
After <b>TXR</b> 215, also, the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
function changed. When the arguments implicate the entire string,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
started just returning the original string, and not making a copy.
The old behavior was to always make a copy.
The above old behaviors of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
are restored if 215 or lower compatibility
is requested. Note, however, that the restoration of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>
behavior in response to the compatibility option was only
introduced in <b>TXR</b> 251. In <b>TXR</b> 249 and older, the
compatibility value has no effect on the behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CFFEF2">sub-str</=
a></tt>.
</dd><dt>202</dt><dd>
Up to <b>TXR</b> 202, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D5AF97">logxor</a=
></tt>
function was incorrectly implemented, producing wrong results when both
arguments are the same fixnum integer, or the same bignum object.
The incorrect behavior is restored if 202 or earlier compatibility is
requested. After 202, the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
function changed with regard to symbols in the keyword package.
Regardless of the
<tt><i>pretty-p</i></tt>
flag, keywords are printed with the leading colon. Compatibility with
202 or earlier restores the behavior that when the
<tt><i>pretty-p</i></tt>
flag is true, symbols are printed without package prefixes.
</dd><dt>199</dt><dd>
After <b>TXR</b> 199, certain global variables that had been deprecated
for a long time, and no longer documented, were removed. Requesting 199 or
earlier compatibility restores those variables.
</dd><dt>190</dt><dd>
Until <b>TXR</b> 190, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-002A609F">reset-str=
uct</a></tt>
function neglected to perform
<tt>:postinit</tt>
initializations, and didn't invoke finalization on the structure object
if an exception was thrown during reinitialization. Thus, contrary
to documented requirements, reinitialization of a structure didn't behave
like fresh construction. Also, until <b>TXR</b> 190, macro parameter
lists implemented the requirement that a
<tt>:</tt>
(colon keyword symbol) argument to an optional
was treated as a missing argument, triggering argument-defaulting behavior.
That requirement was removed; the colon symbol behaves as an ordinary value
under destructuring with macro parameter lists.
Moreover, until <b>TXR</b> 190, the
<tt>pub</tt>
symbol package didn't exist; the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000CBBA0">*package*=
</a></tt>
variable was initialized to the user package and so symbols introduced
by application code were interned in the same package as the <b>TXR Lisp</b=
>library.
All these old behaviors are restored in compatibility
with version 190 or earlier.
Finally, one more change after <b>TXR</b> 190 that is controlled by the
compatibility mechanism was a critical redesign of the requirements
for the behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
function. Version 190 compatibility causes the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>
symbol to refer to the old implementation of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02193773">ldiff</a>=
</tt>.
</dd><dt>188</dt><dd>
Until <b>TXR</b> 188,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
hash tables printed using the notation
<tt>#H((:equal-based ...) ...)</tt>
whereas
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>-based
hash tables simply omitted the
<tt>:equal-based</tt>
keyword. Changes were introduced in <b>TXR</b> 187 which gave rise to a rea=
d/print
inconsistency with printing behavior. In <b>TXR</b> 189, further changes we=
re
introduced to fix this inconsistency:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>-based
hash tables print without any keyword indicating equality, and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>-based
hash tables print as
<tt>#H((:eql-based) ...)</tt>.
If 188 or compatibility is selected, hash tables are printed
in the old way.
</dd><dt>187</dt><dd>
Until <b>TXR</b> 187, hash tables constructed by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>
function were based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
equality by default; the
<tt>:equal-based</tt>
keyword argument had to be specified to override this default, and the
<tt>:eql-based</tt>
keyword didn't exist. Selecting 187 or lower compatibility restores the
behavior of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
equality being default, and the
<tt>:eql-based</tt>
keyword being unrecognized. This affects all functions which implicitly
rely on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0001">hash</a></tt>=
,
those being :
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6D456">uniq</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0028147F">unique</a=
></tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F6F229">group-by<=
/a></tt>.
In spite of these changes, the printed representation of hash tables contin=
ues
to use the
<tt>:equal-based</tt>
keyword to indicate hash tables based on
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-006E">equal</a></tt=
>
and its absence to indicate
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02550B35">eql</a></=
tt>
equality. The new
<tt>:eql-based</tt>
keyword may be used in hash literals (unless 187 compatibility is
in effect, in which case it is ignored).
</dd><dt>184</dt><dd>
A value of 184 or lower switches to the old implementation of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a></tt>
macros which was replaced starting in <b>TXR</b> 185. Also, this has the
effect of disabling the special recognition of meta-expressions
and meta-symbols in the dot position of function calls, and
the macro expansion of meta-symbols in quasiliterals. This is
because the old
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">op</a></t=
t>
implementation implements these behaviors itself. The implication
is that user code which binds custom macros to
<tt>sys:var</tt>
or
<tt>sys:expr</tt>
may be affected by 184 or lower compatibility.
</dd><dt>185</dt><dd>
A value of 185 or lower restores the old precedence of the
double dot notation for expressing ranges, relative to the
referencing dot. Until <b>TXR</b> 185, the expression
<tt>a.b..c.d</tt>
parsed as
<tt>(qref a (rcons b c) d)</tt>.
What is worse, it parsed this way even if written as
<tt>a.b .. c.d</tt>.
Starting in <b>TXR</b> 186,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0217A971">..</a></t=
t>
has a lower precedence, producing the more useful and intuitive parse
<tt>(rcons (qref a b) (qref c d))</tt>:
in other words, the range with endpoints given by
<tt>a.b</tt>
and
<tt>c.d</tt>.
<p>
</p><p>
</p></dd><dt>183</dt><dd>
A value of 183 or lower restores an inconsistent behavior in the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a>)</=
tt>
directive and other places in the <b>TXR</b> pattern language where binding
takes place. Prior to version 184, a string tree match was only tried in
both directions when the left hand side of a binding (the "pattern") was a
variable. For non-variable pattern terms, such as Lisp expressions or atoms=
,
the string tree match was tried in one direction only: a string tree arisin=
g
out of the pattern could match a string atom value on the right side.
A string tree is a nested list structure whose leaves are strings: a list
of strings, a list of lists of strings, and so on, in any mixture.
Concretely, before <b>TXR</b> 184,
<tt>

@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> "a" ("=
a" "b" "c"))
</tt>

didn't match, but
<tt>

@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> ("a" "=
b" "c") "a")
</tt>

did. However, if the variable
<tt>a</tt>
contained
<tt>"a"</tt>
then
<tt>

@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a> a ("a"=
 "b" "c"))
</tt>

did match: an inconsistency.
</dd><dt>177</dt><dd>
A value of 177 or lower causes the emulation of a bug which was present in =
the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
awk macro. A range whose start and end condition matched on the same record=
 failed
to activate for that record, even though
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BEA6DF">rng</a></=
tt>
is inclusive. The behavior is incompatible with POSIX Awk.
</dd><dt>174</dt><dd>
A value of 174 or lower restores a previous behavior of variable substituti=
on
in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>
directive and in quasiliterals in both the <b>TXR</b> pattern language and =
<b>TXR Lisp</b>.
The behavior in question is the evaluation of the element indexing or
range selection modifier, exemplified by
<tt>@{a [2]}</tt>.
The previous behavior was that if the variable is of any type other
than list, it is converted to a string (unless it already is one).
The indexing then applies to the string. If it is a list then the
indexing or range selection applies to the original list value,
prior to conversion to text. The current behavior is that indexing
and range selection is applied to the original value if that value
is any sequence type which satisfies the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C6CAE0">seqp</a><=
/tt>
function, otherwise to the string representation.
</dd><dt>172</dt><dd>
A value of 172 or lower restores a behavior of the <b>TXR</b> pattern
matching language when matching a variable followed by a directive, such as
<tt>@a@(fun b)</tt>.
The old behavior is that the scan for a match for the directive
takes place in an environment in which a binding for
<tt>a</tt>
has not yet been established. The new behavior is that the variable
is always bound prior to the processing of the directive. During
the search, it is bound to the range of text spanning between the
starting position and the position being tried.
</dd><dt>170</dt><dd>
A value of 170 or lower disables the behavior that <b>TXR</b> scans standar=
d input
when no input sources are specified on the command line. Standard input mus=
t
be requested explicitly using the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0009">-</a></tt>
argument. This is how it was in all versions of <b>TXR</b> up to 170.
Some programs may behave differently because of this. Specifically, program=
s
which do not take any arguments, and do not select an input source using th=
e
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive, or suppress the use of an input source using
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a> ni=
l)</tt>,
may now accidentally read from standard input.
Until version 170, the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FD4882">split*</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0142889E">partition=
</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03951D7A">partition=
*</a></tt>
ignored negative indices in their
<tt><i>index-list</i></tt>
argument. The new behavior is that the length of the input sequence
is added to any negative index values. The resulting values are then
ignored if they are still negative.
</dd><dt>165</dt><dd>
A value of 165 restores the following behaviors, which changed starting in =
166.
There was a change in Lisp evaluation support of the <b>TXR</b> pattern lan=
guage.
Specifically, Lisp argument forms were not subject to expansion prior to
evaluation in these directives:
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0076">mod</a></tt>,
<tt>modlast</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021FCB7C">skip</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CAE17D">fuzz</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0080">load</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0030">close</a></tt=
>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386C775">call</a><=
/tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03336E1B">cat</a></=
tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a></tt>=
.
</dd><dt>161</dt><dd>
Version 161 was the last version in which a bug existed in the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
macro. In spite of the documentation claiming that
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
has the same syntax as
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>,
the clauses of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
were being passed the exception symbol as the leftmost argument, followed
by the exception arguments. This convention is different from
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>
clauses which do not receive the exception symbol, only the arguments.
The discrepancy was corrected by making
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
behave like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0023">catch</a></tt=
>,
as documented. Requesting compatibility with 161 or earlier restores
the previous behavior of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F7D8B5">handle</a=
></tt>
macro.
</dd><dt>156</dt><dd>
After version 156, two behaviors changed in the in the macro expander for
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseq</a>=
</tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">caseql</a=
></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">casequal<=
/a></tt>:
one outright bug was fixed, and one hitherto undocumented behavior
was changed and specified in the documentation at the same time.
Selecting a compatibility value of 156 or less restores the previous
behaviors. The bug was that single-atom case keys were undergoing
evaluation. For instance
<tt>(caseql x (a 0))</tt>
would arrange for the evaluation of
<tt>a</tt>
as a variable, rather than treating it as the symbol
<tt>a</tt>
itself. Though the compatibility mechanism restores the behavior,
applications depending on the evaluating behavior should be changed to
instead use
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseq*</a=
></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FB71A2">caseql*</=
a></tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017EB9A1">casequal<=
/a></tt>.
A workaround for this bug for <b>TXR</b> versions 156 or older is to replac=
e
simple keys with a key list of length one, exemplified by a rewrite of the
foregoing expression to
<tt>(caseql x ((a) 0))</tt>.
Here
<tt>a</tt>
is not evaluated.
The undocumented behavior was that a matching clause which has no forms
to be evaluated was producing a result value of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>.
For example
<tt>(case 1 (1))</tt>
previously yielded
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">t</a></tt=
>,
but now yields
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>,
and this behavior is documented.
</dd><dt>155</dt><dd>
After version 155, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-str</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0225F28F">tok-where=
</a></tt>
functions changed semantics. Previously, these functions exhibited the
flaw that under some conditions they extracted an empty token immediately
following a non-empty token. This behavior was working as designed and
documented, but the design was flawed, creating a major difficulty in simpl=
e
tokenizing tasks when tokens may be empty strings.  Requesting compatibilit=
y
with version 155 or earlier restores the behavior.
</dd><dt>154</dt><dd>
After version 154, changes were introduced in the semantics of struct
literals. Previously, the syntax
<tt>#S(abc x a y b)</tt>
denoted the construction of an instance of
<tt>abc</tt>
with
<tt>x a y b</tt>
as the constructor parameters, similarly to
<tt>(new abc x 'a y 'b)</tt>.
The new behavior is that
<tt>abc</tt>
is constructed using no parameters, as if  by
<tt>(new abc)</tt>
and then the slot values are assigned. This means that the values
specified in the literal override any manipulations of those slots by
the type's user-defined
<tt>:postinit</tt>
handlers. Also, after 154,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
methods are expected to take three arguments and are invoked for both
pretty printing and regular machine-readable printing. Until 154, a struct'=
s
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-007D">print</a></tt=
>
methods was called only when that struct was being pretty-printed, and
only with two arguments; ordinary printing side-stepped the method and rend=
ered
the standard
<tt>#S</tt>
syntax featuring all instance slots.
</dd><dt>151</dt><dd>
After version 151, changes were implemented to the way static slots work
in <b>TXR Lisp</b> structs. Selecting compatibility with 151 restores most =
of the behaviors.
Until 151, each structure type had its own instance of static slots whether
they were newly defined or inherited. Under the new scheme, a derived struc=
t
shares one instance of each inherited static slot with its base type.
Under the old scheme, a struct inherits the static
initialization functions of its bases (the
<tt><i>static-initfun</i></tt>
argument passed in
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>).
These are invoked because they are relied upon by the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
macro to perform the initializations of all the inherited static slots.
Under the new scheme, the static initialization functions are not inherited=
.
Only the type's own
<tt><i>static-initfun</i></tt>
is invoked to initialize its newly defined static slots that it doesn't
share with the parent. The inherited static slots simply preserve their
current values they have in the base type; their values are untouched by
the introduction of a derived type. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E71F31">static-sl=
ot-ensure</a></tt>
also changed semantics after version 151. The old behavior was problematic
because it affected all static slots throughout the inheritance hierarchy
matching the name passed in by argument. Since this function is the basis
for redefining methods, its behavior broke the semantics of overriding.
Selecting 151 compatibility only restores the behavior of this
function and macros based on it like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0047C7E8">defmeth</=
a></tt>:
in the situation when it introduces a new static slot into one or more
struct types, in compatibility mode it introduces the slot separately into =
each
type without sharing, and it recurses over the entire type hierarchy,
storing
<tt><i>new-val</i></tt>
into all static slots which match
<tt><i>name</i></tt>.
</dd><dt>150</dt><dd>
Until version 150, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3A26F">match-reg=
ex</a></tt>
function behaved in a different way from what was documented. Rather
than returning the length of the match, it returned the index one
past the last matching character. In the case when the starting position
is zero, these values coincide; they are different if the match begins
at some position inside the string. Compatibility with 150 restores
the behavior. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E3A26F">match-reg=
st</a></tt>
function was also affected by this issue; however, since it returned nonsen=
se
result not corresponding to the matching text, it was repaired without
backward compatibility.
Also affected by version 150 compatibility are the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019430C5">match-reg=
ex-right</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019430C5">match-reg=
st-right</a></tt>
functions. These functions worked as documented; however, their
specification changes after version 150 to a semantics which is
more useful and less surprising to the programmer.
</dd><dt>148</dt><dd>
Up until version 148, the
<tt>:postinit</tt>
handlers specified in a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
were executed in derived-to-base order, opposite to the
order of execution of
<tt>:init</tt>
handlers. Though described in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021CC672">defstruct=
</a></tt>
syntax and concepts, this is actually a change in how
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
treats its
<tt><i>postinitfun</i></tt>
argument.
Specifying 148 or earlier compatibility provides this
old behavior. Also, until version 148, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E6E63B">trim-str<=
/a></tt>
function stripped leading and trailing whitespace from a string
consisting of not only spaces, tabs and newlines, but also carriage
returns, vertical tabs and form feeds.
</dd><dt>145</dt><dd>
In versions 144 and 145, <b>TXR</b> opened files in text mode on Cygwin,
enabling conversion between CR-LF line endings and abstract newline
characters. This behavior change was retracted, so that files on Cygwin are
opened without specifying text mode, causing the streams to be effectively
binary. The intended "Windows native" behavior of streams being text mode i=
s
instead provided in the Windows version of <b>TXR</b> by the Cygnal library=
.
</dd><dt>143</dt><dd>
Until version 143, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-008E4BC2">stdlib</a=
></tt>
variable didn't include the trailing slash. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FA4070">makunboun=
d</a></tt>
function semantics changed after version 143 to be more
compatible with ANSI Common Lisp. Until 143, that function removed
only the global binding, leaving the dynamic rebinding of a variable
intact. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
operator neglected to remove the symbol's special variable
mark, if the symbol was previously defined as a special variable.
Also, until version 143 many more places in the <b>TXR</b> pattern language=
 used
bind expressions rather than Lisp expressions. The compatibility
option restores these behaviors.
</dd><dt>142</dt><dd>
Until version 142, the <b>TXR</b> pattern language supported a prefix
convention on data sources. Data sources beginning with the character
<tt>!</tt>
were treated as system command pipes, and data sources beginning with
<tt>$</tt>
indicated that a directory is to be scanned. This convention was recognized
both for command line arguments, the arguments of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive, and of the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
directive, whether or not the argument was a literal or a computed
value. This feature was dropped from the language after version 142.
Also, until version 142, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive recognized the name
<tt>"-"</tt>

as denoting standard input, and
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
recognized it as standard output. These behaviors were also removed;
versions after 142 recognize this convention only when it appears
as a command line argument.  Lastly, until version 142, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
directive evaluated the
<tt><i>destination</i></tt>
argument as an expression of the <b>TXR</b> pattern language, requiring
<tt>@</tt>
to be used to denote a Lisp expression. This is no longer required.
All these old behaviors are provided
if compatibility with 142 or earlier is requested.
</dd><dt>139</dt><dd>
After <b>TXR</b> 139, changes were implemented in the area of pseudo-random
number generation. Compatibility with 139 brings back the previous
seeding algorithm used by
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032BEE6C">make-rand=
om-state</a></tt>,
allowing the old pseudo-random sequences to be reproduced. This is only
the case if the default value of 8 is used for the
<tt><i>warmup-period</i></tt>
argument of that function (which didn't exist in 139 or earlier versions).
</dd><dt>138</dt><dd>
After <b>TXR</b> 138, the variable name lookup rules in the <b>TXR</b> patt=
ern language
changed for greater utility and consistency. Compatibility with 138 or late=
r
restores the previous rules under which most accesses to a <b>TXR Lisp</b> =
variable from
<b>TXR Lisp</b> require the
<tt>@</tt>
prefix denoting Lisp evaluation, but some do not.
</dd><dt>137</dt><dd>
Compatibility with <b>TXR</b> 137 restores the behavior of not expanding
symbol macros in the dot position of a function call form. For instance
if
<tt>x</tt>
is a symbol macro, in this compatibility mode it is not recognized
in a form like
<tt>(list 1 2 . x)</tt>.
This preserves the behavior of code which depends on
<tt>x</tt>
in such a form to refer to a variable that is being otherwise shadowed by t=
he
symbol macro. <b>TXR</b> 137 compatibility also restores a particular behav=
ior
of the global and local macro defining operators
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0080256D">defsymacr=
o</a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>:
in compatibility mode, these operators macro-expand the replacement forms
of symbol macros at expansion time, and then bind the resulting expanded
forms to their respective macro symbols. The forms are then potentially
expanded again when the symbol macros are substituted. This wrong behavior =
was
never implied by the documentation. The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C411A2">with-slot=
s</a></tt>
macro is also affected by this, because it is implemented in terms of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00321AB1">symacrole=
t</a></tt>.
Lastly, <b>TXR</b> 137 compatibility mode also restores another behavior
of the dot position in function call forms: if the dot position of a
function call form produces a sequence that is not a list, that sequence
is converted to a list so that
<tt>

(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0206CE91">list</a> . "=
abc")
</tt>

produces
<tt>(#\a #\b #\c)</tt>.
After 137, no such treatment is applied to the value and the same form now
yields
<tt>"abc"</tt>.
</dd><dt>136</dt><dd>
A request for compatibility with <b>TXR</b> 136 or earlier restores the old=
 behavior
of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0039">if</a></tt>
directive, which in used to be a syntactic sugar for a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-039458F2">cases</a>=
</tt>
directive with
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0075">require</a></=
tt>
at the top of each block. Though semantically well-defined and working as
documented, the behavior was confusing, since failed matching caused potent=
ial
evaluation of multiple clauses, whereas programmers expect an if/elif/else
ladder to select exactly one clause.
</dd><dt>128</dt><dd>
Compatibility with <b>TXR</b> 128 or earlier brings back the behavior that
expressions in quasiliterals are evaluated according to <b>TXR</b> evaluati=
on
rules for quasiliterals which occur in the <b>TXR</b> pattern language.
Similarly, expressions in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
blocks are treated <b>TXR</b> pattern language expressions.
</dd><dt>127</dt><dd>
In versions of <b>TXR</b> until 127, the functions
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00004DDC">symbol-fu=
nction</a></tt>,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01FBF828">fboundp</=
a></tt>
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02964FC0">fmakunbou=
nd</a></tt>
behaved similarly to their Common Lisp counterparts. See the Dialect Notes
under these functions.
</dd><dt>124</dt><dd>
In <b>TXR</b> 124 and earlier versions, the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0056">next</a>)</=
tt>
directive didn't evaluate the
<tt><i>source</i></tt>
argument as a Lisp expression, but as a <b>TXR</b> pattern language
expression. Lisp expressions thus had to be delimited by
<tt>@</tt>.
The current behavior is that the argument is treated as Lisp.
If the compatibility option is set to 124 or lower, the old behavior
is restored. However, even without the presence of the compatibility option=
,
if the
<tt><i>source</i></tt>
argument is a meta-expression or meta-symbol (denotes by the
<tt>@</tt>
prefix in front of a compound expression or symbol, respectively)
it is also treated in the old way. This latter behavior is obsolescent
and will eventually disappear, and the compatibility option will be
the only way to get the old behavior.
<p>
</p></dd><dt>123</dt><dd>
In <b>TXR</b> 123 and earlier, the variable initialization forms of a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for</a></=
tt>
or
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031372ED">for*</a><=
/tt>
loop were evaluated outside of the scope of the implicit
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
block. They are now inside the block. The compatibility option will
restore the old behavior.
</dd><dt>121</dt><dd>
In <b>TXR</b> 121 and earlier versions, <b>TXR Lisp</b> expressions evaluat=
ed in the
pattern language were placed in a lexical environment in which the
pattern variables were visible as lexical variables. The meant that
these variables could be directly captured in lexical closures. On the othe=
r
hand, it meant that a Lisp function defined in a
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0061">do</a>)</tt=
>
block could not access a variable established by a later
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0057">bind</a>)</=
tt>.
It doesn't make sense for dynamically captured variables to be lexical,
so the rule was changed. The backward compatibility switch will enable
the old scoping behavior. Capturing the values of pattern variables in
closures is possible indirectly under the new rule: simply bind new lexical
variables with their values.
</dd><dt>118</dt><dd>
The
<tt>slot-p</tt>
function's name changed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B90177">slotp</a>=
</tt>
after 118. The compatibility option causes
<tt>slot-p</tt>
to be defined also.
<p>
</p></dd><dt>117</dt><dd>
The arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022EEF2D">make-stru=
ct-type</a></tt>
acquired changed after version 117. 117 compatibility brings back the old
interface.
<p>
</p></dd><dt>114</dt><dd>
<b>TXR</b> until version 114 reported parse errors in this format:
<p>
<tt>
</tt></p><pre><tt>  ./txr: (file.txr:123): syntax error
</tt></pre><tt>

</tt>

<p>
The new format omits the program name prefix and parentheses.
</p><p>
Also, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0386CCD5">kill</a><=
/tt>
function returned an integer, obtained from the return
value of the underlying C function, rather than converting
that value to a Boolean. The old behavior was not documented,
and 114 compatibility restores it.
</p><p>
Lastly, prior to 115, random state objects were of type
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033875AD">*random-s=
tate*</a></tt>
(the same symbol as the special variable name)
rather than of type
<tt>random-state</tt>.
This is a bug whose behavior is simulated by 114 compatibility.
</p><p>
</p></dd><dt>113</dt><dd>
Version 113 is the last version in which the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0029">stat</a></tt>=
,
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">lstat</a>=
</tt>,
and
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">fstat</a>=
</tt>
functions returned a property list rather than a structure.
Requesting 113 compatibility restores the behavior of returning
a property list. However, the filesystem testing functions like
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03C41AE2">path-exis=
ts-p</a></tt>
will not work, because they rely on these functions returning
a structure.
<p>
</p></dd><dt>109</dt><dd>
The optional trailing semicolon on hex and octal codes in the <b>TXR</b>pat=
tern language was introduced in 110. The feature is disabled
with 109 or lower compatibility, so that
<tt>@\x21;a</tt>
encodes
<tt>!;a</tt>
rather than the current behavior of encoding
<tt>!a</tt>.
Also, in 109 and earlier, newlines were allowed in word list literals and
word list quasiliterals. They were treated as a word-separating space.
A backslash-escaped newline, and all whitespace around it, was deleted
just like in ordinary literals, and did not separate words. The old
behavior is emulated.
<p>
</p></dd><dt>107</dt><dd>
Up through <b>TXR</b> 107, by accident, there was a function called
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0042153F">flip</a><=
/tt>
as well as an operator by the same name. The function was renamed to
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02D06BA4">flipargs<=
/a></tt>.
Version 107 compatibility or earlier provides the
function under the original name also. Also, up until this version,
<b>TXR</b> allowed functions and macros to be defined with the same names
as built-in operators, and macros. Newer versions reject this as an error.
Requesting compatibility to 107 or earlier suppresses the rejection,
though without introducing any requirement that redefinition will work as
expected.
<p>
</p></dd><dt>105</dt><dd>
Provides the behavior that the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B8FBBD">open-file=
</a></tt>
function automatically marks a stream open on a TTY devices as a real-time =
stream
(subject to the availability of the POSIX
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03709E8A">isatty</a=
></tt>
function).
<p>
Also allows unrecognized backslash escape sequences in regular
expression syntax to simply denote the escaped character literally,
as was historically the case prior to <b>TXR</b> 106, so that
<tt>\z</tt>
for instance denotes
<tt>z</tt>.
As of <b>TXR</b> 106, these are diagnosed as errors.
</p><p>
</p></dd><dt>102</dt><dd>
Up to <b>TXR</b> 102, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00BE9AAC">get-strin=
g</a></tt>
function did not close the stream. This old behavior is emulated.
<p>
</p></dd><dt>101</dt><dd>
Up to <b>TXR</b> 101, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01C1D23C">make-like=
</a></tt>
function incorrectly returned
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
when converting the empty list
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
to string type. This affects numerous generic sequence functions,
causing their result to be
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
instead of an empty string.
<p>
</p></dd><dt>100</dt><dd>
Up to <b>TXR</b> 100, the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000386B4">split-str=
</a></tt>
function had an undocumented behavior. When the
<tt>sep</tt>
argument was an empty string, it split the string into
individual characters as if by calling
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0236023D">list-str<=
/a></tt>.
This behavior changed to the currently
documented behavior starting in <b>TXR</b> 101.
Also, the arguments of the
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0208F1DE">where</a>=
</tt>
function, which introduced in <b>TXR</b> 91, were reversed starting
in <b>TXR</b> 101.
<p>
</p></dd><dt>99</dt><dd>
Up to <b>TXR</b> 99, the substitution of TXR Lisp expressions in
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
directives and in the quasistrings of the pattern language
exhibited the buggy behavior that if the TXR Lisp expression
produced a list, the list was rendered as a parenthesized
representation, or the text
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015134D8">nil</a></=
tt>
in the empty list case. Moreover, in the
<tt>@(<a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0159EBE7">output<=
/a>)</tt>
case, the value of TXR Lisp expressions was not subject to filtering. Start=
ing with <b>TXR</b> 100, these issues
are fixed, making the the behavior is consistent with
the behavior of TXR Lisp quasiliterals.
</dd><dt>97</dt><dd>
Up to <b>TXR</b> 97, the error exception symbols such as
<tt>file-error</tt>
were named with underscores, as in
<tt>file_error</tt>.
These error symbols existed:
<tt>type_error</tt>,
<tt>internal_error</tt>,
<tt>numeric_error</tt>,
<tt>range_error</tt>,
<tt>query_error</tt>,
<tt>file_error</tt>
and
<tt>process_error</tt>.
<p>

</p></dd></dl>
<a name=3D"N-032F57D4">&nbsp;</a>
<h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-16.5">16.5</a> Va=
riables <tt>txr-version</tt> and <tt>lib-version</tt></h3>



<p>



</p><dl>
<dt>Description:</dt><dd>
<p>



The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032F57D4">txr-versi=
on</a></tt>
variable gives the version of the <b>TXR</b> executable. Programs can expre=
ss
conditional variable based on detecting the version.
</p><p>
The
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-032F57D4">lib-versi=
on</a></tt>
variable gives the version of the installed library of <b>TXR</b> code acco=
mpanying
the executable.
</p><p>
It is expected that these two variables have an identical value. Any
discrepancy in their value indicates an installation whose library or <b>TX=
R</b>executable were upgraded independently. Should such a situation arise =
in any
system and cause a problem, <b>TXR</b> programs can be defensively coded ag=
ainst it
with the help of these variables.
</p><p>
Some features of the <b>TXR</b> library are built into the executable, wher=
eas
others are in the library directory. This aspect of library symbols isn't
specified in this manual; knowing which of these two variables is relevant
to a library feature requires familiarity with the implementation.
</p><p>
</p></dd></dl>
<a name=3D"N-014A29D1">&nbsp;</a>
<h2><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-17">17</a> APPEND=
IX</h2>




<p>


<a name=3D"N-03D86EEC">&nbsp;</a>
</p><h3><a href=3D"http://nongnu.org/txr/txr-manpage.html#TOC-17.1">17.1</a=
> A. NOTES ON EXOTIC REGULAR EXPRESSIONS</h3>



<p>


Users familiar with regular expressions may not be familiar with the comple=
ment
and intersection operators, which are often absent from text processing too=
ls
that support regular expressions.  The following remarks are offered in the
hope that they may be of some use.
</p><p>
</p><dl>
<dt>Equivalence to Sets</dt><dd>
<p>


Regexp intersection is not essential; it may be obtained from complement an=
d
union as follows, since De Morgan's law applies to regular expression algeb=
ra:
<tt>(R1)&amp;(R2)</tt>
=3D
<tt>~(~(R1)|~(R2))</tt>.
(The complement of the union of the complements of
R1 and R2 constitutes the intersection.) This law works because the regular
expression operators denote set operations in a straightforward way. A regu=
lar
expression denotes a set of strings (a potentially infinite one) in a conde=
nsed
way. The union of two regular expressions
<tt>R1|R2</tt>
denotes the union of the set
of texts denoted by
<tt>R1</tt>
and that denoted by
<tt>R2</tt>.
Similarly
<tt>R1&amp;R2</tt>
denotes a set intersection, and
<tt>~R</tt>
denotes a set complement. Thus algebraic laws
that apply to set operations apply to regular expressions. It's useful to k=
eep
in mind this relationship between regular expressions and sets in understan=
ding
intersection and complement.
</p><p>
Given a finite set of strings, like the set
<tt>

{ "abc", "def" }
</tt>

which corresponds to the regular expression
<tt>(abc|def)</tt>,
the complement is the set which contains
an infinite number of strings: it consists of all possible strings except
<tt>"abc"</tt>

and
<tt>"def"</tt>.
It includes the empty string, all strings of length 1, all strings
of length 2, all strings of length 3 other than
<tt>"abc"</tt>

and
<tt>"def"</tt>,
all strings of
length 4, etc.  This means that a "harmless looking" expression like
<tt>~(abc|def)</tt>
can actually match arbitrarily long inputs.
</p><p>
</p></dd><dt>Set Difference</dt><dd>
<p>


How about matching only three-character-long strings other than
<tt>"abc"</tt>

or
<tt>"def"</tt>?
To express this, regex intersection can be used: these strings are the
intersection of the set of all three-character strings, and the set of all
strings which are not
<tt>"abc"</tt>

or
<tt>"def"</tt>.
The straightforward set-based reasoning
leads us to this:
<tt>...&amp;~(abc|def)</tt>.
This
<tt>A&amp;~B</tt>
idiom is also called set
difference, sometimes notated with a minus sign:
<tt>A-B</tt>
(which is not supported in <b>TXR</b> regular expression syntax).  Elements=
 which
are in the set
<tt>A</tt>,
but not
<tt>B</tt>,
are those elements which are in the intersection of
<tt>A</tt>
with the complement of
<tt>B</tt>.
This is similar to the arithmetic rule
<tt>A - B =3D A + -B</tt>:
subtraction is
equivalent to addition of the additive inverse. Set difference is a useful
tool: it enables us to write a positive match which captures a more general=
 set
than what is intended (but one whose regular expression is far simpler
than a positive match for the exact set we want), then we can
intersect this over-generalized set with the complemented set of
another regular expression which matches the particulars that we wish exclu=
ded.
</p><p>
</p></dd><dt>Expressiveness versus Power</dt><dd>
<p>


</p><p>
It turns out that regular expressions which do not make use of the
complement or intersection operators are just as powerful as expressions
that do. That is to say, with or without these operators, regular expressio=
ns
can match the same sets of strings (all regular languages).  This means tha=
t
for a given regular expression which uses intersection and complement, it i=
s
possible to find a regular expression which doesn't use these operators, ye=
t
matches the same set of strings.  But, though they exist, such equivalent
regular expressions are often much more complicated, which makes them diffi=
cult
to design.  Such expressions do not necessarily
<b>express</b>

what it is they match; they merely capture the equivalent set. They
perform a job, without making it obvious what it is they do.  The use of
complement and intersection leads to natural ways of expressing many kinds =
of
matching sets, which not only demonstrate the power to carry out an operati=
on,
but also easily express the concept.
</p><p>
</p></dd><dt>Example: Matching C Language Comments</dt><dd>
<p>


</p><p>
For instance, using complement, we can write a straightforward regular
expression which matches C language comments. A C language
comment is the digraph
<tt>/*</tt>,
followed by any string which does not contain the
closing sequence
<tt>*/</tt>,
followed by that closing sequence.
Examples of valid comments are
<tt>/**/</tt>,
<tt>/* abc */</tt>
or
<tt>/***/</tt>.
But C
comments do not nest (cannot contain comments), so that <tt>/* /* nested */=
 */</tt>
actually consists of the comment
<tt>/* /* nested */</tt>,
which is followed by the trailing junk
<tt>*/</tt>.
Our simple characterization of the interior part of a C comment as a string
which does not contain the terminating digraph makes use of the
complement, and can be expressed using the complemented regular expression =
like
this:
<tt>(~.*[*][/].*)</tt>.
That is to say, strings which contain
<tt>*/</tt>
are matched by
the expression
<tt>.*[*][/].*</tt>:
zero or more arbitrary characters, followed by
<tt>*/</tt>,
followed by zero or more arbitrary characters. Therefore, the complement of
this expression matches all other strings: those which do not contain
<tt>*/</tt>.
These strings make up the inside of a C comment between the
<tt>/*</tt>
and
<tt>*/</tt>.
</p><p>
The equivalent simple regex is quite a bit more complicated.
Without complement, we must somehow write a positive match for all strings =
such
that we avoid matching
<tt>*/</tt>.
Obviously, sequences of characters other than
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
are included:
<tt>[^*]*</tt>.
Occurrences of
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
are also allowed, but only if followed
by something other than a slash, so let's include this via union:
</p><p>
<tt>
</tt></p><pre><tt>  ([^*]|[*][^/])*.
</tt></pre><tt>

</tt>

<p>
Alas, we already have a bug in this expression. The
subexpression
<tt>[*][^/]</tt>
can match
<tt>**</tt>,
since a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-022396F7">*</a></tt=
>
is not a
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>.
If the next character in the input is
<tt><a href=3D"http://nongnu.org/txr/txr-manpage.html#D-0007">/</a></tt>,
we missed a comment close.  To fix the problem we
revise to this:
</p><p>
<tt>
</tt></p><pre><tt>  ([^*]|[*][^*/])*
</tt></pre><tt>

</tt>

<p>
(The interior of a C language comment is any
mixture of zero or more non-asterisks, or digraphs consisting of an asteris=
k
followed by something other than a slash or another asterisk).  Oops, now w=
e
have a problem again. What if two asterisks occur in a comment?  They are n=
ot
matched by
<tt>[^*]</tt>,
and they are not matched by
<tt>[*][^*/]</tt>.
Actually, our regex must not simply match asterisk-non-asterisk digraphs, b=
ut
rather sequences of one or more asterisks followed by a non-asterisk: </p><=
p>
<tt>
</tt></p><pre><tt>  ([^*]|[*]*[^*/])*
</tt></pre><tt>

</tt>

<p>
This is still not right, because, for instance, it fails to match the inter=
ior
of a comment which is terminated by asterisks, including the simple test ca=
ses
where the comment interior is nothing but asterisks.  We have no provision =
in
our expression for this case; the expression requires all runs of asterisks=
 to
be followed by something which is not a slash or asterisk. The way to fix t=
his
is to add on a subexpression which optionally matches a run of zero or more
interior asterisks before the comment close:
</p><p>
<tt>
</tt></p><pre><tt>  ([^*]|[*]*[^*/])*[*]*
</tt></pre><tt>

</tt>

<p>
Thus the semi-final regular expression is
</p><p>
<tt>
</tt></p><pre><tt>  [/][*]([^*]|[*]*[^*/])*[*]*[*][/]
</tt></pre><tt>

</tt>

<p>
(Interpretation: a C comment is an interior string enclosed in
<tt>/* */</tt>,
where this interior part
consists of a mixture of non-asterisk characters, as well as runs of asteri=
sk
characters which are terminated by a character other than a slash, except f=
or
possibly one rightmost run of asterisks which extends to the end of the
interior, touching the comment close. Phew!) One final simplification is
possible: the tail part
<tt>[*]*[*][/]</tt>
can be reduced to
<tt>[*]+[/]</tt>
such that the
final run of asterisks is regarded as part of an extended comment terminato=
r
which consists of one or more asterisks followed by a slash.   The regular
expression works, but it's cryptic; to someone who has not developed it, it
isn't obvious what it is intended to match.  Working out complemented match=
ing
without complement support from the language is not impossible, but it may =
be
difficult and error-prone, possibly requiring multiple iterations of
trial-and-error development involving numerous test cases, resulting in an
expression that doesn't have a straightforward relationship to the original
idea.
</p><p>
</p></dd><dt>The Non-Greedy Operator</dt><dd>
<p>


</p><p>
The non-greedy operator
<tt>%</tt>
is actually defined in terms of a set difference,
which is in turn based on intersection and complement. The uninteresting ca=
se
<tt>(R%)</tt>
where the right operand is empty reduces to <tt>(R*)</tt>:
if there is no trailing
context, the non-greedy operator matches
<tt>R</tt>
as far as possible, possibly to the
end of the input, exactly like the greedy operator.  The interesting case
<tt>(R%T)</tt>
is defined as a "syntactic sugar" which expands to the expression
<tt>((R*)&amp;(~.*(T&amp;.+).*))T</tt>
which means: match the longest string which is matched
by
<tt>R*</tt>,
but which does not contain a non-empty match for
<tt>T</tt>;
then, match
<tt>T</tt>.
This is a useful and expressive notation. With it, we can write the regular
expression for matching C language comments simply like this:
<tt>[/][*].%[*][/]</tt>
(match the opening sequence
<tt>/*</tt>,
then match a sequence of zero or more
characters non-greedily, and then the closing sequence
<tt>*/</tt>.
With the non-greedy
operator, we don't have to think about the interior of the comment as set o=
f
strings which excludes
<tt>*/</tt>.
Though the non-greedy operator appears expressive,
its apparent simplicity may be deceptive.  It looks as if it works "magical=
ly"
by itself; "somehow" this
<tt>.%</tt>
part "knows" only to consume enough characters so that
it doesn't swallow an occurrence of the trailing context. Care must be take=
n
that the trailing context passed to the operator really is the correct text
that should be excluded by the non-greedy match. For instance, take the
expression
<tt>.%abc</tt>.
If you intend the trailing context to be merely
<tt>a</tt>,
you must be careful to write
<tt>(.%a)bc</tt>.
Otherwise, the trailing context is
<tt>abc</tt>,
and this means that the
<tt>.%</tt>
match will consume the longest string that does not contain
<tt>abc</tt>,
when in fact what was intended was to consume the longest string that
does not contain
<tt>a</tt>.
The change in behavior of the
<tt>%</tt>
operator upon modifying the
trailing context is not as intuitive as that of the * operator, because the
trailing context is deeply involved in its logic.
</p><p>
On a related note, for single-character trailing contexts, it may be a good
idea to use a complemented character class instead. That is to say, rather =
than
<tt>(.%a)bc</tt>,
consider
<tt>[^a]*abc</tt>.
The set of strings which don't contain the
character a is adequately expressed by
<tt>[^a]*</tt>.
</p><p>
</p></dd></dl>

<div class=3D"disambiguations">
<a name=3D"D-0059">
  <p>Topics matching <tt>sign-extend</tt>:
  </p></a><dl><a name=3D"D-0059">
    </a><dt><a name=3D"D-0059"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-026F9F46">1:</a> Function <tt>sign-extend</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01EFD64C">2:</a=
> Method <tt>sign-extend</tt></dt>
  </dl>

<a name=3D"D-003B">
  <p>Topics matching <tt>get-byte</tt>:
  </p></a><dl><a name=3D"D-003B">
    </a><dt><a name=3D"D-003B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01EF7E47">1:</a> Functions <tt>get-line</tt>, <tt>get-char</tt>=
 and <tt>get-byte</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00963754">2:</a=
> Method <tt>get-byte</tt></dt>
  </dl>

<a name=3D"D-002C">
  <p>Topics matching <tt>buf</tt>:
  </p></a><dl><a name=3D"D-002C">
    </a><dt><a name=3D"D-002C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-038187CC">1:</a> The <tt>buf</tt> type</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0384A6E7">2:</a=
> FFI types <tt>buf</tt> and <tt>buf-d</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A6E963">3:</a=
> FFI types <tt>buf</tt> and <tt>buf-d</tt></dt>
  </dl>

<a name=3D"D-0028">
  <p>Topics matching <tt>merge</tt>:
  </p></a><dl><a name=3D"D-0028">
    </a><dt><a name=3D"D-0028"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0252B14E">1:</a> The <tt>merge</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01093AE7">2:</a=
> Function <tt>merge</tt></dt>
  </dl>

<a name=3D"D-0009">
  <p>Topics matching <tt>-</tt>:
  </p></a><dl><a name=3D"D-0009">
    </a><dt><a name=3D"D-0009"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01F56DFE">1:</a> Functions <tt>+</tt> and <tt>-</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B396F7">2:</a=
> Method <tt>-</tt></dt>
  </dl>

<a name=3D"D-0055">
  <p>Topics matching <tt>collect</tt>:
  </p></a><dl><a name=3D"D-0055">
    </a><dt><a name=3D"D-0055"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-016E0310">1:</a> The <tt>collect</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014CE43D">2:</a=
> The <tt>until</tt> / <tt>last</tt> clause in <tt>collect</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-037F7135">3:</a=
> Keyword parameters in <tt>collect</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020EDAFF">4:</a=
> Specifying variables in <tt>collect</tt></dt>
  </dl>

<a name=3D"D-007D">
  <p>Topics matching <tt>print</tt>:
  </p></a><dl><a name=3D"D-007D">
    </a><dt><a name=3D"D-007D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F8B869">1:</a> Method <tt>print</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02FCCE0D">2:</a=
> Functions <tt>print</tt>, <tt>pprint</tt>, <tt>prinl</tt>, <tt>pprinl</tt=
>, <tt>tostring</tt> and <tt>tostringp</tt></dt>
  </dl>

<a name=3D"D-0024">
  <p>Topics matching <tt>lognot</tt>:
  </p></a><dl><a name=3D"D-0024">
    </a><dt><a name=3D"D-0024"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-006B7321">1:</a> Functions <tt>lognot</tt> and <tt>logtrunc</tt=
></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-031D8ED1">2:</a=
> Method <tt>lognot</tt></dt>
  </dl>

<a name=3D"D-0002">
  <p>Topics matching <tt>round</tt>:
  </p></a><dl><a name=3D"D-0002">
    </a><dt><a name=3D"D-0002"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02084F55">1:</a> Functions <tt>trunc</tt>, <tt>floor</tt>, <tt>=
ceil</tt> and <tt>round</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F8B9F8">2:</a=
> Method <tt>round</tt></dt>
  </dl>

<a name=3D"D-0075">
  <p>Topics matching <tt>require</tt>:
  </p></a><dl><a name=3D"D-0075">
    </a><dt><a name=3D"D-0075"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0222EE5F">1:</a> The <tt>require</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0268BD16">2:</a=
> Pattern operator <tt>require</tt></dt>
  </dl>

<a name=3D"D-0026">
  <p>Topics matching <tt>coll</tt>:
  </p></a><dl><a name=3D"D-0026">
    </a><dt><a name=3D"D-0026"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-031B6F7D">1:</a> The <tt>coll</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0357BB7E">2:</a=
> Keyword parameters in <tt>coll</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02C98DE1">3:</a=
> Pattern operator <tt>coll</tt></dt>
  </dl>

<a name=3D"D-0015">
  <p>Topics matching <tt>atan2</tt>:
  </p></a><dl><a name=3D"D-0015">
    </a><dt><a name=3D"D-0015"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D8FB88">2:</a=
> Method <tt>atan2</tt></dt>
  </dl>

<a name=3D"D-0007">
  <p>Topics matching <tt>/</tt>:
  </p></a><dl><a name=3D"D-0007">
    </a><dt><a name=3D"D-0007"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-008424F7">1:</a> Function <tt>/</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01D396F7">2:</a=
> Method <tt>/</tt></dt>
  </dl>

<a name=3D"D-001D">
  <p>Topics matching <tt>unget-char</tt>:
  </p></a><dl><a name=3D"D-001D">
    </a><dt><a name=3D"D-001D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0260DBDD">1:</a> Functions <tt>unget-char</tt> and <tt>unget-by=
te</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DC39A">2:</a=
> Method <tt>unget-char</tt></dt>
  </dl>

<a name=3D"D-0072">
  <p>Topics matching <tt>asin</tt>:
  </p></a><dl><a name=3D"D-0072">
    </a><dt><a name=3D"D-0072"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0186CA8D">2:</a=
> Method <tt>asin</tt></dt>
  </dl>

<a name=3D"D-005C">
  <p>Topics matching <tt>square</tt>:
  </p></a><dl><a name=3D"D-005C">
    </a><dt><a name=3D"D-005C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-012730BE">1:</a> Function <tt>square</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0129DBF6">2:</a=
> Method <tt>square</tt></dt>
  </dl>

<a name=3D"D-0019">
  <p>Topics matching <tt>flatten</tt>:
  </p></a><dl><a name=3D"D-0019">
    </a><dt><a name=3D"D-0019"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02BF4BBC">1:</a> The <tt>flatten</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0226672B">2:</a=
> Functions <tt>flatten</tt> and <tt>flatten*</tt></dt>
  </dl>

<a name=3D"D-0001">
  <p>Topics matching <tt>hash</tt>:
  </p></a><dl><a name=3D"D-0001">
    </a><dt><a name=3D"D-0001"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-020988A5">1:</a> Pattern operator <tt>hash</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-026D4158">2:</a=
> Functions <tt>make-hash</tt> and <tt>hash</tt></dt>
  </dl>

<a name=3D"D-005F">
  <p>Topics matching <tt>...</tt>:
  </p></a><dl><a name=3D"D-005F">
    </a><dt><a name=3D"D-005F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00209CEE">1:</a> Accessors <tt>caar</tt>, <tt>cadr</tt>, <tt>cd=
ar</tt>, <tt>cddr</tt>, <tt>...</tt> and <tt>cdddddr</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03F9BE17">2:</a=
> Variables <tt>*0</tt>, <tt>*1</tt>, <tt>*2</tt>, <tt>...</tt>, <tt>*99</t=
t></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B67C9B">3:</a=
> Symbol Macros <tt>*-1</tt>, <tt>*-2</tt>, <tt>...</tt>, <tt>*-20</tt></dt=
>
  </dl>

<a name=3D"D-0021">
  <p>Topics matching <tt>get-error-str</tt>:
  </p></a><dl><a name=3D"D-0021">
    </a><dt><a name=3D"D-0021"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01060C4A">1:</a> Functions <tt>get-error</tt>, <tt>get-error-st=
r</tt> and <tt>clear-error</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F46C69">2:</a=
> Method <tt>get-error-str</tt></dt>
  </dl>

<a name=3D"D-007E">
  <p>Topics matching <tt>cosh</tt>:
  </p></a><dl><a name=3D"D-007E">
    </a><dt><a name=3D"D-007E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01DC05E9">1:</a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>ta=
nh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0366CA96">2:</a=
> Method <tt>cosh</tt></dt>
  </dl>

<a name=3D"D-0073">
  <p>Topics matching <tt>iter-more</tt>:
  </p></a><dl><a name=3D"D-0073">
    </a><dt><a name=3D"D-0073"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00889268">1:</a> Method <tt>iter-more</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B6130D">2:</a=
> Function <tt>iter-more</tt></dt>
  </dl>

<a name=3D"D-002F">
  <p>Topics matching <tt>set</tt>:
  </p></a><dl><a name=3D"D-002F">
    </a><dt><a name=3D"D-002F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-032AAE1B">1:</a> The <tt>set</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033F39EB">2:</a=
> Macro <tt>set</tt></dt>
  </dl>

<a name=3D"D-004F">
  <p>Topics matching <tt>lambda</tt>:
  </p></a><dl><a name=3D"D-004F">
    </a><dt><a name=3D"D-004F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00FAFD10">1:</a> Operator <tt>lambda</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02E775FE">2:</a=
> Method <tt>lambda</tt></dt>
  </dl>

<a name=3D"D-006F">
  <p>Topics matching <tt>put-string</tt>:
  </p></a><dl><a name=3D"D-006F">
    </a><dt><a name=3D"D-006F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-012163C3">1:</a> Functions <tt>put-string</tt>, <tt>put-line</t=
t>, <tt>put-char</tt> and <tt>put-byte</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0376A37F">2:</a=
> Method <tt>put-string</tt></dt>
  </dl>

<a name=3D"D-0065">
  <p>Topics matching <tt>logtrunc</tt>:
  </p></a><dl><a name=3D"D-0065">
    </a><dt><a name=3D"D-0065"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-006B7321">1:</a> Functions <tt>lognot</tt> and <tt>logtrunc</tt=
></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-000B2006">2:</a=
> Method <tt>logtrunc</tt></dt>
  </dl>

<a name=3D"D-002A">
  <p>Topics matching <tt>trunc</tt>:
  </p></a><dl><a name=3D"D-002A">
    </a><dt><a name=3D"D-002A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02084F55">1:</a> Functions <tt>trunc</tt>, <tt>floor</tt>, <tt>=
ceil</tt> and <tt>round</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E8C8B8">2:</a=
> Method <tt>trunc</tt></dt>
  </dl>

<a name=3D"D-006C">
  <p>Topics matching <tt>finally</tt>:
  </p></a><dl><a name=3D"D-006C">
    </a><dt><a name=3D"D-006C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03054775">1:</a> Interaction Between <tt>finally</tt> and the <=
tt>accept</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0134EBD1">2:</a=
> The <tt>finally</tt> clause</dt>
  </dl>

<a name=3D"D-0041">
  <p>Topics matching <tt>del</tt>:
  </p></a><dl><a name=3D"D-0041">
    </a><dt><a name=3D"D-0041"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0166445C">1:</a> Methods <tt>del</tt> and <tt>del*</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BF3A07">2:</a=
> Macro <tt>del</tt></dt>
  </dl>

<a name=3D"D-001E">
  <p>Topics matching <tt>tree-insert-node</tt>:
  </p></a><dl><a name=3D"D-001E">
    </a><dt><a name=3D"D-001E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-008B4AD9">1:</a> Function <tt>tree-insert-node</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-034ADC20">2:</a=
> Function <tt>tree-insert-node</tt></dt>
  </dl>

<a name=3D"D-007B">
  <p>Topics matching <tt>accept</tt>:
  </p></a><dl><a name=3D"D-007B">
    </a><dt><a name=3D"D-007B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01AC9294">1:</a> Interaction Between the <tt>trailer</tt> and <=
tt>accept</tt> Directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01188822">2:</a=
> Interaction Between the <tt>next</tt> and <tt>accept</tt> Directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B71A20">3:</a=
> Interaction Between Functions and the <tt>accept</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03054775">4:</a=
> Interaction Between <tt>finally</tt> and the <tt>accept</tt> directive</d=
t>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005E1D6C">5:</a=
> Vertical-Horizontal Mismatch Between <tt>block</tt> and <tt>accept</tt></=
dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A72FC6">6:</a=
> Horizontal-Horizontal Mismatch between <tt>block</tt> and <tt>accept</tt>=
</dt>
  </dl>

<a name=3D"D-0053">
  <p>Topics matching <tt>put-byte</tt>:
  </p></a><dl><a name=3D"D-0053">
    </a><dt><a name=3D"D-0053"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-012163C3">1:</a> Functions <tt>put-string</tt>, <tt>put-line</t=
t>, <tt>put-char</tt> and <tt>put-byte</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01963753">2:</a=
> Method <tt>put-byte</tt></dt>
  </dl>

<a name=3D"D-0011">
  <p>Topics matching <tt>atan</tt>:
  </p></a><dl><a name=3D"D-0011">
    </a><dt><a name=3D"D-0011"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0186CA7F">2:</a=
> Method <tt>atan</tt></dt>
  </dl>

<a name=3D"D-0045">
  <p>Topics matching <tt>sinh</tt>:
  </p></a><dl><a name=3D"D-0045">
    </a><dt><a name=3D"D-0045"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01DC05E9">1:</a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>ta=
nh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0266D697">2:</a=
> Method <tt>sinh</tt></dt>
  </dl>

<a name=3D"D-0070">
  <p>Topics matching <tt>tan</tt>:
  </p></a><dl><a name=3D"D-0070">
    </a><dt><a name=3D"D-0070"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0239F61E">2:</a=
> Method <tt>tan</tt></dt>
  </dl>

<a name=3D"D-005A">
  <p>Topics matching <tt>block</tt>:
  </p></a><dl><a name=3D"D-005A">
    </a><dt><a name=3D"D-005A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0298769A">1:</a> The <tt>block</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005E1D6C">2:</a=
> Vertical-Horizontal Mismatch Between <tt>block</tt> and <tt>accept</tt></=
dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02A72FC6">3:</a=
> Horizontal-Horizontal Mismatch between <tt>block</tt> and <tt>accept</tt>=
</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02F60DCE">4:</a=
> Operators <tt>block</tt> and <tt>block*</tt></dt>
  </dl>

<a name=3D"D-006A">
  <p>Topics matching <tt>=3D</tt>:
  </p></a><dl><a name=3D"D-006A">
    </a><dt><a name=3D"D-006A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02A1116F">1:</a> Functions <tt>&gt;</tt>, <tt>&lt;</tt>, <tt>&g=
t;=3D</tt>, <tt>&lt;=3D</tt> and <tt>=3D</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02B396F7">2:</a=
> Method <tt>=3D</tt></dt>
  </dl>

<a name=3D"D-0027">
  <p>Topics matching <tt>cptr</tt>:
  </p></a><dl><a name=3D"D-0027">
    </a><dt><a name=3D"D-0027"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F7EE55">1:</a> The <tt>cptr</tt> type</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-019DE724">2:</a=
> FFI type <tt>cptr</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E726E5">3:</a=
> FFI type <tt>cptr</tt></dt>
  </dl>

<a name=3D"D-0074">
  <p>Topics matching <tt>zerop</tt>:
  </p></a><dl><a name=3D"D-0074">
    </a><dt><a name=3D"D-0074"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0197FF9D">1:</a> Functions <tt>zerop</tt> and <tt>nzerop</tt></=
dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B8A374">2:</a=
> Method <tt>zerop</tt></dt>
  </dl>

<a name=3D"D-005E">
  <p>Topics matching <tt>iter-step</tt>:
  </p></a><dl><a name=3D"D-005E">
    </a><dt><a name=3D"D-005E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00387731">1:</a> Method <tt>iter-step</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0205F7AB">2:</a=
> Function <tt>iter-step</tt></dt>
  </dl>

<a name=3D"D-0056">
  <p>Topics matching <tt>next</tt>:
  </p></a><dl><a name=3D"D-0056">
    </a><dt><a name=3D"D-0056"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0131C606">1:</a> The <tt>next</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01188822">2:</a=
> Interaction Between the <tt>next</tt> and <tt>accept</tt> Directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03820F9E">3:</a=
> Macro <tt>next</tt></dt>
  </dl>

<a name=3D"D-0060">
  <p>Topics matching <tt>exp</tt>:
  </p></a><dl><a name=3D"D-0060">
    </a><dt><a name=3D"D-0060"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02C4F18A">1:</a> Functions <tt>exp</tt>, <tt>log</tt>, <tt>log1=
0</tt> and <tt>log2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0119F541">2:</a=
> Method <tt>exp</tt></dt>
  </dl>

<a name=3D"D-006D">
  <p>Topics matching <tt>logcount</tt>:
  </p></a><dl><a name=3D"D-006D">
    </a><dt><a name=3D"D-006D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00A12EC7">1:</a> Function <tt>logcount</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00E186C6">2:</a=
> Method <tt>logcount</tt></dt>
  </dl>

<a name=3D"D-0030">
  <p>Topics matching <tt>close</tt>:
  </p></a><dl><a name=3D"D-0030">
    </a><dt><a name=3D"D-0030"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0399709A">1:</a> The <tt>close</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0308FCDD">2:</a=
> Method <tt>close</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01094176">3:</a=
> Function <tt>close</tt></dt>
  </dl>

<a name=3D"D-0004">
  <p>Topics matching <tt>put-char</tt>:
  </p></a><dl><a name=3D"D-0004">
    </a><dt><a name=3D"D-0004"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-012163C3">1:</a> Functions <tt>put-string</tt>, <tt>put-line</t=
t>, <tt>put-char</tt> and <tt>put-byte</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0146375A">2:</a=
> Method <tt>put-char</tt></dt>
  </dl>

<a name=3D"D-0078">
  <p>Topics matching <tt>acosh</tt>:
  </p></a><dl><a name=3D"D-0078">
    </a><dt><a name=3D"D-0078"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01DC05E9">1:</a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>ta=
nh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0239109D">2:</a=
> Method <tt>acosh</tt></dt>
  </dl>

<a name=3D"D-006B">
  <p>Topics matching <tt>oddp</tt>:
  </p></a><dl><a name=3D"D-006B">
    </a><dt><a name=3D"D-006B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02140809">1:</a> Functions <tt>evenp</tt> and <tt>oddp</tt></dt=
>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E6D33E">2:</a=
> Method <tt>oddp</tt></dt>
  </dl>

<a name=3D"D-005B">
  <p>Topics matching <tt>get-error</tt>:
  </p></a><dl><a name=3D"D-005B">
    </a><dt><a name=3D"D-005B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01060C4A">1:</a> Functions <tt>get-error</tt>, <tt>get-error-st=
r</tt> and <tt>clear-error</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00121ED3">2:</a=
> Method <tt>get-error</tt></dt>
  </dl>

<a name=3D"D-0012">
  <p>Topics matching <tt>nullify</tt>:
  </p></a><dl><a name=3D"D-0012">
    </a><dt><a name=3D"D-0012"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-035F2D99">1:</a> Methods <tt>car</tt>, <tt>cdr</tt> and <tt>nul=
lify</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03E5C1DE">2:</a=
> Function <tt>nullify</tt></dt>
  </dl>

<a name=3D"D-000F">
  <p>Topics matching <tt>unget-byte</tt>:
  </p></a><dl><a name=3D"D-000F">
    </a><dt><a name=3D"D-000F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0260DBDD">1:</a> Functions <tt>unget-char</tt> and <tt>unget-by=
te</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027DC412">2:</a=
> Method <tt>unget-byte</tt></dt>
  </dl>

<a name=3D"D-0048">
  <p>Topics matching <tt>plusp</tt>:
  </p></a><dl><a name=3D"D-0048">
    </a><dt><a name=3D"D-0048"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-019BF656">1:</a> Functions <tt>plusp</tt> and <tt>minusp</tt></=
dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B8D135">2:</a=
> Method <tt>plusp</tt></dt>
  </dl>

<a name=3D"D-0034">
  <p>Topics matching <tt>or</tt>:
  </p></a><dl><a name=3D"D-0034">
    </a><dt><a name=3D"D-0034"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02F4E3A4">1:</a> Operator/function <tt>or</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A12201">2:</a=
> Pattern operators <tt>and</tt> and <tt>or</tt></dt>
  </dl>

<a name=3D"D-0066">
  <p>Topics matching <tt>expt</tt>:
  </p></a><dl><a name=3D"D-0066">
    </a><dt><a name=3D"D-0066"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0127A60B">1:</a> Functions <tt>expt</tt>, <tt>sqrt</tt> and <tt=
>isqrt</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0226C8EB">2:</a=
> Method <tt>expt</tt></dt>
  </dl>

<a name=3D"D-0043">
  <p>Topics matching <tt>car</tt>:
  </p></a><dl><a name=3D"D-0043">
    </a><dt><a name=3D"D-0043"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02D60463">1:</a> Accessors <tt>car</tt> and <tt>first</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035F2D99">2:</a=
> Methods <tt>car</tt>, <tt>cdr</tt> and <tt>nullify</tt></dt>
  </dl>

<a name=3D"D-0038">
  <p>Topics matching <tt>tanh</tt>:
  </p></a><dl><a name=3D"D-0038">
    </a><dt><a name=3D"D-0038"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01DC05E9">1:</a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>ta=
nh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0266D577">2:</a=
> Method <tt>tanh</tt></dt>
  </dl>

<a name=3D"D-0046">
  <p>Topics matching <tt>until</tt>:
  </p></a><dl><a name=3D"D-0046">
    </a><dt><a name=3D"D-0046"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01AADEFA">1:</a> The <tt>until</tt> / <tt>last</tt> clause in <=
tt>gather</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014CE43D">2:</a=
> The <tt>until</tt> / <tt>last</tt> clause in <tt>collect</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025D542C">3:</a=
> Mandatory <tt>until</tt> and <tt>last</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01026F48">4:</a=
> Macros <tt>while</tt> and <tt>until</tt></dt>
  </dl>

<a name=3D"D-0040">
  <p>Topics matching <tt>get-char</tt>:
  </p></a><dl><a name=3D"D-0040">
    </a><dt><a name=3D"D-0040"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01EF7E47">1:</a> Functions <tt>get-line</tt>, <tt>get-char</tt>=
 and <tt>get-byte</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0246375D">2:</a=
> Method <tt>get-char</tt></dt>
  </dl>

<a name=3D"D-006E">
  <p>Topics matching <tt>equal</tt>:
  </p></a><dl><a name=3D"D-006E">
    </a><dt><a name=3D"D-006E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02550B35">1:</a> Functions <tt>eq</tt>, <tt>eql</tt> and <tt>eq=
ual</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00790C76">2:</a=
> Method <tt>equal</tt></dt>
  </dl>

<a name=3D"D-000D">
  <p>Topics matching <tt>elemtype</tt>:
  </p></a><dl><a name=3D"D-000D">
    </a><dt><a name=3D"D-000D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-008CEE1E">1:</a> FFI type <tt>elemtype</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D55EC5">2:</a=
> Macro <tt>elemtype</tt></dt>
  </dl>

<a name=3D"D-0036">
  <p>Topics matching <tt>evenp</tt>:
  </p></a><dl><a name=3D"D-0036">
    </a><dt><a name=3D"D-0036"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02140809">1:</a> Functions <tt>evenp</tt> and <tt>oddp</tt></dt=
>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B90BF9">2:</a=
> Method <tt>evenp</tt></dt>
  </dl>

<a name=3D"D-0014">
  <p>Topics matching <tt>log10</tt>:
  </p></a><dl><a name=3D"D-0014">
    </a><dt><a name=3D"D-0014"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02C4F18A">1:</a> Functions <tt>exp</tt>, <tt>log</tt>, <tt>log1=
0</tt> and <tt>log2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01B901AD">2:</a=
> Method <tt>log10</tt></dt>
  </dl>

<a name=3D"D-0006">
  <p>Topics matching <tt>length</tt>:
  </p></a><dl><a name=3D"D-0006">
    </a><dt><a name=3D"D-0006"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-025D84CE">1:</a> Method <tt>length</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AD172A">2:</a=
> Functions <tt>length</tt> and <tt>len</tt></dt>
  </dl>

<a name=3D"D-000A">
  <p>Topics matching <tt>logior</tt>:
  </p></a><dl><a name=3D"D-000A">
    </a><dt><a name=3D"D-000A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02D5AF97">1:</a> Functions <tt>logand</tt>, <tt>logior</tt> and=
 <tt>logxor</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02BD8EDD">2:</a=
> Method <tt>logior</tt></dt>
  </dl>

<a name=3D"D-0079">
  <p>Topics matching <tt>put-buf</tt>:
  </p></a><dl><a name=3D"D-0079">
    </a><dt><a name=3D"D-0079"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-021DB1B7">1:</a> Function <tt>put-buf</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02117E37">2:</a=
> Method <tt>put-buf</tt></dt>
  </dl>

<a name=3D"D-0062">
  <p>Topics matching <tt>in-package</tt>:
  </p></a><dl><a name=3D"D-0062">
    </a><dt><a name=3D"D-0062"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01617CB2">1:</a> The <tt>in-package</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0179530B">2:</a=
> Macro <tt>in-package</tt></dt>
  </dl>

<a name=3D"D-0067">
  <p>Topics matching <tt>bitset</tt>:
  </p></a><dl><a name=3D"D-0067">
    </a><dt><a name=3D"D-0067"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0121D13B">1:</a> Function <tt>bitset</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011DFB63">2:</a=
> Method <tt>bitset</tt></dt>
  </dl>

<a name=3D"D-0064">
  <p>Topics matching <tt>exptmod</tt>:
  </p></a><dl><a name=3D"D-0064">
    </a><dt><a name=3D"D-0064"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-034A37D0">1:</a> Function <tt>exptmod</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03462450">2:</a=
> Method <tt>exptmod</tt></dt>
  </dl>

<a name=3D"D-004C">
  <p>Topics matching <tt>floor</tt>:
  </p></a><dl><a name=3D"D-004C">
    </a><dt><a name=3D"D-004C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02084F55">1:</a> Functions <tt>trunc</tt>, <tt>floor</tt>, <tt>=
ceil</tt> and <tt>round</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D908C0">2:</a=
> Method <tt>floor</tt></dt>
  </dl>

<a name=3D"D-0069">
  <p>Topics matching <tt>cdr</tt>:
  </p></a><dl><a name=3D"D-0069">
    </a><dt><a name=3D"D-0069"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02288559">1:</a> Accessors <tt>cdr</tt> and <tt>rest</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-035F2D99">2:</a=
> Methods <tt>car</tt>, <tt>cdr</tt> and <tt>nullify</tt></dt>
  </dl>

<a name=3D"D-002B">
  <p>Topics matching <tt>defex</tt>:
  </p></a><dl><a name=3D"D-002B">
    </a><dt><a name=3D"D-002B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00FFE564">1:</a> The <tt>defex</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00ECE51D">2:</a=
> Macro <tt>defex</tt></dt>
  </dl>

<a name=3D"D-0008">
  <p>Topics matching <tt>iter-item</tt>:
  </p></a><dl><a name=3D"D-0008">
    </a><dt><a name=3D"D-0008"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-000891B1">1:</a> Method <tt>iter-item</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0036122B">2:</a=
> Function <tt>iter-item</tt></dt>
  </dl>

<a name=3D"D-0058">
  <p>Topics matching <tt>qref</tt>:
  </p></a><dl><a name=3D"D-0058">
    </a><dt><a name=3D"D-0058"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03A212AB">1:</a> Macro <tt>qref</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015DE290">2:</a=
> FFI type <tt>qref</tt></dt>
  </dl>

<a name=3D"D-0076">
  <p>Topics matching <tt>mod</tt>:
  </p></a><dl><a name=3D"D-0076">
    </a><dt><a name=3D"D-0076"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0047F5A8">1:</a> Function <tt>mod</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00D9F564">2:</a=
> Method <tt>mod</tt></dt>
  </dl>

<a name=3D"D-007A">
  <p>Topics matching <tt>last</tt>:
  </p></a><dl><a name=3D"D-007A">
    </a><dt><a name=3D"D-007A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01AADEFA">1:</a> The <tt>until</tt> / <tt>last</tt> clause in <=
tt>gather</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-014CE43D">2:</a=
> The <tt>until</tt> / <tt>last</tt> clause in <tt>collect</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-025D542C">3:</a=
> Mandatory <tt>until</tt> and <tt>last</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0326F3F2">4:</a=
> Accessor <tt>last</tt></dt>
  </dl>

<a name=3D"D-0077">
  <p>Topics matching <tt>some</tt>:
  </p></a><dl><a name=3D"D-0077">
    </a><dt><a name=3D"D-0077"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-039458F2">1:</a> The <tt>some</tt>, <tt>all</tt>, <tt>none</tt>=
, <tt>maybe</tt>, <tt>cases</tt> and <tt>choose</tt> directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DD08">2:</a=
> Functions <tt>some</tt>, <tt>all</tt> and <tt>none</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-033989E1">3:</a=
> Pattern operator <tt>some</tt></dt>
  </dl>

<a name=3D"D-0033">
  <p>Topics matching <tt>width</tt>:
  </p></a><dl><a name=3D"D-0033">
    </a><dt><a name=3D"D-0033"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0338F21A">1:</a> Function <tt>width</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0138CDB7">2:</a=
> Method <tt>width</tt></dt>
  </dl>

<a name=3D"D-001B">
  <p>Topics matching <tt>all</tt>:
  </p></a><dl><a name=3D"D-001B">
    </a><dt><a name=3D"D-001B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-039458F2">1:</a> The <tt>some</tt>, <tt>all</tt>, <tt>none</tt>=
, <tt>maybe</tt>, <tt>cases</tt> and <tt>choose</tt> directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DD08">2:</a=
> Functions <tt>some</tt>, <tt>all</tt> and <tt>none</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F6E2A2">3:</a=
> Pattern operators <tt>all</tt> and <tt>all*</tt></dt>
  </dl>

<a name=3D"D-001A">
  <p>Topics matching <tt>&gt;=3D</tt>:
  </p></a><dl><a name=3D"D-001A">
    </a><dt><a name=3D"D-001A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02A1116F">1:</a> Functions <tt>&gt;</tt>, <tt>&lt;</tt>, <tt>&g=
t;=3D</tt>, <tt>&lt;=3D</tt> and <tt>=3D</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0388136A">2:</a=
> Method <tt>&gt;=3D</tt></dt>
  </dl>

<a name=3D"D-0068">
  <p>Topics matching <tt>isqrt</tt>:
  </p></a><dl><a name=3D"D-0068">
    </a><dt><a name=3D"D-0068"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0127A60B">1:</a> Functions <tt>expt</tt>, <tt>sqrt</tt> and <tt=
>isqrt</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00F8DD02">2:</a=
> Method <tt>isqrt</tt></dt>
  </dl>

<a name=3D"D-000E">
  <p>Topics matching <tt>rep</tt>:
  </p></a><dl><a name=3D"D-000E">
    </a><dt><a name=3D"D-000E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0343AA1B">1:</a> The <tt>rep</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B81F3D">2:</a=
> <tt>repeat</tt> and <tt>rep</tt> Examples</dt>
  </dl>

<a name=3D"D-002E">
  <p>Topics matching <tt>assert</tt>:
  </p></a><dl><a name=3D"D-002E">
    </a><dt><a name=3D"D-002E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0294EF6B">1:</a> The <tt>assert</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-005A3A6C">2:</a=
> Macro <tt>assert</tt></dt>
  </dl>

<a name=3D"D-0022">
  <p>Topics matching <tt>&lt;</tt>:
  </p></a><dl><a name=3D"D-0022">
    </a><dt><a name=3D"D-0022"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02A1116F">1:</a> Functions <tt>&gt;</tt>, <tt>&lt;</tt>, <tt>&g=
t;=3D</tt>, <tt>&lt;=3D</tt> and <tt>=3D</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0136D95D">2:</a=
> Method <tt>&lt;</tt></dt>
  </dl>

<a name=3D"D-002D">
  <p>Topics matching <tt>buf-d</tt>:
  </p></a><dl><a name=3D"D-002D">
    </a><dt><a name=3D"D-002D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0384A6E7">1:</a> FFI types <tt>buf</tt> and <tt>buf-d</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A6E963">2:</a=
> FFI types <tt>buf</tt> and <tt>buf-d</tt></dt>
  </dl>

<a name=3D"D-0080">
  <p>Topics matching <tt>load</tt>:
  </p></a><dl><a name=3D"D-0080">
    </a><dt><a name=3D"D-0080"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01A2ECA0">1:</a> The <tt>load</tt> and <tt>include</tt> directi=
ves</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0306CE9C">2:</a=
> Function <tt>load</tt></dt>
  </dl>

<a name=3D"D-0063">
  <p>Topics matching <tt>log2</tt>:
  </p></a><dl><a name=3D"D-0063">
    </a><dt><a name=3D"D-0063"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02C4F18A">1:</a> Functions <tt>exp</tt>, <tt>log</tt>, <tt>log1=
0</tt> and <tt>log2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C6CADD">2:</a=
> Method <tt>log2</tt></dt>
  </dl>

<a name=3D"D-0039">
  <p>Topics matching <tt>if</tt>:
  </p></a><dl><a name=3D"D-0039">
    </a><dt><a name=3D"D-0039"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03AE2765">1:</a> The <tt>if</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03DC6E54">2:</a=
> The Lisp <tt>if</tt> versus TXR <tt>if</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03B4E3A4">3:</a=
> Operator/function <tt>if</tt></dt>
  </dl>

<a name=3D"D-000C">
  <p>Topics matching <tt>bit</tt>:
  </p></a><dl><a name=3D"D-000C">
    </a><dt><a name=3D"D-000C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0347F5A4">1:</a> Function <tt>bit</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D9F568">2:</a=
> Method <tt>bit</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015B052B">3:</a=
> FFI type <tt>bit</tt></dt>
  </dl>

<a name=3D"D-0042">
  <p>Topics matching <tt>cos</tt>:
  </p></a><dl><a name=3D"D-0042">
    </a><dt><a name=3D"D-0042"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0209F56C">2:</a=
> Method <tt>cos</tt></dt>
  </dl>

<a name=3D"D-0035">
  <p>Topics matching <tt>struct</tt>:
  </p></a><dl><a name=3D"D-0035">
    </a><dt><a name=3D"D-0035"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03DE4A45">1:</a> Pattern operator <tt>struct</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0005D5C1">2:</a=
> FFI type <tt>struct</tt></dt>
  </dl>

<a name=3D"D-0005">
  <p>Topics matching <tt>asinh</tt>:
  </p></a><dl><a name=3D"D-0005">
    </a><dt><a name=3D"D-0005"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01DC05E9">1:</a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>ta=
nh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0338FCA8">2:</a=
> Method <tt>asinh</tt></dt>
  </dl>

<a name=3D"D-0071">
  <p>Topics matching <tt>ceil</tt>:
  </p></a><dl><a name=3D"D-0071">
    </a><dt><a name=3D"D-0071"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02084F55">1:</a> Functions <tt>trunc</tt>, <tt>floor</tt>, <tt>=
ceil</tt> and <tt>round</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01A6CAA5">2:</a=
> Method <tt>ceil</tt></dt>
  </dl>

<a name=3D"D-0052">
  <p>Topics matching <tt>repeat</tt>:
  </p></a><dl><a name=3D"D-0052">
    </a><dt><a name=3D"D-0052"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00CB3FB7">1:</a> The <tt>repeat</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-017CF83A">2:</a=
> Nested <tt>repeat</tt> directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B81F3D">3:</a=
> <tt>repeat</tt> and <tt>rep</tt> Examples</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011DC272">4:</a=
> Function <tt>repeat</tt></dt>
  </dl>

<a name=3D"D-003D">
  <p>Topics matching <tt>ash</tt>:
  </p></a><dl><a name=3D"D-003D">
    </a><dt><a name=3D"D-003D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0107F533">1:</a> Function <tt>ash</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0099F56F">2:</a=
> Method <tt>ash</tt></dt>
  </dl>

<a name=3D"D-004D">
  <p>Topics matching <tt>gather</tt>:
  </p></a><dl><a name=3D"D-004D">
    </a><dt><a name=3D"D-004D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01410000">1:</a> The <tt>gather</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AADEFA">2:</a=
> The <tt>until</tt> / <tt>last</tt> clause in <tt>gather</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03CE85EA">3:</a=
> Keyword parameters in <tt>gather</tt></dt>
  </dl>

<a name=3D"D-003C">
  <p>Topics matching <tt>time-parse</tt>:
  </p></a><dl><a name=3D"D-003C">
    </a><dt><a name=3D"D-003C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00207C99">1:</a> Functions <tt>time-parse</tt>, <tt>time-parse-=
local</tt> and <tt>time-parse-utc</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0012278E">2:</a=
> Method <tt>time-parse</tt></dt>
  </dl>

<a name=3D"D-0032">
  <p>Topics matching <tt>abs</tt>:
  </p></a><dl><a name=3D"D-0032">
    </a><dt><a name=3D"D-0032"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0297F537">1:</a> Function <tt>abs</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0309F553">2:</a=
> Method <tt>abs</tt></dt>
  </dl>

<a name=3D"D-0050">
  <p>Topics matching <tt>not</tt>:
  </p></a><dl><a name=3D"D-0050">
    </a><dt><a name=3D"D-0050"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03C679D2">1:</a> Functions <tt>null</tt>, <tt>not</tt> and <tt>=
false</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003BC1A2">2:</a=
> Pattern operator <tt>not</tt></dt>
  </dl>

<a name=3D"D-004A">
  <p>Topics matching <tt>sqrt</tt>:
  </p></a><dl><a name=3D"D-004A">
    </a><dt><a name=3D"D-004A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0127A60B">1:</a> Functions <tt>expt</tt>, <tt>sqrt</tt> and <tt=
>isqrt</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0026D70F">2:</a=
> Method <tt>sqrt</tt></dt>
  </dl>

<a name=3D"D-003A">
  <p>Topics matching <tt>&lt;=3D</tt>:
  </p></a><dl><a name=3D"D-003A">
    </a><dt><a name=3D"D-003A"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02A1116F">1:</a> Functions <tt>&gt;</tt>, <tt>&lt;</tt>, <tt>&g=
t;=3D</tt>, <tt>&lt;=3D</tt> and <tt>=3D</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-038809AA">2:</a=
> Method <tt>&lt;=3D</tt></dt>
  </dl>

<a name=3D"D-0025">
  <p>Topics matching <tt>awk</tt>:
  </p></a><dl><a name=3D"D-0025">
    </a><dt><a name=3D"D-0025"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-012F3A2C">1:</a> Macro <tt>awk</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D16283">2:</a=
> Examples of <tt>awk</tt> Macro Usage</dt>
  </dl>

<a name=3D"D-0017">
  <p>Topics matching <tt>clear-error</tt>:
  </p></a><dl><a name=3D"D-0017">
    </a><dt><a name=3D"D-0017"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01060C4A">1:</a> Functions <tt>get-error</tt>, <tt>get-error-st=
r</tt> and <tt>clear-error</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-029208DD">2:</a=
> Method <tt>clear-error</tt></dt>
  </dl>

<a name=3D"D-0013">
  <p>Topics matching <tt>rplacd</tt>:
  </p></a><dl><a name=3D"D-0013">
    </a><dt><a name=3D"D-0013"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0276905F">1:</a> Functions <tt>rplaca</tt> and <tt>rplacd</tt><=
/dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0002B267">2:</a=
> Methods <tt>rplaca</tt> and <tt>rplacd</tt></dt>
  </dl>

<a name=3D"D-007C">
  <p>Topics matching <tt>+</tt>:
  </p></a><dl><a name=3D"D-007C">
    </a><dt><a name=3D"D-007C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01F56DFE">1:</a> Functions <tt>+</tt> and <tt>-</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-021396F7">2:</a=
> Method <tt>+</tt></dt>
  </dl>

<a name=3D"D-004B">
  <p>Topics matching <tt>acos</tt>:
  </p></a><dl><a name=3D"D-004B">
    </a><dt><a name=3D"D-004B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00B6C9CC">2:</a=
> Method <tt>acos</tt></dt>
  </dl>

<a name=3D"D-0037">
  <p>Topics matching <tt>&gt;</tt>:
  </p></a><dl><a name=3D"D-0037">
    </a><dt><a name=3D"D-0037"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02A1116F">1:</a> Functions <tt>&gt;</tt>, <tt>&lt;</tt>, <tt>&g=
t;=3D</tt>, <tt>&lt;=3D</tt> and <tt>=3D</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0136D9F9">2:</a=
> Method <tt>&gt;</tt></dt>
  </dl>

<a name=3D"D-0003">
  <p>Topics matching <tt>load-time</tt>:
  </p></a><dl><a name=3D"D-0003">
    </a><dt><a name=3D"D-0003"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-019FEC08">1:</a> Differences due to <tt>load-time</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A3999F">2:</a=
> Macro <tt>load-time</tt></dt>
  </dl>

<a name=3D"D-003F">
  <p>Topics matching <tt>iter-reset</tt>:
  </p></a><dl><a name=3D"D-003F">
    </a><dt><a name=3D"D-003F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0227EA90">1:</a> Methods <tt>iter-begin</tt> and <tt>iter-reset=
</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03EE4725">2:</a=
> Function <tt>iter-reset</tt></dt>
  </dl>

<a name=3D"D-0023">
  <p>Topics matching <tt>catch</tt>:
  </p></a><dl><a name=3D"D-0023">
    </a><dt><a name=3D"D-0023"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-023ADC77">1:</a> <tt>catch</tt> clauses</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-020EA418">2:</a=
> <tt>catch</tt> Clauses with Parameters</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0211F3D3">3:</a=
> Macros <tt>catch</tt>, <tt>catch*</tt> and <tt>catch**</tt></dt>
  </dl>

<a name=3D"D-0044">
  <p>Topics matching <tt>atanh</tt>:
  </p></a><dl><a name=3D"D-0044">
    </a><dt><a name=3D"D-0044"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01DC05E9">1:</a> Functions <tt>sinh</tt>, <tt>cosh</tt>, <tt>ta=
nh</tt>, <tt>asinh</tt>, <tt>acosh</tt> and <tt>atanh</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0338FB88">2:</a=
> Method <tt>atanh</tt></dt>
  </dl>

<a name=3D"D-0029">
  <p>Topics matching <tt>stat</tt>:
  </p></a><dl><a name=3D"D-0029">
    </a><dt><a name=3D"D-0029"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0308FEDD">1:</a> Structure <tt>stat</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-006DE1CC">2:</a=
> Functions <tt>stat</tt>, <tt>lstat</tt> and <tt>fstat</tt></dt>
  </dl>

<a name=3D"D-0031">
  <p>Topics matching <tt>get-line</tt>:
  </p></a><dl><a name=3D"D-0031">
    </a><dt><a name=3D"D-0031"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01EF7E47">1:</a> Functions <tt>get-line</tt>, <tt>get-char</tt>=
 and <tt>get-byte</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02963E19">2:</a=
> Method <tt>get-line</tt></dt>
  </dl>

<a name=3D"D-0061">
  <p>Topics matching <tt>do</tt>:
  </p></a><dl><a name=3D"D-0061">
    </a><dt><a name=3D"D-0061"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03B66E65">1:</a> The <tt>do</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0068EA9D">2:</a=
> Macros <tt>op</tt> and <tt>do</tt></dt>
  </dl>

<a name=3D"D-004E">
  <p>Topics matching <tt>bool</tt>:
  </p></a><dl><a name=3D"D-004E">
    </a><dt><a name=3D"D-004E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03BDE6A5">1:</a> FFI type <tt>bool</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01E6A76D">2:</a=
> FFI type <tt>bool</tt></dt>
  </dl>

<a name=3D"D-007F">
  <p>Topics matching <tt>log</tt>:
  </p></a><dl><a name=3D"D-007F">
    </a><dt><a name=3D"D-007F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02C4F18A">1:</a> Functions <tt>exp</tt>, <tt>log</tt>, <tt>log1=
0</tt> and <tt>log2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00C9F560">2:</a=
> Method <tt>log</tt></dt>
  </dl>

<a name=3D"D-0047">
  <p>Topics matching <tt>fill-buf</tt>:
  </p></a><dl><a name=3D"D-0047">
    </a><dt><a name=3D"D-0047"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00D142E1">1:</a> Functions <tt>fill-buf</tt> and <tt>fill-buf-a=
djust</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-013949E0">2:</a=
> Method <tt>fill-buf</tt></dt>
  </dl>

<a name=3D"D-001C">
  <p>Topics matching <tt>logand</tt>:
  </p></a><dl><a name=3D"D-001C">
    </a><dt><a name=3D"D-001C"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02D5AF97">1:</a> Functions <tt>logand</tt>, <tt>logior</tt> and=
 <tt>logxor</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-011D877D">2:</a=
> Method <tt>logand</tt></dt>
  </dl>

<a name=3D"D-0020">
  <p>Topics matching <tt>trailer</tt>:
  </p></a><dl><a name=3D"D-0020">
    </a><dt><a name=3D"D-0020"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01476441">1:</a> The <tt>trailer</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01AC9294">2:</a=
> Interaction Between the <tt>trailer</tt> and <tt>accept</tt> Directives</=
dt>
  </dl>

<a name=3D"D-003E">
  <p>Topics matching <tt>dwim</tt>:
  </p></a><dl><a name=3D"D-003E">
    </a><dt><a name=3D"D-003E"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02DC9E04">1:</a> Operator <tt>dwim</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-003616B1">2:</a=
> Unbound symbols in <tt>dwim</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-027616B2">3:</a=
> Bound symbols in <tt>dwim</tt></dt>
  </dl>

<a name=3D"D-0051">
  <p>Topics matching <tt>iter-begin</tt>:
  </p></a><dl><a name=3D"D-0051">
    </a><dt><a name=3D"D-0051"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0227EA90">1:</a> Methods <tt>iter-begin</tt> and <tt>iter-reset=
</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-024C86F4">2:</a=
> Function <tt>iter-begin</tt></dt>
  </dl>

<a name=3D"D-0057">
  <p>Topics matching <tt>bind</tt>:
  </p></a><dl><a name=3D"D-0057">
    </a><dt><a name=3D"D-0057"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02ED877D">1:</a> The <tt>bind</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-00A298C5">2:</a=
> Keywords in the <tt>bind</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02572115">3:</a=
> Lisp forms in the <tt>bind</tt> directive</dt>
  </dl>

<a name=3D"D-0054">
  <p>Topics matching <tt>none</tt>:
  </p></a><dl><a name=3D"D-0054">
    </a><dt><a name=3D"D-0054"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-039458F2">1:</a> The <tt>some</tt>, <tt>all</tt>, <tt>none</tt>=
, <tt>maybe</tt>, <tt>cases</tt> and <tt>choose</tt> directives</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03D4DD08">2:</a=
> Functions <tt>some</tt>, <tt>all</tt> and <tt>none</tt></dt>
  </dl>

<a name=3D"D-0010">
  <p>Topics matching <tt>minusp</tt>:
  </p></a><dl><a name=3D"D-0010">
    </a><dt><a name=3D"D-0010"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-019BF656">1:</a> Functions <tt>plusp</tt> and <tt>minusp</tt></=
dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-02DDD586">2:</a=
> Method <tt>minusp</tt></dt>
  </dl>

<a name=3D"D-000B">
  <p>Topics matching <tt>rplaca</tt>:
  </p></a><dl><a name=3D"D-000B">
    </a><dt><a name=3D"D-000B"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-0276905F">1:</a> Functions <tt>rplaca</tt> and <tt>rplacd</tt><=
/dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0002B267">2:</a=
> Methods <tt>rplaca</tt> and <tt>rplacd</tt></dt>
  </dl>

<a name=3D"D-0049">
  <p>Topics matching <tt>and</tt>:
  </p></a><dl><a name=3D"D-0049">
    </a><dt><a name=3D"D-0049"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-02D7EEB3">1:</a> Operator/function <tt>and</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03A12201">2:</a=
> Pattern operators <tt>and</tt> and <tt>or</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-018C7C8C">3:</a=
> FFI types <tt>short</tt>, <tt>ushort</tt>, <tt>int</tt>, <tt>uint</tt>, <=
tt>long</tt>, <tt>and</tt> <tt>ulong</tt></dt>
  </dl>

<a name=3D"D-005D">
  <p>Topics matching <tt>time</tt>:
  </p></a><dl><a name=3D"D-005D">
    </a><dt><a name=3D"D-005D"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03B6DB3D">1:</a> Functions <tt>time</tt>, <tt>time-usec</tt> an=
d <tt>time-nsec</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-01F8F906">2:</a=
> Structure <tt>time</tt></dt>
  </dl>

<a name=3D"D-001F">
  <p>Topics matching <tt>signum</tt>:
  </p></a><dl><a name=3D"D-001F">
    </a><dt><a name=3D"D-001F"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-03AD95A2">1:</a> Function <tt>signum</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-03AA56EA">2:</a=
> Method <tt>signum</tt></dt>
  </dl>

<a name=3D"D-0018">
  <p>Topics matching <tt>sin</tt>:
  </p></a><dl><a name=3D"D-0018">
    </a><dt><a name=3D"D-0018"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-00F5D388">1:</a> Functions <tt>sin</tt>, <tt>cos</tt>, <tt>tan<=
/tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt> and <tt>atan2</tt></dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-0239F62C">2:</a=
> Method <tt>sin</tt></dt>
  </dl>

<a name=3D"D-0016">
  <p>Topics matching <tt>throw</tt>:
  </p></a><dl><a name=3D"D-0016">
    </a><dt><a name=3D"D-0016"></a><a href=3D"http://nongnu.org/txr/txr-man=
page.html#N-01634260">1:</a> The <tt>throw</tt> directive</dt>
    <dt><a href=3D"http://nongnu.org/txr/txr-manpage.html#N-015466AD">2:</a=
> Functions <tt>throw</tt>, <tt>throwf</tt> and <tt>error</tt></dt>
  </dl>

</div>


</body></html>
------MultipartBoundary--pSBQFzMwx6iqKirzHyn6nKPOp5RwEH2OySALaokay7----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: cid:css-09d5e6d3-863d-447c-aeb2-db07e4366efb@mhtml.blink

@charset "utf-8";

.disambiguations dl { margin-bottom: 2048px; }

dl.items dd:empty::after { content: "=C2=A0"; }

dl.items dd { overflow: auto; min-width: calc(100% - 3em); margin-left: 3em=
; margin-bottom: 1ex; }

dl.items dt { float: left; padding-right: 1ex; }
------MultipartBoundary--pSBQFzMwx6iqKirzHyn6nKPOp5RwEH2OySALaokay7----
Content-Type: image/webp
Content-Transfer-Encoding: base64
Content-Location: https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif

UklGRtQCAABXRUJQVlA4WAoAAAAQAAAAWwAAGQAAQUxQSEYAAAABDzD/ERGCbSRbbZ58qBIoFUql
BEIvRZxsARH9nwAdZ3eTO/tGHlgFcCqSoZKJHWRjJ93/4yDbfZVMLJIhEHlg5YCRam8SVlA4IGgC
AABwDQCdASpcABoAPtlerFEoJKQiqBVZyQAbCWwAxy1BfqvQMVs8vfhnEdtR5gOhhvAHoAfsB1o6
NBCAcoZoG+lfYHSdskWWJhjgwd8EOtmgweTM0IyE/GN696V16cqNLjTpIoddj7frso17wltPX0bJ
pXtZwAD+83NrNObh1tq3eq1H2AT6fvxH/DD++OONG3uagOVoQfR/8x9OgHe//AoNOrVLZ7Glwdgs
MmBT+pvG0/78BZgABcEAOn8O/8ZRBJm/H/Okszlfc2nzgoIvT9Y5do37uZyp565jI3ZvaPIqAxO0
I2HwYtohfVKn3v3e97eodhHjiuHyvxWpfq47mMWuc6ebFIlPyuorxnAgU0Y69xanRuNVBXKX3UDl
vHx9Coan73By+33N9+yrRudVqbz/+70iuWUa6QAParxX+kgjirE0tSG1z+4AGrNfilDCswKUm4wG
A1/gwVaHpPswQy986e37XCeh20L7yAk4OsD3KRLf9MFqU+a7vUGJfNZ5qA77mo1LIqEXCUk5i8Xm
ptOlRXlHgBbcGH0lmUOslHBcv+DSK7a7NIobP3AVFxA2vwec9yNGAhPAd+tZZPYjHt916XBYWJC2
dt+zK3/fjSnk58NhcCGL72oTqA1cc7JYhqs3z0R8H2tSRHMGPuR46zpnYSGeygQhHzbzpcY6MM4G
SZWPaUPdKfNAbjctn4OXVOCL0zasWzbn1pOaXrW7BXo59yySY6657tDCe5WIHU6wAqR3gP/LKpZj
DMQ0f72rDrSWvjMz4veZEihHahD2dP/6fMbm4cbFjFCKcBCmPUH/e+zg2Q3lMAAA

------MultipartBoundary--pSBQFzMwx6iqKirzHyn6nKPOp5RwEH2OySALaokay7------
